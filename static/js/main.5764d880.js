/*! For license information please see main.5764d880.js.LICENSE.txt */
!function(){var e={9998:function(e,t){"use strict";t.Z=function(e,t){if(e&&t){var n=Array.isArray(t)?t:t.split(","),r=e.name||"",i=(e.type||"").toLowerCase(),o=i.replace(/\/.*$/,"");return n.some((function(e){var t=e.trim().toLowerCase();return"."===t.charAt(0)?r.toLowerCase().endsWith(t):t.endsWith("/*")?o===t.replace(/\/.*$/,""):i===t}))}return!0}},1694:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var a=i.apply(null,n);a&&e.push(a)}}else if("object"===o)if(n.toString===Object.prototype.toString)for(var s in n)r.call(n,s)&&n[s]&&e.push(s);else e.push(n.toString())}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},9110:function(e,t,n){var r=n(7424).default,i=n(7061).default,o=n(861).default,a=n(4993).default,s=n(4704).default,l=n(1588).default,u=n(3808).default,c=n(8416).default,d=n(6690).default,h=n(9728).default,f=n(6115).default,p=n(1655).default,v=n(6389).default;globalThis,e.exports=function(){var e={9742:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o=l(e),a=o[0],s=o[1],u=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),c=0,d=s>0?a-4:a;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===s&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,u[c++]=255&t),1===s&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],a=16383,s=0,l=r-i;s<l;s+=a)o.push(u(e,s,s+a>l?l:s+a));return 1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,s=o.length;a<s;++a)n[a]=o[a],r[o.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,r){for(var i,o,a=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},8764:function(e,t,n){"use strict";var r=n(9742),i=n(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50;var a=2147483647;function s(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return g(e)}return u(e,t,n)}function u(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|b(e,t),r=s(n),i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(ee(e,Uint8Array)){var t=new Uint8Array(e);return y(t.buffer,t.byteOffset,t.byteLength)}return m(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(ee(e,ArrayBuffer)||e&&ee(e.buffer,ArrayBuffer))return y(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(ee(e,SharedArrayBuffer)||e&&ee(e.buffer,SharedArrayBuffer)))return y(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return l.from(r,t,n);var i=function(e){if(l.isBuffer(e)){var t=0|w(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||te(e.length)?s(0):m(e):"Buffer"===e.type&&Array.isArray(e.data)?m(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function g(e){return c(e),s(e<0?0:0|w(e))}function m(e){for(var t=e.length<0?0:0|w(e.length),n=s(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function y(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,l.prototype),r}function w(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function b(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||ee(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return Z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return J(e).length;default:if(i)return r?-1:Z(e).length;t=(""+t).toLowerCase(),i=!0}}function C(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,n);case"utf8":case"utf-8":return D(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return F(this,t,n);case"base64":return O(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function S(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function E(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),te(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:k(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):k(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function k(e,t,n,r,i){var o,a=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var c=-1;for(o=n;o<s;o++)if(u(e,o)===u(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var d=!0,h=0;h<l;h++)if(u(e,o+h)!==u(t,h)){d=!1;break}if(d)return o}return-1}function x(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o,a=t.length;for(r>a/2&&(r=a/2),o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(te(s))return o;e[n+o]=s}return o}function T(e,t,n,r){return $(Z(t,e.length-n),e,n,r)}function R(e,t,n,r){return $(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function A(e,t,n,r){return $(J(t),e,n,r)}function _(e,t,n,r){return $(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function O(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function D(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o=e[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s<=n){var l=void 0,u=void 0,c=void 0,d=void 0;switch(s){case 1:o<128&&(a=o);break;case 2:128==(192&(l=e[i+1]))&&(d=(31&o)<<6|63&l)>127&&(a=d);break;case 3:l=e[i+1],u=e[i+2],128==(192&l)&&128==(192&u)&&(d=(15&o)<<12|(63&l)<<6|63&u)>2047&&(d<55296||d>57343)&&(a=d);break;case 4:l=e[i+1],u=e[i+2],c=e[i+3],128==(192&l)&&128==(192&u)&&128==(192&c)&&(d=(15&o)<<18|(63&l)<<12|(63&u)<<6|63&c)>65535&&d<1114112&&(a=d)}}null===a?(a=65533,s=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),i+=s}return function(e){var t=e.length;if(t<=N)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=N));return n}(r)}t.kMaxLength=a,l.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),n={foo:function(){return 42}};return Object.setPrototypeOf(n,Uint8Array.prototype),Object.setPrototypeOf(t,n),42===t.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return u(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return function(e,t,n){return c(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}(e,t,n)},l.allocUnsafe=function(e){return g(e)},l.allocUnsafeSlow=function(e){return g(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(ee(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),ee(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(ee(o,Uint8Array))i+o.length>r.length?(l.isBuffer(o)||(o=l.from(o)),o.copy(r,i)):Uint8Array.prototype.set.call(r,o,i);else{if(!l.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i)}i+=o.length}return r},l.byteLength=b,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)S(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)S(this,t,t+3),S(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)S(this,t,t+7),S(this,t+1,t+6),S(this,t+2,t+5),S(this,t+3,t+4);return this},l.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?D(this,0,e):C.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(e,t,n,r,i){if(ee(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(r,i),c=e.slice(t,n),d=0;d<s;++d)if(u[d]!==c[d]){o=u[d],a=c[d];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return E(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return E(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return x(this,e,t,n);case"utf8":case"utf-8":return T(this,e,t,n);case"ascii":case"latin1":case"binary":return R(this,e,t,n);case"base64":return A(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var N=4096;function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function F(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function I(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=ne[e[o]];return i}function L(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function G(e,t,n,r,i,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function B(e,t,n,r,i){q(t,r,i,e,n,7);var o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;var a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,n}function j(e,t,n,r,i){q(t,r,i,e,n,7);var o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;var a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=a,a>>=8,e[n+2]=a,a>>=8,e[n+1]=a,a>>=8,e[n]=a,n+8}function H(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function V(e,t,n,r,o){return t=+t,n>>>=0,o||H(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function W(e,t,n,r,o){return t=+t,n>>>=0,o||H(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=re((function(e){X(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Y(e,this.length-8);var r=t+256*this[++e]+65536*this[++e]+this[++e]*Math.pow(2,24),i=this[++e]+256*this[++e]+65536*this[++e]+n*Math.pow(2,24);return BigInt(r)+(BigInt(i)<<BigInt(32))})),l.prototype.readBigUInt64BE=re((function(e){X(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Y(e,this.length-8);var r=t*Math.pow(2,24)+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*Math.pow(2,24)+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=re((function(e){X(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Y(e,this.length-8);var r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*Math.pow(2,24))})),l.prototype.readBigInt64BE=re((function(e){X(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Y(e,this.length-8);var r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*Math.pow(2,24)+65536*this[++e]+256*this[++e]+n)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||M(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||M(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||M(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||M(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||G(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||G(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||G(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||G(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||G(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||G(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||G(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=re((function(e){return B(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=re((function(e){return j(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);G(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);G(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||G(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||G(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||G(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||G(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||G(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=re((function(e){return B(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=re((function(e){return j(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,n){return V(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return V(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return W(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return W(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=l.isBuffer(e)?e:l.from(e,r),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var z={};function U(e,t,n){z[e]=function(n){p(i,n);var r=v(i);function i(){var n;return d(this,i),n=r.call(this),Object.defineProperty(f(n),"message",{value:t.apply(f(n),arguments),writable:!0,configurable:!0}),n.name="".concat(n.name," [").concat(e,"]"),n.stack,delete n.name,n}return h(i,[{key:"code",get:function(){return e},set:function(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}},{key:"toString",value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}]),i}(n)}function K(e){for(var t="",n=e.length,r="-"===e[0]?1:0;n>=r+4;n-=3)t="_".concat(e.slice(n-3,n)).concat(t);return"".concat(e.slice(0,n)).concat(t)}function q(e,t,n,r,i,o){if(e>n||e<t){var a,s="bigint"==typeof t?"n":"";throw a=o>3?0===t||t===BigInt(0)?">= 0".concat(s," and < 2").concat(s," ** ").concat(8*(o+1)).concat(s):">= -(2".concat(s," ** ").concat(8*(o+1)-1).concat(s,") and < 2 ** ").concat(8*(o+1)-1).concat(s):">= ".concat(t).concat(s," and <= ").concat(n).concat(s),new z.ERR_OUT_OF_RANGE("value",a,e)}!function(e,t,n){X(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||Y(t,e.length-(n+1))}(r,i,o)}function X(e,t){if("number"!=typeof e)throw new z.ERR_INVALID_ARG_TYPE(t,"number",e)}function Y(e,t,n){if(Math.floor(e)!==e)throw X(e,n),new z.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new z.ERR_BUFFER_OUT_OF_BOUNDS;throw new z.ERR_OUT_OF_RANGE(n||"offset",">= ".concat(n?1:0," and <= ").concat(t),e)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)}),TypeError),U("ERR_OUT_OF_RANGE",(function(e,t,n){var r='The value of "'.concat(e,'" is out of range.'),i=n;return Number.isInteger(n)&&Math.abs(n)>Math.pow(2,32)?i=K(String(n)):"bigint"==typeof n&&(i=String(n),(n>Math.pow(BigInt(2),BigInt(32))||n<-Math.pow(BigInt(2),BigInt(32)))&&(i=K(i)),i+="n"),r+=" It must be ".concat(t,". Received ").concat(i)}),RangeError);var Q=/[^+/0-9A-Za-z-_]/g;function Z(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function J(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(Q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function $(e,t,n,r){var i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function ee(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function te(e){return e!=e}var ne=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)t[r+i]=e[n]+e[i];return t}();function re(e){return"undefined"==typeof BigInt?ie:e}function ie(){throw new Error("BigInt not supported")}},7187:function(e){"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}v(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&v(e,"error",t,{once:!0})}(e,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,n,r){var i,o,a,u;if(s(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=l(e))>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,u=c,console&&console.warn&&console.warn(u)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=c.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):p(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function v(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var u=l.length,c=p(l,u);for(n=0;n<u;++n)r(c[n],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return s(t),this.on(e,d(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,d(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,a;if(s(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},645:function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,u=l>>1,c=-7,d=n?i-1:0,h=n?-1:1,f=e[t+d];for(d+=h,o=f&(1<<-c)-1,f>>=-c,c+=s;c>0;o=256*o+e[t+d],d+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;c>0;a=256*a+e[t+d],d+=h,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),o-=u}return(f?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,l,u=8*o-i-1,c=(1<<u)-1,d=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=c?(s=0,a=c):a+d>=1?(s=(t*l-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+f]=255&s,f+=p,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[n+f]=255&a,f+=p,a/=256,u-=8);e[n+f-p]|=128*v}},5705:function(e,t,n){"use strict";var r,i,o=n.g.MutationObserver||n.g.WebKitMutationObserver;if(o){var a=0,s=new o(d),l=n.g.document.createTextNode("");s.observe(l,{characterData:!0}),r=function(){l.data=a=++a%2}}else if(n.g.setImmediate||void 0===n.g.MessageChannel)r="document"in n.g&&"onreadystatechange"in n.g.document.createElement("script")?function(){var e=n.g.document.createElement("script");e.onreadystatechange=function(){d(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},n.g.document.documentElement.appendChild(e)}:function(){setTimeout(d,0)};else{var u=new n.g.MessageChannel;u.port1.onmessage=d,r=function(){u.port2.postMessage(0)}}var c=[];function d(){var e,t;i=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}i=!1}e.exports=function(e){1!==c.push(e)||i||r()}},5717:function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},8458:function(e,t,n){"use strict";var r=n(8910),i=n(3790),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(e){for(var t,n,i,a,s,l,u,c=[],d=0,h=e.length,f=h,p="string"!==r.getTypeOf(e);d<e.length;)f=h-d,p?(t=e[d++],n=d<h?e[d++]:0,i=d<h?e[d++]:0):(t=e.charCodeAt(d++),n=d<h?e.charCodeAt(d++):0,i=d<h?e.charCodeAt(d++):0),a=t>>2,s=(3&t)<<4|n>>4,l=f>1?(15&n)<<2|i>>6:64,u=f>2?63&i:64,c.push(o.charAt(a)+o.charAt(s)+o.charAt(l)+o.charAt(u));return c.join("")},t.decode=function(e){var t,n,r,a,s,l,u=0,c=0,d="data:";if(e.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var h,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===o.charAt(64)&&f--,e.charAt(e.length-2)===o.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=i.uint8array?new Uint8Array(0|f):new Array(0|f);u<e.length;)t=o.indexOf(e.charAt(u++))<<2|(a=o.indexOf(e.charAt(u++)))>>4,n=(15&a)<<4|(s=o.indexOf(e.charAt(u++)))>>2,r=(3&s)<<6|(l=o.indexOf(e.charAt(u++))),h[c++]=t,64!==s&&(h[c++]=n),64!==l&&(h[c++]=r);return h}},7326:function(e,t,n){"use strict";var r=n(8565),i=n(5301),o=n(2541),a=n(5977);function s(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}s.prototype={getContentWorker:function(){var e=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,n){return e.pipe(new o).pipe(new a("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},e.exports=s},1678:function(e,t,n){"use strict";var r=n(3718);t.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},t.DEFLATE=n(1033)},6988:function(e,t,n){"use strict";var r=n(8910),i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,n,r){var o=i,a=0+n;e^=-1;for(var s=0;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}(0|t,e,e.length):function(e,t,n,r){var o=i,a=0+n;e^=-1;for(var s=0;s<a;s++)e=e>>>8^o[255&(e^t.charCodeAt(s))];return-1^e}(0|t,e,e.length):0}},6032:function(e,t){"use strict";t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!0,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},8565:function(e,t,n){"use strict";var r;r="undefined"!=typeof Promise?Promise:n(3389),e.exports={Promise:r}},1033:function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=n(9591),o=n(8910),a=n(3718),s=r?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}t.magic="\b\0",o.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(s,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},t.compressWorker=function(e){return new l("Deflate",e)},t.uncompressWorker=function(){return new l("Inflate",{})}},4979:function(e,t,n){"use strict";var r=n(8910),i=n(3718),o=n(3600),a=n(6988),s=n(1141),l=function(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r},u=function(e,t,n,i,u,c){var d,h,f=e.file,p=e.compression,v=c!==o.utf8encode,g=r.transformTo("string",c(f.name)),m=r.transformTo("string",o.utf8encode(f.name)),y=f.comment,w=r.transformTo("string",c(y)),b=r.transformTo("string",o.utf8encode(y)),C=m.length!==f.name.length,S=b.length!==y.length,E="",k="",x="",T=f.dir,R=f.date,A={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(A.crc32=e.crc32,A.compressedSize=e.compressedSize,A.uncompressedSize=e.uncompressedSize);var _=0;t&&(_|=8),v||!C&&!S||(_|=2048);var O,D,N=0,P=0;T&&(N|=16),"UNIX"===u?(P=798,N|=(D=O=f.unixPermissions,O||(D=T?16893:33204),(65535&D)<<16)):(P=20,N|=63&(f.dosPermissions||0)),d=R.getUTCHours(),d<<=6,d|=R.getUTCMinutes(),d<<=5,d|=R.getUTCSeconds()/2,h=R.getUTCFullYear()-1980,h<<=4,h|=R.getUTCMonth()+1,h<<=5,h|=R.getUTCDate(),C&&(k=l(1,1)+l(a(g),4)+m,E+="up"+l(k.length,2)+k),S&&(x=l(1,1)+l(a(w),4)+b,E+="uc"+l(x.length,2)+x);var F="";return F+="\n\0",F+=l(_,2),F+=p.magic,F+=l(d,2),F+=l(h,2),F+=l(A.crc32,4),F+=l(A.compressedSize,4),F+=l(A.uncompressedSize,4),F+=l(g.length,2),F+=l(E.length,2),{fileRecord:s.LOCAL_FILE_HEADER+F+g+E,dirRecord:s.CENTRAL_FILE_HEADER+l(P,2)+F+l(w.length,2)+"\0\0\0\0"+l(N,4)+l(i,4)+g+E+w}},c=function(e){return s.DATA_DESCRIPTOR+l(e.crc32,4)+l(e.compressedSize,4)+l(e.uncompressedSize,4)};function d(e,t,n,r){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(d,i),d.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,i.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},d.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=u(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=u(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:c(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,i=function(e,t,n,i,o){var a=r.transformTo("string",o(i));return s.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(e,2)+l(e,2)+l(t,4)+l(n,4)+l(a.length,2)+a}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},d.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(e){var t=this._sources;if(!i.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},d.prototype.lock=function(){i.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},e.exports=d},7834:function(e,t,n){"use strict";var r=n(1678),i=n(4979);t.generateWorker=function(e,t,n){var o=new i(t.streamFiles,n,t.platform,t.encodeFileName),a=0;try{e.forEach((function(e,n){a++;var i=function(e,t){var n=e||t,i=r[n];if(!i)throw new Error(n+" is not a valid compression method !");return i}(n.options.compression,t.compression),s=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,u=n.date;n._compressWorker(i,s).withStreamInfo("file",{name:e,dir:l,date:u,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(o)})),o.entriesCount=a}catch(e){o.error(e)}return o}},6085:function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}r.prototype=n(7132),r.prototype.loadAsync=n(1062),r.support=n(3790),r.defaults=n(6032),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=n(8565),e.exports=r},1062:function(e,t,n){"use strict";var r=n(8910),i=n(8565),o=n(3600),a=n(6624),s=n(2541),l=n(2182);function u(e){return new i.Promise((function(t,n){var r=e.decompressed.getContentWorker().pipe(new s);r.on("error",(function(e){n(e)})).on("end",(function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}e.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var n=new a(t);return n.load(e),n})).then((function(e){var n=[i.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var o=0;o<r.length;o++)n.push(u(r[o]));return i.Promise.all(n)})).then((function(e){for(var i=e.shift(),o=i.files,a=0;a<o.length;a++){var s=o[a],l=s.fileNameStr,u=r.resolve(s.fileNameStr);n.file(u,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(n.file(u).unsafeOriginalName=l)}return i.zipComment.length&&(n.comment=i.zipComment),n}))}},2182:function(e){"use strict";e.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},660:function(e,t,n){"use strict";var r=n(8910),i=n(3718);function o(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(o,i),o.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=o},1220:function(e,t,n){"use strict";var r=n(749).Readable;function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on("data",(function(e,t){i.push(e)||i._helper.pause(),n&&n(t)})).on("error",(function(e){i.emit("error",e)})).on("end",(function(){i.push(null)}))}n(8910).inherits(i,r),i.prototype._read=function(){this._helper.resume()},e.exports=i},7132:function(e,t,n){"use strict";var r=n(3600),i=n(8910),o=n(3718),a=n(1285),s=n(6032),l=n(7326),u=n(6859),c=n(7834),d=n(2182),h=n(660),f=function(e,t,n){var r,a=i.getTypeOf(t),c=i.extend(n||{},s);c.date=c.date||new Date,null!==c.compression&&(c.compression=c.compression.toUpperCase()),"string"==typeof c.unixPermissions&&(c.unixPermissions=parseInt(c.unixPermissions,8)),c.unixPermissions&&16384&c.unixPermissions&&(c.dir=!0),c.dosPermissions&&16&c.dosPermissions&&(c.dir=!0),c.dir&&(e=v(e)),c.createFolders&&(r=p(e))&&g.call(this,r,!0);var f,m="string"===a&&!1===c.binary&&!1===c.base64;n&&void 0!==n.binary||(c.binary=!m),(t instanceof l&&0===t.uncompressedSize||c.dir||!t||0===t.length)&&(c.base64=!1,c.binary=!0,t="",c.compression="STORE",a="string"),f=t instanceof l||t instanceof o?t:d.isNode&&d.isStream(t)?new h(e,t):i.prepareContent(e,t,c.binary,c.optimizedBinaryString,c.base64);var y=new u(e,f,c);this.files[e]=y},p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},v=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:s.createFolders,e=v(e),this.files[e]||f.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function m(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach((function(n,r){e(n,r)&&t.push(r)})),t},file:function(e,t,n){if(1===arguments.length){if(m(e)){var r=e;return this.filter((function(e,t){return!t.dir&&r.test(e)}))}var i=this.files[this.root+e];return i&&!i.dir?i:null}return e=this.root+e,f.call(this,e,t,n),this},folder:function(e){if(!e)return this;if(m(e))return this.filter((function(t,n){return n.dir&&e.test(t)}));var t=this.root+e,n=g.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter((function(t,n){return n.name.slice(0,e.length)===e})),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=i.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");i.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var s=n.comment||this.comment||"";t=c.generateWorker(this,n,s)}catch(e){(t=new o("error")).error(e)}return new a(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};e.exports=y},749:function(e,t,n){"use strict";e.exports=n(2830)},2370:function(e,t,n){"use strict";var r=n(8542);function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}n(8910).inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===t&&this.data[o+1]===n&&this.data[o+2]===r&&this.data[o+3]===i)return o-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&n===o[1]&&r===o[2]&&i===o[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=i},8542:function(e,t,n){"use strict";var r=n(8910);function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},e.exports=i},9583:function(e,t,n){"use strict";var r=n(414);function i(e){r.call(this,e)}n(8910).inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=i},9226:function(e,t,n){"use strict";var r=n(8542);function i(e){r.call(this,e)}n(8910).inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=i},414:function(e,t,n){"use strict";var r=n(2370);function i(e){r.call(this,e)}n(8910).inherits(i,r),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=i},8435:function(e,t,n){"use strict";var r=n(8910),i=n(3790),o=n(2370),a=n(9226),s=n(9583),l=n(414);e.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new s(e):i.uint8array?new l(r.transformTo("uint8array",e)):new o(r.transformTo("array",e)):new a(e)}},1141:function(e,t){"use strict";t.LOCAL_FILE_HEADER="PK\x03\x04",t.CENTRAL_FILE_HEADER="PK\x01\x02",t.CENTRAL_DIRECTORY_END="PK\x05\x06",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",t.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",t.DATA_DESCRIPTOR="PK\x07\b"},4293:function(e,t,n){"use strict";var r=n(3718),i=n(8910);function o(e){r.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(o,r),o.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},e.exports=o},2541:function(e,t,n){"use strict";var r=n(3718),i=n(6988);function o(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n(8910).inherits(o,r),o.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},e.exports=o},5977:function(e,t,n){"use strict";var r=n(8910),i=n(3718);function o(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(o,i),o.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},e.exports=o},5301:function(e,t,n){"use strict";var r=n(8910),i=n(3718);function o(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}r.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=o},3718:function(e){"use strict";function t(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}t.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},e.exports=t},1285:function(e,t,n){"use strict";var r=n(8910),i=n(4293),o=n(3718),a=n(8458),s=n(3790),l=n(8565),u=null;if(s.nodestream)try{u=n(1220)}catch(e){}function c(e,t,n){var a=t;switch(t){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=t,this._mimeType=n,r.checkSupport(a),this._worker=e.pipe(new i(a)),e.lock()}catch(e){this._worker=new o("error"),this._worker.error(e)}}c.prototype={accumulate:function(e){return t=this,n=e,new l.Promise((function(e,i){var o=[],s=t._internalType,l=t._outputType,u=t._mimeType;t.on("data",(function(e,t){o.push(e),n&&n(t)})).on("error",(function(e){o=[],i(e)})).on("end",(function(){try{var t=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return a.encode(t);default:return r.transformTo(e,t)}}(l,function(e,t){var n,r=0,i=null,o=0;for(n=0;n<t.length;n++)o+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(o),n=0;n<t.length;n++)i.set(t[n],r),r+=t[n].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,o),u);e(t)}catch(e){i(e)}o=[]})).resume()}));var t,n},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,(function(e){t.call(n,e.data,e.meta)})):this._worker.on(e,(function(){r.delay(t,arguments,n)})),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},e.exports=c},3790:function(e,t,n){"use strict";if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,t.nodebuffer="undefined"!=typeof Buffer,t.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)t.blob=!1;else{var r=new ArrayBuffer(0);try{t.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(r),t.blob=0===i.getBlob("application/zip").size}catch(e){t.blob=!1}}}try{t.nodestream=!!n(749).Readable}catch(e){t.nodestream=!1}},3600:function(e,t,n){"use strict";for(var r=n(8910),i=n(3790),o=n(2182),a=n(3718),s=new Array(256),l=0;l<256;l++)s[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;function u(){a.call(this,"utf-8 decode"),this.leftOver=null}function c(){a.call(this,"utf-8 encode")}s[254]=s[254]=1,t.utf8encode=function(e){return i.nodebuffer?o.newBufferFrom(e,"utf-8"):function(e){var t,n,r,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),a=0,o=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t}(e)},t.utf8decode=function(e){return i.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,i,o,a=e.length,l=new Array(2*a);for(n=0,t=0;t<a;)if((i=e[t++])<128)l[n++]=i;else if((o=s[i])>4)l[n++]=65533,t+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&t<a;)i=i<<6|63&e[t++],o--;o>1?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),r.applyFromCharCode(l)}(e=r.transformTo(i.uint8array?"uint8array":"array",e))},r.inherits(u,a),u.prototype.processChunk=function(e){var n=r.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var o=n;(n=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),n.set(o,this.leftOver.length)}else n=this.leftOver.concat(n);this.leftOver=null}var a=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}(n),l=n;a!==n.length&&(i.uint8array?(l=n.subarray(0,a),this.leftOver=n.subarray(a,n.length)):(l=n.slice(0,a),this.leftOver=n.slice(a,n.length))),this.push({data:t.utf8decode(l),meta:e.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:t.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},t.Utf8DecodeWorker=u,r.inherits(c,a),c.prototype.processChunk=function(e){this.push({data:t.utf8encode(e.data),meta:e.meta})},t.Utf8EncodeWorker=c},8910:function(e,t,n){"use strict";var r=n(3790),i=n(8458),o=n(2182),a=n(8565);function s(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}n(4889),t.newBlob=function(e,n){t.checkSupport("blob");try{return new Blob([e],{type:n})}catch(t){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(n)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(e,t,n){var r=[],i=0,o=e.length;if(o<=n)return String.fromCharCode.apply(null,e);for(;i<o;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,o)))):r.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,o)))),i+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(e){return!1}}()}};function c(e){var n=65536,r=t.getTypeOf(e),i=!0;if("uint8array"===r?i=u.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=u.applyCanBeUsed.nodebuffer),i)for(;n>1;)try{return u.stringifyByChunk(e,r,n)}catch(e){n=Math.floor(n/2)}return u.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}t.applyFromCharCode=c;var h={};h.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,o.allocBuffer(e.length))}},h.array={string:c,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(e)}},h.arraybuffer={string:function(e){return c(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return o.newBufferFrom(e)}},h.nodebuffer={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:s},t.transformTo=function(e,n){if(n||(n=""),!e)return n;t.checkSupport(e);var r=t.getTypeOf(n);return h[r][e](n)},t.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var i=t[r];"."===i||""===i&&0!==r&&r!==t.length-1||(".."===i?n.pop():n.push(i))}return n.join("/")},t.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&o.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},t.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},t.delay=function(e,t,n){setImmediate((function(){e.apply(n||null,t||[])}))},t.inherits=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n},t.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},t.prepareContent=function(e,n,o,s,u){return a.Promise.resolve(n).then((function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new a.Promise((function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)})):e})).then((function(n){var c,d=t.getTypeOf(n);return d?("arraybuffer"===d?n=t.transformTo("uint8array",n):"string"===d&&(u?n=i.decode(n):o&&!0!==s&&(n=l(c=n,r.uint8array?new Uint8Array(c.length):new Array(c.length)))),n):a.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},6624:function(e,t,n){"use strict";var r=n(8435),i=n(8910),o=n(1141),a=n(9392),s=n(3790);function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",n=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(r>0)this.isSignature(t,o.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=l},9392:function(e,t,n){"use strict";var r=n(8435),i=n(8910),o=n(7326),a=n(6988),s=n(3600),l=n(1678),u=n(3790);function c(e,t){this.options=e,this.loadOptions=t}c.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,r,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(i)},handleUTF8:function(){var e=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var o=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},e.exports=c},6859:function(e,t,n){"use strict";var r=n(1285),i=n(5301),o=n(3600),a=n(7326),s=n(3718),l=function(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}};l.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var i="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!i&&(t=t.pipe(new o.Utf8EncodeWorker)),!a&&i&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(e){(t=new s("error")).error(e)}return new r(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof a&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new o.Utf8EncodeWorker)),a.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof s?this._data:new i(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<u.length;d++)l.prototype[u[d]]=c;e.exports=l},3389:function(e,t,n){"use strict";var r=n(5705);function i(){}var o={},a=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&f(this,e)}function c(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return o.reject(e,t)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function i(t){n||(n=!0,o.resolve(e,t))}var a=p((function(){t(i,r)}));"error"===a.status&&r(a.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}e.exports=u,u.prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){throw n}))}))},u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(i);return this.state!==l?d(n,this.state===s?e:t,this.outcome):this.queue.push(new c(n,e,t)),n},c.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},c.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},c.prototype.callRejected=function(e){o.reject(this.promise,e)},c.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=p(h,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)f(e,r);else{e.state=s,e.outcome=t;for(var i=-1,a=e.queue.length;++i<a;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},u.resolve=function(e){return e instanceof this?e:o.resolve(new this(i),e)},u.reject=function(e){var t=new this(i);return o.reject(t,e)},u.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a=new Array(n),s=0,l=-1,u=new this(i);++l<n;)c(e[l],l);return u;function c(e,i){t.resolve(e).then((function(e){a[i]=e,++s!==n||r||(r=!0,o.resolve(u,a))}),(function(e){r||(r=!0,o.reject(u,e))}))}},u.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var r,a=-1,s=new this(i);++a<t;)r=e[a],this.resolve(r).then((function(e){n||(n=!0,o.resolve(s,e))}),(function(e){n||(n=!0,o.reject(s,e))}));return s}},9591:function(e,t,n){"use strict";var r={};(0,n(4236).assign)(r,n(4555),n(8843),n(1619)),e.exports=r},4555:function(e,t,n){"use strict";var r=n(405),i=n(4236),o=n(9373),a=n(8898),s=n(2292),l=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(a[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var c;if(c="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=r.deflateSetDictionary(this.strm,c)))throw new Error(a[n]);this._dict_set=!0}}function c(e,t){var n=new u(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}u.prototype.push=function(e,t){var n,a,s=this.strm,u=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(u),s.next_out=0,s.avail_out=u),1!==(n=r.deflate(s,a))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==n);return 4===a?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==a||(this.onEnd(0),s.avail_out=0,!0)},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=u,t.deflate=c,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,c(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,c(e,t)}},8843:function(e,t,n){"use strict";var r=n(7948),i=n(4236),o=n(9373),a=n(1619),s=n(8898),l=n(2292),u=n(2401),c=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==a.Z_OK)throw new Error(s[n]);if(this.header=new u,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=r.inflateSetDictionary(this.strm,t.dictionary))!==a.Z_OK))throw new Error(s[n])}function h(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}d.prototype.push=function(e,t){var n,s,l,u,d,h=this.strm,f=this.options.chunkSize,p=this.options.dictionary,v=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?h.input=o.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?h.input=new Uint8Array(e):h.input=e,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new i.Buf8(f),h.next_out=0,h.avail_out=f),(n=r.inflate(h,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&p&&(n=r.inflateSetDictionary(this.strm,p)),n===a.Z_BUF_ERROR&&!0===v&&(n=a.Z_OK,v=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),this.ended=!0,!1;h.next_out&&(0!==h.avail_out&&n!==a.Z_STREAM_END&&(0!==h.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(h.output,h.next_out),u=h.next_out-l,d=o.buf2string(h.output,l),h.next_out=u,h.avail_out=f-u,u&&i.arraySet(h.output,h.output,l,u,0),this.onData(d)):this.onData(i.shrinkBuf(h.output,h.next_out)))),0===h.avail_in&&0===h.avail_out&&(v=!0)}while((h.avail_in>0||0===h.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),h.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=d,t.inflate=h,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},t.ungzip=h},4236:function(e,t){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){var t,n,r,i,o,a;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(a=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)o=e[t],a.set(o,i),i+=o.length;return a}},o={arraySet:function(e,t,n,r,i){for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(n)},9373:function(e,t,n){"use strict";var r=n(4236),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new r.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n}a[254]=a[254]=1,t.string2buf=function(e){var t,n,i,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),a=0,o=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},t.buf2string=function(e,t){var n,r,i,o,s=t||e.length,u=new Array(2*s);for(r=0,n=0;n<s;)if((i=e[n++])<128)u[r++]=i;else if((o=a[i])>4)u[r++]=65533,n+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&n<s;)i=i<<6|63&e[n++],o--;o>1?u[r++]=65533:i<65536?u[r++]=i:(i-=65536,u[r++]=55296|i>>10&1023,u[r++]=56320|1023&i)}return l(u,r)},t.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+a[e[n]]>t?n:t}},6069:function(e){"use strict";e.exports=function(e,t,n,r){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{o=o+(i=i+t[r++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16|0}},1619:function(e){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},2869:function(e){"use strict";var t=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,n,r,i){var o=t,a=i+r;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^n[s])];return-1^e}},405:function(e,t,n){"use strict";var r,i=n(4236),o=n(342),a=n(6069),s=n(2869),l=n(8898),u=-2,c=258,d=262,h=103,f=113,p=666;function v(e,t){return e.msg=l[t],t}function g(e){return(e<<1)-(e>4?9:0)}function m(e){for(var t=e.length;--t>=0;)e[t]=0}function y(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function w(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,y(e.strm)}function b(e,t){e.pending_buf[e.pending++]=t}function C(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function S(e,t){var n,r,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-d?e.strstart-(e.w_size-d):0,u=e.window,h=e.w_mask,f=e.prev,p=e.strstart+c,v=u[o+a-1],g=u[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(n=t)+a]===g&&u[n+a-1]===v&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do{}while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<p);if(r=c-(p-o),o=p-c,r>a){if(e.match_start=t,a=r,r>=s)break;v=u[o+a-1],g=u[o+a]}}}while((t=f[t&h])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function E(e){var t,n,r,o,l,u,c,h,f,p,v=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=v+(v-d)){i.arraySet(e.window,e.window,v,v,0),e.match_start-=v,e.strstart-=v,e.block_start-=v,t=n=e.hash_size;do{r=e.head[--t],e.head[t]=r>=v?r-v:0}while(--n);t=n=v;do{r=e.prev[--t],e.prev[t]=r>=v?r-v:0}while(--n);o+=v}if(0===e.strm.avail_in)break;if(u=e.strm,c=e.window,h=e.strstart+e.lookahead,f=o,p=void 0,(p=u.avail_in)>f&&(p=f),n=0===p?0:(u.avail_in-=p,i.arraySet(c,u.input,u.next_in,p,h),1===u.state.wrap?u.adler=a(u.adler,c,p,h):2===u.state.wrap&&(u.adler=s(u.adler,c,p,h)),u.next_in+=p,u.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<d&&0!==e.strm.avail_in)}function k(e,t){for(var n,r;;){if(e.lookahead<d){if(E(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-d&&(e.match_length=S(e,n)),e.match_length>=3)if(r=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(w(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(w(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(w(e,!1),0===e.strm.avail_out)?1:2}function x(e,t){for(var n,r,i;;){if(e.lookahead<d){if(E(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-d&&(e.match_length=S(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(w(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=o._tr_tally(e,0,e.window[e.strstart-1]))&&w(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(w(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(w(e,!1),0===e.strm.avail_out)?1:2}function T(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function R(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),m(this.dyn_ltree),m(this.dyn_dtree),m(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),m(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),m(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function A(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:f,e.adler=2===t.wrap?0:1,t.last_flush=0,o._tr_init(t),0):v(e,u)}function _(e){var t,n=A(e);return 0===n&&((t=e.state).window_size=2*t.w_size,m(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function O(e,t,n,r,o,a){if(!e)return u;var s=1;if(-1===t&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),o<1||o>9||8!==n||r<8||r>15||t<0||t>9||a<0||a>4)return v(e,u);8===r&&(r=9);var l=new R;return e.state=l,l.strm=e,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=n,_(e)}r=[new T(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(E(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,w(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-d&&(w(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(w(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(w(e,!1),e.strm.avail_out),1)})),new T(4,4,8,4,k),new T(4,5,16,8,k),new T(4,6,32,32,k),new T(4,4,16,16,x),new T(8,16,32,32,x),new T(8,16,128,128,x),new T(8,32,128,256,x),new T(32,128,258,1024,x),new T(32,258,258,4096,x)],t.deflateInit=function(e,t){return O(e,t,8,15,8,0)},t.deflateInit2=O,t.deflateReset=_,t.deflateResetKeep=A,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?u:(e.state.gzhead=t,0):u},t.deflate=function(e,t){var n,i,a,l;if(!e||!e.state||t>5||t<0)return e?v(e,u):u;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||i.status===p&&4!==t)return v(e,0===e.avail_out?-5:u);if(i.strm=e,n=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,b(i,31),b(i,139),b(i,8),i.gzhead?(b(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),b(i,255&i.gzhead.time),b(i,i.gzhead.time>>8&255),b(i,i.gzhead.time>>16&255),b(i,i.gzhead.time>>24&255),b(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),b(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(b(i,255&i.gzhead.extra.length),b(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(b(i,0),b(i,0),b(i,0),b(i,0),b(i,0),b(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),b(i,3),i.status=f);else{var d=8+(i.w_bits-8<<4)<<8;d|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(d|=32),d+=31-d%31,i.status=f,C(i,d),0!==i.strstart&&(C(i,e.adler>>>16),C(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),y(e),a=i.pending,i.pending!==i.pending_buf_size));)b(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),y(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,b(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),y(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,b(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.status=h)}else i.status=h;if(i.status===h&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&y(e),i.pending+2<=i.pending_buf_size&&(b(i,255&e.adler),b(i,e.adler>>8&255),e.adler=0,i.status=f)):i.status=f),0!==i.pending){if(y(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&g(t)<=g(n)&&4!==t)return v(e,-5);if(i.status===p&&0!==e.avail_in)return v(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&i.status!==p){var S=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(E(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(w(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(w(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(w(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var n,r,i,a,s=e.window;;){if(e.lookahead<=c){if(E(e),e.lookahead<=c&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=s[i=e.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){a=e.strstart+c;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<a);e.match_length=c-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(w(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(w(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(w(e,!1),0===e.strm.avail_out)?1:2}(i,t):r[i.level].func(i,t);if(3!==S&&4!==S||(i.status=p),1===S||3===S)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===S&&(1===t?o._tr_align(i):5!==t&&(o._tr_stored_block(i,0,0,!1),3===t&&(m(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),y(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(b(i,255&e.adler),b(i,e.adler>>8&255),b(i,e.adler>>16&255),b(i,e.adler>>24&255),b(i,255&e.total_in),b(i,e.total_in>>8&255),b(i,e.total_in>>16&255),b(i,e.total_in>>24&255)):(C(i,e.adler>>>16),C(i,65535&e.adler)),y(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==h&&t!==f&&t!==p?v(e,u):(e.state=null,t===f?v(e,-3):0):u},t.deflateSetDictionary=function(e,t){var n,r,o,s,l,c,d,h,f=t.length;if(!e||!e.state)return u;if(2===(s=(n=e.state).wrap)||1===s&&42!==n.status||n.lookahead)return u;for(1===s&&(e.adler=a(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===s&&(m(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new i.Buf8(n.w_size),i.arraySet(h,t,f-n.w_size,n.w_size,0),t=h,f=n.w_size),l=e.avail_in,c=e.next_in,d=e.input,e.avail_in=f,e.next_in=0,e.input=t,E(n);n.lookahead>=3;){r=n.strstart,o=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--o);n.strstart=r,n.lookahead=2,E(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=c,e.input=d,e.avail_in=l,n.wrap=s,0},t.deflateInfo="pako deflate (from Nodeca project)"},2401:function(e){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},4264:function(e){"use strict";e.exports=function(e,t){var n,r,i,o,a,s,l,u,c,d,h,f,p,v,g,m,y,w,b,C,S,E,k,x,T;n=e.state,r=e.next_in,x=e.input,i=r+(e.avail_in-5),o=e.next_out,T=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=n.dmax,u=n.wsize,c=n.whave,d=n.wnext,h=n.window,f=n.hold,p=n.bits,v=n.lencode,g=n.distcode,m=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{p<15&&(f+=x[r++]<<p,p+=8,f+=x[r++]<<p,p+=8),w=v[f&m];t:for(;;){if(f>>>=b=w>>>24,p-=b,0==(b=w>>>16&255))T[o++]=65535&w;else{if(!(16&b)){if(0==(64&b)){w=v[(65535&w)+(f&(1<<b)-1)];continue t}if(32&b){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}C=65535&w,(b&=15)&&(p<b&&(f+=x[r++]<<p,p+=8),C+=f&(1<<b)-1,f>>>=b,p-=b),p<15&&(f+=x[r++]<<p,p+=8,f+=x[r++]<<p,p+=8),w=g[f&y];n:for(;;){if(f>>>=b=w>>>24,p-=b,!(16&(b=w>>>16&255))){if(0==(64&b)){w=g[(65535&w)+(f&(1<<b)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(S=65535&w,p<(b&=15)&&(f+=x[r++]<<p,(p+=8)<b&&(f+=x[r++]<<p,p+=8)),(S+=f&(1<<b)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=b,p-=b,S>(b=o-a)){if((b=S-b)>c&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(E=0,k=h,0===d){if(E+=u-b,b<C){C-=b;do{T[o++]=h[E++]}while(--b);E=o-S,k=T}}else if(d<b){if(E+=u+d-b,(b-=d)<C){C-=b;do{T[o++]=h[E++]}while(--b);if(E=0,d<C){C-=b=d;do{T[o++]=h[E++]}while(--b);E=o-S,k=T}}}else if(E+=d-b,b<C){C-=b;do{T[o++]=h[E++]}while(--b);E=o-S,k=T}for(;C>2;)T[o++]=k[E++],T[o++]=k[E++],T[o++]=k[E++],C-=3;C&&(T[o++]=k[E++],C>1&&(T[o++]=k[E++]))}else{E=o-S;do{T[o++]=T[E++],T[o++]=T[E++],T[o++]=T[E++],C-=3}while(C>2);C&&(T[o++]=T[E++],C>1&&(T[o++]=T[E++]))}break}}break}}while(r<i&&o<s);r-=C=p>>3,f&=(1<<(p-=C<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=o<s?s-o+257:257-(o-s),n.hold=f,n.bits=p}},7948:function(e,t,n){"use strict";var r=n(4236),i=n(6069),o=n(2869),a=n(4264),s=n(9241),l=-2,u=12,c=30;function d(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function h(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):l}function p(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,f(e)):l}function v(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?l:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,p(e))):l}function g(e,t){var n,r;return e?(r=new h,e.state=r,r.window=null,0!==(n=v(e,t))&&(e.state=null),n):l}var m,y,w=!0;function b(e){if(w){var t;for(m=new r.Buf32(512),y=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,m,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,y,0,e.work,{bits:5}),w=!1}e.lencode=m,e.lenbits=9,e.distcode=y,e.distbits=5}function C(e,t,n,i){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new r.Buf8(a.wsize)),i>=a.wsize?(r.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>i&&(o=i),r.arraySet(a.window,t,n-i,o,a.wnext),(i-=o)?(r.arraySet(a.window,t,n-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}t.inflateReset=p,t.inflateReset2=v,t.inflateResetKeep=f,t.inflateInit=function(e){return g(e,15)},t.inflateInit2=g,t.inflate=function(e,t){var n,h,f,p,v,g,m,y,w,S,E,k,x,T,R,A,_,O,D,N,P,F,I,L,M=0,G=new r.Buf8(4),B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;(n=e.state).mode===u&&(n.mode=13),v=e.next_out,f=e.output,m=e.avail_out,p=e.next_in,h=e.input,g=e.avail_in,y=n.hold,w=n.bits,S=g,E=m,F=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;w<16;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}if(2&n.wrap&&35615===y){n.check=0,G[0]=255&y,G[1]=y>>>8&255,n.check=o(n.check,G,2,0),y=0,w=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",n.mode=c;break}if(8!=(15&y)){e.msg="unknown compression method",n.mode=c;break}if(w-=4,P=8+(15&(y>>>=4)),0===n.wbits)n.wbits=P;else if(P>n.wbits){e.msg="invalid window size",n.mode=c;break}n.dmax=1<<P,e.adler=n.check=1,n.mode=512&y?10:u,y=0,w=0;break;case 2:for(;w<16;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}if(n.flags=y,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=c;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=c;break}n.head&&(n.head.text=y>>8&1),512&n.flags&&(G[0]=255&y,G[1]=y>>>8&255,n.check=o(n.check,G,2,0)),y=0,w=0,n.mode=3;case 3:for(;w<32;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}n.head&&(n.head.time=y),512&n.flags&&(G[0]=255&y,G[1]=y>>>8&255,G[2]=y>>>16&255,G[3]=y>>>24&255,n.check=o(n.check,G,4,0)),y=0,w=0,n.mode=4;case 4:for(;w<16;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}n.head&&(n.head.xflags=255&y,n.head.os=y>>8),512&n.flags&&(G[0]=255&y,G[1]=y>>>8&255,n.check=o(n.check,G,2,0)),y=0,w=0,n.mode=5;case 5:if(1024&n.flags){for(;w<16;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}n.length=y,n.head&&(n.head.extra_len=y),512&n.flags&&(G[0]=255&y,G[1]=y>>>8&255,n.check=o(n.check,G,2,0)),y=0,w=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((k=n.length)>g&&(k=g),k&&(n.head&&(P=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,h,p,k,P)),512&n.flags&&(n.check=o(n.check,h,k,p)),g-=k,p+=k,n.length-=k),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===g)break e;k=0;do{P=h[p+k++],n.head&&P&&n.length<65536&&(n.head.name+=String.fromCharCode(P))}while(P&&k<g);if(512&n.flags&&(n.check=o(n.check,h,k,p)),g-=k,p+=k,P)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===g)break e;k=0;do{P=h[p+k++],n.head&&P&&n.length<65536&&(n.head.comment+=String.fromCharCode(P))}while(P&&k<g);if(512&n.flags&&(n.check=o(n.check,h,k,p)),g-=k,p+=k,P)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;w<16;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}if(y!==(65535&n.check)){e.msg="header crc mismatch",n.mode=c;break}y=0,w=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=u;break;case 10:for(;w<32;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}e.adler=n.check=d(y),y=0,w=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=v,e.avail_out=m,e.next_in=p,e.avail_in=g,n.hold=y,n.bits=w,2;e.adler=n.check=1,n.mode=u;case u:if(5===t||6===t)break e;case 13:if(n.last){y>>>=7&w,w-=7&w,n.mode=27;break}for(;w<3;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}switch(n.last=1&y,w-=1,3&(y>>>=1)){case 0:n.mode=14;break;case 1:if(b(n),n.mode=20,6===t){y>>>=2,w-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=c}y>>>=2,w-=2;break;case 14:for(y>>>=7&w,w-=7&w;w<32;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",n.mode=c;break}if(n.length=65535&y,y=0,w=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(k=n.length){if(k>g&&(k=g),k>m&&(k=m),0===k)break e;r.arraySet(f,h,p,k,v),g-=k,p+=k,m-=k,v+=k,n.length-=k;break}n.mode=u;break;case 17:for(;w<14;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}if(n.nlen=257+(31&y),y>>>=5,w-=5,n.ndist=1+(31&y),y>>>=5,w-=5,n.ncode=4+(15&y),y>>>=4,w-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=c;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;w<3;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}n.lens[B[n.have++]]=7&y,y>>>=3,w-=3}for(;n.have<19;)n.lens[B[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,I={bits:n.lenbits},F=s(0,n.lens,0,19,n.lencode,0,n.work,I),n.lenbits=I.bits,F){e.msg="invalid code lengths set",n.mode=c;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;A=(M=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,_=65535&M,!((R=M>>>24)<=w);){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}if(_<16)y>>>=R,w-=R,n.lens[n.have++]=_;else{if(16===_){for(L=R+2;w<L;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}if(y>>>=R,w-=R,0===n.have){e.msg="invalid bit length repeat",n.mode=c;break}P=n.lens[n.have-1],k=3+(3&y),y>>>=2,w-=2}else if(17===_){for(L=R+3;w<L;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}w-=R,P=0,k=3+(7&(y>>>=R)),y>>>=3,w-=3}else{for(L=R+7;w<L;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}w-=R,P=0,k=11+(127&(y>>>=R)),y>>>=7,w-=7}if(n.have+k>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=c;break}for(;k--;)n.lens[n.have++]=P}}if(n.mode===c)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=c;break}if(n.lenbits=9,I={bits:n.lenbits},F=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,I),n.lenbits=I.bits,F){e.msg="invalid literal/lengths set",n.mode=c;break}if(n.distbits=6,n.distcode=n.distdyn,I={bits:n.distbits},F=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,I),n.distbits=I.bits,F){e.msg="invalid distances set",n.mode=c;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(g>=6&&m>=258){e.next_out=v,e.avail_out=m,e.next_in=p,e.avail_in=g,n.hold=y,n.bits=w,a(e,E),v=e.next_out,f=e.output,m=e.avail_out,p=e.next_in,h=e.input,g=e.avail_in,y=n.hold,w=n.bits,n.mode===u&&(n.back=-1);break}for(n.back=0;A=(M=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,_=65535&M,!((R=M>>>24)<=w);){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}if(A&&0==(240&A)){for(O=R,D=A,N=_;A=(M=n.lencode[N+((y&(1<<O+D)-1)>>O)])>>>16&255,_=65535&M,!(O+(R=M>>>24)<=w);){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}y>>>=O,w-=O,n.back+=O}if(y>>>=R,w-=R,n.back+=R,n.length=_,0===A){n.mode=26;break}if(32&A){n.back=-1,n.mode=u;break}if(64&A){e.msg="invalid literal/length code",n.mode=c;break}n.extra=15&A,n.mode=22;case 22:if(n.extra){for(L=n.extra;w<L;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}n.length+=y&(1<<n.extra)-1,y>>>=n.extra,w-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;A=(M=n.distcode[y&(1<<n.distbits)-1])>>>16&255,_=65535&M,!((R=M>>>24)<=w);){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}if(0==(240&A)){for(O=R,D=A,N=_;A=(M=n.distcode[N+((y&(1<<O+D)-1)>>O)])>>>16&255,_=65535&M,!(O+(R=M>>>24)<=w);){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}y>>>=O,w-=O,n.back+=O}if(y>>>=R,w-=R,n.back+=R,64&A){e.msg="invalid distance code",n.mode=c;break}n.offset=_,n.extra=15&A,n.mode=24;case 24:if(n.extra){for(L=n.extra;w<L;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}n.offset+=y&(1<<n.extra)-1,y>>>=n.extra,w-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=c;break}n.mode=25;case 25:if(0===m)break e;if(k=E-m,n.offset>k){if((k=n.offset-k)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=c;break}k>n.wnext?(k-=n.wnext,x=n.wsize-k):x=n.wnext-k,k>n.length&&(k=n.length),T=n.window}else T=f,x=v-n.offset,k=n.length;k>m&&(k=m),m-=k,n.length-=k;do{f[v++]=T[x++]}while(--k);0===n.length&&(n.mode=21);break;case 26:if(0===m)break e;f[v++]=n.length,m--,n.mode=21;break;case 27:if(n.wrap){for(;w<32;){if(0===g)break e;g--,y|=h[p++]<<w,w+=8}if(E-=m,e.total_out+=E,n.total+=E,E&&(e.adler=n.check=n.flags?o(n.check,f,E,v-E):i(n.check,f,E,v-E)),E=m,(n.flags?y:d(y))!==n.check){e.msg="incorrect data check",n.mode=c;break}y=0,w=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;w<32;){if(0===g)break e;g--,y+=h[p++]<<w,w+=8}if(y!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=c;break}y=0,w=0}n.mode=29;case 29:F=1;break e;case c:F=-3;break e;case 31:return-4;default:return l}return e.next_out=v,e.avail_out=m,e.next_in=p,e.avail_in=g,n.hold=y,n.bits=w,(n.wsize||E!==e.avail_out&&n.mode<c&&(n.mode<27||4!==t))&&C(e,e.output,e.next_out,E-e.avail_out)?(n.mode=31,-4):(S-=e.avail_in,E-=e.avail_out,e.total_in+=S,e.total_out+=E,n.total+=E,n.wrap&&E&&(e.adler=n.check=n.flags?o(n.check,f,E,e.next_out-E):i(n.check,f,E,e.next_out-E)),e.data_type=n.bits+(n.last?64:0)+(n.mode===u?128:0)+(20===n.mode||15===n.mode?256:0),(0===S&&0===E||4===t)&&0===F&&(F=-5),F)},t.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?l:(n.head=t,t.done=!1,0):l},t.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?l:11===n.mode&&i(1,t,r,0)!==n.check?-3:C(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,0):l},t.inflateInfo="pako inflate (from Nodeca project)"},9241:function(e,t,n){"use strict";var r=n(4236),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,n,l,u,c,d,h){var f,p,v,g,m,y,w,b,C,S=h.bits,E=0,k=0,x=0,T=0,R=0,A=0,_=0,O=0,D=0,N=0,P=null,F=0,I=new r.Buf16(16),L=new r.Buf16(16),M=null,G=0;for(E=0;E<=15;E++)I[E]=0;for(k=0;k<l;k++)I[t[n+k]]++;for(R=S,T=15;T>=1&&0===I[T];T--);if(R>T&&(R=T),0===T)return u[c++]=20971520,u[c++]=20971520,h.bits=1,0;for(x=1;x<T&&0===I[x];x++);for(R<x&&(R=x),O=1,E=1;E<=15;E++)if(O<<=1,(O-=I[E])<0)return-1;if(O>0&&(0===e||1!==T))return-1;for(L[1]=0,E=1;E<15;E++)L[E+1]=L[E]+I[E];for(k=0;k<l;k++)0!==t[n+k]&&(d[L[t[n+k]]++]=k);if(0===e?(P=M=d,y=19):1===e?(P=i,F-=257,M=o,G-=257,y=256):(P=a,M=s,y=-1),N=0,k=0,E=x,m=c,A=R,_=0,v=-1,g=(D=1<<R)-1,1===e&&D>852||2===e&&D>592)return 1;for(;;){w=E-_,d[k]<y?(b=0,C=d[k]):d[k]>y?(b=M[G+d[k]],C=P[F+d[k]]):(b=96,C=0),f=1<<E-_,x=p=1<<A;do{u[m+(N>>_)+(p-=f)]=w<<24|b<<16|C|0}while(0!==p);for(f=1<<E-1;N&f;)f>>=1;if(0!==f?(N&=f-1,N+=f):N=0,k++,0==--I[E]){if(E===T)break;E=t[n+d[k]]}if(E>R&&(N&g)!==v){for(0===_&&(_=R),m+=x,O=1<<(A=E-_);A+_<T&&!((O-=I[A+_])<=0);)A++,O<<=1;if(D+=1<<A,1===e&&D>852||2===e&&D>592)return 1;u[v=N&g]=R<<24|A<<16|m-c|0}}return 0!==N&&(u[m+N]=E-_<<24|64<<16|0),h.bits=R,0}},8898:function(e){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},342:function(e,t,n){"use strict";var r=n(4236);function i(e){for(var t=e.length;--t>=0;)e[t]=0}var o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],a=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);i(u);var c=new Array(60);i(c);var d=new Array(512);i(d);var h=new Array(256);i(h);var f=new Array(29);i(f);var p,v,g,m=new Array(30);function y(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function w(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function b(e){return e<256?d[e]:d[256+(e>>>7)]}function C(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function S(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,C(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function E(e,t,n){S(e,n[2*t],n[2*t+1])}function k(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function x(e,t,n){var r,i,o=new Array(16),a=0;for(r=1;r<=15;r++)o[r]=a=a+n[r-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=k(o[s]++,s))}}function T(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function R(e){e.bi_valid>8?C(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function A(e,t,n,r){var i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]}function _(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&A(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!A(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function O(e,t,n){var r,i,s,l,u=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*u]<<8|e.pending_buf[e.d_buf+2*u+1],i=e.pending_buf[e.l_buf+u],u++,0===r?E(e,i,t):(E(e,(s=h[i])+256+1,t),0!==(l=o[s])&&S(e,i-=f[s],l),E(e,s=b(--r),n),0!==(l=a[s])&&S(e,r-=m[s],l))}while(u<e.last_lit);E(e,256,t)}function D(e,t){var n,r,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<l;n++)0!==o[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=u,n=e.heap_len>>1;n>=1;n--)_(e,o,n);i=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],_(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*i]=o[2*n]+o[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=i,e.heap[1]=i++,_(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,o,a,s,l=t.dyn_tree,u=t.max_code,c=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,v=0;for(o=0;o<=15;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(o=l[2*l[2*(r=e.heap[n])+1]+1]+1)>p&&(o=p,v++),l[2*r+1]=o,r>u||(e.bl_count[o]++,a=0,r>=f&&(a=h[r-f]),s=l[2*r],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(c[2*r+1]+a)));if(0!==v){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,v-=2}while(v>0);for(o=p;0!==o;o--)for(r=e.bl_count[o];0!==r;)(i=e.heap[--n])>u||(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),r--)}}(e,t),x(o,u,e.bl_count)}function N(e,t,n){var r,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=t[2*(r+1)+1],++s<l&&i===a||(s<u?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4))}function P(e,t,n){var r,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),r=0;r<=n;r++)if(i=a,a=t[2*(r+1)+1],!(++s<l&&i===a)){if(s<u)do{E(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(E(e,i,e.bl_tree),s--),E(e,16,e.bl_tree),S(e,s-3,2)):s<=10?(E(e,17,e.bl_tree),S(e,s-3,3)):(E(e,18,e.bl_tree),S(e,s-11,7));s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4)}}i(m);var F=!1;function I(e,t,n,i){S(e,0+(i?1:0),3),function(e,t,n,i){R(e),C(e,n),C(e,~n),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}t._tr_init=function(e){F||(function(){var e,t,n,r,i,l=new Array(16);for(n=0,r=0;r<28;r++)for(f[r]=n,e=0;e<1<<o[r];e++)h[n++]=r;for(h[n-1]=r,i=0,r=0;r<16;r++)for(m[r]=i,e=0;e<1<<a[r];e++)d[i++]=r;for(i>>=7;r<30;r++)for(m[r]=i<<7,e=0;e<1<<a[r]-7;e++)d[256+i++]=r;for(t=0;t<=15;t++)l[t]=0;for(e=0;e<=143;)u[2*e+1]=8,e++,l[8]++;for(;e<=255;)u[2*e+1]=9,e++,l[9]++;for(;e<=279;)u[2*e+1]=7,e++,l[7]++;for(;e<=287;)u[2*e+1]=8,e++,l[8]++;for(x(u,287,l),e=0;e<30;e++)c[2*e+1]=5,c[2*e]=k(e,5);p=new y(u,o,257,286,15),v=new y(c,a,0,30,15),g=new y(new Array(0),s,0,19,7)}(),F=!0),e.l_desc=new w(e.dyn_ltree,p),e.d_desc=new w(e.dyn_dtree,v),e.bl_desc=new w(e.bl_tree,g),e.bi_buf=0,e.bi_valid=0,T(e)},t._tr_stored_block=I,t._tr_flush_block=function(e,t,n,r){var i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),D(e,e.l_desc),D(e,e.d_desc),a=function(e){var t;for(N(e,e.dyn_ltree,e.l_desc.max_code),N(e,e.dyn_dtree,e.d_desc.max_code),D(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?I(e,t,n,r):4===e.strategy||o===i?(S(e,2+(r?1:0),3),O(e,u,c)):(S(e,4+(r?1:0),3),function(e,t,n,r){var i;for(S(e,t-257,5),S(e,n-1,5),S(e,r-4,4),i=0;i<r;i++)S(e,e.bl_tree[2*l[i]+1],3);P(e,e.dyn_ltree,t-1),P(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),O(e,e.dyn_ltree,e.dyn_dtree)),T(e),r&&R(e)},t._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(h[n]+256+1)]++,e.dyn_dtree[2*b(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){S(e,2,3),E(e,256,u),function(e){16===e.bi_valid?(C(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},2292:function(e){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},4155:function(e){var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var s,l=[],u=!1,c=-1;function d(){u&&s&&(u=!1,s.length?l=s.concat(l):c=-1,l.length&&h())}function h(){if(!u){var e=a(d);u=!0;for(var t=l.length;t;){for(s=l,l=[];++c<t;)s&&s[c].run();c=-1,t=l.length}s=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||u||a(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},9509:function(e,t,n){var r=n(8764),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=a),o(i,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},6099:function(e,t,n){!function(e){e.parser=function(e,t){return new i(e,t)},e.SAXParser=i,e.SAXStream=a,e.createStream=function(e,t){return new a(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(t,n){if(!(this instanceof i))return new i(t,n);var o=this;!function(e){for(var t=0,n=r.length;t<n;t++)e[r[t]]=""}(o),o.q=o.c="",o.bufferCheckPosition=e.MAX_BUFFER_LENGTH,o.opt=n||{},o.opt.lowercase=o.opt.lowercase||o.opt.lowercasetags,o.looseCase=o.opt.lowercase?"toLowerCase":"toUpperCase",o.tags=[],o.closed=o.closedRoot=o.sawRoot=!1,o.tag=o.error=null,o.strict=!!t,o.noscript=!(!t&&!o.opt.noscript),o.state=S.BEGIN,o.strictEntities=o.opt.strictEntities,o.ENTITIES=o.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),o.attribList=[],o.opt.xmlns&&(o.ns=Object.create(u)),o.trackPosition=!1!==o.opt.position,o.trackPosition&&(o.position=o.line=o.column=0),k(o,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),i.prototype={end:function(){_(this)},write:function(t){var n=this;if(this.error)throw this.error;if(n.closed)return A(n,"Cannot write after close. Assign an onready handler.");if(null===t)return _(n);"object"==typeof t&&(t=t.toString());for(var i=0,o="";o=G(t,i++),n.c=o,o;)switch(n.trackPosition&&(n.position++,"\n"===o?(n.line++,n.column=0):n.column++),n.state){case S.BEGIN:if(n.state=S.BEGIN_WHITESPACE,"\ufeff"===o)continue;M(n,o);continue;case S.BEGIN_WHITESPACE:M(n,o);continue;case S.TEXT:if(n.sawRoot&&!n.closedRoot){for(var a=i-1;o&&"<"!==o&&"&"!==o;)(o=G(t,i++))&&n.trackPosition&&(n.position++,"\n"===o?(n.line++,n.column=0):n.column++);n.textNode+=t.substring(a,i-1)}"<"!==o||n.sawRoot&&n.closedRoot&&!n.strict?(p(o)||n.sawRoot&&!n.closedRoot||O(n,"Text data outside of root node."),"&"===o?n.state=S.TEXT_ENTITY:n.textNode+=o):(n.state=S.OPEN_WAKA,n.startTagPosition=n.position);continue;case S.SCRIPT:"<"===o?n.state=S.SCRIPT_ENDING:n.script+=o;continue;case S.SCRIPT_ENDING:"/"===o?n.state=S.CLOSE_TAG:(n.script+="<"+o,n.state=S.SCRIPT);continue;case S.OPEN_WAKA:if("!"===o)n.state=S.SGML_DECL,n.sgmlDecl="";else if(p(o));else if(m(c,o))n.state=S.OPEN_TAG,n.tagName=o;else if("/"===o)n.state=S.CLOSE_TAG,n.tagName="";else if("?"===o)n.state=S.PROC_INST,n.procInstName=n.procInstBody="";else{if(O(n,"Unencoded <"),n.startTagPosition+1<n.position){var s=n.position-n.startTagPosition;o=new Array(s).join(" ")+o}n.textNode+="<"+o,n.state=S.TEXT}continue;case S.SGML_DECL:"[CDATA["===(n.sgmlDecl+o).toUpperCase()?(x(n,"onopencdata"),n.state=S.CDATA,n.sgmlDecl="",n.cdata=""):n.sgmlDecl+o==="--"?(n.state=S.COMMENT,n.comment="",n.sgmlDecl=""):"DOCTYPE"===(n.sgmlDecl+o).toUpperCase()?(n.state=S.DOCTYPE,(n.doctype||n.sawRoot)&&O(n,"Inappropriately located doctype declaration"),n.doctype="",n.sgmlDecl=""):">"===o?(x(n,"onsgmldeclaration",n.sgmlDecl),n.sgmlDecl="",n.state=S.TEXT):v(o)?(n.state=S.SGML_DECL_QUOTED,n.sgmlDecl+=o):n.sgmlDecl+=o;continue;case S.SGML_DECL_QUOTED:o===n.q&&(n.state=S.SGML_DECL,n.q=""),n.sgmlDecl+=o;continue;case S.DOCTYPE:">"===o?(n.state=S.TEXT,x(n,"ondoctype",n.doctype),n.doctype=!0):(n.doctype+=o,"["===o?n.state=S.DOCTYPE_DTD:v(o)&&(n.state=S.DOCTYPE_QUOTED,n.q=o));continue;case S.DOCTYPE_QUOTED:n.doctype+=o,o===n.q&&(n.q="",n.state=S.DOCTYPE);continue;case S.DOCTYPE_DTD:n.doctype+=o,"]"===o?n.state=S.DOCTYPE:v(o)&&(n.state=S.DOCTYPE_DTD_QUOTED,n.q=o);continue;case S.DOCTYPE_DTD_QUOTED:n.doctype+=o,o===n.q&&(n.state=S.DOCTYPE_DTD,n.q="");continue;case S.COMMENT:"-"===o?n.state=S.COMMENT_ENDING:n.comment+=o;continue;case S.COMMENT_ENDING:"-"===o?(n.state=S.COMMENT_ENDED,n.comment=R(n.opt,n.comment),n.comment&&x(n,"oncomment",n.comment),n.comment=""):(n.comment+="-"+o,n.state=S.COMMENT);continue;case S.COMMENT_ENDED:">"!==o?(O(n,"Malformed comment"),n.comment+="--"+o,n.state=S.COMMENT):n.state=S.TEXT;continue;case S.CDATA:"]"===o?n.state=S.CDATA_ENDING:n.cdata+=o;continue;case S.CDATA_ENDING:"]"===o?n.state=S.CDATA_ENDING_2:(n.cdata+="]"+o,n.state=S.CDATA);continue;case S.CDATA_ENDING_2:">"===o?(n.cdata&&x(n,"oncdata",n.cdata),x(n,"onclosecdata"),n.cdata="",n.state=S.TEXT):"]"===o?n.cdata+="]":(n.cdata+="]]"+o,n.state=S.CDATA);continue;case S.PROC_INST:"?"===o?n.state=S.PROC_INST_ENDING:p(o)?n.state=S.PROC_INST_BODY:n.procInstName+=o;continue;case S.PROC_INST_BODY:if(!n.procInstBody&&p(o))continue;"?"===o?n.state=S.PROC_INST_ENDING:n.procInstBody+=o;continue;case S.PROC_INST_ENDING:">"===o?(x(n,"onprocessinginstruction",{name:n.procInstName,body:n.procInstBody}),n.procInstName=n.procInstBody="",n.state=S.TEXT):(n.procInstBody+="?"+o,n.state=S.PROC_INST_BODY);continue;case S.OPEN_TAG:m(d,o)?n.tagName+=o:(D(n),">"===o?F(n):"/"===o?n.state=S.OPEN_TAG_SLASH:(p(o)||O(n,"Invalid character in tag name"),n.state=S.ATTRIB));continue;case S.OPEN_TAG_SLASH:">"===o?(F(n,!0),I(n)):(O(n,"Forward-slash in opening tag not followed by >"),n.state=S.ATTRIB);continue;case S.ATTRIB:if(p(o))continue;">"===o?F(n):"/"===o?n.state=S.OPEN_TAG_SLASH:m(c,o)?(n.attribName=o,n.attribValue="",n.state=S.ATTRIB_NAME):O(n,"Invalid attribute name");continue;case S.ATTRIB_NAME:"="===o?n.state=S.ATTRIB_VALUE:">"===o?(O(n,"Attribute without value"),n.attribValue=n.attribName,P(n),F(n)):p(o)?n.state=S.ATTRIB_NAME_SAW_WHITE:m(d,o)?n.attribName+=o:O(n,"Invalid attribute name");continue;case S.ATTRIB_NAME_SAW_WHITE:if("="===o)n.state=S.ATTRIB_VALUE;else{if(p(o))continue;O(n,"Attribute without value"),n.tag.attributes[n.attribName]="",n.attribValue="",x(n,"onattribute",{name:n.attribName,value:""}),n.attribName="",">"===o?F(n):m(c,o)?(n.attribName=o,n.state=S.ATTRIB_NAME):(O(n,"Invalid attribute name"),n.state=S.ATTRIB)}continue;case S.ATTRIB_VALUE:if(p(o))continue;v(o)?(n.q=o,n.state=S.ATTRIB_VALUE_QUOTED):(O(n,"Unquoted attribute value"),n.state=S.ATTRIB_VALUE_UNQUOTED,n.attribValue=o);continue;case S.ATTRIB_VALUE_QUOTED:if(o!==n.q){"&"===o?n.state=S.ATTRIB_VALUE_ENTITY_Q:n.attribValue+=o;continue}P(n),n.q="",n.state=S.ATTRIB_VALUE_CLOSED;continue;case S.ATTRIB_VALUE_CLOSED:p(o)?n.state=S.ATTRIB:">"===o?F(n):"/"===o?n.state=S.OPEN_TAG_SLASH:m(c,o)?(O(n,"No whitespace between attributes"),n.attribName=o,n.attribValue="",n.state=S.ATTRIB_NAME):O(n,"Invalid attribute name");continue;case S.ATTRIB_VALUE_UNQUOTED:if(!g(o)){"&"===o?n.state=S.ATTRIB_VALUE_ENTITY_U:n.attribValue+=o;continue}P(n),">"===o?F(n):n.state=S.ATTRIB;continue;case S.CLOSE_TAG:if(n.tagName)">"===o?I(n):m(d,o)?n.tagName+=o:n.script?(n.script+="</"+n.tagName,n.tagName="",n.state=S.SCRIPT):(p(o)||O(n,"Invalid tagname in closing tag"),n.state=S.CLOSE_TAG_SAW_WHITE);else{if(p(o))continue;y(c,o)?n.script?(n.script+="</"+o,n.state=S.SCRIPT):O(n,"Invalid tagname in closing tag."):n.tagName=o}continue;case S.CLOSE_TAG_SAW_WHITE:if(p(o))continue;">"===o?I(n):O(n,"Invalid characters in closing tag");continue;case S.TEXT_ENTITY:case S.ATTRIB_VALUE_ENTITY_Q:case S.ATTRIB_VALUE_ENTITY_U:var l,u;switch(n.state){case S.TEXT_ENTITY:l=S.TEXT,u="textNode";break;case S.ATTRIB_VALUE_ENTITY_Q:l=S.ATTRIB_VALUE_QUOTED,u="attribValue";break;case S.ATTRIB_VALUE_ENTITY_U:l=S.ATTRIB_VALUE_UNQUOTED,u="attribValue"}";"===o?(n[u]+=L(n),n.entity="",n.state=l):m(n.entity.length?f:h,o)?n.entity+=o:(O(n,"Invalid character in entity name"),n[u]+="&"+n.entity+o,n.entity="",n.state=l);continue;default:throw new Error(n,"Unknown state: "+n.state)}return n.position>=n.bufferCheckPosition&&function(t){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),i=0,o=0,a=r.length;o<a;o++){var s=t[r[o]].length;if(s>n)switch(r[o]){case"textNode":T(t);break;case"cdata":x(t,"oncdata",t.cdata),t.cdata="";break;case"script":x(t,"onscript",t.script),t.script="";break;default:A(t,"Max buffer length exceeded: "+r[o])}i=Math.max(i,s)}var l=e.MAX_BUFFER_LENGTH-i;t.bufferCheckPosition=l+t.position}(n),n},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;T(e=this),""!==e.cdata&&(x(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(x(e,"onscript",e.script),e.script="")}};try{t=n(2830).Stream}catch(e){t=function(){}}var o=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function a(e,n){if(!(this instanceof a))return new a(e,n);t.apply(this),this._parser=new i(e,n),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(e){r.emit("error",e),r._parser.error=null},this._decoder=null,o.forEach((function(e){Object.defineProperty(r,"on"+e,{get:function(){return r._parser["on"+e]},set:function(t){if(!t)return r.removeAllListeners(e),r._parser["on"+e]=t,t;r.on(e,t)},enumerable:!0,configurable:!1})}))}a.prototype=Object.create(t.prototype,{constructor:{value:a}}),a.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=n(2553).s;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},a.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},a.prototype.on=function(e,n){var r=this;return r._parser["on"+e]||-1===o.indexOf(e)||(r._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t)}),t.prototype.on.call(r,e,n)};var s="http://www.w3.org/XML/1998/namespace",l="http://www.w3.org/2000/xmlns/",u={xml:s,xmlns:l},c=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,h=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function p(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function v(e){return'"'===e||"'"===e}function g(e){return">"===e||p(e)}function m(e,t){return e.test(t)}function y(e,t){return!m(e,t)}var w,b,C,S=0;for(var E in e.STATE={BEGIN:S++,BEGIN_WHITESPACE:S++,TEXT:S++,TEXT_ENTITY:S++,OPEN_WAKA:S++,SGML_DECL:S++,SGML_DECL_QUOTED:S++,DOCTYPE:S++,DOCTYPE_QUOTED:S++,DOCTYPE_DTD:S++,DOCTYPE_DTD_QUOTED:S++,COMMENT_STARTING:S++,COMMENT:S++,COMMENT_ENDING:S++,COMMENT_ENDED:S++,CDATA:S++,CDATA_ENDING:S++,CDATA_ENDING_2:S++,PROC_INST:S++,PROC_INST_BODY:S++,PROC_INST_ENDING:S++,OPEN_TAG:S++,OPEN_TAG_SLASH:S++,ATTRIB:S++,ATTRIB_NAME:S++,ATTRIB_NAME_SAW_WHITE:S++,ATTRIB_VALUE:S++,ATTRIB_VALUE_QUOTED:S++,ATTRIB_VALUE_CLOSED:S++,ATTRIB_VALUE_UNQUOTED:S++,ATTRIB_VALUE_ENTITY_Q:S++,ATTRIB_VALUE_ENTITY_U:S++,CLOSE_TAG:S++,CLOSE_TAG_SAW_WHITE:S++,SCRIPT:S++,SCRIPT_ENDING:S++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach((function(t){var n=e.ENTITIES[t],r="number"==typeof n?String.fromCharCode(n):n;e.ENTITIES[t]=r})),e.STATE)e.STATE[e.STATE[E]]=E;function k(e,t,n){e[t]&&e[t](n)}function x(e,t,n){e.textNode&&T(e),k(e,t,n)}function T(e){e.textNode=R(e.opt,e.textNode),e.textNode&&k(e,"ontext",e.textNode),e.textNode=""}function R(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function A(e,t){return T(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,k(e,"onerror",t),e}function _(e){return e.sawRoot&&!e.closedRoot&&O(e,"Unclosed root tag"),e.state!==S.BEGIN&&e.state!==S.BEGIN_WHITESPACE&&e.state!==S.TEXT&&A(e,"Unexpected end"),T(e),e.c="",e.closed=!0,k(e,"onend"),i.call(e,e.strict,e.opt),e}function O(e,t){if("object"!=typeof e||!(e instanceof i))throw new Error("bad call to strictFail");e.strict&&A(e,t)}function D(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,x(e,"onopentagstart",n)}function N(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),r=n[0],i=n[1];return t&&"xmlns"===e&&(r="xmlns",i=""),{prefix:r,local:i}}function P(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=N(e.attribName,!0),n=t.prefix,r=t.local;if("xmlns"===n)if("xml"===r&&e.attribValue!==s)O(e,"xml: prefix must be bound to "+s+"\nActual: "+e.attribValue);else if("xmlns"===r&&e.attribValue!==l)O(e,"xmlns: prefix must be bound to "+l+"\nActual: "+e.attribValue);else{var i=e.tag,o=e.tags[e.tags.length-1]||e;i.ns===o.ns&&(i.ns=Object.create(o.ns)),i.ns[r]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,x(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function F(e,t){if(e.opt.xmlns){var n=e.tag,r=N(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(O(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix);var i=e.tags[e.tags.length-1]||e;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach((function(t){x(e,"onopennamespace",{prefix:t,uri:n.ns[t]})}));for(var o=0,a=e.attribList.length;o<a;o++){var s=e.attribList[o],l=s[0],u=s[1],c=N(l,!0),d=c.prefix,h=c.local,f=""===d?"":n.ns[d]||"",p={name:l,value:u,prefix:d,local:h,uri:f};d&&"xmlns"!==d&&!f&&(O(e,"Unbound namespace prefix: "+JSON.stringify(d)),p.uri=d),e.tag.attributes[l]=p,x(e,"onattribute",p)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),x(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=S.TEXT:e.state=S.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function I(e){if(!e.tagName)return O(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=S.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=S.SCRIPT);x(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var r=n;t--&&e.tags[t].name!==r;)O(e,"Unexpected close tag");if(t<0)return O(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=S.TEXT);e.tagName=n;for(var i=e.tags.length;i-- >t;){var o=e.tag=e.tags.pop();e.tagName=e.tag.name,x(e,"onclosetag",e.tagName);var a={};for(var s in o.ns)a[s]=o.ns[s];var l=e.tags[e.tags.length-1]||e;e.opt.xmlns&&o.ns!==l.ns&&Object.keys(o.ns).forEach((function(t){var n=o.ns[t];x(e,"onclosenamespace",{prefix:t,uri:n})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=S.TEXT}function L(e){var t,n=e.entity,r=n.toLowerCase(),i="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:("#"===(n=r).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),i=(t=parseInt(n,16)).toString(16)):(n=n.slice(1),i=(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),isNaN(t)||i.toLowerCase()!==n?(O(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function M(e,t){"<"===t?(e.state=S.OPEN_WAKA,e.startTagPosition=e.position):p(t)||(O(e,"Non-whitespace before first tag."),e.textNode=t,e.state=S.TEXT)}function G(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}S=e.STATE,String.fromCodePoint||(w=String.fromCharCode,b=Math.floor,C=function(){var e,t,n=16384,r=[],i=-1,o=arguments.length;if(!o)return"";for(var a="";++i<o;){var s=Number(arguments[i]);if(!isFinite(s)||s<0||s>1114111||b(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?r.push(s):(e=55296+((s-=65536)>>10),t=s%1024+56320,r.push(e,t)),(i+1===o||r.length>n)&&(a+=w.apply(null,r),r.length=0)}return a},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:C,configurable:!0,writable:!0}):String.fromCodePoint=C)}(t)},4889:function(e,t,n){var r=n(4155);!function(e,t){"use strict";if(!e.setImmediate){var n,i,o,a,s,l=1,u={},c=!1,d=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?n=function(e){r.nextTick((function(){p(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(t){e.postMessage(a+t,"*")}):e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){p(e.data)},n=function(e){o.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,n=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):n=function(e){setTimeout(p,0,e)},h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var i={callback:e,args:t};return u[l]=i,n(l),l++},h.clearImmediate=f}function f(e){delete u[e]}function p(e){if(c)setTimeout(p,0,e);else{var t=u[e];if(t){c=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{f(e),c=!1}}}}}("undefined"==typeof self?void 0===n.g?this:n.g:self)},2830:function(e,t,n){e.exports=i;var r=n(7187).EventEmitter;function i(){r.call(this)}n(5717)(i,r),i.Readable=n(6577),i.Writable=n(323),i.Duplex=n(8656),i.Transform=n(4473),i.PassThrough=n(2366),i.finished=n(1086),i.pipeline=n(6472),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",l));var a=!1;function s(){a||(a=!0,e.end())}function l(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),0===r.listenerCount(this,"error"))throw e}function c(){n.removeListener("data",i),e.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",l),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",u),e.on("error",u),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e}},8106:function(e){"use strict";var t={};function n(e,n,r){r||(r=Error);var i=function(e){var t,r;function i(t,r,i){return e.call(this,function(e,t,r){return"string"==typeof n?n:n(e,t,r)}(t,r,i))||this}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i}(r);i.prototype.name=r.name,i.prototype.code=e,t[e]=i}function r(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}n("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(e,t,n){var i,o,a,s,l;if("string"==typeof t&&(o="not ",t.substr(0,o.length)===o)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))a="The ".concat(e," ").concat(i," ").concat(r(t,"type"));else{var u=("number"!=typeof l&&(l=0),l+1>(s=e).length||-1===s.indexOf(".",l)?"argument":"property");a='The "'.concat(e,'" ').concat(u," ").concat(i," ").concat(r(t,"type"))}return a+". Received type ".concat(typeof n)}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},8656:function(e,t,n){"use strict";var r=n(4155),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=c;var o=n(6577),a=n(323);n(5717)(c,o);for(var s=i(a.prototype),l=0;l<s.length;l++){var u=s[l];c.prototype[u]||(c.prototype[u]=a.prototype[u])}function c(e){if(!(this instanceof c))return new c(e);o.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",d)))}function d(){this._writableState.ended||r.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},2366:function(e,t,n){"use strict";e.exports=i;var r=n(4473);function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}n(5717)(i,r),i.prototype._transform=function(e,t,n){n(null,e)}},6577:function(e,t,n){"use strict";var r,i=n(4155);e.exports=x,x.ReadableState=k,n(7187).EventEmitter;var o,a=function(e,t){return e.listeners(t).length},s=n(3194),l=n(8764).Buffer,u=n.g.Uint8Array||function(){},c=n(5575);o=c&&c.debuglog?c.debuglog("stream"):function(){};var d,h,f,p=n(9686),v=n(1029),g=n(94).getHighWaterMark,m=n(8106).q,y=m.ERR_INVALID_ARG_TYPE,w=m.ERR_STREAM_PUSH_AFTER_EOF,b=m.ERR_METHOD_NOT_IMPLEMENTED,C=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(5717)(x,s);var S=v.errorOrDestroy,E=["error","close","destroy","pause","resume"];function k(e,t,i){r=r||n(8656),e=e||{},"boolean"!=typeof i&&(i=t instanceof r),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(d||(d=n(2553).s),this.decoder=new d(e.encoding),this.encoding=e.encoding)}function x(e){if(r=r||n(8656),!(this instanceof x))return new x(e);var t=this instanceof r;this._readableState=new k(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function T(e,t,n,r,i){o("readableAddChunk",t);var a,s=e._readableState;if(null===t)s.reading=!1,function(e,t){if(o("onEofChunk"),!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?O(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,D(e)))}}(e,s);else if(i||(a=function(e,t){var n,r;return r=t,l.isBuffer(r)||r instanceof u||"string"==typeof t||void 0===t||e.objectMode||(n=new y("chunk",["string","Buffer","Uint8Array"],t)),n}(s,t)),a)S(e,a);else if(s.objectMode||t&&t.length>0)if("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),r)s.endEmitted?S(e,new C):R(e,s,t,!0);else if(s.ended)S(e,new w);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!n?(t=s.decoder.write(t),s.objectMode||0!==t.length?R(e,s,t,!1):N(e,s)):R(e,s,t,!1)}else r||(s.reading=!1,N(e,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function R(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&O(e)),N(e,t)}Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),x.prototype.destroy=v.destroy,x.prototype._undestroy=v.undestroy,x.prototype._destroy=function(e,t){t(e)},x.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=l.from(e,t),t=""),n=!0),T(this,e,t,!1,n)},x.prototype.unshift=function(e){return T(this,e,null,!0,!1)},x.prototype.isPaused=function(){return!1===this._readableState.flowing},x.prototype.setEncoding=function(e){d||(d=n(2553).s);var t=new d(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var A=1073741824;function _(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=A?e=A:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function O(e){var t=e._readableState;o("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(o("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(D,e))}function D(e){var t=e._readableState;o("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,M(e)}function N(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(P,e,t))}function P(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(o("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function F(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function I(e){o("readable nexttick read 0"),e.read(0)}function L(e,t){o("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),M(e),t.flowing&&!t.reading&&e.read(0)}function M(e){var t=e._readableState;for(o("flow",t.flowing);t.flowing&&null!==e.read(););}function G(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function B(e){var t=e._readableState;o("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(j,t,e))}function j(e,t){if(o("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function H(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}x.prototype.read=function(e){o("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return o("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?B(this):O(this),null;if(0===(e=_(e,t))&&t.ended)return 0===t.length&&B(this),null;var r,i=t.needReadable;return o("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&o("length less than watermark",i=!0),t.ended||t.reading?o("reading or ended",i=!1):i&&(o("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=_(n,t))),null===(r=e>0?G(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&B(this)),null!==r&&this.emit("data",r),r},x.prototype._read=function(e){S(this,new b("_read()"))},x.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,o("pipe count=%d opts=%j",r.pipesCount,t);var s=t&&!1===t.end||e===i.stdout||e===i.stderr?v:l;function l(){o("onend"),e.end()}r.endEmitted?i.nextTick(s):n.once("end",s),e.on("unpipe",(function t(i,a){o("onunpipe"),i===n&&a&&!1===a.hasUnpiped&&(a.hasUnpiped=!0,o("cleanup"),e.removeListener("close",f),e.removeListener("finish",p),e.removeListener("drain",u),e.removeListener("error",h),e.removeListener("unpipe",t),n.removeListener("end",l),n.removeListener("end",v),n.removeListener("data",d),c=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||u())}));var u=function(e){return function(){var t=e._readableState;o("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,M(e))}}(n);e.on("drain",u);var c=!1;function d(t){o("ondata");var i=e.write(t);o("dest.write",i),!1===i&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==H(r.pipes,e))&&!c&&(o("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function h(t){o("onerror",t),v(),e.removeListener("error",h),0===a(e,"error")&&S(e,t)}function f(){e.removeListener("finish",p),v()}function p(){o("onfinish"),e.removeListener("close",f),v()}function v(){o("unpipe"),n.unpipe(e)}return n.on("data",d),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events.error?Array.isArray(e._events.error)?e._events.error.unshift(n):e._events.error=[n,e._events.error]:e.on(t,n)}(e,"error",h),e.once("close",f),e.once("finish",p),e.emit("pipe",n),r.flowing||(o("pipe resume"),n.resume()),e},x.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=H(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},x.prototype.on=function(e,t){var n=s.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,o("on readable",r.length,r.reading),r.length?O(this):r.reading||i.nextTick(I,this))),n},x.prototype.addListener=x.prototype.on,x.prototype.removeListener=function(e,t){var n=s.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(F,this),n},x.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(F,this),t},x.prototype.resume=function(){var e=this._readableState;return e.flowing||(o("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(L,e,t))}(this,e)),e.paused=!1,this},x.prototype.pause=function(){return o("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(o("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},x.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(o("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){o("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<E.length;a++)e.on(E[a],this.emit.bind(this,E[a]));return this._read=function(t){o("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(x.prototype[Symbol.asyncIterator]=function(){return void 0===h&&(h=n(828)),h(this)}),Object.defineProperty(x.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(x.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(x.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),x._fromList=G,Object.defineProperty(x.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(x.from=function(e,t){return void 0===f&&(f=n(1265)),f(x,e,t)})},4473:function(e,t,n){"use strict";e.exports=c;var r=n(8106).q,i=r.ERR_METHOD_NOT_IMPLEMENTED,o=r.ERR_MULTIPLE_CALLBACK,a=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=r.ERR_TRANSFORM_WITH_LENGTH_0,l=n(8656);function u(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new o);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);l.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function d(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,n){h(e,t,n)}))}function h(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new s;if(e._transformState.transforming)throw new a;return e.push(null)}n(5717)(c,l),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,n){n(new i("_transform()"))},c.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}},323:function(e,t,n){"use strict";var r,i=n(4155);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(void 0),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=x,x.WritableState=k;var a,s={deprecate:n(4927)},l=n(3194),u=n(8764).Buffer,c=n.g.Uint8Array||function(){},d=n(1029),h=n(94).getHighWaterMark,f=n(8106).q,p=f.ERR_INVALID_ARG_TYPE,v=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,m=f.ERR_STREAM_CANNOT_PIPE,y=f.ERR_STREAM_DESTROYED,w=f.ERR_STREAM_NULL_VALUES,b=f.ERR_STREAM_WRITE_AFTER_END,C=f.ERR_UNKNOWN_ENCODING,S=d.errorOrDestroy;function E(){}function k(e,t,a){r=r||n(8656),e=e||{},"boolean"!=typeof a&&(a=t instanceof r),this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=h(this,e,"writableHighWaterMark",a),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if("function"!=typeof o)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,o){--t.pendingcb,n?(i.nextTick(o,r),i.nextTick(D,e,t),e._writableState.errorEmitted=!0,S(e,r)):(o(r),e._writableState.errorEmitted=!0,S(e,r),D(e,t))}(e,n,r,t,o);else{var a=_(n)||e.destroyed;a||n.corked||n.bufferProcessing||!n.bufferedRequest||A(e,n),r?i.nextTick(R,e,n,a,o):R(e,n,a,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function x(e){var t=this instanceof(r=r||n(8656));if(!t&&!a.call(x,this))return new x(e);this._writableState=new k(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),l.call(this)}function T(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new y("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function R(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),D(e,t)}function A(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var s=0,l=!0;n;)i[s]=n,n.isBuf||(l=!1),n=n.next,s+=1;i.allBuffers=l,T(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,c=n.encoding,d=n.callback;if(T(e,t,!1,t.objectMode?1:u.length,u,c,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function _(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function O(e,t){e._final((function(n){t.pendingcb--,n&&S(e,n),t.prefinished=!0,e.emit("prefinish"),D(e,t)}))}function D(e,t){var n=_(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(O,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return n}n(5717)(x,l),k.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(k.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(a=Function.prototype[Symbol.hasInstance],Object.defineProperty(x,Symbol.hasInstance,{value:function(e){return!!a.call(this,e)||this===x&&e&&e._writableState instanceof k}})):a=function(e){return e instanceof this},x.prototype.pipe=function(){S(this,new m)},x.prototype.write=function(e,t,n){var r,o=this._writableState,a=!1,s=!o.objectMode&&(r=e,u.isBuffer(r)||r instanceof c);return s&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=E),o.ending?function(e,t){var n=new b;S(e,n),i.nextTick(t,n)}(this,n):(s||function(e,t,n,r){var o;return null===n?o=new w:"string"==typeof n||t.objectMode||(o=new p("chunk",["string","Buffer"],n)),!o||(S(e,o),i.nextTick(r,o),!1)}(this,o,e,n))&&(o.pendingcb++,a=function(e,t,n,r,i,o){if(!n){var a=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=u.from(t,n)),t}(t,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=t.objectMode?1:r.length;t.length+=s;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,s,r,i,o);return l}(this,o,s,e,t,n)),a},x.prototype.cork=function(){this._writableState.corked++},x.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||A(this,e))},x.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new C(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(x.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(x.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),x.prototype._write=function(e,t,n){n(new v("_write()"))},x.prototype._writev=null,x.prototype.end=function(e,t,n){var r=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,n){t.ending=!0,D(e,t),n&&(t.finished?i.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,r,n),this},Object.defineProperty(x.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),x.prototype.destroy=d.destroy,x.prototype._undestroy=d.undestroy,x.prototype._destroy=function(e,t){t(e)}},828:function(e,t,n){"use strict";var r,i=n(4155);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=n(1086),s=Symbol("lastResolve"),l=Symbol("lastReject"),u=Symbol("error"),c=Symbol("ended"),d=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function p(e,t){return{value:e,done:t}}function v(e){var t=e[s];if(null!==t){var n=e[f].read();null!==n&&(e[d]=null,e[s]=null,e[l]=null,t(p(n,!1)))}}function g(e){i.nextTick(v,e)}var m=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((o(r={get stream(){return this[f]},next:function(){var e=this,t=this[u];if(null!==t)return Promise.reject(t);if(this[c])return Promise.resolve(p(void 0,!0));if(this[f].destroyed)return new Promise((function(t,n){i.nextTick((function(){e[u]?n(e[u]):t(p(void 0,!0))}))}));var n,r=this[d];if(r)n=new Promise(function(e,t){return function(n,r){e.then((function(){t[c]?n(p(void 0,!0)):t[h](n,r)}),r)}}(r,this));else{var o=this[f].read();if(null!==o)return Promise.resolve(p(o,!1));n=new Promise(this[h])}return this[d]=n,n}},Symbol.asyncIterator,(function(){return this})),o(r,"return",(function(){var e=this;return new Promise((function(t,n){e[f].destroy(null,(function(e){e?n(e):t(p(void 0,!0))}))}))})),r),m);e.exports=function(e){var t,n=Object.create(y,(o(t={},f,{value:e,writable:!0}),o(t,s,{value:null,writable:!0}),o(t,l,{value:null,writable:!0}),o(t,u,{value:null,writable:!0}),o(t,c,{value:e._readableState.endEmitted,writable:!0}),o(t,h,{value:function(e,t){var r=n[f].read();r?(n[d]=null,n[s]=null,n[l]=null,e(p(r,!1))):(n[s]=e,n[l]=t)},writable:!0}),t));return n[d]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[l];return null!==t&&(n[d]=null,n[s]=null,n[l]=null,t(e)),void(n[u]=e)}var r=n[s];null!==r&&(n[d]=null,n[s]=null,n[l]=null,r(p(void 0,!0))),n[c]=!0})),e.on("readable",g.bind(null,n)),n}},9686:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=n(8764).Buffer,s=n(5575).inspect,l=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t;return t=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return a.alloc(0);for(var t,n,r,i=a.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,n=i,r=s,a.prototype.copy.call(t,n,r),s+=o.data.length,o=o.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?r+=i:r+=i.slice(0,e),0==(e-=o)){o===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=a.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,t}},{key:l,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],t&&o(e.prototype,t),e}()},1029:function(e,t,n){"use strict";var r=n(4155);function i(e,t){a(e,t),o(e)}function o(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function a(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,s=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return s||l?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(a,this,e)):r.nextTick(a,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?n._writableState?n._writableState.errorEmitted?r.nextTick(o,n):(n._writableState.errorEmitted=!0,r.nextTick(i,n,e)):r.nextTick(i,n,e):t?(r.nextTick(o,n),t(e)):r.nextTick(o,n)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}},1086:function(e,t,n){"use strict";var r=n(8106).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,n,o){if("function"==typeof n)return e(t,null,n);n||(n={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(o||i);var a=n.readable||!1!==n.readable&&t.readable,s=n.writable||!1!==n.writable&&t.writable,l=function(){t.writable||c()},u=t._writableState&&t._writableState.finished,c=function(){s=!1,u=!0,a||o.call(t)},d=t._readableState&&t._readableState.endEmitted,h=function(){a=!1,d=!0,s||o.call(t)},f=function(e){o.call(t,e)},p=function(){var e;return a&&!d?(t._readableState&&t._readableState.ended||(e=new r),o.call(t,e)):s&&!u?(t._writableState&&t._writableState.ended||(e=new r),o.call(t,e)):void 0},v=function(){t.req.on("finish",c)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",c),t.on("abort",p),t.req?v():t.on("request",v)):s&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",h),t.on("finish",c),!1!==n.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",c),t.removeListener("abort",p),t.removeListener("request",v),t.req&&t.req.removeListener("finish",c),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",c),t.removeListener("end",h),t.removeListener("error",f),t.removeListener("close",p)}}},1265:function(e){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},6472:function(e,t,n){"use strict";var r,i=n(8106).q,o=i.ERR_MISSING_ARGS,a=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function l(e,t,i,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var s=!1;e.on("close",(function(){s=!0})),void 0===r&&(r=n(1086)),r(e,{readable:t,writable:i},(function(e){if(e)return o(e);s=!0,o()}));var l=!1;return function(t){if(!s&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void o(t||new a("pipe"))}}function u(e){e()}function c(e,t){return e.pipe(t)}function d(e){return e.length?"function"!=typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=d(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new o("streams");var a=t.map((function(e,n){var o=n<t.length-1;return l(e,o,n>0,(function(e){r||(r=e),e&&a.forEach(u),o||(a.forEach(u),i(r))}))}));return t.reduce(c)}},94:function(e,t,n){"use strict";var r=n(8106).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,n,i){var o=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new r(i?n:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}},3194:function(e,t,n){e.exports=n(7187).EventEmitter},2553:function(e,t,n){"use strict";var r=n(9509).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=u,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=c,this.end=d,t=3;break;default:return this.write=h,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"\ufffd";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"\ufffd";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"\ufffd"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function c(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.s=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\ufffd":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=a(t[r]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--r<n||-2===i?0:(i=a(t[r]))>=0?(i>0&&(e.lastNeed=i-2),i):--r<n||-2===i?0:(i=a(t[r]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},5457:function(e,t,n){"use strict";n.d(t,{vw:function(){return o},rq:function(){return i},EL:function(){return s},NY:function(){return a}});var r=0,i=function(e){return Math.floor(e/25.4*72*20)},o=function(e){return Math.floor(72*e*20)},a=function(){return++r},s=function(){return function(){for(var e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;t--;)e+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return e}().toLowerCase()}},5575:function(e,t,n){"use strict";n.r(t),n.d(t,{convertInchesToTwip:function(){return r.vw},convertMillimetersToTwip:function(){return r.rq},dateTimeValue:function(){return i.sF},decimalNumber:function(){return i.vH},eighthPointMeasureValue:function(){return i.LV},hexColorValue:function(){return i.dg},hpsMeasureValue:function(){return i.KR},longHexNumber:function(){return i.mA},measurementOrPercentValue:function(){return i.aB},percentageValue:function(){return i.wp},pointMeasureValue:function(){return i.gg},positiveUniversalMeasureValue:function(){return i._p},shortHexNumber:function(){return i.G0},signedHpsMeasureValue:function(){return i.Rg},signedTwipsMeasureValue:function(){return i.xb},twipsMeasureValue:function(){return i.Jd},uCharHexNumber:function(){return i.xD},uniqueId:function(){return r.EL},uniqueNumericId:function(){return r.NY},universalMeasureValue:function(){return i.KC},unsignedDecimalNumber:function(){return i.f$}});var r=n(5457),i=n(6595)},6595:function(e,t,n){"use strict";n.d(t,{G0:function(){return s},Jd:function(){return g},KC:function(){return u},KR:function(){return p},LV:function(){return w},Rg:function(){return v},_p:function(){return d},aB:function(){return y},dg:function(){return h},f$:function(){return i},gg:function(){return b},mA:function(){return a},sF:function(){return C},vH:function(){return r},wp:function(){return m},xD:function(){return l},xb:function(){return f}});var r=function(e){if(isNaN(e))throw new Error("Invalid value '".concat(e,"' specified. Must be an integer."));return Math.floor(e)},i=function(e){var t=r(e);if(t<0)throw new Error("Invalid value '".concat(e,"' specified. Must be a positive integer."));return t},o=function(e,t){var n=2*t;if(e.length!==n||isNaN(Number("0x".concat(e))))throw new Error("Invalid hex value '".concat(e,"'. Expected ").concat(n," digit hex value"));return e},a=function(e){return o(e,4)},s=function(e){return o(e,2)},l=function(e){return o(e,1)},u=function(e){var t=e.slice(-2);if(!c.includes(t))throw new Error("Invalid unit '".concat(t,"' specified. Valid units are ").concat(c.join(", ")));var n=e.substring(0,e.length-2);if(isNaN(Number(n)))throw new Error("Invalid value '".concat(n,"' specified. Expected a valid number."));return"".concat(Number(n)).concat(t)},c=["mm","cm","in","pt","pc","pi"],d=function(e){var t=u(e);if(parseFloat(t)<0)throw new Error("Invalid value '".concat(t,"' specified. Expected a positive number."));return t},h=function(e){if("auto"===e)return e;var t="#"===e.charAt(0)?e.substring(1):e;return o(t,3)},f=function(e){return"string"==typeof e?u(e):r(e)},p=function(e){return"string"==typeof e?d(e):i(e)},v=function(e){return"string"==typeof e?u(e):r(e)},g=function(e){return"string"==typeof e?d(e):i(e)},m=function(e){if("%"!==e.slice(-1))throw new Error("Invalid value '".concat(e,"'. Expected percentage value (eg '55%')"));var t=e.substring(0,e.length-1);if(isNaN(Number(t)))throw new Error("Invalid value '".concat(t,"' specified. Expected a valid number."));return"".concat(Number(t),"%")},y=function(e){return"number"==typeof e?r(e):"%"===e.slice(-1)?m(e):u(e)},w=i,b=i,C=function(e){return e.toISOString()}},4927:function(e,t,n){function r(e){try{if(!n.g.localStorage)return!1}catch(e){return!1}var t=n.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}},9881:function(e){e.exports={isArray:function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}}},7888:function(e,t,n){var r=n(1229),i=n(1388),o=n(6501),a=n(4673);e.exports={xml2js:r,xml2json:i,js2xml:o,json2xml:a}},6501:function(e,t,n){var r,i,o=n(4740),a=n(9881).isArray;function s(e,t,n){return(!n&&e.spaces?"\n":"")+Array(t+1).join(e.spaces)}function l(e,t,n){if(t.ignoreAttributes)return"";"attributesFn"in t&&(e=t.attributesFn(e,i,r));var o,a,l,u,c=[];for(o in e)e.hasOwnProperty(o)&&null!==e[o]&&void 0!==e[o]&&(u=t.noQuotesForNativeAttributes&&"string"!=typeof e[o]?"":'"',a=(a=""+e[o]).replace(/"/g,"&quot;"),l="attributeNameFn"in t?t.attributeNameFn(o,a,i,r):o,c.push(t.spaces&&t.indentAttributes?s(t,n+1,!1):" "),c.push(l+"="+u+("attributeValueFn"in t?t.attributeValueFn(a,o,i,r):a)+u));return e&&Object.keys(e).length&&t.spaces&&t.indentAttributes&&c.push(s(t,n,!1)),c.join("")}function u(e,t,n){return r=e,i="xml",t.ignoreDeclaration?"":"<?xml"+l(e[t.attributesKey],t,n)+"?>"}function c(e,t,n){if(t.ignoreInstruction)return"";var o;for(o in e)if(e.hasOwnProperty(o))break;var a="instructionNameFn"in t?t.instructionNameFn(o,e[o],i,r):o;if("object"==typeof e[o])return r=e,i=a,"<?"+a+l(e[o][t.attributesKey],t,n)+"?>";var s=e[o]?e[o]:"";return"instructionFn"in t&&(s=t.instructionFn(s,o,i,r)),"<?"+a+(s?" "+s:"")+"?>"}function d(e,t){return t.ignoreComment?"":"\x3c!--"+("commentFn"in t?t.commentFn(e,i,r):e)+"--\x3e"}function h(e,t){return t.ignoreCdata?"":"<![CDATA["+("cdataFn"in t?t.cdataFn(e,i,r):e.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function f(e,t){return t.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in t?t.doctypeFn(e,i,r):e)+">"}function p(e,t){return t.ignoreText?"":(e=(e=(e=""+e).replace(/&amp;/g,"&")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in t?t.textFn(e,i,r):e)}function v(e,t,n,o){return e.reduce((function(e,a){var u=s(t,n,o&&!e);switch(a.type){case"element":return e+u+function(e,t,n){r=e,i=e.name;var o=[],a="elementNameFn"in t?t.elementNameFn(e.name,e):e.name;o.push("<"+a),e[t.attributesKey]&&o.push(l(e[t.attributesKey],t,n));var s=e[t.elementsKey]&&e[t.elementsKey].length||e[t.attributesKey]&&"preserve"===e[t.attributesKey]["xml:space"];return s||(s="fullTagEmptyElementFn"in t?t.fullTagEmptyElementFn(e.name,e):t.fullTagEmptyElement),s?(o.push(">"),e[t.elementsKey]&&e[t.elementsKey].length&&(o.push(v(e[t.elementsKey],t,n+1)),r=e,i=e.name),o.push(t.spaces&&function(e,t){var n;if(e.elements&&e.elements.length)for(n=0;n<e.elements.length;++n)switch(e.elements[n][t.typeKey]){case"text":if(t.indentText)return!0;break;case"cdata":if(t.indentCdata)return!0;break;case"instruction":if(t.indentInstruction)return!0;break;default:return!0}return!1}(e,t)?"\n"+Array(n+1).join(t.spaces):""),o.push("</"+a+">")):o.push("/>"),o.join("")}(a,t,n);case"comment":return e+u+d(a[t.commentKey],t);case"doctype":return e+u+f(a[t.doctypeKey],t);case"cdata":return e+(t.indentCdata?u:"")+h(a[t.cdataKey],t);case"text":return e+(t.indentText?u:"")+p(a[t.textKey],t);case"instruction":var g={};return g[a[t.nameKey]]=a[t.attributesKey]?a:a[t.instructionKey],e+(t.indentInstruction?u:"")+c(g,t,n)}}),"")}function g(e,t,n){var r;for(r in e)if(e.hasOwnProperty(r))switch(r){case t.parentKey:case t.attributesKey:break;case t.textKey:if(t.indentText||n)return!0;break;case t.cdataKey:if(t.indentCdata||n)return!0;break;case t.instructionKey:if(t.indentInstruction||n)return!0;break;case t.doctypeKey:case t.commentKey:default:return!0}return!1}function m(e,t,n,o,a){r=e,i=t;var u="elementNameFn"in n?n.elementNameFn(t,e):t;if(null==e||""===e)return"fullTagEmptyElementFn"in n&&n.fullTagEmptyElementFn(t,e)||n.fullTagEmptyElement?"<"+u+"></"+u+">":"<"+u+"/>";var c=[];if(t){if(c.push("<"+u),"object"!=typeof e)return c.push(">"+p(e,n)+"</"+u+">"),c.join("");e[n.attributesKey]&&c.push(l(e[n.attributesKey],n,o));var d=g(e,n,!0)||e[n.attributesKey]&&"preserve"===e[n.attributesKey]["xml:space"];if(d||(d="fullTagEmptyElementFn"in n?n.fullTagEmptyElementFn(t,e):n.fullTagEmptyElement),!d)return c.push("/>"),c.join("");c.push(">")}return c.push(y(e,n,o+1,!1)),r=e,i=t,t&&c.push((a?s(n,o,!1):"")+"</"+u+">"),c.join("")}function y(e,t,n,r){var i,o,l,v=[];for(o in e)if(e.hasOwnProperty(o))for(l=a(e[o])?e[o]:[e[o]],i=0;i<l.length;++i){switch(o){case t.declarationKey:v.push(u(l[i],t,n));break;case t.instructionKey:v.push((t.indentInstruction?s(t,n,r):"")+c(l[i],t,n));break;case t.attributesKey:case t.parentKey:break;case t.textKey:v.push((t.indentText?s(t,n,r):"")+p(l[i],t));break;case t.cdataKey:v.push((t.indentCdata?s(t,n,r):"")+h(l[i],t));break;case t.doctypeKey:v.push(s(t,n,r)+f(l[i],t));break;case t.commentKey:v.push(s(t,n,r)+d(l[i],t));break;default:v.push(s(t,n,r)+m(l[i],o,t,n,g(l[i],t)))}r=r&&!v.length}return v.join("")}e.exports=function(e,t){t=function(e){var t=o.copyOptions(e);return o.ensureFlagExists("ignoreDeclaration",t),o.ensureFlagExists("ignoreInstruction",t),o.ensureFlagExists("ignoreAttributes",t),o.ensureFlagExists("ignoreText",t),o.ensureFlagExists("ignoreComment",t),o.ensureFlagExists("ignoreCdata",t),o.ensureFlagExists("ignoreDoctype",t),o.ensureFlagExists("compact",t),o.ensureFlagExists("indentText",t),o.ensureFlagExists("indentCdata",t),o.ensureFlagExists("indentAttributes",t),o.ensureFlagExists("indentInstruction",t),o.ensureFlagExists("fullTagEmptyElement",t),o.ensureFlagExists("noQuotesForNativeAttributes",t),o.ensureSpacesExists(t),"number"==typeof t.spaces&&(t.spaces=Array(t.spaces+1).join(" ")),o.ensureKeyExists("declaration",t),o.ensureKeyExists("instruction",t),o.ensureKeyExists("attributes",t),o.ensureKeyExists("text",t),o.ensureKeyExists("comment",t),o.ensureKeyExists("cdata",t),o.ensureKeyExists("doctype",t),o.ensureKeyExists("type",t),o.ensureKeyExists("name",t),o.ensureKeyExists("elements",t),o.checkFnExists("doctype",t),o.checkFnExists("instruction",t),o.checkFnExists("cdata",t),o.checkFnExists("comment",t),o.checkFnExists("text",t),o.checkFnExists("instructionName",t),o.checkFnExists("elementName",t),o.checkFnExists("attributeName",t),o.checkFnExists("attributeValue",t),o.checkFnExists("attributes",t),o.checkFnExists("fullTagEmptyElement",t),t}(t);var n=[];return r=e,i="_root_",t.compact?n.push(y(e,t,0,!0)):(e[t.declarationKey]&&n.push(u(e[t.declarationKey],t,0)),e[t.elementsKey]&&e[t.elementsKey].length&&n.push(v(e[t.elementsKey],t,0,!n.length))),n.join("")}},4673:function(e,t,n){var r=n(6501);e.exports=function(e,t){e instanceof Buffer&&(e=e.toString());var n=null;if("string"==typeof e)try{n=JSON.parse(e)}catch(e){throw new Error("The JSON structure is invalid")}else n=e;return r(n,t)}},4740:function(e,t,n){var r=n(9881).isArray;e.exports={copyOptions:function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n},ensureFlagExists:function(e,t){e in t&&"boolean"==typeof t[e]||(t[e]=!1)},ensureSpacesExists:function(e){(!("spaces"in e)||"number"!=typeof e.spaces&&"string"!=typeof e.spaces)&&(e.spaces=0)},ensureAlwaysArrayExists:function(e){"alwaysArray"in e&&("boolean"==typeof e.alwaysArray||r(e.alwaysArray))||(e.alwaysArray=!1)},ensureKeyExists:function(e,t){e+"Key"in t&&"string"==typeof t[e+"Key"]||(t[e+"Key"]=t.compact?"_"+e:e)},checkFnExists:function(e,t){return e+"Fn"in t}}},1229:function(e,t,n){var r,i,o=n(6099),a=n(4740),s=n(9881).isArray;function l(e){var t=Number(e);if(!isNaN(t))return t;var n=e.toLowerCase();return"true"===n||"false"!==n&&e}function u(e,t){var n;if(r.compact){if(!i[r[e+"Key"]]&&(s(r.alwaysArray)?-1!==r.alwaysArray.indexOf(r[e+"Key"]):r.alwaysArray)&&(i[r[e+"Key"]]=[]),i[r[e+"Key"]]&&!s(i[r[e+"Key"]])&&(i[r[e+"Key"]]=[i[r[e+"Key"]]]),e+"Fn"in r&&"string"==typeof t&&(t=r[e+"Fn"](t,i)),"instruction"===e&&("instructionFn"in r||"instructionNameFn"in r))for(n in t)if(t.hasOwnProperty(n))if("instructionFn"in r)t[n]=r.instructionFn(t[n],n,i);else{var o=t[n];delete t[n],t[r.instructionNameFn(n,o,i)]=o}s(i[r[e+"Key"]])?i[r[e+"Key"]].push(t):i[r[e+"Key"]]=t}else{i[r.elementsKey]||(i[r.elementsKey]=[]);var a={};if(a[r.typeKey]=e,"instruction"===e){for(n in t)if(t.hasOwnProperty(n))break;a[r.nameKey]="instructionNameFn"in r?r.instructionNameFn(n,t,i):n,r.instructionHasAttributes?(a[r.attributesKey]=t[n][r.attributesKey],"instructionFn"in r&&(a[r.attributesKey]=r.instructionFn(a[r.attributesKey],n,i))):("instructionFn"in r&&(t[n]=r.instructionFn(t[n],n,i)),a[r.instructionKey]=t[n])}else e+"Fn"in r&&(t=r[e+"Fn"](t,i)),a[r[e+"Key"]]=t;r.addParent&&(a[r.parentKey]=i),i[r.elementsKey].push(a)}}function c(e){var t;if("attributesFn"in r&&e&&(e=r.attributesFn(e,i)),(r.trim||"attributeValueFn"in r||"attributeNameFn"in r||r.nativeTypeAttributes)&&e)for(t in e)if(e.hasOwnProperty(t)&&(r.trim&&(e[t]=e[t].trim()),r.nativeTypeAttributes&&(e[t]=l(e[t])),"attributeValueFn"in r&&(e[t]=r.attributeValueFn(e[t],t,i)),"attributeNameFn"in r)){var n=e[t];delete e[t],e[r.attributeNameFn(t,e[t],i)]=n}return e}function d(e){var t={};if(e.body&&("xml"===e.name.toLowerCase()||r.instructionHasAttributes)){for(var n,o=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g;null!==(n=o.exec(e.body));)t[n[1]]=n[2]||n[3]||n[4];t=c(t)}if("xml"===e.name.toLowerCase()){if(r.ignoreDeclaration)return;i[r.declarationKey]={},Object.keys(t).length&&(i[r.declarationKey][r.attributesKey]=t),r.addParent&&(i[r.declarationKey][r.parentKey]=i)}else{if(r.ignoreInstruction)return;r.trim&&(e.body=e.body.trim());var a={};r.instructionHasAttributes&&Object.keys(t).length?(a[e.name]={},a[e.name][r.attributesKey]=t):a[e.name]=e.body,u("instruction",a)}}function h(e,t){var n;if("object"==typeof e&&(t=e.attributes,e=e.name),t=c(t),"elementNameFn"in r&&(e=r.elementNameFn(e,i)),r.compact){var o;if(n={},!r.ignoreAttributes&&t&&Object.keys(t).length)for(o in n[r.attributesKey]={},t)t.hasOwnProperty(o)&&(n[r.attributesKey][o]=t[o]);!(e in i)&&(s(r.alwaysArray)?-1!==r.alwaysArray.indexOf(e):r.alwaysArray)&&(i[e]=[]),i[e]&&!s(i[e])&&(i[e]=[i[e]]),s(i[e])?i[e].push(n):i[e]=n}else i[r.elementsKey]||(i[r.elementsKey]=[]),(n={})[r.typeKey]="element",n[r.nameKey]=e,!r.ignoreAttributes&&t&&Object.keys(t).length&&(n[r.attributesKey]=t),r.alwaysChildren&&(n[r.elementsKey]=[]),i[r.elementsKey].push(n);n[r.parentKey]=i,i=n}function f(e){r.ignoreText||(e.trim()||r.captureSpacesBetweenElements)&&(r.trim&&(e=e.trim()),r.nativeType&&(e=l(e)),r.sanitize&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),u("text",e))}function p(e){r.ignoreComment||(r.trim&&(e=e.trim()),u("comment",e))}function v(e){var t=i[r.parentKey];r.addParent||delete i[r.parentKey],i=t}function g(e){r.ignoreCdata||(r.trim&&(e=e.trim()),u("cdata",e))}function m(e){r.ignoreDoctype||(e=e.replace(/^ /,""),r.trim&&(e=e.trim()),u("doctype",e))}function y(e){e.note=e}e.exports=function(e,t){var n=o.parser(!0,{}),s={};if(i=s,r=function(e){return r=a.copyOptions(e),a.ensureFlagExists("ignoreDeclaration",r),a.ensureFlagExists("ignoreInstruction",r),a.ensureFlagExists("ignoreAttributes",r),a.ensureFlagExists("ignoreText",r),a.ensureFlagExists("ignoreComment",r),a.ensureFlagExists("ignoreCdata",r),a.ensureFlagExists("ignoreDoctype",r),a.ensureFlagExists("compact",r),a.ensureFlagExists("alwaysChildren",r),a.ensureFlagExists("addParent",r),a.ensureFlagExists("trim",r),a.ensureFlagExists("nativeType",r),a.ensureFlagExists("nativeTypeAttributes",r),a.ensureFlagExists("sanitize",r),a.ensureFlagExists("instructionHasAttributes",r),a.ensureFlagExists("captureSpacesBetweenElements",r),a.ensureAlwaysArrayExists(r),a.ensureKeyExists("declaration",r),a.ensureKeyExists("instruction",r),a.ensureKeyExists("attributes",r),a.ensureKeyExists("text",r),a.ensureKeyExists("comment",r),a.ensureKeyExists("cdata",r),a.ensureKeyExists("doctype",r),a.ensureKeyExists("type",r),a.ensureKeyExists("name",r),a.ensureKeyExists("elements",r),a.ensureKeyExists("parent",r),a.checkFnExists("doctype",r),a.checkFnExists("instruction",r),a.checkFnExists("cdata",r),a.checkFnExists("comment",r),a.checkFnExists("text",r),a.checkFnExists("instructionName",r),a.checkFnExists("elementName",r),a.checkFnExists("attributeName",r),a.checkFnExists("attributeValue",r),a.checkFnExists("attributes",r),r}(t),n.opt={strictEntities:!0},n.onopentag=h,n.ontext=f,n.oncomment=p,n.onclosetag=v,n.onerror=y,n.oncdata=g,n.ondoctype=m,n.onprocessinginstruction=d,n.write(e).close(),s[r.elementsKey]){var l=s[r.elementsKey];delete s[r.elementsKey],s[r.elementsKey]=l,delete s.text}return s}},1388:function(e,t,n){var r=n(4740),i=n(1229);e.exports=function(e,t){var n,o,a;return n=function(e){var t=r.copyOptions(e);return r.ensureSpacesExists(t),t}(t),o=i(e,n),a="compact"in n&&n.compact?"_parent":"parent",("addParent"in n&&n.addParent?JSON.stringify(o,(function(e,t){return e===a?"_":t}),n.spaces):JSON.stringify(o,null,n.spaces)).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}},255:function(e){var t={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};e.exports=function(e){return e&&e.replace?e.replace(/([&"<>'])/g,(function(e,n){return t[n]})):e}},3479:function(e,t,n){var r=n(4155),i=n(255),o=n(2830).Stream;function a(e,t,n){n=n||0;var r,o,s=(r=t,new Array(n||0).join(r||"")),l=e;if("object"==typeof e&&(l=e[o=Object.keys(e)[0]])&&l._elem)return l._elem.name=o,l._elem.icount=n,l._elem.indent=t,l._elem.indents=s,l._elem.interrupt=l,l._elem;var u,c=[],d=[];function h(e){Object.keys(e).forEach((function(t){c.push(function(e,t){return e+'="'+i(t)+'"'}(t,e[t]))}))}switch(typeof l){case"object":if(null===l)break;l._attr&&h(l._attr),l._cdata&&d.push(("<![CDATA["+l._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),l.forEach&&(u=!1,d.push(""),l.forEach((function(e){"object"==typeof e?"_attr"==Object.keys(e)[0]?h(e._attr):d.push(a(e,t,n+1)):(d.pop(),u=!0,d.push(i(e)))})),u||d.push(""));break;default:d.push(i(l))}return{name:o,interrupt:!1,attributes:c,content:d,icount:n,indents:s,indent:t}}function s(e,t,n){if("object"!=typeof t)return e(!1,t);var r=t.interrupt?1:t.content.length;function i(){for(;t.content.length;){var i=t.content.shift();if(void 0!==i){if(o(i))return;s(e,i)}}e(!1,(r>1?t.indents:"")+(t.name?"</"+t.name+">":"")+(t.indent&&!n?"\n":"")),n&&n()}function o(t){return!!t.interrupt&&(t.interrupt.append=e,t.interrupt.end=i,t.interrupt=!1,e(!0),!0)}if(e(!1,t.indents+(t.name?"<"+t.name:"")+(t.attributes.length?" "+t.attributes.join(" "):"")+(r?t.name?">":"":t.name?"/>":"")+(t.indent&&r>1?"\n":"")),!r)return e(!1,t.indent?"\n":"");o(t)||i()}e.exports=function(e,t){"object"!=typeof t&&(t={indent:t});var n,i,l=t.stream?new o:null,u="",c=!1,d=t.indent?!0===t.indent?"    ":t.indent:"",h=!0;function f(e){h?r.nextTick(e):e()}function p(e,t){if(void 0!==t&&(u+=t),e&&!c&&(l=l||new o,c=!0),e&&c){var n=u;f((function(){l.emit("data",n)})),u=""}}function v(e,t){s(p,a(e,d,d?1:0),t)}function g(){if(l){var e=u;f((function(){l.emit("data",e),l.emit("end"),l.readable=!1,l.emit("close")}))}}return f((function(){h=!1})),t.declaration&&(i={version:"1.0",encoding:(n=t.declaration).encoding||"UTF-8"},n.standalone&&(i.standalone=n.standalone),v({"?xml":{_attr:i}}),u=u.replace("/>","?>")),e&&e.forEach?e.forEach((function(t,n){var r;n+1===e.length&&(r=g),v(t,r)})):v(e,g),l?(l.readable=!0,l):u},e.exports.element=e.exports.Element=function(){var e={_elem:a(Array.prototype.slice.call(arguments)),push:function(e){if(!this.append)throw new Error("not assigned to a parent!");var t=this,n=this._elem.indent;s(this.append,a(e,n,this._elem.icount+(n?1:0)),(function(){t.append(!0)}))},close:function(e){void 0!==e&&this.push(e),this.end&&this.end()}};return e}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var g={};return function(){"use strict";n.r(g),n.d(g,{AbstractNumbering:function(){return fa},Alignment:function(){return q},AlignmentAttributes:function(){return K},AlignmentType:function(){return e},Attributes:function(){return D},BaseEmphasisMark:function(){return he},BaseXmlComponent:function(){return T},Body:function(){return xr},Bookmark:function(){return Un},BookmarkEnd:function(){return qn},BookmarkStart:function(){return Kn},Border:function(){return Q},BorderElement:function(){return X},BorderStyle:function(){return t},Column:function(){return Rr},ColumnAttributes:function(){return Tr},ColumnBreak:function(){return Tn},Columns:function(){return nr},ColumnsAttributes:function(){return tr},Comment:function(){return Sn},CommentRangeEnd:function(){return bn},CommentRangeStart:function(){return wn},CommentReference:function(){return Cn},Comments:function(){return En},ConcreteHyperlink:function(){return jn},ConcreteNumbering:function(){return ga},DeletedTextRun:function(){return ms},DocGridAttributes:function(){return rr},Document:function(){return es},DocumentAttributes:function(){return Ar},DocumentBackground:function(){return Or},DocumentBackgroundAttributes:function(){return _r},DocumentDefaults:function(){return Za},DocumentGrid:function(){return ir},DocumentGridType:function(){return We},DotEmphasisMark:function(){return pe},Drawing:function(){return ln},DropCapType:function(){return mr},EMPTY_OBJECT:function(){return R},EmphasisMark:function(){return fe},EmphasisMarkType:function(){return E},ExternalHyperlink:function(){return Vn},File:function(){return es},FootNoteReferenceRunAttributes:function(){return us},FootNotes:function(){return Xo},Footer:function(){return ls},FooterWrapper:function(){return Lo},FootnoteReference:function(){return cs},FootnoteReferenceRun:function(){return ds},FrameAnchorType:function(){return yr},FrameProperties:function(){return Vr},FramePropertiesAttributes:function(){return Hr},FrameWrap:function(){return wr},GridSpan:function(){return Ui},Header:function(){return ss},HeaderFooterReference:function(){return er},HeaderFooterReferenceType:function(){return He},HeaderFooterType:function(){return Ve},HeaderWrapper:function(){return Jo},HeadingLevel:function(){return Fe},HeightRule:function(){return $i},HorizontalPosition:function(){return ut},HorizontalPositionAlign:function(){return y},HorizontalPositionRelativeFrom:function(){return Ae},HpsMeasureElement:function(){return H},HyperlinkType:function(){return Be},IgnoreIfEmptyXmlComponent:function(){return _},ImageRun:function(){return un},ImportDotx:function(){return _s},ImportedRootElementAttributes:function(){return L},ImportedXmlComponent:function(){return I},Indent:function(){return $},InitializableXmlComponent:function(){return G},InsertedTextRun:function(){return hs},InternalHyperlink:function(){return Hn},LeaderType:function(){return Le},Level:function(){return ua},LevelBase:function(){return la},LevelForOverride:function(){return ca},LevelFormat:function(){return jo},LevelOverride:function(){return ya},LevelSuffix:function(){return Ho},LineNumberAttributes:function(){return or},LineNumberRestartFormat:function(){return ze},LineNumberType:function(){return ar},LineRuleType:function(){return Pe},Math:function(){return Ur},MathAccentCharacter:function(){return Jr},MathAngledBrackets:function(){return Li},MathBase:function(){return $r},MathCurlyBrackets:function(){return Ii},MathDegree:function(){return bi},MathDenominator:function(){return Xr},MathFraction:function(){return Qr},MathFunction:function(){return Ri},MathFunctionName:function(){return xi},MathFunctionProperties:function(){return Ti},MathIntegral:function(){return ci},MathLimitLocation:function(){return ti},MathNAryProperties:function(){return ai},MathNumerator:function(){return Yr},MathPreSubSuperScript:function(){return yi},MathPreSubSuperScriptProperties:function(){return mi},MathRadical:function(){return ki},MathRadicalProperties:function(){return Ei},MathRoundBrackets:function(){return Pi},MathRun:function(){return qr},MathSquareBrackets:function(){return Fi},MathSubScript:function(){return pi},MathSubScriptElement:function(){return si},MathSubScriptProperties:function(){return fi},MathSubSuperScript:function(){return gi},MathSubSuperScriptProperties:function(){return vi},MathSum:function(){return ui},MathSuperScript:function(){return hi},MathSuperScriptElement:function(){return li},MathSuperScriptProperties:function(){return di},Media:function(){return $o},NumberFormat:function(){return b},NumberProperties:function(){return Fn},NumberValueElement:function(){return W},Numbering:function(){return Ca},OnOffElement:function(){return j},OutlineLevel:function(){return Xn},OverlapType:function(){return Zi},Packer:function(){return xs},PageBorderDisplay:function(){return Ue},PageBorderOffsetFrom:function(){return Ke},PageBorderZOrder:function(){return qe},PageBorders:function(){return lr},PageBreak:function(){return xn},PageBreakBefore:function(){return Rn},PageMargin:function(){return cr},PageMarginAttributes:function(){return ur},PageNumber:function(){return x},PageNumberSeparator:function(){return Xe},PageNumberType:function(){return hr},PageNumberTypeAttributes:function(){return dr},PageOrientation:function(){return Ye},PageReference:function(){return Qn},PageSize:function(){return pr},PageSizeAttributes:function(){return fr},PageTextDirection:function(){return gr},PageTextDirectionType:function(){return Qe},Paragraph:function(){return zr},ParagraphProperties:function(){return Wr},ParagraphPropertiesDefaults:function(){return Ya},PrettifyType:function(){return oa},RelativeHorizontalPosition:function(){return Yi},RelativeVerticalPosition:function(){return Qi},Run:function(){return Je},RunFonts:function(){return be},RunProperties:function(){return xe},RunPropertiesChange:function(){return Te},RunPropertiesDefaults:function(){return Qa},SectionProperties:function(){return kr},SectionType:function(){return Ze},SectionTypeAttributes:function(){return br},SequentialIdentifier:function(){return dn},Shading:function(){return ce},ShadingType:function(){return S},SimpleField:function(){return pn},SimpleMailMergeField:function(){return vn},SimplePos:function(){return ot},SpaceType:function(){return C},Spacing:function(){return _n},StringContainer:function(){return U},StringEnumValueElement:function(){return z},StringValueElement:function(){return V},Style:function(){return On},StyleForCharacter:function(){return Pa},StyleForParagraph:function(){return Na},StyleLevel:function(){return as},Styles:function(){return Xa},SymbolRun:function(){return nt},TDirection:function(){return no},Tab:function(){return hn},TabAttributes:function(){return Nn},TabStop:function(){return Dn},TabStopItem:function(){return Pn},TabStopPosition:function(){return Me},TabStopType:function(){return Ie},Table:function(){return po},TableAnchorType:function(){return Xi},TableBorders:function(){return so},TableCell:function(){return io},TableCellBorders:function(){return Wi},TableFloatOptionsAttributes:function(){return lo},TableFloatProperties:function(){return uo},TableLayout:function(){return ho},TableLayoutType:function(){return Ji},TableOfContents:function(){return os},TableProperties:function(){return fo},TableRow:function(){return yo},TableRowHeight:function(){return go},TableRowHeightAttributes:function(){return vo},TableRowProperties:function(){return mo},TableWidthElement:function(){return Hi},TextDirection:function(){return jr},TextRun:function(){return $e},TextWrappingSide:function(){return De},TextWrappingType:function(){return Oe},ThematicBreak:function(){return Z},Type:function(){return Cr},Underline:function(){return ke},UnderlineType:function(){return k},VerticalAlign:function(){return je},VerticalAlignAttributes:function(){return Zn},VerticalAlignElement:function(){return Jn},VerticalMerge:function(){return qi},VerticalMergeType:function(){return Br},VerticalPosition:function(){return dt},VerticalPositionAlign:function(){return w},VerticalPositionRelativeFrom:function(){return _e},WORKAROUND:function(){return ts},WORKAROUND2:function(){return ea},WORKAROUND3:function(){return M},WORKAROUND4:function(){return wi},WidthType:function(){return Mr},WrapNone:function(){return Ht},WrapSquare:function(){return Wt},WrapTight:function(){return Ut},WrapTopAndBottom:function(){return qt},XmlAttributeComponent:function(){return O},XmlComponent:function(){return A},convertInchesToTwip:function(){return Os.convertInchesToTwip},convertMillimetersToTwip:function(){return Os.convertMillimetersToTwip},convertToXmlComponent:function(){return P},dateTimeValue:function(){return Os.dateTimeValue},decimalNumber:function(){return Os.decimalNumber},eighthPointMeasureValue:function(){return Os.eighthPointMeasureValue},hexColorValue:function(){return Os.hexColorValue},hpsMeasureValue:function(){return Os.hpsMeasureValue},longHexNumber:function(){return Os.longHexNumber},measurementOrPercentValue:function(){return Os.measurementOrPercentValue},percentageValue:function(){return Os.percentageValue},pointMeasureValue:function(){return Os.pointMeasureValue},positiveUniversalMeasureValue:function(){return Os.positiveUniversalMeasureValue},sectionMarginDefaults:function(){return Sr},sectionPageSizeDefaults:function(){return Er},shortHexNumber:function(){return Os.shortHexNumber},signedHpsMeasureValue:function(){return Os.signedHpsMeasureValue},signedTwipsMeasureValue:function(){return Os.signedTwipsMeasureValue},twipsMeasureValue:function(){return Os.twipsMeasureValue},uCharHexNumber:function(){return Os.uCharHexNumber},uniqueId:function(){return Os.uniqueId},uniqueNumericId:function(){return Os.uniqueNumericId},universalMeasureValue:function(){return Os.universalMeasureValue},unsignedDecimalNumber:function(){return Os.unsignedDecimalNumber}});var e,t,m,y,w,b,C,S,E,k,x,T=h((function e(t){d(this,e),this.rootKey=t})),R=Object.seal({}),A=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).root=new Array,r}return h(n,[{key:"prepForXml",value:function(e){var t,n=this.root.map((function(t){return t instanceof T?t.prepForXml(e):t})).filter((function(e){return void 0!==e}));return c({},this.rootKey,n.length?1===n.length&&(null===(t=n[0])||void 0===t?void 0:t._attr)?n[0]:n:R)}},{key:"addChildElement",value:function(e){return this.root.push(e),this}}]),n}(T),_=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.apply(this,arguments)}return h(n,[{key:"prepForXml",value:function(e){var t=l(u(n.prototype),"prepForXml",this).call(this,e);if(t&&("object"!=typeof t[this.rootKey]||Object.keys(t[this.rootKey]).length))return t}}]),n}(A),O=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"_attr")).root=e,r}return h(n,[{key:"prepForXml",value:function(e){var t=this,n={};return Object.keys(this.root).forEach((function(e){var r=t.root[e];if(void 0!==r){var i=t.xmlKeys&&t.xmlKeys[e]||e;n[i]=r}})),{_attr:n}}}]),n}(T),D=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"},e}return h(n)}(O),N=n(7888),P=function e(t){switch(t.type){case void 0:case"element":var n,r=new I(t.name,t.attributes),i=t.elements||[],o=s(i);try{for(o.s();!(n=o.n()).done;){var a=e(n.value);void 0!==a&&r.push(a)}}catch(l){o.e(l)}finally{o.f()}return r;case"text":return t.text;default:return}},F=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.apply(this,arguments)}return h(n)}(O),I=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),i=t.call(this,e),r&&i.root.push(new F(r)),i}return h(n,[{key:"push",value:function(e){this.root.push(e)}}],[{key:"fromXmlString",value:function(e){var t=(0,N.xml2js)(e,{compact:!1});return P(t)}}]),n}(A),L=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,""))._attr=e,r}return h(n,[{key:"prepForXml",value:function(e){return{_attr:this._attr}}}]),n}(A),M="",G=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),i=t.call(this,e),r&&(i.root=r.root),i}return h(n)}(A),B=n(6595),j=function(e){p(n,e);var t=v(n);function n(e){var r,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return d(this,n),r=t.call(this,e),!0!==i&&r.root.push(new D({val:i})),r}return h(n)}(A),H=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,e)).root.push(new D({val:(0,B.KR)(r)})),i}return h(n)}(A),V=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,e)).root.push(new D({val:r})),i}return h(n)}(A),W=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,e)).root.push(new D({val:r})),i}return h(n)}(A),z=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,e)).root.push(new D({val:r})),i}return h(n)}(A),U=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,e)).root.push(r),i}return h(n)}(A);!function(e){e.START="start",e.CENTER="center",e.END="end",e.BOTH="both",e.MEDIUM_KASHIDA="mediumKashida",e.DISTRIBUTE="distribute",e.NUM_TAB="numTab",e.HIGH_KASHIDA="highKashida",e.LOW_KASHIDA="lowKashida",e.THAI_DISTRIBUTE="thaiDistribute",e.LEFT="left",e.RIGHT="right",e.JUSTIFIED="both"}(e||(e={}));var K=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={val:"w:val"},e}return h(n)}(O),q=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:jc")).root.push(new K({val:e})),r}return h(n)}(A),X=function(e){p(n,e);var t=v(n);function n(e,r){var i,o=r.color,a=r.size,s=r.space,l=r.style;return d(this,n),(i=t.call(this,e)).root.push(new Y({style:l,color:void 0===o?void 0:(0,B.dg)(o),size:void 0===a?void 0:(0,B.LV)(a),space:void 0===s?void 0:(0,B.gg)(s)})),i}return h(n)}(A),Y=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={style:"w:val",color:"w:color",size:"w:sz",space:"w:space"},e}return h(n)}(O);!function(e){e.SINGLE="single",e.DASH_DOT_STROKED="dashDotStroked",e.DASHED="dashed",e.DASH_SMALL_GAP="dashSmallGap",e.DOT_DASH="dotDash",e.DOT_DOT_DASH="dotDotDash",e.DOTTED="dotted",e.DOUBLE="double",e.DOUBLE_WAVE="doubleWave",e.INSET="inset",e.NIL="nil",e.NONE="none",e.OUTSET="outset",e.THICK="thick",e.THICK_THIN_LARGE_GAP="thickThinLargeGap",e.THICK_THIN_MEDIUM_GAP="thickThinMediumGap",e.THICK_THIN_SMALL_GAP="thickThinSmallGap",e.THIN_THICK_LARGE_GAP="thinThickLargeGap",e.THIN_THICK_MEDIUM_GAP="thinThickMediumGap",e.THIN_THICK_SMALL_GAP="thinThickSmallGap",e.THIN_THICK_THIN_LARGE_GAP="thinThickThinLargeGap",e.THIN_THICK_THIN_MEDIUM_GAP="thinThickThinMediumGap",e.THIN_THICK_THIN_SMALL_GAP="thinThickThinSmallGap",e.THREE_D_EMBOSS="threeDEmboss",e.THREE_D_ENGRAVE="threeDEngrave",e.TRIPLE="triple",e.WAVE="wave"}(t||(t={}));var Q=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),r=t.call(this,"w:pBdr"),e.top&&r.root.push(new X("w:top",e.top)),e.bottom&&r.root.push(new X("w:bottom",e.bottom)),e.left&&r.root.push(new X("w:left",e.left)),e.right&&r.root.push(new X("w:right",e.right)),r}return h(n)}(_),Z=function(e){p(r,e);var n=v(r);function r(){var e;d(this,r),e=n.call(this,"w:pBdr");var i=new X("w:bottom",{color:"auto",space:1,style:t.SINGLE,size:6});return e.root.push(i),e}return h(r)}(A),J=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={start:"w:start",end:"w:end",left:"w:left",right:"w:right",hanging:"w:hanging",firstLine:"w:firstLine"},e}return h(n)}(O),$=function(e){p(n,e);var t=v(n);function n(e){var r,i=e.start,o=e.end,a=e.left,s=e.right,l=e.hanging,u=e.firstLine;return d(this,n),(r=t.call(this,"w:ind")).root.push(new J({start:void 0===i?void 0:(0,B.xb)(i),end:void 0===o?void 0:(0,B.xb)(o),left:void 0===a?void 0:(0,B.xb)(a),right:void 0===s?void 0:(0,B.xb)(s),hanging:void 0===l?void 0:(0,B.Jd)(l),firstLine:void 0===u?void 0:(0,B.Jd)(u)})),r}return h(n)}(A),ee=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"w:br")}return h(n)}(A);!function(e){e.BEGIN="begin",e.END="end",e.SEPARATE="separate"}(m||(m={}));var te=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={type:"w:fldCharType",dirty:"w:dirty"},e}return h(n)}(O),ne=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:fldChar")).root.push(new te({type:m.BEGIN,dirty:e})),r}return h(n)}(A),re=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:fldChar")).root.push(new te({type:m.SEPARATE,dirty:e})),r}return h(n)}(A),ie=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:fldChar")).root.push(new te({type:m.END,dirty:e})),r}return h(n)}(A);!function(e){e.CENTER="center",e.INSIDE="inside",e.LEFT="left",e.OUTSIDE="outside",e.RIGHT="right"}(y||(y={})),function(e){e.BOTTOM="bottom",e.CENTER="center",e.INSIDE="inside",e.OUTSIDE="outside",e.TOP="top"}(w||(w={})),function(e){e.DECIMAL="decimal",e.UPPER_ROMAN="upperRoman",e.LOWER_ROMAN="lowerRoman",e.UPPER_LETTER="upperLetter",e.LOWER_LETTER="lowerLetter",e.ORDINAL="ordinal",e.CARDINAL_TEXT="cardinalText",e.ORDINAL_TEXT="ordinalText",e.HEX="hex",e.CHICAGO="chicago",e.IDEOGRAPH_DIGITAL="ideographDigital",e.JAPANESE_COUNTING="japaneseCounting",e.AIUEO="aiueo",e.IROHA="iroha",e.DECIMAL_FULL_WIDTH="decimalFullWidth",e.DECIMAL_HALF_WIDTH="decimalHalfWidth",e.JAPANESE_LEGAL="japaneseLegal",e.JAPANESE_DIGITAL_TEN_THOUSAND="japaneseDigitalTenThousand",e.DECIMAL_ENCLOSED_CIRCLE="decimalEnclosedCircle",e.DECIMAL_FULL_WIDTH_2="decimalFullWidth2",e.AIUEO_FULL_WIDTH="aiueoFullWidth",e.IROHA_FULL_WIDTH="irohaFullWidth",e.DECIMAL_ZERO="decimalZero",e.BULLET="bullet",e.GANADA="ganada",e.CHOSUNG="chosung",e.DECIMAL_ENCLOSED_FULL_STOP="decimalEnclosedFullstop",e.DECIMAL_ENCLOSED_PAREN="decimalEnclosedParen",e.DECIMAL_ENCLOSED_CIRCLE_CHINESE="decimalEnclosedCircleChinese",e.IDEOGRAPH_ENCLOSED_CIRCLE="ideographEnclosedCircle",e.IDEOGRAPH_TRADITIONAL="ideographTraditional",e.IDEOGRAPH_ZODIAC="ideographZodiac",e.IDEOGRAPH_ZODIAC_TRADITIONAL="ideographZodiacTraditional",e.TAIWANESE_COUNTING="taiwaneseCounting",e.IDEOGRAPH_LEGAL_TRADITIONAL="ideographLegalTraditional",e.TAIWANESE_COUNTING_THOUSAND="taiwaneseCountingThousand",e.TAIWANESE_DIGITAL="taiwaneseDigital",e.CHINESE_COUNTING="chineseCounting",e.CHINESE_LEGAL_SIMPLIFIED="chineseLegalSimplified",e.CHINESE_COUNTING_TEN_THOUSAND="chineseCountingThousand",e.KOREAN_DIGITAL="koreanDigital",e.KOREAN_COUNTING="koreanCounting",e.KOREAN_LEGAL="koreanLegal",e.KOREAN_DIGITAL_2="koreanDigital2",e.VIETNAMESE_COUNTING="vietnameseCounting",e.RUSSIAN_LOWER="russianLower",e.RUSSIAN_UPPER="russianUpper",e.NONE="none",e.NUMBER_IN_DASH="numberInDash",e.HEBREW_1="hebrew1",e.HEBREW_2="hebrew2",e.ARABIC_ALPHA="arabicAlpha",e.ARABIC_ABJAD="arabicAbjad",e.HINDI_VOWELS="hindiVowels",e.HINDI_CONSONANTS="hindiConsonants",e.HINDI_NUMBERS="hindiNumbers",e.HINDI_COUNTING="hindiCounting",e.THAI_LETTERS="thaiLetters",e.THAI_NUMBERS="thaiNumbers",e.THAI_COUNTING="thaiCounting",e.BAHT_TEXT="bahtText",e.DOLLAR_TEXT="dollarText"}(b||(b={})),function(e){e.DEFAULT="default",e.PRESERVE="preserve"}(C||(C={}));var oe=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={space:"xml:space"},e}return h(n)}(O),ae=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"w:instrText")).root.push(new oe({space:C.PRESERVE})),e.root.push("PAGE"),e}return h(n)}(A),se=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"w:instrText")).root.push(new oe({space:C.PRESERVE})),e.root.push("NUMPAGES"),e}return h(n)}(A),le=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"w:instrText")).root.push(new oe({space:C.PRESERVE})),e.root.push("SECTIONPAGES"),e}return h(n)}(A),ue=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={fill:"w:fill",color:"w:color",type:"w:val"},e}return h(n)}(O),ce=function(e){p(n,e);var t=v(n);function n(e){var r,i=e.fill,o=e.color,a=e.type;return d(this,n),(r=t.call(this,"w:shd")).root.push(new ue({fill:void 0===i?void 0:(0,B.dg)(i),color:void 0===o?void 0:(0,B.dg)(o),type:a})),r}return h(n)}(A);!function(e){e.CLEAR="clear",e.DIAGONAL_CROSS="diagCross",e.DIAGONAL_STRIPE="diagStripe",e.HORIZONTAL_CROSS="horzCross",e.HORIZONTAL_STRIPE="horzStripe",e.NIL="nil",e.PERCENT_5="pct5",e.PERCENT_10="pct10",e.PERCENT_12="pct12",e.PERCENT_15="pct15",e.PERCENT_20="pct20",e.PERCENT_25="pct25",e.PERCENT_30="pct30",e.PERCENT_35="pct35",e.PERCENT_37="pct37",e.PERCENT_40="pct40",e.PERCENT_45="pct45",e.PERCENT_50="pct50",e.PERCENT_55="pct55",e.PERCENT_60="pct60",e.PERCENT_62="pct62",e.PERCENT_65="pct65",e.PERCENT_70="pct70",e.PERCENT_75="pct75",e.PERCENT_80="pct80",e.PERCENT_85="pct85",e.PERCENT_87="pct87",e.PERCENT_90="pct90",e.PERCENT_95="pct95",e.REVERSE_DIAGONAL_STRIPE="reverseDiagStripe",e.SOLID="solid",e.THIN_DIAGONAL_CROSS="thinDiagCross",e.THIN_DIAGONAL_STRIPE="thinDiagStripe",e.THIN_HORIZONTAL_CROSS="thinHorzCross",e.THIN_REVERSE_DIAGONAL_STRIPE="thinReverseDiagStripe",e.THIN_VERTICAL_STRIPE="thinVertStripe",e.VERTICAL_STRIPE="vertStripe"}(S||(S={}));var de=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={id:"w:id",author:"w:author",date:"w:date"},e}return h(n)}(O);!function(e){e.DOT="dot"}(E||(E={}));var he=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:em")).root.push(new D({val:e})),r}return h(n)}(A),fe=function(e){p(n,e);var t=v(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E.DOT;return d(this,n),t.call(this,e)}return h(n)}(he),pe=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,E.DOT)}return h(n)}(he),ve=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:spacing")).root.push(new D({val:(0,B.xb)(e)})),r}return h(n)}(A),ge=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:color")).root.push(new D({val:(0,B.dg)(e)})),r}return h(n)}(A),me=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:highlight")).root.push(new D({val:e})),r}return h(n)}(A),ye=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:highlightCs")).root.push(new D({val:e})),r}return h(n)}(A),we=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"},e}return h(n)}(O),be=function(e){p(n,e);var t=v(n);function n(e,r){var i;if(d(this,n),i=t.call(this,"w:rFonts"),"string"==typeof e){var o=e;i.root.push(new we({ascii:o,cs:o,eastAsia:o,hAnsi:o,hint:r}))}else{var s=e;i.root.push(new we(s))}return a(i)}return h(n)}(A),Ce=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:vertAlign")).root.push(new D({val:e})),r}return h(n)}(A),Se=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"superscript")}return h(n)}(Ce),Ee=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"subscript")}return h(n)}(Ce);!function(e){e.SINGLE="single",e.WORDS="words",e.DOUBLE="double",e.THICK="thick",e.DOTTED="dotted",e.DOTTEDHEAVY="dottedHeavy",e.DASH="dash",e.DASHEDHEAVY="dashedHeavy",e.DASHLONG="dashLong",e.DASHLONGHEAVY="dashLongHeavy",e.DOTDASH="dotDash",e.DASHDOTHEAVY="dashDotHeavy",e.DOTDOTDASH="dotDotDash",e.DASHDOTDOTHEAVY="dashDotDotHeavy",e.WAVE="wave",e.WAVYHEAVY="wavyHeavy",e.WAVYDOUBLE="wavyDouble",e.NONE="none"}(k||(k={}));var ke=function(e){p(n,e);var t=v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k.SINGLE,i=arguments.length>1?arguments[1]:void 0;return d(this,n),(e=t.call(this,"w:u")).root.push(new D({val:r,color:void 0===i?void 0:(0,B.dg)(i)})),e}return h(n)}(A),xe=function(e){p(n,e);var t=v(n);function n(e){var r,i,o;if(d(this,n),r=t.call(this,"w:rPr"),!e)return a(r);void 0!==e.bold&&r.push(new j("w:b",e.bold)),(void 0===e.boldComplexScript&&void 0!==e.bold||e.boldComplexScript)&&r.push(new j("w:bCs",null!==(i=e.boldComplexScript)&&void 0!==i?i:e.bold)),void 0!==e.italics&&r.push(new j("w:i",e.italics)),(void 0===e.italicsComplexScript&&void 0!==e.italics||e.italicsComplexScript)&&r.push(new j("w:iCs",null!==(o=e.italicsComplexScript)&&void 0!==o?o:e.italics)),e.underline&&r.push(new ke(e.underline.type,e.underline.color)),e.emphasisMark&&r.push(new fe(e.emphasisMark.type)),e.color&&r.push(new ge(e.color)),void 0!==e.size&&r.push(new H("w:sz",e.size));var s=void 0===e.sizeComplexScript||!0===e.sizeComplexScript?e.size:e.sizeComplexScript;s&&r.push(new H("w:szCs",s)),void 0!==e.rightToLeft&&r.push(new j("w:rtl",e.rightToLeft)),void 0!==e.smallCaps?r.push(new j("w:smallCaps",e.smallCaps)):void 0!==e.allCaps&&r.push(new j("w:caps",e.allCaps)),void 0!==e.strike&&r.push(new j("w:strike",e.strike)),void 0!==e.doubleStrike&&r.push(new j("w:dstrike",e.doubleStrike)),e.subScript&&r.push(new Ee),e.superScript&&r.push(new Se),e.style&&r.push(new V("w:rStyle",e.style)),e.font&&("string"==typeof e.font?r.push(new be(e.font)):"name"in e.font?r.push(new be(e.font.name,e.font.hint)):r.push(new be(e.font))),e.highlight&&r.push(new me(e.highlight));var l=void 0===e.highlightComplexScript||!0===e.highlightComplexScript?e.highlight:e.highlightComplexScript;return l&&r.push(new ye(l)),e.characterSpacing&&r.push(new ve(e.characterSpacing)),void 0!==e.emboss&&r.push(new j("w:emboss",e.emboss)),void 0!==e.imprint&&r.push(new j("w:imprint",e.imprint)),e.shading&&r.push(new ce(e.shading)),e.revision&&r.push(new Te(e.revision)),e.border&&r.push(new X("w:bdr",e.border)),e.vanish&&r.push(new j("w:vanish",e.vanish)),e.specVanish&&r.push(new j("w:specVanish",e.vanish)),void 0!==e.scale&&r.push(new W("w:w",e.scale)),a(r)}return h(n,[{key:"push",value:function(e){this.root.push(e)}}]),n}(_),Te=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:rPrChange")).root.push(new de({id:e.id,author:e.author,date:e.date})),r.addChildElement(new xe(e)),r}return h(n)}(A),Re=function(e){p(n,e);var t=v(n);function n(e){var r,i;return d(this,n),a(r,(r=t.call(this,"w:t"),"string"==typeof e?(r.root.push(new oe({space:C.PRESERVE})),r.root.push(e),f(r)):(r.root.push(new oe({space:null!==(i=e.space)&&void 0!==i?i:C.DEFAULT})),r.root.push(e.text),f(r))))}return h(n)}(A);!function(e){e.CURRENT="CURRENT",e.TOTAL_PAGES="TOTAL_PAGES",e.TOTAL_PAGES_IN_SECTION="TOTAL_PAGES_IN_SECTION"}(x||(x={}));var Ae,_e,Oe,De,Ne,Pe,Fe,Ie,Le,Me,Ge,Be,je,He,Ve,We,ze,Ue,Ke,qe,Xe,Ye,Qe,Ze,Je=function(e){p(n,e);var t=v(n);function n(e){var r;if(d(this,n),(r=t.call(this,"w:r")).properties=new xe(e),r.root.push(r.properties),e.break)for(var i=0;i<e.break;i++)r.root.push(new ee);if(e.children){var o,l=s(e.children);try{for(l.s();!(o=l.n()).done;){var u=o.value;if("string"!=typeof u)r.root.push(u);else switch(u){case x.CURRENT:r.root.push(new ne),r.root.push(new ae),r.root.push(new re),r.root.push(new ie);break;case x.TOTAL_PAGES:r.root.push(new ne),r.root.push(new se),r.root.push(new re),r.root.push(new ie);break;case x.TOTAL_PAGES_IN_SECTION:r.root.push(new ne),r.root.push(new le),r.root.push(new re),r.root.push(new ie);break;default:r.root.push(new Re(u))}}}catch(c){l.e(c)}finally{l.f()}}else e.text&&r.root.push(new Re(e.text));return a(r)}return h(n)}(A),$e=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),"string"==typeof e?a(r,((r=t.call(this,{})).root.push(new Re(e)),f(r))):t.call(this,e)}return h(n)}(Je),et=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={char:"w:char",symbolfont:"w:font"},e}return h(n)}(O),tt=function(e){p(n,e);var t=v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Wingdings";return d(this,n),(e=t.call(this,"w:sym")).root.push(new et({char:r,symbolfont:i})),e}return h(n)}(A),nt=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),"string"==typeof e?a(r,((r=t.call(this,{})).root.push(new tt(e)),f(r))):((r=t.call(this,e)).root.push(new tt(e.char,e.symbolfont)),a(r))}return h(n)}(Je),rt=n(5457);!function(e){e.CHARACTER="character",e.COLUMN="column",e.INSIDE_MARGIN="insideMargin",e.LEFT_MARGIN="leftMargin",e.MARGIN="margin",e.OUTSIDE_MARGIN="outsideMargin",e.PAGE="page",e.RIGHT_MARGIN="rightMargin"}(Ae||(Ae={})),function(e){e.BOTTOM_MARGIN="bottomMargin",e.INSIDE_MARGIN="insideMargin",e.LINE="line",e.MARGIN="margin",e.OUTSIDE_MARGIN="outsideMargin",e.PAGE="page",e.PARAGRAPH="paragraph",e.TOP_MARGIN="topMargin"}(_e||(_e={}));var it=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={x:"x",y:"y"},e}return h(n)}(O),ot=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"wp:simplePos")).root.push(new it({x:0,y:0})),e}return h(n)}(A),at=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"wp:align")).root.push(e),r}return h(n)}(A),st=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"wp:posOffset")).root.push(e.toString()),r}return h(n)}(A),lt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={relativeFrom:"relativeFrom"},e}return h(n)}(O),ut=function(e){p(n,e);var t=v(n);function n(e){var r;if(d(this,n),(r=t.call(this,"wp:positionH")).root.push(new lt({relativeFrom:e.relative||Ae.PAGE})),e.align)r.root.push(new at(e.align));else{if(void 0===e.offset)throw new Error("There is no configuration provided for floating position (Align or offset)");r.root.push(new st(e.offset))}return a(r)}return h(n)}(A),ct=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={relativeFrom:"relativeFrom"},e}return h(n)}(O),dt=function(e){p(n,e);var t=v(n);function n(e){var r;if(d(this,n),(r=t.call(this,"wp:positionV")).root.push(new ct({relativeFrom:e.relative||_e.PAGE})),e.align)r.root.push(new at(e.align));else{if(void 0===e.offset)throw new Error("There is no configuration provided for floating position (Align or offset)");r.root.push(new st(e.offset))}return a(r)}return h(n)}(A),ht=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={uri:"uri"},e}return h(n)}(O),ft=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={embed:"r:embed",cstate:"cstate"},e}return h(n)}(O),pt=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"a:blip")).root.push(new ft({embed:"rId{".concat(e.fileName,"}"),cstate:"none"})),r}return h(n)}(A),vt=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"a:srcRect")}return h(n)}(A),gt=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"a:fillRect")}return h(n)}(A),mt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"a:stretch")).root.push(new gt),e}return h(n)}(A),yt=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"pic:blipFill")).root.push(new pt(e)),r.root.push(new vt),r.root.push(new mt),r}return h(n)}(A),wt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={noChangeAspect:"noChangeAspect",noChangeArrowheads:"noChangeArrowheads"},e}return h(n)}(O),bt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"a:picLocks")).root.push(new wt({noChangeAspect:1,noChangeArrowheads:1})),e}return h(n)}(A),Ct=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"pic:cNvPicPr")).root.push(new bt),e}return h(n)}(A),St=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={id:"id",name:"name",descr:"descr"},e}return h(n)}(O),Et=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"pic:cNvPr")).root.push(new St({id:0,name:"",descr:""})),e}return h(n)}(A),kt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"pic:nvPicPr")).root.push(new Et),e.root.push(new Ct),e}return h(n)}(A),xt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={xmlns:"xmlns:pic"},e}return h(n)}(O),Tt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={cx:"cx",cy:"cy"},e}return h(n)}(O),Rt=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"a:ext")).attributes=new Tt({cx:e,cy:r}),i.root.push(i.attributes),i}return h(n)}(A),At=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={x:"x",y:"y"},e}return h(n)}(O),_t=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"a:off")).root.push(new At({x:0,y:0})),e}return h(n)}(A),Ot=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={flipVertical:"flipV",flipHorizontal:"flipH",rotation:"rot"},e}return h(n)}(O),Dt=function(e){p(n,e);var t=v(n);function n(e){var r,i,o;return d(this,n),(r=t.call(this,"a:xfrm")).root.push(new Ot({flipVertical:null===(i=e.flip)||void 0===i?void 0:i.vertical,flipHorizontal:null===(o=e.flip)||void 0===o?void 0:o.horizontal,rotation:e.rotation})),r.extents=new Rt(e.emus.x,e.emus.y),r.root.push(new _t),r.root.push(r.extents),r}return h(n)}(A),Nt=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"a:avLst")}return h(n)}(A),Pt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={prst:"prst"},e}return h(n)}(O),Ft=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"a:prstGeom")).root.push(new Pt({prst:"rect"})),e.root.push(new Nt),e}return h(n)}(A),It=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={bwMode:"bwMode"},e}return h(n)}(O),Lt=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"pic:spPr")).root.push(new It({bwMode:"auto"})),r.form=new Dt(e),r.root.push(r.form),r.root.push(new Ft),r}return h(n)}(A),Mt=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"pic:pic")).root.push(new xt({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),i.root.push(new kt),i.root.push(new yt(e)),i.root.push(new Lt(r)),i}return h(n)}(A),Gt=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"a:graphicData")).root.push(new ht({uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),i.pic=new Mt(e,r),i.root.push(i.pic),i}return h(n)}(A),Bt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={a:"xmlns:a"},e}return h(n)}(O),jt=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"a:graphic")).root.push(new Bt({a:"http://schemas.openxmlformats.org/drawingml/2006/main"})),i.data=new Gt(e,r),i.root.push(i.data),i}return h(n)}(A);!function(e){e[e.NONE=0]="NONE",e[e.SQUARE=1]="SQUARE",e[e.TIGHT=2]="TIGHT",e[e.TOP_AND_BOTTOM=3]="TOP_AND_BOTTOM"}(Oe||(Oe={})),function(e){e.BOTH_SIDES="bothSides",e.LEFT="left",e.RIGHT="right",e.LARGEST="largest"}(De||(De={}));var Ht=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"wp:wrapNone")}return h(n)}(A),Vt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={distT:"distT",distB:"distB",distL:"distL",distR:"distR",wrapText:"wrapText"},e}return h(n)}(O),Wt=function(e){p(n,e);var t=v(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{top:0,bottom:0,left:0,right:0};return d(this,n),(r=t.call(this,"wp:wrapSquare")).root.push(new Vt({wrapText:e.side||De.BOTH_SIDES,distT:i.top,distB:i.bottom,distL:i.left,distR:i.right})),r}return h(n)}(A),zt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={distT:"distT",distB:"distB"},e}return h(n)}(O),Ut=function(e){p(n,e);var t=v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{top:0,bottom:0};return d(this,n),(e=t.call(this,"wp:wrapTight")).root.push(new zt({distT:r.top,distB:r.bottom})),e}return h(n)}(A),Kt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={distT:"distT",distB:"distB"},e}return h(n)}(O),qt=function(e){p(n,e);var t=v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{top:0,bottom:0};return d(this,n),(e=t.call(this,"wp:wrapTopAndBottom")).root.push(new Kt({distT:r.top,distB:r.bottom})),e}return h(n)}(A),Xt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={id:"id",name:"name",description:"descr",title:"title"},e}return h(n)}(O),Yt=function(e){p(n,e);var t=v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"",description:"",title:""},i=r.name,o=r.description,a=r.title;return d(this,n),(e=t.call(this,"wp:docPr")).root.push(new Xt({id:(0,rt.NY)(),name:i,description:o,title:a})),e}return h(n)}(A),Qt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={b:"b",l:"l",r:"r",t:"t"},e}return h(n)}(O),Zt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"wp:effectExtent")).root.push(new Qt({b:0,l:0,r:0,t:0})),e}return h(n)}(A),Jt=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={cx:"cx",cy:"cy"},e}return h(n)}(O),$t=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"wp:extent")).attributes=new Jt({cx:e,cy:r}),i.root.push(i.attributes),i}return h(n)}(A),en=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={xmlns:"xmlns:a",noChangeAspect:"noChangeAspect"},e}return h(n)}(O),tn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"a:graphicFrameLocks")).root.push(new en({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:1})),e}return h(n)}(A),nn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"wp:cNvGraphicFramePr")).root.push(new tn),e}return h(n)}(A),rn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={distT:"distT",distB:"distB",distL:"distL",distR:"distR",allowOverlap:"allowOverlap",behindDoc:"behindDoc",layoutInCell:"layoutInCell",locked:"locked",relativeHeight:"relativeHeight",simplePos:"simplePos"},e}return h(n)}(O),on=function(e){p(n,e);var t=v(n);function n(e,r,i){var o;d(this,n),o=t.call(this,"wp:anchor");var a=Object.assign({allowOverlap:!0,behindDocument:!1,lockAnchor:!1,layoutInCell:!0,verticalPosition:{},horizontalPosition:{}},i.floating);if(o.root.push(new rn({distT:a.margins&&a.margins.top||0,distB:a.margins&&a.margins.bottom||0,distL:a.margins&&a.margins.left||0,distR:a.margins&&a.margins.right||0,simplePos:"0",allowOverlap:!0===a.allowOverlap?"1":"0",behindDoc:!0===a.behindDocument?"1":"0",locked:!0===a.lockAnchor?"1":"0",layoutInCell:!0===a.layoutInCell?"1":"0",relativeHeight:a.zIndex?a.zIndex:r.emus.y})),o.root.push(new ot),o.root.push(new ut(a.horizontalPosition)),o.root.push(new dt(a.verticalPosition)),o.root.push(new $t(r.emus.x,r.emus.y)),o.root.push(new Zt),void 0!==i.floating&&void 0!==i.floating.wrap)switch(i.floating.wrap.type){case Oe.SQUARE:o.root.push(new Wt(i.floating.wrap,i.floating.margins));break;case Oe.TIGHT:o.root.push(new Ut(i.floating.margins));break;case Oe.TOP_AND_BOTTOM:o.root.push(new qt(i.floating.margins));break;case Oe.NONE:default:o.root.push(new Ht)}else o.root.push(new Ht);return o.root.push(new Yt(i.docProperties)),o.root.push(new nn),o.root.push(new jt(e,r)),o}return h(n)}(A),an=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={distT:"distT",distB:"distB",distL:"distL",distR:"distR"},e}return h(n)}(O),sn=function(e){p(n,e);var t=v(n);function n(e){var r,i=e.mediaData,o=e.transform,a=e.docProperties;return d(this,n),(r=t.call(this,"wp:inline")).root.push(new an({distT:0,distB:0,distL:0,distR:0})),r.extent=new $t(o.emus.x,o.emus.y),r.graphic=new jt(i,o),r.root.push(r.extent),r.root.push(new Zt),r.root.push(new Yt(a)),r.root.push(new nn),r.root.push(r.graphic),r}return h(n)}(A),ln=function(e){p(n,e);var t=v(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d(this,n),r=t.call(this,"w:drawing"),i.floating?r.root.push(new on(e,e.transformation,i)):(r.inline=new sn({mediaData:e,transform:e.transformation,docProperties:i.docProperties}),r.root.push(r.inline)),r}return h(n)}(A),un=function(e){p(r,e);var t=v(r);function r(e){var n;d(this,r),(n=t.call(this,{})).key="".concat((0,rt.EL)(),".png");var i="string"==typeof e.data?n.convertDataURIToBinary(e.data):e.data;n.imageData={stream:i,fileName:n.key,transformation:{pixels:{x:Math.round(e.transformation.width),y:Math.round(e.transformation.height)},emus:{x:Math.round(9525*e.transformation.width),y:Math.round(9525*e.transformation.height)},flip:e.transformation.flip,rotation:e.transformation.rotation?6e4*e.transformation.rotation:void 0}};var o=new ln(n.imageData,{floating:e.floating,docProperties:e.altText});return n.root.push(o),n}return h(r,[{key:"prepForXml",value:function(e){return e.file.Media.addImage(this.key,this.imageData),l(u(r.prototype),"prepForXml",this).call(this,e)}},{key:"convertDataURIToBinary",value:function(e){if("function"==typeof atob){var t=";base64,",r=e.indexOf(t),i=-1===r?0:r+t.length;return new Uint8Array(atob(e.substring(i)).split("").map((function(e){return e.charCodeAt(0)})))}return new(n(8764).Buffer)(e,"base64")}}]),r}(Je),cn=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:instrText")).root.push(new oe({space:C.PRESERVE})),r.root.push("SEQ ".concat(e)),r}return h(n)}(A),dn=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,{})).root.push(new ne(!0)),r.root.push(new cn(e)),r.root.push(new re),r.root.push(new ie),r}return h(n)}(Je),hn=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"w:tab")}return h(n)}(A),fn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={instr:"w:instr"},e}return h(n)}(O),pn=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"w:fldSimple")).root.push(new fn({instr:e})),void 0!==r&&i.root.push(new $e(r)),i}return h(n)}(A),vn=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this," MERGEFIELD ".concat(e," "),"\xab".concat(e,"\xbb"))}return h(n)}(pn),gn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"},e}return h(n)}(O),mn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={id:"w:id"},e}return h(n)}(O),yn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"},e}return h(n)}(O),wn=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:commentRangeStart")).root.push(new mn({id:e})),r}return h(n)}(A),bn=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:commentRangeEnd")).root.push(new mn({id:e})),r}return h(n)}(A),Cn=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:commentReference")).root.push(new mn({id:e})),r}return h(n)}(A),Sn=function(e){p(n,e);var t=v(n);function n(e){var r,i=e.id,o=e.initials,a=e.author,s=e.date,l=void 0===s?new Date:s,u=e.text;return d(this,n),(r=t.call(this,"w:comment")).root.push(new gn({id:i,initials:o,author:a,date:l.toISOString()})),r.root.push(new zr({children:[new $e(u)]})),r}return h(n)}(A),En=function(e){p(n,e);var t=v(n);function n(e){var r,i=e.children;d(this,n),(r=t.call(this,"w:comments")).root.push(new yn({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));var o,a=s(i);try{for(a.s();!(o=a.n()).done;){var l=o.value;r.root.push(new Sn(l))}}catch(u){a.e(u)}finally{a.f()}return r}return h(n)}(A);!function(e){e.COLUMN="column",e.PAGE="page"}(Ne||(Ne={}));var kn=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:br")).root.push(new D({type:e})),r}return h(n)}(A),xn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,{})).root.push(new kn(Ne.PAGE)),e}return h(n)}(Je),Tn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,{})).root.push(new kn(Ne.COLUMN)),e}return h(n)}(Je),Rn=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"w:pageBreakBefore")}return h(n)}(A);!function(e){e.AT_LEAST="atLeast",e.EXACTLY="exactly",e.EXACT="exact",e.AUTO="auto"}(Pe||(Pe={}));var An=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule"},e}return h(n)}(O),_n=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:spacing")).root.push(new An(e)),r}return h(n)}(A);!function(e){e.HEADING_1="Heading1",e.HEADING_2="Heading2",e.HEADING_3="Heading3",e.HEADING_4="Heading4",e.HEADING_5="Heading5",e.HEADING_6="Heading6",e.TITLE="Title"}(Fe||(Fe={}));var On=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:pStyle")).root.push(new D({val:e})),r}return h(n)}(A),Dn=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),r=t.call(this,"w:tabs");var i,o=s(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.root.push(new Pn(a))}}catch(l){o.e(l)}finally{o.f()}return r}return h(n)}(A);!function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.BAR="bar",e.CLEAR="clear",e.DECIMAL="decimal",e.END="end",e.NUM="num",e.START="start"}(Ie||(Ie={})),function(e){e.DOT="dot",e.HYPHEN="hyphen",e.MIDDLE_DOT="middleDot",e.NONE="none",e.UNDERSCORE="underscore"}(Le||(Le={})),function(e){e[e.MAX=9026]="MAX"}(Me||(Me={}));var Nn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={val:"w:val",pos:"w:pos",leader:"w:leader"},e}return h(n)}(O),Pn=function(e){p(n,e);var t=v(n);function n(e){var r,i=e.type,o=e.position,a=e.leader;return d(this,n),(r=t.call(this,"w:tab")).root.push(new Nn({val:i,pos:o,leader:a})),r}return h(n)}(A),Fn=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"w:numPr")).root.push(new In(r)),i.root.push(new Ln(e)),i}return h(n)}(A),In=function(e){p(n,e);var t=v(n);function n(e){var r;if(d(this,n),r=t.call(this,"w:ilvl"),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");return r.root.push(new D({val:e})),a(r)}return h(n)}(A),Ln=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:numId")).root.push(new D({val:"string"==typeof e?"{".concat(e,"}"):e})),r}return h(n)}(A),Mn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"},e}return h(n)}(O);!function(e){e.EXTERNAL="External"}(Ge||(Ge={}));var Gn=function(e){p(n,e);var t=v(n);function n(e,r,i,o){var a;return d(this,n),(a=t.call(this,"Relationship")).root.push(new Mn({id:e,type:r,target:i,targetMode:o})),a}return h(n)}(A),Bn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={id:"r:id",history:"w:history",anchor:"w:anchor"},e}return h(n)}(O);!function(e){e.INTERNAL="INTERNAL",e.EXTERNAL="EXTERNAL"}(Be||(Be={}));var jn=function(e){p(n,e);var t=v(n);function n(e,r,i){var o;d(this,n),(o=t.call(this,"w:hyperlink")).linkId=r;var a={history:1,anchor:i||void 0,id:i?void 0:"rId".concat(o.linkId)},s=new Bn(a);return o.root.push(s),e.forEach((function(e){o.root.push(e)})),o}return h(n)}(A),Hn=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,e.children,(0,rt.EL)(),e.anchor)}return h(n)}(jn),Vn=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:externalHyperlink")).options=e,r}return h(n)}(A),Wn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={id:"w:id",name:"w:name"},e}return h(n)}(O),zn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={id:"w:id"},e}return h(n)}(O),Un=h((function e(t){d(this,e);var n=(0,rt.NY)();this.start=new Kn(t.id,n),this.children=t.children,this.end=new qn(n)})),Kn=function(e){p(n,e);var t=v(n);function n(e,r){var i;d(this,n),i=t.call(this,"w:bookmarkStart");var o=new Wn({name:e,id:r});return i.root.push(o),i}return h(n)}(A),qn=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),r=t.call(this,"w:bookmarkEnd");var i=new zn({id:e});return r.root.push(i),r}return h(n)}(A),Xn=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:outlineLvl")).level=e,r.root.push(new D({val:e})),r}return h(n)}(A),Yn=function(e){p(n,e);var t=v(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d(this,n),(r=t.call(this,"w:instrText")).root.push(new oe({space:C.PRESERVE}));var o="PAGEREF ".concat(e);return i.hyperlink&&(o="".concat(o," \\h")),i.useRelativePosition&&(o="".concat(o," \\p")),r.root.push(o),r}return h(n)}(A),Qn=function(e){p(n,e);var t=v(n);function n(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d(this,n),t.call(this,{children:[new ne(!0),new Yn(e,r),new ie]})}return h(n)}(Je);!function(e){e.BOTTOM="bottom",e.CENTER="center",e.TOP="top"}(je||(je={}));var Zn=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={verticalAlign:"w:val"},e}return h(n)}(O),Jn=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:vAlign")).root.push(new Zn({verticalAlign:e})),r}return h(n)}(A);!function(e){e.DEFAULT="default",e.FIRST="first",e.EVEN="even"}(He||(He={}));var $n=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={type:"w:type",id:"r:id"},e}return h(n)}(O);!function(e){e.HEADER="w:headerReference",e.FOOTER="w:footerReference"}(Ve||(Ve={}));var er=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,e)).root.push(new $n({type:r.type||He.DEFAULT,id:"rId".concat(r.id)})),i}return h(n)}(A),tr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={space:"w:space",count:"w:num",separate:"w:sep",equalWidth:"w:equalWidth"},e}return h(n)}(O),nr=function(e){p(n,e);var t=v(n);function n(e){var r,i=e.space,o=e.count,a=e.separate,s=e.equalWidth,l=e.children;return d(this,n),(r=t.call(this,"w:cols")).root.push(new tr({space:void 0===i?void 0:(0,B.Jd)(i),count:void 0===o?void 0:(0,B.vH)(o),separate:a,equalWidth:s})),!s&&l&&l.forEach((function(e){return r.addChildElement(e)})),r}return h(n)}(A);!function(e){e.DEFAULT="default",e.LINES="lines",e.LINES_AND_CHARS="linesAndChars",e.SNAP_TO_CHARS="snapToChars"}(We||(We={}));var rr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={type:"w:type",linePitch:"w:linePitch",charSpace:"w:charSpace"},e}return h(n)}(O),ir=function(e){p(n,e);var t=v(n);function n(e,r,i){var o;return d(this,n),(o=t.call(this,"w:docGrid")).root.push(new rr({type:i,linePitch:(0,B.vH)(e),charSpace:r?(0,B.vH)(r):void 0})),o}return h(n)}(A);!function(e){e.NEW_PAGE="newPage",e.NEW_SECTION="newSection",e.CONTINUOUS="continuous"}(ze||(ze={}));var or=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={countBy:"w:countBy",start:"w:start",restart:"w:restart",distance:"w:distance"},e}return h(n)}(O),ar=function(e){p(n,e);var t=v(n);function n(e){var r,i=e.countBy,o=e.start,a=e.restart,s=e.distance;return d(this,n),(r=t.call(this,"w:lnNumType")).root.push(new or({countBy:void 0===i?void 0:(0,B.vH)(i),start:void 0===o?void 0:(0,B.vH)(o),restart:a,distance:void 0===s?void 0:(0,B.Jd)(s)})),r}return h(n)}(A);!function(e){e.ALL_PAGES="allPages",e.FIRST_PAGE="firstPage",e.NOT_FIRST_PAGE="notFirstPage"}(Ue||(Ue={})),function(e){e.PAGE="page",e.TEXT="text"}(Ke||(Ke={})),function(e){e.BACK="back",e.FRONT="front"}(qe||(qe={}));var sr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"},e}return h(n)}(O),lr=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),r=t.call(this,"w:pgBorders"),e?(e.pageBorders?r.root.push(new sr({display:e.pageBorders.display,offsetFrom:e.pageBorders.offsetFrom,zOrder:e.pageBorders.zOrder})):r.root.push(new sr({})),e.pageBorderTop&&r.root.push(new X("w:top",e.pageBorderTop)),e.pageBorderLeft&&r.root.push(new X("w:left",e.pageBorderLeft)),e.pageBorderBottom&&r.root.push(new X("w:bottom",e.pageBorderBottom)),e.pageBorderRight&&r.root.push(new X("w:right",e.pageBorderRight)),a(r)):a(r,f(r))}return h(n)}(_),ur=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter"},e}return h(n)}(O),cr=function(e){p(n,e);var t=v(n);function n(e,r,i,o,a,s,l){var u;return d(this,n),(u=t.call(this,"w:pgMar")).root.push(new ur({top:(0,B.xb)(e),right:(0,B.Jd)(r),bottom:(0,B.xb)(i),left:(0,B.Jd)(o),header:(0,B.Jd)(a),footer:(0,B.Jd)(s),gutter:(0,B.Jd)(l)})),u}return h(n)}(A);!function(e){e.HYPHEN="hyphen",e.PERIOD="period",e.COLON="colon",e.EM_DASH="emDash",e.EN_DASH="endash"}(Xe||(Xe={}));var dr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={start:"w:start",formatType:"w:fmt",separator:"w:chapSep"},e}return h(n)}(O),hr=function(e){p(n,e);var t=v(n);function n(e){var r,i=e.start,o=e.formatType,a=e.separator;return d(this,n),(r=t.call(this,"w:pgNumType")).root.push(new dr({start:void 0===i?void 0:(0,B.vH)(i),formatType:o,separator:a})),r}return h(n)}(A);!function(e){e.PORTRAIT="portrait",e.LANDSCAPE="landscape"}(Ye||(Ye={}));var fr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={width:"w:w",height:"w:h",orientation:"w:orient"},e}return h(n)}(O),pr=function(e){p(n,e);var t=v(n);function n(e,r,i){var o;d(this,n),o=t.call(this,"w:pgSz");var a=i===Ye.LANDSCAPE,s=(0,B.Jd)(e),l=(0,B.Jd)(r);return o.root.push(new fr({width:a?l:s,height:a?s:l,orientation:i})),o}return h(n)}(A);!function(e){e.LEFT_TO_RIGHT_TOP_TO_BOTTOM="lrTb",e.TOP_TO_BOTTOM_RIGHT_TO_LEFT="tbRl"}(Qe||(Qe={}));var vr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={val:"w:val"},e}return h(n)}(O),gr=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:textDirection")).root.push(new vr({val:e})),r}return h(n)}(A);!function(e){e.NEXT_PAGE="nextPage",e.NEXT_COLUMN="nextColumn",e.CONTINUOUS="continuous",e.EVEN_PAGE="evenPage",e.ODD_PAGE="oddPage"}(Ze||(Ze={}));var mr,yr,wr,br=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={val:"w:val"},e}return h(n)}(O),Cr=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:type")).root.push(new br({val:e})),r}return h(n)}(A),Sr={TOP:"1in",RIGHT:"1in",BOTTOM:"1in",LEFT:"1in",HEADER:708,FOOTER:708,GUTTER:0},Er={WIDTH:11906,HEIGHT:16838,ORIENTATION:Ye.PORTRAIT},kr=function(e){p(n,e);var t=v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.page,o=void 0===i?{}:i,a=o.size,s=void 0===a?{}:a,l=s.width,u=void 0===l?Er.WIDTH:l,c=s.height,h=void 0===c?Er.HEIGHT:c,f=s.orientation,p=void 0===f?Er.ORIENTATION:f,v=o.margin,g=void 0===v?{}:v,m=g.top,y=void 0===m?Sr.TOP:m,w=g.right,b=void 0===w?Sr.RIGHT:w,C=g.bottom,S=void 0===C?Sr.BOTTOM:C,E=g.left,k=void 0===E?Sr.LEFT:E,x=g.header,T=void 0===x?Sr.HEADER:x,R=g.footer,A=void 0===R?Sr.FOOTER:R,_=g.gutter,O=void 0===_?Sr.GUTTER:_,D=o.pageNumbers,N=void 0===D?{}:D,P=o.borders,F=o.textDirection,I=r.grid,L=void 0===I?{}:I,M=L.linePitch,G=void 0===M?360:M,B=L.charSpace,H=L.type,V=r.headerWrapperGroup,W=void 0===V?{}:V,z=r.footerWrapperGroup,U=void 0===z?{}:z,K=r.lineNumbers,q=r.titlePage,X=r.verticalAlign,Y=r.column,Q=r.type;return d(this,n),(e=t.call(this,"w:sectPr")).addHeaderFooterGroup(Ve.HEADER,W),e.addHeaderFooterGroup(Ve.FOOTER,U),Q&&e.root.push(new Cr(Q)),e.root.push(new pr(u,h,p)),e.root.push(new cr(y,b,S,k,T,A,O)),P&&e.root.push(new lr(P)),K&&e.root.push(new ar(K)),e.root.push(new hr(N)),Y&&e.root.push(new nr(Y)),X&&e.root.push(new Jn(X)),void 0!==q&&e.root.push(new j("w:titlePg",q)),F&&e.root.push(new gr(F)),e.root.push(new ir(G,B,H)),e}return h(n,[{key:"addHeaderFooterGroup",value:function(e,t){t.default&&this.root.push(new er(e,{type:He.DEFAULT,id:t.default.View.ReferenceId})),t.first&&this.root.push(new er(e,{type:He.FIRST,id:t.first.View.ReferenceId})),t.even&&this.root.push(new er(e,{type:He.EVEN,id:t.even.View.ReferenceId}))}}]),n}(A),xr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"w:body")).sections=[],e}return h(n,[{key:"addSection",value:function(e){var t=this.sections.pop();this.root.push(this.createSectionParagraph(t)),this.sections.push(new kr(e))}},{key:"prepForXml",value:function(e){return 1===this.sections.length&&(this.root.splice(0,1),this.root.push(this.sections.pop())),l(u(n.prototype),"prepForXml",this).call(this,e)}},{key:"push",value:function(e){this.root.push(e)}},{key:"createSectionParagraph",value:function(e){var t=new zr({}),n=new Wr({});return n.push(e),t.addChildElement(n),t}}]),n}(A),Tr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={width:"w:w",space:"w:space"},e}return h(n)}(O),Rr=function(e){p(n,e);var t=v(n);function n(e){var r,i=e.width,o=e.space;return d(this,n),(r=t.call(this,"w:col")).root.push(new Tr({width:(0,B.Jd)(i),space:void 0===o?void 0:(0,B.Jd)(o)})),r}return h(n)}(A),Ar=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",aink:"xmlns:aink",am3d:"xmlns:am3d",w16cex:"xmlns:w16cex",w16cid:"xmlns:w16cid",w16:"xmlns:w16",w16sdtdh:"xmlns:w16sdtdh",w16se:"xmlns:w16se"},e}return h(n)}(O),_r=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"},e}return h(n)}(O),Or=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:background")).root.push(new _r({color:void 0===e.color?void 0:(0,B.dg)(e.color),themeColor:e.themeColor,themeShade:void 0===e.themeShade?void 0:(0,B.xD)(e.themeShade),themeTint:void 0===e.themeTint?void 0:(0,B.xD)(e.themeTint)})),r}return h(n)}(A),Dr=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:document")).root.push(new Ar({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex",Ignorable:"w14 w15 wp14"})),r.body=new xr,e.background&&r.root.push(new Or(e.background)),r.root.push(r.body),r}return h(n,[{key:"add",value:function(e){return this.body.push(e),this}},{key:"Body",get:function(){return this.body}}]),n}(A),Nr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={xmlns:"xmlns"},e}return h(n)}(O),Pr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"Relationships")).root.push(new Nr({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"})),e}return h(n,[{key:"addRelationship",value:function(e){this.root.push(e)}},{key:"createRelationship",value:function(e,t,n,r){var i=new Gn("rId".concat(e),t,n,r);return this.addRelationship(i),i}},{key:"RelationshipCount",get:function(){return this.root.length-1}}]),n}(A),Fr=function(){function e(t){d(this,e),this.document=new Dr(t),this.relationships=new Pr}return h(e,[{key:"View",get:function(){return this.document}},{key:"Relationships",get:function(){return this.relationships}}]),e}(),Ir=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={val:"w:val"},e}return h(n)}(O),Lr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"w:wordWrap")).root.push(new Ir({val:0})),e}return h(n)}(A);!function(e){e.NONE="none",e.DROP="drop",e.MARGIN="margin"}(mr||(mr={})),function(e){e.MARGIN="margin",e.PAGE="page",e.TEXT="text"}(yr||(yr={})),function(e){e.AROUND="around",e.AUTO="auto",e.NONE="none",e.NOT_BESIDE="notBeside",e.THROUGH="through",e.TIGHT="tight"}(wr||(wr={}));var Mr,Gr,Br,jr,Hr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={anchorLock:"w:anchorLock",dropCap:"w:dropCap",width:"w:w",height:"w:h",x:"w:x",y:"w:y",anchorHorizontal:"w:hAnchor",anchorVertical:"w:vAnchor",spaceHorizontal:"w:hSpace",spaceVertical:"w:vSpace",rule:"w:hRule",alignmentX:"w:xAlign",alignmentY:"w:yAlign",lines:"w:lines",wrap:"w:wrap"},e}return h(n)}(O),Vr=function(e){p(n,e);var t=v(n);function n(e){var r,i,o;return d(this,n),(r=t.call(this,"w:framePr")).root.push(new Hr({anchorLock:e.anchorLock,dropCap:e.dropCap,width:e.width,height:e.height,x:e.position?e.position.x:void 0,y:e.position?e.position.y:void 0,anchorHorizontal:e.anchor.horizontal,anchorVertical:e.anchor.vertical,spaceHorizontal:null===(i=e.space)||void 0===i?void 0:i.horizontal,spaceVertical:null===(o=e.space)||void 0===o?void 0:o.vertical,rule:e.rule,alignmentX:e.alignment?e.alignment.x:void 0,alignmentY:e.alignment?e.alignment.y:void 0,lines:e.lines,wrap:e.wrap})),r}return h(n)}(A),Wr=function(e){p(n,e);var t=v(n);function n(e){var r,i,s;if(d(this,n),(r=t.call(this,"w:pPr")).numberingReferences=[],!e)return a(r,f(r));e.heading&&r.push(new On(e.heading)),e.bullet&&r.push(new On("ListParagraph")),e.numbering&&(e.style||e.heading||e.numbering.custom||r.push(new On("ListParagraph"))),e.style&&r.push(new On(e.style)),void 0!==e.keepNext&&r.push(new j("w:keepNext",e.keepNext)),void 0!==e.keepLines&&r.push(new j("w:keepLines",e.keepLines)),e.pageBreakBefore&&r.push(new Rn),e.frame&&r.push(new Vr(e.frame)),void 0!==e.widowControl&&r.push(new j("w:widowControl",e.widowControl)),e.bullet&&r.push(new Fn(1,e.bullet.level)),e.numbering&&(r.numberingReferences.push({reference:e.numbering.reference,instance:null!==(i=e.numbering.instance)&&void 0!==i?i:0}),r.push(new Fn("".concat(e.numbering.reference,"-").concat(null!==(s=e.numbering.instance)&&void 0!==s?s:0),e.numbering.level))),e.border&&r.push(new Q(e.border)),e.thematicBreak&&r.push(new Z),e.shading&&r.push(new ce(e.shading)),e.wordWrap&&r.push(new Lr);var l=[].concat(o(e.rightTabStop?[{type:Ie.RIGHT,position:e.rightTabStop}]:[]),o(e.tabStops?e.tabStops:[]),o(e.leftTabStop?[{type:Ie.LEFT,position:e.leftTabStop}]:[]));return l.length>0&&r.push(new Dn(l)),void 0!==e.bidirectional&&r.push(new j("w:bidi",e.bidirectional)),e.spacing&&r.push(new _n(e.spacing)),e.indent&&r.push(new $(e.indent)),void 0!==e.contextualSpacing&&r.push(new j("w:contextualSpacing",e.contextualSpacing)),e.alignment&&r.push(new q(e.alignment)),void 0!==e.outlineLevel&&r.push(new Xn(e.outlineLevel)),void 0!==e.suppressLineNumbers&&r.push(new j("w:suppressLineNumbers",e.suppressLineNumbers)),a(r)}return h(n,[{key:"push",value:function(e){this.root.push(e)}},{key:"prepForXml",value:function(e){if(e.viewWrapper instanceof Fr){var t,r=s(this.numberingReferences);try{for(r.s();!(t=r.n()).done;){var i=t.value;e.file.Numbering.createConcreteNumberingInstance(i.reference,i.instance)}}catch(o){r.e(o)}finally{r.f()}}return l(u(n.prototype),"prepForXml",this).call(this,e)}}]),n}(_),zr=function(e){p(n,e);var t=v(n);function n(e){var r;if(d(this,n),r=t.call(this,"w:p"),"string"==typeof e)return a(r,(r.properties=new Wr({}),r.root.push(r.properties),r.root.push(new $e(e)),f(r)));if(r.properties=new Wr(e),r.root.push(r.properties),e.text&&r.root.push(new $e(e.text)),e.children){var i,o=s(e.children);try{for(o.s();!(i=o.n()).done;){var l=i.value;if(l instanceof Un){r.root.push(l.start);var u,c=s(l.children);try{for(c.s();!(u=c.n()).done;){var h=u.value;r.root.push(h)}}catch(p){c.e(p)}finally{c.f()}r.root.push(l.end)}else r.root.push(l)}}catch(p){o.e(p)}finally{o.f()}}return a(r)}return h(n,[{key:"prepForXml",value:function(e){var t,r=s(this.root);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i instanceof Vn){var o=this.root.indexOf(i),a=new jn(i.options.children,(0,rt.EL)());e.viewWrapper.Relationships.createRelationship(a.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",i.options.link,Ge.EXTERNAL),this.root[o]=a}}}catch(c){r.e(c)}finally{r.f()}return l(u(n.prototype),"prepForXml",this).call(this,e)}},{key:"addRunToFront",value:function(e){return this.root.splice(1,0,e),this}}]),n}(A),Ur=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),r=t.call(this,"m:oMath");var i,o=s(e.children);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.root.push(a)}}catch(l){o.e(l)}finally{o.f()}return r}return h(n)}(A),Kr=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:t")).root.push(e),r}return h(n)}(A),qr=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:r")).root.push(new Kr(e)),r}return h(n)}(A),Xr=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),r=t.call(this,"m:den");var i,o=s(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.root.push(a)}}catch(l){o.e(l)}finally{o.f()}return r}return h(n)}(A),Yr=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),r=t.call(this,"m:num");var i,o=s(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.root.push(a)}}catch(l){o.e(l)}finally{o.f()}return r}return h(n)}(A),Qr=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:f")).root.push(new Yr(e.numerator)),r.root.push(new Xr(e.denominator)),r}return h(n)}(A),Zr=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={accent:"m:val"},e}return h(n)}(O),Jr=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:chr")).root.push(new Zr({accent:e})),r}return h(n)}(A),$r=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),r=t.call(this,"m:e");var i,o=s(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.root.push(a)}}catch(l){o.e(l)}finally{o.f()}return r}return h(n)}(A),ei=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={value:"m:val"},e}return h(n)}(O),ti=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"m:limLoc")).root.push(new ei({value:"undOvr"})),e}return h(n)}(A),ni=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={hide:"m:val"},e}return h(n)}(O),ri=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"m:subHide")).root.push(new ni({hide:1})),e}return h(n)}(A),ii=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={hide:"m:val"},e}return h(n)}(O),oi=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"m:supHide")).root.push(new ii({hide:1})),e}return h(n)}(A),ai=function(e){p(n,e);var t=v(n);function n(e,r,i){var o;return d(this,n),o=t.call(this,"m:naryPr"),e&&o.root.push(new Jr(e)),o.root.push(new ti),r||o.root.push(new oi),i||o.root.push(new ri),o}return h(n)}(A),si=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),r=t.call(this,"m:sub");var i,o=s(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.root.push(a)}}catch(l){o.e(l)}finally{o.f()}return r}return h(n)}(A),li=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),r=t.call(this,"m:sup");var i,o=s(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.root.push(a)}}catch(l){o.e(l)}finally{o.f()}return r}return h(n)}(A),ui=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:nary")).root.push(new ai("\u2211",!!e.superScript,!!e.subScript)),e.subScript&&r.root.push(new si(e.subScript)),e.superScript&&r.root.push(new li(e.superScript)),r.root.push(new $r(e.children)),r}return h(n)}(A),ci=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:nary")).root.push(new ai("",!!e.superScript,!!e.subScript)),e.subScript&&r.root.push(new si(e.subScript)),e.superScript&&r.root.push(new li(e.superScript)),r.root.push(new $r(e.children)),r}return h(n)}(A),di=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"m:sSupPr")}return h(n)}(A),hi=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:sSup")).root.push(new di),r.root.push(new $r(e.children)),r.root.push(new li(e.superScript)),r}return h(n)}(A),fi=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"m:sSubPr")}return h(n)}(A),pi=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:sSub")).root.push(new fi),r.root.push(new $r(e.children)),r.root.push(new si(e.subScript)),r}return h(n)}(A),vi=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"m:sSubSupPr")}return h(n)}(A),gi=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:sSubSup")).root.push(new vi),r.root.push(new $r(e.children)),r.root.push(new si(e.subScript)),r.root.push(new li(e.superScript)),r}return h(n)}(A),mi=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"m:sPrePr")}return h(n)}(A),yi=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:sPre")).root.push(new mi),r.root.push(new $r(e.children)),r.root.push(new si(e.subScript)),r.root.push(new li(e.superScript)),r}return h(n)}(A),wi="",bi=function(e){p(n,e);var t=v(n);function n(e){var r;if(d(this,n),r=t.call(this,"m:deg"),e){var i,o=s(e);try{for(o.s();!(i=o.n()).done;){var l=i.value;r.root.push(l)}}catch(u){o.e(u)}finally{o.f()}}return a(r)}return h(n)}(A),Ci=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={hide:"m:val"},e}return h(n)}(O),Si=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"m:degHide")).root.push(new Ci({hide:1})),e}return h(n)}(A),Ei=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),r=t.call(this,"m:radPr"),e||r.root.push(new Si),r}return h(n)}(A),ki=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:rad")).root.push(new Ei(!!e.degree)),r.root.push(new bi(e.degree)),r.root.push(new $r(e.children)),r}return h(n)}(A),xi=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),r=t.call(this,"m:fName");var i,o=s(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.root.push(a)}}catch(l){o.e(l)}finally{o.f()}return r}return h(n)}(A),Ti=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"m:funcPr")}return h(n)}(A),Ri=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:func")).root.push(new Ti),r.root.push(new xi(e.name)),r.root.push(new $r(e.children)),r}return h(n)}(A),Ai=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={character:"m:val"},e}return h(n)}(O),_i=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:begChr")).root.push(new Ai({character:e})),r}return h(n)}(A),Oi=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={character:"m:val"},e}return h(n)}(O),Di=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:endChr")).root.push(new Oi({character:e})),r}return h(n)}(A),Ni=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),r=t.call(this,"m:dPr"),e&&(r.root.push(new _i(e.beginningCharacter)),r.root.push(new Di(e.endingCharacter))),r}return h(n)}(A),Pi=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:d")).root.push(new Ni),r.root.push(new $r(e.children)),r}return h(n)}(A),Fi=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:d")).root.push(new Ni({beginningCharacter:"[",endingCharacter:"]"})),r.root.push(new $r(e.children)),r}return h(n)}(A),Ii=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:d")).root.push(new Ni({beginningCharacter:"{",endingCharacter:"}"})),r.root.push(new $r(e.children)),r}return h(n)}(A),Li=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"m:d")).root.push(new Ni({beginningCharacter:"\u2329",endingCharacter:"\u232a"})),r.root.push(new $r(e.children)),r}return h(n)}(A),Mi=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),r=t.call(this,"w:tblGrid");var i,o=s(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.root.push(new Bi(a))}}catch(l){o.e(l)}finally{o.f()}return r}return h(n)}(A),Gi=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={w:"w:w"},e}return h(n)}(O),Bi=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),r=t.call(this,"w:gridCol"),void 0!==e&&r.root.push(new Gi({w:(0,B.Jd)(e)})),r}return h(n)}(A);!function(e){e.AUTO="auto",e.DXA="dxa",e.NIL="nil",e.PERCENTAGE="pct"}(Mr||(Mr={}));var ji=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={type:"w:type",size:"w:w"},e}return h(n)}(O),Hi=function(e){p(n,e);var t=v(n);function n(e,r){var i,o=r.type,a=void 0===o?Mr.AUTO:o,s=r.size;d(this,n),i=t.call(this,e);var l=s;return a===Mr.PERCENTAGE&&"number"==typeof s&&(l="".concat(s,"%")),i.root.push(new ji({type:a,size:(0,B.aB)(l)})),i}return h(n)}(A);!function(e){e.TABLE="w:tblCellMar",e.TABLE_CELL="w:tcMar"}(Gr||(Gr={}));var Vi=function(e){p(n,e);var t=v(n);function n(e,r){var i,o=r.marginUnitType,a=void 0===o?Mr.DXA:o,s=r.top,l=r.left,u=r.bottom,c=r.right;return d(this,n),i=t.call(this,e),void 0!==s&&i.root.push(new Hi("w:top",{type:a,size:s})),void 0!==l&&i.root.push(new Hi("w:left",{type:a,size:l})),void 0!==u&&i.root.push(new Hi("w:bottom",{type:a,size:u})),void 0!==c&&i.root.push(new Hi("w:right",{type:a,size:c})),i}return h(n)}(_),Wi=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),r=t.call(this,"w:tcBorders"),e.top&&r.root.push(new X("w:top",e.top)),e.start&&r.root.push(new X("w:start",e.start)),e.left&&r.root.push(new X("w:left",e.left)),e.bottom&&r.root.push(new X("w:bottom",e.bottom)),e.end&&r.root.push(new X("w:end",e.end)),e.right&&r.root.push(new X("w:right",e.right)),r}return h(n)}(_),zi=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={val:"w:val"},e}return h(n)}(O),Ui=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:gridSpan")).root.push(new zi({val:(0,B.vH)(e)})),r}return h(n)}(A);!function(e){e.CONTINUE="continue",e.RESTART="restart"}(Br||(Br={}));var Ki=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={val:"w:val"},e}return h(n)}(O),qi=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:vMerge")).root.push(new Ki({val:e})),r}return h(n)}(A);!function(e){e.BOTTOM_TO_TOP_LEFT_TO_RIGHT="btLr",e.LEFT_TO_RIGHT_TOP_TO_BOTTOM="lrTb",e.TOP_TO_BOTTOM_RIGHT_TO_LEFT="tbRl"}(jr||(jr={}));var Xi,Yi,Qi,Zi,Ji,$i,eo,to=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={val:"w:val"},e}return h(n)}(O),no=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:textDirection")).root.push(new to({val:e})),r}return h(n)}(A),ro=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),r=t.call(this,"w:tcPr"),e.width&&r.root.push(new Hi("w:tcW",e.width)),e.columnSpan&&r.root.push(new Ui(e.columnSpan)),e.verticalMerge?r.root.push(new qi(e.verticalMerge)):e.rowSpan&&e.rowSpan>1&&r.root.push(new qi(Br.RESTART)),e.borders&&r.root.push(new Wi(e.borders)),e.shading&&r.root.push(new ce(e.shading)),e.margins&&r.root.push(new Vi(Gr.TABLE_CELL,e.margins)),e.textDirection&&r.root.push(new no(e.textDirection)),e.verticalAlign&&r.root.push(new Jn(e.verticalAlign)),r}return h(n)}(_),io=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),(r=t.call(this,"w:tc")).options=e,r.root.push(new ro(e));var i,o=s(e.children);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.root.push(a)}}catch(l){o.e(l)}finally{o.f()}return r}return h(n,[{key:"prepForXml",value:function(e){return this.root[this.root.length-1]instanceof zr||this.root.push(new zr({})),l(u(n.prototype),"prepForXml",this).call(this,e)}}]),n}(A),oo={style:t.NONE,size:0,color:"auto"},ao={style:t.SINGLE,size:4,color:"auto"},so=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),r=t.call(this,"w:tblBorders"),e.top?r.root.push(new X("w:top",e.top)):r.root.push(new X("w:top",ao)),e.left?r.root.push(new X("w:left",e.left)):r.root.push(new X("w:left",ao)),e.bottom?r.root.push(new X("w:bottom",e.bottom)):r.root.push(new X("w:bottom",ao)),e.right?r.root.push(new X("w:right",e.right)):r.root.push(new X("w:right",ao)),e.insideHorizontal?r.root.push(new X("w:insideH",e.insideHorizontal)):r.root.push(new X("w:insideH",ao)),e.insideVertical?r.root.push(new X("w:insideV",e.insideVertical)):r.root.push(new X("w:insideV",ao)),r}return h(n)}(A);so.NONE={top:oo,bottom:oo,left:oo,right:oo,insideHorizontal:oo,insideVertical:oo},function(e){e.MARGIN="margin",e.PAGE="page",e.TEXT="text"}(Xi||(Xi={})),function(e){e.CENTER="center",e.INSIDE="inside",e.LEFT="left",e.OUTSIDE="outside",e.RIGHT="right"}(Yi||(Yi={})),function(e){e.CENTER="center",e.INSIDE="inside",e.BOTTOM="bottom",e.OUTSIDE="outside",e.INLINE="inline",e.TOP="top"}(Qi||(Qi={})),function(e){e.NEVER="never",e.OVERLAP="overlap"}(Zi||(Zi={}));var lo=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={horizontalAnchor:"w:horzAnchor",verticalAnchor:"w:vertAnchor",absoluteHorizontalPosition:"w:tblpX",relativeHorizontalPosition:"w:tblpXSpec",absoluteVerticalPosition:"w:tblpY",relativeVerticalPosition:"w:tblpYSpec",bottomFromText:"w:bottomFromText",topFromText:"w:topFromText",leftFromText:"w:leftFromText",rightFromText:"w:rightFromText"},e}return h(n)}(O),uo=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n);var i=e.leftFromText,o=e.rightFromText,a=e.topFromText,s=e.bottomFromText,l=e.absoluteHorizontalPosition,u=e.absoluteVerticalPosition,c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["leftFromText","rightFromText","topFromText","bottomFromText","absoluteHorizontalPosition","absoluteVerticalPosition"]);return(r=t.call(this,"w:tblpPr")).root.push(new lo(Object.assign({leftFromText:void 0===i?void 0:(0,B.Jd)(i),rightFromText:void 0===o?void 0:(0,B.Jd)(o),topFromText:void 0===a?void 0:(0,B.Jd)(a),bottomFromText:void 0===s?void 0:(0,B.Jd)(s),absoluteHorizontalPosition:void 0===l?void 0:(0,B.xb)(l),absoluteVerticalPosition:void 0===u?void 0:(0,B.xb)(u)},c))),c.overlap&&r.root.push(new z("w:tblOverlap",c.overlap)),r}return h(n)}(A);!function(e){e.AUTOFIT="autofit",e.FIXED="fixed"}(Ji||(Ji={}));var co=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={type:"w:type"},e}return h(n)}(O),ho=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:tblLayout")).root.push(new co({type:e})),r}return h(n)}(A),fo=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),r=t.call(this,"w:tblPr"),e.style&&r.root.push(new V("w:tblStyle",e.style)),e.float&&r.root.push(new uo(e.float)),void 0!==e.visuallyRightToLeft&&r.root.push(new j("w:bidiVisual",e.visuallyRightToLeft)),e.width&&r.root.push(new Hi("w:tblW",e.width)),e.alignment&&r.root.push(new q(e.alignment)),e.indent&&r.root.push(new Hi("w:tblInd",e.indent)),e.borders&&r.root.push(new so(e.borders)),e.shading&&r.root.push(new ce(e.shading)),e.layout&&r.root.push(new ho(e.layout)),e.cellMargin&&r.root.push(new Vi(Gr.TABLE,e.cellMargin)),r}return h(n)}(_),po=function(e){p(n,e);var t=v(n);function n(e){var r,i=e.rows,a=e.width,l=e.columnWidths,u=void 0===l?Array(Math.max.apply(Math,o(i.map((function(e){return e.CellCount}))))).fill(100):l,c=e.margins,h=e.indent,f=e.float,p=e.layout,v=e.style,g=e.borders,m=e.alignment,y=e.visuallyRightToLeft;d(this,n),(r=t.call(this,"w:tbl")).root.push(new fo({borders:null!=g?g:{},width:null!=a?a:{size:100},indent:h,float:f,layout:p,style:v,alignment:m,cellMargin:c,visuallyRightToLeft:y})),r.root.push(new Mi(u));var w,b=s(i);try{for(b.s();!(w=b.n()).done;){var C=w.value;r.root.push(C)}}catch(S){b.e(S)}finally{b.f()}return i.forEach((function(e,t){if(t!==i.length-1){var n=0;e.cells.forEach((function(e){if(e.options.rowSpan&&e.options.rowSpan>1){var r=new io({rowSpan:e.options.rowSpan-1,columnSpan:e.options.columnSpan,borders:e.options.borders,children:[],verticalMerge:Br.CONTINUE});i[t+1].addCellToColumnIndex(r,n)}n+=e.options.columnSpan||1}))}})),r}return h(n)}(A);!function(e){e.AUTO="auto",e.ATLEAST="atLeast",e.EXACT="exact"}($i||($i={}));var vo=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={value:"w:val",rule:"w:hRule"},e}return h(n)}(O),go=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"w:trHeight")).root.push(new vo({value:(0,B.Jd)(e),rule:r})),i}return h(n)}(A),mo=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),r=t.call(this,"w:trPr"),void 0!==e.cantSplit&&r.root.push(new j("w:cantSplit",e.cantSplit)),void 0!==e.tableHeader&&r.root.push(new j("w:tblHeader",e.tableHeader)),e.height&&r.root.push(new go(e.height.value,e.height.rule)),r}return h(n)}(_),yo=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),(r=t.call(this,"w:tr")).options=e,r.root.push(new mo(e));var i,o=s(e.children);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.root.push(a)}}catch(l){o.e(l)}finally{o.f()}return r}return h(n,[{key:"CellCount",get:function(){return this.options.children.length}},{key:"cells",get:function(){return this.root.filter((function(e){return e instanceof io}))}},{key:"addCellToIndex",value:function(e,t){this.root.splice(t+1,0,e)}},{key:"addCellToColumnIndex",value:function(e,t){var n=this.columnIndexToRootIndex(t,!0);this.addCellToIndex(e,n-1)}},{key:"rootIndexToColumnIndex",value:function(e){if(e<1||e>=this.root.length)throw new Error("cell 'rootIndex' should between 1 to "+(this.root.length-1));for(var t=0,n=1;n<e;n++)t+=this.root[n].options.columnSpan||1;return t}},{key:"columnIndexToRootIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<0)throw new Error("cell 'columnIndex' should not less than zero");for(var n=0,r=1;n<=e;){if(r>=this.root.length){if(t)return this.root.length;throw new Error("cell 'columnIndex' should not great than "+(n-1))}var i=this.root[r];r+=1,n+=i&&i.options.columnSpan||1}return r-1}}]),n}(A),wo=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={xmlns:"xmlns",vt:"xmlns:vt"},e}return h(n)}(O),bo=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"Properties")).root.push(new wo({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),e}return h(n)}(A),Co=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={xmlns:"xmlns"},e}return h(n)}(O),So=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={contentType:"ContentType",extension:"Extension"},e}return h(n)}(O),Eo=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"Default")).root.push(new So({contentType:e,extension:r})),i}return h(n)}(A),ko=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={contentType:"ContentType",partName:"PartName"},e}return h(n)}(O),xo=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"Override")).root.push(new ko({contentType:e,partName:r})),i}return h(n)}(A),To=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"Types")).root.push(new Co({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),e.root.push(new Eo("image/png","png")),e.root.push(new Eo("image/jpeg","jpeg")),e.root.push(new Eo("image/jpeg","jpg")),e.root.push(new Eo("image/bmp","bmp")),e.root.push(new Eo("image/gif","gif")),e.root.push(new Eo("application/vnd.openxmlformats-package.relationships+xml","rels")),e.root.push(new Eo("application/xml","xml")),e.root.push(new xo("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),e.root.push(new xo("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),e.root.push(new xo("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),e.root.push(new xo("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),e.root.push(new xo("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),e.root.push(new xo("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),e.root.push(new xo("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),e.root.push(new xo("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),e.root.push(new xo("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),e}return h(n,[{key:"addFooter",value:function(e){this.root.push(new xo("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml","/word/footer".concat(e,".xml")))}},{key:"addHeader",value:function(e){this.root.push(new xo("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml","/word/header".concat(e,".xml")))}}]),n}(A),Ro=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"cp:coreProperties")).root.push(new Ar({cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"})),e.title&&r.root.push(new U("dc:title",e.title)),e.subject&&r.root.push(new U("dc:subject",e.subject)),e.creator&&r.root.push(new U("dc:creator",e.creator)),e.keywords&&r.root.push(new U("cp:keywords",e.keywords)),e.description&&r.root.push(new U("dc:description",e.description)),e.lastModifiedBy&&r.root.push(new U("cp:lastModifiedBy",e.lastModifiedBy)),e.revision&&r.root.push(new U("cp:revision",String(e.revision))),r.root.push(new Ao("dcterms:created")),r.root.push(new Ao("dcterms:modified")),r}return h(n)}(A),Ao=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).root.push(new Ar({type:"dcterms:W3CDTF"})),r.root.push((0,B.sF)(new Date)),r}return h(n)}(A),_o=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={xmlns:"xmlns",vt:"xmlns:vt"},e}return h(n)}(O),Oo=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={fmtid:"fmtid",pid:"pid",name:"name"},e}return h(n)}(O),Do=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"property")).root.push(new Oo({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e.toString(),name:r.name})),i.root.push(new No(r.value)),i}return h(n)}(A),No=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"vt:lpwstr")).root.push(e),r}return h(n)}(A),Po=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),(r=t.call(this,"Properties")).properties=[],r.root.push(new _o({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),r.nextId=2;var i,o=s(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.addCustomProperty(a)}}catch(l){o.e(l)}finally{o.f()}return r}return h(n,[{key:"prepForXml",value:function(e){var t=this;return this.properties.forEach((function(e){return t.root.push(e)})),l(u(n.prototype),"prepForXml",this).call(this,e)}},{key:"addCustomProperty",value:function(e){this.properties.push(new Do(this.nextId++,e))}}]),n}(A),Fo=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"},e}return h(n)}(O),Io=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"w:ftr",r)).refId=e,r||i.root.push(new Fo({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"})),i}return h(n,[{key:"ReferenceId",get:function(){return this.refId}},{key:"add",value:function(e){this.root.push(e)}}]),n}(G),Lo=function(){function e(t,n,r){d(this,e),this.media=t,this.footer=new Io(n,r),this.relationships=new Pr}return h(e,[{key:"add",value:function(e){this.footer.add(e)}},{key:"addChildElement",value:function(e){this.footer.addChildElement(e)}},{key:"View",get:function(){return this.footer}},{key:"Relationships",get:function(){return this.relationships}},{key:"Media",get:function(){return this.media}}]),e}(),Mo=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={type:"w:type",id:"w:id"},e}return h(n)}(O),Go=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"w:footnoteRef")}return h(n)}(A),Bo=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,{style:"FootnoteReference"})).root.push(new Go),e}return h(n)}(Je);!function(e){e.SEPERATOR="separator",e.CONTINUATION_SEPERATOR="continuationSeparator"}(eo||(eo={}));var jo,Ho,Vo=function(e){p(n,e);var t=v(n);function n(e){var r;d(this,n),(r=t.call(this,"w:footnote")).root.push(new Mo({type:e.type,id:e.id}));for(var i=0;i<e.children.length;i++){var o=e.children[i];0===i&&o.addRunToFront(new Bo),r.root.push(o)}return r}return h(n)}(A),Wo=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"w:continuationSeparator")}return h(n)}(A),zo=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,{})).root.push(new Wo),e}return h(n)}(Je),Uo=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"w:separator")}return h(n)}(A),Ko=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,{})).root.push(new Uo),e}return h(n)}(Je),qo=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"},e}return h(n)}(O),Xo=function(e){p(n,e);var t=v(n);function n(){var e;d(this,n),(e=t.call(this,"w:footnotes")).root.push(new qo({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));var r=new Vo({id:-1,type:eo.SEPERATOR,children:[new zr({spacing:{after:0,line:240,lineRule:Pe.AUTO},children:[new Ko]})]});e.root.push(r);var i=new Vo({id:0,type:eo.CONTINUATION_SEPERATOR,children:[new zr({spacing:{after:0,line:240,lineRule:Pe.AUTO},children:[new zo]})]});return e.root.push(i),e}return h(n,[{key:"createFootNote",value:function(e,t){var n=new Vo({id:e,children:t});this.root.push(n)}}]),n}(A),Yo=function(){function e(){d(this,e),this.footnotess=new Xo,this.relationships=new Pr}return h(e,[{key:"View",get:function(){return this.footnotess}},{key:"Relationships",get:function(){return this.relationships}}]),e}(),Qo=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"},e}return h(n)}(O),Zo=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"w:hdr",r)).refId=e,r||i.root.push(new Qo({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"})),i}return h(n,[{key:"ReferenceId",get:function(){return this.refId}},{key:"add",value:function(e){this.root.push(e)}}]),n}(G),Jo=function(){function e(t,n,r){d(this,e),this.media=t,this.header=new Zo(n,r),this.relationships=new Pr}return h(e,[{key:"add",value:function(e){return this.header.add(e),this}},{key:"addChildElement",value:function(e){this.header.addChildElement(e)}},{key:"View",get:function(){return this.header}},{key:"Relationships",get:function(){return this.relationships}},{key:"Media",get:function(){return this.media}}]),e}(),$o=function(){function e(){d(this,e),this.map=new Map}return h(e,[{key:"addMedia",value:function(e,t){var n="".concat((0,rt.EL)(),".png"),r={stream:"string"==typeof e?this.convertDataURIToBinary(e):e,fileName:n,transformation:{pixels:{x:Math.round(t.width),y:Math.round(t.height)},emus:{x:Math.round(9525*t.width),y:Math.round(9525*t.height)},flip:t.flip,rotation:t.rotation?6e4*t.rotation:void 0}};return this.map.set(n,r),r}},{key:"addImage",value:function(e,t){this.map.set(e,t)}},{key:"Array",get:function(){return Array.from(this.map.values())}},{key:"convertDataURIToBinary",value:function(e){var t=";base64,",r=e.indexOf(t)+t.length;return"function"==typeof atob?new Uint8Array(atob(e.substring(r)).split("").map((function(e){return e.charCodeAt(0)}))):new(n(8764).Buffer)(e,"base64")}}]),e}(),ea="";!function(e){e.DECIMAL="decimal",e.UPPER_ROMAN="upperRoman",e.LOWER_ROMAN="lowerRoman",e.UPPER_LETTER="upperLetter",e.LOWER_LETTER="lowerLetter",e.ORDINAL="ordinal",e.CARDINAL_TEXT="cardinalText",e.ORDINAL_TEXT="ordinalText",e.HEX="hex",e.CHICAGO="chicago",e.IDEOGRAPH__DIGITAL="ideographDigital",e.JAPANESE_COUNTING="japaneseCounting",e.AIUEO="aiueo",e.IROHA="iroha",e.DECIMAL_FULL_WIDTH="decimalFullWidth",e.DECIMAL_HALF_WIDTH="decimalHalfWidth",e.JAPANESE_LEGAL="japaneseLegal",e.JAPANESE_DIGITAL_TEN_THOUSAND="japaneseDigitalTenThousand",e.DECIMAL_ENCLOSED_CIRCLE="decimalEnclosedCircle",e.DECIMAL_FULL_WIDTH2="decimalFullWidth2",e.AIUEO_FULL_WIDTH="aiueoFullWidth",e.IROHA_FULL_WIDTH="irohaFullWidth",e.DECIMAL_ZERO="decimalZero",e.BULLET="bullet",e.GANADA="ganada",e.CHOSUNG="chosung",e.DECIMAL_ENCLOSED_FULLSTOP="decimalEnclosedFullstop",e.DECIMAL_ENCLOSED_PARENTHESES="decimalEnclosedParen",e.DECIMAL_ENCLOSED_CIRCLE_CHINESE="decimalEnclosedCircleChinese",e.IDEOGRAPH_ENCLOSED_CIRCLE="ideographEnclosedCircle",e.IDEOGRAPH_TRADITIONAL="ideographTraditional",e.IDEOGRAPH_ZODIAC="ideographZodiac",e.IDEOGRAPH_ZODIAC_TRADITIONAL="ideographZodiacTraditional",e.TAIWANESE_COUNTING="taiwaneseCounting",e.IDEOGRAPH_LEGAL_TRADITIONAL="ideographLegalTraditional",e.TAIWANESE_COUNTING_THOUSAND="taiwaneseCountingThousand",e.TAIWANESE_DIGITAL="taiwaneseDigital",e.CHINESE_COUNTING="chineseCounting",e.CHINESE_LEGAL_SIMPLIFIED="chineseLegalSimplified",e.CHINESE_COUNTING_THOUSAND="chineseCountingThousand",e.KOREAN_DIGITAL="koreanDigital",e.KOREAN_COUNTING="koreanCounting",e.KOREAN_LEGAL="koreanLegal",e.KOREAN_DIGITAL2="koreanDigital2",e.VIETNAMESE_COUNTING="vietnameseCounting",e.RUSSIAN_LOWER="russianLower",e.RUSSIAN_UPPER="russianUpper",e.NONE="none",e.NUMBER_IN_DASH="numberInDash",e.HEBREW1="hebrew1",e.HEBREW2="hebrew2",e.ARABIC_ALPHA="arabicAlpha",e.ARABIC_ABJAD="arabicAbjad",e.HINDI_VOWELS="hindiVowels",e.HINDI_CONSONANTS="hindiConsonants",e.HINDI_NUMBERS="hindiNumbers",e.HINDI_COUNTING="hindiCounting",e.THAI_LETTERS="thaiLetters",e.THAI_NUMBERS="thaiNumbers",e.THAI_COUNTING="thaiCounting",e.BAHT_TEXT="bahtText",e.DOLLAR_TEXT="dollarText",e.CUSTOM="custom"}(jo||(jo={}));var ta=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={ilvl:"w:ilvl",tentative:"w15:tentative"},e}return h(n)}(O),na=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:numFmt")).root.push(new D({val:e})),r}return h(n)}(A),ra=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:lvlText")).root.push(new D({val:e})),r}return h(n)}(A),ia=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:lvlJc")).root.push(new D({val:e})),r}return h(n)}(A);!function(e){e.NOTHING="nothing",e.SPACE="space",e.TAB="tab"}(Ho||(Ho={}));var oa,aa=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:suff")).root.push(new D({val:e})),r}return h(n)}(A),sa=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"w:isLgl")}return h(n)}(A),la=function(t){p(r,t);var n=v(r);function r(t){var i,o=t.level,s=t.format,l=t.text,u=t.alignment,c=void 0===u?e.START:u,h=t.start,f=void 0===h?1:h,p=t.style,v=t.suffix,g=t.isLegalNumberingStyle;if(d(this,r),(i=n.call(this,"w:lvl")).root.push(new W("w:start",(0,B.vH)(f))),s&&i.root.push(new na(s)),v&&i.root.push(new aa(v)),g&&i.root.push(new sa),l&&i.root.push(new ra(l)),i.root.push(new ia(c)),i.paragraphProperties=new Wr(p&&p.paragraph),i.runProperties=new xe(p&&p.run),i.root.push(i.paragraphProperties),i.root.push(i.runProperties),o>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");return i.root.push(new ta({ilvl:(0,B.vH)(o),tentative:1})),a(i)}return h(r)}(A),ua=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.apply(this,arguments)}return h(n)}(la),ca=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.apply(this,arguments)}return h(n)}(la),da=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:multiLevelType")).root.push(new D({val:e})),r}return h(n)}(A),ha=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"},e}return h(n)}(O),fa=function(e){p(n,e);var t=v(n);function n(e,r){var i;d(this,n),(i=t.call(this,"w:abstractNum")).root.push(new ha({abstractNumId:(0,B.vH)(e),restartNumberingAfterBreak:0})),i.root.push(new da("hybridMultilevel")),i.id=e;var o,a=s(r);try{for(a.s();!(o=a.n()).done;){var l=o.value;i.root.push(new ua(l))}}catch(u){a.e(u)}finally{a.f()}return i}return h(n)}(A),pa=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:abstractNumId")).root.push(new D({val:e})),r}return h(n)}(A),va=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={numId:"w:numId"},e}return h(n)}(O),ga=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:num")).numId=e.numId,r.reference=e.reference,r.instance=e.instance,r.root.push(new va({numId:(0,B.vH)(e.numId)})),r.root.push(new pa((0,B.vH)(e.abstractNumId))),e.overrideLevel&&r.root.push(new ya(e.overrideLevel.num,e.overrideLevel.start)),r}return h(n)}(A),ma=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={ilvl:"w:ilvl"},e}return h(n)}(O),ya=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"w:lvlOverride")).root.push(new ma({ilvl:e})),void 0!==r&&i.root.push(new ba(r)),i}return h(n)}(A),wa=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={val:"w:val"},e}return h(n)}(O),ba=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:startOverride")).root.push(new wa({val:e})),r}return h(n)}(A),Ca=function(t){p(r,t);var n=v(r);function r(t){var i;d(this,r),(i=n.call(this,"w:numbering")).abstractNumberingMap=new Map,i.concreteNumberingMap=new Map,i.referenceConfigMap=new Map,i.root.push(new Ar({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));var o=new fa((0,rt.NY)(),[{level:0,format:jo.BULLET,text:"\u25cf",alignment:e.LEFT,style:{paragraph:{indent:{left:(0,rt.vw)(.5),hanging:(0,rt.vw)(.25)}}}},{level:1,format:jo.BULLET,text:"\u25cb",alignment:e.LEFT,style:{paragraph:{indent:{left:(0,rt.vw)(1),hanging:(0,rt.vw)(.25)}}}},{level:2,format:jo.BULLET,text:"\u25a0",alignment:e.LEFT,style:{paragraph:{indent:{left:2160,hanging:(0,rt.vw)(.25)}}}},{level:3,format:jo.BULLET,text:"\u25cf",alignment:e.LEFT,style:{paragraph:{indent:{left:2880,hanging:(0,rt.vw)(.25)}}}},{level:4,format:jo.BULLET,text:"\u25cb",alignment:e.LEFT,style:{paragraph:{indent:{left:3600,hanging:(0,rt.vw)(.25)}}}},{level:5,format:jo.BULLET,text:"\u25a0",alignment:e.LEFT,style:{paragraph:{indent:{left:4320,hanging:(0,rt.vw)(.25)}}}},{level:6,format:jo.BULLET,text:"\u25cf",alignment:e.LEFT,style:{paragraph:{indent:{left:5040,hanging:(0,rt.vw)(.25)}}}},{level:7,format:jo.BULLET,text:"\u25cf",alignment:e.LEFT,style:{paragraph:{indent:{left:5760,hanging:(0,rt.vw)(.25)}}}},{level:8,format:jo.BULLET,text:"\u25cf",alignment:e.LEFT,style:{paragraph:{indent:{left:6480,hanging:(0,rt.vw)(.25)}}}}]);i.concreteNumberingMap.set("default-bullet-numbering",new ga({numId:1,abstractNumId:o.id,reference:"default-bullet-numbering",instance:0,overrideLevel:{num:0,start:1}})),i.abstractNumberingMap.set("default-bullet-numbering",o);var a,l=s(t.config);try{for(l.s();!(a=l.n()).done;){var u=a.value;i.abstractNumberingMap.set(u.reference,new fa((0,rt.NY)(),u.levels)),i.referenceConfigMap.set(u.reference,u.levels)}}catch(c){l.e(c)}finally{l.f()}return i}return h(r,[{key:"prepForXml",value:function(e){var t,n=s(this.abstractNumberingMap.values());try{for(n.s();!(t=n.n()).done;){var i=t.value;this.root.push(i)}}catch(d){n.e(d)}finally{n.f()}var o,a=s(this.concreteNumberingMap.values());try{for(a.s();!(o=a.n()).done;){var c=o.value;this.root.push(c)}}catch(d){a.e(d)}finally{a.f()}return l(u(r.prototype),"prepForXml",this).call(this,e)}},{key:"createConcreteNumberingInstance",value:function(e,t){var n=this.abstractNumberingMap.get(e);if(n){var r="".concat(e,"-").concat(t);if(!this.concreteNumberingMap.has(r)){var i=this.referenceConfigMap.get(e),o=i&&i[0].start,a={numId:(0,rt.NY)(),abstractNumId:n.id,reference:e,instance:t,overrideLevel:o&&Number.isInteger(o)?{num:0,start:o}:{num:0,start:1}};this.concreteNumberingMap.set(r,new ga(a))}}}},{key:"ConcreteNumbering",get:function(){return Array.from(this.concreteNumberingMap.values())}},{key:"ReferenceConfig",get:function(){return Array.from(this.referenceConfigMap.values())}}]),r}(A),Sa=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={version:"w:val",name:"w:name",uri:"w:uri"},e}return h(n)}(O),Ea=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:compatSetting")).root.push(new Sa({version:e,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"})),r}return h(n)}(A),ka=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),r=t.call(this,"w:compat"),e.version&&r.root.push(new Ea(e.version)),e.useSingleBorderforContiguousCells&&r.root.push(new j("w:useSingleBorderforContiguousCells",e.useSingleBorderforContiguousCells)),e.wordPerfectJustification&&r.root.push(new j("w:wpJustification",e.wordPerfectJustification)),e.noTabStopForHangingIndent&&r.root.push(new j("w:noTabHangInd",e.noTabStopForHangingIndent)),e.noLeading&&r.root.push(new j("w:noLeading",e.noLeading)),e.spaceForUnderline&&r.root.push(new j("w:spaceForUL",e.spaceForUnderline)),e.noColumnBalance&&r.root.push(new j("w:noColumnBalance",e.noColumnBalance)),e.balanceSingleByteDoubleByteWidth&&r.root.push(new j("w:balanceSingleByteDoubleByteWidth",e.balanceSingleByteDoubleByteWidth)),e.noExtraLineSpacing&&r.root.push(new j("w:noExtraLineSpacing",e.noExtraLineSpacing)),e.doNotLeaveBackslashAlone&&r.root.push(new j("w:doNotLeaveBackslashAlone",e.doNotLeaveBackslashAlone)),e.underlineTrailingSpaces&&r.root.push(new j("w:ulTrailSpace",e.underlineTrailingSpaces)),e.doNotExpandShiftReturn&&r.root.push(new j("w:doNotExpandShiftReturn",e.doNotExpandShiftReturn)),e.spacingInWholePoints&&r.root.push(new j("w:spacingInWholePoints",e.spacingInWholePoints)),e.lineWrapLikeWord6&&r.root.push(new j("w:lineWrapLikeWord6",e.lineWrapLikeWord6)),e.printBodyTextBeforeHeader&&r.root.push(new j("w:printBodyTextBeforeHeader",e.printBodyTextBeforeHeader)),e.printColorsBlack&&r.root.push(new j("w:printColBlack",e.printColorsBlack)),e.spaceWidth&&r.root.push(new j("w:wpSpaceWidth",e.spaceWidth)),e.showBreaksInFrames&&r.root.push(new j("w:showBreaksInFrames",e.showBreaksInFrames)),e.subFontBySize&&r.root.push(new j("w:subFontBySize",e.subFontBySize)),e.suppressBottomSpacing&&r.root.push(new j("w:suppressBottomSpacing",e.suppressBottomSpacing)),e.suppressTopSpacing&&r.root.push(new j("w:suppressTopSpacing",e.suppressTopSpacing)),e.suppressSpacingAtTopOfPage&&r.root.push(new j("w:suppressSpacingAtTopOfPage",e.suppressSpacingAtTopOfPage)),e.suppressTopSpacingWP&&r.root.push(new j("w:suppressTopSpacingWP",e.suppressTopSpacingWP)),e.suppressSpBfAfterPgBrk&&r.root.push(new j("w:suppressSpBfAfterPgBrk",e.suppressSpBfAfterPgBrk)),e.swapBordersFacingPages&&r.root.push(new j("w:swapBordersFacingPages",e.swapBordersFacingPages)),e.convertMailMergeEsc&&r.root.push(new j("w:convMailMergeEsc",e.convertMailMergeEsc)),e.truncateFontHeightsLikeWP6&&r.root.push(new j("w:truncateFontHeightsLikeWP6",e.truncateFontHeightsLikeWP6)),e.macWordSmallCaps&&r.root.push(new j("w:mwSmallCaps",e.macWordSmallCaps)),e.usePrinterMetrics&&r.root.push(new j("w:usePrinterMetrics",e.usePrinterMetrics)),e.doNotSuppressParagraphBorders&&r.root.push(new j("w:doNotSuppressParagraphBorders",e.doNotSuppressParagraphBorders)),e.wrapTrailSpaces&&r.root.push(new j("w:wrapTrailSpaces",e.wrapTrailSpaces)),e.footnoteLayoutLikeWW8&&r.root.push(new j("w:footnoteLayoutLikeWW8",e.footnoteLayoutLikeWW8)),e.shapeLayoutLikeWW8&&r.root.push(new j("w:shapeLayoutLikeWW8",e.shapeLayoutLikeWW8)),e.alignTablesRowByRow&&r.root.push(new j("w:alignTablesRowByRow",e.alignTablesRowByRow)),e.forgetLastTabAlignment&&r.root.push(new j("w:forgetLastTabAlignment",e.forgetLastTabAlignment)),e.adjustLineHeightInTable&&r.root.push(new j("w:adjustLineHeightInTable",e.adjustLineHeightInTable)),e.autoSpaceLikeWord95&&r.root.push(new j("w:autoSpaceLikeWord95",e.autoSpaceLikeWord95)),e.noSpaceRaiseLower&&r.root.push(new j("w:noSpaceRaiseLower",e.noSpaceRaiseLower)),e.doNotUseHTMLParagraphAutoSpacing&&r.root.push(new j("w:doNotUseHTMLParagraphAutoSpacing",e.doNotUseHTMLParagraphAutoSpacing)),e.layoutRawTableWidth&&r.root.push(new j("w:layoutRawTableWidth",e.layoutRawTableWidth)),e.layoutTableRowsApart&&r.root.push(new j("w:layoutTableRowsApart",e.layoutTableRowsApart)),e.useWord97LineBreakRules&&r.root.push(new j("w:useWord97LineBreakRules",e.useWord97LineBreakRules)),e.doNotBreakWrappedTables&&r.root.push(new j("w:doNotBreakWrappedTables",e.doNotBreakWrappedTables)),e.doNotSnapToGridInCell&&r.root.push(new j("w:doNotSnapToGridInCell",e.doNotSnapToGridInCell)),e.selectFieldWithFirstOrLastCharacter&&r.root.push(new j("w:selectFldWithFirstOrLastChar",e.selectFieldWithFirstOrLastCharacter)),e.applyBreakingRules&&r.root.push(new j("w:applyBreakingRules",e.applyBreakingRules)),e.doNotWrapTextWithPunctuation&&r.root.push(new j("w:doNotWrapTextWithPunct",e.doNotWrapTextWithPunctuation)),e.doNotUseEastAsianBreakRules&&r.root.push(new j("w:doNotUseEastAsianBreakRules",e.doNotUseEastAsianBreakRules)),e.useWord2002TableStyleRules&&r.root.push(new j("w:useWord2002TableStyleRules",e.useWord2002TableStyleRules)),e.growAutofit&&r.root.push(new j("w:growAutofit",e.growAutofit)),e.useFELayout&&r.root.push(new j("w:useFELayout",e.useFELayout)),e.useNormalStyleForList&&r.root.push(new j("w:useNormalStyleForList",e.useNormalStyleForList)),e.doNotUseIndentAsNumberingTabStop&&r.root.push(new j("w:doNotUseIndentAsNumberingTabStop",e.doNotUseIndentAsNumberingTabStop)),e.useAlternateEastAsianLineBreakRules&&r.root.push(new j("w:useAltKinsokuLineBreakRules",e.useAlternateEastAsianLineBreakRules)),e.allowSpaceOfSameStyleInTable&&r.root.push(new j("w:allowSpaceOfSameStyleInTable",e.allowSpaceOfSameStyleInTable)),e.doNotSuppressIndentation&&r.root.push(new j("w:doNotSuppressIndentation",e.doNotSuppressIndentation)),e.doNotAutofitConstrainedTables&&r.root.push(new j("w:doNotAutofitConstrainedTables",e.doNotAutofitConstrainedTables)),e.autofitToFirstFixedWidthCell&&r.root.push(new j("w:autofitToFirstFixedWidthCell",e.autofitToFirstFixedWidthCell)),e.underlineTabInNumberingList&&r.root.push(new j("w:underlineTabInNumList",e.underlineTabInNumberingList)),e.displayHangulFixedWidth&&r.root.push(new j("w:displayHangulFixedWidth",e.displayHangulFixedWidth)),e.splitPgBreakAndParaMark&&r.root.push(new j("w:splitPgBreakAndParaMark",e.splitPgBreakAndParaMark)),e.doNotVerticallyAlignCellWithSp&&r.root.push(new j("w:doNotVertAlignCellWithSp",e.doNotVerticallyAlignCellWithSp)),e.doNotBreakConstrainedForcedTable&&r.root.push(new j("w:doNotBreakConstrainedForcedTable",e.doNotBreakConstrainedForcedTable)),e.ignoreVerticalAlignmentInTextboxes&&r.root.push(new j("w:doNotVertAlignInTxbx",e.ignoreVerticalAlignmentInTextboxes)),e.useAnsiKerningPairs&&r.root.push(new j("w:useAnsiKerningPairs",e.useAnsiKerningPairs)),e.cachedColumnBalance&&r.root.push(new j("w:cachedColBalance",e.cachedColumnBalance)),r}return h(n)}(A),xa=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"},e}return h(n)}(O),Ta=function(e){p(n,e);var t=v(n);function n(e){var r,i,o,a,s;return d(this,n),(r=t.call(this,"w:settings")).root.push(new xa({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),r.root.push(new j("w:displayBackgroundShape",!0)),void 0!==e.trackRevisions&&r.root.push(new j("w:trackRevisions",e.trackRevisions)),void 0!==e.evenAndOddHeaders&&r.root.push(new j("w:evenAndOddHeaders",e.evenAndOddHeaders)),void 0!==e.updateFields&&r.root.push(new j("w:updateFields",e.updateFields)),r.root.push(new ka(Object.assign(Object.assign({},null!==(i=e.compatibility)&&void 0!==i?i:{}),{version:null!==(s=null!==(a=null===(o=e.compatibility)||void 0===o?void 0:o.version)&&void 0!==a?a:e.compatibilityModeVersion)&&void 0!==s?s:15}))),r}return h(n)}(A),Ra=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={val:"w:val"},e}return h(n)}(O),Aa=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:name")).root.push(new Ra({val:e})),r}return h(n)}(A),_a=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:uiPriority")).root.push(new Ra({val:(0,B.vH)(e)})),r}return h(n)}(A),Oa=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"},e}return h(n)}(O),Da=function(e){p(n,e);var t=v(n);function n(e,r){var i;return d(this,n),(i=t.call(this,"w:style")).root.push(new Oa(e)),r.name&&i.root.push(new Aa(r.name)),r.basedOn&&i.root.push(new V("w:basedOn",r.basedOn)),r.next&&i.root.push(new V("w:next",r.next)),r.link&&i.root.push(new V("w:link",r.link)),void 0!==r.uiPriority&&i.root.push(new _a(r.uiPriority)),void 0!==r.semiHidden&&i.root.push(new j("w:semiHidden",r.semiHidden)),void 0!==r.unhideWhenUsed&&i.root.push(new j("w:unhideWhenUsed",r.unhideWhenUsed)),void 0!==r.quickFormat&&i.root.push(new j("w:qFormat",r.quickFormat)),i}return h(n)}(A),Na=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,{type:"paragraph",styleId:e.id},e)).paragraphProperties=new Wr(e.paragraph),r.runProperties=new xe(e.run),r.root.push(r.paragraphProperties),r.root.push(r.runProperties),r}return h(n)}(Da),Pa=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,{type:"character",styleId:e.id},Object.assign({uiPriority:99,unhideWhenUsed:!0},e))).runProperties=new xe(e.run),r.root.push(r.runProperties),r}return h(n)}(Da),Fa=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{basedOn:"Normal",next:"Normal",quickFormat:!0}))}return h(n)}(Na),Ia=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"Title",name:"Title"}))}return h(n)}(Fa),La=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"Heading1",name:"Heading 1"}))}return h(n)}(Fa),Ma=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"Heading2",name:"Heading 2"}))}return h(n)}(Fa),Ga=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"Heading3",name:"Heading 3"}))}return h(n)}(Fa),Ba=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"Heading4",name:"Heading 4"}))}return h(n)}(Fa),ja=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"Heading5",name:"Heading 5"}))}return h(n)}(Fa),Ha=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"Heading6",name:"Heading 6"}))}return h(n)}(Fa),Va=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"Strong",name:"Strong"}))}return h(n)}(Fa),Wa=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0}))}return h(n)}(Na),za=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:Pe.AUTO}},run:{size:20}}))}return h(n)}(Na),Ua=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}}))}return h(n)}(Pa),Ka=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}}))}return h(n)}(Pa),qa=function(e){p(n,e);var t=v(n);function n(e){return d(this,n),t.call(this,Object.assign(Object.assign({},e),{id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:k.SINGLE}}}))}return h(n)}(Pa),Xa=function(e){p(n,e);var t=v(n);function n(e){var r;if(d(this,n),r=t.call(this,"w:styles"),e.initialStyles&&r.root.push(e.initialStyles),e.importedStyles){var i,o=s(e.importedStyles);try{for(o.s();!(i=o.n()).done;){var l=i.value;r.root.push(l)}}catch(g){o.e(g)}finally{o.f()}}if(e.paragraphStyles){var u,c=s(e.paragraphStyles);try{for(c.s();!(u=c.n()).done;){var h=u.value;r.root.push(new Na(h))}}catch(g){c.e(g)}finally{c.f()}}if(e.characterStyles){var f,p=s(e.characterStyles);try{for(p.s();!(f=p.n()).done;){var v=f.value;r.root.push(new Pa(v))}}catch(g){p.e(g)}finally{p.f()}}return a(r)}return h(n)}(A),Ya=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:pPrDefault")).root.push(new Wr(e)),r}return h(n)}(A),Qa=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:rPrDefault")).root.push(new xe(e)),r}return h(n)}(A),Za=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:docDefaults")).runPropertiesDefaults=new Qa(e.run),r.paragraphPropertiesDefaults=new Ya(e.paragraph),r.root.push(r.runPropertiesDefaults),r.root.push(r.paragraphPropertiesDefaults),r}return h(n)}(A),Ja=function(){function e(){d(this,e)}return h(e,[{key:"newInstance",value:function(e){var t,n,r=(0,N.xml2js)(e,{compact:!1}),i=s(r.elements||[]);try{for(i.s();!(n=i.n()).done;){var o=n.value;"w:styles"===o.name&&(t=o)}}catch(l){i.e(l)}finally{i.f()}if(void 0===t)throw new Error("can not find styles element");var a=t.elements||[];return new Xa({initialStyles:new L(t.attributes),importedStyles:a.map((function(e){return P(e)}))})}}]),e}(),$a=function(){function e(){d(this,e)}return h(e,[{key:"newInstance",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{initialStyles:new Ar({mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",Ignorable:"w14 w15"}),importedStyles:[new Za(null!==(e=t.document)&&void 0!==e?e:{}),new Ia(Object.assign({run:{size:56}},t.title)),new La(Object.assign({run:{color:"2E74B5",size:32}},t.heading1)),new Ma(Object.assign({run:{color:"2E74B5",size:26}},t.heading2)),new Ga(Object.assign({run:{color:"1F4D78",size:24}},t.heading3)),new Ba(Object.assign({run:{color:"2E74B5",italics:!0}},t.heading4)),new ja(Object.assign({run:{color:"2E74B5"}},t.heading5)),new Ha(Object.assign({run:{color:"1F4D78"}},t.heading6)),new Va(Object.assign({run:{bold:!0}},t.strong)),new Wa(t.listParagraph||{}),new qa(t.hyperlink||{}),new Ua(t.footnoteReference||{}),new za(t.footnoteText||{}),new Ka(t.footnoteTextChar||{})]}}}]),e}(),es=function(){function e(t){var n,r,i,o,a,l,u,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(d(this,e),this.currentRelationshipId=1,this.headers=[],this.footers=[],this.coreProperties=new Ro(Object.assign(Object.assign({},t),{creator:null!==(n=t.creator)&&void 0!==n?n:"Un-named",revision:null!==(r=t.revision)&&void 0!==r?r:1,lastModifiedBy:null!==(i=t.lastModifiedBy)&&void 0!==i?i:"Un-named"})),this.numbering=new Ca(t.numbering?t.numbering:{config:[]}),this.comments=new En(null!==(o=t.comments)&&void 0!==o?o:{children:[]}),this.fileRelationships=new Pr,this.customProperties=new Po(null!==(a=t.customProperties)&&void 0!==a?a:[]),this.appProperties=new bo,this.footnotesWrapper=new Yo,this.contentTypes=new To,this.documentWrapper=new Fr({background:t.background}),this.settings=new Ta({compatibilityModeVersion:t.compatabilityModeVersion,compatibility:t.compatibility,evenAndOddHeaders:!!t.evenAndOddHeaderAndFooters,trackRevisions:null===(l=t.features)||void 0===l?void 0:l.trackRevisions,updateFields:null===(u=t.features)||void 0===u?void 0:u.updateFields}),this.media=c.template&&c.template.media?c.template.media:new $o,c.template&&(this.currentRelationshipId=c.template.currentRelationshipId+1),c.template&&t.externalStyles)throw Error("can not use both template and external styles");if(c.template&&c.template.styles){var h=new Ja;this.styles=h.newInstance(c.template.styles)}else if(t.externalStyles){var f=new Ja;this.styles=f.newInstance(t.externalStyles)}else if(t.styles){var p=(new $a).newInstance(t.styles.default);this.styles=new Xa(Object.assign(Object.assign({},p),t.styles))}else{var v=new $a;this.styles=new Xa(v.newInstance())}if(this.addDefaultRelationships(),c.template&&c.template.headers){var g,m=s(c.template.headers);try{for(m.s();!(g=m.n()).done;){var y=g.value;this.addHeaderToDocument(y.header,y.type)}}catch(T){m.e(T)}finally{m.f()}}if(c.template&&c.template.footers){var w,b=s(c.template.footers);try{for(b.s();!(w=b.n()).done;){var C=w.value;this.addFooterToDocument(C.footer,C.type)}}catch(T){b.e(T)}finally{b.f()}}var S,E=s(t.sections);try{for(E.s();!(S=E.n()).done;){var k=S.value;this.addSection(k)}}catch(T){E.e(T)}finally{E.f()}if(t.footnotes)for(var x in t.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(x),t.footnotes[x].children)}return h(e,[{key:"addSection",value:function(e){var t=e.headers,n=void 0===t?{}:t,r=e.footers,i=void 0===r?{}:r,o=e.children,a=e.properties;this.documentWrapper.View.Body.addSection(Object.assign(Object.assign({},a),{headerWrapperGroup:{default:n.default?this.createHeader(n.default):void 0,first:n.first?this.createHeader(n.first):void 0,even:n.even?this.createHeader(n.even):void 0},footerWrapperGroup:{default:i.default?this.createFooter(i.default):void 0,first:i.first?this.createFooter(i.first):void 0,even:i.even?this.createFooter(i.even):void 0}}));var l,u=s(o);try{for(u.s();!(l=u.n()).done;){var c=l.value;this.documentWrapper.View.add(c)}}catch(d){u.e(d)}finally{u.f()}}},{key:"createHeader",value:function(e){var t,n=new Jo(this.media,this.currentRelationshipId++),r=s(e.options.children);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.add(i)}}catch(o){r.e(o)}finally{r.f()}return this.addHeaderToDocument(n),n}},{key:"createFooter",value:function(e){var t,n=new Lo(this.media,this.currentRelationshipId++),r=s(e.options.children);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.add(i)}}catch(o){r.e(o)}finally{r.f()}return this.addFooterToDocument(n),n}},{key:"addHeaderToDocument",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:He.DEFAULT;this.headers.push({header:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header","header".concat(this.headers.length,".xml")),this.contentTypes.addHeader(this.headers.length)}},{key:"addFooterToDocument",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:He.DEFAULT;this.footers.push({footer:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer","footer".concat(this.footers.length,".xml")),this.contentTypes.addFooter(this.footers.length)}},{key:"addDefaultRelationships",value:function(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}},{key:"Document",get:function(){return this.documentWrapper}},{key:"Styles",get:function(){return this.styles}},{key:"CoreProperties",get:function(){return this.coreProperties}},{key:"Numbering",get:function(){return this.numbering}},{key:"Media",get:function(){return this.media}},{key:"FileRelationships",get:function(){return this.fileRelationships}},{key:"Headers",get:function(){return this.headers.map((function(e){return e.header}))}},{key:"Footers",get:function(){return this.footers.map((function(e){return e.footer}))}},{key:"ContentTypes",get:function(){return this.contentTypes}},{key:"CustomProperties",get:function(){return this.customProperties}},{key:"AppProperties",get:function(){return this.appProperties}},{key:"FootNotes",get:function(){return this.footnotesWrapper}},{key:"Settings",get:function(){return this.settings}},{key:"Comments",get:function(){return this.comments}}]),e}(),ts="",ns=function(e){p(n,e);var t=v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,n),(e=t.call(this,"w:instrText")).properties=r,e.root.push(new oe({space:C.PRESERVE}));var i="TOC";return e.properties.captionLabel&&(i="".concat(i,' \\a "').concat(e.properties.captionLabel,'"')),e.properties.entriesFromBookmark&&(i="".concat(i,' \\b "').concat(e.properties.entriesFromBookmark,'"')),e.properties.captionLabelIncludingNumbers&&(i="".concat(i,' \\c "').concat(e.properties.captionLabelIncludingNumbers,'"')),e.properties.sequenceAndPageNumbersSeparator&&(i="".concat(i,' \\d "').concat(e.properties.sequenceAndPageNumbersSeparator,'"')),e.properties.tcFieldIdentifier&&(i="".concat(i,' \\f "').concat(e.properties.tcFieldIdentifier,'"')),e.properties.hyperlink&&(i="".concat(i," \\h")),e.properties.tcFieldLevelRange&&(i="".concat(i,' \\l "').concat(e.properties.tcFieldLevelRange,'"')),e.properties.pageNumbersEntryLevelsRange&&(i="".concat(i,' \\n "').concat(e.properties.pageNumbersEntryLevelsRange,'"')),e.properties.headingStyleRange&&(i="".concat(i,' \\o "').concat(e.properties.headingStyleRange,'"')),e.properties.entryAndPageNumberSeparator&&(i="".concat(i,' \\p "').concat(e.properties.entryAndPageNumberSeparator,'"')),e.properties.seqFieldIdentifierForPrefix&&(i="".concat(i,' \\s "').concat(e.properties.seqFieldIdentifierForPrefix,'"')),e.properties.stylesWithLevels&&e.properties.stylesWithLevels.length&&(i="".concat(i,' \\t "').concat(e.properties.stylesWithLevels.map((function(e){return"".concat(e.styleName,",").concat(e.level)})).join(","),'"')),e.properties.useAppliedParagraphOutlineLevel&&(i="".concat(i," \\u")),e.properties.preserveTabInEntries&&(i="".concat(i," \\w")),e.properties.preserveNewLineInEntries&&(i="".concat(i," \\x")),e.properties.hideTabAndPageNumbersInWebView&&(i="".concat(i," \\z")),e.root.push(i),e}return h(n)}(A),rs=function(e){p(n,e);var t=v(n);function n(){return d(this,n),t.call(this,"w:sdtContent")}return h(n)}(A),is=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:sdtPr")).root.push(new V("w:alias",e)),r}return h(n)}(A),os=function(e){p(n,e);var t=v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Table of Contents",i=arguments.length>1?arguments[1]:void 0;d(this,n),(e=t.call(this,"w:sdt")).root.push(new is(r));var o=new rs,a=new zr({children:[new Je({children:[new ne(!0),new ns(i),new re]})]});o.addChildElement(a);var s=new zr({children:[new Je({children:[new ie]})]});return o.addChildElement(s),e.root.push(o),e}return h(n)}(A),as=h((function e(t,n){d(this,e),this.styleName=t,this.level=n})),ss=h((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{children:[]};d(this,e),this.options=t})),ls=h((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{children:[]};d(this,e),this.options=t})),us=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).xmlKeys={id:"w:id"},e}return h(n)}(O),cs=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:footnoteReference")).root.push(new us({id:e})),r}return h(n)}(A),ds=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,{style:"FootnoteReference"})).root.push(new cs(e)),r}return h(n)}(Je),hs=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:ins")).root.push(new de({id:e.id,author:e.author,date:e.date})),r.addChildElement(new $e(e)),r}return h(n)}(A),fs=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"w:delInstrText")).root.push(new oe({space:C.PRESERVE})),e.root.push("PAGE"),e}return h(n)}(A),ps=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"w:delInstrText")).root.push(new oe({space:C.PRESERVE})),e.root.push("NUMPAGES"),e}return h(n)}(A),vs=function(e){p(n,e);var t=v(n);function n(){var e;return d(this,n),(e=t.call(this,"w:delInstrText")).root.push(new oe({space:C.PRESERVE})),e.root.push("SECTIONPAGES"),e}return h(n)}(A),gs=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:delText")).root.push(new oe({space:C.PRESERVE})),r.root.push(e),r}return h(n)}(A),ms=function(e){p(n,e);var t=v(n);function n(e){var r;return d(this,n),(r=t.call(this,"w:del")).root.push(new de({id:e.id,author:e.author,date:e.date})),r.deletedTextRunWrapper=new ys(e),r.addChildElement(r.deletedTextRunWrapper),r}return h(n)}(A),ys=function(e){p(n,e);var t=v(n);function n(e){var r;if(d(this,n),(r=t.call(this,"w:r")).root.push(new xe(e)),e.children){var i,o=s(e.children);try{for(o.s();!(i=o.n()).done;){var l=i.value;if("string"!=typeof l)r.root.push(l);else switch(l){case x.CURRENT:r.root.push(new ne),r.root.push(new fs),r.root.push(new re),r.root.push(new ie);break;case x.TOTAL_PAGES:r.root.push(new ne),r.root.push(new ps),r.root.push(new re),r.root.push(new ie);break;case x.TOTAL_PAGES_IN_SECTION:r.root.push(new ne),r.root.push(new vs),r.root.push(new re),r.root.push(new ie);break;default:r.root.push(new gs(l))}}}catch(c){o.e(c)}finally{o.f()}}else e.text&&r.root.push(new gs(e.text));if(e.break)for(var u=0;u<e.break;u++)r.root.splice(1,0,new ee);return a(r)}return h(n)}(A),ws=n(6085),bs=n(3479),Cs=function(){function e(){d(this,e)}return h(e,[{key:"format",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.prepForXml(t);if(n)return n;throw Error("XMLComponent did not format correctly")}}]),e}(),Ss=function(){function e(){d(this,e)}return h(e,[{key:"replace",value:function(e,t,n){var r=e;return t.forEach((function(e,t){r=r.replace(new RegExp("{".concat(e.fileName,"}"),"g"),(n+t).toString())})),r}},{key:"getMediaData",value:function(e,t){return t.Array.filter((function(t){return e.search("{".concat(t.fileName,"}"))>0}))}}]),e}(),Es=function(){function e(){d(this,e)}return h(e,[{key:"replace",value:function(e,t){var n,r=e,i=s(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;r=r.replace(new RegExp("{".concat(o.reference,"-").concat(o.instance,"}"),"g"),o.numId.toString())}}catch(a){i.e(a)}finally{i.f()}return r}}]),e}(),ks=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.NONE="",e.WITH_2_BLANKS="  ",e.WITH_4_BLANKS="    ",e.WITH_TAB="\t"}(oa||(oa={}));var xs=function(){function e(){d(this,e)}return h(e,null,[{key:"toString",value:function(e,t){return ks(this,void 0,void 0,i().mark((function n(){var r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.compiler.compile(e,t),n.next=3,r.generateAsync({type:"string",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"toBuffer",value:function(e,t){return ks(this,void 0,void 0,i().mark((function n(){var r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.compiler.compile(e,t),n.next=3,r.generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"toBase64String",value:function(e,t){return ks(this,void 0,void 0,i().mark((function n(){var r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.compiler.compile(e,t),n.next=3,r.generateAsync({type:"base64",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"toBlob",value:function(e,t){return ks(this,void 0,void 0,i().mark((function n(){var r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.compiler.compile(e,t),n.next=3,r.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"toStream",value:function(e,t){return this.compiler.compile(e,t).generateNodeStream({type:"nodebuffer",streamFiles:!0,mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})}}]),e}();xs.compiler=new(function(){function e(){d(this,e),this.formatter=new Cs,this.imageReplacer=new Ss,this.numberingReplacer=new Es}return h(e,[{key:"compile",value:function(e,t){var n,i=new ws,o=this.xmlifyFile(e,t),a=new Map(Object.entries(o)),l=s(a);try{for(l.s();!(n=l.n()).done;){var u=r(n.value,2)[1];if(Array.isArray(u)){var c,d=s(u);try{for(d.s();!(c=d.n()).done;){var h=c.value;i.file(h.path,h.data)}}catch(m){d.e(m)}finally{d.f()}}else i.file(u.path,u.data)}}catch(m){l.e(m)}finally{l.f()}var f,p=s(e.Media.Array);try{for(p.s();!(f=p.n()).done;){var v=f.value,g=v.stream;i.file("word/media/".concat(v.fileName),g)}}catch(m){p.e(m)}finally{p.f()}return i}},{key:"xmlifyFile",value:function(e,t){var n=this,r=e.Document.Relationships.RelationshipCount+1,i=bs(this.formatter.format(e.Document.View,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),o=this.imageReplacer.getMediaData(i,e.Media);return{Relationships:{data:(o.forEach((function(t,n){e.Document.Relationships.createRelationship(r+n,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image","media/".concat(t.fileName))})),bs(n.formatter.format(e.Document.Relationships,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:function(){var t=n.imageReplacer.replace(i,o,r);return n.numberingReplacer.replace(t,e.Numbering.ConcreteNumbering)}(),path:"word/document.xml"},Styles:{data:function(){var r=bs(n.formatter.format(e.Styles,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}});return n.numberingReplacer.replace(r,e.Numbering.ConcreteNumbering)}(),path:"word/styles.xml"},Properties:{data:bs(this.formatter.format(e.CoreProperties,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:bs(this.formatter.format(e.Numbering,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:bs(this.formatter.format(e.FileRelationships,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:e.Headers.map((function(r,i){var o=bs(n.formatter.format(r.View,{viewWrapper:r,file:e}),{indent:t,declaration:{encoding:"UTF-8"}});return n.imageReplacer.getMediaData(o,e.Media).forEach((function(e,t){r.Relationships.createRelationship(t,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image","media/".concat(e.fileName))})),{data:bs(n.formatter.format(r.Relationships,{viewWrapper:r,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/header".concat(i+1,".xml.rels")}})),FooterRelationships:e.Footers.map((function(r,i){var o=bs(n.formatter.format(r.View,{viewWrapper:r,file:e}),{indent:t,declaration:{encoding:"UTF-8"}});return n.imageReplacer.getMediaData(o,e.Media).forEach((function(e,t){r.Relationships.createRelationship(t,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image","media/".concat(e.fileName))})),{data:bs(n.formatter.format(r.Relationships,{viewWrapper:r,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footer".concat(i+1,".xml.rels")}})),Headers:e.Headers.map((function(r,i){var o=bs(n.formatter.format(r.View,{viewWrapper:r,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),a=n.imageReplacer.getMediaData(o,e.Media),s=n.imageReplacer.replace(o,a,0);return{data:n.numberingReplacer.replace(s,e.Numbering.ConcreteNumbering),path:"word/header".concat(i+1,".xml")}})),Footers:e.Footers.map((function(r,i){var o=bs(n.formatter.format(r.View,{viewWrapper:r,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),a=n.imageReplacer.getMediaData(o,e.Media),s=n.imageReplacer.replace(o,a,0);return{data:n.numberingReplacer.replace(s,e.Numbering.ConcreteNumbering),path:"word/footer".concat(i+1,".xml")}})),ContentTypes:{data:bs(this.formatter.format(e.ContentTypes,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:bs(this.formatter.format(e.CustomProperties,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:bs(this.formatter.format(e.AppProperties,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:bs(this.formatter.format(e.FootNotes.View,{viewWrapper:e.FootNotes,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:bs(this.formatter.format(e.FootNotes.Relationships,{viewWrapper:e.FootNotes,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:bs(this.formatter.format(e.Settings,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:bs(this.formatter.format(e.Comments,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/comments.xml"}}}}]),e}());var Ts,Rs=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},As={"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header":"header","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer":"footer","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":"image","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink":"hyperlink"};!function(e){e.HEADER="header",e.FOOTER="footer",e.IMAGE="image",e.HYPERLINK="hyperlink"}(Ts||(Ts={}));var _s=function(){function e(){d(this,e)}return h(e,[{key:"extract",value:function(e){return Rs(this,void 0,void 0,i().mark((function t(){var n,r,o,a,s,l;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ws.loadAsync(e);case 2:return n=t.sent,t.next=5,n.files["word/document.xml"].async("text");case 5:return r=t.sent,t.next=8,n.files["word/_rels/document.xml.rels"].async("text");case 8:return o=t.sent,a=this.extractDocumentRefs(r),s=this.findReferenceFiles(o),l=new $o,t.next=14,this.createHeaders(n,a,s,l,0);case 14:return t.t0=t.sent,t.next=17,this.createFooters(n,a,s,l,a.headers.length);case 17:return t.t1=t.sent,t.t2=a.footers.length+a.headers.length,t.next=21,n.files["word/styles.xml"].async("text");case 21:return t.t3=t.sent,t.t4=this.checkIfTitlePageIsDefined(r),t.t5=l,t.abrupt("return",{headers:t.t0,footers:t.t1,currentRelationshipId:t.t2,styles:t.t3,titlePageIsDefined:t.t4,media:t.t5});case 25:case"end":return t.stop()}}),t,this)})))}},{key:"createFooters",value:function(e,t,n,r,o){return Rs(this,void 0,void 0,i().mark((function a(){var s,l=this;return i().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s=t.footers.map((function(t,a){return Rs(l,void 0,void 0,i().mark((function s(){var l,u,c,d,h,f;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(l=n.find((function(e){return e.id===t.id})),null!==l&&l){i.next=3;break}throw new Error("Can not find target file for id ".concat(t.id));case 3:return i.next=5,e.files["word/".concat(l.target)].async("text");case 5:if(u=i.sent,(c=(0,N.xml2js)(u,{compact:!1,captureSpacesBetweenElements:!0})).elements){i.next=9;break}return i.abrupt("return");case 9:return d=c.elements.reduce((function(e,t){return"w:ftr"===t.name?t:e})),h=P(d),f=new Lo(r,o+a,h),i.next=12,this.addRelationshipToWrapper(l,e,f,r);case 12:return i.abrupt("return",{type:t.type,footer:f});case 13:case"end":return i.stop()}}),s,this)})))})).filter((function(e){return!!e})),a.abrupt("return",Promise.all(s));case 2:case"end":return a.stop()}}),a)})))}},{key:"createHeaders",value:function(e,t,n,r,o){return Rs(this,void 0,void 0,i().mark((function a(){var s,l=this;return i().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s=t.headers.map((function(t,a){return Rs(l,void 0,void 0,i().mark((function s(){var l,u,c,d,h,f;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(l=n.find((function(e){return e.id===t.id})),null!==l&&l){i.next=3;break}throw new Error("Can not find target file for id ".concat(t.id));case 3:return i.next=5,e.files["word/".concat(l.target)].async("text");case 5:if(u=i.sent,(c=(0,N.xml2js)(u,{compact:!1,captureSpacesBetweenElements:!0})).elements){i.next=9;break}return i.abrupt("return");case 9:return d=c.elements.reduce((function(e,t){return"w:hdr"===t.name?t:e})),h=P(d),f=new Jo(r,o+a,h),i.next=12,this.addRelationshipToWrapper(l,e,f,r);case 12:return i.abrupt("return",{type:t.type,header:f});case 13:case"end":return i.stop()}}),s,this)})))})).filter((function(e){return!!e})),a.abrupt("return",Promise.all(s));case 2:case"end":return a.stop()}}),a)})))}},{key:"addRelationshipToWrapper",value:function(e,t,n,r){return Rs(this,void 0,void 0,i().mark((function o(){var a,l,u,c,d,h,f,p,v,g,m,y,w;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=t.files["word/_rels/".concat(e.target,".rels")]){i.next=3;break}return i.abrupt("return");case 3:return i.next=5,a.async("text");case 5:l=i.sent,u=this.findReferenceFiles(l).filter((function(e){return e.type===Ts.IMAGE})),c=this.findReferenceFiles(l).filter((function(e){return e.type===Ts.HYPERLINK})),d=s(u),i.prev=9,d.s();case 11:if((h=d.n()).done){i.next=21;break}return f=h.value,p=ws.support.arraybuffer?"arraybuffer":"nodebuffer",i.next=16,t.files["word/".concat(f.target)].async(p);case 16:v=i.sent,g=r.addMedia(v,{width:100,height:100}),n.Relationships.createRelationship(f.id,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image","media/".concat(g.fileName));case 19:i.next=11;break;case 21:i.next=26;break;case 23:i.prev=23,i.t0=i.catch(9),d.e(i.t0);case 26:return i.prev=26,d.f(),i.finish(26);case 29:m=s(c);try{for(m.s();!(y=m.n()).done;)w=y.value,n.Relationships.createRelationship(w.id,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",w.target,Ge.EXTERNAL)}catch(o){m.e(o)}finally{m.f()}case 31:case"end":return i.stop()}}),o,this,[[9,23,26,29]])})))}},{key:"findReferenceFiles",value:function(e){var t=this,n=(0,N.xml2js)(e,{compact:!0});return(Array.isArray(n.Relationships.Relationship)?n.Relationships.Relationship:[n.Relationships.Relationship]).map((function(e){if(void 0===e._attributes)throw Error("relationship element has no attributes");return{id:t.parseRefId(e._attributes.Id),type:As[e._attributes.Type],target:e._attributes.Target}})).filter((function(e){return null!==e.type}))}},{key:"extractDocumentRefs",value:function(e){var t=this,n=(0,N.xml2js)(e,{compact:!0})["w:document"]["w:body"]["w:sectPr"],r=n["w:headerReference"],i=(void 0===r?[]:Array.isArray(r)?r:[r]).map((function(e){if(void 0===e._attributes)throw Error("header reference element has no attributes");return{type:e._attributes["w:type"],id:t.parseRefId(e._attributes["r:id"])}})),o=n["w:footerReference"];return{headers:i,footers:(void 0===o?[]:Array.isArray(o)?o:[o]).map((function(e){if(void 0===e._attributes)throw Error("footer reference element has no attributes");return{type:e._attributes["w:type"],id:t.parseRefId(e._attributes["r:id"])}}))}}},{key:"checkIfTitlePageIsDefined",value:function(e){return void 0!==(0,N.xml2js)(e,{compact:!0})["w:document"]["w:body"]["w:sectPr"]["w:titlePg"]}},{key:"parseRefId",value:function(e){var t=/^rId(\d+)$/.exec(e);if(null===t)throw new Error("Invalid ref id");return parseInt(t[1],10)}}]),e}(),Os=n(5575)}(),g}()},4802:function(e,t,n){var r,i,o;i=[],void 0===(o="function"===typeof(r=function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function r(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){l(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,s=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,t,n){var s=a.URL||a.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?o(l):i(l.href)?r(e,t,n):o(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){o(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,a),n);else if(i(e))r(e,n,a);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){o(s)}))}}:function(e,t,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return r(e,t,n);var o="application/octet-stream"===e.type,l=/constructor/i.test(a.HTMLElement)||a.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||o&&l||s)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=u?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},c.readAsDataURL(e)}else{var d=a.URL||a.webkitURL,h=d.createObjectURL(e);i?i.location=h:location.href=h,i=null,setTimeout((function(){d.revokeObjectURL(h)}),4e4)}});a.saveAs=l.saveAs=l,e.exports=l})?r.apply(t,i):r)||(e.exports=o)},5587:function(e,t,n){e.exports=function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};t[a][0].call(u.exports,(function(e){return i(t[a][1][e]||e)}),u,u.exports,e,t,n,r)}return n[a].exports}for(var o=void 0,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,i,a,s,l,u,c=[],d=0,h=e.length,f=h,p="string"!==r.getTypeOf(e);d<e.length;)f=h-d,i=p?(t=e[d++],n=d<h?e[d++]:0,d<h?e[d++]:0):(t=e.charCodeAt(d++),n=d<h?e.charCodeAt(d++):0,d<h?e.charCodeAt(d++):0),a=t>>2,s=(3&t)<<4|n>>4,l=1<f?(15&n)<<2|i>>6:64,u=2<f?63&i:64,c.push(o.charAt(a)+o.charAt(s)+o.charAt(l)+o.charAt(u));return c.join("")},n.decode=function(e){var t,n,r,a,s,l,u=0,c=0,d="data:";if(e.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var h,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===o.charAt(64)&&f--,e.charAt(e.length-2)===o.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=i.uint8array?new Uint8Array(0|f):new Array(0|f);u<e.length;)t=o.indexOf(e.charAt(u++))<<2|(a=o.indexOf(e.charAt(u++)))>>4,n=(15&a)<<4|(s=o.indexOf(e.charAt(u++)))>>2,r=(3&s)<<6|(l=o.indexOf(e.charAt(u++))),h[c++]=t,64!==s&&(h[c++]=n),64!==l&&(h[c++]=r);return h}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var r=e("./external"),i=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function s(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}s.prototype={getContentWorker:function(){var e=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,n){return e.pipe(new o).pipe(new a("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var r=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var r=e("./utils"),i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,n,r){var o=i,a=r+n;e^=-1;for(var s=r;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}(0|t,e,e.length,0):function(e,t,n,r){var o=i,a=r+n;e^=-1;for(var s=r;s<a;s++)e=e>>>8^o[255&(e^t.charCodeAt(s))];return-1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var r=null;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),o=e("./utils"),a=e("./stream/GenericWorker"),s=r?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",o.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(s,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";function r(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r}function i(e,t,n,i,a,c){var d,h,f=e.file,p=e.compression,v=c!==s.utf8encode,g=o.transformTo("string",c(f.name)),m=o.transformTo("string",s.utf8encode(f.name)),y=f.comment,w=o.transformTo("string",c(y)),b=o.transformTo("string",s.utf8encode(y)),C=m.length!==f.name.length,S=b.length!==y.length,E="",k="",x="",T=f.dir,R=f.date,A={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(A.crc32=e.crc32,A.compressedSize=e.compressedSize,A.uncompressedSize=e.uncompressedSize);var _=0;t&&(_|=8),v||!C&&!S||(_|=2048);var O=0,D=0;T&&(O|=16),"UNIX"===a?(D=798,O|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(f.unixPermissions,T)):(D=20,O|=function(e){return 63&(e||0)}(f.dosPermissions)),d=R.getUTCHours(),d<<=6,d|=R.getUTCMinutes(),d<<=5,d|=R.getUTCSeconds()/2,h=R.getUTCFullYear()-1980,h<<=4,h|=R.getUTCMonth()+1,h<<=5,h|=R.getUTCDate(),C&&(k=r(1,1)+r(l(g),4)+m,E+="up"+r(k.length,2)+k),S&&(x=r(1,1)+r(l(w),4)+b,E+="uc"+r(x.length,2)+x);var N="";return N+="\n\0",N+=r(_,2),N+=p.magic,N+=r(d,2),N+=r(h,2),N+=r(A.crc32,4),N+=r(A.compressedSize,4),N+=r(A.uncompressedSize,4),N+=r(g.length,2),N+=r(E.length,2),{fileRecord:u.LOCAL_FILE_HEADER+N+g+E,dirRecord:u.CENTRAL_FILE_HEADER+r(D,2)+N+r(w.length,2)+"\0\0\0\0"+r(O,4)+r(i,4)+g+E+w}}var o=e("../utils"),a=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),u=e("../signature");function c(e,t,n,r){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(c,a),c.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,a.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},c.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=i(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},c.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=i(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:function(e){return u.DATA_DESCRIPTOR+r(e.crc32,4)+r(e.compressedSize,4)+r(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},c.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,i=function(e,t,n,i,a){var s=o.transformTo("string",a(i));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(e,2)+r(e,2)+r(t,4)+r(n,4)+r(s.length,2)+s}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},c.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},c.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},c.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},c.prototype.error=function(e){var t=this._sources;if(!a.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},c.prototype.lock=function(){a.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=c},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var r=e("../compressions"),i=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var o=new i(t.streamFiles,n,t.platform,t.encodeFileName),a=0;try{e.forEach((function(e,n){a++;var i=function(e,t){var n=e||t,i=r[n];if(!i)throw new Error(n+" is not a valid compression method !");return i}(n.options.compression,t.compression),s=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,u=n.date;n._compressWorker(i,s).withStreamInfo("file",{name:e,dir:l,date:u,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(o)})),o.entriesCount=a}catch(e){o.error(e)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./external"),o=e("./utf8"),a=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function u(e){return new i.Promise((function(t,n){var r=e.decompressed.getContentWorker().pipe(new s);r.on("error",(function(e){n(e)})).on("end",(function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var n=new a(t);return n.load(e),n})).then((function(e){var n=[i.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var o=0;o<r.length;o++)n.push(u(r[o]));return i.Promise.all(n)})).then((function(e){for(var i=e.shift(),o=i.files,a=0;a<o.length;a++){var s=o[a],l=s.fileNameStr,u=r.resolve(s.fileNameStr);n.file(u,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(n.file(u).unsafeOriginalName=l)}return i.zipComment.length&&(n.comment=i.zipComment),n}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../stream/GenericWorker");function o(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(o,i),o.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var r=e("readable-stream").Readable;function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on("data",(function(e,t){i.push(e)||i._helper.pause(),n&&n(t)})).on("error",(function(e){i.emit("error",e)})).on("end",(function(){i.push(null)}))}e("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";function r(e,t,n){var r,i=o.getTypeOf(t),s=o.extend(n||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=v(e)),s.createFolders&&(r=p(e))&&g.call(this,r,!0);var d="string"===i&&!1===s.binary&&!1===s.base64;n&&void 0!==n.binary||(s.binary=!d),(t instanceof u&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",i="string");var m=null;m=t instanceof u||t instanceof a?t:h.isNode&&h.isStream(t)?new f(e,t):o.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var y=new c(e,m,s);this.files[e]=y}var i=e("./utf8"),o=e("./utils"),a=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),u=e("./compressedObject"),c=e("./zipObject"),d=e("./generate"),h=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},v=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:l.createFolders,e=v(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function m(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach((function(n,r){e(n,r)&&t.push(r)})),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,n),this;if(m(e)){var i=e;return this.filter((function(e,t){return!t.dir&&i.test(e)}))}var o=this.files[this.root+e];return o&&!o.dir?o:null},folder:function(e){if(!e)return this;if(m(e))return this.filter((function(t,n){return n.dir&&e.test(t)}));var t=this.root+e,n=g.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter((function(t,n){return n.name.slice(0,e.length)===e})),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=o.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");o.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var r=n.comment||this.comment||"";t=d.generateWorker(this,n,r)}catch(e){(t=new a("error")).error(e)}return new s(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===t&&this.data[o+1]===n&&this.data[o+2]===r&&this.data[o+3]===i)return o-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&n===o[1]&&r===o[2]&&i===o[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var r=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,n){"use strict";var r=e("./Uint8ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var r=e("./ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../support"),o=e("./ArrayReader"),a=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new s(e):i.uint8array?new l(r.transformTo("uint8array",e)):new o(r.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK\x03\x04",n.CENTRAL_FILE_HEADER="PK\x01\x02",n.CENTRAL_DIRECTORY_END="PK\x05\x06",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../utils");function o(e){r.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(o,r),o.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../crc32");function o(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,r),o.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function o(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(o,i),o.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function o(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}r.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./ConvertWorker"),o=e("./GenericWorker"),a=e("../base64"),s=e("../support"),l=e("../external"),u=null;if(s.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function c(e,t){return new l.Promise((function(n,i){var o=[],s=e._internalType,l=e._outputType,u=e._mimeType;e.on("data",(function(e,n){o.push(e),t&&t(n)})).on("error",(function(e){o=[],i(e)})).on("end",(function(){try{var e=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return a.encode(t);default:return r.transformTo(e,t)}}(l,function(e,t){var n,r=0,i=null,o=0;for(n=0;n<t.length;n++)o+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(o),n=0;n<t.length;n++)i.set(t[n],r),r+=t[n].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,o),u);n(e)}catch(e){i(e)}o=[]})).resume()}))}function d(e,t,n){var a=t;switch(t){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=t,this._mimeType=n,r.checkSupport(a),this._worker=e.pipe(new i(a)),e.lock()}catch(e){this._worker=new o("error"),this._worker.error(e)}}d.prototype={accumulate:function(e){return c(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,(function(e){t.call(n,e.data,e.meta)})):this._worker.on(e,(function(){r.delay(t,arguments,n)})),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(r),n.blob=0===i.getBlob("application/zip").size}catch(e){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(e){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var r=e("./utils"),i=e("./support"),o=e("./nodejsUtils"),a=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function u(){a.call(this,"utf-8 decode"),this.leftOver=null}function c(){a.call(this,"utf-8 encode")}s[254]=s[254]=1,n.utf8encode=function(e){return i.nodebuffer?o.newBufferFrom(e,"utf-8"):function(e){var t,n,r,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),o=a=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),n<128?t[a++]=n:(n<2048?t[a++]=192|n>>>6:(n<65536?t[a++]=224|n>>>12:(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63),t[a++]=128|n>>>6&63),t[a++]=128|63&n);return t}(e)},n.utf8decode=function(e){return i.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,i,o,a=e.length,l=new Array(2*a);for(t=n=0;t<a;)if((i=e[t++])<128)l[n++]=i;else if(4<(o=s[i]))l[n++]=65533,t+=o-1;else{for(i&=2===o?31:3===o?15:7;1<o&&t<a;)i=i<<6|63&e[t++],o--;1<o?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),r.applyFromCharCode(l)}(e=r.transformTo(i.uint8array?"uint8array":"array",e))},r.inherits(u,a),u.prototype.processChunk=function(e){var t=r.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var o=t;(t=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),t.set(o,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var a=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}(t),l=t;a!==t.length&&(i.uint8array?(l=t.subarray(0,a),this.leftOver=t.subarray(a,t.length)):(l=t.slice(0,a),this.leftOver=t.slice(a,t.length))),this.push({data:n.utf8decode(l),meta:e.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=u,r.inherits(c,a),c.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";var r=e("./support"),i=e("./base64"),o=e("./nodejsUtils"),a=e("./external");function s(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(t,r){n.checkSupport("blob");try{return new Blob([t],{type:r})}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(t),i.getBlob(r)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(e,t,n){var r=[],i=0,o=e.length;if(o<=n)return String.fromCharCode.apply(null,e);for(;i<o;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,o)))):r.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,o)))),i+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(e){return!1}}()}};function c(e){var t=65536,r=n.getTypeOf(e),i=!0;if("uint8array"===r?i=u.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=u.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return u.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return u.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=c;var h={};h.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,o.allocBuffer(e.length))}},h.array={string:c,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(e)}},h.arraybuffer={string:function(e){return c(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return o.newBufferFrom(e)}},h.nodebuffer={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:s},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return h[r][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var i=t[r];"."===i||""===i&&0!==r&&r!==t.length-1||(".."===i?n.pop():n.push(i))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&o.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},n.delay=function(e,t,n){setImmediate((function(){e.apply(n||null,t||[])}))},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,o,s,u){return a.Promise.resolve(t).then((function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new a.Promise((function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)})):e})).then((function(t){var c=n.getTypeOf(t);return c?("arraybuffer"===c?t=n.transformTo("uint8array",t):"string"===c&&(u?t=i.decode(t):o&&!0!==s&&(t=function(e){return l(e,r.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):a.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),o=e("./signature"),a=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",n=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(0<r)this.isSignature(t,o.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),o=e("./compressedObject"),a=e("./crc32"),s=e("./utf8"),l=e("./compressions"),u=e("./support");function c(e,t){this.options=e,this.loadOptions=t}c.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,r,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(i)},handleUTF8:function(){var e=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var o=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";function r(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var i=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),a=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var o=!this._dataBinary;o&&!r&&(t=t.pipe(new a.Utf8EncodeWorker)),!o&&r&&(t=t.pipe(new a.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new i(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new a.Utf8EncodeWorker)),s.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new o(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<u.length;d++)r.prototype[u[d]]=c;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){"use strict";var n,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,a=new i(c),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),n=function(){s.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(c,0)};else{var l=new e.MessageChannel;l.port1.onmessage=c,n=function(){l.port2.postMessage(0)}}var u=[];function c(){var e,t;r=!0;for(var n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}r=!1}t.exports=function(e){1!==u.push(e)||r||n()}}).call(this,"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){"use strict";var r=e("immediate");function i(){}var o={},a=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&f(this,e)}function c(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r((function(){var r;try{r=t(n)}catch(r){return o.reject(e,r)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function i(t){n||(n=!0,o.resolve(e,t))}var a=p((function(){t(i,r)}));"error"===a.status&&r(a.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=u).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){throw n}))}))},u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(i);return this.state!==l?d(n,this.state===s?e:t,this.outcome):this.queue.push(new c(n,e,t)),n},c.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},c.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},c.prototype.callRejected=function(e){o.reject(this.promise,e)},c.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=p(h,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)f(e,r);else{e.state=s,e.outcome=t;for(var i=-1,a=e.queue.length;++i<a;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},u.resolve=function(e){return e instanceof this?e:o.resolve(new this(i),e)},u.reject=function(e){var t=new this(i);return o.reject(t,e)},u.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a=new Array(n),s=0,l=-1,u=new this(i);++l<n;)c(e[l],l);return u;function c(e,i){t.resolve(e).then((function(e){a[i]=e,++s!==n||r||(r=!0,o.resolve(u,a))}),(function(e){r||(r=!0,o.reject(u,e))}))}},u.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a,s=-1,l=new this(i);++s<n;)a=e[s],t.resolve(a).then((function(e){r||(r=!0,o.resolve(l,e))}),(function(e){r||(r=!0,o.reject(l,e))}));return l}},{immediate:36}],38:[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var r=e("./zlib/deflate"),i=e("./utils/common"),o=e("./utils/strings"),a=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString,u=0,c=-1,d=0,h=8;function f(e){if(!(this instanceof f))return new f(e);this.options=i.assign({level:c,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==u)throw new Error(a[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var p;if(p="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=r.deflateSetDictionary(this.strm,p))!==u)throw new Error(a[n]);this._dict_set=!0}}function p(e,t){var n=new f(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}f.prototype.push=function(e,t){var n,a,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(c),s.next_out=0,s.avail_out=c),1!==(n=r.deflate(s,a))&&n!==u)return this.onEnd(n),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==n);return 4===a?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===u):2!==a||(this.onEnd(u),!(s.avail_out=0))},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){e===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=f,n.deflate=p,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,p(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var r=e("./zlib/inflate"),i=e("./utils/common"),o=e("./utils/strings"),a=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),u=e("./zlib/gzheader"),c=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==a.Z_OK)throw new Error(s[n]);this.header=new u,r.inflateGetHeader(this.strm,this.header)}function h(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}d.prototype.push=function(e,t){var n,s,l,u,d,h,f=this.strm,p=this.options.chunkSize,v=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?f.input=o.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(p),f.next_out=0,f.avail_out=p),(n=r.inflate(f,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&v&&(h="string"==typeof v?o.string2buf(v):"[object ArrayBuffer]"===c.call(v)?new Uint8Array(v):v,n=r.inflateSetDictionary(this.strm,h)),n===a.Z_BUF_ERROR&&!0===g&&(n=a.Z_OK,g=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&n!==a.Z_STREAM_END&&(0!==f.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(f.output,f.next_out),u=f.next_out-l,d=o.buf2string(f.output,l),f.next_out=u,f.avail_out=p-u,u&&i.arraySet(f.output,f.output,l,u,0),this.onData(d)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(g=!0)}while((0<f.avail_in||0===f.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(f.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=d,n.inflate=h,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},n.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){var t,n,r,i,o,a;for(t=r=0,n=e.length;t<n;t++)r+=e[t].length;for(a=new Uint8Array(r),t=i=0,n=e.length;t<n;t++)o=e[t],a.set(o,i),i+=o.length;return a}},o={arraySet:function(e,t,n,r,i){for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(r)},{}],42:[function(e,t,n){"use strict";var r=e("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new r.Buf8(256),s=0;s<256;s++)a[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n}a[254]=a[254]=1,n.string2buf=function(e){var t,n,i,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),o=a=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?t[a++]=n:(n<2048?t[a++]=192|n>>>6:(n<65536?t[a++]=224|n>>>12:(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63),t[a++]=128|n>>>6&63),t[a++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,i,o,s=t||e.length,u=new Array(2*s);for(n=r=0;n<s;)if((i=e[n++])<128)u[r++]=i;else if(4<(o=a[i]))u[r++]=65533,n+=o-1;else{for(i&=2===o?31:3===o?15:7;1<o&&n<s;)i=i<<6|63&e[n++],o--;1<o?u[r++]=65533:i<65536?u[r++]=i:(i-=65536,u[r++]=55296|i>>10&1023,u[r++]=56320|1023&i)}return l(u,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+a[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==n;){for(n-=a=2e3<n?2e3:n;o=o+(i=i+t[r++]|0)|0,--a;);i%=65521,o%=65521}return i|o<<16|0}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,i){var o=r,a=i+n;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}},{}],46:[function(e,t,n){"use strict";var r,i=e("../utils/common"),o=e("./trees"),a=e("./adler32"),s=e("./crc32"),l=e("./messages"),u=0,c=4,d=0,h=-2,f=-1,p=4,v=2,g=8,m=9,y=286,w=30,b=19,C=2*y+1,S=15,E=3,k=258,x=k+E+1,T=42,R=113,A=1,_=2,O=3,D=4;function N(e,t){return e.msg=l[t],t}function P(e){return(e<<1)-(4<e?9:0)}function F(e){for(var t=e.length;0<=--t;)e[t]=0}function I(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function L(e,t){o._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,I(e.strm)}function M(e,t){e.pending_buf[e.pending++]=t}function G(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function B(e,t){var n,r,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-x?e.strstart-(e.w_size-x):0,u=e.window,c=e.w_mask,d=e.prev,h=e.strstart+k,f=u[o+a-1],p=u[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(n=t)+a]===p&&u[n+a-1]===f&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do{}while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<h);if(r=k-(h-o),o=h-k,a<r){if(e.match_start=t,s<=(a=r))break;f=u[o+a-1],p=u[o+a]}}}while((t=d[t&c])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function j(e){var t,n,r,o,l,u,c,d,h,f,p=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-x)){for(i.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=n=e.hash_size;r=e.head[--t],e.head[t]=p<=r?r-p:0,--n;);for(t=n=p;r=e.prev[--t],e.prev[t]=p<=r?r-p:0,--n;);o+=p}if(0===e.strm.avail_in)break;if(u=e.strm,c=e.window,d=e.strstart+e.lookahead,f=void 0,(h=o)<(f=u.avail_in)&&(f=h),n=0===f?0:(u.avail_in-=f,i.arraySet(c,u.input,u.next_in,f,d),1===u.state.wrap?u.adler=a(u.adler,c,f,d):2===u.state.wrap&&(u.adler=s(u.adler,c,f,d)),u.next_in+=f,u.total_in+=f,f),e.lookahead+=n,e.lookahead+e.insert>=E)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+E-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<E)););}while(e.lookahead<x&&0!==e.strm.avail_in)}function H(e,t){for(var n,r;;){if(e.lookahead<x){if(j(e),e.lookahead<x&&t===u)return A;if(0===e.lookahead)break}if(n=0,e.lookahead>=E&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-x&&(e.match_length=B(e,n)),e.match_length>=E)if(r=o._tr_tally(e,e.strstart-e.match_start,e.match_length-E),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=E){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(L(e,!1),0===e.strm.avail_out))return A}return e.insert=e.strstart<E-1?e.strstart:E-1,t===c?(L(e,!0),0===e.strm.avail_out?O:D):e.last_lit&&(L(e,!1),0===e.strm.avail_out)?A:_}function V(e,t){for(var n,r,i;;){if(e.lookahead<x){if(j(e),e.lookahead<x&&t===u)return A;if(0===e.lookahead)break}if(n=0,e.lookahead>=E&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=E-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-x&&(e.match_length=B(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===E&&4096<e.strstart-e.match_start)&&(e.match_length=E-1)),e.prev_length>=E&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-E,r=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-E),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=E-1,e.strstart++,r&&(L(e,!1),0===e.strm.avail_out))return A}else if(e.match_available){if((r=o._tr_tally(e,0,e.window[e.strstart-1]))&&L(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return A}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<E-1?e.strstart:E-1,t===c?(L(e,!0),0===e.strm.avail_out?O:D):e.last_lit&&(L(e,!1),0===e.strm.avail_out)?A:_}function W(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*C),this.dyn_dtree=new i.Buf16(2*(2*w+1)),this.bl_tree=new i.Buf16(2*(2*b+1)),F(this.dyn_ltree),F(this.dyn_dtree),F(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(S+1),this.heap=new i.Buf16(2*y+1),F(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*y+1),F(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function U(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=v,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?T:R,e.adler=2===t.wrap?0:1,t.last_flush=u,o._tr_init(t),d):N(e,h)}function K(e){var t=U(e);return t===d&&function(e){e.window_size=2*e.w_size,F(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=E-1,e.match_available=0,e.ins_h=0}(e.state),t}function q(e,t,n,r,o,a){if(!e)return h;var s=1;if(t===f&&(t=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),o<1||m<o||n!==g||r<8||15<r||t<0||9<t||a<0||p<a)return N(e,h);8===r&&(r=9);var l=new z;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+E-1)/E),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=n,K(e)}r=[new W(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(j(e),0===e.lookahead&&t===u)return A;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,L(e,!1),0===e.strm.avail_out))return A;if(e.strstart-e.block_start>=e.w_size-x&&(L(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===c?(L(e,!0),0===e.strm.avail_out?O:D):(e.strstart>e.block_start&&(L(e,!1),e.strm.avail_out),A)})),new W(4,4,8,4,H),new W(4,5,16,8,H),new W(4,6,32,32,H),new W(4,4,16,16,V),new W(8,16,32,32,V),new W(8,16,128,128,V),new W(8,32,128,256,V),new W(32,128,258,1024,V),new W(32,258,258,4096,V)],n.deflateInit=function(e,t){return q(e,t,g,15,8,0)},n.deflateInit2=q,n.deflateReset=K,n.deflateResetKeep=U,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?h:(e.state.gzhead=t,d):h},n.deflate=function(e,t){var n,i,a,l;if(!e||!e.state||5<t||t<0)return e?N(e,h):h;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&t!==c)return N(e,0===e.avail_out?-5:h);if(i.strm=e,n=i.last_flush,i.last_flush=t,i.status===T)if(2===i.wrap)e.adler=0,M(i,31),M(i,139),M(i,8),i.gzhead?(M(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),M(i,255&i.gzhead.time),M(i,i.gzhead.time>>8&255),M(i,i.gzhead.time>>16&255),M(i,i.gzhead.time>>24&255),M(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),M(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(M(i,255&i.gzhead.extra.length),M(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(M(i,0),M(i,0),M(i,0),M(i,0),M(i,0),M(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),M(i,3),i.status=R);else{var f=g+(i.w_bits-8<<4)<<8;f|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(f|=32),f+=31-f%31,i.status=R,G(i,f),0!==i.strstart&&(G(i,e.adler>>>16),G(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),I(e),a=i.pending,i.pending!==i.pending_buf_size));)M(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),I(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,M(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),I(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,M(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&I(e),i.pending+2<=i.pending_buf_size&&(M(i,255&e.adler),M(i,e.adler>>8&255),e.adler=0,i.status=R)):i.status=R),0!==i.pending){if(I(e),0===e.avail_out)return i.last_flush=-1,d}else if(0===e.avail_in&&P(t)<=P(n)&&t!==c)return N(e,-5);if(666===i.status&&0!==e.avail_in)return N(e,-5);if(0!==e.avail_in||0!==i.lookahead||t!==u&&666!==i.status){var p=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(j(e),0===e.lookahead)){if(t===u)return A;break}if(e.match_length=0,n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(L(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===c?(L(e,!0),0===e.strm.avail_out?O:D):e.last_lit&&(L(e,!1),0===e.strm.avail_out)?A:_}(i,t):3===i.strategy?function(e,t){for(var n,r,i,a,s=e.window;;){if(e.lookahead<=k){if(j(e),e.lookahead<=k&&t===u)return A;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=E&&0<e.strstart&&(r=s[i=e.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){a=e.strstart+k;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<a);e.match_length=k-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=E?(n=o._tr_tally(e,1,e.match_length-E),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(L(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===c?(L(e,!0),0===e.strm.avail_out?O:D):e.last_lit&&(L(e,!1),0===e.strm.avail_out)?A:_}(i,t):r[i.level].func(i,t);if(p!==O&&p!==D||(i.status=666),p===A||p===O)return 0===e.avail_out&&(i.last_flush=-1),d;if(p===_&&(1===t?o._tr_align(i):5!==t&&(o._tr_stored_block(i,0,0,!1),3===t&&(F(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),I(e),0===e.avail_out))return i.last_flush=-1,d}return t!==c?d:i.wrap<=0?1:(2===i.wrap?(M(i,255&e.adler),M(i,e.adler>>8&255),M(i,e.adler>>16&255),M(i,e.adler>>24&255),M(i,255&e.total_in),M(i,e.total_in>>8&255),M(i,e.total_in>>16&255),M(i,e.total_in>>24&255)):(G(i,e.adler>>>16),G(i,65535&e.adler)),I(e),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?d:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==T&&69!==t&&73!==t&&91!==t&&103!==t&&t!==R&&666!==t?N(e,h):(e.state=null,t===R?N(e,-3):d):h},n.deflateSetDictionary=function(e,t){var n,r,o,s,l,u,c,f,p=t.length;if(!e||!e.state)return h;if(2===(s=(n=e.state).wrap)||1===s&&n.status!==T||n.lookahead)return h;for(1===s&&(e.adler=a(e.adler,t,p,0)),n.wrap=0,p>=n.w_size&&(0===s&&(F(n.head),n.strstart=0,n.block_start=0,n.insert=0),f=new i.Buf8(n.w_size),i.arraySet(f,t,p-n.w_size,n.w_size,0),t=f,p=n.w_size),l=e.avail_in,u=e.next_in,c=e.input,e.avail_in=p,e.next_in=0,e.input=t,j(n);n.lookahead>=E;){for(r=n.strstart,o=n.lookahead-(E-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+E-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--o;);n.strstart=r,n.lookahead=E-1,j(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=E-1,n.match_available=0,e.next_in=u,e.input=c,e.avail_in=l,n.wrap=s,d},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,i,o,a,s,l,u,c,d,h,f,p,v,g,m,y,w,b,C,S,E,k,x,T;n=e.state,r=e.next_in,x=e.input,i=r+(e.avail_in-5),o=e.next_out,T=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=n.dmax,u=n.wsize,c=n.whave,d=n.wnext,h=n.window,f=n.hold,p=n.bits,v=n.lencode,g=n.distcode,m=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{p<15&&(f+=x[r++]<<p,p+=8,f+=x[r++]<<p,p+=8),w=v[f&m];t:for(;;){if(f>>>=b=w>>>24,p-=b,0===(b=w>>>16&255))T[o++]=65535&w;else{if(!(16&b)){if(0==(64&b)){w=v[(65535&w)+(f&(1<<b)-1)];continue t}if(32&b){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}C=65535&w,(b&=15)&&(p<b&&(f+=x[r++]<<p,p+=8),C+=f&(1<<b)-1,f>>>=b,p-=b),p<15&&(f+=x[r++]<<p,p+=8,f+=x[r++]<<p,p+=8),w=g[f&y];n:for(;;){if(f>>>=b=w>>>24,p-=b,!(16&(b=w>>>16&255))){if(0==(64&b)){w=g[(65535&w)+(f&(1<<b)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(S=65535&w,p<(b&=15)&&(f+=x[r++]<<p,(p+=8)<b&&(f+=x[r++]<<p,p+=8)),l<(S+=f&(1<<b)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=b,p-=b,(b=o-a)<S){if(c<(b=S-b)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(k=h,(E=0)===d){if(E+=u-b,b<C){for(C-=b;T[o++]=h[E++],--b;);E=o-S,k=T}}else if(d<b){if(E+=u+d-b,(b-=d)<C){for(C-=b;T[o++]=h[E++],--b;);if(E=0,d<C){for(C-=b=d;T[o++]=h[E++],--b;);E=o-S,k=T}}}else if(E+=d-b,b<C){for(C-=b;T[o++]=h[E++],--b;);E=o-S,k=T}for(;2<C;)T[o++]=k[E++],T[o++]=k[E++],T[o++]=k[E++],C-=3;C&&(T[o++]=k[E++],1<C&&(T[o++]=k[E++]))}else{for(E=o-S;T[o++]=T[E++],T[o++]=T[E++],T[o++]=T[E++],2<(C-=3););C&&(T[o++]=T[E++],1<C&&(T[o++]=T[E++]))}break}}break}}while(r<i&&o<s);r-=C=p>>3,f&=(1<<(p-=C<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=o<s?s-o+257:257-(o-s),n.hold=f,n.bits=p}},{}],49:[function(e,t,n){"use strict";var r=e("../utils/common"),i=e("./adler32"),o=e("./crc32"),a=e("./inffast"),s=e("./inftrees"),l=1,u=2,c=0,d=-2,h=1,f=852,p=592;function v(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function m(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=h,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(f),t.distcode=t.distdyn=new r.Buf32(p),t.sane=1,t.back=-1,c):d}function y(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,m(e)):d}function w(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?d:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,y(e))):d}function b(e,t){var n,r;return e?(r=new g,(e.state=r).window=null,(n=w(e,t))!==c&&(e.state=null),n):d}var C,S,E=!0;function k(e){if(E){var t;for(C=new r.Buf32(512),S=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(l,e.lens,0,288,C,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(u,e.lens,0,32,S,0,e.work,{bits:5}),E=!1}e.lencode=C,e.lenbits=9,e.distcode=S,e.distbits=5}function x(e,t,n,i){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new r.Buf8(a.wsize)),i>=a.wsize?(r.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(i<(o=a.wsize-a.wnext)&&(o=i),r.arraySet(a.window,t,n-i,o,a.wnext),(i-=o)?(r.arraySet(a.window,t,n-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}n.inflateReset=y,n.inflateReset2=w,n.inflateResetKeep=m,n.inflateInit=function(e){return b(e,15)},n.inflateInit2=b,n.inflate=function(e,t){var n,f,p,g,m,y,w,b,C,S,E,T,R,A,_,O,D,N,P,F,I,L,M,G,B=0,j=new r.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return d;12===(n=e.state).mode&&(n.mode=13),m=e.next_out,p=e.output,w=e.avail_out,g=e.next_in,f=e.input,y=e.avail_in,b=n.hold,C=n.bits,S=y,E=w,L=c;e:for(;;)switch(n.mode){case h:if(0===n.wrap){n.mode=13;break}for(;C<16;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}if(2&n.wrap&&35615===b){j[n.check=0]=255&b,j[1]=b>>>8&255,n.check=o(n.check,j,2,0),C=b=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&b)<<8)+(b>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&b)){e.msg="unknown compression method",n.mode=30;break}if(C-=4,I=8+(15&(b>>>=4)),0===n.wbits)n.wbits=I;else if(I>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<I,e.adler=n.check=1,n.mode=512&b?10:12,C=b=0;break;case 2:for(;C<16;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}if(n.flags=b,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=b>>8&1),512&n.flags&&(j[0]=255&b,j[1]=b>>>8&255,n.check=o(n.check,j,2,0)),C=b=0,n.mode=3;case 3:for(;C<32;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}n.head&&(n.head.time=b),512&n.flags&&(j[0]=255&b,j[1]=b>>>8&255,j[2]=b>>>16&255,j[3]=b>>>24&255,n.check=o(n.check,j,4,0)),C=b=0,n.mode=4;case 4:for(;C<16;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}n.head&&(n.head.xflags=255&b,n.head.os=b>>8),512&n.flags&&(j[0]=255&b,j[1]=b>>>8&255,n.check=o(n.check,j,2,0)),C=b=0,n.mode=5;case 5:if(1024&n.flags){for(;C<16;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}n.length=b,n.head&&(n.head.extra_len=b),512&n.flags&&(j[0]=255&b,j[1]=b>>>8&255,n.check=o(n.check,j,2,0)),C=b=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(y<(T=n.length)&&(T=y),T&&(n.head&&(I=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,f,g,T,I)),512&n.flags&&(n.check=o(n.check,f,T,g)),y-=T,g+=T,n.length-=T),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===y)break e;for(T=0;I=f[g+T++],n.head&&I&&n.length<65536&&(n.head.name+=String.fromCharCode(I)),I&&T<y;);if(512&n.flags&&(n.check=o(n.check,f,T,g)),y-=T,g+=T,I)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===y)break e;for(T=0;I=f[g+T++],n.head&&I&&n.length<65536&&(n.head.comment+=String.fromCharCode(I)),I&&T<y;);if(512&n.flags&&(n.check=o(n.check,f,T,g)),y-=T,g+=T,I)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;C<16;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}if(b!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}C=b=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;C<32;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}e.adler=n.check=v(b),C=b=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=m,e.avail_out=w,e.next_in=g,e.avail_in=y,n.hold=b,n.bits=C,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){b>>>=7&C,C-=7&C,n.mode=27;break}for(;C<3;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}switch(n.last=1&b,C-=1,3&(b>>>=1)){case 0:n.mode=14;break;case 1:if(k(n),n.mode=20,6!==t)break;b>>>=2,C-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}b>>>=2,C-=2;break;case 14:for(b>>>=7&C,C-=7&C;C<32;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}if((65535&b)!=(b>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&b,C=b=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(T=n.length){if(y<T&&(T=y),w<T&&(T=w),0===T)break e;r.arraySet(p,f,g,T,m),y-=T,g+=T,w-=T,m+=T,n.length-=T;break}n.mode=12;break;case 17:for(;C<14;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}if(n.nlen=257+(31&b),b>>>=5,C-=5,n.ndist=1+(31&b),b>>>=5,C-=5,n.ncode=4+(15&b),b>>>=4,C-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;C<3;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}n.lens[H[n.have++]]=7&b,b>>>=3,C-=3}for(;n.have<19;)n.lens[H[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,M={bits:n.lenbits},L=s(0,n.lens,0,19,n.lencode,0,n.work,M),n.lenbits=M.bits,L){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;O=(B=n.lencode[b&(1<<n.lenbits)-1])>>>16&255,D=65535&B,!((_=B>>>24)<=C);){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}if(D<16)b>>>=_,C-=_,n.lens[n.have++]=D;else{if(16===D){for(G=_+2;C<G;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}if(b>>>=_,C-=_,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}I=n.lens[n.have-1],T=3+(3&b),b>>>=2,C-=2}else if(17===D){for(G=_+3;C<G;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}C-=_,I=0,T=3+(7&(b>>>=_)),b>>>=3,C-=3}else{for(G=_+7;C<G;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}C-=_,I=0,T=11+(127&(b>>>=_)),b>>>=7,C-=7}if(n.have+T>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;T--;)n.lens[n.have++]=I}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,M={bits:n.lenbits},L=s(l,n.lens,0,n.nlen,n.lencode,0,n.work,M),n.lenbits=M.bits,L){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,M={bits:n.distbits},L=s(u,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,M),n.distbits=M.bits,L){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=y&&258<=w){e.next_out=m,e.avail_out=w,e.next_in=g,e.avail_in=y,n.hold=b,n.bits=C,a(e,E),m=e.next_out,p=e.output,w=e.avail_out,g=e.next_in,f=e.input,y=e.avail_in,b=n.hold,C=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;O=(B=n.lencode[b&(1<<n.lenbits)-1])>>>16&255,D=65535&B,!((_=B>>>24)<=C);){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}if(O&&0==(240&O)){for(N=_,P=O,F=D;O=(B=n.lencode[F+((b&(1<<N+P)-1)>>N)])>>>16&255,D=65535&B,!(N+(_=B>>>24)<=C);){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}b>>>=N,C-=N,n.back+=N}if(b>>>=_,C-=_,n.back+=_,n.length=D,0===O){n.mode=26;break}if(32&O){n.back=-1,n.mode=12;break}if(64&O){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&O,n.mode=22;case 22:if(n.extra){for(G=n.extra;C<G;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}n.length+=b&(1<<n.extra)-1,b>>>=n.extra,C-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;O=(B=n.distcode[b&(1<<n.distbits)-1])>>>16&255,D=65535&B,!((_=B>>>24)<=C);){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}if(0==(240&O)){for(N=_,P=O,F=D;O=(B=n.distcode[F+((b&(1<<N+P)-1)>>N)])>>>16&255,D=65535&B,!(N+(_=B>>>24)<=C);){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}b>>>=N,C-=N,n.back+=N}if(b>>>=_,C-=_,n.back+=_,64&O){e.msg="invalid distance code",n.mode=30;break}n.offset=D,n.extra=15&O,n.mode=24;case 24:if(n.extra){for(G=n.extra;C<G;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}n.offset+=b&(1<<n.extra)-1,b>>>=n.extra,C-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===w)break e;if(T=E-w,n.offset>T){if((T=n.offset-T)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}R=T>n.wnext?(T-=n.wnext,n.wsize-T):n.wnext-T,T>n.length&&(T=n.length),A=n.window}else A=p,R=m-n.offset,T=n.length;for(w<T&&(T=w),w-=T,n.length-=T;p[m++]=A[R++],--T;);0===n.length&&(n.mode=21);break;case 26:if(0===w)break e;p[m++]=n.length,w--,n.mode=21;break;case 27:if(n.wrap){for(;C<32;){if(0===y)break e;y--,b|=f[g++]<<C,C+=8}if(E-=w,e.total_out+=E,n.total+=E,E&&(e.adler=n.check=n.flags?o(n.check,p,E,m-E):i(n.check,p,E,m-E)),E=w,(n.flags?b:v(b))!==n.check){e.msg="incorrect data check",n.mode=30;break}C=b=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;C<32;){if(0===y)break e;y--,b+=f[g++]<<C,C+=8}if(b!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}C=b=0}n.mode=29;case 29:L=1;break e;case 30:L=-3;break e;case 31:return-4;default:return d}return e.next_out=m,e.avail_out=w,e.next_in=g,e.avail_in=y,n.hold=b,n.bits=C,(n.wsize||E!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&x(e,e.output,e.next_out,E-e.avail_out)?(n.mode=31,-4):(S-=e.avail_in,E-=e.avail_out,e.total_in+=S,e.total_out+=E,n.total+=E,n.wrap&&E&&(e.adler=n.check=n.flags?o(n.check,p,E,e.next_out-E):i(n.check,p,E,e.next_out-E)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==S&&0===E||4===t)&&L===c&&(L=-5),L)},n.inflateEnd=function(e){if(!e||!e.state)return d;var t=e.state;return t.window&&(t.window=null),e.state=null,c},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?d:((n.head=t).done=!1,c):d},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?d:11===n.mode&&i(1,t,r,0)!==n.check?-3:x(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,c):d},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var r=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,u,c,d,h){var f,p,v,g,m,y,w,b,C,S=h.bits,E=0,k=0,x=0,T=0,R=0,A=0,_=0,O=0,D=0,N=0,P=null,F=0,I=new r.Buf16(16),L=new r.Buf16(16),M=null,G=0;for(E=0;E<=15;E++)I[E]=0;for(k=0;k<l;k++)I[t[n+k]]++;for(R=S,T=15;1<=T&&0===I[T];T--);if(T<R&&(R=T),0===T)return u[c++]=20971520,u[c++]=20971520,h.bits=1,0;for(x=1;x<T&&0===I[x];x++);for(R<x&&(R=x),E=O=1;E<=15;E++)if(O<<=1,(O-=I[E])<0)return-1;if(0<O&&(0===e||1!==T))return-1;for(L[1]=0,E=1;E<15;E++)L[E+1]=L[E]+I[E];for(k=0;k<l;k++)0!==t[n+k]&&(d[L[t[n+k]]++]=k);if(y=0===e?(P=M=d,19):1===e?(P=i,F-=257,M=o,G-=257,256):(P=a,M=s,-1),E=x,m=c,_=k=N=0,v=-1,g=(D=1<<(A=R))-1,1===e&&852<D||2===e&&592<D)return 1;for(;;){for(w=E-_,C=d[k]<y?(b=0,d[k]):d[k]>y?(b=M[G+d[k]],P[F+d[k]]):(b=96,0),f=1<<E-_,x=p=1<<A;u[m+(N>>_)+(p-=f)]=w<<24|b<<16|C|0,0!==p;);for(f=1<<E-1;N&f;)f>>=1;if(0!==f?(N&=f-1,N+=f):N=0,k++,0==--I[E]){if(E===T)break;E=t[n+d[k]]}if(R<E&&(N&g)!==v){for(0===_&&(_=R),m+=x,O=1<<(A=E-_);A+_<T&&!((O-=I[A+_])<=0);)A++,O<<=1;if(D+=1<<A,1===e&&852<D||2===e&&592<D)return 1;u[v=N&g]=R<<24|A<<16|m-c|0}}return 0!==N&&(u[m+N]=E-_<<24|64<<16|0),h.bits=R,0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var r=e("../utils/common"),i=0,o=1;function a(e){for(var t=e.length;0<=--t;)e[t]=0}var s=0,l=29,u=256,c=u+1+l,d=30,h=19,f=2*c+1,p=15,v=16,g=7,m=256,y=16,w=17,b=18,C=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],x=new Array(2*(c+2));a(x);var T=new Array(2*d);a(T);var R=new Array(512);a(R);var A=new Array(256);a(A);var _=new Array(l);a(_);var O,D,N,P=new Array(d);function F(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function I(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function L(e){return e<256?R[e]:R[256+(e>>>7)]}function M(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function G(e,t,n){e.bi_valid>v-n?(e.bi_buf|=t<<e.bi_valid&65535,M(e,e.bi_buf),e.bi_buf=t>>v-e.bi_valid,e.bi_valid+=n-v):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function B(e,t,n){G(e,n[2*t],n[2*t+1])}function j(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function H(e,t,n){var r,i,o=new Array(p+1),a=0;for(r=1;r<=p;r++)o[r]=a=a+n[r-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=j(o[s]++,s))}}function V(e){var t;for(t=0;t<c;t++)e.dyn_ltree[2*t]=0;for(t=0;t<d;t++)e.dyn_dtree[2*t]=0;for(t=0;t<h;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*m]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function W(e){8<e.bi_valid?M(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function z(e,t,n,r){var i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]}function U(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&z(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!z(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function K(e,t,n){var r,i,o,a,s=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===r?B(e,i,t):(B(e,(o=A[i])+u+1,t),0!==(a=C[o])&&G(e,i-=_[o],a),B(e,o=L(--r),n),0!==(a=S[o])&&G(e,r-=P[o],a)),s<e.last_lit;);B(e,m,t)}function q(e,t){var n,r,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=f,n=0;n<l;n++)0!==o[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=u,n=e.heap_len>>1;1<=n;n--)U(e,o,n);for(i=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],U(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*i]=o[2*n]+o[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=i,e.heap[1]=i++,U(e,o,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,o,a,s,l=t.dyn_tree,u=t.max_code,c=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,v=t.stat_desc.extra_base,g=t.stat_desc.max_length,m=0;for(o=0;o<=p;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<f;n++)g<(o=l[2*l[2*(r=e.heap[n])+1]+1]+1)&&(o=g,m++),l[2*r+1]=o,u<r||(e.bl_count[o]++,a=0,v<=r&&(a=h[r-v]),s=l[2*r],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(c[2*r+1]+a)));if(0!==m){do{for(o=g-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[g]--,m-=2}while(0<m);for(o=g;0!==o;o--)for(r=e.bl_count[o];0!==r;)u<(i=e.heap[--n])||(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),r--)}}(e,t),H(o,u,e.bl_count)}function X(e,t,n){var r,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=t[2*(r+1)+1],++s<l&&i===a||(s<u?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*y]++):s<=10?e.bl_tree[2*w]++:e.bl_tree[2*b]++,o=i,u=(s=0)===a?(l=138,3):i===a?(l=6,3):(l=7,4))}function Y(e,t,n){var r,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),r=0;r<=n;r++)if(i=a,a=t[2*(r+1)+1],!(++s<l&&i===a)){if(s<u)for(;B(e,i,e.bl_tree),0!=--s;);else 0!==i?(i!==o&&(B(e,i,e.bl_tree),s--),B(e,y,e.bl_tree),G(e,s-3,2)):s<=10?(B(e,w,e.bl_tree),G(e,s-3,3)):(B(e,b,e.bl_tree),G(e,s-11,7));o=i,u=(s=0)===a?(l=138,3):i===a?(l=6,3):(l=7,4)}}a(P);var Q=!1;function Z(e,t,n,i){G(e,(s<<1)+(i?1:0),3),function(e,t,n,i){W(e),i&&(M(e,n),M(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}n._tr_init=function(e){Q||(function(){var e,t,n,r,i,o=new Array(p+1);for(r=n=0;r<l-1;r++)for(_[r]=n,e=0;e<1<<C[r];e++)A[n++]=r;for(A[n-1]=r,r=i=0;r<16;r++)for(P[r]=i,e=0;e<1<<S[r];e++)R[i++]=r;for(i>>=7;r<d;r++)for(P[r]=i<<7,e=0;e<1<<S[r]-7;e++)R[256+i++]=r;for(t=0;t<=p;t++)o[t]=0;for(e=0;e<=143;)x[2*e+1]=8,e++,o[8]++;for(;e<=255;)x[2*e+1]=9,e++,o[9]++;for(;e<=279;)x[2*e+1]=7,e++,o[7]++;for(;e<=287;)x[2*e+1]=8,e++,o[8]++;for(H(x,c+1,o),e=0;e<d;e++)T[2*e+1]=5,T[2*e]=j(e,5);O=new F(x,C,u+1,c,p),D=new F(T,S,0,d,p),N=new F(new Array(0),E,0,h,g)}(),Q=!0),e.l_desc=new I(e.dyn_ltree,O),e.d_desc=new I(e.dyn_dtree,D),e.bl_desc=new I(e.bl_tree,N),e.bi_buf=0,e.bi_valid=0,V(e)},n._tr_stored_block=Z,n._tr_flush_block=function(e,t,n,r){var a,s,l=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return i;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return o;for(t=32;t<u;t++)if(0!==e.dyn_ltree[2*t])return o;return i}(e)),q(e,e.l_desc),q(e,e.d_desc),l=function(e){var t;for(X(e,e.dyn_ltree,e.l_desc.max_code),X(e,e.dyn_dtree,e.d_desc.max_code),q(e,e.bl_desc),t=h-1;3<=t&&0===e.bl_tree[2*k[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),a=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=a&&(a=s)):a=s=n+5,n+4<=a&&-1!==t?Z(e,t,n,r):4===e.strategy||s===a?(G(e,2+(r?1:0),3),K(e,x,T)):(G(e,4+(r?1:0),3),function(e,t,n,r){var i;for(G(e,t-257,5),G(e,n-1,5),G(e,r-4,4),i=0;i<r;i++)G(e,e.bl_tree[2*k[i]+1],3);Y(e,e.dyn_ltree,t-1),Y(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),K(e,e.dyn_ltree,e.dyn_dtree)),V(e),r&&W(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(A[n]+u+1)]++,e.dyn_dtree[2*L(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){G(e,2,3),B(e,m,x),function(e){16===e.bi_valid?(M(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(e,t){"use strict";if(!e.setImmediate){var n,r,i,o,a=1,s={},l=!1,u=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,n="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick((function(){h(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(o="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",f,!1):e.attachEvent("onmessage",f),function(t){e.postMessage(o+t,"*")}):e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){h(e.data)},function(e){i.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(r=u.documentElement,function(e){var t=u.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):function(e){setTimeout(h,0,e)},c.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var i={callback:e,args:t};return s[a]=i,n(a),a++},c.clearImmediate=d}function d(e){delete s[e]}function h(e){if(l)setTimeout(h,0,e);else{var n=s[e];if(n){l=!0;try{!function(e){var n=e.callback,r=e.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(t,r)}}(n)}finally{d(e),l=!1}}}}function f(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&h(+t.data.slice(o.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},908:function(e,t,n){var r=n(8136)(n(7009),"DataView");e.exports=r},9676:function(e,t,n){var r=n(5403),i=n(2747),o=n(6037),a=n(4154),s=n(7728);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,e.exports=l},8384:function(e,t,n){var r=n(3894),i=n(8699),o=n(4957),a=n(7184),s=n(7109);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,e.exports=l},5797:function(e,t,n){var r=n(8136)(n(7009),"Map");e.exports=r},8059:function(e,t,n){var r=n(4086),i=n(9255),o=n(9186),a=n(3423),s=n(3739);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,e.exports=l},8319:function(e,t,n){var r=n(8136)(n(7009),"Promise");e.exports=r},3924:function(e,t,n){var r=n(8136)(n(7009),"Set");e.exports=r},692:function(e,t,n){var r=n(8059),i=n(5774),o=n(1596);function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=i,a.prototype.has=o,e.exports=a},2854:function(e,t,n){var r=n(8384),i=n(511),o=n(835),a=n(707),s=n(8832),l=n(5077);function u(e){var t=this.__data__=new r(e);this.size=t.size}u.prototype.clear=i,u.prototype.delete=o,u.prototype.get=a,u.prototype.has=s,u.prototype.set=l,e.exports=u},7197:function(e,t,n){var r=n(7009).Symbol;e.exports=r},6219:function(e,t,n){var r=n(7009).Uint8Array;e.exports=r},7091:function(e,t,n){var r=n(8136)(n(7009),"WeakMap");e.exports=r},3665:function(e){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},4550:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},4903:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}},9055:function(e,t,n){var r=n(4842);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},2683:function(e){e.exports=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},7538:function(e,t,n){var r=n(6478),i=n(4963),o=n(3629),a=n(5174),s=n(6800),l=n(9102),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),c=!n&&i(e),d=!n&&!c&&a(e),h=!n&&!c&&!d&&l(e),f=n||c||d||h,p=f?r(e.length,String):[],v=p.length;for(var g in e)!t&&!u.call(e,g)||f&&("length"==g||d&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,v))||p.push(g);return p}},8950:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},1705:function(e){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},2095:function(e){e.exports=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}},7897:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},8463:function(e,t,n){var r=n(2526),i=n(9231),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var a=e[t];o.call(e,t)&&i(a,n)&&(void 0!==n||t in e)||r(e,t,n)}},7112:function(e,t,n){var r=n(9231);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},1855:function(e,t,n){var r=n(4503),i=n(2742);e.exports=function(e,t){return e&&r(t,i(t),e)}},5076:function(e,t,n){var r=n(4503),i=n(3961);e.exports=function(e,t){return e&&r(t,i(t),e)}},2526:function(e,t,n){var r=n(8528);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},2050:function(e,t,n){var r=n(6181);e.exports=function(e,t){for(var n=-1,i=t.length,o=Array(i),a=null==e;++n<i;)o[n]=a?void 0:r(e,t[n]);return o}},1905:function(e,t,n){var r=n(2854),i=n(4550),o=n(8463),a=n(1855),s=n(5076),l=n(4523),u=n(291),c=n(2455),d=n(7636),h=n(8248),f=n(5341),p=n(8383),v=n(9243),g=n(9759),m=n(548),y=n(3629),w=n(5174),b=n(103),C=n(8092),S=n(6995),E=n(2742),k=n(3961),x="[object Arguments]",T="[object Function]",R="[object Object]",A={};A[x]=A["[object Array]"]=A["[object ArrayBuffer]"]=A["[object DataView]"]=A["[object Boolean]"]=A["[object Date]"]=A["[object Float32Array]"]=A["[object Float64Array]"]=A["[object Int8Array]"]=A["[object Int16Array]"]=A["[object Int32Array]"]=A["[object Map]"]=A["[object Number]"]=A[R]=A["[object RegExp]"]=A["[object Set]"]=A["[object String]"]=A["[object Symbol]"]=A["[object Uint8Array]"]=A["[object Uint8ClampedArray]"]=A["[object Uint16Array]"]=A["[object Uint32Array]"]=!0,A["[object Error]"]=A[T]=A["[object WeakMap]"]=!1,e.exports=function e(t,n,_,O,D,N){var P,F=1&n,I=2&n,L=4&n;if(_&&(P=D?_(t,O,D,N):_(t)),void 0!==P)return P;if(!C(t))return t;var M=y(t);if(M){if(P=v(t),!F)return u(t,P)}else{var G=p(t),B=G==T||"[object GeneratorFunction]"==G;if(w(t))return l(t,F);if(G==R||G==x||B&&!D){if(P=I||B?{}:m(t),!F)return I?d(t,s(P,t)):c(t,a(P,t))}else{if(!A[G])return D?t:{};P=g(t,G,F)}}N||(N=new r);var j=N.get(t);if(j)return j;N.set(t,P),S(t)?t.forEach((function(r){P.add(e(r,n,_,r,t,N))})):b(t)&&t.forEach((function(r,i){P.set(i,e(r,n,_,i,t,N))}));var H=M?void 0:(L?I?f:h:I?k:E)(t);return i(H||t,(function(r,i){H&&(r=t[i=r]),o(P,i,e(r,n,_,i,t,N))})),P}},5763:function(e,t,n){var r=n(8092),i=Object.create,o=function(){function e(){}return function(t){if(!r(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=o},1468:function(e,t,n){var r=n(692),i=n(9055),o=n(2683),a=n(8950),s=n(6194),l=n(75);e.exports=function(e,t,n,u){var c=-1,d=i,h=!0,f=e.length,p=[],v=t.length;if(!f)return p;n&&(t=a(t,s(n))),u?(d=o,h=!1):t.length>=200&&(d=l,h=!1,t=new r(t));e:for(;++c<f;){var g=e[c],m=null==n?g:n(g);if(g=u||0!==g?g:0,h&&m===m){for(var y=v;y--;)if(t[y]===m)continue e;p.push(g)}else d(t,m,u)||p.push(g)}return p}},7927:function(e,t,n){var r=n(5358),i=n(7056)(r);e.exports=i},3079:function(e,t,n){var r=n(152);e.exports=function(e,t,n){for(var i=-1,o=e.length;++i<o;){var a=e[i],s=t(a);if(null!=s&&(void 0===l?s===s&&!r(s):n(s,l)))var l=s,u=a}return u}},2045:function(e){e.exports=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},5182:function(e,t,n){var r=n(1705),i=n(3529);e.exports=function e(t,n,o,a,s){var l=-1,u=t.length;for(o||(o=i),s||(s=[]);++l<u;){var c=t[l];n>0&&o(c)?n>1?e(c,n-1,o,a,s):r(s,c):a||(s[s.length]=c)}return s}},5099:function(e,t,n){var r=n(372)();e.exports=r},5358:function(e,t,n){var r=n(5099),i=n(2742);e.exports=function(e,t){return e&&r(e,t,i)}},8667:function(e,t,n){var r=n(3082),i=n(9793);e.exports=function(e,t){for(var n=0,o=(t=r(t,e)).length;null!=e&&n<o;)e=e[i(t[n++])];return n&&n==o?e:void 0}},1986:function(e,t,n){var r=n(1705),i=n(3629);e.exports=function(e,t,n){var o=t(e);return i(e)?o:r(o,n(e))}},9066:function(e,t,n){var r=n(7197),i=n(1587),o=n(3581),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},1954:function(e){e.exports=function(e,t){return e>t}},529:function(e){e.exports=function(e,t){return null!=e&&t in Object(e)}},4842:function(e,t,n){var r=n(2045),i=n(505),o=n(7167);e.exports=function(e,t,n){return t===t?o(e,t,n):r(e,i,n)}},4032:function(e){e.exports=function(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}},5188:function(e,t,n){var r=n(692),i=n(9055),o=n(2683),a=n(8950),s=n(6194),l=n(75),u=Math.min;e.exports=function(e,t,n){for(var c=n?o:i,d=e[0].length,h=e.length,f=h,p=Array(h),v=1/0,g=[];f--;){var m=e[f];f&&t&&(m=a(m,s(t))),v=u(m.length,v),p[f]=!n&&(t||d>=120&&m.length>=120)?new r(f&&m):void 0}m=e[0];var y=-1,w=p[0];e:for(;++y<d&&g.length<v;){var b=m[y],C=t?t(b):b;if(b=n||0!==b?b:0,!(w?l(w,C):c(g,C,n))){for(f=h;--f;){var S=p[f];if(!(S?l(S,C):c(e[f],C,n)))continue e}w&&w.push(C),g.push(b)}}return g}},4906:function(e,t,n){var r=n(9066),i=n(3141);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},1848:function(e,t,n){var r=n(3355),i=n(3141);e.exports=function e(t,n,o,a,s){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!==t&&n!==n:r(t,n,o,a,e,s))}},3355:function(e,t,n){var r=n(2854),i=n(5305),o=n(2206),a=n(8078),s=n(8383),l=n(3629),u=n(5174),c=n(9102),d="[object Arguments]",h="[object Array]",f="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,v,g,m){var y=l(e),w=l(t),b=y?h:s(e),C=w?h:s(t),S=(b=b==d?f:b)==f,E=(C=C==d?f:C)==f,k=b==C;if(k&&u(e)){if(!u(t))return!1;y=!0,S=!1}if(k&&!S)return m||(m=new r),y||c(e)?i(e,t,n,v,g,m):o(e,t,b,n,v,g,m);if(!(1&n)){var x=S&&p.call(e,"__wrapped__"),T=E&&p.call(t,"__wrapped__");if(x||T){var R=x?e.value():e,A=T?t.value():t;return m||(m=new r),g(R,A,n,v,m)}}return!!k&&(m||(m=new r),a(e,t,n,v,g,m))}},3085:function(e,t,n){var r=n(8383),i=n(3141);e.exports=function(e){return i(e)&&"[object Map]"==r(e)}},8856:function(e,t,n){var r=n(2854),i=n(1848);e.exports=function(e,t,n,o){var a=n.length,s=a,l=!o;if(null==e)return!s;for(e=Object(e);a--;){var u=n[a];if(l&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++a<s;){var c=(u=n[a])[0],d=e[c],h=u[1];if(l&&u[2]){if(void 0===d&&!(c in e))return!1}else{var f=new r;if(o)var p=o(d,h,c,e,t,f);if(!(void 0===p?i(h,d,3,o,f):p))return!1}}return!0}},505:function(e){e.exports=function(e){return e!==e}},6703:function(e,t,n){var r=n(4786),i=n(257),o=n(8092),a=n(7907),s=/^\[object .+?Constructor\]$/,l=Function.prototype,u=Object.prototype,c=l.toString,d=u.hasOwnProperty,h=RegExp("^"+c.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?h:s).test(a(e))}},8680:function(e,t,n){var r=n(8383),i=n(3141);e.exports=function(e){return i(e)&&"[object Set]"==r(e)}},8150:function(e,t,n){var r=n(9066),i=n(4635),o=n(3141),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!a[r(e)]}},6025:function(e,t,n){var r=n(7080),i=n(4322),o=n(2100),a=n(3629),s=n(38);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?a(e)?i(e[0],e[1]):r(e):s(e)}},3654:function(e,t,n){var r=n(2936),i=n(8836),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},8664:function(e,t,n){var r=n(8092),i=n(2936),o=n(4221),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=i(e),n=[];for(var s in e)("constructor"!=s||!t&&a.call(e,s))&&n.push(s);return n}},3849:function(e,t,n){var r=n(7927),i=n(1473);e.exports=function(e,t){var n=-1,o=i(e)?Array(e.length):[];return r(e,(function(e,r,i){o[++n]=t(e,r,i)})),o}},7080:function(e,t,n){var r=n(8856),i=n(9091),o=n(284);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},4322:function(e,t,n){var r=n(1848),i=n(6181),o=n(5658),a=n(5823),s=n(5072),l=n(284),u=n(9793);e.exports=function(e,t){return a(e)&&s(t)?l(u(e),t):function(n){var a=i(n,e);return void 0===a&&a===t?o(n,e):r(t,a,3)}}},3226:function(e,t,n){var r=n(8950),i=n(8667),o=n(6025),a=n(3849),s=n(9179),l=n(6194),u=n(4480),c=n(2100),d=n(3629);e.exports=function(e,t,n){t=t.length?r(t,(function(e){return d(e)?function(t){return i(t,1===e.length?e[0]:e)}:e})):[c];var h=-1;t=r(t,l(o));var f=a(e,(function(e,n,i){return{criteria:r(t,(function(t){return t(e)})),index:++h,value:e}}));return s(f,(function(e,t){return u(e,t,n)}))}},9586:function(e){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},4084:function(e,t,n){var r=n(8667);e.exports=function(e){return function(t){return r(t,e)}}},2664:function(e,t,n){var r=n(8950),i=n(4842),o=n(4032),a=n(6194),s=n(291),l=Array.prototype.splice;e.exports=function(e,t,n,u){var c=u?o:i,d=-1,h=t.length,f=e;for(e===t&&(t=s(t)),n&&(f=r(e,a(n)));++d<h;)for(var p=0,v=t[d],g=n?n(v):v;(p=c(f,g,p,u))>-1;)f!==e&&l.call(f,p,1),l.call(e,p,1);return e}},7125:function(e,t,n){var r=n(6555),i=n(6800),o=Array.prototype.splice;e.exports=function(e,t){for(var n=e?t.length:0,a=n-1;n--;){var s=t[n];if(n==a||s!==l){var l=s;i(s)?o.call(e,s,1):r(e,s)}}return e}},750:function(e){e.exports=function(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}},8794:function(e,t,n){var r=n(2100),i=n(4262),o=n(9156);e.exports=function(e,t){return o(i(e,t,r),e+"")}},7532:function(e,t,n){var r=n(1547),i=n(8528),o=n(2100),a=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o;e.exports=a},2646:function(e){e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}},9179:function(e){e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},6478:function(e){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},2446:function(e,t,n){var r=n(7197),i=n(8950),o=n(3629),a=n(152),s=r?r.prototype:void 0,l=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(a(t))return l?l.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n}},821:function(e,t,n){var r=n(6050),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},6194:function(e){e.exports=function(e){return function(t){return e(t)}}},9602:function(e,t,n){var r=n(692),i=n(9055),o=n(2683),a=n(75),s=n(7730),l=n(2230);e.exports=function(e,t,n){var u=-1,c=i,d=e.length,h=!0,f=[],p=f;if(n)h=!1,c=o;else if(d>=200){var v=t?null:s(e);if(v)return l(v);h=!1,c=a,p=new r}else p=t?[]:f;e:for(;++u<d;){var g=e[u],m=t?t(g):g;if(g=n||0!==g?g:0,h&&m===m){for(var y=p.length;y--;)if(p[y]===m)continue e;t&&p.push(m),f.push(g)}else c(p,m,n)||(p!==f&&p.push(m),f.push(g))}return f}},6555:function(e,t,n){var r=n(3082),i=n(5727),o=n(8978),a=n(9793);e.exports=function(e,t){return t=r(t,e),null==(e=o(e,t))||delete e[a(i(t))]}},8019:function(e,t,n){var r=n(8950);e.exports=function(e,t){return r(t,(function(t){return e[t]}))}},1126:function(e,t,n){var r=n(1468),i=n(5182),o=n(9602);e.exports=function(e,t,n){var a=e.length;if(a<2)return a?o(e[0]):[];for(var s=-1,l=Array(a);++s<a;)for(var u=e[s],c=-1;++c<a;)c!=s&&(l[s]=r(l[s]||u,e[c],t,n));return o(i(l,1),t,n)}},75:function(e){e.exports=function(e,t){return e.has(t)}},5600:function(e,t,n){var r=n(6279);e.exports=function(e){return r(e)?e:[]}},3082:function(e,t,n){var r=n(3629),i=n(5823),o=n(170),a=n(3518);e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:o(a(e))}},7010:function(e,t,n){var r=n(6219);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},4523:function(e,t,n){e=n.nmd(e);var r=n(7009),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r}},1022:function(e,t,n){var r=n(7010);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},8503:function(e){var t=/\w*$/;e.exports=function(e){var n=new e.constructor(e.source,t.exec(e));return n.lastIndex=e.lastIndex,n}},4720:function(e,t,n){var r=n(7197),i=r?r.prototype:void 0,o=i?i.valueOf:void 0;e.exports=function(e){return o?Object(o.call(e)):{}}},613:function(e,t,n){var r=n(7010);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},8558:function(e,t,n){var r=n(152);e.exports=function(e,t){if(e!==t){var n=void 0!==e,i=null===e,o=e===e,a=r(e),s=void 0!==t,l=null===t,u=t===t,c=r(t);if(!l&&!c&&!a&&e>t||a&&s&&u&&!l&&!c||i&&s&&u||!n&&u||!o)return 1;if(!i&&!a&&!c&&e<t||c&&n&&o&&!i&&!a||l&&n&&o||!s&&o||!u)return-1}return 0}},4480:function(e,t,n){var r=n(8558);e.exports=function(e,t,n){for(var i=-1,o=e.criteria,a=t.criteria,s=o.length,l=n.length;++i<s;){var u=r(o[i],a[i]);if(u)return i>=l?u:u*("desc"==n[i]?-1:1)}return e.index-t.index}},291:function(e){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},4503:function(e,t,n){var r=n(8463),i=n(2526);e.exports=function(e,t,n,o){var a=!n;n||(n={});for(var s=-1,l=t.length;++s<l;){var u=t[s],c=o?o(n[u],e[u],u,n,e):void 0;void 0===c&&(c=e[u]),a?i(n,u,c):r(n,u,c)}return n}},2455:function(e,t,n){var r=n(4503),i=n(5918);e.exports=function(e,t){return r(e,i(e),t)}},7636:function(e,t,n){var r=n(4503),i=n(8487);e.exports=function(e,t){return r(e,i(e),t)}},5525:function(e,t,n){var r=n(7009)["__core-js_shared__"];e.exports=r},7056:function(e,t,n){var r=n(1473);e.exports=function(e,t){return function(n,i){if(null==n)return n;if(!r(n))return e(n,i);for(var o=n.length,a=t?o:-1,s=Object(n);(t?a--:++a<o)&&!1!==i(s[a],a,s););return n}}},372:function(e){e.exports=function(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===n(o[l],l,o))break}return t}}},7730:function(e,t,n){var r=n(3924),i=n(9694),o=n(2230),a=r&&1/o(new r([,-0]))[1]==1/0?function(e){return new r(e)}:i;e.exports=a},8528:function(e,t,n){var r=n(8136),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=i},5305:function(e,t,n){var r=n(692),i=n(7897),o=n(75);e.exports=function(e,t,n,a,s,l){var u=1&n,c=e.length,d=t.length;if(c!=d&&!(u&&d>c))return!1;var h=l.get(e),f=l.get(t);if(h&&f)return h==t&&f==e;var p=-1,v=!0,g=2&n?new r:void 0;for(l.set(e,t),l.set(t,e);++p<c;){var m=e[p],y=t[p];if(a)var w=u?a(y,m,p,t,e,l):a(m,y,p,e,t,l);if(void 0!==w){if(w)continue;v=!1;break}if(g){if(!i(t,(function(e,t){if(!o(g,t)&&(m===e||s(m,e,n,a,l)))return g.push(t)}))){v=!1;break}}else if(m!==y&&!s(m,y,n,a,l)){v=!1;break}}return l.delete(e),l.delete(t),v}},2206:function(e,t,n){var r=n(7197),i=n(6219),o=n(9231),a=n(5305),s=n(234),l=n(2230),u=r?r.prototype:void 0,c=u?u.valueOf:void 0;e.exports=function(e,t,n,r,u,d,h){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=s;case"[object Set]":var p=1&r;if(f||(f=l),e.size!=t.size&&!p)return!1;var v=h.get(e);if(v)return v==t;r|=2,h.set(e,t);var g=a(f(e),f(t),r,u,d,h);return h.delete(e),g;case"[object Symbol]":if(c)return c.call(e)==c.call(t)}return!1}},8078:function(e,t,n){var r=n(8248),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,a,s){var l=1&n,u=r(e),c=u.length;if(c!=r(t).length&&!l)return!1;for(var d=c;d--;){var h=u[d];if(!(l?h in t:i.call(t,h)))return!1}var f=s.get(e),p=s.get(t);if(f&&p)return f==t&&p==e;var v=!0;s.set(e,t),s.set(t,e);for(var g=l;++d<c;){var m=e[h=u[d]],y=t[h];if(o)var w=l?o(y,m,h,t,e,s):o(m,y,h,e,t,s);if(!(void 0===w?m===y||a(m,y,n,o,s):w)){v=!1;break}g||(g="constructor"==h)}if(v&&!g){var b=e.constructor,C=t.constructor;b==C||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof C&&C instanceof C||(v=!1)}return s.delete(e),s.delete(t),v}},7038:function(e,t,n){var r=n(5506),i=n(4262),o=n(9156);e.exports=function(e){return o(i(e,void 0,r),e+"")}},1032:function(e,t,n){var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},8248:function(e,t,n){var r=n(1986),i=n(5918),o=n(2742);e.exports=function(e){return r(e,o,i)}},5341:function(e,t,n){var r=n(1986),i=n(8487),o=n(3961);e.exports=function(e){return r(e,o,i)}},2799:function(e,t,n){var r=n(5964);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},9091:function(e,t,n){var r=n(5072),i=n(2742);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var o=t[n],a=e[o];t[n]=[o,a,r(a)]}return t}},8136:function(e,t,n){var r=n(6703),i=n(40);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},1137:function(e,t,n){var r=n(2709)(Object.getPrototypeOf,Object);e.exports=r},1587:function(e,t,n){var r=n(7197),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(l){}var i=a.call(e);return r&&(t?e[s]=n:delete e[s]),i}},5918:function(e,t,n){var r=n(4903),i=n(8174),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),r(a(e),(function(t){return o.call(e,t)})))}:i;e.exports=s},8487:function(e,t,n){var r=n(1705),i=n(1137),o=n(5918),a=n(8174),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,o(e)),e=i(e);return t}:a;e.exports=s},8383:function(e,t,n){var r=n(908),i=n(5797),o=n(8319),a=n(3924),s=n(7091),l=n(9066),u=n(7907),c="[object Map]",d="[object Promise]",h="[object Set]",f="[object WeakMap]",p="[object DataView]",v=u(r),g=u(i),m=u(o),y=u(a),w=u(s),b=l;(r&&b(new r(new ArrayBuffer(1)))!=p||i&&b(new i)!=c||o&&b(o.resolve())!=d||a&&b(new a)!=h||s&&b(new s)!=f)&&(b=function(e){var t=l(e),n="[object Object]"==t?e.constructor:void 0,r=n?u(n):"";if(r)switch(r){case v:return p;case g:return c;case m:return d;case y:return h;case w:return f}return t}),e.exports=b},40:function(e){e.exports=function(e,t){return null==e?void 0:e[t]}},6417:function(e,t,n){var r=n(3082),i=n(4963),o=n(3629),a=n(6800),s=n(4635),l=n(9793);e.exports=function(e,t,n){for(var u=-1,c=(t=r(t,e)).length,d=!1;++u<c;){var h=l(t[u]);if(!(d=null!=e&&n(e,h)))break;e=e[h]}return d||++u!=c?d:!!(c=null==e?0:e.length)&&s(c)&&a(h,c)&&(o(e)||i(e))}},5403:function(e,t,n){var r=n(9620);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},2747:function(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},6037:function(e,t,n){var r=n(9620),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},4154:function(e,t,n){var r=n(9620),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},7728:function(e,t,n){var r=n(9620);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},9243:function(e){var t=Object.prototype.hasOwnProperty;e.exports=function(e){var n=e.length,r=new e.constructor(n);return n&&"string"==typeof e[0]&&t.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},9759:function(e,t,n){var r=n(7010),i=n(1022),o=n(8503),a=n(4720),s=n(613);e.exports=function(e,t,n){var l=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new l(+e);case"[object DataView]":return i(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,n);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(e);case"[object RegExp]":return o(e);case"[object Symbol]":return a(e)}}},548:function(e,t,n){var r=n(5763),i=n(1137),o=n(2936);e.exports=function(e){return"function"!=typeof e.constructor||o(e)?{}:r(i(e))}},3529:function(e,t,n){var r=n(7197),i=n(4963),o=n(3629),a=r?r.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||i(e)||!!(a&&e&&e[a])}},6800:function(e){var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},3195:function(e,t,n){var r=n(9231),i=n(1473),o=n(6800),a=n(8092);e.exports=function(e,t,n){if(!a(n))return!1;var s=typeof t;return!!("number"==s?i(n)&&o(t,n.length):"string"==s&&t in n)&&r(n[t],e)}},5823:function(e,t,n){var r=n(3629),i=n(152),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||(a.test(e)||!o.test(e)||null!=t&&e in Object(t))}},5964:function(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},257:function(e,t,n){var r=n(5525),i=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!i&&i in e}},2936:function(e){var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},5072:function(e,t,n){var r=n(8092);e.exports=function(e){return e===e&&!r(e)}},3894:function(e){e.exports=function(){this.__data__=[],this.size=0}},8699:function(e,t,n){var r=n(7112),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},4957:function(e,t,n){var r=n(7112);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},7184:function(e,t,n){var r=n(7112);e.exports=function(e){return r(this.__data__,e)>-1}},7109:function(e,t,n){var r=n(7112);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},4086:function(e,t,n){var r=n(9676),i=n(8384),o=n(5797);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},9255:function(e,t,n){var r=n(2799);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},9186:function(e,t,n){var r=n(2799);e.exports=function(e){return r(this,e).get(e)}},3423:function(e,t,n){var r=n(2799);e.exports=function(e){return r(this,e).has(e)}},3739:function(e,t,n){var r=n(2799);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},234:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},284:function(e){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},4634:function(e,t,n){var r=n(9151);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},9620:function(e,t,n){var r=n(8136)(Object,"create");e.exports=r},8836:function(e,t,n){var r=n(2709)(Object.keys,Object);e.exports=r},4221:function(e){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},9494:function(e,t,n){e=n.nmd(e);var r=n(1032),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i&&r.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(t){}}();e.exports=s},3581:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},2709:function(e){e.exports=function(e,t){return function(n){return e(t(n))}}},4262:function(e,t,n){var r=n(3665),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,a=-1,s=i(o.length-t,0),l=Array(s);++a<s;)l[a]=o[t+a];a=-1;for(var u=Array(t+1);++a<t;)u[a]=o[a];return u[t]=n(l),r(e,this,u)}}},8978:function(e,t,n){var r=n(8667),i=n(2646);e.exports=function(e,t){return t.length<2?e:r(e,i(t,0,-1))}},7009:function(e,t,n){var r=n(1032),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},5774:function(e){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},1596:function(e){e.exports=function(e){return this.__data__.has(e)}},2230:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},9156:function(e,t,n){var r=n(7532),i=n(3197)(r);e.exports=i},3197:function(e){var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var i=t(),o=16-(i-r);if(r=i,o>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},511:function(e,t,n){var r=n(8384);e.exports=function(){this.__data__=new r,this.size=0}},835:function(e){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},707:function(e){e.exports=function(e){return this.__data__.get(e)}},8832:function(e){e.exports=function(e){return this.__data__.has(e)}},5077:function(e,t,n){var r=n(8384),i=n(5797),o=n(8059);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!i||a.length<199)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(a)}return n.set(e,t),this.size=n.size,this}},7167:function(e){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},170:function(e,t,n){var r=n(4634),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,r,i){t.push(r?i.replace(o,"$1"):n||e)})),t}));e.exports=a},9793:function(e,t,n){var r=n(152);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}},7907:function(e){var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(n){}try{return e+""}catch(n){}}return""}},6050:function(e){var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},8121:function(e,t,n){var r=n(1905);e.exports=function(e){return r(e,5)}},1547:function(e){e.exports=function(e){return function(){return e}}},1180:function(e,t,n){var r=n(1468),i=n(5182),o=n(8794),a=n(6279),s=o((function(e,t){return a(e)?r(e,i(t,1,a,!0)):[]}));e.exports=s},9231:function(e){e.exports=function(e,t){return e===t||e!==e&&t!==t}},5506:function(e,t,n){var r=n(5182);e.exports=function(e){return(null==e?0:e.length)?r(e,1):[]}},6181:function(e,t,n){var r=n(8667);e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}},5658:function(e,t,n){var r=n(529),i=n(6417);e.exports=function(e,t){return null!=e&&i(e,t,r)}},2100:function(e){e.exports=function(e){return e}},806:function(e,t,n){var r=n(4842),i=n(1473),o=n(6769),a=n(9753),s=n(2063),l=Math.max;e.exports=function(e,t,n,u){e=i(e)?e:s(e),n=n&&!u?a(n):0;var c=e.length;return n<0&&(n=l(c+n,0)),o(e)?n<=c&&e.indexOf(t,n)>-1:!!c&&r(e,t,n)>-1}},9761:function(e,t,n){var r=n(4842),i=n(9753),o=Math.max;e.exports=function(e,t,n){var a=null==e?0:e.length;if(!a)return-1;var s=null==n?0:i(n);return s<0&&(s=o(a+s,0)),r(e,t,s)}},7753:function(e,t,n){var r=n(8950),i=n(5188),o=n(8794),a=n(5600),s=o((function(e){var t=r(e,a);return t.length&&t[0]===e[0]?i(t):[]}));e.exports=s},4963:function(e,t,n){var r=n(4906),i=n(3141),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(e){return i(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},3629:function(e){var t=Array.isArray;e.exports=t},1473:function(e,t,n){var r=n(4786),i=n(4635);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},6279:function(e,t,n){var r=n(1473),i=n(3141);e.exports=function(e){return i(e)&&r(e)}},5174:function(e,t,n){e=n.nmd(e);var r=n(7009),i=n(9488),o=t&&!t.nodeType&&t,a=o&&e&&!e.nodeType&&e,s=a&&a.exports===o?r.Buffer:void 0,l=(s?s.isBuffer:void 0)||i;e.exports=l},8111:function(e,t,n){var r=n(1848);e.exports=function(e,t){return r(e,t)}},4786:function(e,t,n){var r=n(9066),i=n(8092);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},4635:function(e){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},103:function(e,t,n){var r=n(3085),i=n(6194),o=n(9494),a=o&&o.isMap,s=a?i(a):r;e.exports=s},8092:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3141:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},6995:function(e,t,n){var r=n(8680),i=n(6194),o=n(9494),a=o&&o.isSet,s=a?i(a):r;e.exports=s},6769:function(e,t,n){var r=n(9066),i=n(3629),o=n(3141);e.exports=function(e){return"string"==typeof e||!i(e)&&o(e)&&"[object String]"==r(e)}},152:function(e,t,n){var r=n(9066),i=n(3141);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},9102:function(e,t,n){var r=n(8150),i=n(6194),o=n(9494),a=o&&o.isTypedArray,s=a?i(a):r;e.exports=s},2742:function(e,t,n){var r=n(7538),i=n(3654),o=n(1473);e.exports=function(e){return o(e)?r(e):i(e)}},3961:function(e,t,n){var r=n(7538),i=n(8664),o=n(1473);e.exports=function(e){return o(e)?r(e,!0):i(e)}},5727:function(e){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},763:function(e,t,n){var r;e=n.nmd(e),function(){var i,o="Expected a function",a="__lodash_hash_undefined__",s="__lodash_placeholder__",l=16,u=32,c=64,d=128,h=256,f=1/0,p=9007199254740991,v=NaN,g=4294967295,m=[["ary",d],["bind",1],["bindKey",2],["curry",8],["curryRight",l],["flip",512],["partial",u],["partialRight",c],["rearg",h]],y="[object Arguments]",w="[object Array]",b="[object Boolean]",C="[object Date]",S="[object Error]",E="[object Function]",k="[object GeneratorFunction]",x="[object Map]",T="[object Number]",R="[object Object]",A="[object Promise]",_="[object RegExp]",O="[object Set]",D="[object String]",N="[object Symbol]",P="[object WeakMap]",F="[object ArrayBuffer]",I="[object DataView]",L="[object Float32Array]",M="[object Float64Array]",G="[object Int8Array]",B="[object Int16Array]",j="[object Int32Array]",H="[object Uint8Array]",V="[object Uint8ClampedArray]",W="[object Uint16Array]",z="[object Uint32Array]",U=/\b__p \+= '';/g,K=/\b(__p \+=) '' \+/g,q=/(__e\(.*?\)|\b__t\)) \+\n'';/g,X=/&(?:amp|lt|gt|quot|#39);/g,Y=/[&<>"']/g,Q=RegExp(X.source),Z=RegExp(Y.source),J=/<%-([\s\S]+?)%>/g,$=/<%([\s\S]+?)%>/g,ee=/<%=([\s\S]+?)%>/g,te=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ne=/^\w*$/,re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ie=/[\\^$.*+?()[\]{}|]/g,oe=RegExp(ie.source),ae=/^\s+/,se=/\s/,le=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ue=/\{\n\/\* \[wrapped with (.+)\] \*/,ce=/,? & /,de=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,he=/[()=,{}\[\]\/\s]/,fe=/\\(\\)?/g,pe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ve=/\w*$/,ge=/^[-+]0x[0-9a-f]+$/i,me=/^0b[01]+$/i,ye=/^\[object .+?Constructor\]$/,we=/^0o[0-7]+$/i,be=/^(?:0|[1-9]\d*)$/,Ce=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Se=/($^)/,Ee=/['\n\r\u2028\u2029\\]/g,ke="\\ud800-\\udfff",xe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Te="\\u2700-\\u27bf",Re="a-z\\xdf-\\xf6\\xf8-\\xff",Ae="A-Z\\xc0-\\xd6\\xd8-\\xde",_e="\\ufe0e\\ufe0f",Oe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",De="['\u2019]",Ne="["+ke+"]",Pe="["+Oe+"]",Fe="["+xe+"]",Ie="\\d+",Le="["+Te+"]",Me="["+Re+"]",Ge="[^"+ke+Oe+Ie+Te+Re+Ae+"]",Be="\\ud83c[\\udffb-\\udfff]",je="[^"+ke+"]",He="(?:\\ud83c[\\udde6-\\uddff]){2}",Ve="[\\ud800-\\udbff][\\udc00-\\udfff]",We="["+Ae+"]",ze="\\u200d",Ue="(?:"+Me+"|"+Ge+")",Ke="(?:"+We+"|"+Ge+")",qe="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Xe="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Ye="(?:"+Fe+"|"+Be+")"+"?",Qe="["+_e+"]?",Ze=Qe+Ye+("(?:"+ze+"(?:"+[je,He,Ve].join("|")+")"+Qe+Ye+")*"),Je="(?:"+[Le,He,Ve].join("|")+")"+Ze,$e="(?:"+[je+Fe+"?",Fe,He,Ve,Ne].join("|")+")",et=RegExp(De,"g"),tt=RegExp(Fe,"g"),nt=RegExp(Be+"(?="+Be+")|"+$e+Ze,"g"),rt=RegExp([We+"?"+Me+"+"+qe+"(?="+[Pe,We,"$"].join("|")+")",Ke+"+"+Xe+"(?="+[Pe,We+Ue,"$"].join("|")+")",We+"?"+Ue+"+"+qe,We+"+"+Xe,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ie,Je].join("|"),"g"),it=RegExp("["+ze+ke+xe+_e+"]"),ot=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,at=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],st=-1,lt={};lt[L]=lt[M]=lt[G]=lt[B]=lt[j]=lt[H]=lt[V]=lt[W]=lt[z]=!0,lt[y]=lt[w]=lt[F]=lt[b]=lt[I]=lt[C]=lt[S]=lt[E]=lt[x]=lt[T]=lt[R]=lt[_]=lt[O]=lt[D]=lt[P]=!1;var ut={};ut[y]=ut[w]=ut[F]=ut[I]=ut[b]=ut[C]=ut[L]=ut[M]=ut[G]=ut[B]=ut[j]=ut[x]=ut[T]=ut[R]=ut[_]=ut[O]=ut[D]=ut[N]=ut[H]=ut[V]=ut[W]=ut[z]=!0,ut[S]=ut[E]=ut[P]=!1;var ct={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},dt=parseFloat,ht=parseInt,ft="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,pt="object"==typeof self&&self&&self.Object===Object&&self,vt=ft||pt||Function("return this")(),gt=t&&!t.nodeType&&t,mt=gt&&e&&!e.nodeType&&e,yt=mt&&mt.exports===gt,wt=yt&&ft.process,bt=function(){try{var e=mt&&mt.require&&mt.require("util").types;return e||wt&&wt.binding&&wt.binding("util")}catch(t){}}(),Ct=bt&&bt.isArrayBuffer,St=bt&&bt.isDate,Et=bt&&bt.isMap,kt=bt&&bt.isRegExp,xt=bt&&bt.isSet,Tt=bt&&bt.isTypedArray;function Rt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function At(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function _t(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Ot(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Dt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Nt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function Pt(e,t){return!!(null==e?0:e.length)&&Wt(e,t,0)>-1}function Ft(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function It(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Lt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Mt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Gt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Bt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var jt=qt("length");function Ht(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function Vt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Wt(e,t,n){return t===t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Vt(e,Ut,n)}function zt(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Ut(e){return e!==e}function Kt(e,t){var n=null==e?0:e.length;return n?Qt(e,t)/n:v}function qt(e){return function(t){return null==t?i:t[e]}}function Xt(e){return function(t){return null==e?i:e[t]}}function Yt(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function Qt(e,t){for(var n,r=-1,o=e.length;++r<o;){var a=t(e[r]);a!==i&&(n=n===i?a:n+a)}return n}function Zt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Jt(e){return e?e.slice(0,gn(e)+1).replace(ae,""):e}function $t(e){return function(t){return e(t)}}function en(e,t){return It(t,(function(t){return e[t]}))}function tn(e,t){return e.has(t)}function nn(e,t){for(var n=-1,r=e.length;++n<r&&Wt(t,e[n],0)>-1;);return n}function rn(e,t){for(var n=e.length;n--&&Wt(t,e[n],0)>-1;);return n}var on=Xt({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),an=Xt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function sn(e){return"\\"+ct[e]}function ln(e){return it.test(e)}function un(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function cn(e,t){return function(n){return e(t(n))}}function dn(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==s||(e[n]=s,o[i++]=n)}return o}function hn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function fn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function pn(e){return ln(e)?function(e){var t=nt.lastIndex=0;for(;nt.test(e);)++t;return t}(e):jt(e)}function vn(e){return ln(e)?function(e){return e.match(nt)||[]}(e):function(e){return e.split("")}(e)}function gn(e){for(var t=e.length;t--&&se.test(e.charAt(t)););return t}var mn=Xt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var yn=function e(t){var n=(t=null==t?vt:yn.defaults(vt.Object(),t,yn.pick(vt,at))).Array,r=t.Date,se=t.Error,ke=t.Function,xe=t.Math,Te=t.Object,Re=t.RegExp,Ae=t.String,_e=t.TypeError,Oe=n.prototype,De=ke.prototype,Ne=Te.prototype,Pe=t["__core-js_shared__"],Fe=De.toString,Ie=Ne.hasOwnProperty,Le=0,Me=function(){var e=/[^.]+$/.exec(Pe&&Pe.keys&&Pe.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ge=Ne.toString,Be=Fe.call(Te),je=vt._,He=Re("^"+Fe.call(Ie).replace(ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ve=yt?t.Buffer:i,We=t.Symbol,ze=t.Uint8Array,Ue=Ve?Ve.allocUnsafe:i,Ke=cn(Te.getPrototypeOf,Te),qe=Te.create,Xe=Ne.propertyIsEnumerable,Ye=Oe.splice,Qe=We?We.isConcatSpreadable:i,Ze=We?We.iterator:i,Je=We?We.toStringTag:i,$e=function(){try{var e=ho(Te,"defineProperty");return e({},"",{}),e}catch(t){}}(),nt=t.clearTimeout!==vt.clearTimeout&&t.clearTimeout,it=r&&r.now!==vt.Date.now&&r.now,ct=t.setTimeout!==vt.setTimeout&&t.setTimeout,ft=xe.ceil,pt=xe.floor,gt=Te.getOwnPropertySymbols,mt=Ve?Ve.isBuffer:i,wt=t.isFinite,bt=Oe.join,jt=cn(Te.keys,Te),Xt=xe.max,wn=xe.min,bn=r.now,Cn=t.parseInt,Sn=xe.random,En=Oe.reverse,kn=ho(t,"DataView"),xn=ho(t,"Map"),Tn=ho(t,"Promise"),Rn=ho(t,"Set"),An=ho(t,"WeakMap"),_n=ho(Te,"create"),On=An&&new An,Dn={},Nn=Go(kn),Pn=Go(xn),Fn=Go(Tn),In=Go(Rn),Ln=Go(An),Mn=We?We.prototype:i,Gn=Mn?Mn.valueOf:i,Bn=Mn?Mn.toString:i;function jn(e){if(ts(e)&&!za(e)&&!(e instanceof zn)){if(e instanceof Wn)return e;if(Ie.call(e,"__wrapped__"))return Bo(e)}return new Wn(e)}var Hn=function(){function e(){}return function(t){if(!es(t))return{};if(qe)return qe(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function Vn(){}function Wn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function zn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=g,this.__views__=[]}function Un(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Kn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function qn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Xn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new qn;++t<n;)this.add(e[t])}function Yn(e){var t=this.__data__=new Kn(e);this.size=t.size}function Qn(e,t){var n=za(e),r=!n&&Wa(e),i=!n&&!r&&Xa(e),o=!n&&!r&&!i&&us(e),a=n||r||i||o,s=a?Zt(e.length,Ae):[],l=s.length;for(var u in e)!t&&!Ie.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||wo(u,l))||s.push(u);return s}function Zn(e){var t=e.length;return t?e[Xr(0,t-1)]:i}function Jn(e,t){return Io(_i(e),sr(t,0,e.length))}function $n(e){return Io(_i(e))}function er(e,t,n){(n!==i&&!ja(e[t],n)||n===i&&!(t in e))&&or(e,t,n)}function tr(e,t,n){var r=e[t];Ie.call(e,t)&&ja(r,n)&&(n!==i||t in e)||or(e,t,n)}function nr(e,t){for(var n=e.length;n--;)if(ja(e[n][0],t))return n;return-1}function rr(e,t,n,r){return hr(e,(function(e,i,o){t(r,e,n(e),o)})),r}function ir(e,t){return e&&Oi(t,Ds(t),e)}function or(e,t,n){"__proto__"==t&&$e?$e(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ar(e,t){for(var r=-1,o=t.length,a=n(o),s=null==e;++r<o;)a[r]=s?i:Ts(e,t[r]);return a}function sr(e,t,n){return e===e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function lr(e,t,n,r,o,a){var s,l=1&t,u=2&t,c=4&t;if(n&&(s=o?n(e,r,o,a):n(e)),s!==i)return s;if(!es(e))return e;var d=za(e);if(d){if(s=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Ie.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!l)return _i(e,s)}else{var h=vo(e),f=h==E||h==k;if(Xa(e))return Ei(e,l);if(h==R||h==y||f&&!o){if(s=u||f?{}:mo(e),!l)return u?function(e,t){return Oi(e,po(e),t)}(e,function(e,t){return e&&Oi(t,Ns(t),e)}(s,e)):function(e,t){return Oi(e,fo(e),t)}(e,ir(s,e))}else{if(!ut[h])return o?e:{};s=function(e,t,n){var r=e.constructor;switch(t){case F:return ki(e);case b:case C:return new r(+e);case I:return function(e,t){var n=t?ki(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case L:case M:case G:case B:case j:case H:case V:case W:case z:return xi(e,n);case x:return new r;case T:case D:return new r(e);case _:return function(e){var t=new e.constructor(e.source,ve.exec(e));return t.lastIndex=e.lastIndex,t}(e);case O:return new r;case N:return i=e,Gn?Te(Gn.call(i)):{}}var i}(e,h,l)}}a||(a=new Yn);var p=a.get(e);if(p)return p;a.set(e,s),as(e)?e.forEach((function(r){s.add(lr(r,t,n,r,e,a))})):ns(e)&&e.forEach((function(r,i){s.set(i,lr(r,t,n,i,e,a))}));var v=d?i:(c?u?io:ro:u?Ns:Ds)(e);return _t(v||e,(function(r,i){v&&(r=e[i=r]),tr(s,i,lr(r,t,n,i,e,a))})),s}function ur(e,t,n){var r=n.length;if(null==e)return!r;for(e=Te(e);r--;){var o=n[r],a=t[o],s=e[o];if(s===i&&!(o in e)||!a(s))return!1}return!0}function cr(e,t,n){if("function"!=typeof e)throw new _e(o);return Do((function(){e.apply(i,n)}),t)}function dr(e,t,n,r){var i=-1,o=Pt,a=!0,s=e.length,l=[],u=t.length;if(!s)return l;n&&(t=It(t,$t(n))),r?(o=Ft,a=!1):t.length>=200&&(o=tn,a=!1,t=new Xn(t));e:for(;++i<s;){var c=e[i],d=null==n?c:n(c);if(c=r||0!==c?c:0,a&&d===d){for(var h=u;h--;)if(t[h]===d)continue e;l.push(c)}else o(t,d,r)||l.push(c)}return l}jn.templateSettings={escape:J,evaluate:$,interpolate:ee,variable:"",imports:{_:jn}},jn.prototype=Vn.prototype,jn.prototype.constructor=jn,Wn.prototype=Hn(Vn.prototype),Wn.prototype.constructor=Wn,zn.prototype=Hn(Vn.prototype),zn.prototype.constructor=zn,Un.prototype.clear=function(){this.__data__=_n?_n(null):{},this.size=0},Un.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Un.prototype.get=function(e){var t=this.__data__;if(_n){var n=t[e];return n===a?i:n}return Ie.call(t,e)?t[e]:i},Un.prototype.has=function(e){var t=this.__data__;return _n?t[e]!==i:Ie.call(t,e)},Un.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=_n&&t===i?a:t,this},Kn.prototype.clear=function(){this.__data__=[],this.size=0},Kn.prototype.delete=function(e){var t=this.__data__,n=nr(t,e);return!(n<0)&&(n==t.length-1?t.pop():Ye.call(t,n,1),--this.size,!0)},Kn.prototype.get=function(e){var t=this.__data__,n=nr(t,e);return n<0?i:t[n][1]},Kn.prototype.has=function(e){return nr(this.__data__,e)>-1},Kn.prototype.set=function(e,t){var n=this.__data__,r=nr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},qn.prototype.clear=function(){this.size=0,this.__data__={hash:new Un,map:new(xn||Kn),string:new Un}},qn.prototype.delete=function(e){var t=uo(this,e).delete(e);return this.size-=t?1:0,t},qn.prototype.get=function(e){return uo(this,e).get(e)},qn.prototype.has=function(e){return uo(this,e).has(e)},qn.prototype.set=function(e,t){var n=uo(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Xn.prototype.add=Xn.prototype.push=function(e){return this.__data__.set(e,a),this},Xn.prototype.has=function(e){return this.__data__.has(e)},Yn.prototype.clear=function(){this.__data__=new Kn,this.size=0},Yn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Yn.prototype.get=function(e){return this.__data__.get(e)},Yn.prototype.has=function(e){return this.__data__.has(e)},Yn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Kn){var r=n.__data__;if(!xn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new qn(r)}return n.set(e,t),this.size=n.size,this};var hr=Pi(br),fr=Pi(Cr,!0);function pr(e,t){var n=!0;return hr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function vr(e,t,n){for(var r=-1,o=e.length;++r<o;){var a=e[r],s=t(a);if(null!=s&&(l===i?s===s&&!ls(s):n(s,l)))var l=s,u=a}return u}function gr(e,t){var n=[];return hr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function mr(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=yo),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?mr(s,t-1,n,r,i):Lt(i,s):r||(i[i.length]=s)}return i}var yr=Fi(),wr=Fi(!0);function br(e,t){return e&&yr(e,t,Ds)}function Cr(e,t){return e&&wr(e,t,Ds)}function Sr(e,t){return Nt(t,(function(t){return Za(e[t])}))}function Er(e,t){for(var n=0,r=(t=wi(t,e)).length;null!=e&&n<r;)e=e[Mo(t[n++])];return n&&n==r?e:i}function kr(e,t,n){var r=t(e);return za(e)?r:Lt(r,n(e))}function xr(e){return null==e?e===i?"[object Undefined]":"[object Null]":Je&&Je in Te(e)?function(e){var t=Ie.call(e,Je),n=e[Je];try{e[Je]=i;var r=!0}catch(a){}var o=Ge.call(e);r&&(t?e[Je]=n:delete e[Je]);return o}(e):function(e){return Ge.call(e)}(e)}function Tr(e,t){return e>t}function Rr(e,t){return null!=e&&Ie.call(e,t)}function Ar(e,t){return null!=e&&t in Te(e)}function _r(e,t,r){for(var o=r?Ft:Pt,a=e[0].length,s=e.length,l=s,u=n(s),c=1/0,d=[];l--;){var h=e[l];l&&t&&(h=It(h,$t(t))),c=wn(h.length,c),u[l]=!r&&(t||a>=120&&h.length>=120)?new Xn(l&&h):i}h=e[0];var f=-1,p=u[0];e:for(;++f<a&&d.length<c;){var v=h[f],g=t?t(v):v;if(v=r||0!==v?v:0,!(p?tn(p,g):o(d,g,r))){for(l=s;--l;){var m=u[l];if(!(m?tn(m,g):o(e[l],g,r)))continue e}p&&p.push(g),d.push(v)}}return d}function Or(e,t,n){var r=null==(e=Ao(e,t=wi(t,e)))?e:e[Mo(Qo(t))];return null==r?i:Rt(r,e,n)}function Dr(e){return ts(e)&&xr(e)==y}function Nr(e,t,n,r,o){return e===t||(null==e||null==t||!ts(e)&&!ts(t)?e!==e&&t!==t:function(e,t,n,r,o,a){var s=za(e),l=za(t),u=s?w:vo(e),c=l?w:vo(t),d=(u=u==y?R:u)==R,h=(c=c==y?R:c)==R,f=u==c;if(f&&Xa(e)){if(!Xa(t))return!1;s=!0,d=!1}if(f&&!d)return a||(a=new Yn),s||us(e)?to(e,t,n,r,o,a):function(e,t,n,r,i,o,a){switch(n){case I:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case F:return!(e.byteLength!=t.byteLength||!o(new ze(e),new ze(t)));case b:case C:case T:return ja(+e,+t);case S:return e.name==t.name&&e.message==t.message;case _:case D:return e==t+"";case x:var s=un;case O:var l=1&r;if(s||(s=hn),e.size!=t.size&&!l)return!1;var u=a.get(e);if(u)return u==t;r|=2,a.set(e,t);var c=to(s(e),s(t),r,i,o,a);return a.delete(e),c;case N:if(Gn)return Gn.call(e)==Gn.call(t)}return!1}(e,t,u,n,r,o,a);if(!(1&n)){var p=d&&Ie.call(e,"__wrapped__"),v=h&&Ie.call(t,"__wrapped__");if(p||v){var g=p?e.value():e,m=v?t.value():t;return a||(a=new Yn),o(g,m,n,r,a)}}if(!f)return!1;return a||(a=new Yn),function(e,t,n,r,o,a){var s=1&n,l=ro(e),u=l.length,c=ro(t),d=c.length;if(u!=d&&!s)return!1;var h=u;for(;h--;){var f=l[h];if(!(s?f in t:Ie.call(t,f)))return!1}var p=a.get(e),v=a.get(t);if(p&&v)return p==t&&v==e;var g=!0;a.set(e,t),a.set(t,e);var m=s;for(;++h<u;){var y=e[f=l[h]],w=t[f];if(r)var b=s?r(w,y,f,t,e,a):r(y,w,f,e,t,a);if(!(b===i?y===w||o(y,w,n,r,a):b)){g=!1;break}m||(m="constructor"==f)}if(g&&!m){var C=e.constructor,S=t.constructor;C==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof C&&C instanceof C&&"function"==typeof S&&S instanceof S||(g=!1)}return a.delete(e),a.delete(t),g}(e,t,n,r,o,a)}(e,t,n,r,Nr,o))}function Pr(e,t,n,r){var o=n.length,a=o,s=!r;if(null==e)return!a;for(e=Te(e);o--;){var l=n[o];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<a;){var u=(l=n[o])[0],c=e[u],d=l[1];if(s&&l[2]){if(c===i&&!(u in e))return!1}else{var h=new Yn;if(r)var f=r(c,d,u,e,t,h);if(!(f===i?Nr(d,c,3,r,h):f))return!1}}return!0}function Fr(e){return!(!es(e)||(t=e,Me&&Me in t))&&(Za(e)?He:ye).test(Go(e));var t}function Ir(e){return"function"==typeof e?e:null==e?rl:"object"==typeof e?za(e)?Hr(e[0],e[1]):jr(e):hl(e)}function Lr(e){if(!ko(e))return jt(e);var t=[];for(var n in Te(e))Ie.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Mr(e){if(!es(e))return function(e){var t=[];if(null!=e)for(var n in Te(e))t.push(n);return t}(e);var t=ko(e),n=[];for(var r in e)("constructor"!=r||!t&&Ie.call(e,r))&&n.push(r);return n}function Gr(e,t){return e<t}function Br(e,t){var r=-1,i=Ka(e)?n(e.length):[];return hr(e,(function(e,n,o){i[++r]=t(e,n,o)})),i}function jr(e){var t=co(e);return 1==t.length&&t[0][2]?To(t[0][0],t[0][1]):function(n){return n===e||Pr(n,e,t)}}function Hr(e,t){return Co(e)&&xo(t)?To(Mo(e),t):function(n){var r=Ts(n,e);return r===i&&r===t?Rs(n,e):Nr(t,r,3)}}function Vr(e,t,n,r,o){e!==t&&yr(t,(function(a,s){if(o||(o=new Yn),es(a))!function(e,t,n,r,o,a,s){var l=_o(e,n),u=_o(t,n),c=s.get(u);if(c)return void er(e,n,c);var d=a?a(l,u,n+"",e,t,s):i,h=d===i;if(h){var f=za(u),p=!f&&Xa(u),v=!f&&!p&&us(u);d=u,f||p||v?za(l)?d=l:qa(l)?d=_i(l):p?(h=!1,d=Ei(u,!0)):v?(h=!1,d=xi(u,!0)):d=[]:is(u)||Wa(u)?(d=l,Wa(l)?d=ms(l):es(l)&&!Za(l)||(d=mo(u))):h=!1}h&&(s.set(u,d),o(d,u,r,a,s),s.delete(u));er(e,n,d)}(e,t,s,n,Vr,r,o);else{var l=r?r(_o(e,s),a,s+"",e,t,o):i;l===i&&(l=a),er(e,s,l)}}),Ns)}function Wr(e,t){var n=e.length;if(n)return wo(t+=t<0?n:0,n)?e[t]:i}function zr(e,t,n){t=t.length?It(t,(function(e){return za(e)?function(t){return Er(t,1===e.length?e[0]:e)}:e})):[rl];var r=-1;t=It(t,$t(lo()));var i=Br(e,(function(e,n,i){var o=It(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(i,(function(e,t){return function(e,t,n){var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;for(;++r<a;){var l=Ti(i[r],o[r]);if(l)return r>=s?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function Ur(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=Er(e,a);n(s,a)&&$r(o,wi(a,e),s)}return o}function Kr(e,t,n,r){var i=r?zt:Wt,o=-1,a=t.length,s=e;for(e===t&&(t=_i(t)),n&&(s=It(e,$t(n)));++o<a;)for(var l=0,u=t[o],c=n?n(u):u;(l=i(s,c,l,r))>-1;)s!==e&&Ye.call(s,l,1),Ye.call(e,l,1);return e}function qr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;wo(i)?Ye.call(e,i,1):di(e,i)}}return e}function Xr(e,t){return e+pt(Sn()*(t-e+1))}function Yr(e,t){var n="";if(!e||t<1||t>p)return n;do{t%2&&(n+=e),(t=pt(t/2))&&(e+=e)}while(t);return n}function Qr(e,t){return No(Ro(e,t,rl),e+"")}function Zr(e){return Zn(js(e))}function Jr(e,t){var n=js(e);return Io(n,sr(t,0,n.length))}function $r(e,t,n,r){if(!es(e))return e;for(var o=-1,a=(t=wi(t,e)).length,s=a-1,l=e;null!=l&&++o<a;){var u=Mo(t[o]),c=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(o!=s){var d=l[u];(c=r?r(d,u,l):i)===i&&(c=es(d)?d:wo(t[o+1])?[]:{})}tr(l,u,c),l=l[u]}return e}var ei=On?function(e,t){return On.set(e,t),e}:rl,ti=$e?function(e,t){return $e(e,"toString",{configurable:!0,enumerable:!1,value:el(t),writable:!0})}:rl;function ni(e){return Io(js(e))}function ri(e,t,r){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var a=n(o);++i<o;)a[i]=e[i+t];return a}function ii(e,t){var n;return hr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function oi(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t===t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!ls(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return ai(e,t,rl,n)}function ai(e,t,n,r){var o=0,a=null==e?0:e.length;if(0===a)return 0;for(var s=(t=n(t))!==t,l=null===t,u=ls(t),c=t===i;o<a;){var d=pt((o+a)/2),h=n(e[d]),f=h!==i,p=null===h,v=h===h,g=ls(h);if(s)var m=r||v;else m=c?v&&(r||f):l?v&&f&&(r||!p):u?v&&f&&!p&&(r||!g):!p&&!g&&(r?h<=t:h<t);m?o=d+1:a=d}return wn(a,4294967294)}function si(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!ja(s,l)){var l=s;o[i++]=0===a?0:a}}return o}function li(e){return"number"==typeof e?e:ls(e)?v:+e}function ui(e){if("string"==typeof e)return e;if(za(e))return It(e,ui)+"";if(ls(e))return Bn?Bn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ci(e,t,n){var r=-1,i=Pt,o=e.length,a=!0,s=[],l=s;if(n)a=!1,i=Ft;else if(o>=200){var u=t?null:Yi(e);if(u)return hn(u);a=!1,i=tn,l=new Xn}else l=t?[]:s;e:for(;++r<o;){var c=e[r],d=t?t(c):c;if(c=n||0!==c?c:0,a&&d===d){for(var h=l.length;h--;)if(l[h]===d)continue e;t&&l.push(d),s.push(c)}else i(l,d,n)||(l!==s&&l.push(d),s.push(c))}return s}function di(e,t){return null==(e=Ao(e,t=wi(t,e)))||delete e[Mo(Qo(t))]}function hi(e,t,n,r){return $r(e,t,n(Er(e,t)),r)}function fi(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ri(e,r?0:o,r?o+1:i):ri(e,r?o+1:0,r?i:o)}function pi(e,t){var n=e;return n instanceof zn&&(n=n.value()),Mt(t,(function(e,t){return t.func.apply(t.thisArg,Lt([e],t.args))}),n)}function vi(e,t,r){var i=e.length;if(i<2)return i?ci(e[0]):[];for(var o=-1,a=n(i);++o<i;)for(var s=e[o],l=-1;++l<i;)l!=o&&(a[o]=dr(a[o]||s,e[l],t,r));return ci(mr(a,1),t,r)}function gi(e,t,n){for(var r=-1,o=e.length,a=t.length,s={};++r<o;){var l=r<a?t[r]:i;n(s,e[r],l)}return s}function mi(e){return qa(e)?e:[]}function yi(e){return"function"==typeof e?e:rl}function wi(e,t){return za(e)?e:Co(e,t)?[e]:Lo(ys(e))}var bi=Qr;function Ci(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:ri(e,t,n)}var Si=nt||function(e){return vt.clearTimeout(e)};function Ei(e,t){if(t)return e.slice();var n=e.length,r=Ue?Ue(n):new e.constructor(n);return e.copy(r),r}function ki(e){var t=new e.constructor(e.byteLength);return new ze(t).set(new ze(e)),t}function xi(e,t){var n=t?ki(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ti(e,t){if(e!==t){var n=e!==i,r=null===e,o=e===e,a=ls(e),s=t!==i,l=null===t,u=t===t,c=ls(t);if(!l&&!c&&!a&&e>t||a&&s&&u&&!l&&!c||r&&s&&u||!n&&u||!o)return 1;if(!r&&!a&&!c&&e<t||c&&n&&o&&!r&&!a||l&&n&&o||!s&&o||!u)return-1}return 0}function Ri(e,t,r,i){for(var o=-1,a=e.length,s=r.length,l=-1,u=t.length,c=Xt(a-s,0),d=n(u+c),h=!i;++l<u;)d[l]=t[l];for(;++o<s;)(h||o<a)&&(d[r[o]]=e[o]);for(;c--;)d[l++]=e[o++];return d}function Ai(e,t,r,i){for(var o=-1,a=e.length,s=-1,l=r.length,u=-1,c=t.length,d=Xt(a-l,0),h=n(d+c),f=!i;++o<d;)h[o]=e[o];for(var p=o;++u<c;)h[p+u]=t[u];for(;++s<l;)(f||o<a)&&(h[p+r[s]]=e[o++]);return h}function _i(e,t){var r=-1,i=e.length;for(t||(t=n(i));++r<i;)t[r]=e[r];return t}function Oi(e,t,n,r){var o=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var l=t[a],u=r?r(n[l],e[l],l,n,e):i;u===i&&(u=e[l]),o?or(n,l,u):tr(n,l,u)}return n}function Di(e,t){return function(n,r){var i=za(n)?At:rr,o=t?t():{};return i(n,e,lo(r,2),o)}}function Ni(e){return Qr((function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:i,s=o>2?n[2]:i;for(a=e.length>3&&"function"==typeof a?(o--,a):i,s&&bo(n[0],n[1],s)&&(a=o<3?i:a,o=1),t=Te(t);++r<o;){var l=n[r];l&&e(t,l,r,a)}return t}))}function Pi(e,t){return function(n,r){if(null==n)return n;if(!Ka(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Te(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function Fi(e){return function(t,n,r){for(var i=-1,o=Te(t),a=r(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===n(o[l],l,o))break}return t}}function Ii(e){return function(t){var n=ln(t=ys(t))?vn(t):i,r=n?n[0]:t.charAt(0),o=n?Ci(n,1).join(""):t.slice(1);return r[e]()+o}}function Li(e){return function(t){return Mt(Zs(Ws(t).replace(et,"")),e,"")}}function Mi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Hn(e.prototype),r=e.apply(n,t);return es(r)?r:n}}function Gi(e){return function(t,n,r){var o=Te(t);if(!Ka(t)){var a=lo(n,3);t=Ds(t),n=function(e){return a(o[e],e,o)}}var s=e(t,n,r);return s>-1?o[a?t[s]:s]:i}}function Bi(e){return no((function(t){var n=t.length,r=n,a=Wn.prototype.thru;for(e&&t.reverse();r--;){var s=t[r];if("function"!=typeof s)throw new _e(o);if(a&&!l&&"wrapper"==ao(s))var l=new Wn([],!0)}for(r=l?r:n;++r<n;){var u=ao(s=t[r]),c="wrapper"==u?oo(s):i;l=c&&So(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?l[ao(c[0])].apply(l,c[3]):1==s.length&&So(s)?l[u]():l.thru(s)}return function(){var e=arguments,r=e[0];if(l&&1==e.length&&za(r))return l.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function ji(e,t,r,o,a,s,l,u,c,h){var f=t&d,p=1&t,v=2&t,g=24&t,m=512&t,y=v?i:Mi(e);return function d(){for(var w=arguments.length,b=n(w),C=w;C--;)b[C]=arguments[C];if(g)var S=so(d),E=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(b,S);if(o&&(b=Ri(b,o,a,g)),s&&(b=Ai(b,s,l,g)),w-=E,g&&w<h){var k=dn(b,S);return qi(e,t,ji,d.placeholder,r,b,k,u,c,h-w)}var x=p?r:this,T=v?x[e]:e;return w=b.length,u?b=function(e,t){var n=e.length,r=wn(t.length,n),o=_i(e);for(;r--;){var a=t[r];e[r]=wo(a,n)?o[a]:i}return e}(b,u):m&&w>1&&b.reverse(),f&&c<w&&(b.length=c),this&&this!==vt&&this instanceof d&&(T=y||Mi(T)),T.apply(x,b)}}function Hi(e,t){return function(n,r){return function(e,t,n,r){return br(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function Vi(e,t){return function(n,r){var o;if(n===i&&r===i)return t;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=ui(n),r=ui(r)):(n=li(n),r=li(r)),o=e(n,r)}return o}}function Wi(e){return no((function(t){return t=It(t,$t(lo())),Qr((function(n){var r=this;return e(t,(function(e){return Rt(e,r,n)}))}))}))}function zi(e,t){var n=(t=t===i?" ":ui(t)).length;if(n<2)return n?Yr(t,e):t;var r=Yr(t,ft(e/pn(t)));return ln(t)?Ci(vn(r),0,e).join(""):r.slice(0,e)}function Ui(e){return function(t,r,o){return o&&"number"!=typeof o&&bo(t,r,o)&&(r=o=i),t=fs(t),r===i?(r=t,t=0):r=fs(r),function(e,t,r,i){for(var o=-1,a=Xt(ft((t-e)/(r||1)),0),s=n(a);a--;)s[i?a:++o]=e,e+=r;return s}(t,r,o=o===i?t<r?1:-1:fs(o),e)}}function Ki(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=gs(t),n=gs(n)),e(t,n)}}function qi(e,t,n,r,o,a,s,l,d,h){var f=8&t;t|=f?u:c,4&(t&=~(f?c:u))||(t&=-4);var p=[e,t,o,f?a:i,f?s:i,f?i:a,f?i:s,l,d,h],v=n.apply(i,p);return So(e)&&Oo(v,p),v.placeholder=r,Po(v,e,t)}function Xi(e){var t=xe[e];return function(e,n){if(e=gs(e),(n=null==n?0:wn(ps(n),292))&&wt(e)){var r=(ys(e)+"e").split("e");return+((r=(ys(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Yi=Rn&&1/hn(new Rn([,-0]))[1]==f?function(e){return new Rn(e)}:ll;function Qi(e){return function(t){var n=vo(t);return n==x?un(t):n==O?fn(t):function(e,t){return It(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Zi(e,t,r,a,f,p,v,g){var m=2&t;if(!m&&"function"!=typeof e)throw new _e(o);var y=a?a.length:0;if(y||(t&=-97,a=f=i),v=v===i?v:Xt(ps(v),0),g=g===i?g:ps(g),y-=f?f.length:0,t&c){var w=a,b=f;a=f=i}var C=m?i:oo(e),S=[e,t,r,a,f,w,b,p,v,g];if(C&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=r==d&&8==n||r==d&&n==h&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var l=t[3];if(l){var u=e[3];e[3]=u?Ri(u,l,t[4]):l,e[4]=u?dn(e[3],s):t[4]}(l=t[5])&&(u=e[5],e[5]=u?Ai(u,l,t[6]):l,e[6]=u?dn(e[5],s):t[6]);(l=t[7])&&(e[7]=l);r&d&&(e[8]=null==e[8]?t[8]:wn(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(S,C),e=S[0],t=S[1],r=S[2],a=S[3],f=S[4],!(g=S[9]=S[9]===i?m?0:e.length:Xt(S[9]-y,0))&&24&t&&(t&=-25),t&&1!=t)E=8==t||t==l?function(e,t,r){var o=Mi(e);return function a(){for(var s=arguments.length,l=n(s),u=s,c=so(a);u--;)l[u]=arguments[u];var d=s<3&&l[0]!==c&&l[s-1]!==c?[]:dn(l,c);return(s-=d.length)<r?qi(e,t,ji,a.placeholder,i,l,d,i,i,r-s):Rt(this&&this!==vt&&this instanceof a?o:e,this,l)}}(e,t,g):t!=u&&33!=t||f.length?ji.apply(i,S):function(e,t,r,i){var o=1&t,a=Mi(e);return function t(){for(var s=-1,l=arguments.length,u=-1,c=i.length,d=n(c+l),h=this&&this!==vt&&this instanceof t?a:e;++u<c;)d[u]=i[u];for(;l--;)d[u++]=arguments[++s];return Rt(h,o?r:this,d)}}(e,t,r,a);else var E=function(e,t,n){var r=1&t,i=Mi(e);return function t(){return(this&&this!==vt&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,r);return Po((C?ei:Oo)(E,S),e,t)}function Ji(e,t,n,r){return e===i||ja(e,Ne[n])&&!Ie.call(r,n)?t:e}function $i(e,t,n,r,o,a){return es(e)&&es(t)&&(a.set(t,e),Vr(e,t,i,$i,a),a.delete(t)),e}function eo(e){return is(e)?i:e}function to(e,t,n,r,o,a){var s=1&n,l=e.length,u=t.length;if(l!=u&&!(s&&u>l))return!1;var c=a.get(e),d=a.get(t);if(c&&d)return c==t&&d==e;var h=-1,f=!0,p=2&n?new Xn:i;for(a.set(e,t),a.set(t,e);++h<l;){var v=e[h],g=t[h];if(r)var m=s?r(g,v,h,t,e,a):r(v,g,h,e,t,a);if(m!==i){if(m)continue;f=!1;break}if(p){if(!Bt(t,(function(e,t){if(!tn(p,t)&&(v===e||o(v,e,n,r,a)))return p.push(t)}))){f=!1;break}}else if(v!==g&&!o(v,g,n,r,a)){f=!1;break}}return a.delete(e),a.delete(t),f}function no(e){return No(Ro(e,i,Uo),e+"")}function ro(e){return kr(e,Ds,fo)}function io(e){return kr(e,Ns,po)}var oo=On?function(e){return On.get(e)}:ll;function ao(e){for(var t=e.name+"",n=Dn[t],r=Ie.call(Dn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function so(e){return(Ie.call(jn,"placeholder")?jn:e).placeholder}function lo(){var e=jn.iteratee||il;return e=e===il?Ir:e,arguments.length?e(arguments[0],arguments[1]):e}function uo(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function co(e){for(var t=Ds(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,xo(i)]}return t}function ho(e,t){var n=function(e,t){return null==e?i:e[t]}(e,t);return Fr(n)?n:i}var fo=gt?function(e){return null==e?[]:(e=Te(e),Nt(gt(e),(function(t){return Xe.call(e,t)})))}:vl,po=gt?function(e){for(var t=[];e;)Lt(t,fo(e)),e=Ke(e);return t}:vl,vo=xr;function go(e,t,n){for(var r=-1,i=(t=wi(t,e)).length,o=!1;++r<i;){var a=Mo(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&$a(i)&&wo(a,i)&&(za(e)||Wa(e))}function mo(e){return"function"!=typeof e.constructor||ko(e)?{}:Hn(Ke(e))}function yo(e){return za(e)||Wa(e)||!!(Qe&&e&&e[Qe])}function wo(e,t){var n=typeof e;return!!(t=null==t?p:t)&&("number"==n||"symbol"!=n&&be.test(e))&&e>-1&&e%1==0&&e<t}function bo(e,t,n){if(!es(n))return!1;var r=typeof t;return!!("number"==r?Ka(n)&&wo(t,n.length):"string"==r&&t in n)&&ja(n[t],e)}function Co(e,t){if(za(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ls(e))||(ne.test(e)||!te.test(e)||null!=t&&e in Te(t))}function So(e){var t=ao(e),n=jn[t];if("function"!=typeof n||!(t in zn.prototype))return!1;if(e===n)return!0;var r=oo(n);return!!r&&e===r[0]}(kn&&vo(new kn(new ArrayBuffer(1)))!=I||xn&&vo(new xn)!=x||Tn&&vo(Tn.resolve())!=A||Rn&&vo(new Rn)!=O||An&&vo(new An)!=P)&&(vo=function(e){var t=xr(e),n=t==R?e.constructor:i,r=n?Go(n):"";if(r)switch(r){case Nn:return I;case Pn:return x;case Fn:return A;case In:return O;case Ln:return P}return t});var Eo=Pe?Za:gl;function ko(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ne)}function xo(e){return e===e&&!es(e)}function To(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==i||e in Te(n)))}}function Ro(e,t,r){return t=Xt(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=Xt(i.length-t,0),s=n(a);++o<a;)s[o]=i[t+o];o=-1;for(var l=n(t+1);++o<t;)l[o]=i[o];return l[t]=r(s),Rt(e,this,l)}}function Ao(e,t){return t.length<2?e:Er(e,ri(t,0,-1))}function _o(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}var Oo=Fo(ei),Do=ct||function(e,t){return vt.setTimeout(e,t)},No=Fo(ti);function Po(e,t,n){var r=t+"";return No(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(le,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return _t(m,(function(n){var r="_."+n[0];t&n[1]&&!Pt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ue);return t?t[1].split(ce):[]}(r),n)))}function Fo(e){var t=0,n=0;return function(){var r=bn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Io(e,t){var n=-1,r=e.length,o=r-1;for(t=t===i?r:t;++n<t;){var a=Xr(n,o),s=e[a];e[a]=e[n],e[n]=s}return e.length=t,e}var Lo=function(e){var t=Fa(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(re,(function(e,n,r,i){t.push(r?i.replace(fe,"$1"):n||e)})),t}));function Mo(e){if("string"==typeof e||ls(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Go(e){if(null!=e){try{return Fe.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Bo(e){if(e instanceof zn)return e.clone();var t=new Wn(e.__wrapped__,e.__chain__);return t.__actions__=_i(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var jo=Qr((function(e,t){return qa(e)?dr(e,mr(t,1,qa,!0)):[]})),Ho=Qr((function(e,t){var n=Qo(t);return qa(n)&&(n=i),qa(e)?dr(e,mr(t,1,qa,!0),lo(n,2)):[]})),Vo=Qr((function(e,t){var n=Qo(t);return qa(n)&&(n=i),qa(e)?dr(e,mr(t,1,qa,!0),i,n):[]}));function Wo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ps(n);return i<0&&(i=Xt(r+i,0)),Vt(e,lo(t,3),i)}function zo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==i&&(o=ps(n),o=n<0?Xt(r+o,0):wn(o,r-1)),Vt(e,lo(t,3),o,!0)}function Uo(e){return(null==e?0:e.length)?mr(e,1):[]}function Ko(e){return e&&e.length?e[0]:i}var qo=Qr((function(e){var t=It(e,mi);return t.length&&t[0]===e[0]?_r(t):[]})),Xo=Qr((function(e){var t=Qo(e),n=It(e,mi);return t===Qo(n)?t=i:n.pop(),n.length&&n[0]===e[0]?_r(n,lo(t,2)):[]})),Yo=Qr((function(e){var t=Qo(e),n=It(e,mi);return(t="function"==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?_r(n,i,t):[]}));function Qo(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Zo=Qr(Jo);function Jo(e,t){return e&&e.length&&t&&t.length?Kr(e,t):e}var $o=no((function(e,t){var n=null==e?0:e.length,r=ar(e,t);return qr(e,It(t,(function(e){return wo(e,n)?+e:e})).sort(Ti)),r}));function ea(e){return null==e?e:En.call(e)}var ta=Qr((function(e){return ci(mr(e,1,qa,!0))})),na=Qr((function(e){var t=Qo(e);return qa(t)&&(t=i),ci(mr(e,1,qa,!0),lo(t,2))})),ra=Qr((function(e){var t=Qo(e);return t="function"==typeof t?t:i,ci(mr(e,1,qa,!0),i,t)}));function ia(e){if(!e||!e.length)return[];var t=0;return e=Nt(e,(function(e){if(qa(e))return t=Xt(e.length,t),!0})),Zt(t,(function(t){return It(e,qt(t))}))}function oa(e,t){if(!e||!e.length)return[];var n=ia(e);return null==t?n:It(n,(function(e){return Rt(t,i,e)}))}var aa=Qr((function(e,t){return qa(e)?dr(e,t):[]})),sa=Qr((function(e){return vi(Nt(e,qa))})),la=Qr((function(e){var t=Qo(e);return qa(t)&&(t=i),vi(Nt(e,qa),lo(t,2))})),ua=Qr((function(e){var t=Qo(e);return t="function"==typeof t?t:i,vi(Nt(e,qa),i,t)})),ca=Qr(ia);var da=Qr((function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,oa(e,n)}));function ha(e){var t=jn(e);return t.__chain__=!0,t}function fa(e,t){return t(e)}var pa=no((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return ar(t,e)};return!(t>1||this.__actions__.length)&&r instanceof zn&&wo(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:fa,args:[o],thisArg:i}),new Wn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(i),e}))):this.thru(o)}));var va=Di((function(e,t,n){Ie.call(e,n)?++e[n]:or(e,n,1)}));var ga=Gi(Wo),ma=Gi(zo);function ya(e,t){return(za(e)?_t:hr)(e,lo(t,3))}function wa(e,t){return(za(e)?Ot:fr)(e,lo(t,3))}var ba=Di((function(e,t,n){Ie.call(e,n)?e[n].push(t):or(e,n,[t])}));var Ca=Qr((function(e,t,r){var i=-1,o="function"==typeof t,a=Ka(e)?n(e.length):[];return hr(e,(function(e){a[++i]=o?Rt(t,e,r):Or(e,t,r)})),a})),Sa=Di((function(e,t,n){or(e,n,t)}));function Ea(e,t){return(za(e)?It:Br)(e,lo(t,3))}var ka=Di((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var xa=Qr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&bo(e,t[0],t[1])?t=[]:n>2&&bo(t[0],t[1],t[2])&&(t=[t[0]]),zr(e,mr(t,1),[])})),Ta=it||function(){return vt.Date.now()};function Ra(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,Zi(e,d,i,i,i,i,t)}function Aa(e,t){var n;if("function"!=typeof t)throw new _e(o);return e=ps(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var _a=Qr((function(e,t,n){var r=1;if(n.length){var i=dn(n,so(_a));r|=u}return Zi(e,r,t,n,i)})),Oa=Qr((function(e,t,n){var r=3;if(n.length){var i=dn(n,so(Oa));r|=u}return Zi(t,r,e,n,i)}));function Da(e,t,n){var r,a,s,l,u,c,d=0,h=!1,f=!1,p=!0;if("function"!=typeof e)throw new _e(o);function v(t){var n=r,o=a;return r=a=i,d=t,l=e.apply(o,n)}function g(e){var n=e-c;return c===i||n>=t||n<0||f&&e-d>=s}function m(){var e=Ta();if(g(e))return y(e);u=Do(m,function(e){var n=t-(e-c);return f?wn(n,s-(e-d)):n}(e))}function y(e){return u=i,p&&r?v(e):(r=a=i,l)}function w(){var e=Ta(),n=g(e);if(r=arguments,a=this,c=e,n){if(u===i)return function(e){return d=e,u=Do(m,t),h?v(e):l}(c);if(f)return Si(u),u=Do(m,t),v(c)}return u===i&&(u=Do(m,t)),l}return t=gs(t)||0,es(n)&&(h=!!n.leading,s=(f="maxWait"in n)?Xt(gs(n.maxWait)||0,t):s,p="trailing"in n?!!n.trailing:p),w.cancel=function(){u!==i&&Si(u),d=0,r=c=a=u=i},w.flush=function(){return u===i?l:y(Ta())},w}var Na=Qr((function(e,t){return cr(e,1,t)})),Pa=Qr((function(e,t,n){return cr(e,gs(t)||0,n)}));function Fa(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new _e(o);var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Fa.Cache||qn),n}function Ia(e){if("function"!=typeof e)throw new _e(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Fa.Cache=qn;var La=bi((function(e,t){var n=(t=1==t.length&&za(t[0])?It(t[0],$t(lo())):It(mr(t,1),$t(lo()))).length;return Qr((function(r){for(var i=-1,o=wn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return Rt(e,this,r)}))})),Ma=Qr((function(e,t){var n=dn(t,so(Ma));return Zi(e,u,i,t,n)})),Ga=Qr((function(e,t){var n=dn(t,so(Ga));return Zi(e,c,i,t,n)})),Ba=no((function(e,t){return Zi(e,h,i,i,i,t)}));function ja(e,t){return e===t||e!==e&&t!==t}var Ha=Ki(Tr),Va=Ki((function(e,t){return e>=t})),Wa=Dr(function(){return arguments}())?Dr:function(e){return ts(e)&&Ie.call(e,"callee")&&!Xe.call(e,"callee")},za=n.isArray,Ua=Ct?$t(Ct):function(e){return ts(e)&&xr(e)==F};function Ka(e){return null!=e&&$a(e.length)&&!Za(e)}function qa(e){return ts(e)&&Ka(e)}var Xa=mt||gl,Ya=St?$t(St):function(e){return ts(e)&&xr(e)==C};function Qa(e){if(!ts(e))return!1;var t=xr(e);return t==S||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!is(e)}function Za(e){if(!es(e))return!1;var t=xr(e);return t==E||t==k||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ja(e){return"number"==typeof e&&e==ps(e)}function $a(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=p}function es(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ts(e){return null!=e&&"object"==typeof e}var ns=Et?$t(Et):function(e){return ts(e)&&vo(e)==x};function rs(e){return"number"==typeof e||ts(e)&&xr(e)==T}function is(e){if(!ts(e)||xr(e)!=R)return!1;var t=Ke(e);if(null===t)return!0;var n=Ie.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Fe.call(n)==Be}var os=kt?$t(kt):function(e){return ts(e)&&xr(e)==_};var as=xt?$t(xt):function(e){return ts(e)&&vo(e)==O};function ss(e){return"string"==typeof e||!za(e)&&ts(e)&&xr(e)==D}function ls(e){return"symbol"==typeof e||ts(e)&&xr(e)==N}var us=Tt?$t(Tt):function(e){return ts(e)&&$a(e.length)&&!!lt[xr(e)]};var cs=Ki(Gr),ds=Ki((function(e,t){return e<=t}));function hs(e){if(!e)return[];if(Ka(e))return ss(e)?vn(e):_i(e);if(Ze&&e[Ze])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Ze]());var t=vo(e);return(t==x?un:t==O?hn:js)(e)}function fs(e){return e?(e=gs(e))===f||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}function ps(e){var t=fs(e),n=t%1;return t===t?n?t-n:t:0}function vs(e){return e?sr(ps(e),0,g):0}function gs(e){if("number"==typeof e)return e;if(ls(e))return v;if(es(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=es(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Jt(e);var n=me.test(e);return n||we.test(e)?ht(e.slice(2),n?2:8):ge.test(e)?v:+e}function ms(e){return Oi(e,Ns(e))}function ys(e){return null==e?"":ui(e)}var ws=Ni((function(e,t){if(ko(t)||Ka(t))Oi(t,Ds(t),e);else for(var n in t)Ie.call(t,n)&&tr(e,n,t[n])})),bs=Ni((function(e,t){Oi(t,Ns(t),e)})),Cs=Ni((function(e,t,n,r){Oi(t,Ns(t),e,r)})),Ss=Ni((function(e,t,n,r){Oi(t,Ds(t),e,r)})),Es=no(ar);var ks=Qr((function(e,t){e=Te(e);var n=-1,r=t.length,o=r>2?t[2]:i;for(o&&bo(t[0],t[1],o)&&(r=1);++n<r;)for(var a=t[n],s=Ns(a),l=-1,u=s.length;++l<u;){var c=s[l],d=e[c];(d===i||ja(d,Ne[c])&&!Ie.call(e,c))&&(e[c]=a[c])}return e})),xs=Qr((function(e){return e.push(i,$i),Rt(Fs,i,e)}));function Ts(e,t,n){var r=null==e?i:Er(e,t);return r===i?n:r}function Rs(e,t){return null!=e&&go(e,t,Ar)}var As=Hi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Ge.call(t)),e[t]=n}),el(rl)),_s=Hi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Ge.call(t)),Ie.call(e,t)?e[t].push(n):e[t]=[n]}),lo),Os=Qr(Or);function Ds(e){return Ka(e)?Qn(e):Lr(e)}function Ns(e){return Ka(e)?Qn(e,!0):Mr(e)}var Ps=Ni((function(e,t,n){Vr(e,t,n)})),Fs=Ni((function(e,t,n,r){Vr(e,t,n,r)})),Is=no((function(e,t){var n={};if(null==e)return n;var r=!1;t=It(t,(function(t){return t=wi(t,e),r||(r=t.length>1),t})),Oi(e,io(e),n),r&&(n=lr(n,7,eo));for(var i=t.length;i--;)di(n,t[i]);return n}));var Ls=no((function(e,t){return null==e?{}:function(e,t){return Ur(e,t,(function(t,n){return Rs(e,n)}))}(e,t)}));function Ms(e,t){if(null==e)return{};var n=It(io(e),(function(e){return[e]}));return t=lo(t),Ur(e,n,(function(e,n){return t(e,n[0])}))}var Gs=Qi(Ds),Bs=Qi(Ns);function js(e){return null==e?[]:en(e,Ds(e))}var Hs=Li((function(e,t,n){return t=t.toLowerCase(),e+(n?Vs(t):t)}));function Vs(e){return Qs(ys(e).toLowerCase())}function Ws(e){return(e=ys(e))&&e.replace(Ce,on).replace(tt,"")}var zs=Li((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Us=Li((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ks=Ii("toLowerCase");var qs=Li((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Xs=Li((function(e,t,n){return e+(n?" ":"")+Qs(t)}));var Ys=Li((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Qs=Ii("toUpperCase");function Zs(e,t,n){return e=ys(e),(t=n?i:t)===i?function(e){return ot.test(e)}(e)?function(e){return e.match(rt)||[]}(e):function(e){return e.match(de)||[]}(e):e.match(t)||[]}var Js=Qr((function(e,t){try{return Rt(e,i,t)}catch(n){return Qa(n)?n:new se(n)}})),$s=no((function(e,t){return _t(t,(function(t){t=Mo(t),or(e,t,_a(e[t],e))})),e}));function el(e){return function(){return e}}var tl=Bi(),nl=Bi(!0);function rl(e){return e}function il(e){return Ir("function"==typeof e?e:lr(e,1))}var ol=Qr((function(e,t){return function(n){return Or(n,e,t)}})),al=Qr((function(e,t){return function(n){return Or(e,n,t)}}));function sl(e,t,n){var r=Ds(t),i=Sr(t,r);null!=n||es(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=Sr(t,Ds(t)));var o=!(es(n)&&"chain"in n)||!!n.chain,a=Za(e);return _t(i,(function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=_i(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Lt([this.value()],arguments))})})),e}function ll(){}var ul=Wi(It),cl=Wi(Dt),dl=Wi(Bt);function hl(e){return Co(e)?qt(Mo(e)):function(e){return function(t){return Er(t,e)}}(e)}var fl=Ui(),pl=Ui(!0);function vl(){return[]}function gl(){return!1}var ml=Vi((function(e,t){return e+t}),0),yl=Xi("ceil"),wl=Vi((function(e,t){return e/t}),1),bl=Xi("floor");var Cl=Vi((function(e,t){return e*t}),1),Sl=Xi("round"),El=Vi((function(e,t){return e-t}),0);return jn.after=function(e,t){if("function"!=typeof t)throw new _e(o);return e=ps(e),function(){if(--e<1)return t.apply(this,arguments)}},jn.ary=Ra,jn.assign=ws,jn.assignIn=bs,jn.assignInWith=Cs,jn.assignWith=Ss,jn.at=Es,jn.before=Aa,jn.bind=_a,jn.bindAll=$s,jn.bindKey=Oa,jn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return za(e)?e:[e]},jn.chain=ha,jn.chunk=function(e,t,r){t=(r?bo(e,t,r):t===i)?1:Xt(ps(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var a=0,s=0,l=n(ft(o/t));a<o;)l[s++]=ri(e,a,a+=t);return l},jn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},jn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=n(e-1),r=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Lt(za(r)?_i(r):[r],mr(t,1))},jn.cond=function(e){var t=null==e?0:e.length,n=lo();return e=t?It(e,(function(e){if("function"!=typeof e[1])throw new _e(o);return[n(e[0]),e[1]]})):[],Qr((function(n){for(var r=-1;++r<t;){var i=e[r];if(Rt(i[0],this,n))return Rt(i[1],this,n)}}))},jn.conforms=function(e){return function(e){var t=Ds(e);return function(n){return ur(n,e,t)}}(lr(e,1))},jn.constant=el,jn.countBy=va,jn.create=function(e,t){var n=Hn(e);return null==t?n:ir(n,t)},jn.curry=function e(t,n,r){var o=Zi(t,8,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},jn.curryRight=function e(t,n,r){var o=Zi(t,l,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},jn.debounce=Da,jn.defaults=ks,jn.defaultsDeep=xs,jn.defer=Na,jn.delay=Pa,jn.difference=jo,jn.differenceBy=Ho,jn.differenceWith=Vo,jn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ri(e,(t=n||t===i?1:ps(t))<0?0:t,r):[]},jn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ri(e,0,(t=r-(t=n||t===i?1:ps(t)))<0?0:t):[]},jn.dropRightWhile=function(e,t){return e&&e.length?fi(e,lo(t,3),!0,!0):[]},jn.dropWhile=function(e,t){return e&&e.length?fi(e,lo(t,3),!0):[]},jn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&bo(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=ps(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:ps(r))<0&&(r+=o),r=n>r?0:vs(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},jn.filter=function(e,t){return(za(e)?Nt:gr)(e,lo(t,3))},jn.flatMap=function(e,t){return mr(Ea(e,t),1)},jn.flatMapDeep=function(e,t){return mr(Ea(e,t),f)},jn.flatMapDepth=function(e,t,n){return n=n===i?1:ps(n),mr(Ea(e,t),n)},jn.flatten=Uo,jn.flattenDeep=function(e){return(null==e?0:e.length)?mr(e,f):[]},jn.flattenDepth=function(e,t){return(null==e?0:e.length)?mr(e,t=t===i?1:ps(t)):[]},jn.flip=function(e){return Zi(e,512)},jn.flow=tl,jn.flowRight=nl,jn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},jn.functions=function(e){return null==e?[]:Sr(e,Ds(e))},jn.functionsIn=function(e){return null==e?[]:Sr(e,Ns(e))},jn.groupBy=ba,jn.initial=function(e){return(null==e?0:e.length)?ri(e,0,-1):[]},jn.intersection=qo,jn.intersectionBy=Xo,jn.intersectionWith=Yo,jn.invert=As,jn.invertBy=_s,jn.invokeMap=Ca,jn.iteratee=il,jn.keyBy=Sa,jn.keys=Ds,jn.keysIn=Ns,jn.map=Ea,jn.mapKeys=function(e,t){var n={};return t=lo(t,3),br(e,(function(e,r,i){or(n,t(e,r,i),e)})),n},jn.mapValues=function(e,t){var n={};return t=lo(t,3),br(e,(function(e,r,i){or(n,r,t(e,r,i))})),n},jn.matches=function(e){return jr(lr(e,1))},jn.matchesProperty=function(e,t){return Hr(e,lr(t,1))},jn.memoize=Fa,jn.merge=Ps,jn.mergeWith=Fs,jn.method=ol,jn.methodOf=al,jn.mixin=sl,jn.negate=Ia,jn.nthArg=function(e){return e=ps(e),Qr((function(t){return Wr(t,e)}))},jn.omit=Is,jn.omitBy=function(e,t){return Ms(e,Ia(lo(t)))},jn.once=function(e){return Aa(2,e)},jn.orderBy=function(e,t,n,r){return null==e?[]:(za(t)||(t=null==t?[]:[t]),za(n=r?i:n)||(n=null==n?[]:[n]),zr(e,t,n))},jn.over=ul,jn.overArgs=La,jn.overEvery=cl,jn.overSome=dl,jn.partial=Ma,jn.partialRight=Ga,jn.partition=ka,jn.pick=Ls,jn.pickBy=Ms,jn.property=hl,jn.propertyOf=function(e){return function(t){return null==e?i:Er(e,t)}},jn.pull=Zo,jn.pullAll=Jo,jn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Kr(e,t,lo(n,2)):e},jn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Kr(e,t,i,n):e},jn.pullAt=$o,jn.range=fl,jn.rangeRight=pl,jn.rearg=Ba,jn.reject=function(e,t){return(za(e)?Nt:gr)(e,Ia(lo(t,3)))},jn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=lo(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return qr(e,i),n},jn.rest=function(e,t){if("function"!=typeof e)throw new _e(o);return Qr(e,t=t===i?t:ps(t))},jn.reverse=ea,jn.sampleSize=function(e,t,n){return t=(n?bo(e,t,n):t===i)?1:ps(t),(za(e)?Jn:Jr)(e,t)},jn.set=function(e,t,n){return null==e?e:$r(e,t,n)},jn.setWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:$r(e,t,n,r)},jn.shuffle=function(e){return(za(e)?$n:ni)(e)},jn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&bo(e,t,n)?(t=0,n=r):(t=null==t?0:ps(t),n=n===i?r:ps(n)),ri(e,t,n)):[]},jn.sortBy=xa,jn.sortedUniq=function(e){return e&&e.length?si(e):[]},jn.sortedUniqBy=function(e,t){return e&&e.length?si(e,lo(t,2)):[]},jn.split=function(e,t,n){return n&&"number"!=typeof n&&bo(e,t,n)&&(t=n=i),(n=n===i?g:n>>>0)?(e=ys(e))&&("string"==typeof t||null!=t&&!os(t))&&!(t=ui(t))&&ln(e)?Ci(vn(e),0,n):e.split(t,n):[]},jn.spread=function(e,t){if("function"!=typeof e)throw new _e(o);return t=null==t?0:Xt(ps(t),0),Qr((function(n){var r=n[t],i=Ci(n,0,t);return r&&Lt(i,r),Rt(e,this,i)}))},jn.tail=function(e){var t=null==e?0:e.length;return t?ri(e,1,t):[]},jn.take=function(e,t,n){return e&&e.length?ri(e,0,(t=n||t===i?1:ps(t))<0?0:t):[]},jn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ri(e,(t=r-(t=n||t===i?1:ps(t)))<0?0:t,r):[]},jn.takeRightWhile=function(e,t){return e&&e.length?fi(e,lo(t,3),!1,!0):[]},jn.takeWhile=function(e,t){return e&&e.length?fi(e,lo(t,3)):[]},jn.tap=function(e,t){return t(e),e},jn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new _e(o);return es(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Da(e,t,{leading:r,maxWait:t,trailing:i})},jn.thru=fa,jn.toArray=hs,jn.toPairs=Gs,jn.toPairsIn=Bs,jn.toPath=function(e){return za(e)?It(e,Mo):ls(e)?[e]:_i(Lo(ys(e)))},jn.toPlainObject=ms,jn.transform=function(e,t,n){var r=za(e),i=r||Xa(e)||us(e);if(t=lo(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:es(e)&&Za(o)?Hn(Ke(e)):{}}return(i?_t:br)(e,(function(e,r,i){return t(n,e,r,i)})),n},jn.unary=function(e){return Ra(e,1)},jn.union=ta,jn.unionBy=na,jn.unionWith=ra,jn.uniq=function(e){return e&&e.length?ci(e):[]},jn.uniqBy=function(e,t){return e&&e.length?ci(e,lo(t,2)):[]},jn.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?ci(e,i,t):[]},jn.unset=function(e,t){return null==e||di(e,t)},jn.unzip=ia,jn.unzipWith=oa,jn.update=function(e,t,n){return null==e?e:hi(e,t,yi(n))},jn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:hi(e,t,yi(n),r)},jn.values=js,jn.valuesIn=function(e){return null==e?[]:en(e,Ns(e))},jn.without=aa,jn.words=Zs,jn.wrap=function(e,t){return Ma(yi(t),e)},jn.xor=sa,jn.xorBy=la,jn.xorWith=ua,jn.zip=ca,jn.zipObject=function(e,t){return gi(e||[],t||[],tr)},jn.zipObjectDeep=function(e,t){return gi(e||[],t||[],$r)},jn.zipWith=da,jn.entries=Gs,jn.entriesIn=Bs,jn.extend=bs,jn.extendWith=Cs,sl(jn,jn),jn.add=ml,jn.attempt=Js,jn.camelCase=Hs,jn.capitalize=Vs,jn.ceil=yl,jn.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=gs(n))===n?n:0),t!==i&&(t=(t=gs(t))===t?t:0),sr(gs(e),t,n)},jn.clone=function(e){return lr(e,4)},jn.cloneDeep=function(e){return lr(e,5)},jn.cloneDeepWith=function(e,t){return lr(e,5,t="function"==typeof t?t:i)},jn.cloneWith=function(e,t){return lr(e,4,t="function"==typeof t?t:i)},jn.conformsTo=function(e,t){return null==t||ur(e,t,Ds(t))},jn.deburr=Ws,jn.defaultTo=function(e,t){return null==e||e!==e?t:e},jn.divide=wl,jn.endsWith=function(e,t,n){e=ys(e),t=ui(t);var r=e.length,o=n=n===i?r:sr(ps(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},jn.eq=ja,jn.escape=function(e){return(e=ys(e))&&Z.test(e)?e.replace(Y,an):e},jn.escapeRegExp=function(e){return(e=ys(e))&&oe.test(e)?e.replace(ie,"\\$&"):e},jn.every=function(e,t,n){var r=za(e)?Dt:pr;return n&&bo(e,t,n)&&(t=i),r(e,lo(t,3))},jn.find=ga,jn.findIndex=Wo,jn.findKey=function(e,t){return Ht(e,lo(t,3),br)},jn.findLast=ma,jn.findLastIndex=zo,jn.findLastKey=function(e,t){return Ht(e,lo(t,3),Cr)},jn.floor=bl,jn.forEach=ya,jn.forEachRight=wa,jn.forIn=function(e,t){return null==e?e:yr(e,lo(t,3),Ns)},jn.forInRight=function(e,t){return null==e?e:wr(e,lo(t,3),Ns)},jn.forOwn=function(e,t){return e&&br(e,lo(t,3))},jn.forOwnRight=function(e,t){return e&&Cr(e,lo(t,3))},jn.get=Ts,jn.gt=Ha,jn.gte=Va,jn.has=function(e,t){return null!=e&&go(e,t,Rr)},jn.hasIn=Rs,jn.head=Ko,jn.identity=rl,jn.includes=function(e,t,n,r){e=Ka(e)?e:js(e),n=n&&!r?ps(n):0;var i=e.length;return n<0&&(n=Xt(i+n,0)),ss(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Wt(e,t,n)>-1},jn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ps(n);return i<0&&(i=Xt(r+i,0)),Wt(e,t,i)},jn.inRange=function(e,t,n){return t=fs(t),n===i?(n=t,t=0):n=fs(n),function(e,t,n){return e>=wn(t,n)&&e<Xt(t,n)}(e=gs(e),t,n)},jn.invoke=Os,jn.isArguments=Wa,jn.isArray=za,jn.isArrayBuffer=Ua,jn.isArrayLike=Ka,jn.isArrayLikeObject=qa,jn.isBoolean=function(e){return!0===e||!1===e||ts(e)&&xr(e)==b},jn.isBuffer=Xa,jn.isDate=Ya,jn.isElement=function(e){return ts(e)&&1===e.nodeType&&!is(e)},jn.isEmpty=function(e){if(null==e)return!0;if(Ka(e)&&(za(e)||"string"==typeof e||"function"==typeof e.splice||Xa(e)||us(e)||Wa(e)))return!e.length;var t=vo(e);if(t==x||t==O)return!e.size;if(ko(e))return!Lr(e).length;for(var n in e)if(Ie.call(e,n))return!1;return!0},jn.isEqual=function(e,t){return Nr(e,t)},jn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:i)?n(e,t):i;return r===i?Nr(e,t,i,n):!!r},jn.isError=Qa,jn.isFinite=function(e){return"number"==typeof e&&wt(e)},jn.isFunction=Za,jn.isInteger=Ja,jn.isLength=$a,jn.isMap=ns,jn.isMatch=function(e,t){return e===t||Pr(e,t,co(t))},jn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:i,Pr(e,t,co(t),n)},jn.isNaN=function(e){return rs(e)&&e!=+e},jn.isNative=function(e){if(Eo(e))throw new se("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Fr(e)},jn.isNil=function(e){return null==e},jn.isNull=function(e){return null===e},jn.isNumber=rs,jn.isObject=es,jn.isObjectLike=ts,jn.isPlainObject=is,jn.isRegExp=os,jn.isSafeInteger=function(e){return Ja(e)&&e>=-9007199254740991&&e<=p},jn.isSet=as,jn.isString=ss,jn.isSymbol=ls,jn.isTypedArray=us,jn.isUndefined=function(e){return e===i},jn.isWeakMap=function(e){return ts(e)&&vo(e)==P},jn.isWeakSet=function(e){return ts(e)&&"[object WeakSet]"==xr(e)},jn.join=function(e,t){return null==e?"":bt.call(e,t)},jn.kebabCase=zs,jn.last=Qo,jn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=ps(n))<0?Xt(r+o,0):wn(o,r-1)),t===t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Vt(e,Ut,o,!0)},jn.lowerCase=Us,jn.lowerFirst=Ks,jn.lt=cs,jn.lte=ds,jn.max=function(e){return e&&e.length?vr(e,rl,Tr):i},jn.maxBy=function(e,t){return e&&e.length?vr(e,lo(t,2),Tr):i},jn.mean=function(e){return Kt(e,rl)},jn.meanBy=function(e,t){return Kt(e,lo(t,2))},jn.min=function(e){return e&&e.length?vr(e,rl,Gr):i},jn.minBy=function(e,t){return e&&e.length?vr(e,lo(t,2),Gr):i},jn.stubArray=vl,jn.stubFalse=gl,jn.stubObject=function(){return{}},jn.stubString=function(){return""},jn.stubTrue=function(){return!0},jn.multiply=Cl,jn.nth=function(e,t){return e&&e.length?Wr(e,ps(t)):i},jn.noConflict=function(){return vt._===this&&(vt._=je),this},jn.noop=ll,jn.now=Ta,jn.pad=function(e,t,n){e=ys(e);var r=(t=ps(t))?pn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return zi(pt(i),n)+e+zi(ft(i),n)},jn.padEnd=function(e,t,n){e=ys(e);var r=(t=ps(t))?pn(e):0;return t&&r<t?e+zi(t-r,n):e},jn.padStart=function(e,t,n){e=ys(e);var r=(t=ps(t))?pn(e):0;return t&&r<t?zi(t-r,n)+e:e},jn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Cn(ys(e).replace(ae,""),t||0)},jn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&bo(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=fs(e),t===i?(t=e,e=0):t=fs(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=Sn();return wn(e+o*(t-e+dt("1e-"+((o+"").length-1))),t)}return Xr(e,t)},jn.reduce=function(e,t,n){var r=za(e)?Mt:Yt,i=arguments.length<3;return r(e,lo(t,4),n,i,hr)},jn.reduceRight=function(e,t,n){var r=za(e)?Gt:Yt,i=arguments.length<3;return r(e,lo(t,4),n,i,fr)},jn.repeat=function(e,t,n){return t=(n?bo(e,t,n):t===i)?1:ps(t),Yr(ys(e),t)},jn.replace=function(){var e=arguments,t=ys(e[0]);return e.length<3?t:t.replace(e[1],e[2])},jn.result=function(e,t,n){var r=-1,o=(t=wi(t,e)).length;for(o||(o=1,e=i);++r<o;){var a=null==e?i:e[Mo(t[r])];a===i&&(r=o,a=n),e=Za(a)?a.call(e):a}return e},jn.round=Sl,jn.runInContext=e,jn.sample=function(e){return(za(e)?Zn:Zr)(e)},jn.size=function(e){if(null==e)return 0;if(Ka(e))return ss(e)?pn(e):e.length;var t=vo(e);return t==x||t==O?e.size:Lr(e).length},jn.snakeCase=qs,jn.some=function(e,t,n){var r=za(e)?Bt:ii;return n&&bo(e,t,n)&&(t=i),r(e,lo(t,3))},jn.sortedIndex=function(e,t){return oi(e,t)},jn.sortedIndexBy=function(e,t,n){return ai(e,t,lo(n,2))},jn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=oi(e,t);if(r<n&&ja(e[r],t))return r}return-1},jn.sortedLastIndex=function(e,t){return oi(e,t,!0)},jn.sortedLastIndexBy=function(e,t,n){return ai(e,t,lo(n,2),!0)},jn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=oi(e,t,!0)-1;if(ja(e[n],t))return n}return-1},jn.startCase=Xs,jn.startsWith=function(e,t,n){return e=ys(e),n=null==n?0:sr(ps(n),0,e.length),t=ui(t),e.slice(n,n+t.length)==t},jn.subtract=El,jn.sum=function(e){return e&&e.length?Qt(e,rl):0},jn.sumBy=function(e,t){return e&&e.length?Qt(e,lo(t,2)):0},jn.template=function(e,t,n){var r=jn.templateSettings;n&&bo(e,t,n)&&(t=i),e=ys(e),t=Cs({},t,r,Ji);var o,a,s=Cs({},t.imports,r.imports,Ji),l=Ds(s),u=en(s,l),c=0,d=t.interpolate||Se,h="__p += '",f=Re((t.escape||Se).source+"|"+d.source+"|"+(d===ee?pe:Se).source+"|"+(t.evaluate||Se).source+"|$","g"),p="//# sourceURL="+(Ie.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++st+"]")+"\n";e.replace(f,(function(t,n,r,i,s,l){return r||(r=i),h+=e.slice(c,l).replace(Ee,sn),n&&(o=!0,h+="' +\n__e("+n+") +\n'"),s&&(a=!0,h+="';\n"+s+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=l+t.length,t})),h+="';\n";var v=Ie.call(t,"variable")&&t.variable;if(v){if(he.test(v))throw new se("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(a?h.replace(U,""):h).replace(K,"$1").replace(q,"$1;"),h="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g=Js((function(){return ke(l,p+"return "+h).apply(i,u)}));if(g.source=h,Qa(g))throw g;return g},jn.times=function(e,t){if((e=ps(e))<1||e>p)return[];var n=g,r=wn(e,g);t=lo(t),e-=g;for(var i=Zt(r,t);++n<e;)t(n);return i},jn.toFinite=fs,jn.toInteger=ps,jn.toLength=vs,jn.toLower=function(e){return ys(e).toLowerCase()},jn.toNumber=gs,jn.toSafeInteger=function(e){return e?sr(ps(e),-9007199254740991,p):0===e?e:0},jn.toString=ys,jn.toUpper=function(e){return ys(e).toUpperCase()},jn.trim=function(e,t,n){if((e=ys(e))&&(n||t===i))return Jt(e);if(!e||!(t=ui(t)))return e;var r=vn(e),o=vn(t);return Ci(r,nn(r,o),rn(r,o)+1).join("")},jn.trimEnd=function(e,t,n){if((e=ys(e))&&(n||t===i))return e.slice(0,gn(e)+1);if(!e||!(t=ui(t)))return e;var r=vn(e);return Ci(r,0,rn(r,vn(t))+1).join("")},jn.trimStart=function(e,t,n){if((e=ys(e))&&(n||t===i))return e.replace(ae,"");if(!e||!(t=ui(t)))return e;var r=vn(e);return Ci(r,nn(r,vn(t))).join("")},jn.truncate=function(e,t){var n=30,r="...";if(es(t)){var o="separator"in t?t.separator:o;n="length"in t?ps(t.length):n,r="omission"in t?ui(t.omission):r}var a=(e=ys(e)).length;if(ln(e)){var s=vn(e);a=s.length}if(n>=a)return e;var l=n-pn(r);if(l<1)return r;var u=s?Ci(s,0,l).join(""):e.slice(0,l);if(o===i)return u+r;if(s&&(l+=u.length-l),os(o)){if(e.slice(l).search(o)){var c,d=u;for(o.global||(o=Re(o.source,ys(ve.exec(o))+"g")),o.lastIndex=0;c=o.exec(d);)var h=c.index;u=u.slice(0,h===i?l:h)}}else if(e.indexOf(ui(o),l)!=l){var f=u.lastIndexOf(o);f>-1&&(u=u.slice(0,f))}return u+r},jn.unescape=function(e){return(e=ys(e))&&Q.test(e)?e.replace(X,mn):e},jn.uniqueId=function(e){var t=++Le;return ys(e)+t},jn.upperCase=Ys,jn.upperFirst=Qs,jn.each=ya,jn.eachRight=wa,jn.first=Ko,sl(jn,function(){var e={};return br(jn,(function(t,n){Ie.call(jn.prototype,n)||(e[n]=t)})),e}(),{chain:!1}),jn.VERSION="4.17.21",_t(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){jn[e].placeholder=jn})),_t(["drop","take"],(function(e,t){zn.prototype[e]=function(n){n=n===i?1:Xt(ps(n),0);var r=this.__filtered__&&!t?new zn(this):this.clone();return r.__filtered__?r.__takeCount__=wn(n,r.__takeCount__):r.__views__.push({size:wn(n,g),type:e+(r.__dir__<0?"Right":"")}),r},zn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),_t(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;zn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:lo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),_t(["head","last"],(function(e,t){var n="take"+(t?"Right":"");zn.prototype[e]=function(){return this[n](1).value()[0]}})),_t(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");zn.prototype[e]=function(){return this.__filtered__?new zn(this):this[n](1)}})),zn.prototype.compact=function(){return this.filter(rl)},zn.prototype.find=function(e){return this.filter(e).head()},zn.prototype.findLast=function(e){return this.reverse().find(e)},zn.prototype.invokeMap=Qr((function(e,t){return"function"==typeof e?new zn(this):this.map((function(n){return Or(n,e,t)}))})),zn.prototype.reject=function(e){return this.filter(Ia(lo(e)))},zn.prototype.slice=function(e,t){e=ps(e);var n=this;return n.__filtered__&&(e>0||t<0)?new zn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=ps(t))<0?n.dropRight(-t):n.take(t-e)),n)},zn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},zn.prototype.toArray=function(){return this.take(g)},br(zn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=jn[r?"take"+("last"==t?"Right":""):t],a=r||/^find/.test(t);o&&(jn.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,l=t instanceof zn,u=s[0],c=l||za(t),d=function(e){var t=o.apply(jn,Lt([e],s));return r&&h?t[0]:t};c&&n&&"function"==typeof u&&1!=u.length&&(l=c=!1);var h=this.__chain__,f=!!this.__actions__.length,p=a&&!h,v=l&&!f;if(!a&&c){t=v?t:new zn(this);var g=e.apply(t,s);return g.__actions__.push({func:fa,args:[d],thisArg:i}),new Wn(g,h)}return p&&v?e.apply(this,s):(g=this.thru(d),p?r?g.value()[0]:g.value():g)})})),_t(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Oe[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);jn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(za(i)?i:[],e)}return this[n]((function(n){return t.apply(za(n)?n:[],e)}))}})),br(zn.prototype,(function(e,t){var n=jn[t];if(n){var r=n.name+"";Ie.call(Dn,r)||(Dn[r]=[]),Dn[r].push({name:t,func:n})}})),Dn[ji(i,2).name]=[{name:"wrapper",func:i}],zn.prototype.clone=function(){var e=new zn(this.__wrapped__);return e.__actions__=_i(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=_i(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=_i(this.__views__),e},zn.prototype.reverse=function(){if(this.__filtered__){var e=new zn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},zn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=za(e),r=t<0,i=n?e.length:0,o=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=wn(t,e+a);break;case"takeRight":e=Xt(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,l=s-a,u=r?s:a-1,c=this.__iteratees__,d=c.length,h=0,f=wn(l,this.__takeCount__);if(!n||!r&&i==l&&f==l)return pi(e,this.__actions__);var p=[];e:for(;l--&&h<f;){for(var v=-1,g=e[u+=t];++v<d;){var m=c[v],y=m.iteratee,w=m.type,b=y(g);if(2==w)g=b;else if(!b){if(1==w)continue e;break e}}p[h++]=g}return p},jn.prototype.at=pa,jn.prototype.chain=function(){return ha(this)},jn.prototype.commit=function(){return new Wn(this.value(),this.__chain__)},jn.prototype.next=function(){this.__values__===i&&(this.__values__=hs(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},jn.prototype.plant=function(e){for(var t,n=this;n instanceof Vn;){var r=Bo(n);r.__index__=0,r.__values__=i,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},jn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof zn){var t=e;return this.__actions__.length&&(t=new zn(this)),(t=t.reverse()).__actions__.push({func:fa,args:[ea],thisArg:i}),new Wn(t,this.__chain__)}return this.thru(ea)},jn.prototype.toJSON=jn.prototype.valueOf=jn.prototype.value=function(){return pi(this.__wrapped__,this.__actions__)},jn.prototype.first=jn.prototype.head,Ze&&(jn.prototype[Ze]=function(){return this}),jn}();vt._=yn,(r=function(){return yn}.call(t,n,t,e))===i||(e.exports=r)}.call(this)},2034:function(e,t,n){var r=n(8950),i=n(6025),o=n(3849),a=n(3629);e.exports=function(e,t){return(a(e)?r:o)(e,i(t,3))}},9627:function(e,t,n){var r=n(3079),i=n(1954),o=n(2100);e.exports=function(e){return e&&e.length?r(e,o,i):void 0}},9151:function(e,t,n){var r=n(8059);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},9694:function(e){e.exports=function(){}},38:function(e,t,n){var r=n(9586),i=n(4084),o=n(5823),a=n(9793);e.exports=function(e){return o(e)?r(a(e)):i(e)}},4475:function(e,t,n){var r=n(8794)(n(566));e.exports=r},566:function(e,t,n){var r=n(2664);e.exports=function(e,t){return e&&e.length&&t&&t.length?r(e,t):e}},4617:function(e,t,n){var r=n(8950),i=n(2050),o=n(7125),a=n(8558),s=n(7038),l=n(6800),u=s((function(e,t){var n=null==e?0:e.length,s=i(e,t);return o(e,r(t,(function(e){return l(e,n)?+e:e})).sort(a)),s}));e.exports=u},5080:function(e,t,n){var r=n(2095),i=n(7927),o=n(6025),a=n(750),s=n(3629);e.exports=function(e,t,n){var l=s(e)?r:a,u=arguments.length<3;return l(e,o(t,4),n,u,i)}},4286:function(e,t,n){var r=n(5182),i=n(3226),o=n(8794),a=n(3195),s=o((function(e,t){if(null==e)return[];var n=t.length;return n>1&&a(e,t[0],t[1])?t=[]:n>2&&a(t[0],t[1],t[2])&&(t=[t[0]]),i(e,r(t,1),[])}));e.exports=s},8174:function(e){e.exports=function(){return[]}},9488:function(e){e.exports=function(){return!1}},1495:function(e,t,n){var r=n(2582),i=1/0;e.exports=function(e){return e?(e=r(e))===i||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}},9753:function(e,t,n){var r=n(1495);e.exports=function(e){var t=r(e),n=t%1;return t===t?n?t-n:t:0}},2582:function(e,t,n){var r=n(821),i=n(8092),o=n(152),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=s.test(e);return n||l.test(e)?u(e.slice(2),n?2:8):a.test(e)?NaN:+e}},3518:function(e,t,n){var r=n(2446);e.exports=function(e){return null==e?"":r(e)}},2064:function(e,t,n){var r=n(9602);e.exports=function(e){return e&&e.length?r(e):[]}},8006:function(e,t,n){var r=n(4903),i=n(8950),o=n(9586),a=n(6478),s=n(6279),l=Math.max;e.exports=function(e){if(!e||!e.length)return[];var t=0;return e=r(e,(function(e){if(s(e))return t=l(e.length,t),!0})),a(t,(function(t){return i(e,o(t))}))}},2063:function(e,t,n){var r=n(8019),i=n(2742);e.exports=function(e){return null==e?[]:r(e,i(e))}},981:function(e,t,n){var r=n(4903),i=n(8794),o=n(1126),a=n(6279),s=i((function(e){return o(r(e,a))}));e.exports=s},8042:function(e,t,n){var r=n(8794)(n(8006));e.exports=r},1025:function(e,t){var n,r,i;r=[],n=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},n=!t.document&&!!t.postMessage,r=t.IS_PAPA_WORKER||!1,i={},o=0,a={parse:function(n,r){var s=(r=r||{}).dynamicTyping||!1;if(C(s)&&(r.dynamicTypingFunction=s,s={}),r.dynamicTyping=s,r.transform=!!C(r.transform)&&r.transform,r.worker&&a.WORKERS_SUPPORTED){var l=function(){if(!a.WORKERS_SUPPORTED)return!1;var n,r,s=(n=t.URL||t.webkitURL||null,r=e.toString(),a.BLOB_URL||(a.BLOB_URL=n.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"})))),l=new t.Worker(s);return l.onmessage=g,l.id=o++,i[l.id]=l}();return l.userStep=r.step,l.userChunk=r.chunk,l.userComplete=r.complete,l.userError=r.error,r.step=C(r.step),r.chunk=C(r.chunk),r.complete=C(r.complete),r.error=C(r.error),delete r.worker,void l.postMessage({input:n,config:r,workerId:l.id})}var f=null;return a.NODE_STREAM_INPUT,"string"==typeof n?(n=function(e){return 65279===e.charCodeAt(0)?e.slice(1):e}(n),f=r.download?new u(r):new d(r)):!0===n.readable&&C(n.read)&&C(n.on)?f=new h(r):(t.File&&n instanceof File||n instanceof Object)&&(f=new c(r)),f.stream(n)},unparse:function(e,t){var n=!1,r=!0,i=",",o="\r\n",s='"',l=s+s,u=!1,c=null,d=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(i=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(u=t.skipEmptyLines),"string"==typeof t.newline&&(o=t.newline),"string"==typeof t.quoteChar&&(s=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");c=t.columns}void 0!==t.escapeChar&&(l=t.escapeChar+s),("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(d=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var h=new RegExp(p(s),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,u);if("object"==typeof e[0])return f(c||Object.keys(e[0]),e,u)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||c),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),f(e.fields||[],e.data||[],u);throw new Error("Unable to serialize unrecognized input");function f(e,t,n){var a="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var s=Array.isArray(e)&&0<e.length,l=!Array.isArray(t[0]);if(s&&r){for(var u=0;u<e.length;u++)0<u&&(a+=i),a+=v(e[u],u);0<t.length&&(a+=o)}for(var c=0;c<t.length;c++){var d=s?e.length:t[c].length,h=!1,f=s?0===Object.keys(t[c]).length:0===t[c].length;if(n&&!s&&(h="greedy"===n?""===t[c].join("").trim():1===t[c].length&&0===t[c][0].length),"greedy"===n&&s){for(var p=[],g=0;g<d;g++){var m=l?e[g]:g;p.push(t[c][m])}h=""===p.join("").trim()}if(!h){for(var y=0;y<d;y++){0<y&&!f&&(a+=i);var w=s&&l?e[y]:y;a+=v(t[c][w],y)}c<t.length-1&&(!n||0<d&&!f)&&(a+=o)}}return a}function v(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var r=!1;d&&"string"==typeof e&&d.test(e)&&(e="'"+e,r=!0);var o=e.toString().replace(h,l);return(r=r||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||function(e,t){for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1}(o,a.BAD_DELIMITERS)||-1<o.indexOf(i)||" "===o.charAt(0)||" "===o.charAt(o.length-1))?s+o+s:o}}};if(a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!n&&!!t.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=v,a.ParserHandle=f,a.NetworkStreamer=u,a.FileStreamer=c,a.StringStreamer=d,a.ReadableStreamStreamer=h,t.jQuery){var s=t.jQuery;s.fn.parse=function(e){var n=e.config||{},r=[];return this.each((function(e){if("INPUT"!==s(this).prop("tagName").toUpperCase()||"file"!==s(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)r.push({file:this.files[i],inputElem:this,instanceConfig:s.extend({},n)})})),i(),this;function i(){if(0!==r.length){var t,n,i,l,u=r[0];if(C(e.before)){var c=e.before(u.file,u.inputElem);if("object"==typeof c){if("abort"===c.action)return t="AbortError",n=u.file,i=u.inputElem,l=c.reason,void(C(e.error)&&e.error({name:t},n,i,l));if("skip"===c.action)return void o();"object"==typeof c.config&&(u.instanceConfig=s.extend(u.instanceConfig,c.config))}else if("skip"===c)return void o()}var d=u.instanceConfig.complete;u.instanceConfig.complete=function(e){C(d)&&d(e,u.file,u.inputElem),o()},a.parse(u.file,u.instanceConfig)}else C(e.complete)&&e.complete()}function o(){r.splice(0,1),i()}}}function l(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=w(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new f(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,n){if(this.isFirstChunk&&C(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(e);void 0!==i&&(e=i)}this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+e;this._partialLine="";var s=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var l=s.meta.cursor;this._finished||(this._partialLine=o.substring(l-this._baseIndex),this._baseIndex=l),s&&s.data&&(this._rowCount+=s.data.length);var u=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)t.postMessage({results:s,workerId:a.WORKER_ID,finished:u});else if(C(this._config.chunk)&&!n){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);s=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),this._completed||!u||!C(this._config.complete)||s&&s.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),u||s&&s.meta.paused||this._nextChunk(),s}this._halted=!0},this._sendError=function(e){C(this._config.error)?this._config.error(e):r&&this._config.error&&t.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function u(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),l.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),n||(t.onload=b(this._chunkLoaded,this),t.onerror=b(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var r in e)t.setRequestHeader(r,e[r])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+i)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}n&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var n=t.statusText||e;this._sendError(new Error(n))}}function c(e){var t,n;(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),l.call(this,e);var r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=b(this._chunkLoaded,this),t.onerror=b(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var i=Math.min(this._start+this._config.chunkSize,this._input.size);e=n.call(e,this._start,i)}var o=t.readAsText(e,this._config.encoding);r||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function d(e){var t;l.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,n=this._config.chunkSize;return n?(e=t.substring(0,n),t=t.substring(n)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function h(e){l.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=b((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=b((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=b((function(){this._streamCleanUp(),r=!0,this._streamData("")}),this),this._streamCleanUp=b((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function f(e){var t,n,r,i=Math.pow(2,53),o=-i,s=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,l=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,u=this,c=0,d=0,h=!1,f=!1,g=[],m={data:[],errors:[],meta:{}};if(C(e.step)){var y=e.step;e.step=function(t){if(m=t,E())S();else{if(S(),0===m.data.length)return;c+=t.data.length,e.preview&&c>e.preview?n.abort():(m.data=m.data[0],y(m,u))}}}function b(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function S(){return m&&r&&(x("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines&&(m.data=m.data.filter((function(e){return!b(e)}))),E()&&function(){if(m)if(Array.isArray(m.data[0])){for(var t=0;E()&&t<m.data.length;t++)m.data[t].forEach(n);m.data.splice(0,1)}else m.data.forEach(n);function n(t,n){C(e.transformHeader)&&(t=e.transformHeader(t,n)),g.push(t)}}(),function(){if(!m||!e.header&&!e.dynamicTyping&&!e.transform)return m;function t(t,n){var r,i=e.header?{}:[];for(r=0;r<t.length;r++){var o=r,a=t[r];e.header&&(o=r>=g.length?"__parsed_extra":g[r]),e.transform&&(a=e.transform(a,o)),a=k(o,a),"__parsed_extra"===o?(i[o]=i[o]||[],i[o].push(a)):i[o]=a}return e.header&&(r>g.length?x("FieldMismatch","TooManyFields","Too many fields: expected "+g.length+" fields but parsed "+r,d+n):r<g.length&&x("FieldMismatch","TooFewFields","Too few fields: expected "+g.length+" fields but parsed "+r,d+n)),i}var n=1;return!m.data.length||Array.isArray(m.data[0])?(m.data=m.data.map(t),n=m.data.length):m.data=t(m.data,0),e.header&&m.meta&&(m.meta.fields=g),d+=n,m}()}function E(){return e.header&&0===g.length}function k(t,n){return r=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[r]&&(e.dynamicTyping[r]=e.dynamicTypingFunction(r)),!0===(e.dynamicTyping[r]||e.dynamicTyping)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&(function(e){if(s.test(e)){var t=parseFloat(e);if(o<t&&t<i)return!0}return!1}(n)?parseFloat(n):l.test(n)?new Date(n):""===n?null:n):n;var r}function x(e,t,n,r){var i={type:e,code:t,message:n};void 0!==r&&(i.row=r),m.errors.push(i)}this.parse=function(i,o,s){var l=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var n=new RegExp(p(t)+"([^]*?)"+p(t),"gm"),r=(e=e.replace(n,"")).split("\r"),i=e.split("\n"),o=1<i.length&&i[0].length<r[0].length;if(1===r.length||o)return"\n";for(var a=0,s=0;s<r.length;s++)"\n"===r[s][0]&&a++;return a>=r.length/2?"\r\n":"\r"}(i,l)),r=!1,e.delimiter)C(e.delimiter)&&(e.delimiter=e.delimiter(i),m.meta.delimiter=e.delimiter);else{var u=function(t,n,r,i,o){var s,l,u,c;o=o||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var d=0;d<o.length;d++){var h=o[d],f=0,p=0,g=0;u=void 0;for(var m=new v({comments:i,delimiter:h,newline:n,preview:10}).parse(t),y=0;y<m.data.length;y++)if(r&&b(m.data[y]))g++;else{var w=m.data[y].length;p+=w,void 0!==u?0<w&&(f+=Math.abs(w-u),u=w):u=w}0<m.data.length&&(p/=m.data.length-g),(void 0===l||f<=l)&&(void 0===c||c<p)&&1.99<p&&(l=f,s=h,c=p)}return{successful:!!(e.delimiter=s),bestDelimiter:s}}(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);u.successful?e.delimiter=u.bestDelimiter:(r=!0,e.delimiter=a.DefaultDelimiter),m.meta.delimiter=e.delimiter}var c=w(e);return e.preview&&e.header&&c.preview++,t=i,n=new v(c),m=n.parse(t,o,s),S(),h?{meta:{paused:!0}}:m||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,n.abort(),t=C(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){u.streamer._halted?(h=!1,u.streamer.parseChunk(t,!0)):setTimeout(u.resume,3)},this.aborted=function(){return f},this.abort=function(){f=!0,n.abort(),m.meta.aborted=!0,C(e.complete)&&e.complete(m),t=""}}function p(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(e){var t,n=(e=e||{}).delimiter,r=e.newline,i=e.comments,o=e.step,s=e.preview,l=e.fastMode,u=t=void 0===e.quoteChar||null===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(u=e.escapeChar),("string"!=typeof n||-1<a.BAD_DELIMITERS.indexOf(n))&&(n=","),i===n)throw new Error("Comment character same as delimiter");!0===i?i="#":("string"!=typeof i||-1<a.BAD_DELIMITERS.indexOf(i))&&(i=!1),"\n"!==r&&"\r"!==r&&"\r\n"!==r&&(r="\n");var c=0,d=!1;this.parse=function(a,h,f){if("string"!=typeof a)throw new Error("Input must be a string");var v=a.length,g=n.length,m=r.length,y=i.length,w=C(o),b=[],S=[],E=[],k=c=0;if(!a)return K();if(e.header&&!h){var x=a.split(r)[0].split(n),T=[],R={},A=!1;for(var _ in x){var O=x[_];C(e.transformHeader)&&(O=e.transformHeader(O,_));var D=O,N=R[O]||0;for(0<N&&(A=!0,D=O+"_"+N),R[O]=N+1;T.includes(D);)D=D+"_"+N;T.push(D)}if(A){var P=a.split(r);P[0]=T.join(n),a=P.join(r)}}if(l||!1!==l&&-1===a.indexOf(t)){for(var F=a.split(r),I=0;I<F.length;I++){if(E=F[I],c+=E.length,I!==F.length-1)c+=r.length;else if(f)return K();if(!i||E.substring(0,y)!==i){if(w){if(b=[],V(E.split(n)),q(),d)return K()}else V(E.split(n));if(s&&s<=I)return b=b.slice(0,s),K(!0)}}return K()}for(var L=a.indexOf(n,c),M=a.indexOf(r,c),G=new RegExp(p(u)+p(t),"g"),B=a.indexOf(t,c);;)if(a[c]!==t)if(i&&0===E.length&&a.substring(c,c+y)===i){if(-1===M)return K();c=M+m,M=a.indexOf(r,c),L=a.indexOf(n,c)}else if(-1!==L&&(L<M||-1===M))E.push(a.substring(c,L)),c=L+g,L=a.indexOf(n,c);else{if(-1===M)break;if(E.push(a.substring(c,M)),U(M+m),w&&(q(),d))return K();if(s&&b.length>=s)return K(!0)}else for(B=c,c++;;){if(-1===(B=a.indexOf(t,B+1)))return f||S.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:c}),z();if(B===v-1)return z(a.substring(c,B).replace(G,t));if(t!==u||a[B+1]!==u){if(t===u||0===B||a[B-1]!==u){-1!==L&&L<B+1&&(L=a.indexOf(n,B+1)),-1!==M&&M<B+1&&(M=a.indexOf(r,B+1));var j=W(-1===M?L:Math.min(L,M));if(a.substr(B+1+j,g)===n){E.push(a.substring(c,B).replace(G,t)),a[c=B+1+j+g]!==t&&(B=a.indexOf(t,c)),L=a.indexOf(n,c),M=a.indexOf(r,c);break}var H=W(M);if(a.substring(B+1+H,B+1+H+m)===r){if(E.push(a.substring(c,B).replace(G,t)),U(B+1+H+m),L=a.indexOf(n,c),B=a.indexOf(t,c),w&&(q(),d))return K();if(s&&b.length>=s)return K(!0);break}S.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:c}),B++}}else B++}return z();function V(e){b.push(e),k=c}function W(e){var t=0;if(-1!==e){var n=a.substring(B+1,e);n&&""===n.trim()&&(t=n.length)}return t}function z(e){return f||(void 0===e&&(e=a.substring(c)),E.push(e),c=v,V(E),w&&q()),K()}function U(e){c=e,V(E),E=[],M=a.indexOf(r,c)}function K(e){return{data:b,errors:S,meta:{delimiter:n,linebreak:r,aborted:d,truncated:!!e,cursor:k+(h||0)}}}function q(){o(K()),b=[],S=[]}},this.abort=function(){d=!0},this.getCharIndex=function(){return c}}function g(e){var t=e.data,n=i[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var o={abort:function(){r=!0,m(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(C(n.userStep)){for(var a=0;a<t.results.data.length&&(n.userStep({data:t.results.data[a],errors:t.results.errors,meta:t.results.meta},o),!r);a++);delete t.results}else C(n.userChunk)&&(n.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!r&&m(t.workerId,t.results)}function m(e,t){var n=i[e];C(n.userComplete)&&n.userComplete(t),n.terminate(),delete i[e]}function y(){throw new Error("Not implemented.")}function w(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var n in e)t[n]=w(e[n]);return t}function b(e,t){return function(){e.apply(t,arguments)}}function C(e){return"function"==typeof e}return r&&(t.onmessage=function(e){var n=e.data;if(void 0===a.WORKER_ID&&n&&(a.WORKER_ID=n.workerId),"string"==typeof n.input)t.postMessage({workerId:a.WORKER_ID,results:a.parse(n.input,n.config),finished:!0});else if(t.File&&n.input instanceof File||n.input instanceof Object){var r=a.parse(n.input,n.config);r&&t.postMessage({workerId:a.WORKER_ID,results:r,finished:!0})}}),(u.prototype=Object.create(l.prototype)).constructor=u,(c.prototype=Object.create(l.prototype)).constructor=c,(d.prototype=Object.create(d.prototype)).constructor=d,(h.prototype=Object.create(l.prototype)).constructor=h,a},void 0===(i="function"===typeof n?n.apply(t,r):n)||(e.exports=i)},888:function(e,t,n){"use strict";var r=n(9047);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},2007:function(e,t,n){e.exports=n(888)()},9047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},1071:function(e,t,n){"use strict";var r=n(2791);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=Object.prototype.hasOwnProperty,a=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,s={},l={};function u(e){return!!o.call(l,e)||!o.call(s,e)&&(a.test(e)?l[e]=!0:(s[e]=!0,!1))}function c(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var d={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){d[e]=new c(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];d[t]=new c(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){d[e]=new c(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){d[e]=new c(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){d[e]=new c(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){d[e]=new c(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){d[e]=new c(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){d[e]=new c(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){d[e]=new c(e,5,!1,e.toLowerCase(),null,!1,!1)}));var h=/[\-:]([a-z])/g;function f(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(h,f);d[t]=new c(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(h,f);d[t]=new c(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(h,f);d[t]=new c(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){d[e]=new c(e,1,!1,e.toLowerCase(),null,!1,!1)})),d.xlinkHref=new c("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){d[e]=new c(e,1,!1,e.toLowerCase(),null,!0,!0)}));var p={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},v=["Webkit","ms","Moz","O"];Object.keys(p).forEach((function(e){v.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),p[t]=p[e]}))}));var g=/["'&<>]/;function m(e){if("boolean"===typeof e||"number"===typeof e)return""+e;e=""+e;var t=g.exec(e);if(t){var n,r="",i=0;for(n=t.index;n<e.length;n++){switch(e.charCodeAt(n)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}i!==n&&(r+=e.substring(i,n)),i=n+1,r+=t}e=i!==n?r+e.substring(i,n):r}return e}var y=/([A-Z])/g,w=/^ms-/,b=Array.isArray;function C(e,t){return{insertionMode:e,selectedValue:t}}var S=new Map;function E(e,t,n){if("object"!==typeof n)throw Error(i(62));for(var r in t=!0,n)if(o.call(n,r)){var a=n[r];if(null!=a&&"boolean"!==typeof a&&""!==a){if(0===r.indexOf("--")){var s=m(r);a=m((""+a).trim())}else{s=r;var l=S.get(s);void 0!==l||(l=m(s.replace(y,"-$1").toLowerCase().replace(w,"-ms-")),S.set(s,l)),s=l,a="number"===typeof a?0===a||o.call(p,r)?""+a:a+"px":m((""+a).trim())}t?(t=!1,e.push(' style="',s,":",a)):e.push(";",s,":",a)}}t||e.push('"')}function k(e,t,n,r){switch(n){case"style":return void E(e,t,r);case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])if(null!==(t=d.hasOwnProperty(n)?d[n]:null)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(n=t.attributeName,t.type){case 3:r&&e.push(" ",n,'=""');break;case 4:!0===r?e.push(" ",n,'=""'):!1!==r&&e.push(" ",n,'="',m(r),'"');break;case 5:isNaN(r)||e.push(" ",n,'="',m(r),'"');break;case 6:!isNaN(r)&&1<=r&&e.push(" ",n,'="',m(r),'"');break;default:t.sanitizeURL&&(r=""+r),e.push(" ",n,'="',m(r),'"')}}else if(u(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if("data-"!==(t=n.toLowerCase().slice(0,5))&&"aria-"!==t)return}e.push(" ",n,'="',m(r),'"')}}function x(e,t,n){if(null!=t){if(null!=n)throw Error(i(60));if("object"!==typeof t||!("__html"in t))throw Error(i(61));null!==(t=t.__html)&&void 0!==t&&e.push(""+t)}}function T(e,t,n,r){e.push(_(n));var i,a=n=null;for(i in t)if(o.call(t,i)){var s=t[i];if(null!=s)switch(i){case"children":n=s;break;case"dangerouslySetInnerHTML":a=s;break;default:k(e,r,i,s)}}return e.push(">"),x(e,a,n),"string"===typeof n?(e.push(m(n)),null):n}var R=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,A=new Map;function _(e){var t=A.get(e);if(void 0===t){if(!R.test(e))throw Error(i(65,e));t="<"+e,A.set(e,t)}return t}function O(e,t,n,a,s){switch(t){case"select":e.push(_("select"));var l=null,c=null;for(p in n)if(o.call(n,p)){var d=n[p];if(null!=d)switch(p){case"children":l=d;break;case"dangerouslySetInnerHTML":c=d;break;case"defaultValue":case"value":break;default:k(e,a,p,d)}}return e.push(">"),x(e,c,l),l;case"option":c=s.selectedValue,e.push(_("option"));var h=d=null,f=null,p=null;for(l in n)if(o.call(n,l)){var v=n[l];if(null!=v)switch(l){case"children":d=v;break;case"selected":f=v;break;case"dangerouslySetInnerHTML":p=v;break;case"value":h=v;default:k(e,a,l,v)}}if(null!=c)if(n=null!==h?""+h:function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(d),b(c)){for(a=0;a<c.length;a++)if(""+c[a]===n){e.push(' selected=""');break}}else""+c===n&&e.push(' selected=""');else f&&e.push(' selected=""');return e.push(">"),x(e,p,d),d;case"textarea":for(d in e.push(_("textarea")),p=c=l=null,n)if(o.call(n,d)&&null!=(h=n[d]))switch(d){case"children":p=h;break;case"value":l=h;break;case"defaultValue":c=h;break;case"dangerouslySetInnerHTML":throw Error(i(91));default:k(e,a,d,h)}if(null===l&&null!==c&&(l=c),e.push(">"),null!=p){if(null!=l)throw Error(i(92));if(b(p)&&1<p.length)throw Error(i(93));l=""+p}return"string"===typeof l&&"\n"===l[0]&&e.push("\n"),null!==l&&e.push(m(""+l)),null;case"input":for(c in e.push(_("input")),h=p=d=l=null,n)if(o.call(n,c)&&null!=(f=n[c]))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(i(399,"input"));case"defaultChecked":h=f;break;case"defaultValue":d=f;break;case"checked":p=f;break;case"value":l=f;break;default:k(e,a,c,f)}return null!==p?k(e,a,"checked",p):null!==h&&k(e,a,"checked",h),null!==l?k(e,a,"value",l):null!==d&&k(e,a,"value",d),e.push("/>"),null;case"menuitem":for(var g in e.push(_("menuitem")),n)if(o.call(n,g)&&null!=(l=n[g]))switch(g){case"children":case"dangerouslySetInnerHTML":throw Error(i(400));default:k(e,a,g,l)}return e.push(">"),null;case"title":for(v in e.push(_("title")),l=null,n)if(o.call(n,v)&&null!=(c=n[v]))switch(v){case"children":l=c;break;case"dangerouslySetInnerHTML":throw Error(i(434));default:k(e,a,v,c)}return e.push(">"),l;case"listing":case"pre":for(h in e.push(_(t)),c=l=null,n)if(o.call(n,h)&&null!=(d=n[h]))switch(h){case"children":l=d;break;case"dangerouslySetInnerHTML":c=d;break;default:k(e,a,h,d)}if(e.push(">"),null!=c){if(null!=l)throw Error(i(60));if("object"!==typeof c||!("__html"in c))throw Error(i(61));null!==(n=c.__html)&&void 0!==n&&("string"===typeof n&&0<n.length&&"\n"===n[0]?e.push("\n",n):e.push(""+n))}return"string"===typeof l&&"\n"===l[0]&&e.push("\n"),l;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":for(var y in e.push(_(t)),n)if(o.call(n,y)&&null!=(l=n[y]))switch(y){case"children":case"dangerouslySetInnerHTML":throw Error(i(399,t));default:k(e,a,y,l)}return e.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return T(e,n,t,a);case"html":return 0===s.insertionMode&&e.push("<!DOCTYPE html>"),T(e,n,t,a);default:if(-1===t.indexOf("-")&&"string"!==typeof n.is)return T(e,n,t,a);for(f in e.push(_(t)),c=l=null,n)if(o.call(n,f)&&null!=(d=n[f]))switch(f){case"children":l=d;break;case"dangerouslySetInnerHTML":c=d;break;case"style":E(e,a,d);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:u(f)&&"function"!==typeof d&&"symbol"!==typeof d&&e.push(" ",f,'="',m(d),'"')}return e.push(">"),x(e,c,l),l}}function D(e,t,n){if(e.push('\x3c!--$?--\x3e<template id="'),null===n)throw Error(i(395));return e.push(n),e.push('"></template>')}var N=/[<\u2028\u2029]/g;function P(e){return JSON.stringify(e).replace(N,(function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}}))}function F(e,t,n,r){return n.generateStaticMarkup?(e.push(m(t)),!1):(""===t?e=r:(r&&e.push("\x3c!-- --\x3e"),e.push(m(t)),e=!0),e)}var I=Object.assign,L=Symbol.for("react.element"),M=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),H=Symbol.for("react.provider"),V=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),K=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),X=Symbol.for("react.scope"),Y=Symbol.for("react.debug_trace_mode"),Q=Symbol.for("react.legacy_hidden"),Z=Symbol.for("react.default_value"),J=Symbol.iterator;function $(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case G:return"Fragment";case M:return"Portal";case j:return"Profiler";case B:return"StrictMode";case z:return"Suspense";case U:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case V:return(e.displayName||"Context")+".Consumer";case H:return(e._context.displayName||"Context")+".Provider";case W:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case K:return null!==(t=e.displayName||null)?t:$(e.type)||"Memo";case q:t=e._payload,e=e._init;try{return $(e(t))}catch(n){}}return null}var ee={};function te(e,t){if(!(e=e.contextTypes))return ee;var n,r={};for(n in e)r[n]=t[n];return r}var ne=null;function re(e,t){if(e!==t){e.context._currentValue2=e.parentValue,e=e.parent;var n=t.parent;if(null===e){if(null!==n)throw Error(i(401))}else{if(null===n)throw Error(i(401));re(e,n)}t.context._currentValue2=t.value}}function ie(e){e.context._currentValue2=e.parentValue,null!==(e=e.parent)&&ie(e)}function oe(e){var t=e.parent;null!==t&&oe(t),e.context._currentValue2=e.value}function ae(e,t){if(e.context._currentValue2=e.parentValue,null===(e=e.parent))throw Error(i(402));e.depth===t.depth?re(e,t):ae(e,t)}function se(e,t){var n=t.parent;if(null===n)throw Error(i(402));e.depth===n.depth?re(e,n):se(e,n),t.context._currentValue2=t.value}function le(e){var t=ne;t!==e&&(null===t?oe(e):null===e?ie(t):t.depth===e.depth?re(t,e):t.depth>e.depth?ae(t,e):se(t,e),ne=e)}var ue={isMounted:function(){return!1},enqueueSetState:function(e,t){null!==(e=e._reactInternals).queue&&e.queue.push(t)},enqueueReplaceState:function(e,t){(e=e._reactInternals).replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function ce(e,t,n,r){var i=void 0!==e.state?e.state:null;e.updater=ue,e.props=n,e.state=i;var o={queue:[],replace:!1};e._reactInternals=o;var a=t.contextType;if(e.context="object"===typeof a&&null!==a?a._currentValue2:r,"function"===typeof(a=t.getDerivedStateFromProps)&&(i=null===(a=a(n,i))||void 0===a?i:I({},i,a),e.state=i),"function"!==typeof t.getDerivedStateFromProps&&"function"!==typeof e.getSnapshotBeforeUpdate&&("function"===typeof e.UNSAFE_componentWillMount||"function"===typeof e.componentWillMount))if(t=e.state,"function"===typeof e.componentWillMount&&e.componentWillMount(),"function"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),t!==e.state&&ue.enqueueReplaceState(e,e.state,null),null!==o.queue&&0<o.queue.length)if(t=o.queue,a=o.replace,o.queue=null,o.replace=!1,a&&1===t.length)e.state=t[0];else{for(o=a?t[0]:e.state,i=!0,a=a?1:0;a<t.length;a++){var s=t[a];null!=(s="function"===typeof s?s.call(e,o,n,r):s)&&(i?(i=!1,o=I({},o,s)):I(o,s))}e.state=o}else o.queue=null}var de={id:1,overflow:""};function he(e,t,n){var r=e.id;e=e.overflow;var i=32-fe(r)-1;r&=~(1<<i),n+=1;var o=32-fe(t)+i;if(30<o){var a=i-i%5;return o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,{id:1<<32-fe(t)+i|n<<i|r,overflow:o+e}}return{id:1<<o|n<<i|r,overflow:e}}var fe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(pe(e)/ve|0)|0},pe=Math.log,ve=Math.LN2;var ge="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},me=null,ye=null,we=null,be=null,Ce=!1,Se=!1,Ee=0,ke=null,xe=0;function Te(){if(null===me)throw Error(i(321));return me}function Re(){if(0<xe)throw Error(i(312));return{memoizedState:null,queue:null,next:null}}function Ae(){return null===be?null===we?(Ce=!1,we=be=Re()):(Ce=!0,be=we):null===be.next?(Ce=!1,be=be.next=Re()):(Ce=!0,be=be.next),be}function _e(){ye=me=null,Se=!1,we=null,xe=0,be=ke=null}function Oe(e,t){return"function"===typeof t?t(e):t}function De(e,t,n){if(me=Te(),be=Ae(),Ce){var r=be.queue;if(t=r.dispatch,null!==ke&&void 0!==(n=ke.get(r))){ke.delete(r),r=be.memoizedState;do{r=e(r,n.action),n=n.next}while(null!==n);return be.memoizedState=r,[r,t]}return[be.memoizedState,t]}return e=e===Oe?"function"===typeof t?t():t:void 0!==n?n(t):t,be.memoizedState=e,e=(e=be.queue={last:null,dispatch:null}).dispatch=Pe.bind(null,me,e),[be.memoizedState,e]}function Ne(e,t){if(me=Te(),t=void 0===t?null:t,null!==(be=Ae())){var n=be.memoizedState;if(null!==n&&null!==t){var r=n[1];e:if(null===r)r=!1;else{for(var i=0;i<r.length&&i<t.length;i++)if(!ge(t[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return e=e(),be.memoizedState=[e,t],e}function Pe(e,t,n){if(25<=xe)throw Error(i(301));if(e===me)if(Se=!0,e={action:n,next:null},null===ke&&(ke=new Map),void 0===(n=ke.get(t)))ke.set(t,e);else{for(t=n;null!==t.next;)t=t.next;t.next=e}}function Fe(){throw Error(i(394))}function Ie(){}var Le={readContext:function(e){return e._currentValue2},useContext:function(e){return Te(),e._currentValue2},useMemo:Ne,useReducer:De,useRef:function(e){me=Te();var t=(be=Ae()).memoizedState;return null===t?(e={current:e},be.memoizedState=e):t},useState:function(e){return De(Oe,e)},useInsertionEffect:Ie,useLayoutEffect:function(){},useCallback:function(e,t){return Ne((function(){return e}),t)},useImperativeHandle:Ie,useEffect:Ie,useDebugValue:Ie,useDeferredValue:function(e){return Te(),e},useTransition:function(){return Te(),[!1,Fe]},useId:function(){var e=ye.treeContext,t=e.overflow;e=((e=e.id)&~(1<<32-fe(e)-1)).toString(32)+t;var n=Me;if(null===n)throw Error(i(404));return t=Ee++,e=":"+n.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return Te(),t(e._source)},useSyncExternalStore:function(e,t,n){if(void 0===n)throw Error(i(407));return n()}},Me=null,Ge=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Be(e){return console.error(e),null}function je(){}function He(e,t,n,r,i,o,a,s){e.allPendingTasks++,null===n?e.pendingRootTasks++:n.pendingTasks++;var l={node:t,ping:function(){var t=e.pingedTasks;t.push(l),1===t.length&&nt(e)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:a,treeContext:s};return i.add(l),l}function Ve(e,t,n,r,i,o){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function We(e,t){if(null!=(e=e.onError(t))&&"string"!==typeof e)throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function ze(e,t){var n=e.onShellError;n(t),(n=e.onFatalError)(t),null!==e.destination?(e.status=2,e.destination.destroy(t)):(e.status=1,e.fatalError=t)}function Ue(e,t,n,r,i){for(me={},ye=t,Ee=0,e=n(r,i);Se;)Se=!1,Ee=0,xe+=1,be=null,e=n(r,i);return _e(),e}function Ke(e,t,n,r){var o=n.render(),a=r.childContextTypes;if(null!==a&&void 0!==a){var s=t.legacyContext;if("function"!==typeof n.getChildContext)r=s;else{for(var l in n=n.getChildContext())if(!(l in a))throw Error(i(108,$(r)||"Unknown",l));r=I({},s,n)}t.legacyContext=r,Ye(e,t,o),t.legacyContext=s}else Ye(e,t,o)}function qe(e,t){if(e&&e.defaultProps){for(var n in t=I({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function Xe(e,t,n,r,o){if("function"===typeof n)if(n.prototype&&n.prototype.isReactComponent){o=te(n,t.legacyContext);var a=n.contextType;ce(a=new n(r,"object"===typeof a&&null!==a?a._currentValue2:o),n,r,o),Ke(e,t,a,n)}else{o=Ue(e,t,n,r,a=te(n,t.legacyContext));var s=0!==Ee;if("object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof)ce(o,n,r,a),Ke(e,t,o,n);else if(s){r=t.treeContext,t.treeContext=he(r,1,0);try{Ye(e,t,o)}finally{t.treeContext=r}}else Ye(e,t,o)}else{if("string"!==typeof n){switch(n){case Q:case Y:case B:case j:case G:case U:return void Ye(e,t,r.children);case X:throw Error(i(343));case z:e:{n=t.blockedBoundary,o=t.blockedSegment,a=r.fallback,r=r.children;var l={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s=new Set,errorDigest:null},u=Ve(0,o.chunks.length,l,o.formatContext,!1,!1);o.children.push(u),o.lastPushedText=!1;var c=Ve(0,0,null,o.formatContext,!1,!1);c.parentFlushed=!0,t.blockedBoundary=l,t.blockedSegment=c;try{if(Ze(e,t,r),e.responseState.generateStaticMarkup||c.lastPushedText&&c.textEmbedded&&c.chunks.push("\x3c!-- --\x3e"),c.status=1,et(l,c),0===l.pendingTasks)break e}catch(d){c.status=4,l.forceClientRender=!0,l.errorDigest=We(e,d)}finally{t.blockedBoundary=n,t.blockedSegment=o}t=He(e,a,n,u,s,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if("object"===typeof n&&null!==n)switch(n.$$typeof){case W:if(r=Ue(e,t,n.render,r,o),0!==Ee){n=t.treeContext,t.treeContext=he(n,1,0);try{Ye(e,t,r)}finally{t.treeContext=n}}else Ye(e,t,r);return;case K:return void Xe(e,t,n=n.type,r=qe(n,r),o);case H:if(o=r.children,n=n._context,r=r.value,a=n._currentValue2,n._currentValue2=r,ne=r={parent:s=ne,depth:null===s?0:s.depth+1,context:n,parentValue:a,value:r},t.context=r,Ye(e,t,o),null===(e=ne))throw Error(i(403));return r=e.parentValue,e.context._currentValue2=r===Z?e.context._defaultValue:r,e=ne=e.parent,void(t.context=e);case V:return void Ye(e,t,r=(r=r.children)(n._currentValue2));case q:return void Xe(e,t,n=(o=n._init)(n._payload),r=qe(n,r),void 0)}throw Error(i(130,null==n?n:typeof n,""))}switch(a=O((o=t.blockedSegment).chunks,n,r,e.responseState,o.formatContext),o.lastPushedText=!1,s=o.formatContext,o.formatContext=function(e,t,n){switch(t){case"select":return C(1,null!=n.value?n.value:n.defaultValue);case"svg":return C(2,null);case"math":return C(3,null);case"foreignObject":return C(1,null);case"table":return C(4,null);case"thead":case"tbody":case"tfoot":return C(5,null);case"colgroup":return C(7,null);case"tr":return C(6,null)}return 4<=e.insertionMode||0===e.insertionMode?C(1,null):e}(s,n,r),Ze(e,t,a),o.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:o.chunks.push("</",n,">")}o.lastPushedText=!1}}function Ye(e,t,n){if(t.node=n,"object"===typeof n&&null!==n){switch(n.$$typeof){case L:return void Xe(e,t,n.type,n.props,n.ref);case M:throw Error(i(257));case q:var r=n._init;return void Ye(e,t,n=r(n._payload))}if(b(n))return void Qe(e,t,n);if(null===n||"object"!==typeof n?r=null:r="function"===typeof(r=J&&n[J]||n["@@iterator"])?r:null,r&&(r=r.call(n))){if(!(n=r.next()).done){var o=[];do{o.push(n.value),n=r.next()}while(!n.done);Qe(e,t,o)}return}throw e=Object.prototype.toString.call(n),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(n).join(", ")+"}":e))}"string"===typeof n?(r=t.blockedSegment).lastPushedText=F(t.blockedSegment.chunks,n,e.responseState,r.lastPushedText):"number"===typeof n&&((r=t.blockedSegment).lastPushedText=F(t.blockedSegment.chunks,""+n,e.responseState,r.lastPushedText))}function Qe(e,t,n){for(var r=n.length,i=0;i<r;i++){var o=t.treeContext;t.treeContext=he(o,r,i);try{Ze(e,t,n[i])}finally{t.treeContext=o}}}function Ze(e,t,n){var r=t.blockedSegment.formatContext,i=t.legacyContext,o=t.context;try{return Ye(e,t,n)}catch(l){if(_e(),"object"!==typeof l||null===l||"function"!==typeof l.then)throw t.blockedSegment.formatContext=r,t.legacyContext=i,t.context=o,le(o),l;n=l;var a=t.blockedSegment,s=Ve(0,a.chunks.length,null,a.formatContext,a.lastPushedText,!0);a.children.push(s),a.lastPushedText=!1,e=He(e,t.node,t.blockedBoundary,s,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,n.then(e,e),t.blockedSegment.formatContext=r,t.legacyContext=i,t.context=o,le(o)}}function Je(e){var t=e.blockedBoundary;(e=e.blockedSegment).status=3,tt(this,t,e)}function $e(e,t,n){var r=e.blockedBoundary;e.blockedSegment.status=3,null===r?(t.allPendingTasks--,2!==t.status&&(t.status=2,null!==t.destination&&t.destination.push(null))):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,e=void 0===n?Error(i(432)):n,r.errorDigest=t.onError(e),r.parentFlushed&&t.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach((function(e){return $e(e,t,n)})),r.fallbackAbortableTasks.clear(),t.allPendingTasks--,0===t.allPendingTasks&&(r=t.onAllReady)())}function et(e,t){if(0===t.chunks.length&&1===t.children.length&&null===t.children[0].boundary){var n=t.children[0];n.id=t.id,n.parentFlushed=!0,1===n.status&&et(e,n)}else e.completedSegments.push(t)}function tt(e,t,n){if(null===t){if(n.parentFlushed){if(null!==e.completedRootSegment)throw Error(i(389));e.completedRootSegment=n}e.pendingRootTasks--,0===e.pendingRootTasks&&(e.onShellError=je,(t=e.onShellReady)())}else t.pendingTasks--,t.forceClientRender||(0===t.pendingTasks?(n.parentFlushed&&1===n.status&&et(t,n),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(Je,e),t.fallbackAbortableTasks.clear()):n.parentFlushed&&1===n.status&&(et(t,n),1===t.completedSegments.length&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,0===e.allPendingTasks&&(e=e.onAllReady)()}function nt(e){if(2!==e.status){var t=ne,n=Ge.current;Ge.current=Le;var r=Me;Me=e.responseState;try{var i,o=e.pingedTasks;for(i=0;i<o.length;i++){var a=o[i],s=e,l=a.blockedSegment;if(0===l.status){le(a.context);try{Ye(s,a,a.node),s.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("\x3c!-- --\x3e"),a.abortSet.delete(a),l.status=1,tt(s,a.blockedBoundary,l)}catch(f){if(_e(),"object"===typeof f&&null!==f&&"function"===typeof f.then){var u=a.ping;f.then(u,u)}else{a.abortSet.delete(a),l.status=4;var c=a.blockedBoundary,d=f,h=We(s,d);if(null===c?ze(s,d):(c.pendingTasks--,c.forceClientRender||(c.forceClientRender=!0,c.errorDigest=h,c.parentFlushed&&s.clientRenderedBoundaries.push(c))),s.allPendingTasks--,0===s.allPendingTasks)(0,s.onAllReady)()}}}}o.splice(0,i),null!==e.destination&&lt(e,e.destination)}catch(f){We(e,f),ze(e,f)}finally{Me=r,Ge.current=n,n===Le&&le(t)}}}function rt(e,t,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=e.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,e=e.responseState,t.push('<template id="'),t.push(e.placeholderPrefix),e=r.toString(16),t.push(e),t.push('"></template>');case 1:n.status=2;var o=!0;r=n.chunks;var a=0;n=n.children;for(var s=0;s<n.length;s++){for(o=n[s];a<o.index;a++)t.push(r[a]);o=it(e,t,o)}for(;a<r.length-1;a++)t.push(r[a]);return a<r.length&&(o=t.push(r[a])),o;default:throw Error(i(390))}}function it(e,t,n){var r=n.boundary;if(null===r)return rt(e,t,n);if(r.parentFlushed=!0,r.forceClientRender)return e.responseState.generateStaticMarkup||(r=r.errorDigest,t.push("\x3c!--$!--\x3e"),t.push("<template"),r&&(t.push(' data-dgst="'),r=m(r),t.push(r),t.push('"')),t.push("></template>")),rt(e,t,n),e=!!e.responseState.generateStaticMarkup||t.push("\x3c!--/$--\x3e");if(0<r.pendingTasks){r.rootSegmentID=e.nextSegmentId++,0<r.completedSegments.length&&e.partialBoundaries.push(r);var o=e.responseState,a=o.nextSuspenseID++;return o=o.boundaryPrefix+a.toString(16),r=r.id=o,D(t,e.responseState,r),rt(e,t,n),t.push("\x3c!--/$--\x3e")}if(r.byteSize>e.progressiveChunkSize)return r.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(r),D(t,e.responseState,r.id),rt(e,t,n),t.push("\x3c!--/$--\x3e");if(e.responseState.generateStaticMarkup||t.push("\x3c!--$--\x3e"),1!==(n=r.completedSegments).length)throw Error(i(391));return it(e,t,n[0]),e=!!e.responseState.generateStaticMarkup||t.push("\x3c!--/$--\x3e")}function ot(e,t,n){return function(e,t,n,r){switch(n.insertionMode){case 0:case 1:return e.push('<div hidden id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 2:return e.push('<svg aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 3:return e.push('<math aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 4:return e.push('<table hidden id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 5:return e.push('<table hidden><tbody id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 6:return e.push('<table hidden><tr id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 7:return e.push('<table hidden><colgroup id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');default:throw Error(i(397))}}(t,e.responseState,n.formatContext,n.id),it(e,t,n),function(e,t){switch(t.insertionMode){case 0:case 1:return e.push("</div>");case 2:return e.push("</svg>");case 3:return e.push("</math>");case 4:return e.push("</table>");case 5:return e.push("</tbody></table>");case 6:return e.push("</tr></table>");case 7:return e.push("</colgroup></table>");default:throw Error(i(397))}}(t,n.formatContext)}function at(e,t,n){for(var r=n.completedSegments,o=0;o<r.length;o++)st(e,t,n,r[o]);if(r.length=0,e=e.responseState,r=n.id,n=n.rootSegmentID,t.push(e.startInlineScript),e.sentCompleteBoundaryFunction?t.push('$RC("'):(e.sentCompleteBoundaryFunction=!0,t.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),null===r)throw Error(i(395));return n=n.toString(16),t.push(r),t.push('","'),t.push(e.segmentPrefix),t.push(n),t.push('")<\/script>')}function st(e,t,n,r){if(2===r.status)return!0;var o=r.id;if(-1===o){if(-1===(r.id=n.rootSegmentID))throw Error(i(392));return ot(e,t,r)}return ot(e,t,r),e=e.responseState,t.push(e.startInlineScript),e.sentCompleteSegmentFunction?t.push('$RS("'):(e.sentCompleteSegmentFunction=!0,t.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),t.push(e.segmentPrefix),o=o.toString(16),t.push(o),t.push('","'),t.push(e.placeholderPrefix),t.push(o),t.push('")<\/script>')}function lt(e,t){try{var n=e.completedRootSegment;if(null!==n&&0===e.pendingRootTasks){it(e,t,n),e.completedRootSegment=null;var r=e.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)t.push(r[n]);n<r.length&&t.push(r[n])}var o,a=e.clientRenderedBoundaries;for(o=0;o<a.length;o++){var s=a[o];r=t;var l=e.responseState,u=s.id,c=s.errorDigest,d=s.errorMessage,h=s.errorComponentStack;if(r.push(l.startInlineScript),l.sentClientRenderFunction?r.push('$RX("'):(l.sentClientRenderFunction=!0,r.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),null===u)throw Error(i(395));if(r.push(u),r.push('"'),c||d||h){r.push(",");var f=P(c||"");r.push(f)}if(d||h){r.push(",");var p=P(d||"");r.push(p)}if(h){r.push(",");var v=P(h);r.push(v)}if(!r.push(")<\/script>"))return e.destination=null,o++,void a.splice(0,o)}a.splice(0,o);var g=e.completedBoundaries;for(o=0;o<g.length;o++)if(!at(e,t,g[o]))return e.destination=null,o++,void g.splice(0,o);g.splice(0,o);var m=e.partialBoundaries;for(o=0;o<m.length;o++){var y=m[o];e:{a=e,s=t;var w=y.completedSegments;for(l=0;l<w.length;l++)if(!st(a,s,y,w[l])){l++,w.splice(0,l);var b=!1;break e}w.splice(0,l),b=!0}if(!b)return e.destination=null,o++,void m.splice(0,o)}m.splice(0,o);var C=e.completedBoundaries;for(o=0;o<C.length;o++)if(!at(e,t,C[o]))return e.destination=null,o++,void C.splice(0,o);C.splice(0,o)}finally{0===e.allPendingTasks&&0===e.pingedTasks.length&&0===e.clientRenderedBoundaries.length&&0===e.completedBoundaries.length&&t.push(null)}}function ut(e,t){try{var n=e.abortableTasks;n.forEach((function(n){return $e(n,e,t)})),n.clear(),null!==e.destination&&lt(e,e.destination)}catch(r){We(e,r),ze(e,r)}}function ct(){}function dt(e,t,n,r){var o=!1,a=null,s="",l={push:function(e){return null!==e&&(s+=e),!0},destroy:function(e){o=!0,a=e}},u=!1;if(e=function(e,t,n,r,i,o,a,s,l){var u=[],c=new Set;return(n=Ve(t={destination:null,responseState:t,progressiveChunkSize:void 0===r?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:c,pingedTasks:u,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:void 0===i?Be:i,onAllReady:void 0===o?je:o,onShellReady:void 0===a?je:a,onShellError:void 0===s?je:s,onFatalError:void 0===l?je:l},0,null,n,!1,!1)).parentFlushed=!0,e=He(t,e,null,n,c,ee,null,de),u.push(e),t}(e,function(e,t){return{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:(t=void 0===t?"":t)+"P:",segmentPrefix:t+"S:",boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:e}}(n,t?t.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,ct,void 0,(function(){u=!0}),void 0,void 0),nt(e),ut(e,r),1===e.status)e.status=2,l.destroy(e.fatalError);else if(2!==e.status&&null===e.destination){e.destination=l;try{lt(e,l)}catch(c){We(e,c),ze(e,c)}}if(o)throw a;if(!u)throw Error(i(426));return s}t.renderToNodeStream=function(){throw Error(i(207))},t.renderToStaticMarkup=function(e,t){return dt(e,t,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},t.renderToStaticNodeStream=function(){throw Error(i(208))},t.renderToString=function(e,t){return dt(e,t,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},t.version="18.2.0"},4424:function(e,t,n){"use strict";var r=n(2791);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=null,a=0;function s(e,t){if(0!==t.length)if(512<t.length)0<a&&(e.enqueue(new Uint8Array(o.buffer,0,a)),o=new Uint8Array(512),a=0),e.enqueue(t);else{var n=o.length-a;n<t.length&&(0===n?e.enqueue(o):(o.set(t.subarray(0,n),a),e.enqueue(o),t=t.subarray(n)),o=new Uint8Array(512),a=0),o.set(t,a),a+=t.length}}function l(e,t){return s(e,t),!0}function u(e){o&&0<a&&(e.enqueue(new Uint8Array(o.buffer,0,a)),o=null,a=0)}var c=new TextEncoder;function d(e){return c.encode(e)}function h(e){return c.encode(e)}function f(e,t){"function"===typeof e.error?e.error(t):e.close()}var p=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},m={};function y(e){return!!p.call(m,e)||!p.call(g,e)&&(v.test(e)?m[e]=!0:(g[e]=!0,!1))}function w(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){b[e]=new w(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];b[t]=new w(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){b[e]=new w(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){b[e]=new w(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){b[e]=new w(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){b[e]=new w(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){b[e]=new w(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){b[e]=new w(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){b[e]=new w(e,5,!1,e.toLowerCase(),null,!1,!1)}));var C=/[\-:]([a-z])/g;function S(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(C,S);b[t]=new w(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(C,S);b[t]=new w(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(C,S);b[t]=new w(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){b[e]=new w(e,1,!1,e.toLowerCase(),null,!1,!1)})),b.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){b[e]=new w(e,1,!1,e.toLowerCase(),null,!0,!0)}));var E={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},k=["Webkit","ms","Moz","O"];Object.keys(E).forEach((function(e){k.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),E[t]=E[e]}))}));var x=/["'&<>]/;function T(e){if("boolean"===typeof e||"number"===typeof e)return""+e;e=""+e;var t=x.exec(e);if(t){var n,r="",i=0;for(n=t.index;n<e.length;n++){switch(e.charCodeAt(n)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}i!==n&&(r+=e.substring(i,n)),i=n+1,r+=t}e=i!==n?r+e.substring(i,n):r}return e}var R=/([A-Z])/g,A=/^ms-/,_=Array.isArray,O=h("<script>"),D=h("<\/script>"),N=h('<script src="'),P=h('<script type="module" src="'),F=h('" async=""><\/script>'),I=/(<\/|<)(s)(cript)/gi;function L(e,t,n,r){return t+("s"===n?"\\u0073":"\\u0053")+r}function M(e,t){return{insertionMode:e,selectedValue:t}}var G=h("\x3c!-- --\x3e");function B(e,t,n,r){return""===t?r:(r&&e.push(G),e.push(d(T(t))),!0)}var j=new Map,H=h(' style="'),V=h(":"),W=h(";");function z(e,t,n){if("object"!==typeof n)throw Error(i(62));for(var r in t=!0,n)if(p.call(n,r)){var o=n[r];if(null!=o&&"boolean"!==typeof o&&""!==o){if(0===r.indexOf("--")){var a=d(T(r));o=d(T((""+o).trim()))}else{a=r;var s=j.get(a);void 0!==s||(s=h(T(a.replace(R,"-$1").toLowerCase().replace(A,"-ms-"))),j.set(a,s)),a=s,o="number"===typeof o?0===o||p.call(E,r)?d(""+o):d(o+"px"):d(T((""+o).trim()))}t?(t=!1,e.push(H,a,V,o)):e.push(W,a,V,o)}}t||e.push(q)}var U=h(" "),K=h('="'),q=h('"'),X=h('=""');function Y(e,t,n,r){switch(n){case"style":return void z(e,t,r);case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])if(null!==(t=b.hasOwnProperty(n)?b[n]:null)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(n=d(t.attributeName),t.type){case 3:r&&e.push(U,n,X);break;case 4:!0===r?e.push(U,n,X):!1!==r&&e.push(U,n,K,d(T(r)),q);break;case 5:isNaN(r)||e.push(U,n,K,d(T(r)),q);break;case 6:!isNaN(r)&&1<=r&&e.push(U,n,K,d(T(r)),q);break;default:t.sanitizeURL&&(r=""+r),e.push(U,n,K,d(T(r)),q)}}else if(y(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if("data-"!==(t=n.toLowerCase().slice(0,5))&&"aria-"!==t)return}e.push(U,d(n),K,d(T(r)),q)}}var Q=h(">"),Z=h("/>");function J(e,t,n){if(null!=t){if(null!=n)throw Error(i(60));if("object"!==typeof t||!("__html"in t))throw Error(i(61));null!==(t=t.__html)&&void 0!==t&&e.push(d(""+t))}}var $=h(' selected=""');function ee(e,t,n,r){e.push(ie(n));var i,o=n=null;for(i in t)if(p.call(t,i)){var a=t[i];if(null!=a)switch(i){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;default:Y(e,r,i,a)}}return e.push(Q),J(e,o,n),"string"===typeof n?(e.push(d(T(n))),null):n}var te=h("\n"),ne=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,re=new Map;function ie(e){var t=re.get(e);if(void 0===t){if(!ne.test(e))throw Error(i(65,e));t=h("<"+e),re.set(e,t)}return t}var oe=h("<!DOCTYPE html>");function ae(e,t,n,o,a){switch(t){case"select":e.push(ie("select"));var s=null,l=null;for(f in n)if(p.call(n,f)){var u=n[f];if(null!=u)switch(f){case"children":s=u;break;case"dangerouslySetInnerHTML":l=u;break;case"defaultValue":case"value":break;default:Y(e,o,f,u)}}return e.push(Q),J(e,l,s),s;case"option":l=a.selectedValue,e.push(ie("option"));var c=u=null,h=null,f=null;for(s in n)if(p.call(n,s)){var v=n[s];if(null!=v)switch(s){case"children":u=v;break;case"selected":h=v;break;case"dangerouslySetInnerHTML":f=v;break;case"value":c=v;default:Y(e,o,s,v)}}if(null!=l)if(n=null!==c?""+c:function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(u),_(l)){for(o=0;o<l.length;o++)if(""+l[o]===n){e.push($);break}}else""+l===n&&e.push($);else h&&e.push($);return e.push(Q),J(e,f,u),u;case"textarea":for(u in e.push(ie("textarea")),f=l=s=null,n)if(p.call(n,u)&&null!=(c=n[u]))switch(u){case"children":f=c;break;case"value":s=c;break;case"defaultValue":l=c;break;case"dangerouslySetInnerHTML":throw Error(i(91));default:Y(e,o,u,c)}if(null===s&&null!==l&&(s=l),e.push(Q),null!=f){if(null!=s)throw Error(i(92));if(_(f)&&1<f.length)throw Error(i(93));s=""+f}return"string"===typeof s&&"\n"===s[0]&&e.push(te),null!==s&&e.push(d(T(""+s))),null;case"input":for(l in e.push(ie("input")),c=f=u=s=null,n)if(p.call(n,l)&&null!=(h=n[l]))switch(l){case"children":case"dangerouslySetInnerHTML":throw Error(i(399,"input"));case"defaultChecked":c=h;break;case"defaultValue":u=h;break;case"checked":f=h;break;case"value":s=h;break;default:Y(e,o,l,h)}return null!==f?Y(e,o,"checked",f):null!==c&&Y(e,o,"checked",c),null!==s?Y(e,o,"value",s):null!==u&&Y(e,o,"value",u),e.push(Z),null;case"menuitem":for(var g in e.push(ie("menuitem")),n)if(p.call(n,g)&&null!=(s=n[g]))switch(g){case"children":case"dangerouslySetInnerHTML":throw Error(i(400));default:Y(e,o,g,s)}return e.push(Q),null;case"title":for(v in e.push(ie("title")),s=null,n)if(p.call(n,v)&&null!=(l=n[v]))switch(v){case"children":s=l;break;case"dangerouslySetInnerHTML":throw Error(i(434));default:Y(e,o,v,l)}return e.push(Q),s;case"listing":case"pre":for(c in e.push(ie(t)),l=s=null,n)if(p.call(n,c)&&null!=(u=n[c]))switch(c){case"children":s=u;break;case"dangerouslySetInnerHTML":l=u;break;default:Y(e,o,c,u)}if(e.push(Q),null!=l){if(null!=s)throw Error(i(60));if("object"!==typeof l||!("__html"in l))throw Error(i(61));null!==(n=l.__html)&&void 0!==n&&("string"===typeof n&&0<n.length&&"\n"===n[0]?e.push(te,d(n)):e.push(d(""+n)))}return"string"===typeof s&&"\n"===s[0]&&e.push(te),s;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":for(var m in e.push(ie(t)),n)if(p.call(n,m)&&null!=(s=n[m]))switch(m){case"children":case"dangerouslySetInnerHTML":throw Error(i(399,t));default:Y(e,o,m,s)}return e.push(Z),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return ee(e,n,t,o);case"html":return 0===a.insertionMode&&e.push(oe),ee(e,n,t,o);default:if(-1===t.indexOf("-")&&"string"!==typeof n.is)return ee(e,n,t,o);for(h in e.push(ie(t)),l=s=null,n)if(p.call(n,h)&&null!=(u=n[h]))switch(h){case"children":s=u;break;case"dangerouslySetInnerHTML":l=u;break;case"style":z(e,o,u);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:y(h)&&"function"!==typeof u&&"symbol"!==typeof u&&e.push(U,d(h),K,d(T(u)),q)}return e.push(Q),J(e,l,s),s}}var se=h("</"),le=h(">"),ue=h('<template id="'),ce=h('"></template>'),de=h("\x3c!--$--\x3e"),he=h('\x3c!--$?--\x3e<template id="'),fe=h('"></template>'),pe=h("\x3c!--$!--\x3e"),ve=h("\x3c!--/$--\x3e"),ge=h("<template"),me=h('"'),ye=h(' data-dgst="');h(' data-msg="'),h(' data-stck="');var we=h("></template>");function be(e,t,n){if(s(e,he),null===n)throw Error(i(395));return s(e,n),l(e,fe)}var Ce=h('<div hidden id="'),Se=h('">'),Ee=h("</div>"),ke=h('<svg aria-hidden="true" style="display:none" id="'),xe=h('">'),Te=h("</svg>"),Re=h('<math aria-hidden="true" style="display:none" id="'),Ae=h('">'),_e=h("</math>"),Oe=h('<table hidden id="'),De=h('">'),Ne=h("</table>"),Pe=h('<table hidden><tbody id="'),Fe=h('">'),Ie=h("</tbody></table>"),Le=h('<table hidden><tr id="'),Me=h('">'),Ge=h("</tr></table>"),Be=h('<table hidden><colgroup id="'),je=h('">'),He=h("</colgroup></table>");var Ve=h('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),We=h('$RS("'),ze=h('","'),Ue=h('")<\/script>'),Ke=h('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),qe=h('$RC("'),Xe=h('","'),Ye=h('")<\/script>'),Qe=h('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),Ze=h('$RX("'),Je=h('"'),$e=h(")<\/script>"),et=h(","),tt=/[<\u2028\u2029]/g;function nt(e){return JSON.stringify(e).replace(tt,(function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}}))}var rt=Object.assign,it=Symbol.for("react.element"),ot=Symbol.for("react.portal"),at=Symbol.for("react.fragment"),st=Symbol.for("react.strict_mode"),lt=Symbol.for("react.profiler"),ut=Symbol.for("react.provider"),ct=Symbol.for("react.context"),dt=Symbol.for("react.forward_ref"),ht=Symbol.for("react.suspense"),ft=Symbol.for("react.suspense_list"),pt=Symbol.for("react.memo"),vt=Symbol.for("react.lazy"),gt=Symbol.for("react.scope"),mt=Symbol.for("react.debug_trace_mode"),yt=Symbol.for("react.legacy_hidden"),wt=Symbol.for("react.default_value"),bt=Symbol.iterator;function Ct(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case at:return"Fragment";case ot:return"Portal";case lt:return"Profiler";case st:return"StrictMode";case ht:return"Suspense";case ft:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case ct:return(e.displayName||"Context")+".Consumer";case ut:return(e._context.displayName||"Context")+".Provider";case dt:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case pt:return null!==(t=e.displayName||null)?t:Ct(e.type)||"Memo";case vt:t=e._payload,e=e._init;try{return Ct(e(t))}catch(n){}}return null}var St={};function Et(e,t){if(!(e=e.contextTypes))return St;var n,r={};for(n in e)r[n]=t[n];return r}var kt=null;function xt(e,t){if(e!==t){e.context._currentValue=e.parentValue,e=e.parent;var n=t.parent;if(null===e){if(null!==n)throw Error(i(401))}else{if(null===n)throw Error(i(401));xt(e,n)}t.context._currentValue=t.value}}function Tt(e){e.context._currentValue=e.parentValue,null!==(e=e.parent)&&Tt(e)}function Rt(e){var t=e.parent;null!==t&&Rt(t),e.context._currentValue=e.value}function At(e,t){if(e.context._currentValue=e.parentValue,null===(e=e.parent))throw Error(i(402));e.depth===t.depth?xt(e,t):At(e,t)}function _t(e,t){var n=t.parent;if(null===n)throw Error(i(402));e.depth===n.depth?xt(e,n):_t(e,n),t.context._currentValue=t.value}function Ot(e){var t=kt;t!==e&&(null===t?Rt(e):null===e?Tt(t):t.depth===e.depth?xt(t,e):t.depth>e.depth?At(t,e):_t(t,e),kt=e)}var Dt={isMounted:function(){return!1},enqueueSetState:function(e,t){null!==(e=e._reactInternals).queue&&e.queue.push(t)},enqueueReplaceState:function(e,t){(e=e._reactInternals).replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function Nt(e,t,n,r){var i=void 0!==e.state?e.state:null;e.updater=Dt,e.props=n,e.state=i;var o={queue:[],replace:!1};e._reactInternals=o;var a=t.contextType;if(e.context="object"===typeof a&&null!==a?a._currentValue:r,"function"===typeof(a=t.getDerivedStateFromProps)&&(i=null===(a=a(n,i))||void 0===a?i:rt({},i,a),e.state=i),"function"!==typeof t.getDerivedStateFromProps&&"function"!==typeof e.getSnapshotBeforeUpdate&&("function"===typeof e.UNSAFE_componentWillMount||"function"===typeof e.componentWillMount))if(t=e.state,"function"===typeof e.componentWillMount&&e.componentWillMount(),"function"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),t!==e.state&&Dt.enqueueReplaceState(e,e.state,null),null!==o.queue&&0<o.queue.length)if(t=o.queue,a=o.replace,o.queue=null,o.replace=!1,a&&1===t.length)e.state=t[0];else{for(o=a?t[0]:e.state,i=!0,a=a?1:0;a<t.length;a++){var s=t[a];null!=(s="function"===typeof s?s.call(e,o,n,r):s)&&(i?(i=!1,o=rt({},o,s)):rt(o,s))}e.state=o}else o.queue=null}var Pt={id:1,overflow:""};function Ft(e,t,n){var r=e.id;e=e.overflow;var i=32-It(r)-1;r&=~(1<<i),n+=1;var o=32-It(t)+i;if(30<o){var a=i-i%5;return o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,{id:1<<32-It(t)+i|n<<i|r,overflow:o+e}}return{id:1<<o|n<<i|r,overflow:e}}var It=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Lt(e)/Mt|0)|0},Lt=Math.log,Mt=Math.LN2;var Gt="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},Bt=null,jt=null,Ht=null,Vt=null,Wt=!1,zt=!1,Ut=0,Kt=null,qt=0;function Xt(){if(null===Bt)throw Error(i(321));return Bt}function Yt(){if(0<qt)throw Error(i(312));return{memoizedState:null,queue:null,next:null}}function Qt(){return null===Vt?null===Ht?(Wt=!1,Ht=Vt=Yt()):(Wt=!0,Vt=Ht):null===Vt.next?(Wt=!1,Vt=Vt.next=Yt()):(Wt=!0,Vt=Vt.next),Vt}function Zt(){jt=Bt=null,zt=!1,Ht=null,qt=0,Vt=Kt=null}function Jt(e,t){return"function"===typeof t?t(e):t}function $t(e,t,n){if(Bt=Xt(),Vt=Qt(),Wt){var r=Vt.queue;if(t=r.dispatch,null!==Kt&&void 0!==(n=Kt.get(r))){Kt.delete(r),r=Vt.memoizedState;do{r=e(r,n.action),n=n.next}while(null!==n);return Vt.memoizedState=r,[r,t]}return[Vt.memoizedState,t]}return e=e===Jt?"function"===typeof t?t():t:void 0!==n?n(t):t,Vt.memoizedState=e,e=(e=Vt.queue={last:null,dispatch:null}).dispatch=tn.bind(null,Bt,e),[Vt.memoizedState,e]}function en(e,t){if(Bt=Xt(),t=void 0===t?null:t,null!==(Vt=Qt())){var n=Vt.memoizedState;if(null!==n&&null!==t){var r=n[1];e:if(null===r)r=!1;else{for(var i=0;i<r.length&&i<t.length;i++)if(!Gt(t[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return e=e(),Vt.memoizedState=[e,t],e}function tn(e,t,n){if(25<=qt)throw Error(i(301));if(e===Bt)if(zt=!0,e={action:n,next:null},null===Kt&&(Kt=new Map),void 0===(n=Kt.get(t)))Kt.set(t,e);else{for(t=n;null!==t.next;)t=t.next;t.next=e}}function nn(){throw Error(i(394))}function rn(){}var on={readContext:function(e){return e._currentValue},useContext:function(e){return Xt(),e._currentValue},useMemo:en,useReducer:$t,useRef:function(e){Bt=Xt();var t=(Vt=Qt()).memoizedState;return null===t?(e={current:e},Vt.memoizedState=e):t},useState:function(e){return $t(Jt,e)},useInsertionEffect:rn,useLayoutEffect:function(){},useCallback:function(e,t){return en((function(){return e}),t)},useImperativeHandle:rn,useEffect:rn,useDebugValue:rn,useDeferredValue:function(e){return Xt(),e},useTransition:function(){return Xt(),[!1,nn]},useId:function(){var e=jt.treeContext,t=e.overflow;e=((e=e.id)&~(1<<32-It(e)-1)).toString(32)+t;var n=an;if(null===n)throw Error(i(404));return t=Ut++,e=":"+n.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return Xt(),t(e._source)},useSyncExternalStore:function(e,t,n){if(void 0===n)throw Error(i(407));return n()}},an=null,sn=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function ln(e){return console.error(e),null}function un(){}function cn(e,t,n,r,i,o,a,s){e.allPendingTasks++,null===n?e.pendingRootTasks++:n.pendingTasks++;var l={node:t,ping:function(){var t=e.pingedTasks;t.push(l),1===t.length&&xn(e)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:a,treeContext:s};return i.add(l),l}function dn(e,t,n,r,i,o){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function hn(e,t){if(null!=(e=e.onError(t))&&"string"!==typeof e)throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function fn(e,t){var n=e.onShellError;n(t),(n=e.onFatalError)(t),null!==e.destination?(e.status=2,f(e.destination,t)):(e.status=1,e.fatalError=t)}function pn(e,t,n,r,i){for(Bt={},jt=t,Ut=0,e=n(r,i);zt;)zt=!1,Ut=0,qt+=1,Vt=null,e=n(r,i);return Zt(),e}function vn(e,t,n,r){var o=n.render(),a=r.childContextTypes;if(null!==a&&void 0!==a){var s=t.legacyContext;if("function"!==typeof n.getChildContext)r=s;else{for(var l in n=n.getChildContext())if(!(l in a))throw Error(i(108,Ct(r)||"Unknown",l));r=rt({},s,n)}t.legacyContext=r,yn(e,t,o),t.legacyContext=s}else yn(e,t,o)}function gn(e,t){if(e&&e.defaultProps){for(var n in t=rt({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function mn(e,t,n,r,o){if("function"===typeof n)if(n.prototype&&n.prototype.isReactComponent){o=Et(n,t.legacyContext);var a=n.contextType;Nt(a=new n(r,"object"===typeof a&&null!==a?a._currentValue:o),n,r,o),vn(e,t,a,n)}else{o=pn(e,t,n,r,a=Et(n,t.legacyContext));var s=0!==Ut;if("object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof)Nt(o,n,r,a),vn(e,t,o,n);else if(s){r=t.treeContext,t.treeContext=Ft(r,1,0);try{yn(e,t,o)}finally{t.treeContext=r}}else yn(e,t,o)}else{if("string"!==typeof n){switch(n){case yt:case mt:case st:case lt:case at:case ft:return void yn(e,t,r.children);case gt:throw Error(i(343));case ht:e:{n=t.blockedBoundary,o=t.blockedSegment,a=r.fallback,r=r.children;var l={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s=new Set,errorDigest:null},u=dn(0,o.chunks.length,l,o.formatContext,!1,!1);o.children.push(u),o.lastPushedText=!1;var c=dn(0,0,null,o.formatContext,!1,!1);c.parentFlushed=!0,t.blockedBoundary=l,t.blockedSegment=c;try{if(bn(e,t,r),c.lastPushedText&&c.textEmbedded&&c.chunks.push(G),c.status=1,En(l,c),0===l.pendingTasks)break e}catch(h){c.status=4,l.forceClientRender=!0,l.errorDigest=hn(e,h)}finally{t.blockedBoundary=n,t.blockedSegment=o}t=cn(e,a,n,u,s,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if("object"===typeof n&&null!==n)switch(n.$$typeof){case dt:if(r=pn(e,t,n.render,r,o),0!==Ut){n=t.treeContext,t.treeContext=Ft(n,1,0);try{yn(e,t,r)}finally{t.treeContext=n}}else yn(e,t,r);return;case pt:return void mn(e,t,n=n.type,r=gn(n,r),o);case ut:if(o=r.children,n=n._context,r=r.value,a=n._currentValue,n._currentValue=r,kt=r={parent:s=kt,depth:null===s?0:s.depth+1,context:n,parentValue:a,value:r},t.context=r,yn(e,t,o),null===(e=kt))throw Error(i(403));return r=e.parentValue,e.context._currentValue=r===wt?e.context._defaultValue:r,e=kt=e.parent,void(t.context=e);case ct:return void yn(e,t,r=(r=r.children)(n._currentValue));case vt:return void mn(e,t,n=(o=n._init)(n._payload),r=gn(n,r),void 0)}throw Error(i(130,null==n?n:typeof n,""))}switch(a=ae((o=t.blockedSegment).chunks,n,r,e.responseState,o.formatContext),o.lastPushedText=!1,s=o.formatContext,o.formatContext=function(e,t,n){switch(t){case"select":return M(1,null!=n.value?n.value:n.defaultValue);case"svg":return M(2,null);case"math":return M(3,null);case"foreignObject":return M(1,null);case"table":return M(4,null);case"thead":case"tbody":case"tfoot":return M(5,null);case"colgroup":return M(7,null);case"tr":return M(6,null)}return 4<=e.insertionMode||0===e.insertionMode?M(1,null):e}(s,n,r),bn(e,t,a),o.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:o.chunks.push(se,d(n),le)}o.lastPushedText=!1}}function yn(e,t,n){if(t.node=n,"object"===typeof n&&null!==n){switch(n.$$typeof){case it:return void mn(e,t,n.type,n.props,n.ref);case ot:throw Error(i(257));case vt:var r=n._init;return void yn(e,t,n=r(n._payload))}if(_(n))return void wn(e,t,n);if(null===n||"object"!==typeof n?r=null:r="function"===typeof(r=bt&&n[bt]||n["@@iterator"])?r:null,r&&(r=r.call(n))){if(!(n=r.next()).done){var o=[];do{o.push(n.value),n=r.next()}while(!n.done);wn(e,t,o)}return}throw e=Object.prototype.toString.call(n),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(n).join(", ")+"}":e))}"string"===typeof n?(r=t.blockedSegment).lastPushedText=B(t.blockedSegment.chunks,n,e.responseState,r.lastPushedText):"number"===typeof n&&((r=t.blockedSegment).lastPushedText=B(t.blockedSegment.chunks,""+n,e.responseState,r.lastPushedText))}function wn(e,t,n){for(var r=n.length,i=0;i<r;i++){var o=t.treeContext;t.treeContext=Ft(o,r,i);try{bn(e,t,n[i])}finally{t.treeContext=o}}}function bn(e,t,n){var r=t.blockedSegment.formatContext,i=t.legacyContext,o=t.context;try{return yn(e,t,n)}catch(l){if(Zt(),"object"!==typeof l||null===l||"function"!==typeof l.then)throw t.blockedSegment.formatContext=r,t.legacyContext=i,t.context=o,Ot(o),l;n=l;var a=t.blockedSegment,s=dn(0,a.chunks.length,null,a.formatContext,a.lastPushedText,!0);a.children.push(s),a.lastPushedText=!1,e=cn(e,t.node,t.blockedBoundary,s,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,n.then(e,e),t.blockedSegment.formatContext=r,t.legacyContext=i,t.context=o,Ot(o)}}function Cn(e){var t=e.blockedBoundary;(e=e.blockedSegment).status=3,kn(this,t,e)}function Sn(e,t,n){var r=e.blockedBoundary;e.blockedSegment.status=3,null===r?(t.allPendingTasks--,2!==t.status&&(t.status=2,null!==t.destination&&t.destination.close())):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,e=void 0===n?Error(i(432)):n,r.errorDigest=t.onError(e),r.parentFlushed&&t.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach((function(e){return Sn(e,t,n)})),r.fallbackAbortableTasks.clear(),t.allPendingTasks--,0===t.allPendingTasks&&(r=t.onAllReady)())}function En(e,t){if(0===t.chunks.length&&1===t.children.length&&null===t.children[0].boundary){var n=t.children[0];n.id=t.id,n.parentFlushed=!0,1===n.status&&En(e,n)}else e.completedSegments.push(t)}function kn(e,t,n){if(null===t){if(n.parentFlushed){if(null!==e.completedRootSegment)throw Error(i(389));e.completedRootSegment=n}e.pendingRootTasks--,0===e.pendingRootTasks&&(e.onShellError=un,(t=e.onShellReady)())}else t.pendingTasks--,t.forceClientRender||(0===t.pendingTasks?(n.parentFlushed&&1===n.status&&En(t,n),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(Cn,e),t.fallbackAbortableTasks.clear()):n.parentFlushed&&1===n.status&&(En(t,n),1===t.completedSegments.length&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,0===e.allPendingTasks&&(e=e.onAllReady)()}function xn(e){if(2!==e.status){var t=kt,n=sn.current;sn.current=on;var r=an;an=e.responseState;try{var i,o=e.pingedTasks;for(i=0;i<o.length;i++){var a=o[i],s=e,l=a.blockedSegment;if(0===l.status){Ot(a.context);try{yn(s,a,a.node),l.lastPushedText&&l.textEmbedded&&l.chunks.push(G),a.abortSet.delete(a),l.status=1,kn(s,a.blockedBoundary,l)}catch(f){if(Zt(),"object"===typeof f&&null!==f&&"function"===typeof f.then){var u=a.ping;f.then(u,u)}else{a.abortSet.delete(a),l.status=4;var c=a.blockedBoundary,d=f,h=hn(s,d);if(null===c?fn(s,d):(c.pendingTasks--,c.forceClientRender||(c.forceClientRender=!0,c.errorDigest=h,c.parentFlushed&&s.clientRenderedBoundaries.push(c))),s.allPendingTasks--,0===s.allPendingTasks)(0,s.onAllReady)()}}}}o.splice(0,i),null!==e.destination&&Dn(e,e.destination)}catch(f){hn(e,f),fn(e,f)}finally{an=r,sn.current=n,n===on&&Ot(t)}}}function Tn(e,t,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=e.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,e=e.responseState,s(t,ue),s(t,e.placeholderPrefix),s(t,e=d(r.toString(16))),l(t,ce);case 1:n.status=2;var o=!0;r=n.chunks;var a=0;n=n.children;for(var u=0;u<n.length;u++){for(o=n[u];a<o.index;a++)s(t,r[a]);o=Rn(e,t,o)}for(;a<r.length-1;a++)s(t,r[a]);return a<r.length&&(o=l(t,r[a])),o;default:throw Error(i(390))}}function Rn(e,t,n){var r=n.boundary;if(null===r)return Tn(e,t,n);if(r.parentFlushed=!0,r.forceClientRender)r=r.errorDigest,l(t,pe),s(t,ge),r&&(s(t,ye),s(t,d(T(r))),s(t,me)),l(t,we),Tn(e,t,n);else if(0<r.pendingTasks){r.rootSegmentID=e.nextSegmentId++,0<r.completedSegments.length&&e.partialBoundaries.push(r);var o=e.responseState,a=o.nextSuspenseID++;o=h(o.boundaryPrefix+a.toString(16)),r=r.id=o,be(t,e.responseState,r),Tn(e,t,n)}else if(r.byteSize>e.progressiveChunkSize)r.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(r),be(t,e.responseState,r.id),Tn(e,t,n);else{if(l(t,de),1!==(n=r.completedSegments).length)throw Error(i(391));Rn(e,t,n[0])}return l(t,ve)}function An(e,t,n){return function(e,t,n,r){switch(n.insertionMode){case 0:case 1:return s(e,Ce),s(e,t.segmentPrefix),s(e,d(r.toString(16))),l(e,Se);case 2:return s(e,ke),s(e,t.segmentPrefix),s(e,d(r.toString(16))),l(e,xe);case 3:return s(e,Re),s(e,t.segmentPrefix),s(e,d(r.toString(16))),l(e,Ae);case 4:return s(e,Oe),s(e,t.segmentPrefix),s(e,d(r.toString(16))),l(e,De);case 5:return s(e,Pe),s(e,t.segmentPrefix),s(e,d(r.toString(16))),l(e,Fe);case 6:return s(e,Le),s(e,t.segmentPrefix),s(e,d(r.toString(16))),l(e,Me);case 7:return s(e,Be),s(e,t.segmentPrefix),s(e,d(r.toString(16))),l(e,je);default:throw Error(i(397))}}(t,e.responseState,n.formatContext,n.id),Rn(e,t,n),function(e,t){switch(t.insertionMode){case 0:case 1:return l(e,Ee);case 2:return l(e,Te);case 3:return l(e,_e);case 4:return l(e,Ne);case 5:return l(e,Ie);case 6:return l(e,Ge);case 7:return l(e,He);default:throw Error(i(397))}}(t,n.formatContext)}function _n(e,t,n){for(var r=n.completedSegments,o=0;o<r.length;o++)On(e,t,n,r[o]);if(r.length=0,e=e.responseState,r=n.id,n=n.rootSegmentID,s(t,e.startInlineScript),e.sentCompleteBoundaryFunction?s(t,qe):(e.sentCompleteBoundaryFunction=!0,s(t,Ke)),null===r)throw Error(i(395));return n=d(n.toString(16)),s(t,r),s(t,Xe),s(t,e.segmentPrefix),s(t,n),l(t,Ye)}function On(e,t,n,r){if(2===r.status)return!0;var o=r.id;if(-1===o){if(-1===(r.id=n.rootSegmentID))throw Error(i(392));return An(e,t,r)}return An(e,t,r),s(t,(e=e.responseState).startInlineScript),e.sentCompleteSegmentFunction?s(t,We):(e.sentCompleteSegmentFunction=!0,s(t,Ve)),s(t,e.segmentPrefix),s(t,o=d(o.toString(16))),s(t,ze),s(t,e.placeholderPrefix),s(t,o),l(t,Ue)}function Dn(e,t){o=new Uint8Array(512),a=0;try{var n=e.completedRootSegment;if(null!==n&&0===e.pendingRootTasks){Rn(e,t,n),e.completedRootSegment=null;var r=e.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)s(t,r[n]);n<r.length&&l(t,r[n])}var c,h=e.clientRenderedBoundaries;for(c=0;c<h.length;c++){var f=h[c];r=t;var p=e.responseState,v=f.id,g=f.errorDigest,m=f.errorMessage,y=f.errorComponentStack;if(s(r,p.startInlineScript),p.sentClientRenderFunction?s(r,Ze):(p.sentClientRenderFunction=!0,s(r,Qe)),null===v)throw Error(i(395));if(s(r,v),s(r,Je),(g||m||y)&&(s(r,et),s(r,d(nt(g||"")))),(m||y)&&(s(r,et),s(r,d(nt(m||"")))),y&&(s(r,et),s(r,d(nt(y)))),!l(r,$e))return e.destination=null,c++,void h.splice(0,c)}h.splice(0,c);var w=e.completedBoundaries;for(c=0;c<w.length;c++)if(!_n(e,t,w[c]))return e.destination=null,c++,void w.splice(0,c);w.splice(0,c),u(t),o=new Uint8Array(512),a=0;var b=e.partialBoundaries;for(c=0;c<b.length;c++){var C=b[c];e:{h=e,f=t;var S=C.completedSegments;for(p=0;p<S.length;p++)if(!On(h,f,C,S[p])){p++,S.splice(0,p);var E=!1;break e}S.splice(0,p),E=!0}if(!E)return e.destination=null,c++,void b.splice(0,c)}b.splice(0,c);var k=e.completedBoundaries;for(c=0;c<k.length;c++)if(!_n(e,t,k[c]))return e.destination=null,c++,void k.splice(0,c);k.splice(0,c)}finally{u(t),0===e.allPendingTasks&&0===e.pingedTasks.length&&0===e.clientRenderedBoundaries.length&&0===e.completedBoundaries.length&&t.close()}}function Nn(e,t){try{var n=e.abortableTasks;n.forEach((function(n){return Sn(n,e,t)})),n.clear(),null!==e.destination&&Dn(e,e.destination)}catch(r){hn(e,r),fn(e,r)}}t.renderToReadableStream=function(e,t){return new Promise((function(n,r){var i,o,a=new Promise((function(e,t){o=e,i=t})),s=function(e,t,n,r,i,o,a,s,l){var u=[],c=new Set;return(n=dn(t={destination:null,responseState:t,progressiveChunkSize:void 0===r?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:c,pingedTasks:u,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:void 0===i?ln:i,onAllReady:void 0===o?un:o,onShellReady:void 0===a?un:a,onShellError:void 0===s?un:s,onFatalError:void 0===l?un:l},0,null,n,!1,!1)).parentFlushed=!0,e=cn(t,e,null,n,c,St,null,Pt),u.push(e),t}(e,function(e,t,n,r,i){e=void 0===e?"":e,t=void 0===t?O:h('<script nonce="'+T(t)+'">');var o=[];if(void 0!==n&&o.push(t,d((""+n).replace(I,L)),D),void 0!==r)for(n=0;n<r.length;n++)o.push(N,d(T(r[n])),F);if(void 0!==i)for(r=0;r<i.length;r++)o.push(P,d(T(i[r])),F);return{bootstrapChunks:o,startInlineScript:t,placeholderPrefix:h(e+"P:"),segmentPrefix:h(e+"S:"),boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}(t?t.identifierPrefix:void 0,t?t.nonce:void 0,t?t.bootstrapScriptContent:void 0,t?t.bootstrapScripts:void 0,t?t.bootstrapModules:void 0),function(e){return M("http://www.w3.org/2000/svg"===e?2:"http://www.w3.org/1998/Math/MathML"===e?3:0,null)}(t?t.namespaceURI:void 0),t?t.progressiveChunkSize:void 0,t?t.onError:void 0,o,(function(){var e=new ReadableStream({type:"bytes",pull:function(e){if(1===s.status)s.status=2,f(e,s.fatalError);else if(2!==s.status&&null===s.destination){s.destination=e;try{Dn(s,e)}catch(t){hn(s,t),fn(s,t)}}},cancel:function(){Nn(s)}},{highWaterMark:0});e.allReady=a,n(e)}),(function(e){a.catch((function(){})),r(e)}),i);if(t&&t.signal){var l=t.signal;l.addEventListener("abort",(function e(){Nn(s,l.reason),l.removeEventListener("abort",e)}))}xn(s)}))},t.version="18.2.0"},4463:function(e,t,n){"use strict";var r=n(2791),i=n(5296);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function v(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function w(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),S=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),R=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var F=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=F&&e[F]||e["@@iterator"])?e:null}var L,M=Object.assign;function G(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var B=!1;function j(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?G(e):""}function H(e){switch(e.tag){case 5:return G(e.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return e=j(e.type,!1);case 11:return e=j(e.type.render,!1);case 1:return e=j(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case S:return"Portal";case x:return"Profiler";case k:return"StrictMode";case _:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case R:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case N:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function z(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function U(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=U(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=U(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=z(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Z(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function J(e,t){Z(e,t);var n=z(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,z(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+z(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:z(n)}}function oe(e,t){var n=z(t.value),r=z(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce,de=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var me=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function Ce(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,Ee=null,ke=null;function xe(e){if(e=wi(e)){if("function"!==typeof Se)throw Error(o(280));var t=e.stateNode;t&&(t=Ci(t),Se(e.stateNode,e.type,t))}}function Te(e){Ee?ke?ke.push(e):ke=[e]:Ee=e}function Re(){if(Ee){var e=Ee,t=ke;if(ke=Ee=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function Ae(e,t){return e(t)}function _e(){}var Oe=!1;function De(e,t,n){if(Oe)return e(t,n);Oe=!0;try{return Ae(e,t,n)}finally{Oe=!1,(null!==Ee||null!==ke)&&(_e(),Re())}}function Ne(e,t){var n=e.stateNode;if(null===n)return null;var r=Ci(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Pe=!1;if(c)try{var Fe={};Object.defineProperty(Fe,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Fe,Fe),window.removeEventListener("test",Fe,Fe)}catch(ce){Pe=!1}function Ie(e,t,n,r,i,o,a,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Le=!1,Me=null,Ge=!1,Be=null,je={onError:function(e){Le=!0,Me=e}};function He(e,t,n,r,i,o,a,s,l){Le=!1,Me=null,Ie.apply(je,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function ze(e){if(Ve(e)!==e)throw Error(o(188))}function Ue(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return ze(i),e;if(a===r)return ze(i),t;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=a;break}if(l===r){s=!0,r=i,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,r=i;break}if(l===r){s=!0,r=a,n=i;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var qe=i.unstable_scheduleCallback,Xe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Qe=i.unstable_requestPaint,Ze=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,$e=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ut=64,ct=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~i;0!==s?r=dt(s):0!==(o&=a)&&(r=dt(o))}else 0!==(a=n&~i)?r=dt(a):0!==o&&(r=dt(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var wt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Ct,St,Et,kt,xt,Tt=!1,Rt=[],At=null,_t=null,Ot=null,Dt=new Map,Nt=new Map,Pt=[],Ft="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function It(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":_t=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":Dt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nt.delete(t.pointerId)}}function Lt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=wi(t))&&St(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Mt(e){var t=yi(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void xt(e.priority,(function(){Et(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Gt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wi(n))&&St(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Bt(e,t,n){Gt(e)&&n.delete(t)}function jt(){Tt=!1,null!==At&&Gt(At)&&(At=null),null!==_t&&Gt(_t)&&(_t=null),null!==Ot&&Gt(Ot)&&(Ot=null),Dt.forEach(Bt),Nt.forEach(Bt)}function Ht(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,jt)))}function Vt(e){function t(t){return Ht(t,e)}if(0<Rt.length){Ht(Rt[0],e);for(var n=1;n<Rt.length;n++){var r=Rt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==At&&Ht(At,e),null!==_t&&Ht(_t,e),null!==Ot&&Ht(Ot,e),Dt.forEach(t),Nt.forEach(t),n=0;n<Pt.length;n++)(r=Pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Mt(n),null===n.blockedOn&&Pt.shift()}var Wt=b.ReactCurrentBatchConfig,zt=!0;function Ut(e,t,n,r){var i=wt,o=Wt.transition;Wt.transition=null;try{wt=1,qt(e,t,n,r)}finally{wt=i,Wt.transition=o}}function Kt(e,t,n,r){var i=wt,o=Wt.transition;Wt.transition=null;try{wt=4,qt(e,t,n,r)}finally{wt=i,Wt.transition=o}}function qt(e,t,n,r){if(zt){var i=Yt(e,t,n,r);if(null===i)zr(e,t,r,Xt,n),It(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return At=Lt(At,e,t,n,r,i),!0;case"dragenter":return _t=Lt(_t,e,t,n,r,i),!0;case"mouseover":return Ot=Lt(Ot,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Dt.set(o,Lt(Dt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Nt.set(o,Lt(Nt.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(It(e,r),4&t&&-1<Ft.indexOf(e)){for(;null!==i;){var o=wi(i);if(null!==o&&Ct(o),null===(o=Yt(e,t,n,r))&&zr(e,t,r,Xt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else zr(e,t,r,null,n)}}var Xt=null;function Yt(e,t,n,r){if(Xt=null,null!==(e=yi(e=Ce(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Zt=null,Jt=null,$t=null;function en(){if($t)return $t;var e,t,n=Jt,r=n.length,i="value"in Zt?Zt.value:Zt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return $t=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=on(un),dn=M({},un,{view:0,detail:0}),hn=on(dn),fn=M({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=on(fn),vn=on(M({},fn,{dataTransfer:0})),gn=on(M({},dn,{relatedTarget:0})),mn=on(M({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=M({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wn=on(yn),bn=on(M({},un,{data:0})),Cn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function xn(){return kn}var Tn=M({},dn,{key:function(e){if(e.key){var t=Cn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Rn=on(Tn),An=on(M({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_n=on(M({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),On=on(M({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=M({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nn=on(Dn),Pn=[9,13,27,32],Fn=c&&"CompositionEvent"in window,In=null;c&&"documentMode"in document&&(In=document.documentMode);var Ln=c&&"TextEvent"in window&&!In,Mn=c&&(!Fn||In&&8<In&&11>=In),Gn=String.fromCharCode(32),Bn=!1;function jn(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function Un(e,t,n,r){Te(r),0<(t=Kr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,qn=null;function Xn(e){Gr(e,0)}function Yn(e){if(q(bi(e)))return e}function Qn(e,t){if("change"===e)return t}var Zn=!1;if(c){var Jn;if(c){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Jn=$n}else Jn=!1;Zn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Kn&&(Kn.detachEvent("onpropertychange",nr),qn=Kn=null)}function nr(e){if("value"===e.propertyName&&Yn(qn)){var t=[];Un(t,qn,e,Ce(e)),De(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),qn=n,(Kn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(qn)}function or(e,t){if("click"===e)return Yn(t)}function ar(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=cr(n,o);var a=cr(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,mr=null,yr=null,wr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wr||null==gr||gr!==X(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Kr(mr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function Cr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sr={animationend:Cr("Animation","AnimationEnd"),animationiteration:Cr("Animation","AnimationIteration"),animationstart:Cr("Animation","AnimationStart"),transitionend:Cr("Transition","TransitionEnd")},Er={},kr={};function xr(e){if(Er[e])return Er[e];if(!Sr[e])return e;var t,n=Sr[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return Er[e]=n[t];return e}c&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete Sr.animationend.animation,delete Sr.animationiteration.animation,delete Sr.animationstart.animation),"TransitionEvent"in window||delete Sr.transitionend.transition);var Tr=xr("animationend"),Rr=xr("animationiteration"),Ar=xr("animationstart"),_r=xr("transitionend"),Or=new Map,Dr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(e,t){Or.set(e,t),l(t,[e])}for(var Pr=0;Pr<Dr.length;Pr++){var Fr=Dr[Pr];Nr(Fr.toLowerCase(),"on"+(Fr[0].toUpperCase()+Fr.slice(1)))}Nr(Tr,"onAnimationEnd"),Nr(Rr,"onAnimationIteration"),Nr(Ar,"onAnimationStart"),Nr("dblclick","onDoubleClick"),Nr("focusin","onFocus"),Nr("focusout","onBlur"),Nr(_r,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ir="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ir));function Mr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,s,l,u){if(He.apply(this,arguments),Le){if(!Le)throw Error(o(198));var c=Me;Le=!1,Me=null,Ge||(Ge=!0,Be=c)}}(r,t,void 0,e),e.currentTarget=null}function Gr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break e;Mr(i,s,u),o=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,u=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break e;Mr(i,s,u),o=l}}}if(Ge)throw e=Be,Ge=!1,Be=null,e}function Br(e,t){var n=t[vi];void 0===n&&(n=t[vi]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function jr(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var Hr="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[Hr]){e[Hr]=!0,a.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||jr(t,!1,e),jr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Hr]||(t[Hr]=!0,jr("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Qt(t)){case 1:var i=Ut;break;case 4:i=Kt;break;default:i=qt}n=i.bind(null,t,n,e),i=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function zr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=yi(s)))return;if(5===(l=a.tag)||6===l){r=o=a;continue e}s=s.parentNode}}r=r.return}De((function(){var r=o,i=Ce(n),a=[];e:{var s=Or.get(e);if(void 0!==s){var l=cn,u=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Rn;break;case"focusin":u="focus",l=gn;break;case"focusout":u="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=_n;break;case Tr:case Rr:case Ar:l=mn;break;case _r:l=On;break;case"scroll":l=hn;break;case"wheel":l=Nn;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var c=0!==(4&t),d=!c&&"scroll"===e,h=c?null!==s?s+"Capture":null:s;c=[];for(var f,p=r;null!==p;){var v=(f=p).stateNode;if(5===f.tag&&null!==v&&(f=v,null!==h&&(null!=(v=Ne(p,h))&&c.push(Ur(p,v,f)))),d)break;p=p.return}0<c.length&&(s=new l(s,u,null,n,i),a.push({event:s,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===be||!(u=n.relatedTarget||n.fromElement)||!yi(u)&&!u[pi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?yi(u):null)&&(u!==(d=Ve(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=pn,v="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(c=An,v="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?s:bi(l),f=null==u?s:bi(u),(s=new c(v,p+"leave",l,n,i)).target=d,s.relatedTarget=f,v=null,yi(i)===r&&((c=new c(h,p+"enter",u,n,i)).target=f,c.relatedTarget=d,v=c),d=v,l&&u)e:{for(h=u,p=0,f=c=l;f;f=qr(f))p++;for(f=0,v=h;v;v=qr(v))f++;for(;0<p-f;)c=qr(c),p--;for(;0<f-p;)h=qr(h),f--;for(;p--;){if(c===h||null!==h&&c===h.alternate)break e;c=qr(c),h=qr(h)}c=null}else c=null;null!==l&&Xr(a,s,l,c,!1),null!==u&&null!==d&&Xr(a,d,u,c,!0)}if("select"===(l=(s=r?bi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Qn;else if(zn(s))if(Zn)g=ar;else{g=ir;var m=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(e,r))?Un(a,g,n,i):(m&&m(e,s,r),"focusout"===e&&(m=s._wrapperState)&&m.controlled&&"number"===s.type&&ee(s,"number",s.value)),m=r?bi(r):window,e){case"focusin":(zn(m)||"true"===m.contentEditable)&&(gr=m,mr=r,yr=null);break;case"focusout":yr=mr=gr=null;break;case"mousedown":wr=!0;break;case"contextmenu":case"mouseup":case"dragend":wr=!1,br(a,n,i);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":br(a,n,i)}var y;if(Fn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Vn?jn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(Mn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Vn&&(y=en()):(Jt="value"in(Zt=i)?Zt.value:Zt.textContent,Vn=!0)),0<(m=Kr(r,w)).length&&(w=new bn(w,e,null,n,i),a.push({event:w,listeners:m}),y?w.data=y:null!==(y=Hn(n))&&(w.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return Hn(t);case"keypress":return 32!==t.which?null:(Bn=!0,Gn);case"textInput":return(e=t.data)===Gn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Fn&&jn(e,t)?(e=en(),$t=Jt=Zt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(i=new bn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=y))}Gr(a,t)}))}function Ur(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Ne(e,n))&&r.unshift(Ur(e,o,i)),null!=(o=Ne(e,t))&&r.push(Ur(e,o,i))),e=e.return}return r}function qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,u=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==u&&(s=u,i?null!=(l=Ne(n,o))&&a.unshift(Ur(n,l,s)):i||null!=(l=Ne(n,o))&&a.push(Ur(n,l,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Yr=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function Zr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Qr,"")}function Jr(e,t,n){if(t=Zr(t),Zr(e)!==t&&n)throw Error(o(425))}function $r(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Vt(t)}function ui(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ci(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,fi="__reactProps$"+di,pi="__reactContainer$"+di,vi="__reactEvents$"+di,gi="__reactListeners$"+di,mi="__reactHandles$"+di;function yi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ci(e);null!==e;){if(n=e[hi])return n;e=ci(e)}return t}n=(e=n).parentNode}return null}function wi(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function Ci(e){return e[fi]||null}var Si=[],Ei=-1;function ki(e){return{current:e}}function xi(e){0>Ei||(e.current=Si[Ei],Si[Ei]=null,Ei--)}function Ti(e,t){Ei++,Si[Ei]=e.current,e.current=t}var Ri={},Ai=ki(Ri),_i=ki(!1),Oi=Ri;function Di(e,t){var n=e.type.contextTypes;if(!n)return Ri;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ni(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pi(){xi(_i),xi(Ai)}function Fi(e,t,n){if(Ai.current!==Ri)throw Error(o(168));Ti(Ai,t),Ti(_i,n)}function Ii(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,W(e)||"Unknown",i));return M({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ri,Oi=Ai.current,Ti(Ai,e),Ti(_i,_i.current),!0}function Mi(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Ii(e,t,Oi),r.__reactInternalMemoizedMergedChildContext=e,xi(_i),xi(Ai),Ti(Ai,e)):xi(_i),Ti(_i,n)}var Gi=null,Bi=!1,ji=!1;function Hi(e){null===Gi?Gi=[e]:Gi.push(e)}function Vi(){if(!ji&&null!==Gi){ji=!0;var e=0,t=wt;try{var n=Gi;for(wt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Gi=null,Bi=!1}catch(i){throw null!==Gi&&(Gi=Gi.slice(e+1)),qe($e,Vi),i}finally{wt=t,ji=!1}}return null}var Wi=[],zi=0,Ui=null,Ki=0,qi=[],Xi=0,Yi=null,Qi=1,Zi="";function Ji(e,t){Wi[zi++]=Ki,Wi[zi++]=Ui,Ui=e,Ki=t}function $i(e,t,n){qi[Xi++]=Qi,qi[Xi++]=Zi,qi[Xi++]=Yi,Yi=e;var r=Qi;e=Zi;var i=32-at(r)-1;r&=~(1<<i),n+=1;var o=32-at(t)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Qi=1<<32-at(t)+i|n<<i|r,Zi=o+e}else Qi=1<<o|n<<i|r,Zi=e}function eo(e){null!==e.return&&(Ji(e,1),$i(e,1,0))}function to(e){for(;e===Ui;)Ui=Wi[--zi],Wi[zi]=null,Ki=Wi[--zi],Wi[zi]=null;for(;e===Yi;)Yi=qi[--Xi],qi[Xi]=null,Zi=qi[--Xi],qi[Xi]=null,Qi=qi[--Xi],qi[Xi]=null}var no=null,ro=null,io=!1,oo=null;function ao(e,t){var n=Nu(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function so(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=ui(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Qi,overflow:Zi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Nu(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function lo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function uo(e){if(io){var t=ro;if(t){var n=t;if(!so(e,t)){if(lo(e))throw Error(o(418));t=ui(n.nextSibling);var r=no;t&&so(e,t)?ao(r,n):(e.flags=-4097&e.flags|2,io=!1,no=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,no=e}}}function co(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!io)return co(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ro)){if(lo(e))throw fo(),Error(o(418));for(;t;)ao(e,t),t=ui(t.nextSibling)}if(co(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=ui(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?ui(e.stateNode.nextSibling):null;return!0}function fo(){for(var e=ro;e;)e=ui(e.nextSibling)}function po(){ro=no=null,io=!1}function vo(e){null===oo?oo=[e]:oo.push(e)}var go=b.ReactCurrentBatchConfig;function mo(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var yo=ki(null),wo=null,bo=null,Co=null;function So(){Co=bo=wo=null}function Eo(e){var t=yo.current;xi(yo),e._currentValue=t}function ko(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function xo(e,t){wo=e,Co=bo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function To(e){var t=e._currentValue;if(Co!==e)if(e={context:e,memoizedValue:t,next:null},null===bo){if(null===wo)throw Error(o(308));bo=e,wo.dependencies={lanes:0,firstContext:e}}else bo=bo.next=e;return t}var Ro=null;function Ao(e){null===Ro?Ro=[e]:Ro.push(e)}function _o(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ao(t)):(n.next=i.next,i.next=n),t.interleaved=n,Oo(e,r)}function Oo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Do=!1;function No(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Po(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Io(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&_l)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Oo(e,n)}return null===(i=r.interleaved)?(t.next=t,Ao(r)):(t.next=i.next,i.next=t),r.interleaved=t,Oo(e,n)}function Lo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Mo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Go(e,t,n,r){var i=e.updateQueue;Do=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,u=l.next;l.next=null,null===a?o=u:a.next=u,a=l;var c=e.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==a&&(null===s?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(null!==o){var d=i.baseState;for(a=0,c=u=l=null,s=o;;){var h=s.lane,f=s.eventTime;if((r&h)===h){null!==c&&(c=c.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,v=s;switch(h=t,f=n,v.tag){case 1:if("function"===typeof(p=v.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=v.payload)?p.call(f,d,h):p)||void 0===h)break e;d=M({},d,h);break e;case 2:Do=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[s]:h.push(s))}else f={eventTime:f,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(u=c=f,l=d):c=c.next=f,a|=h;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(h=s).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===c&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Ml|=a,e.lanes=a,e.memoizedState=d}}function Bo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var jo=(new r.Component).refs;function Ho(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Vo={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tu(),i=nu(e),o=Fo(r,i);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Io(e,o,i))&&(ru(t,e,i,r),Lo(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tu(),i=nu(e),o=Fo(r,i);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Io(e,o,i))&&(ru(t,e,i,r),Lo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tu(),r=nu(e),i=Fo(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Io(e,i,r))&&(ru(t,e,r,n),Lo(t,e,r))}};function Wo(e,t,n,r,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,o))}function zo(e,t,n){var r=!1,i=Ri,o=t.contextType;return"object"===typeof o&&null!==o?o=To(o):(i=Ni(t)?Oi:Ai.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?Di(e,i):Ri),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Vo,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Uo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Vo.enqueueReplaceState(t,t.state,null)}function Ko(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=jo,No(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=To(o):(o=Ni(t)?Oi:Ai.current,i.context=Di(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(Ho(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Vo.enqueueReplaceState(i,i.state,null),Go(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function qo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;t===jo&&(t=i.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function Xo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yo(e){return(0,e._init)(e._payload)}function Qo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Fu(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Gu(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){var o=n.type;return o===E?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===N&&Yo(o)===t.type)?((r=i(t,n.props)).ref=qo(e,t,n),r.return=e,r):((r=Iu(n.type,n.key,n.props,null,e.mode,r)).ref=qo(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bu(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Lu(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Gu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case C:return(n=Iu(t.type,t.key,t.props,null,e.mode,n)).ref=qo(e,null,t),n.return=e,n;case S:return(t=Bu(t,e.mode,n)).return=e,t;case N:return h(e,(0,t._init)(t._payload),n)}if(te(t)||I(t))return(t=Lu(t,e.mode,n,null)).return=e,t;Xo(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case C:return n.key===i?u(e,t,n,r):null;case S:return n.key===i?c(e,t,n,r):null;case N:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||I(n))return null!==i?null:d(e,t,n,r,null);Xo(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case C:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case S:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case N:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||I(r))return d(t,e=e.get(n)||null,r,i,null);Xo(t,r)}return null}function v(i,o,s,l){for(var u=null,c=null,d=o,v=o=0,g=null;null!==d&&v<s.length;v++){d.index>v?(g=d,d=null):g=d.sibling;var m=f(i,d,s[v],l);if(null===m){null===d&&(d=g);break}e&&d&&null===m.alternate&&t(i,d),o=a(m,o,v),null===c?u=m:c.sibling=m,c=m,d=g}if(v===s.length)return n(i,d),io&&Ji(i,v),u;if(null===d){for(;v<s.length;v++)null!==(d=h(i,s[v],l))&&(o=a(d,o,v),null===c?u=d:c.sibling=d,c=d);return io&&Ji(i,v),u}for(d=r(i,d);v<s.length;v++)null!==(g=p(d,i,v,s[v],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?v:g.key),o=a(g,o,v),null===c?u=g:c.sibling=g,c=g);return e&&d.forEach((function(e){return t(i,e)})),io&&Ji(i,v),u}function g(i,s,l,u){var c=I(l);if("function"!==typeof c)throw Error(o(150));if(null==(l=c.call(l)))throw Error(o(151));for(var d=c=null,v=s,g=s=0,m=null,y=l.next();null!==v&&!y.done;g++,y=l.next()){v.index>g?(m=v,v=null):m=v.sibling;var w=f(i,v,y.value,u);if(null===w){null===v&&(v=m);break}e&&v&&null===w.alternate&&t(i,v),s=a(w,s,g),null===d?c=w:d.sibling=w,d=w,v=m}if(y.done)return n(i,v),io&&Ji(i,g),c;if(null===v){for(;!y.done;g++,y=l.next())null!==(y=h(i,y.value,u))&&(s=a(y,s,g),null===d?c=y:d.sibling=y,d=y);return io&&Ji(i,g),c}for(v=r(i,v);!y.done;g++,y=l.next())null!==(y=p(v,i,g,y.value,u))&&(e&&null!==y.alternate&&v.delete(null===y.key?g:y.key),s=a(y,s,g),null===d?c=y:d.sibling=y,d=y);return e&&v.forEach((function(e){return t(i,e)})),io&&Ji(i,g),c}return function e(r,o,a,l){if("object"===typeof a&&null!==a&&a.type===E&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case C:e:{for(var u=a.key,c=o;null!==c;){if(c.key===u){if((u=a.type)===E){if(7===c.tag){n(r,c.sibling),(o=i(c,a.props.children)).return=r,r=o;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===N&&Yo(u)===c.type){n(r,c.sibling),(o=i(c,a.props)).ref=qo(r,c,a),o.return=r,r=o;break e}n(r,c);break}t(r,c),c=c.sibling}a.type===E?((o=Lu(a.props.children,r.mode,l,a.key)).return=r,r=o):((l=Iu(a.type,a.key,a.props,null,r.mode,l)).ref=qo(r,o,a),l.return=r,r=l)}return s(r);case S:e:{for(c=a.key;null!==o;){if(o.key===c){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(r,o.sibling),(o=i(o,a.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Bu(a,r.mode,l)).return=r,r=o}return s(r);case N:return e(r,o,(c=a._init)(a._payload),l)}if(te(a))return v(r,o,a,l);if(I(a))return g(r,o,a,l);Xo(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,a)).return=r,r=o):(n(r,o),(o=Gu(a,r.mode,l)).return=r,r=o),s(r)):n(r,o)}}var Zo=Qo(!0),Jo=Qo(!1),$o={},ea=ki($o),ta=ki($o),na=ki($o);function ra(e){if(e===$o)throw Error(o(174));return e}function ia(e,t){switch(Ti(na,t),Ti(ta,e),Ti(ea,$o),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xi(ea),Ti(ea,t)}function oa(){xi(ea),xi(ta),xi(na)}function aa(e){ra(na.current);var t=ra(ea.current),n=le(t,e.type);t!==n&&(Ti(ta,e),Ti(ea,n))}function sa(e){ta.current===e&&(xi(ea),xi(ta))}var la=ki(0);function ua(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ca=[];function da(){for(var e=0;e<ca.length;e++)ca[e]._workInProgressVersionPrimary=null;ca.length=0}var ha=b.ReactCurrentDispatcher,fa=b.ReactCurrentBatchConfig,pa=0,va=null,ga=null,ma=null,ya=!1,wa=!1,ba=0,Ca=0;function Sa(){throw Error(o(321))}function Ea(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ka(e,t,n,r,i,a){if(pa=a,va=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ha.current=null===e||null===e.memoizedState?ss:ls,e=n(r,i),wa){a=0;do{if(wa=!1,ba=0,25<=a)throw Error(o(301));a+=1,ma=ga=null,t.updateQueue=null,ha.current=us,e=n(r,i)}while(wa)}if(ha.current=as,t=null!==ga&&null!==ga.next,pa=0,ma=ga=va=null,ya=!1,t)throw Error(o(300));return e}function xa(){var e=0!==ba;return ba=0,e}function Ta(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ma?va.memoizedState=ma=e:ma=ma.next=e,ma}function Ra(){if(null===ga){var e=va.alternate;e=null!==e?e.memoizedState:null}else e=ga.next;var t=null===ma?va.memoizedState:ma.next;if(null!==t)ma=t,ga=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ga=e).memoizedState,baseState:ga.baseState,baseQueue:ga.baseQueue,queue:ga.queue,next:null},null===ma?va.memoizedState=ma=e:ma=ma.next=e}return ma}function Aa(e,t){return"function"===typeof t?t(e):t}function _a(e){var t=Ra(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=ga,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=s=null,u=null,c=a;do{var d=c.lane;if((pa&d)===d)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=h,s=r):u=u.next=h,va.lanes|=d,Ml|=d}c=c.next}while(null!==c&&c!==a);null===u?s=r:u.next=l,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,va.lanes|=a,Ml|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Oa(e){var t=Ra(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);sr(a,t.memoizedState)||(bs=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Da(){}function Na(e,t){var n=va,r=Ra(),i=t(),a=!sr(r.memoizedState,i);if(a&&(r.memoizedState=i,bs=!0),r=r.queue,za(Ia.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ma&&1&ma.memoizedState.tag){if(n.flags|=2048,Ba(9,Fa.bind(null,n,r,i,t),void 0,null),null===Ol)throw Error(o(349));0!==(30&pa)||Pa(n,t,i)}return i}function Pa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=va.updateQueue)?(t={lastEffect:null,stores:null},va.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Fa(e,t,n,r){t.value=n,t.getSnapshot=r,La(t)&&Ma(e)}function Ia(e,t,n){return n((function(){La(t)&&Ma(e)}))}function La(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Ma(e){var t=Oo(e,1);null!==t&&ru(t,e,1,-1)}function Ga(e){var t=Ta();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,va,e),[t.memoizedState,e]}function Ba(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=va.updateQueue)?(t={lastEffect:null,stores:null},va.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ja(){return Ra().memoizedState}function Ha(e,t,n,r){var i=Ta();va.flags|=e,i.memoizedState=Ba(1|t,n,void 0,void 0===r?null:r)}function Va(e,t,n,r){var i=Ra();r=void 0===r?null:r;var o=void 0;if(null!==ga){var a=ga.memoizedState;if(o=a.destroy,null!==r&&Ea(r,a.deps))return void(i.memoizedState=Ba(t,n,o,r))}va.flags|=e,i.memoizedState=Ba(1|t,n,o,r)}function Wa(e,t){return Ha(8390656,8,e,t)}function za(e,t){return Va(2048,8,e,t)}function Ua(e,t){return Va(4,2,e,t)}function Ka(e,t){return Va(4,4,e,t)}function qa(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Xa(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Va(4,4,qa.bind(null,t,e),n)}function Ya(){}function Qa(e,t){var n=Ra();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ea(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Za(e,t){var n=Ra();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ea(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ja(e,t,n){return 0===(21&pa)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),va.lanes|=n,Ml|=n,e.baseState=!0),t)}function $a(e,t){var n=wt;wt=0!==n&&4>n?n:4,e(!0);var r=fa.transition;fa.transition={};try{e(!1),t()}finally{wt=n,fa.transition=r}}function es(){return Ra().memoizedState}function ts(e,t,n){var r=nu(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))is(t,n);else if(null!==(n=_o(e,t,n,r))){ru(n,e,r,tu()),os(n,t,r)}}function ns(e,t,n){var r=nu(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))is(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,a)){var l=t.interleaved;return null===l?(i.next=i,Ao(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(u){}null!==(n=_o(e,t,i,r))&&(ru(n,e,r,i=tu()),os(n,t,r))}}function rs(e){var t=e.alternate;return e===va||null!==t&&t===va}function is(e,t){wa=ya=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function os(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var as={readContext:To,useCallback:Sa,useContext:Sa,useEffect:Sa,useImperativeHandle:Sa,useInsertionEffect:Sa,useLayoutEffect:Sa,useMemo:Sa,useReducer:Sa,useRef:Sa,useState:Sa,useDebugValue:Sa,useDeferredValue:Sa,useTransition:Sa,useMutableSource:Sa,useSyncExternalStore:Sa,useId:Sa,unstable_isNewReconciler:!1},ss={readContext:To,useCallback:function(e,t){return Ta().memoizedState=[e,void 0===t?null:t],e},useContext:To,useEffect:Wa,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ha(4194308,4,qa.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ha(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ha(4,2,e,t)},useMemo:function(e,t){var n=Ta();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ta();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,va,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ta().memoizedState=e},useState:Ga,useDebugValue:Ya,useDeferredValue:function(e){return Ta().memoizedState=e},useTransition:function(){var e=Ga(!1),t=e[0];return e=$a.bind(null,e[1]),Ta().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=va,i=Ta();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Ol)throw Error(o(349));0!==(30&pa)||Pa(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Wa(Ia.bind(null,r,a,e),[e]),r.flags|=2048,Ba(9,Fa.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=Ta(),t=Ol.identifierPrefix;if(io){var n=Zi;t=":"+t+"R"+(n=(Qi&~(1<<32-at(Qi)-1)).toString(32)+n),0<(n=ba++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Ca++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ls={readContext:To,useCallback:Qa,useContext:To,useEffect:za,useImperativeHandle:Xa,useInsertionEffect:Ua,useLayoutEffect:Ka,useMemo:Za,useReducer:_a,useRef:ja,useState:function(){return _a(Aa)},useDebugValue:Ya,useDeferredValue:function(e){return Ja(Ra(),ga.memoizedState,e)},useTransition:function(){return[_a(Aa)[0],Ra().memoizedState]},useMutableSource:Da,useSyncExternalStore:Na,useId:es,unstable_isNewReconciler:!1},us={readContext:To,useCallback:Qa,useContext:To,useEffect:za,useImperativeHandle:Xa,useInsertionEffect:Ua,useLayoutEffect:Ka,useMemo:Za,useReducer:Oa,useRef:ja,useState:function(){return Oa(Aa)},useDebugValue:Ya,useDeferredValue:function(e){var t=Ra();return null===ga?t.memoizedState=e:Ja(t,ga.memoizedState,e)},useTransition:function(){return[Oa(Aa)[0],Ra().memoizedState]},useMutableSource:Da,useSyncExternalStore:Na,useId:es,unstable_isNewReconciler:!1};function cs(e,t){try{var n="",r=t;do{n+=H(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function ds(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var fs="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Fo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ul||(Ul=!0,Kl=r),hs(0,t)},n}function vs(e,t,n){(n=Fo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){hs(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){hs(0,t),"function"!==typeof r&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function gs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fs;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Tu.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fo(-1,1)).tag=2,Io(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ws=b.ReactCurrentOwner,bs=!1;function Cs(e,t,n,r){t.child=null===e?Jo(t,null,n,r):Zo(t,e.child,n,r)}function Ss(e,t,n,r,i){n=n.render;var o=t.ref;return xo(t,i),r=ka(e,t,n,r,o,i),n=xa(),null===e||bs?(io&&n&&eo(t),t.flags|=1,Cs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Us(e,t,i))}function Es(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Pu(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Iu(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,ks(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return Us(e,t,i)}return t.flags|=1,(e=Fu(o,r)).ref=t.ref,e.return=t,t.child=e}function ks(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(lr(o,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=o,0===(e.lanes&i))return t.lanes=e.lanes,Us(e,t,i);0!==(131072&e.flags)&&(bs=!0)}}return Rs(e,t,n,r,i)}function xs(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(Fl,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(Fl,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Ti(Fl,Pl),Pl|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ti(Fl,Pl),Pl|=r;return Cs(e,t,i,n),t.child}function Ts(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Rs(e,t,n,r,i){var o=Ni(n)?Oi:Ai.current;return o=Di(t,o),xo(t,i),n=ka(e,t,n,r,o,i),r=xa(),null===e||bs?(io&&r&&eo(t),t.flags|=1,Cs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Us(e,t,i))}function As(e,t,n,r,i){if(Ni(n)){var o=!0;Li(t)}else o=!1;if(xo(t,i),null===t.stateNode)zs(e,t),zo(t,n,r),Ko(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,u=n.contextType;"object"===typeof u&&null!==u?u=To(u):u=Di(t,u=Ni(n)?Oi:Ai.current);var c=n.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||l!==u)&&Uo(t,a,r,u),Do=!1;var h=t.memoizedState;a.state=h,Go(t,r,a,i),l=t.memoizedState,s!==r||h!==l||_i.current||Do?("function"===typeof c&&(Ho(t,n,c,r),l=t.memoizedState),(s=Do||Wo(t,n,s,r,h,l,u))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=u,r=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Po(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:mo(t.type,s),a.props=u,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=To(l):l=Di(t,l=Ni(n)?Oi:Ai.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==d||h!==l)&&Uo(t,a,r,l),Do=!1,h=t.memoizedState,a.state=h,Go(t,r,a,i);var p=t.memoizedState;s!==d||h!==p||_i.current||Do?("function"===typeof f&&(Ho(t,n,f,r),p=t.memoizedState),(u=Do||Wo(t,n,u,r,h,p,l)||!1)?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=l,r=u):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return _s(e,t,n,r,o,i)}function _s(e,t,n,r,i,o){Ts(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&Mi(t,n,!1),Us(e,t,o);r=t.stateNode,ws.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=Zo(t,e.child,null,o),t.child=Zo(t,null,s,o)):Cs(e,t,s,o),t.memoizedState=r.state,i&&Mi(t,n,!0),t.child}function Os(e){var t=e.stateNode;t.pendingContext?Fi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Fi(0,t.context,!1),ia(e,t.containerInfo)}function Ds(e,t,n,r,i){return po(),vo(i),t.flags|=256,Cs(e,t,n,r),t.child}var Ns,Ps,Fs,Is,Ls={dehydrated:null,treeContext:null,retryLane:0};function Ms(e){return{baseLanes:e,cachePool:null,transitions:null}}function Gs(e,t,n){var r,i=t.pendingProps,a=la.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ti(la,1&a),null===e)return uo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,s?(i=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Mu(l,i,0,null),e=Lu(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ms(n),t.memoizedState=Ls,e):Bs(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,s){if(n)return 256&t.flags?(t.flags&=-257,js(e,t,s,r=ds(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Mu({mode:"visible",children:r.children},i,0,null),(a=Lu(a,i,s,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&Zo(t,e.child,null,s),t.child.memoizedState=Ms(s),t.memoizedState=Ls,a);if(0===(1&t.mode))return js(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,js(e,t,s,r=ds(a=Error(o(419)),r,void 0))}if(l=0!==(s&e.childLanes),bs||l){if(null!==(r=Ol)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Oo(e,i),ru(r,e,i,-1))}return gu(),js(e,t,s,r=ds(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Au.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,ro=ui(i.nextSibling),no=t,io=!0,oo=null,null!==e&&(qi[Xi++]=Qi,qi[Xi++]=Zi,qi[Xi++]=Yi,Qi=e.id,Zi=e.overflow,Yi=t),t=Bs(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,a,n);if(s){s=i.fallback,l=t.mode,r=(a=e.child).sibling;var u={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=u,t.deletions=null):(i=Fu(a,u)).subtreeFlags=14680064&a.subtreeFlags,null!==r?s=Fu(r,s):(s=Lu(s,l,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,l=null===(l=e.child.memoizedState)?Ms(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Ls,i}return e=(s=e.child).sibling,i=Fu(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Bs(e,t){return(t=Mu({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function js(e,t,n,r){return null!==r&&vo(r),Zo(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Hs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ko(e.return,t,n)}function Vs(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Ws(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Cs(e,t,r.children,n),0!==(2&(r=la.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Hs(e,n,t);else if(19===e.tag)Hs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ti(la,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ua(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Vs(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ua(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Vs(t,!0,n,null,o);break;case"together":Vs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Us(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Fu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Fu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ks(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Xs(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Ni(t.type)&&Pi(),qs(t),null;case 3:return r=t.stateNode,oa(),xi(_i),xi(Ai),da(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(su(oo),oo=null))),Ps(e,t),qs(t),null;case 5:sa(t);var i=ra(na.current);if(n=t.type,null!==e&&null!=t.stateNode)Fs(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return qs(t),null}if(e=ra(ea.current),ho(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[hi]=t,r[fi]=a,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(i=0;i<Ir.length;i++)Br(Ir[i],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":Q(r,a),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Br("invalid",r);break;case"textarea":ie(r,a),Br("invalid",r)}for(var l in ye(n,a),i=null,a)if(a.hasOwnProperty(l)){var u=a[l];"children"===l?"string"===typeof u?r.textContent!==u&&(!0!==a.suppressHydrationWarning&&Jr(r.textContent,u,e),i=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==a.suppressHydrationWarning&&Jr(r.textContent,u,e),i=["children",""+u]):s.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Br("scroll",r)}switch(n){case"input":K(r),$(r,a,!0);break;case"textarea":K(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=$r)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[fi]=r,Ns(e,t,!1,!1),t.stateNode=e;e:{switch(l=we(n,r),n){case"dialog":Br("cancel",e),Br("close",e),i=r;break;case"iframe":case"object":case"embed":Br("load",e),i=r;break;case"video":case"audio":for(i=0;i<Ir.length;i++)Br(Ir[i],e);i=r;break;case"source":Br("error",e),i=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),i=r;break;case"details":Br("toggle",e),i=r;break;case"input":Q(e,r),i=Y(e,r),Br("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=M({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Br("invalid",e)}for(a in ye(n,i),u=i)if(u.hasOwnProperty(a)){var c=u[a];"style"===a?ge(e,c):"dangerouslySetInnerHTML"===a?null!=(c=c?c.__html:void 0)&&de(e,c):"children"===a?"string"===typeof c?("textarea"!==n||""!==c)&&he(e,c):"number"===typeof c&&he(e,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=c&&"onScroll"===a&&Br("scroll",e):null!=c&&w(e,a,c,l))}switch(n){case"input":K(e),$(e,r,!1);break;case"textarea":K(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+z(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)Is(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=ra(na.current),ra(ea.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(a=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return qs(t),null;case 13:if(xi(la),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))fo(),po(),t.flags|=98560,a=!1;else if(a=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[hi]=t}else po(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),a=!1}else null!==oo&&(su(oo),oo=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&la.current)?0===Il&&(Il=3):gu())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return oa(),Ps(e,t),null===e&&Vr(t.stateNode.containerInfo),qs(t),null;case 10:return Eo(t.type._context),qs(t),null;case 19:if(xi(la),null===(a=t.memoizedState))return qs(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Ks(a,!1);else{if(0!==Il||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ua(e))){for(t.flags|=128,Ks(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ti(la,1&la.current|2),t.child}e=e.sibling}null!==a.tail&&Ze()>Wl&&(t.flags|=128,r=!0,Ks(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ua(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ks(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!io)return qs(t),null}else 2*Ze()-a.renderingStartTime>Wl&&1073741824!==n&&(t.flags|=128,r=!0,Ks(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ze(),t.sibling=null,n=la.current,Ti(la,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return hu(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ys(e,t){switch(to(t),t.tag){case 1:return Ni(t.type)&&Pi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return oa(),xi(_i),xi(Ai),da(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return sa(t),null;case 13:if(xi(la),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));po()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xi(la),null;case 4:return oa(),null;case 10:return Eo(t.type._context),null;case 22:case 23:return hu(),null;default:return null}}Ns=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ps=function(){},Fs=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,ra(ea.current);var o,a=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),a=[];break;case"select":i=M({},i,{value:void 0}),r=M({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(c in ye(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var l=i[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(a||(a=[]),a.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(a=a||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(a=a||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Br("scroll",e),a||l===u||(a=[])):(a=a||[]).push(c,u))}n&&(a=a||[]).push("style",n);var c=a;(t.updateQueue=c)&&(t.flags|=4)}},Is=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qs=!1,Zs=!1,Js="function"===typeof WeakSet?WeakSet:Set,$s=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){xu(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){xu(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&tl(t,n,o)}i=i.next}while(i!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ol(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[fi],delete t[vi],delete t[gi],delete t[mi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var dl=null,hl=!1;function fl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:Zs||el(n,t);case 6:var r=dl,i=hl;dl=null,fl(e,t,n),hl=i,null!==(dl=r)&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Vt(e)):li(dl,n.stateNode));break;case 4:r=dl,i=hl,dl=n.stateNode.containerInfo,hl=!0,fl(e,t,n),dl=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Zs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&tl(n,t,a),i=i.next}while(i!==r)}fl(e,t,n);break;case 1:if(!Zs&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){xu(n,t,s)}fl(e,t,n);break;case 21:fl(e,t,n);break;case 22:1&n.mode?(Zs=(r=Zs)||null!==n.memoizedState,fl(e,t,n),Zs=r):fl(e,t,n);break;default:fl(e,t,n)}}function vl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Js),t.forEach((function(t){var r=_u.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,hl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===dl)throw Error(o(160));pl(a,s,i),dl=null,hl=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(c){xu(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),yl(e),4&r){try{rl(3,e,e.return),il(3,e)}catch(g){xu(e,e.return,g)}try{rl(5,e,e.return)}catch(g){xu(e,e.return,g)}}break;case 1:gl(t,e),yl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(gl(t,e),yl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){xu(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===a.type&&null!=a.name&&Z(i,a),we(l,s);var c=we(l,a);for(s=0;s<u.length;s+=2){var d=u[s],h=u[s+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):w(i,d,h,c)}switch(l){case"input":J(i,a);break;case"textarea":oe(i,a);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?ne(i,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[fi]=a}catch(g){xu(e,e.return,g)}}break;case 6:if(gl(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){xu(e,e.return,g)}}break;case 3:if(gl(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){xu(e,e.return,g)}break;case 4:default:gl(t,e),yl(e);break;case 13:gl(t,e),yl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Vl=Ze())),4&r&&vl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Zs=(c=Zs)||d,gl(t,e),Zs=c):gl(t,e),yl(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&0!==(1&e.mode))for($s=e,d=e.child;null!==d;){for(h=$s=d;null!==$s;){switch(p=(f=$s).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:el(f,f.return);var v=f.stateNode;if("function"===typeof v.componentWillUnmount){r=f,n=f.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){xu(r,n,g)}}break;case 5:el(f,f.return);break;case 22:if(null!==f.memoizedState){Sl(h);continue}}null!==p?(p.return=f,$s=p):Sl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,c?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,s=void 0!==(u=h.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=ve("display",s))}catch(g){xu(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){xu(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gl(t,e),yl(e),4&r&&vl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cl(e,ll(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;ul(e,ll(e),a);break;default:throw Error(o(161))}}catch(s){xu(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function wl(e,t,n){$s=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==$s;){var i=$s,o=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Qs;if(!a){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Zs;s=Qs;var u=Zs;if(Qs=a,(Zs=l)&&!u)for($s=i;null!==$s;)l=(a=$s).child,22===a.tag&&null!==a.memoizedState?El(i):null!==l?(l.return=a,$s=l):El(i);for(;null!==o;)$s=o,bl(o,t,n),o=o.sibling;$s=i,Qs=s,Zs=u}Cl(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,$s=o):Cl(e)}}function Cl(e){for(;null!==$s;){var t=$s;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Zs||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Zs)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:mo(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Bo(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Bo(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(o(163))}Zs||512&t.flags&&ol(t)}catch(f){xu(t,t.return,f)}}if(t===e){$s=null;break}if(null!==(n=t.sibling)){n.return=t.return,$s=n;break}$s=t.return}}function Sl(e){for(;null!==$s;){var t=$s;if(t===e){$s=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$s=n;break}$s=t.return}}function El(e){for(;null!==$s;){var t=$s;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){xu(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){xu(t,i,l)}}var o=t.return;try{ol(t)}catch(l){xu(t,o,l)}break;case 5:var a=t.return;try{ol(t)}catch(l){xu(t,a,l)}}}catch(l){xu(t,t.return,l)}if(t===e){$s=null;break}var s=t.sibling;if(null!==s){s.return=t.return,$s=s;break}$s=t.return}}var kl,xl=Math.ceil,Tl=b.ReactCurrentDispatcher,Rl=b.ReactCurrentOwner,Al=b.ReactCurrentBatchConfig,_l=0,Ol=null,Dl=null,Nl=0,Pl=0,Fl=ki(0),Il=0,Ll=null,Ml=0,Gl=0,Bl=0,jl=null,Hl=null,Vl=0,Wl=1/0,zl=null,Ul=!1,Kl=null,ql=null,Xl=!1,Yl=null,Ql=0,Zl=0,Jl=null,$l=-1,eu=0;function tu(){return 0!==(6&_l)?Ze():-1!==$l?$l:$l=Ze()}function nu(e){return 0===(1&e.mode)?1:0!==(2&_l)&&0!==Nl?Nl&-Nl:null!==go.transition?(0===eu&&(eu=vt()),eu):0!==(e=wt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function ru(e,t,n,r){if(50<Zl)throw Zl=0,Jl=null,Error(o(185));mt(e,n,r),0!==(2&_l)&&e===Ol||(e===Ol&&(0===(2&_l)&&(Gl|=n),4===Il&&lu(e,Nl)),iu(e,r),1===n&&0===_l&&0===(1&t.mode)&&(Wl=Ze()+500,Bi&&Vi()))}function iu(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-at(o),s=1<<a,l=i[a];-1===l?0!==(s&n)&&0===(s&r)||(i[a]=ft(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var r=ht(e,e===Ol?Nl:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Bi=!0,Hi(e)}(uu.bind(null,e)):Hi(uu.bind(null,e)),ai((function(){0===(6&_l)&&Vi()})),n=null;else{switch(bt(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ou(n,ou.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ou(e,t){if($l=-1,eu=0,0!==(6&_l))throw Error(o(327));var n=e.callbackNode;if(Eu()&&e.callbackNode!==n)return null;var r=ht(e,e===Ol?Nl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mu(e,r);else{t=r;var i=_l;_l|=2;var a=vu();for(Ol===e&&Nl===t||(zl=null,Wl=Ze()+500,fu(e,t));;)try{wu();break}catch(l){pu(e,l)}So(),Tl.current=a,_l=i,null!==Dl?t=0:(Ol=null,Nl=0,t=Il)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=au(e,i))),1===t)throw n=Ll,fu(e,0),lu(e,r),iu(e,Ze()),n;if(6===t)lu(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!sr(o(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=mu(e,r))&&(0!==(a=pt(e))&&(r=a,t=au(e,a))),1===t))throw n=Ll,fu(e,0),lu(e,r),iu(e,Ze()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:Su(e,Hl,zl);break;case 3:if(lu(e,r),(130023424&r)===r&&10<(t=Vl+500-Ze())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tu(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(Su.bind(null,e,Hl,zl),t);break}Su(e,Hl,zl);break;case 4:if(lu(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-at(r);a=1<<s,(s=t[s])>i&&(i=s),r&=~a}if(r=i,10<(r=(120>(r=Ze()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*xl(r/1960))-r)){e.timeoutHandle=ri(Su.bind(null,e,Hl,zl),r);break}Su(e,Hl,zl);break;default:throw Error(o(329))}}}return iu(e,Ze()),e.callbackNode===n?ou.bind(null,e):null}function au(e,t){var n=jl;return e.current.memoizedState.isDehydrated&&(fu(e,t).flags|=256),2!==(e=mu(e,t))&&(t=Hl,Hl=n,null!==t&&su(t)),e}function su(e){null===Hl?Hl=e:Hl.push.apply(Hl,e)}function lu(e,t){for(t&=~Bl,t&=~Gl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function uu(e){if(0!==(6&_l))throw Error(o(327));Eu();var t=ht(e,0);if(0===(1&t))return iu(e,Ze()),null;var n=mu(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=au(e,r))}if(1===n)throw n=Ll,fu(e,0),lu(e,t),iu(e,Ze()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Su(e,Hl,zl),iu(e,Ze()),null}function cu(e,t){var n=_l;_l|=1;try{return e(t)}finally{0===(_l=n)&&(Wl=Ze()+500,Bi&&Vi())}}function du(e){null!==Yl&&0===Yl.tag&&0===(6&_l)&&Eu();var t=_l;_l|=1;var n=Al.transition,r=wt;try{if(Al.transition=null,wt=1,e)return e()}finally{wt=r,Al.transition=n,0===(6&(_l=t))&&Vi()}}function hu(){Pl=Fl.current,xi(Fl)}function fu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Dl)for(n=Dl.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Pi();break;case 3:oa(),xi(_i),xi(Ai),da();break;case 5:sa(r);break;case 4:oa();break;case 13:case 19:xi(la);break;case 10:Eo(r.type._context);break;case 22:case 23:hu()}n=n.return}if(Ol=e,Dl=e=Fu(e.current,null),Nl=Pl=t,Il=0,Ll=null,Bl=Gl=Ml=0,Hl=jl=null,null!==Ro){for(t=0;t<Ro.length;t++)if(null!==(r=(n=Ro[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var a=o.next;o.next=i,r.next=a}n.pending=r}Ro=null}return e}function pu(e,t){for(;;){var n=Dl;try{if(So(),ha.current=as,ya){for(var r=va.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ya=!1}if(pa=0,ma=ga=va=null,wa=!1,ba=0,Rl.current=null,null===n||null===n.return){Il=1,Ll=t,Dl=null;break}e:{var a=e,s=n.return,l=n,u=t;if(t=Nl,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ms(s);if(null!==p){p.flags&=-257,ys(p,s,l,0,t),1&p.mode&&gs(a,c,t),u=c;var v=(t=p).updateQueue;if(null===v){var g=new Set;g.add(u),t.updateQueue=g}else v.add(u);break e}if(0===(1&t)){gs(a,c,t),gu();break e}u=Error(o(426))}else if(io&&1&l.mode){var m=ms(s);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),ys(m,s,l,0,t),vo(cs(u,l));break e}}a=u=cs(u,l),4!==Il&&(Il=2),null===jl?jl=[a]:jl.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Mo(a,ps(0,u,t));break e;case 1:l=u;var y=a.type,w=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===ql||!ql.has(w)))){a.flags|=65536,t&=-t,a.lanes|=t,Mo(a,vs(a,l,t));break e}}a=a.return}while(null!==a)}Cu(n)}catch(b){t=b,Dl===n&&null!==n&&(Dl=n=n.return);continue}break}}function vu(){var e=Tl.current;return Tl.current=as,null===e?as:e}function gu(){0!==Il&&3!==Il&&2!==Il||(Il=4),null===Ol||0===(268435455&Ml)&&0===(268435455&Gl)||lu(Ol,Nl)}function mu(e,t){var n=_l;_l|=2;var r=vu();for(Ol===e&&Nl===t||(zl=null,fu(e,t));;)try{yu();break}catch(i){pu(e,i)}if(So(),_l=n,Tl.current=r,null!==Dl)throw Error(o(261));return Ol=null,Nl=0,Il}function yu(){for(;null!==Dl;)bu(Dl)}function wu(){for(;null!==Dl&&!Ye();)bu(Dl)}function bu(e){var t=kl(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?Cu(e):Dl=t,Rl.current=null}function Cu(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xs(n,t,Pl)))return void(Dl=n)}else{if(null!==(n=Ys(n,t)))return n.flags&=32767,void(Dl=n);if(null===e)return Il=6,void(Dl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Dl=t);Dl=t=e}while(null!==t);0===Il&&(Il=5)}function Su(e,t,n){var r=wt,i=Al.transition;try{Al.transition=null,wt=1,function(e,t,n,r){do{Eu()}while(null!==Yl);if(0!==(6&_l))throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,a),e===Ol&&(Dl=Ol=null,Nl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xl||(Xl=!0,Ou(tt,(function(){return Eu(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Al.transition,Al.transition=null;var s=wt;wt=1;var l=_l;_l|=4,Rl.current=null,function(e,t){if(ei=zt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(C){n=null;break e}var s=0,l=-1,u=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=s+i),h!==a||0!==r&&3!==h.nodeType||(u=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++c===i&&(l=s),f===a&&++d===r&&(u=s),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},zt=!1,$s=t;null!==$s;)if(e=(t=$s).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$s=e;else for(;null!==$s;){t=$s;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var g=v.memoizedProps,m=v.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:mo(t.type,g),m);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(o(163))}}catch(C){xu(t,t.return,C)}if(null!==(e=t.sibling)){e.return=t.return,$s=e;break}$s=t.return}v=nl,nl=!1}(e,n),ml(n,e),pr(ti),zt=!!ei,ti=ei=null,e.current=n,wl(n,e,i),Qe(),_l=l,wt=s,Al.transition=a}else e.current=n;if(Xl&&(Xl=!1,Yl=e,Ql=i),a=e.pendingLanes,0===a&&(ql=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),iu(e,Ze()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ul)throw Ul=!1,e=Kl,Kl=null,e;0!==(1&Ql)&&0!==e.tag&&Eu(),a=e.pendingLanes,0!==(1&a)?e===Jl?Zl++:(Zl=0,Jl=e):Zl=0,Vi()}(e,t,n,r)}finally{Al.transition=i,wt=r}return null}function Eu(){if(null!==Yl){var e=bt(Ql),t=Al.transition,n=wt;try{if(Al.transition=null,wt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Ql=0,0!==(6&_l))throw Error(o(331));var i=_l;for(_l|=4,$s=e.current;null!==$s;){var a=$s,s=a.child;if(0!==(16&$s.flags)){var l=a.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for($s=c;null!==$s;){var d=$s;switch(d.tag){case 0:case 11:case 15:rl(8,d,a)}var h=d.child;if(null!==h)h.return=d,$s=h;else for(;null!==$s;){var f=(d=$s).sibling,p=d.return;if(al(d),d===c){$s=null;break}if(null!==f){f.return=p,$s=f;break}$s=p}}}var v=a.alternate;if(null!==v){var g=v.child;if(null!==g){v.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(null!==g)}}$s=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,$s=s;else e:for(;null!==$s;){if(0!==(2048&(a=$s).flags))switch(a.tag){case 0:case 11:case 15:rl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,$s=y;break e}$s=a.return}}var w=e.current;for($s=w;null!==$s;){var b=(s=$s).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,$s=b;else e:for(s=w;null!==$s;){if(0!==(2048&(l=$s).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(S){xu(l,l.return,S)}if(l===s){$s=null;break e}var C=l.sibling;if(null!==C){C.return=l.return,$s=C;break e}$s=l.return}}if(_l=i,Vi(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(S){}r=!0}return r}finally{wt=n,Al.transition=t}}return!1}function ku(e,t,n){e=Io(e,t=ps(0,t=cs(n,t),1),1),t=tu(),null!==e&&(mt(e,1,t),iu(e,t))}function xu(e,t,n){if(3===e.tag)ku(e,e,n);else for(;null!==t;){if(3===t.tag){ku(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===ql||!ql.has(r))){t=Io(t,e=vs(t,e=cs(n,e),1),1),e=tu(),null!==t&&(mt(t,1,e),iu(t,e));break}}t=t.return}}function Tu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tu(),e.pingedLanes|=e.suspendedLanes&n,Ol===e&&(Nl&n)===n&&(4===Il||3===Il&&(130023424&Nl)===Nl&&500>Ze()-Vl?fu(e,0):Bl|=n),iu(e,t)}function Ru(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=tu();null!==(e=Oo(e,t))&&(mt(e,t,n),iu(e,n))}function Au(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ru(e,n)}function _u(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Ru(e,n)}function Ou(e,t){return qe(e,t)}function Du(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nu(e,t,n,r){return new Du(e,t,n,r)}function Pu(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Fu(e,t){var n=e.alternate;return null===n?((n=Nu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Iu(e,t,n,r,i,a){var s=2;if(r=e,"function"===typeof e)Pu(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case E:return Lu(n.children,i,a,t);case k:s=8,i|=8;break;case x:return(e=Nu(12,n,t,2|i)).elementType=x,e.lanes=a,e;case _:return(e=Nu(13,n,t,i)).elementType=_,e.lanes=a,e;case O:return(e=Nu(19,n,t,i)).elementType=O,e.lanes=a,e;case P:return Mu(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:s=10;break e;case R:s=9;break e;case A:s=11;break e;case D:s=14;break e;case N:s=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Nu(s,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Lu(e,t,n,r){return(e=Nu(7,e,r,t)).lanes=n,e}function Mu(e,t,n,r){return(e=Nu(22,e,r,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Gu(e,t,n){return(e=Nu(6,e,null,t)).lanes=n,e}function Bu(e,t,n){return(t=Nu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ju(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Hu(e,t,n,r,i,o,a,s,l){return e=new ju(e,t,n,s,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Nu(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},No(o),e}function Vu(e){if(!e)return Ri;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ni(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Ni(n))return Ii(e,n,t)}return t}function Wu(e,t,n,r,i,o,a,s,l){return(e=Hu(n,r,!0,e,0,o,0,s,l)).context=Vu(null),n=e.current,(o=Fo(r=tu(),i=nu(n))).callback=void 0!==t&&null!==t?t:null,Io(n,o,i),e.current.lanes=i,mt(e,i,r),iu(e,r),e}function zu(e,t,n,r){var i=t.current,o=tu(),a=nu(i);return n=Vu(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fo(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Io(i,t,a))&&(ru(e,i,a,o),Lo(e,i,a)),a}function Uu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Ku(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qu(e,t){Ku(e,t),(e=e.alternate)&&Ku(e,t)}kl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||_i.current)bs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:Os(t),po();break;case 5:aa(t);break;case 1:Ni(t.type)&&Li(t);break;case 4:ia(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ti(yo,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ti(la,1&la.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Gs(e,t,n):(Ti(la,1&la.current),null!==(e=Us(e,t,n))?e.sibling:null);Ti(la,1&la.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ws(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(la,la.current),r)break;return null;case 22:case 23:return t.lanes=0,xs(e,t,n)}return Us(e,t,n)}(e,t,n);bs=0!==(131072&e.flags)}else bs=!1,io&&0!==(1048576&t.flags)&&$i(t,Ki,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;zs(e,t),e=t.pendingProps;var i=Di(t,Ai.current);xo(t,n),i=ka(null,t,r,e,i,n);var a=xa();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ni(r)?(a=!0,Li(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,No(t),i.updater=Vo,t.stateNode=i,i._reactInternals=t,Ko(t,r,e,n),t=_s(null,t,r,!0,a,n)):(t.tag=0,io&&a&&eo(t),Cs(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(zs(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Pu(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===D)return 14}return 2}(r),e=mo(r,e),i){case 0:t=Rs(null,t,r,e,n);break e;case 1:t=As(null,t,r,e,n);break e;case 11:t=Ss(null,t,r,e,n);break e;case 14:t=Es(null,t,r,mo(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Rs(e,t,r,i=t.elementType===r?i:mo(r,i),n);case 1:return r=t.type,i=t.pendingProps,As(e,t,r,i=t.elementType===r?i:mo(r,i),n);case 3:e:{if(Os(t),null===e)throw Error(o(387));r=t.pendingProps,i=(a=t.memoizedState).element,Po(e,t),Go(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ds(e,t,r,n,i=cs(Error(o(423)),t));break e}if(r!==i){t=Ds(e,t,r,n,i=cs(Error(o(424)),t));break e}for(ro=ui(t.stateNode.containerInfo.firstChild),no=t,io=!0,oo=null,n=Jo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(po(),r===i){t=Us(e,t,n);break e}Cs(e,t,r,n)}t=t.child}return t;case 5:return aa(t),null===e&&uo(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==a&&ni(r,a)&&(t.flags|=32),Ts(e,t),Cs(e,t,s,n),t.child;case 6:return null===e&&uo(t),null;case 13:return Gs(e,t,n);case 4:return ia(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Zo(t,null,r,n):Cs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ss(e,t,r,i=t.elementType===r?i:mo(r,i),n);case 7:return Cs(e,t,t.pendingProps,n),t.child;case 8:case 12:return Cs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Ti(yo,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===i.children&&!_i.current){t=Us(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===a.tag){(u=Fo(-1,n&-n)).tag=2;var c=a.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}a.lanes|=n,null!==(u=a.alternate)&&(u.lanes|=n),ko(a.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),ko(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}Cs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,xo(t,n),r=r(i=To(i)),t.flags|=1,Cs(e,t,r,n),t.child;case 14:return i=mo(r=t.type,t.pendingProps),Es(e,t,r,i=mo(r.type,i),n);case 15:return ks(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:mo(r,i),zs(e,t),t.tag=1,Ni(r)?(e=!0,Li(t)):e=!1,xo(t,n),zo(t,r,i),Ko(t,r,i,n),_s(null,t,r,!0,e,n);case 19:return Ws(e,t,n);case 22:return xs(e,t,n)}throw Error(o(156,t.tag))};var Xu="function"===typeof reportError?reportError:function(e){console.error(e)};function Yu(e){this._internalRoot=e}function Qu(e){this._internalRoot=e}function Zu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Ju(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $u(){}function ec(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if("function"===typeof i){var s=i;i=function(){var e=Uu(a);s.call(e)}}zu(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var e=Uu(a);o.call(e)}}var a=Wu(t,r,e,0,null,!1,0,"",$u);return e._reactRootContainer=a,e[pi]=a.current,Vr(8===e.nodeType?e.parentNode:e),du(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=Uu(l);s.call(e)}}var l=Hu(e,0,!1,null,0,!1,0,"",$u);return e._reactRootContainer=l,e[pi]=l.current,Vr(8===e.nodeType?e.parentNode:e),du((function(){zu(t,l,n,r)})),l}(n,t,e,i,r);return Uu(a)}Qu.prototype.render=Yu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));zu(e,t,null,null)},Qu.prototype.unmount=Yu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;du((function(){zu(null,e,null,null)})),t[pi]=null}},Qu.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Mt(e)}},Ct=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),iu(t,Ze()),0===(6&_l)&&(Wl=Ze()+500,Vi()))}break;case 13:du((function(){var t=Oo(e,1);if(null!==t){var n=tu();ru(t,e,1,n)}})),qu(e,1)}},St=function(e){if(13===e.tag){var t=Oo(e,134217728);if(null!==t)ru(t,e,134217728,tu());qu(e,134217728)}},Et=function(e){if(13===e.tag){var t=nu(e),n=Oo(e,t);if(null!==n)ru(n,e,t,tu());qu(e,t)}},kt=function(){return wt},xt=function(e,t){var n=wt;try{return wt=e,t()}finally{wt=n}},Se=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Ci(r);if(!i)throw Error(o(90));q(r),J(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ae=cu,_e=du;var tc={usingClientEntryPoint:!1,Events:[wi,bi,Ci,Te,Re,cu]},nc={findFiberByHostInstance:yi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rc={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ue(e))?null:e.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ic=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ic.isDisabled&&ic.supportsFiber)try{it=ic.inject(rc),ot=ic}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zu(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Zu(e))throw Error(o(299));var n=!1,r="",i=Xu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Hu(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Yu(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=Ue(t))?null:e.stateNode},t.flushSync=function(e){return du(e)},t.hydrate=function(e,t,n){if(!Ju(t))throw Error(o(200));return ec(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zu(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",s=Xu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Wu(t,null,e,1,null!=n?n:null,i,0,a,s),e[pi]=t.current,Vr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Qu(t)},t.render=function(e,t,n){if(!Ju(t))throw Error(o(200));return ec(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Ju(e))throw Error(o(40));return!!e._reactRootContainer&&(du((function(){ec(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=cu,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ju(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return ec(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,n){"use strict";var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},8340:function(e,t,n){"use strict";var r,i;r=n(1071),i=n(4424),r.version,r.renderToString,t.uS=r.renderToStaticMarkup,r.renderToNodeStream,r.renderToStaticNodeStream,i.renderToReadableStream},1435:function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2791),o=a(i);function a(e){return e&&e.__esModule?e:{default:e}}var s=(new(a(n(4184)).default)).getResult(),l=s.os.name,u=s.os.version,c=s.browser.name,d=s.browser.version,h=s.device.type,f=s.device.model,p=s.device.vendor,v=s.engine.name,g=s.engine.version,m=s.cpu.architecture,y=s.ua,w={OS:l,OSVersion:u,Browser:c,BrowserVersion:d,DeviceType:h,DeviceModel:f,DeviceVendor:p,Engine:v,EngineVersion:g,CPU:m,UA:y},b=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.rules,r=e.className,i=e.style;return"function"===typeof t?t(w):Object.keys(n).find((function(e){return w[e]!==n[e]}))?null:"string"===typeof t||t instanceof Array?o.default.createElement("div",{className:r,style:i},t):o.default.cloneElement(t)}}]),t}(i.Component);b.OS=l,b.OSVersion=u,b.Browser=c,b.BrowserVersion=d,b.DeviceType=h,b.DeviceModel=f,b.DeviceVendor=p,b.Engine=v,b.EngineVersion=g,b.CPU=m,b.UA=y,b.defaultProps={rules:{},className:"",style:{}},b.select=function(e){return Object.keys(e).find((function(e){return e===(void 0).OS}))},t.Z=b},4909:function(e,t,n){"use strict";var r=n(2791);var i=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(r);function o(e,t){return"selected"===t.type?{selected:t.payload}:e}t.m=function(e){var t=e.tabs,n=void 0===t?[]:t,a=e.className,s=void 0===a?"bootstrap-tabs-component":a,l=e.type,u=void 0===l?"tabs":l,c=e.orientation,d=void 0===c?"horizontal":c,h=r.useReducer(o,{selected:0}),f=h[0].selected,p=h[1],v=n&&n.find((function(e,t){return t===f}));return i.default.createElement("div",{className:"vertical"===d?"d-flex align-items-start "+s:s},i.default.createElement("ul",{className:"nav nav-"+u+" "+("vertical"===d?"flex-column me-3":"mb-3"),role:"tablist","aria-orientation":d},n.map((function(e,t){return i.default.createElement("li",{className:"nav-item",role:"presentation",key:e.label},i.default.createElement("button",{id:"btn-"+t,className:f===t?"nav-link active":"nav-link",type:"button",role:"tab","aria-selected":f===t,"aria-controls":"tabpanel-"+t,tabIndex:f===t?0:-1,onClick:function(){return p({type:"selected",payload:t})}},e.label))}))),i.default.createElement("div",{className:"tab-content"},i.default.createElement("div",{role:"tabpanel","aria-labelledby":"btn-"+f,id:"tabpanel-"+f},v&&i.default.createElement(v.Component,null))))}},5851:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2791),o=(r=i)&&r.__esModule?r:{default:r};t.default=function(){return o.default.createElement("svg",{width:"14",height:"11",viewBox:"0 0 14 11"},o.default.createElement("path",{d:"M11.264 0L5.26 6.004 2.103 2.847 0 4.95l5.26 5.26 8.108-8.107L11.264 0",fill:"#fff",fillRule:"evenodd"}))}},729:function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2791),a=h(o),s=h(n(1694)),l=h(n(2007)),u=h(n(5851)),c=h(n(2274)),d=n(5039);function h(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n.handleTouchStart=n.handleTouchStart.bind(n),n.handleTouchMove=n.handleTouchMove.bind(n),n.handleTouchEnd=n.handleTouchEnd.bind(n),n.handleFocus=n.handleFocus.bind(n),n.handleBlur=n.handleBlur.bind(n),n.previouslyChecked=!(!e.checked&&!e.defaultChecked),n.state={checked:!(!e.checked&&!e.defaultChecked),hasFocus:!1},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"componentDidUpdate",value:function(e){e.checked!==this.props.checked&&this.setState({checked:!!this.props.checked})}},{key:"handleClick",value:function(e){if(!this.props.disabled){var t=this.input;if(e.target!==t&&!this.moved)return this.previouslyChecked=t.checked,e.preventDefault(),t.focus(),void t.click();var n=this.props.hasOwnProperty("checked")?this.props.checked:t.checked;this.setState({checked:n})}}},{key:"handleTouchStart",value:function(e){this.props.disabled||(this.startX=(0,d.pointerCoord)(e).x,this.activated=!0)}},{key:"handleTouchMove",value:function(e){if(this.activated&&(this.moved=!0,this.startX)){var t=(0,d.pointerCoord)(e).x;this.state.checked&&t+15<this.startX?(this.setState({checked:!1}),this.startX=t,this.activated=!0):t-15>this.startX&&(this.setState({checked:!0}),this.startX=t,this.activated=t<this.startX+5)}}},{key:"handleTouchEnd",value:function(e){if(this.moved){var t=this.input;if(e.preventDefault(),this.startX){var n=(0,d.pointerCoord)(e).x;!0===this.previouslyChecked&&this.startX+4>n?this.previouslyChecked!==this.state.checked&&(this.setState({checked:!1}),this.previouslyChecked=this.state.checked,t.click()):this.startX-4<n&&this.previouslyChecked!==this.state.checked&&(this.setState({checked:!0}),this.previouslyChecked=this.state.checked,t.click()),this.activated=!1,this.startX=null,this.moved=!1}}}},{key:"handleFocus",value:function(e){var t=this.props.onFocus;t&&t(e),this.setState({hasFocus:!0})}},{key:"handleBlur",value:function(e){var t=this.props.onBlur;t&&t(e),this.setState({hasFocus:!1})}},{key:"getIcon",value:function(e){var n=this.props.icons;return n?void 0===n[e]?t.defaultProps.icons[e]:n[e]:null}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,i=(t.icons,function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["className","icons"])),o=(0,s.default)("react-toggle",{"react-toggle--checked":this.state.checked,"react-toggle--focus":this.state.hasFocus,"react-toggle--disabled":this.props.disabled},n);return a.default.createElement("div",{className:o,onClick:this.handleClick,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd},a.default.createElement("div",{className:"react-toggle-track"},a.default.createElement("div",{className:"react-toggle-track-check"},this.getIcon("checked")),a.default.createElement("div",{className:"react-toggle-track-x"},this.getIcon("unchecked"))),a.default.createElement("div",{className:"react-toggle-thumb"}),a.default.createElement("input",r({},i,{ref:function(t){e.input=t},onFocus:this.handleFocus,onBlur:this.handleBlur,className:"react-toggle-screenreader-only",type:"checkbox"})))}}]),t}(o.PureComponent);t.Z=f,f.displayName="Toggle",f.defaultProps={icons:{checked:a.default.createElement(u.default,null),unchecked:a.default.createElement(c.default,null)}},f.propTypes={checked:l.default.bool,disabled:l.default.bool,defaultChecked:l.default.bool,onChange:l.default.func,onFocus:l.default.func,onBlur:l.default.func,className:l.default.string,name:l.default.string,value:l.default.string,id:l.default.string,"aria-labelledby":l.default.string,"aria-label":l.default.string,icons:l.default.oneOfType([l.default.bool,l.default.shape({checked:l.default.node,unchecked:l.default.node})])}},5039:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pointerCoord=function(e){if(e){var t=e.changedTouches;if(t&&t.length>0){var n=t[0];return{x:n.clientX,y:n.clientY}}var r=e.pageX;if(void 0!==r)return{x:r,y:e.pageY}}return{x:0,y:0}}},2274:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2791),o=(r=i)&&r.__esModule?r:{default:r};t.default=function(){return o.default.createElement("svg",{width:"10",height:"10",viewBox:"0 0 10 10"},o.default.createElement("path",{d:"M9.9 2.12L7.78 0 4.95 2.828 2.12 0 0 2.12l2.83 2.83L0 7.776 2.123 9.9 4.95 7.07 7.78 9.9 9.9 7.776 7.072 4.95 9.9 2.12",fill:"#fff",fillRule:"evenodd"}))}},6374:function(e,t,n){"use strict";var r=n(2791),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,o={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:u,ref:c,props:o,_owner:s.current}}t.Fragment=o,t.jsx=u,t.jsxs=u},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,g={};function m(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function w(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=m.prototype;var b=w.prototype=new y;b.constructor=w,v(b,m.prototype),b.isPureReactComponent=!0;var C=Array.isArray,S=Object.prototype.hasOwnProperty,E={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,r){var i,o={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)S.call(t,i)&&!k.hasOwnProperty(i)&&(o[i]=t[i]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:n,type:e,key:a,ref:s,props:o,_owner:E.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var R=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function _(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===o?"."+A(l,0):o,C(a)?(i="",null!=e&&(i=e.replace(R,"$&/")+"/"),_(a,t,i,"",(function(e){return e}))):null!=a&&(T(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(R,"$&/")+"/")+e)),t.push(a)),1;if(l=0,o=""===o?".":o+":",C(e))for(var u=0;u<e.length;u++){var c=o+A(s=e[u],u);l+=_(s,t,i,c,a)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(s=e.next()).done;)l+=_(s=s.value,t,i,c=o+A(s,u++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function O(e,t,n){if(null==e)return e;var r=[],i=0;return _(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N={current:null},P={transition:null},F={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:P,ReactCurrentOwner:E};t.Children={map:O,forEach:function(e,t,n){O(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=i,t.Profiler=a,t.PureComponent=w,t.StrictMode=o,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=v({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=E.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)S.call(t,u)&&!k.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:n,type:e.type,key:o,ref:a,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return N.current.useCallback(e,t)},t.useContext=function(e){return N.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return N.current.useDeferredValue(e)},t.useEffect=function(e,t){return N.current.useEffect(e,t)},t.useId=function(){return N.current.useId()},t.useImperativeHandle=function(e,t,n){return N.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return N.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.current.useMemo(e,t)},t.useReducer=function(e,t,n){return N.current.useReducer(e,t,n)},t.useRef=function(e){return N.current.useRef(e)},t.useState=function(e){return N.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return N.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return N.current.useTransition()},t.version="18.2.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},207:function(e,t){"use strict";var n;!function(){var r=t||{}||this||window;void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n),r.default=r;var i="http://www.w3.org/2000/xmlns/",o="http://www.w3.org/2000/svg",a=/url\(["']?(.+?)["']?\)/,s={woff2:"font/woff2",woff:"font/woff",otf:"application/x-font-opentype",ttf:"application/x-font-ttf",eot:"application/vnd.ms-fontobject",sfnt:"application/font-sfnt",svg:"image/svg+xml"},l=function(e){return e instanceof HTMLElement||e instanceof SVGElement},u=function(e){if(!l(e))throw new Error("an HTMLElement or SVGElement is required; got "+e)},c=function(e){return new Promise((function(t,n){l(e)?t(e):n(new Error("an HTMLElement or SVGElement is required; got "+e))}))},d=function(e){var t=Object.keys(s).filter((function(t){return e.indexOf("."+t)>0})).map((function(e){return s[e]}));return t?t[0]:(console.error("Unknown font format for "+e+". Fonts may not be working correctly."),"application/octet-stream")},h=function(e,t,n){var r=e.viewBox&&e.viewBox.baseVal&&e.viewBox.baseVal[n]||null!==t.getAttribute(n)&&!t.getAttribute(n).match(/%$/)&&parseInt(t.getAttribute(n))||e.getBoundingClientRect()[n]||parseInt(t.style[n])||parseInt(window.getComputedStyle(e).getPropertyValue(n));return"undefined"===typeof r||null===r||isNaN(parseFloat(r))?0:r},f=function(e){for(var t=window.atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),i=new Uint8Array(r),o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return new Blob([r],{type:n})},p=function(e){return Promise.all(Array.from(e.querySelectorAll("image")).map((function(e){var t,n=e.getAttributeNS("http://www.w3.org/1999/xlink","href")||e.getAttribute("href");return n?((t=n)&&0===t.lastIndexOf("http",0)&&-1===t.lastIndexOf(window.location.host)&&(n+=(-1===n.indexOf("?")?"?":"&")+"t="+(new Date).valueOf()),new Promise((function(t,r){var i=document.createElement("canvas"),o=new Image;o.crossOrigin="anonymous",o.src=n,o.onerror=function(){return r(new Error("Could not load "+n))},o.onload=function(){i.width=o.width,i.height=o.height,i.getContext("2d").drawImage(o,0,0),e.setAttributeNS("http://www.w3.org/1999/xlink","href",i.toDataURL("image/png")),t(!0)}}))):Promise.resolve(null)})))},v={},g=function(e){return Promise.all(e.map((function(e){return new Promise((function(t,n){if(v[e.url])return t(v[e.url]);var r=new XMLHttpRequest;r.addEventListener("load",(function(){var n=function(e){for(var t="",n=new Uint8Array(e),r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return window.btoa(t)}(r.response),i=e.text.replace(a,'url("data:'+e.format+";base64,"+n+'")')+"\n";v[e.url]=i,t(i)})),r.addEventListener("error",(function(n){console.warn("Failed to load font from: "+e.url,n),v[e.url]=null,t(null)})),r.addEventListener("abort",(function(n){console.warn("Aborted loading font from: "+e.url,n),t(null)})),r.open("GET",e.url),r.responseType="arraybuffer",r.send()}))}))).then((function(e){return e.filter((function(e){return e})).join("")}))},m=null,y=function(e,t){var n=t||{},r=n.selectorRemap,i=n.modifyStyle,o=n.modifyCss,s=n.fonts,l=n.excludeUnusedCss,u=o||function(e,t){return(r?r(e):e)+"{"+(i?i(t):t)+"}\n"},c=[],h="undefined"===typeof s,f=s||[];return(m||(m=Array.from(document.styleSheets).map((function(e){try{return{rules:e.cssRules,href:e.href}}catch(t){return console.warn("Stylesheet could not be loaded: "+e.href,t),{}}})))).forEach((function(t){var n=t.rules,r=t.href;n&&Array.from(n).forEach((function(t){if("undefined"!=typeof t.style)if(function(e,t){if(t)try{return e.querySelector(t)||e.parentNode&&e.parentNode.querySelector(t)}catch(n){console.warn('Invalid CSS selector "'+t+'"',n)}}(e,t.selectorText))c.push(u(t.selectorText,t.style.cssText));else if(h&&t.cssText.match(/^@font-face/)){var n=function(e,t){var n=e.cssText.match(a),r=n&&n[1]||"";if(r&&!r.match(/^data:/)&&"about:blank"!==r){var i=r.startsWith("../")?t+"/../"+r:r.startsWith("./")?t+"/."+r:r;return{text:e.cssText,format:d(i),url:i}}}(t,r);n&&f.push(n)}else l||c.push(t.cssText)}))})),g(f).then((function(e){return c.join("\n")+e}))},w=function(){if(!navigator.msSaveOrOpenBlob&&!("download"in document.createElement("a")))return{popup:window.open()}};r.prepareSvg=function(e,t,n){u(e);var r=t||{},a=r.left,s=void 0===a?0:a,l=r.top,c=void 0===l?0:l,d=r.width,f=r.height,v=r.scale,g=void 0===v?1:v,m=r.responsive,w=void 0!==m&&m,b=r.excludeCss,C=void 0!==b&&b;return p(e).then((function(){var r=e.cloneNode(!0);r.style.backgroundColor=(t||{}).backgroundColor||e.style.backgroundColor;var a=function(e,t,n,r){if("svg"===e.tagName)return{width:n||h(e,t,"width"),height:r||h(e,t,"height")};if(e.getBBox){var i=e.getBBox(),o=i.x,a=i.y;return{width:o+i.width,height:a+i.height}}}(e,r,d,f),l=a.width,u=a.height;if("svg"!==e.tagName){if(!e.getBBox)return void console.error("Attempted to render non-SVG element",e);null!=r.getAttribute("transform")&&r.setAttribute("transform",r.getAttribute("transform").replace(/translate\(.*?\)/,""));var p=document.createElementNS("http://www.w3.org/2000/svg","svg");p.appendChild(r),r=p}if(r.setAttribute("version","1.1"),r.setAttribute("viewBox",[s,c,l,u].join(" ")),r.getAttribute("xmlns")||r.setAttributeNS(i,"xmlns",o),r.getAttribute("xmlns:xlink")||r.setAttributeNS(i,"xmlns:xlink","http://www.w3.org/1999/xlink"),w?(r.removeAttribute("width"),r.removeAttribute("height"),r.setAttribute("preserveAspectRatio","xMinYMin meet")):(r.setAttribute("width",l*g),r.setAttribute("height",u*g)),Array.from(r.querySelectorAll("foreignObject > *")).forEach((function(e){e.setAttributeNS(i,"xmlns","svg"===e.tagName?o:"http://www.w3.org/1999/xhtml")})),!C)return y(e,t).then((function(e){var t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML="<![CDATA[\n"+e+"\n]]>";var i=document.createElement("defs");i.appendChild(t),r.insertBefore(i,r.firstChild);var o=document.createElement("div");o.appendChild(r);var a=o.innerHTML.replace(/NS\d+:href/gi,'xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href');if("function"!==typeof n)return{src:a,width:l,height:u};n(a,l,u)}));var v=document.createElement("div");v.appendChild(r);var m=v.innerHTML;if("function"!==typeof n)return{src:m,width:l,height:u};n(m,l,u)}))},r.svgAsDataUri=function(e,t,n){return u(e),r.prepareSvg(e,t).then((function(e){var t=e.src,r=e.width,i=e.height,o="data:image/svg+xml;base64,"+window.btoa(decodeURIComponent(encodeURIComponent('<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" [<!ENTITY nbsp "&#160;">]>'+t).replace(/%([0-9A-F]{2})/g,(function(e,t){var n=String.fromCharCode("0x"+t);return"%"===n?"%25":n}))));return"function"===typeof n&&n(o,r,i),o}))},r.svgAsPngUri=function(e,t,n){u(e);var i=t||{},o=i.encoderType,a=void 0===o?"image/png":o,s=i.encoderOptions,l=void 0===s?.8:s,c=i.canvg,d=function(e){var t=e.src,r=e.width,i=e.height,o=document.createElement("canvas"),s=o.getContext("2d"),u=window.devicePixelRatio||1;o.width=r*u,o.height=i*u,o.style.width=o.width+"px",o.style.height=o.height+"px",s.setTransform(u,0,0,u,0,0),c?c(o,t):s.drawImage(t,0,0);var d=void 0;try{d=o.toDataURL(a,l)}catch(h){if("undefined"!==typeof SecurityError&&h instanceof SecurityError||"SecurityError"===h.name)return void console.error("Rendered SVG images cannot be downloaded in this browser.");throw h}return"function"===typeof n&&n(d,o.width,o.height),Promise.resolve(d)};return c?r.prepareSvg(e,t).then(d):r.svgAsDataUri(e,t).then((function(e){return new Promise((function(t,n){var r=new Image;r.onload=function(){return t(d({src:r,width:r.width,height:r.height}))},r.onerror=function(){n("There was an error loading the data URI as an image on the following SVG\n"+window.atob(e.slice(26))+"Open the following link to see browser's diagnosis\n"+e)},r.src=e}))}))},r.download=function(e,t,n){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(f(t),e);else{var r=document.createElement("a");if("download"in r){r.download=e,r.style.display="none",document.body.appendChild(r);try{var i=f(t),o=URL.createObjectURL(i);r.href=o,r.onclick=function(){return requestAnimationFrame((function(){return URL.revokeObjectURL(o)}))}}catch(a){console.error(a),console.warn("Error while getting object URL. Falling back to string URL."),r.href=t}r.click(),document.body.removeChild(r)}else n&&n.popup&&(n.popup.document.title=e,n.popup.location.replace(t))}},r.saveSvg=function(e,t,n){var i=w();return c(e).then((function(e){return r.svgAsDataUri(e,n||{})})).then((function(e){return r.download(t,e,i)}))},r.saveSvgAsPng=function(e,t,n){var i=w();return c(e).then((function(e){return r.svgAsPngUri(e,n||{})})).then((function(e){return r.download(t,e,i)}))}}()},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var s=2*(r+1)-1,l=e[s],u=s+1,c=e[u];if(0>o(l,n))u<i&&0>o(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[s]=n,r=s);else{if(!(u<i&&0>o(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var u=[],c=[],d=1,h=null,f=3,p=!1,v=!1,g=!1,m="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(u,t)}t=r(c)}}function C(e){if(g=!1,b(e),!v)if(null!==r(u))v=!0,P(S);else{var t=r(c);null!==t&&F(C,t.startTime-e)}}function S(e,n){v=!1,g&&(g=!1,y(T),T=-1),p=!0;var o=f;try{for(b(n),h=r(u);null!==h&&(!(h.expirationTime>n)||e&&!_());){var a=h.callback;if("function"===typeof a){h.callback=null,f=h.priorityLevel;var s=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(u)&&i(u),b(n)}else i(u);h=r(u)}if(null!==h)var l=!0;else{var d=r(c);null!==d&&F(C,d.startTime-n),l=!1}return l}finally{h=null,f=o,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,k=!1,x=null,T=-1,R=5,A=-1;function _(){return!(t.unstable_now()-A<R)}function O(){if(null!==x){var e=t.unstable_now();A=e;var n=!0;try{n=x(!0,e)}finally{n?E():(k=!1,x=null)}}else k=!1}if("function"===typeof w)E=function(){w(O)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,N=D.port2;D.port1.onmessage=O,E=function(){N.postMessage(null)}}else E=function(){m(O,0)};function P(e){x=e,k||(k=!0,E())}function F(e,n){T=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,P(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(c,e),null===r(u)&&e===r(c)&&(g?(y(T),T=-1):g=!0,F(C,o-a))):(e.sortIndex=s,n(u,e),v||p||(v=!0,P(S))),e},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},4184:function(e,t,n){var r;!function(i,o){"use strict";var a="function",s="undefined",l="object",u="string",c="major",d="model",h="name",f="type",p="vendor",v="version",g="architecture",m="console",y="mobile",w="tablet",b="smarttv",C="wearable",S="embedded",E="Amazon",k="Apple",x="ASUS",T="BlackBerry",R="Browser",A="Chrome",_="Firefox",O="Google",D="Huawei",N="LG",P="Microsoft",F="Motorola",I="Opera",L="Samsung",M="Sharp",G="Sony",B="Xiaomi",j="Zebra",H="Facebook",V="Chromium OS",W="Mac OS",z=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},U=function(e,t){return typeof e===u&&-1!==K(t).indexOf(K(e))},K=function(e){return e.toLowerCase()},q=function(e,t){if(typeof e===u)return e=e.replace(/^\s\s*/,""),typeof t===s?e:e.substring(0,350)},X=function(e,t){for(var n,r,i,s,u,c,d=0;d<t.length&&!u;){var h=t[d],f=t[d+1];for(n=r=0;n<h.length&&!u&&h[n];)if(u=h[n++].exec(e))for(i=0;i<f.length;i++)c=u[++r],typeof(s=f[i])===l&&s.length>0?2===s.length?typeof s[1]==a?this[s[0]]=s[1].call(this,c):this[s[0]]=s[1]:3===s.length?typeof s[1]!==a||s[1].exec&&s[1].test?this[s[0]]=c?c.replace(s[1],s[2]):o:this[s[0]]=c?s[1].call(this,c,s[2]):o:4===s.length&&(this[s[0]]=c?s[3].call(this,c.replace(s[1],s[2])):o):this[s]=c||o;d+=2}},Y=function(e,t){for(var n in t)if(typeof t[n]===l&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(U(t[n][r],e))return"?"===n?o:n}else if(U(t[n],e))return"?"===n?o:n;return e},Q={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Z={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[v,[h,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[v,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,v],[/opios[\/ ]+([\w\.]+)/i],[v,[h,I+" Mini"]],[/\bopr\/([\w\.]+)/i],[v,[h,I]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[h,v],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[v,[h,"UC"+R]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[v,[h,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[v,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[v,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[v,[h,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[v,[h,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure "+R],v],[/\bfocus\/([\w\.]+)/i],[v,[h,_+" Focus"]],[/\bopt\/([\w\.]+)/i],[v,[h,I+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[v,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[v,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[v,[h,I+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[v,[h,"MIUI "+R]],[/fxios\/([-\w\.]+)/i],[v,[h,_]],[/\bqihu|(qi?ho?o?|360)browser/i],[[h,"360 "+R]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1 "+R],v],[/(comodo_dragon)\/([\w\.]+)/i],[[h,/_/g," "],v],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[h,v],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,H],v],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[h,v],[/\bgsa\/([\w\.]+) .*safari\//i],[v,[h,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[v,[h,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[v,[h,A+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,A+" WebView"],v],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[v,[h,"Android "+R]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,v],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[v,[h,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[v,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[v,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[h,v],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],v],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[v,[h,_+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[h,v],[/(cobalt)\/([\w\.]+)/i],[h,[v,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,K]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,"",K]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,K]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[p,L],[f,w]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[d,[p,L],[f,y]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[p,k],[f,y]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[p,k],[f,w]],[/(macintosh);/i],[d,[p,k]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[p,M],[f,y]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[p,D],[f,w]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[p,D],[f,y]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[d,/_/g," "],[p,B],[f,y]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[p,B],[f,w]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[p,"OPPO"],[f,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[p,"Vivo"],[f,y]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[d,[p,"Realme"],[f,y]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[p,F],[f,y]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[p,F],[f,w]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[p,N],[f,w]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[p,N],[f,y]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[p,"Lenovo"],[f,w]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[p,"Nokia"],[f,y]],[/(pixel c)\b/i],[d,[p,O],[f,w]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[p,O],[f,y]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[p,G],[f,y]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[p,G],[f,w]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[p,"OnePlus"],[f,y]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[p,E],[f,w]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[p,E],[f,y]],[/(playbook);[-\w\),; ]+(rim)/i],[d,p,[f,w]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[p,T],[f,y]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[p,x],[f,w]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[p,x],[f,y]],[/(nexus 9)/i],[d,[p,"HTC"],[f,w]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[p,[d,/_/g," "],[f,y]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[p,"Acer"],[f,w]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[p,"Meizu"],[f,y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[p,d,[f,y]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[p,d,[f,w]],[/(surface duo)/i],[d,[p,P],[f,w]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[p,"Fairphone"],[f,y]],[/(u304aa)/i],[d,[p,"AT&T"],[f,y]],[/\bsie-(\w*)/i],[d,[p,"Siemens"],[f,y]],[/\b(rct\w+) b/i],[d,[p,"RCA"],[f,w]],[/\b(venue[\d ]{2,7}) b/i],[d,[p,"Dell"],[f,w]],[/\b(q(?:mv|ta)\w+) b/i],[d,[p,"Verizon"],[f,w]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[p,"Barnes & Noble"],[f,w]],[/\b(tm\d{3}\w+) b/i],[d,[p,"NuVision"],[f,w]],[/\b(k88) b/i],[d,[p,"ZTE"],[f,w]],[/\b(nx\d{3}j) b/i],[d,[p,"ZTE"],[f,y]],[/\b(gen\d{3}) b.+49h/i],[d,[p,"Swiss"],[f,y]],[/\b(zur\d{3}) b/i],[d,[p,"Swiss"],[f,w]],[/\b((zeki)?tb.*\b) b/i],[d,[p,"Zeki"],[f,w]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[p,"Dragon Touch"],d,[f,w]],[/\b(ns-?\w{0,9}) b/i],[d,[p,"Insignia"],[f,w]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[p,"NextBook"],[f,w]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[p,"Voice"],d,[f,y]],[/\b(lvtel\-)?(v1[12]) b/i],[[p,"LvTel"],d,[f,y]],[/\b(ph-1) /i],[d,[p,"Essential"],[f,y]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[p,"Envizen"],[f,w]],[/\b(trio[-\w\. ]+) b/i],[d,[p,"MachSpeed"],[f,w]],[/\btu_(1491) b/i],[d,[p,"Rotor"],[f,w]],[/(shield[\w ]+) b/i],[d,[p,"Nvidia"],[f,w]],[/(sprint) (\w+)/i],[p,d,[f,y]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[p,P],[f,y]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[p,j],[f,w]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[p,j],[f,y]],[/smart-tv.+(samsung)/i],[p,[f,b]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[p,L],[f,b]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[p,N],[f,b]],[/(apple) ?tv/i],[p,[d,k+" TV"],[f,b]],[/crkey/i],[[d,A+"cast"],[p,O],[f,b]],[/droid.+aft(\w)( bui|\))/i],[d,[p,E],[f,b]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[p,M],[f,b]],[/(bravia[\w ]+)( bui|\))/i],[d,[p,G],[f,b]],[/(mitv-\w{5}) bui/i],[d,[p,B],[f,b]],[/Hbbtv.*(technisat) (.*);/i],[p,d,[f,b]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[p,q],[d,q],[f,b]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[f,b]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[p,d,[f,m]],[/droid.+; (shield) bui/i],[d,[p,"Nvidia"],[f,m]],[/(playstation [345portablevi]+)/i],[d,[p,G],[f,m]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[p,P],[f,m]],[/((pebble))app/i],[p,d,[f,C]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[p,k],[f,C]],[/droid.+; (glass) \d/i],[d,[p,O],[f,C]],[/droid.+; (wt63?0{2,3})\)/i],[d,[p,j],[f,C]],[/(quest( 2| pro)?)/i],[d,[p,H],[f,C]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[p,[f,S]],[/(aeobc)\b/i],[d,[p,E],[f,S]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[d,[f,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[f,w]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[f,w]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[f,y]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[p,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[v,[h,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[v,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[h,v],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[v,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,v],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[h,[v,Y,Q]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[h,"Windows"],[v,Y,Q]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[v,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,W],[v,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[v,h],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[h,v],[/\(bb(10);/i],[v,[h,T]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[v,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[v,[h,_+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[v,[h,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[v,[h,"watchOS"]],[/crkey\/([\d\.]+)/i],[v,[h,A+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[h,V],v],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,v],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],v],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[h,v]]},J=function e(t,n){if(typeof t===l&&(n=t,t=o),!(this instanceof e))return new e(t,n).getResult();var r=typeof i!==s&&i.navigator?i.navigator:o,m=t||(r&&r.userAgent?r.userAgent:""),b=r&&r.userAgentData?r.userAgentData:o,C=n?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2===0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(Z,n):Z,S=r&&r.userAgent==m;return this.getBrowser=function(){var e,t={};return t[h]=o,t[v]=o,X.call(t,m,C.browser),t[c]=typeof(e=t[v])===u?e.replace(/[^\d\.]/g,"").split(".")[0]:o,S&&r&&r.brave&&typeof r.brave.isBrave==a&&(t[h]="Brave"),t},this.getCPU=function(){var e={};return e[g]=o,X.call(e,m,C.cpu),e},this.getDevice=function(){var e={};return e[p]=o,e[d]=o,e[f]=o,X.call(e,m,C.device),S&&!e[f]&&b&&b.mobile&&(e[f]=y),S&&"Macintosh"==e[d]&&r&&typeof r.standalone!==s&&r.maxTouchPoints&&r.maxTouchPoints>2&&(e[d]="iPad",e[f]=w),e},this.getEngine=function(){var e={};return e[h]=o,e[v]=o,X.call(e,m,C.engine),e},this.getOS=function(){var e={};return e[h]=o,e[v]=o,X.call(e,m,C.os),S&&!e[h]&&b&&"Unknown"!=b.platform&&(e[h]=b.platform.replace(/chrome os/i,V).replace(/macos/i,W)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return m},this.setUA=function(e){return m=typeof e===u&&e.length>350?q(e,350):e,this},this.setUA(m),this};J.VERSION="0.7.35",J.BROWSER=z([h,v,c]),J.CPU=z([g]),J.DEVICE=z([d,p,f,m,y,b,w,C,S]),J.ENGINE=J.OS=z([h,v]),typeof t!==s?(e.exports&&(t=e.exports=J),t.UAParser=J):n.amdO?(r=function(){return J}.call(t,n,t,e))===o||(e.exports=r):typeof i!==s&&(i.UAParser=J);var $=typeof i!==s&&(i.jQuery||i.Zepto);if($&&!$.ua){var ee=new J;$.ua=ee.getResult(),$.ua.get=function(){return ee.getUA()},$.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var n in t)$.ua[n]=t[n]}}}("object"===typeof window?window:this)},1561:function(e,t,n){"use strict";var r=n(2791);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=r.useState,a=r.useEffect,s=r.useLayoutEffect,l=r.useDebugValue;function u(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(r){return!0}}var c="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=o({inst:{value:n,getSnapshot:t}}),i=r[0].inst,c=r[1];return s((function(){i.value=n,i.getSnapshot=t,u(i)&&c({inst:i})}),[e,n,t]),a((function(){return u(i)&&c({inst:i}),e((function(){u(i)&&c({inst:i})}))}),[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:c},7595:function(e,t,n){"use strict";var r=n(2791),i=n(7248);var o="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},a=i.useSyncExternalStore,s=r.useRef,l=r.useEffect,u=r.useMemo,c=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var d=s(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;d=u((function(){function e(e){if(!l){if(l=!0,a=e,e=r(e),void 0!==i&&h.hasValue){var t=h.value;if(i(t,e))return s=t}return s=e}if(t=s,o(a,e))return t;var n=r(e);return void 0!==i&&i(t,n)?t:(a=e,s=n)}var a,s,l=!1,u=void 0===n?null:n;return[function(){return e(t())},null===u?void 0:function(){return e(u())}]}),[t,n,r,i]);var f=a(e,d[0],d[1]);return l((function(){h.hasValue=!0,h.value=f}),[f]),c(f),f}},7248:function(e,t,n){"use strict";e.exports=n(1561)},327:function(e,t,n){"use strict";e.exports=n(7595)},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3405:function(e,t,n){var r=n(3897);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},4704:function(e,t,n){var r=n(6116);e.exports=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,n){var r=n(3808),i=n(9617),o=n(4993);e.exports=function(e){var t=i();return function(){var n,i=r(e);if(t){var a=r(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return o(this,n)}},e.exports.__esModule=!0,e.exports.default=e.exports},8416:function(e){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},1588:function(e,t,n){var r=n(1753);function i(){return"undefined"!==typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(this,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},3808:function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,n){var r=n(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},9498:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,n){var r=n(8698).default,i=n(6115);e.exports=function(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7061:function(e,t,n){var r=n(8698).default;function i(){"use strict";e.exports=i=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,o=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(_){c=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof p?t:p,o=Object.create(i.prototype),a=new T(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return A()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=h(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(e,n,a),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(_){return{type:"throw",arg:_}}}t.wrap=d;var f={};function p(){}function v(){}function g(){}var m={};c(m,s,(function(){return this}));var y=Object.getPrototypeOf,w=y&&y(y(R([])));w&&w!==n&&o.call(w,s)&&(m=w);var b=g.prototype=p.prototype=Object.create(m);function C(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,a,s,l){var u=h(e[i],e,a);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==r(d)&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,l)}),(function(e){n("throw",e,s,l)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,l)}))}l(u.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function E(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var r=h(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,f;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function R(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:A}}function A(){return{value:void 0,done:!0}}return v.prototype=g,c(b,"constructor",g),c(g,"constructor",v),v.displayName=c(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,u,"GeneratorFunction")),e.prototype=Object.create(b),e},t.awrap=function(e){return{__await:e}},C(S.prototype),c(S.prototype,l,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new S(d(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(b),c(b,u,"Generator"),c(b,s,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=R,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),l=o.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;x(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,n){var r=n(5372),i=n(8872),o=n(6116),a=n(2218);e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},1753:function(e,t,n){var r=n(3808);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,n){var r=n(3405),i=n(9498),o=n(6116),a=n(2281);e.exports=function(e){return r(e)||i(e)||o(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,n){var r=n(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,n.amdO={},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".502702d7.chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="ken_q_v3:";n.l=function(r,i,o,a){if(e[r])e[r].push(i);else{var s,l;if(void 0!==o)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+o){s=d;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+o),s.src=r),e[r]=[i];var h=function(t,n){s.onerror=s.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(e){return e(n)})),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),l&&document.head.appendChild(s)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.p="/",function(){var e={179:0};n.f.j=function(t,r){var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var o=new Promise((function(n,r){i=e[t]=[n,r]}));r.push(i[2]=o);var a=n.p+n.u(t),s=new Error;n.l(a,(function(r){if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,i[1](s)}}),"chunk-"+t,t)}};var t=function(t,r){var i,o,a=r[0],s=r[1],l=r[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(l)l(n)}for(t&&t(r);u<a.length;u++)o=a[u],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self.webpackChunkken_q_v3=self.webpackChunkken_q_v3||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),function(){"use strict";var e=n(2791),t=n(1250),r=n(184),i=function(){return(0,r.jsx)("div",{className:"m-20 text-left max-w-6xl",children:(0,r.jsxs)("span",{children:["Ken-Q Analysis brings the interactivity and convenience of the web to Q-methodology. It is a desktop web application, so after the page has loaded there is no further communication with the server. All matrix calculations, factor rotations, and file downloads are processed in your browser. ",(0,r.jsx)("strong",{children:"Your data never leave your web browser. "}),"Therefore, the speed of the matrix calculations, table updates, and image displays will depend on the processing power of your computer. Analyzing smaller datasets will likely be quick and responsive, but when working with large datasets you may experience some delays."]})})},o=function(){return(0,r.jsxs)("div",{className:"",children:[(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsxs)("div",{className:"flex flex-col text-center justify-center",children:[(0,r.jsx)("div",{className:""}),(0,r.jsx)("p",{className:"text-8xl my-4",children:"Ken-Q Analysis"}),(0,r.jsx)("p",{className:"text-4xl my-4 pt-2",children:"A Web Application for Q Methodology \xa0\xa0\xa0 Version 2.0.0"})]})}),(0,r.jsx)(i,{})]})},a=n.p+"static/media/firefox.376d9fc275311674f3b1.png",s=function(){return(0,r.jsxs)("div",{className:"flex items-start min-w-[1000px] mb-8 mt-8 justify-around",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADwCAMAAAAJixmgAAAC/VBMVEUAAADd3d7iSiDbdSb3zglAnUPcayw/nEQ/nETgrRneqhnlQDxBnUVMtknf3txBnUTVnhs/mkM/mkPfMTBAm0Q/nERAmUPjrxg/mkThrBjVoRrfIyhelD7mQDvmQj3HJSTXIyjhKSw/nERLskf50hU/m0RMrkaVyJTsWk3grBnu24vnQTy+LidRrUfcKSt1gjfS29G9Ky/iLi/hrRjwyxPw0kOKaDNDnEThrRnbphrt5dpLrUTsWEztzBSyvSLgOTnhrBnvZlXt48DfIifgqxn10zTgJirfqxlnsDqrQivhU1HfqhmKyIjpTETtW07t4Kf0ygxFo0TsV0zg3t7mPzqEtDFXrD/TnRvq08++hx3U2tCbUzDz1Upiul90v3LQ08PruBfjp6fTxRfevr6+1b1Qt02rz6vLlBvpYVZevFuXqCvghITYmJnA2L/MlBvKkRzu12nq3qnQnhytliNTt1Hs13jEfX6/VVjNlZbfSCLDix380glMt0nfIidHrkbvxwnOHyRGq0dCokVKs0hBn0Tf39/hKy3iLzBJsEjgJSnhKCs/nERFqUZDpUbjMjJEp0bkNTTkODbmPTnmQDv6zQ7nQz3i4eD4yBT7zwzoSUHpthjoRj/wvhfpTEPlOjflsRjrVUrqT0ZAgrX3xhbuuxc4fLD5zBDirhlEhbjqUkjn5eTruRcudKk8f7NIiLs1ea7q5+ZMi731xBb5yhLk4+Iyd6xPjsDywBfsWUznsxgbZZxcmMjgqxk+mUPt6egpb6ZWk8RZlcZTkMIeZ5/tXE/0whYrcacXYpokbKLx7Ovv6+khaqEmbaTz7uxgm8ruX1HcpxoUX5hspNJpotFvptRmoM9yqdfUnRv17+0RXZVkns3XoBpinczZpBruYlLQmRt2rNnJkRzNlhzvZFR6r9vwZ1bFjB29gx5+st7Bhx3uww08kkDXICXrvhKbuM5xm7ypv9HP1tva4ObG0Ni1xdLM2eaPsMpfkLZLgqyewd+ApcJQh7EvcKG+0OG2zN9T+5foAAAAe3RSTlMA/tYJ/A4Sx1a8SDdr8u7ZMxz0bT8t5c+xfhzqy08g77mciOjofN2ymGrv7eLRz8TBqYLr4tzHnFcn9vbTz8O7pX739vbm3d3c2riQhHtk9fPw6dzWzezn397Wz7m4raDvxsXDwb+6sqyTwry2h4do5NbQxKPFqpyDyZ6gihI+AAAaE0lEQVR42tzWsYriUBjF8QsBm1umHBKYTghsYR0QWZhCSArJQ/gk2kmiWEhIcErfwAew9w2mkX2PPdmP3Q/mcLksTDTOv0/gx7k3xNyzILZRns/QGM1Qnkc2Dsx3K4ij2XKeLq4f6Ha7/frUIl2OZ1FsvkOjKFuml64r+gMm8Q19oEU6zu0Tzx3YbL44Hs9IwEjF7L12XS7pMn/GreMOiwRME0OsXgXDi85nTD0yz1MQjRenLgHzxJJo1dslXnQ8ppk1TxG07+gvmMVKVq56BSxPpuPBm+04aZpGwDQxxEIWs2rJK+ATWgzZHGfF4dB0YJqYxJpw2StgvCjNhnmf7fyAANaJSQyyxFpw2Qswak7DmzkIi7qu4eWJWcyxVwcGGKW5GVCjLNnXiCZWsZAll1a46kXiRYdDEQ7ln2Q0SfaopoldYkRalxeJFyWDuMzg7nYK9ohBppTr9Aq4rpPJo8lBBi7ANDGLQZacWuG6vWifhOaBBWGy3e48YiYjxiLlOr2oiMyjssUWqbh2i5nMHX1eAe92U2seUTxt21bEAmYxk5FLy1z16sAAo9cHXOWwrSoR86FmsZA1sirX60XbJDf3zRYVErBD7CFTzHV70TQ29yuYlGXlEiMSgyz5teCSt2bvtr3j99oWJfKKmSy5scx1e9u2utfIYbkp/0MMspo9vSvX762qJDL9F0836J+4dYqZjDxa4jq9AKPyNTA9F72tN10CZrGDDLPmtqqWuewFuCys6bXJGgnYIyYyzN4a4nq8KDT9FbyuBewUIxIL2W9ulMvencu72fR3rOMfq5VHTCOzGTmpqlWux4umI9NL9mUFsFPMZDL7O3i47EXrt9j0UPQTXoe4IjGTJa9VtMplb/XZu16/2K/3hr9ZrZ/VJsIwjOKLQF1EEImCEFsb11IhCzcuAwWXvaCBcVPI0DA36kX40SwO9PDykC9z7uDH+8yfaWrcWlySMZOo0pZce1/bLO3dTy2Lq1lDxhySFq7n/Nb7/LyweHeckjiTW8GauYW3tV+Qu7o/HguxZi0yaLLUWLj1nPG2dot6g7gkYwbtwKItuYV3mnaLeYfB4nrWkDFTtqKFW88Zr8X93lpckDEb7YRFW3PtnY6LiJtX4nrWJtMFWHPrOeM9LiHenb2IfWSTMYMW21SwaOGG8zZva7+IN4sh+8w2O2s5rrm1dxiuFO8bFLFn7SNDxow6W9Gay3k957O3tbnGu0GLWEeGLDNoClKwaMUtva3bfu/6AFaz1pFNxgzaGYsWrtfsOZ87rHu9d1ukcdaQMYM+F61g0cLN5z33eNPnXT2Ii7gi2wyaCidYaUsuXnpYXfEBdogTGTNsZyrazJ3g0q7/BR2PDFlm0E5MY62F6/NS56v61lDEgYzZaGcs2sSVt/vFdbMdnI9sMmbQFKTGojWX87rH1ZUPcCbbDDpnrLWZ2/8Yb8YhimsyZrrIaq25tbfj/2M9jv+GTjJm0JSlYK3NXNreXfIFHiUOZJmFjhlrbebSPaDU9z8j4h4yZrqIam3m9n+bPp8+jIgz2WbQLkPBWgs3d9Coi97N869KnMmYjc4Zay3cZUb9/jTPT98kjmSbqdtqrblXvqk/Ps3z/PJzRNxpBk0JKmzQhrY34rkvp+Z9+f1D4kzGDLq7SdrA7fz9+HR6Bf/9OgZxNlMfNWtz6wj+z6u9hEQVR3EctzR60Juih4HRQ0jM6GEPIQrDIltYtJEKKtoEtahFRfS2glq0kwoJhClFrqjXGooQLo7QYgRdaEVIixYuImqyKY0plM6/M/f+5s5x+jf33vpCuxr4dO79n79Ts9h77dpBD2KYgUZZUIGF1lMlOu+UOza48KoHMdBQewhWDdb3uZXLA1bgyxu9iWFGHqzQ+munbiURmL2Xlxd4EwMt0kMDxervW5P2pYBv0WryI4ZaX+BWlJ/7p0t00svgW8WO+JLP/j8VrfvLAROYVxPE/mN5fv7OkpKJ/6vzmW8fK+8ATN5b1w8GLN65rfLE0eoy640qWlZ++syhrRuuBN4H1SdVc11dff0i7YAdcOFV5BtbebSsp6fnTVo9PVZRKdABi5ub657Xr8/NdETXuJ/o69evbwxIXHKiuoeTYFXZma3/aMQErl+V8ZLlfqIJPKMgAHH+8epoNAqw8FLRaHnp3n8CphZkuGS5Bszgi3RuIY/DNaMqm5YBTHUXbQha/ODZs2cPHjyaNv7P/QA73osXd/sTlxwlCcAQS6+qakOA4McP7z18+PgFgadCiebXjAteTU6UNbebIUIML8A85WAe7LzG2sYnT36Dnz141Dw7R7YJXoApXk1erlz5J6xuCaYcLrwQW6f8WvPuX7h/v7a2sfHJvXsKTCPePt5Okmf0RdXyqx7F26q7qagUy1K8VPkGX1iVAtcy+LECH8mVR9b4TzS1xpM4/2Q3J8BmPD78u3g8KgeswnPtBWuLXc/0ZnlkZQTPKPYgLqHx2mAUH00k3rtKjA1bwoshZ4dFeKYZLI+tOTXiibbBtJqyFleWdaeDrdHE+0HK5R1UJcbiACczS71j8UzjJW5enH6NzjhganeW4tvHLavbLR5ODL6jiEe5uO9U70dN9jpZp7xhIWYwPdO/wYvSb1kZwWI1acU7TloKDLE1NviaIhiREbyvqUQ8FUyfUOQBm/kl3uX2zqvJAOY2ZiPOP2pREBP35cuXQsxcx0u/JRF3ga0qL1j5EjM4bRUvgxdLCS0v0IrhPWa5wMODfX19jphztMxlL/22hAmvEu/NGovUSwwwnmndE43VpBXDC3E81t/fD7EiI3DZ29//ehRgJf7gCYsRYxM3L3Cf0RowVpNGvEM9zwCP9r96RWCIQQYXXvrdIwa8eI+1WP2pVZd6Tk/XgLGadOITFuo2YwMDryBWZM7GSu/AwMth2wuxHqt/ietW5aDJGjBWk0ZcaVooPPj2LYv5qU6SEbjw0h8ZtZxMqxRYf+DmqfBOqmGwPLNQIRG14qWGaTnkeF9vr0ssyaR1ewnc29s7ZCFzBQzZit2nVsp9eopuwLyaROLAqjZNxzs80NGbLmYyAtfxErijI+YM2DTL8vyD+SWehp8MdWBeTVrxSfLaI/7ytqMjVQyy0PJ4HS+BIaaK/IFxau3J5hWWq0mKK00Ve+MDkQ4hVmQVsMwV3o7IUJKrflV4BeOupcD4amvSDR2YK/6zeOdMk2NvJFUMMoJWcdV5BW/EEZt4qP0e089z7XulBEsvryZZ2gPNYLOvMyLERObcWubyeOHtjIyy18dDnQ52XuJlALsOadHBccU4oR3xSGenW8xkNiNwhbezsyNuOq0I4Jim7+QX2a/wDc1WkqtJinccM53GurrcYpApFxbcNG9X1w/TqSqQvVRnb+K5NzSvsFxNUrzNdIpHuqSYyWRGthZceAn8NGY6VQQCPsLe+bozC/E/RIjSBvzj6VO3GGQOWNYSV3gJ3PXFtCv3B07upedb+NqhAYtzS/TRNeCxp5QQw4xY6+LCSx/S72/E2Es2eDOfWXow2p1BTANOHlrhSLtbDDKbEbTEld729m+mSn1ylY+9BDCfWguzAa9WPtlSg7lUrL0dYgyZzUDDCq6Kuext73Q+1VjhC/yCwdv5h38NWK4m2VkHfLerXYpBlrEW42Uvg1uHbK9RFMQiXsD3rKzAhTi3UMF+wxbHWlshFmQqHQstvMwlMI2YvUZZXgDgej6kdRct/ZV6bdhIisNdrVIMMkKS63hbecSGqsITuDYVzMf0FAmWA3Z/2yM6aaiUeKipFWKQI1wGLXOll4o44CrvewlgdblcqQPrV1PBTMMWf24aTwwz5bZKLsVcqqnpi/KqwnkBgFepraQD61fTWsNuQhPFYkGGGUHLXOFtGiEvVxEAeI/aSlmDV8sz2i4WGl8Ms8RKLsVcqt2wK/IN5r00WQfWX6mPGXafQ45YkmXQMld6Q6GvRrLyAMBT1RrWgzXf9hTPNJLdDFEQg0xmoIVWcuENxQy7PP9gtYjnasGyNWIpcd9CLJZDJjJyUaElrvSGPjvgCv/g9ereoQHrV9M5w26kRYphJrQMWslVtYScv85T/sH1uTnzdWD9ajqLV7ilpYXFgoykFVriur30gV9xavkHL9aD9avpsGEkp/CzhXINmckwy8DFeOGlhnBq+QfPzpnnDVwIb8EB58xqaIBYkqkMWGgxXtvbMML3DrpOBwuWd2nNasIhHTa4rw0QgwwzAtTFFeMlb4NzaoXz/IOn5UzxCMZqWnoznBQPNbAYQwZZmKUWXIyX+m57wyv+IVgvXoOtRPE9qw1iQQZaWqEFl73UT9sbrvD+0xLA07MEo2KAKQaTWJJhlmXgwtvWFmKvN3BjGnizD/ASgJPikTYpVmROh5VcSn0ie6lSv+B6L2B0EGAW/2ijBJnMSFoRuPCqwsQF2Pt3Wvyf43/xci+vTURRHMdn8F1sfFsVQTG1wUUg4qNqqYgoKgoKRZFiK0hbUBAUFAUhC3VA6P7qWhQXBlzYIAShi0ATaDdZ+k80DQkmNF14bm5vfs6cCaP3Rr/izkc+nDN3Zupj87QxeABgJV7OZiHmZB7Xcm72ywxlCf4G8EYCvzYBUycBbvUzS2JGBjpSCy682Y9W4K9+8CkNfsn/llZ0vQf84MUsxCCTGYVbO3Op93bgtz5wD8D8Tw+j2x8AZzKMzMw8aMGFN9Oc0V00vg1r8KceZ+e02bMlHqkPuvoDLWW0GGSYo7Dh3Eym3gb32zx3KPDWUPCfi5Py0XJEf6BqRsbJqLMVWnDJS5W7A/5sCcat6UBKzKhERokZGWYWtOBivNTcT+0V76wftD6ddnbZgePy9VBocWNujpN1UVhoiQvv3NIqV5w3GHAQvM9ZZwrGI/VzocX1OSkGGWawORVazqWqq15x3fg2DPAax9muxJ3/9nDkV3ueCVnrRjw7x8kwI/i5Flzpnf2ovTOP7G/DxxzH2W14TOPWdFRocXV2NkAmcwQaWM4l72xZcen7CdMzC+A+Am8w22l05eCI+kD0wb5ADLI0I0blWnCpRemVZNGFu9ImAu+xBScP3BWrzdQXZkFmZhbDMu7CQkViZWeM34YBPkfgQUMwOvlc6JYWFhSZm6nOVmjBVd6m0D3uwiG9l8CHOTj9d+D4DqHzMguMDDMCE9i2Flzqp9Cd6MIhfYTAG6etRzw4InTlYhFkmBmaYcO5xYWK0PXbvzp86iHwLntw70OhqxWLIDMz3EwKLbj0S9WF7rz5V/AAPk3gdcZgtFm0axZBhhloxLBKCy41XxO6Owbe4Jl1wZFtMb2I0WQKx9b8PMgwy6Ks0GrufFOwjbY5s/oc2R6AjUeMnRaNeZClGWgUcAILLXEpDPix2UbjC1rqriQ71IWdfhLDiPPzigwzVwet0IJLNQTbaJvnLLoryTbbg3FsUfU8kSmQgeYBC63i0i9TFbrba60vYQKfIm7oMf334vsYcaWYB1mhVVFWaCWXKlsOOPj2T4c0pd+XLEd8V7Rbzsu0GWgEJypCS1xZxhW6WL/5JYwz64Kj2mCx0xgxPp3byIGs0FzNqdC2yuWX7AaMu7D6Uwf16tDh1LK7iqvFXA5moMMCFlqKfgEstBe7YbfRvjOLPVwajvjJiIeTOkcRGWhVR2pQSzU9gDFgg43GJdzjqLZNW+w0uubhI5ZzFMxA82CFllqptrne47UGXtyU2pfwGme1LRY7jQZSXpvs1Qs5XR51pEILr+Z67rDRgNmDdJ+jG7TbadyavDbZbRZABprFsVShkK9pLvX0heVGr4KvEhUXcehO//VSq9RRXaCAoKKoWkveJXC90X4jL9toeuzQrZu22WkUv+uB7NYLqlxkwKqKNa2lYlho843GJczvxDYjnhzx2gmvXFBxdF59Y1iVvH69dndMvGEbvclBhwlsOWJcxmi5UAKDszmVKpU+Vj0P3cUJbbnRRxy0i+200bFFXfOJayslCpqIWj+47Pq8w6YDDm40/SkLxW9MGLGh2Pd5K43SapFYVX7R+72JB8b/XAlPHbgpocGujbi3JUaLcsgoFIrKFd9PTiX7DbzvQge81wfe6QNjxPZiUSmXfpT+pB8/sjXP7x04C4jNkSXBWx1fuxXY5tiCOOb5qpRzP2Sdqa0aiosmBi4bnFjsyFIbfUlL8cYU9rQFsdHJBXJeoTpWaix5gabi6WHLAfON5uc0H7GB+P6IF8hdbJY6c1eWq16wxFD65gurAf9+E/6+z0F49sCIjZYaTaY8VmWxvhKCLTSWax4rNp5ODx3v3oA3OcE2Y6fNR4ziCdcLqbq4XM/mCmqLcyuN8s9a6I9LJen3Nj6xAP7An6PxPB0xYou15lUqFUBZbiJOv/Otteb3YNyT1EaH/Y/Le9iIjZ6oUfIhmdzWtz9L/+DUZFp2r4sDvurwdoaOGGKDnqQ8UCKhrr56h1rey1Ynln/A37fCiTawERvemlDv+CiwbqdvgBM3MZBWmZ9YGDCOrLA22o+YFx8fdf94wuDan1gYsP7qHW83G7GFGFMem3CpiAm71Oi45Kpu3TBeaH0PxoD7nPAOSzB7osZSGzd5LeUi32zbxRJPhtLoXjcHfKQDeN12PWLrpeZjTsDMG02MxYGlLlt4AwPGPYk3yEdsLUZJQsdCsFNjyXSwYfOF5gPe63RqW8cRW4ox6eTYeCIxNTUxMTE1lUiMj032vkrzbhp4Ayc0BnxhfSgW70wG55ZNb7h3qN/Ii4UOH3D0VfxfxGneWVMvH/AnXMGhHWYjxuPHvxGHbPTfv/YHvTixcESHtw73YrbUEP/jjR428IYutBzwJTZg9pbIlvqfii1OLH4B8xOLvxfyEfOlxmUs+8cbPXTcwMsWWp9YfU5UGzFiE7H9Rp+18mKh1WtSTwQX78WhS919MfOy1/5ILvdioc/BFfH0gaU2ENts9D1zLy5gfWId+9V9/bO0FYVxHD8gSYwIGolRg5Pg0KlDS62USgdBoUs7aHCTLoKDgm4dBDVDIBGXQkUCDhU6dHQq5L6HbA4SRIeK+Cb6nDy9+XH93cvNn5sY+5VCUSL58DzneJM1TTRLS909caGzG0u5Hi8WGn+SwhpRcC/ENODXnXm9C500zZUu0jHukviwkxvrhLw4wPWFXpw3TTYHsYB9xVIXwKufOvdioadMs8Ww1BDvd2HGhbZuLHCDvfSMFbbU4WIp6iO83MZ4vd4yvIujpoVmSFzyipUc8Ua/b4XLXs8BrrwwLZVoRixFudErTXK968zelm5oPH7QVQ1xVGtNH/tb4/p6daHpkSO8YYB9xSBHtdELJyehWnCxzvDiAPMzdHhztNRRiwuPPvbXNSFaLzfQ+9G0XizRvPgwgo3+8u3EzR+rWnCxzno/w/tzYsC0USrjI46IzBu9YiFqpoiL8bJXwEtx01bpMRL7DbldcsH7sf+bWzAWXM86P/a+mjdtNlwME3dC3kP7+wvWoSKNqar1ct3jCy8urHaa84pxkCMgHza00uqniwuhwIxYK1ysM3tfmA6aVLCK+SATuQVzocGVf1++i0PIQDMWWowX66xeXNDRizHk9siqteBSabmOuFA0sk50QVw/b3KgM3AswWIJYiI3iT7U15f2StL7HwpRM9DAQkvcaLwQj/iLQ8ih6IK80mptmz8kMQPNfXe14Lrjtcc3Ei/+HEsQSxCDTGZFE9t+S34kw3V7ty4CNSOvFFrlPh6vPm9UJuImgsY9YgyZyDCHVyg1Ol6Q92/JMCPSgqvjjc6LUiPFoLUGuUWzO1/5Nctl2U4hq1nVTFUtltkzXvUuZQ2KWExDJnKIuo7VJsplJYtZ0RS0Hi68wq1MwButGEMmMpnZrd/b+6c9Oj5aOT8vK1nMFq15pYpVrZfrrnMlGTcRFkuQmPYaZkJT+6qV3/F5/Vwqu2agkVgVS1ysM+7n6MXh5HC05doOjhZ+Sa4ZaKRWxarWcrHN6v0Ab0QNzDk0ZJBhBjrAvWdTrHytrp+eKtmagUbAqhbTxXjxPBlls47/kIlMaKpU59qSv08lMlPQernqnTJdaXCMxCDD3ITaYm35lbMzeedKVjPUZFUtuO54Xw1Fb8UjCA8ZZJhDOnBbOpMsWc1Ac79US9zKxLzpWqkE1hpkMoehj2W29iu/Ke9ZyWIGWmKqYFULrngjv674INOQMWY1h6PtMttWFys/LRnmhhrBCi241SnT5QYz/mQyB7hLUv5fuxVJyTBTwEKr3G4dX15rFTMZZqi5o7y2XK1WlAyzxlbFPuJWP8RNL5otMpnNweyDvLZTlSpeM9QIWGgtd/Gt6VHpjIpBhpnQXF7brNUEDDLQHLCiVW41mTU9KzY7BrK/OZgtAy5Kn3NXNZCBlpiqQSt9HDC9bDzhMJnQvgnXtnsl1WB20Ryw4CbnTa8bliGDDHOoWl8zfXl5CbKaEVOhlZaGzBM0PumATGZfuv2/DNgpOs6OgEFWs6IpWLXa1IB5mtK61zAzmhOsvOrl9fV1gwyzqskt32poa8lR83QNjjhkDlE7trGcgEGG2T9oazu93mY+yiDDHOzOO7bN29tbkGGGmq22pbfmyUvNgExmrr7RmRsBgwyzoIO7yr0wfVFsOOPAHKJ2pIfdmxuQYW5EVFtO7qq+Sc6ymsPUReE60+IlMtC+JYdMfzUoNzahOefh4cFZ+3NDZKDZfXn5YdT0X6nZjBOKfpBe/pFcMpm53FbW9GnpSQcFDThzL14PGWZm5z7243DR+IyeZoIDvHt/D7LHzG0M9dFFFVRq2J0zJ97pOwEzmdG3G9t9u8o+5rEg8NrdHch1M9Bw72z19yb7NG7R7H0pXhEzGejcxva8eZYNpGcnMzxgJsO8sTUUN8+72PjgjGWr941YmWxb29jaHn0GV1STpdKDwzOTiWkZsJe8trbxdWv7f6JS8Wx2VJrPZuPx3jP/AlrX7LfTkPddAAAAAElFTkSuQmCC",alt:"Chrome",className:"object-contain max-w-[100px]"}),(0,r.jsx)("p",{children:"Google Chrome"}),(0,r.jsx)("p",{className:"browserSubText",children:"macOS, Windows"}),(0,r.jsx)("p",{children:" version 53 or newer "})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("img",{src:a,alt:"Firefox",className:"object-contain max-w-[100px]"}),(0,r.jsx)("p",{children:"Mozilla Firefox"}),(0,r.jsx)("p",{className:"browserSubText",children:"macOS, Windows, Linux"}),(0,r.jsx)("p",{children:" version 58 or newer"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAC+lBMVEUAAABVdMdUdcplkeRuleVciOJhlfFchuB7qvddiN9qk+1chd1hiN5littciuNbiuNfieFljOBdieFbiOFSgt+QrulhjeRaiOJfh9ybue+OsedojuBYiuddieVfiN6NrOhXiueNq+eXsu6OquZdiN+Rr+qSsO1XiOOOremlw/SQr+pgiuCUsetunfKFquqgvfSNq+hwoPSPrelYhuJ0pfaOrOinw/VonPWFod9Ye8+PqOGhwPdxovR0pfdfk+5pnvaauPFkgtCgvPKjxPl2jMynxvuiw/pimfb29vZkm/ZJivRCctlpnvdLi/U9b9hMjPVmnPZnnfdAcdk7bdg5bNdOjfVEdNmkxPproPc/cNhFdNrz9PVDb9JEcNNEcteXte9DbdFFcdVAbNFFc9agwPdBa849ZMZCbM9cj+yVs+6Use2YtvBCcNacuvKTsetZi+idvPRCbc9AbdNgmPaaufGRrelDcNWiwvlBbtRZiuaSr+ucu/M7Y8dEctaZuPE9Y8VXiOShwfdbjeo9ZcmevvaOq+dgl/SMqOV8lNWhwfk/aMs+YsN9ltd6ktQ/as9Ccdc9YcJ3jtB5kNKfvfWPrOeEntyCnNudvfVflvOAmdlAb9WBmtp1jM5zicw/a9GJpuM9ZMhdk/BzpfdelPJbjus7Zsxwhspcke6NqudVhOFtofdQfdw8YsRXieZZjepVhuNnjuFCb9Vwo/eHo+F+mNizzvtWgd21z/uEoN/u8faQrutuhMfi6fWoxvhgiN9chd41Ycs6W7k4XL2ryftOedU4Y8tKeNs8X76wy/uTuPZGbMprgMRQfNhMddPq7fRwoPNjjOBOdM+tyPWPrOm80fWYu/U7Y8l3p/fY4fGwxe6NtPbe5PHQ2e3J2fVrme5fgtWowvFoleqBpOg4X8HP3fVSkPVUfNSyzPbC1fW/zOpij+ZriNOIsfW4zPGivO+BrffK0um5xeRrkN+puuKhtOJ1kdiAldGSs/BxmOSdrNmYptSdtuqLnM96mt80jhAkAAAARnRSTlMA2NUIDlH+Iv5dFi7s/HShat++kv7kybF/WyTv3IQ6+fXbRj3UjFHsazS/mXlfLcqvoZ1G1cyMiFX8+drE9u/s8tao5uOxacsm4AAAG/pJREFUeNrsmc1q4lAYhg+oSGrUREGFYFbCLFz2MgIuNAQ8qBiy6Lqb2eWKsnGVZbIpWbWQO+huLqBXMG/S0x6tkxlCfu3kwZRu3yfv950jkoaGhoaGhoaGhoZyafdUVe3E4J9um/wftHqdwXg6kZXTV/qiPJmOB51ei3xPWj1pPJLfTqfQ813HcYKAUqrFUBAEjuO6fggV8mgsfTMNd8JygmRR8sDQwPqa7TsaDRzXC8P+ZCncke9AWxjKyI7oGmedaACsVqutEaANoTwUbnw39GZ4876L1/6FvwpgbAPHD/ujWY/cKPdD5eSx8CkEwABnSyFBHN6Tm0NdylF6LYl/CuBocCCPb6oHd3Okd6h2RtoZuHawGNzKPlBRfTTf0HIRwB14yvAGatCS5JPvGCC9gEQDDOqGC6HeF4T2DPEDg6GBPJYAR3NDcVZfBe05uk8NRp4zwFk7Xl0VIH7oUsAN5C4AbFaBJ87rp6A1UEKHRqSrQHoBm1iBVDMFksziXxrIcwlwASDwZYHUB3WC2WcUPQObd1aON1JJPWgP3/yAnlO8ALB1+8taXI0kNvypKpBdAKC+WP0cdCcnFj/1DGQVAAJv1CWVIileQK8pSMC1gbUrSqQa+Os3qhHAS3BHKkJQfESlyQ0ABQsAK1fskCpoLd/iey/i5iYg3RLgJRi3SOn0ZC+wDJBQgcKPAY6+dRel70JBcS3LMpA0eioWoG+cssdgeXpG/gMzQI0sWzC7AEC9JSmP9ih8siIOLGb1AvS1Py1tEXRl32K8VwB/Khegb0pbBKri2hbjUJsGAEfskRLoKM+WaV9WAGQ8B7MLAIF4TwpH6D+bEPBh4PAxBHUQoNN+4YfBoP9kmtZFBcC1gioEAM2XSKHM+i8msCzbvtqDNWiArm/9ASmQeZyfV+B8D9ZhBGIDM1IYM5b/j0NAjepOgZI6gPx7c2/GnFeAGaj8GGSsCjKA/OY+IqECoB4C9E0xm1Bi+VkHLo9CNgT1EIAOCCR3Oug/gwkwPwUcDEZF3wavDXi534hU5N/teQVibCaAV6AmAvRt3rfirviy2++Yga8C7M8KZL0H5SQAaGKX5Eh78bRDfAj4g4ED4Hswn2tARgGALtokP0a/jpGAzyH4FGDHAmxm4GBcFaAiASCYktwYvx6Px6QK2DYM8ArURoDuzElOCK+PjzDAKoCH70EbIP5ZBYwofy0EbPwOyYWeuH+MDcBBzM/zCoD3ITDwgYHSfhrj6AmsfuSyCFuLl8dzAewwMAEvAbCggB2FKfIXJwBoixbJzvTXw8OFAfBFAOJHz0cFjHIF6MkES5IZ6fUBMAG742UF9rwC+EQVuESr5hrA+c2cmYbMFMVhPFuWJJFCvskHZUmJbNn3EVlyGVvWMMTYJkQa68WMfRlrI9LwxZDsWyFDeO37kn3JkqUsHzzn3HvO/5575457XcXPnaHkw+85z/mfe177SwV/A5oI/zwV4PJTeQLmHARQxof8/9EMJHoFHgOti0aNkAnAn+YgR1RgGG0CfALugOABEF0rBbwCPx8xggKwzUFWA6oA4JuAOtD1Pwig966KgU7Ah6NGyASGWDeBiACbgKYAA9qDKIB/dggQgTZB6xz0jQSGiArQGKBNMJUlwGHW+A4wAv52AD0DvBI3eL9Mh75jE+BRKjB16lQ6ClkCgQsQPABiV9k/PgHep5+fpQSoAhQAA2fB1AhtAl6B/2YEMMr/6b2wYTpz6exs9wpIfQbmoFqBrv9NAF0r/5l/3feZTPbYybgzAQRACUCeVWAqq0CEEvDvHzQAd3b92Y+HWmS1TCadO6kXrgDTB2wOJpMiAHz9LyMA9Kr0RxOwjKYhgccnz7omAMwEBvJNkEyaFQD/UwC9z5Ty71/ufUZjpItOLtPd5iAYyPX5HIxEzARg+D/tAFDD/7Ww+U3N4NLJs0jAUQH5UkgViAyKiAokk/9XAP0r+C+AZpJ9mCcBEQNVAP4ogVkB6BdKgAunokM3b05s98XpApwoSJOSfguQ1gTpxSeXLba8DuCjXI5pDrIKJI0GFAogEk1sj2/dqueKmjx8065du9bFixdzxf3vivuhdVW/70CaJPMaFaBXwomWWSDn4J49RgX4HGQtcKtAz2givjX3ZsPnV7fCnYi7Hz5++3nezmELOxQ2GWyULOesYJ8VK5YaLOQsYezb17SkvwJkNQJH4TIkoFaALsfYBAMQACPC5iC+BuXX7xfVtxZ9+Xyrkwt3P37fJN3JXNpvwmNC3qa6gNwBM9+3fsOG9es3rK7lawLgCCQyD1AB7AL4UwLK5RgBmAlg+RECEnDOwVQinvvyCuteiPCH74fPc2/7mgtMc+FO3hxmzRcd4kx9jaRKCb8FILLPUQGeAAUg52AsBn+zAhETDAKmn1T133y62MkDFz/+PCylCaXsedab6r5kPYD6as4Bky11vPuXQAEULp09SwkoFYhGo7EBgE8BigAVUDoQSehL7nXyzK3vh0l8E3k73OHMV9wwB+sNeaZN7OVU8fESmNZUssf4JkACFIBIIMYTEBVIiQpgDvYUCfRM6Kux8f1w99sOUXYhb1lxPGAJHtKGN8C6Q5jYsmXvFvYbWFXNcwCiAMochL+awNChQ1kGqEBMVCCWSlEFkj3NBKLxN7T63iP4uUlZc1vZyXzDeiYOWN/hamOBpL7na+BNzQ67EiyWCYARI4YCDAK5CfYwUiKBZCRpBhDRiz52+iM+fN24wqEPdznlmDm+mDseJk/WNvmdYHxNrz8HUOXllYCDBEyGKhXYg2nIEogIkkYCMX01jT6fXPy80TSHu9jo60XfAU26vVvIFY+hPE+yitPGm3912w6gKwFjsZoAVQD+MUcFIomiV50CcO8rEqAJb5Qeq262XshL+3k7xXJLa+Jqq5LeRmBWy0P2OCpACSgViLFfwKgATyAFf6C/OeJ24B+5f2XO9Ttv3965PufF/SNhtxJ8Xy7deenFygPLynNj5s3dwVXOlClTDh06dBUfMH36GG8nYQvVnK4Ep3gAs0UCQy2bgBLgcxAPSKbiTcN5ra6dCz3rI+jOeNbj3LWLeYP6tBwBCHlyB1h5sday6FPwGHBlPILxoL6nEZjW8pK5bByFi3kCVAEkMDQKuH+MVyBlVCCWyzf9jhzN9FHoLuiTOZqvLx9WLOH2eIQ6Jt4WvupSXqw3d5+eR34MY3Jt3yPQfiVYzKAEBFFAFQBIIJpzbv/wtTJkTv6UQZlrYfs/wSBYwgIQ/ug9Om9scrnwkulwl/LjJWM4oxt5COCm5gauBIb/7NnOBLAJeAWMAFCAobkPdv2DVzqSOAWgMunKQUUfz62v+9aQ/E6pLMVpocl6jOms0MzvDnBcCYwAzAQSCWcFQApg/R0vPy+g7+5PdHyhNAC/7n5dD39seqgDWm58HGtN621n8GDaA/52AF0JRABIIDEisTlhqwAF4PB/qvXx5A+6hZ4qDWAdWL1lAbnbF55QF34woD+BsY187gCVzDFRgd1IIAFsFcBjJqC/srX/XJ+85PXv1q3PuYNqBLf2LvAqL5bbhOQZzQLsAJAeeWrx4t14eAdQATUB+KeMAPSPtuVH+70XgNHxqVF/8X1v7zx768ka36q8hNzBrFmzVv5uDzTXQloBjCvBbgQAdFEBSsCsgN5UHeRzcOr7KACnz3DZAM7HvVOYNclzayFOrbdjugt+twdahECBChThbWg3D2DkyJF6ngqwBIa+Uf3vQNVHAQR34C4agF+fFzDpfPLqwo92LLxk3Lhx9Qv7l06HOIXmIPN3SwCkYtGiI8r2v+nPn7h5kOubXGy6arxDXqKuOh5DfLJVfgaelSUL3wMyIRO3Obj/5DIEgAcBIAEWwObNagVoAJK/nwCI9EEqAH5OtHc6c/e63SczhDuXZ0yoVvgQDFnIX4HFqACYPVImwAOgCiTWKP5p//5EFgnQcXB7SwH5sXZ5/pux8PgY9hMmrG3z2xHglgH9LwHtAZ7AZqoAo+iidf+X8e5PARBlwrIBCHPKFCGvitOsE/L821x4kseztuBBWC8bcuK4EpySU3BrngT0T9YC3AnkD+5QljgLt4xR5YGj9RA33KX8BCG/du7ctXPKFQigsRZyx3IlgD4CMNGVTaCeAFf6BAsAXBFTgPFpFbkLFHl14ScYC2/K4wHDq3kbAe6wK4GagKwA0O9Z33+eBfQHfW5ZLwUL2Por4gxaeCEPcWq9kB/OaeRxBLhzadlZpi8DiIsKbAZLrQOwc2B/0PGgIc+5vcpl1cXCc3m19STPKfAmUCIb8kLm2Kll8DcDwCCI6zCHPlAKcM7d30cAXc5RA8JHFox2bHe19YBab3OfM2fO8EWPClwEtJAnMAdpBwD8V/dmlAAkNlo3wN/x79LtKTUgfHsKyQO19Zy5a7k7sMsvWsQ+09yvAw1C3sCVABWwsBW7IGEvQFgL5E8BdOnB7XkImAJjmbUA7or8hAkrV+aTH87cQYdp0zq4T8HmIY9ki04hADoKtyIB3oE3Xk6A7v4KAPhJANj3u/FSfgK1ni/8SjB3pc1dynfoMK0Dx30Ktgx5hF0JTH9DH7AKjPhkmYDr/pI/2CZeicG9VZNJfoJFHuYrV1rNqfV84SXtXQPIhryS3X9yN78SzIQ/AsAm0JFA7qJSgGD+FAAqIGcAXgdnKQuP1kNedTcw3U15oq2bfzkE4JVLi08ZNwIeAI7COBKwnoEH5/81f7AuTEfh7fGGO8RF6x3yi6j1TvqWcDsEQt7RXqMCbBegAtwf6NafA11z9fcfALhG78O3pnB5AHe7/LRpEJfjzgW3Y6Ax+fk4ClkCcY6eC1MAN/+iP7hJDQiPn8zlne7T8KHWu1MtwClIPDj1xPRHAAYbyf/IX/UHR8TLEPbAYKe8hFrvTp0ANwEie+HUbvjLYwB8owCmBfdXAzjK7A1ejiF3VR6PFxoFOwXpSvCE6/MKsAi2fqAAMi7+PgtAXLK8Do9fqbSewVrfF3gKoP3fCUA7jgpw/Zkzt8ZvxOM58r/4l/3BRVmB8I9xttZzd4/+wO06lIGVzzmIPcAw9sAb5QwI5u8M4JplCEyeJvzNhfcXgNsPhbSQTx6femL68wBWF7gHdg/mD85ZhsAvZs4uRKYwjONvYQ3lI6KIG0XyGeUChVwwU0fOuVBbc+HGnVYUbZuNWaSWy01cz90MRVOW0YyLpRgxy9oZszOG8TFmjN3xfSEpz5xh/i/OOebM8678tHtsWfV75n/e53nnvM1e6YV34+88CU1wXYDIvYFuE/InpDm4XZU/0JCAx7vxwrdSgE5hySrNNU9u1SOQNiPwGhvBIsPfpgC7/I0I5HZD34U/mCqsmKS5Jtw/cIFe/x+LQM5mCtjJ8LecBJJ79/AKMJ85CYPI0Rfkb64CchPIq/MHeSwC1T6Gv+0sPFNzT3uFIlCDpoAH8k4Q+kx/MIRFoLp/PAowXWuByJ0BcxWkP+tRgB7oO/q7KkAPElA4zPAnFvH3QvKWoL4Opp+iACl1/iAlDQId/08BwncHTP/utDQHJaDP9QdZJAAFcOMPlqgpALYENdKfUYBR6HP9wSgSMHaQV4B5agqALQHpp7vlAkCf6w9GkQAUAP7/ugAgcupFd5oiIN8C6vxBVkpAh0UB2LfAQq1FntUjIC+CbvXhb0/Kcg2AP3sRnG7Aye2WgPyPy22wNX/nAvRIXeDweBRgpmGgBG63BOl0Wh6E1PmDIWkO2G/lzx2EVhomWktbAloF5FHYnT78ncgjAYU+C392ASYZDVy3wqO1VhjDZkidP4g1EpCs7rEsAHMzNNkAropA/7ZSm4beIQJF9f5FP45JVDtZ/r0ThRUTdOMP/u5eJ3KAWuFHFCDsQh/+jrTjycDLKi8Ae4Q1umGHnTh4QhHYIPVBVf4ghZMy5Q6Gv8PDQZ/ROrQlkEfBspU+w58oIwFjHQ7+jDdFNxsMaEsgPRlL7lLtvzOKBBT6WAXoXD0eBWgPDHQ/lhYBNfpgECcEYtVOhj+xVVgz1+BAW4JPKEDcQp/hjxMC9D1fdfJnPBpbY3CgLcEb+eGorM/335lEAsb6mAVYKqxZaLAI3zvtRwU80Gf7Ex48GPOP9PH8aStgzSTdYPHkhXxAAvpsf2IM58QyhW08/975wpqpPoNFe790QMCvQ5/vv90vvRtS5fgTZycIG9oMHoOnkqhAia8PSng4Hi30MAuwUdixyeChVT5KEdiuzv+kH2dFXxYY/uiCKvsgCH/2gpICfwQAb4cVWP7EYmHHcoPLk3deEOHpgyAOyfljhU5uAZYIobgNgPBVL8jsUuO/I0PiPxPAD8CJ+cKOCdxVUNcHfzkuz9TH0QiMwUx/YouwZ5NOtG5PaIe8INquwl+LSkelhws8f2KZsGeu/gO37iCS8YJckalPFHNYACkAcYY/1kA7Fvp0CRfuwBj1Sgwz/Ylh5J+m4Dg7AL1LhD2TT+oWNCMOwmWvRIKnj7NRZg1ejzD9icMThQNtOh9P1CuRZegTow17IjkyxPQnVgsnFuh8tLj86Rd+D8f/EUZAusKfwVrhxGyfzieS/2lfIxqEvluCUVSydgPc4PvvWSKcmNqmK8ATw6tG37LQd0eWfhsJyH0tcf2JLdgK2k0CfLRszRvNOwF9NyToV7ECRs+UbjD8MQU4M0tXQXgI0a0xXHSvXzT7H/6PL9XLCgLQu0I4M6VNV0FkGM27dslpbv0HYz/969eP367EFQRg/yoB1DdCEMRCaBJN7HAX/+gv+t7362/fVvD6b5sjgMM0zMd49BL3r/mX3CMX3c8cf1EC77v1D6/An1GBxeJvTFIUAc0Tq8tDpXSuOf1zJXP1g74/8/Tp5RtsfyKFO2Dc7gFUgDKABJg65fYmNn/lH8FBAt5Ne9Bxme2PMdCZuT4V+j6fT3uU9yIBjY/Tc1wLdniGf5ojAa+nvfpw5QbXHz1g/O8BXx0jWG4kANdY3LYjaPFYo1qow8j1/gfxy/BncGS+aIJNfPlGBUpIgHRJllODxd+6/mCqnETj8KOLfroeuvecWiBfH1OQMzO2M+WBHsnG4IRQ16h/qOrbt9lUz1A+hjr9moDct/uhuzepBarwPztPNMPENq480MOe/G8JqBfCAtQJCXh96X6o/8G1K0r8e7EPcGaBrwZLHWjBeBTiqATKgB9wqX8l993vCoXuUgtkaLsYAjAOywatiQM9Qiv7nwmAOH7Axfwa+VAJhCgA1AKVFODIKtEkm3xK0YKJmMsEEJmr9yuBi6HQTWqBagKwTDTLQkRACXo4mMq4SgB9gOSlSlcgFAidpxa4TQkHF4mmqfgUY0SCCbMEzSSA9J9XKl1dgUAg1F9rgWoKsE40z4yTvvEoQTnqdU6ASXLs+bNnx7rqBThPLVCN//55onkmfqfmbFqbiKIwfGBC1AqpaGJtqTYxaGMRKYog/oEh0IWuFFx0k8VNA44QXQwFiUN6IWsFs51kYLQyExAULH4s7EZoEaylICgoIgh+LHXpmQ8dhfoxM+cm4/MP3jvvOc+9KZSV6Tm92NlYf3nvDw1A7r1fe/3qtab4+W+u0igQyUkQgpF0WQQztzudD8/e+mGDBvjhX3568/rVK6YpiHMAuAFpFIjMlwDCV4CeUzOLnc7GkwfP394/98v/2v9Y+fIUvz0zNE1T3AagArKoQMICJKACLqdnFrEJnY2tnz+8ePLkxYfPGx3k9iJ+ex+vAGQKRNZLEA7JKIsFfzDA/8/pcvbszOmyLMsmRmcMO+AXgEyBSAEAklMBRN4E5uIWwNuAdAq8WIKwSHm5LAx5M9rMxdsAFh7ACpkCW8chPBmzLAh5c3TmYLgFsNwCnKdS4GwRIjDJyyKQf4fJkB8bsEf1CkSa0xCFY6x/6RHufH7nBPD7OwXIrl6lUuD5MYjEeFp8/ID2jwHAE6BV4AGIxpAmC48foHsH4G/AHp0CKwUJIrKXCU8f4DtQ8e8Ay2QKrO4HZLBDIP8d/tMKtPAO9I5KgfNHITpbNMHpA9LeAdhOfizA6hyRAlu5FMRg2BSbPkD38yvOAPToFFgdBWRAQyCHwPxxAA2nABfunBn8ADgMKbL48Ag3TUcBtncJWqFSYLOQgpjs0ASHD1aAZtiK24AsmQIvFSE2u3Wx4YMJMPwJoFNg7TDER8qnRWUPqJtOfv8AyH4InZ8CCrYrsqDsAW2TaX4B8A70hUaBzdwQkJBRZDHBA7ruDnQciAp8RKPA1sQhIGKEyYLRmcG8ZxAqkOgVOFcCMiZNWSjc24EaDgCZAmengY5UXpdFwt1bkHsJzK7SKLA2JQEhW9S0LITgHmzbimWRKXC9kAJSjqltWRz+BsQCEL0Cr+fGgJiMymVRcIP5z0AiBTYnikDOXnEngBNgeJfglYeoQIL8+0EAuxRBJ1DHCfDugCQKxPwHQQjDiiyCetv/LdBqrHwlUGDz2igIYqeIDtTxAAzvjyEkCqwslUAYwyoXUACd2e4K7K0QKLC5UAKBDJPbsM79A8ACECjwOs6/UHapnLoA3FuBngKTnt85gTRtAXiXGShBy7oV/xW4jvmFs001CfPjBJhuASgUWMsdgT6wL88oB6DtTgCBAlvVwhj0he15jbAAXUNzVmB2+fGdePnnplLQJ4YmFU5VgK7uFSCuAptr0xL0jxFLpyqANwFxFXhxogR9ZY/FaBTQNWwb70DxFNiq5orQZ7bnlXb8AcAJYAoW4FasV2BzaWoI+k5qXNXjD0CXObfg3nIcBV5cOCDBIMg0bB5Tgd8LEEOBlfOFIgyILeNqOs4rEPPrhqaoN2MocH7taAoGx4hq8zgbUHcmIIYCm3O5URgkWIKGGTU/dwtgR1dgq3YDP/+g2dNQulE3oG4aitJYrkVT4IWlwn5IAFgCux2xAM7fw6IpENs/kYDP73FsssHqUTYgFgAVWImgwNbsjekxSA6ZvMXqIR8BzgGgAiIoEOMvHC9CopBGVMush9gA3MnPbCuCAluX13IlSBzScAOPINQGxAmwQisQ4xdGIZEM7cQW8H/agO4GYMxWsndDKbDVml3LHZYgqUi78g3jr0bgvO0XIKwCm9WF4ycg2WQmeyrjf6p//Xt+pwAhFFipLd2YTtjq25Rt41bD6P4mPcK5p0DmFODKvyrwenXh5NEj8H/wbSz8CuvXYoRBMRS0wUrAdetgVSBh319eYTAoWn3EJwOVhvX5y2cgfI8AM6Al4JJ1649c2kpExgcmfUXVoRL5SMBYCJgO1gGrhWIkAG4CwxIA4SowpSTr8gpTncHU5iMJsALDYH1+xsI29ASwHJQAVp7BWwWmVMfvWiGvNXR9DwFcwjIN64ElwvLFbYgCAFQFLMk/cxJXCdjZUpK5a0W7opHaYOnuUAa4hWWAKQGUHxYuXAwNgCXrsFaBKdOrs7N2ta6QN1VV42IYToCFk19FfT0QrFzfsLZh7VrgSHjBiUawn4GgpaC6LjsT5HNgvBuoSuoN3sYehcHAKiuuoi4isnr16lP3f5e2IoC8qKKpgaqGktRw9To6YGflVFK2AANlZWWp4ZHXR8EoGAWjYBSMglEwCkbBEAIAvKztPKxYL9oAAAAASUVORK5CYII=",alt:"Chromium",className:"object-contain max-w-[100px]"}),(0,r.jsx)("p",{children:"Google Chromium"}),(0,r.jsx)("p",{className:"browserSubText",children:"Linux"}),(0,r.jsx)("p",{children:"version 53 or newer"})]})]})},l=n(1435);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(e){var t,n=new Set,r=function(e,r){var i="function"===typeof e?e(t):e;if(!Object.is(i,t)){var o=t;t=(null!=r?r:"object"!==typeof i)?i:Object.assign({},t,i),n.forEach((function(e){return e(t,o)}))}},i=function(){return t},o={setState:r,getState:i,subscribe:function(e){return n.add(e),function(){return n.delete(e)}},destroy:function(){console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}};return t=e(r,i,o),o},f=function(e){return e?h(e):h},p=n(327).useSyncExternalStoreWithSelector;var v=function(t){"function"!==typeof t&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");var n="function"===typeof t?f(t):t,r=function(t,r){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.getState,r=arguments.length>2?arguments[2]:void 0,i=p(t.subscribe,t.getState,t.getServerState||t.getState,n,r);return(0,e.useDebugValue)(i),i}(n,t,r)};return Object.assign(r,n),r},g=function(e){return e?v(e):v},m=g()((function(e){return{hasImportedStatements:!1,setHasImportedStatements:function(t){return e((function(e){return d(d({},e),{},{hasImportedStatements:t})}))},hasImportedSorts:!1,setHasImportedSorts:function(t){return e((function(e){return d(d({},e),{},{hasImportedSorts:t})}))},showJsonParticipantIdDropdown:!1,setShowJsonParticipantIdDropdown:function(t){return e((function(e){return d(d({},e),{},{showJsonParticipantIdDropdown:t})}))},showJsonFileLoadedMessage:!1,setShowJsonFileLoadedMessage:function(t){return e((function(e){return d(d({},e),{},{showJsonFileLoadedMessage:t})}))},jsonObj:[],setJsonObj:function(t){return e((function(e){return d(d({},e),{},{jsonObj:t})}))},csvData:[],setCsvData:function(t){return e((function(e){return d(d({},e),{},{csvData:t})}))},jsonParticipantId:[],setJsonParticipantId:function(t){return e((function(e){return d(d({},e),{},{jsonParticipantId:t})}))},excelType1NonsymmetricArrayText:"",setExcelType1NonsymmetricArrayText:function(t){return e((function(e){return d(d({},e),{},{excelType1NonsymmetricArrayText:t})}))},sortsAreLoaded:!1,setSortsAreLoaded:function(t){return e((function(e){return d(d({},e),{},{sortsAreLoaded:t})}))},statementsAreLoaded:!1,setStatementsAreLoaded:function(t){return e((function(e){return d(d({},e),{},{statementsAreLoaded:t})}))},projectHistoryArray:[],setProjectHistoryArray:function(t){return e((function(e){return d(d({},e),{},{projectHistoryArray:t})}))},statementNumArray:[],setStatementNumArray:function(t){return e((function(e){return d(d({},e),{},{statementNumArray:t})}))},csvErrorMessage1:"",setCsvErrorMessage1:function(t){return e((function(e){return d(d({},e),{},{csvErrorMessage1:t})}))},showCsvErrorModal:!1,setShowCsvErrorModal:function(t){return e((function(e){return d(d({},e),{},{showCsvErrorModal:t})}))},oldQsortPattern:[],setOldQsortPattern:function(t){return e((function(e){return d(d({},e),{},{oldQsortPattern:t})}))},requireQsortPatternInput:!1,setRequireQsortPatternInput:function(t){return e((function(e){return d(d({},e),{},{requireQsortPatternInput:t})}))},isForcedQsortPattern:!0,setIsForcedQsortPattern:function(t){return e((function(e){return d(d({},e),{},{isForcedQsortPattern:t})}))},showForcedInput:!1,setShowForcedInput:function(t){return e((function(e){return d(d({},e),{},{showForcedInput:t})}))},numQsorts:0,setNumQsorts:function(t){return e((function(e){return d(d({},e),{},{numQsorts:t})}))},qSortPattern:[],setQSortPattern:function(t){return e((function(e){return d(d({},e),{},{qSortPattern:t})}))},numStatements:0,setNumStatements:function(t){return e((function(e){return d(d({},e),{},{numStatements:t})}))},respondentNames:[],setRespondentNames:function(t){return e((function(e){return d(d({},e),{},{respondentNames:t})}))},mainDataObject:[],setMainDataObject:function(t){return e((function(e){return d(d({},e),{},{mainDataObject:t})}))},sortsDisplayText:[],setSortsDisplayText:function(t){return e((function(e){return d(d({},e),{},{sortsDisplayText:t})}))},multiplierArray:[],setMultiplierArray:function(t){return e((function(e){return d(d({},e),{},{multiplierArray:t})}))},dataOrigin:"",setDataOrigin:function(t){return e((function(e){return d(d({},e),{},{dataOrigin:t})}))},statements:["",""],setStatements:function(t){return e((function(e){return d(d({},e),{},{statements:t})}))},projectName:"my Project",setProjectName:function(t){return e((function(e){return d(d({},e),{},{projectName:t})}))},version:"2 .0.0",setVersion:function(t){return e((function(e){return d(d({},e),{},{version:t})}))},browser:"",setBrowser:function(t){return e((function(e){return d(d({},e),{},{browser:t})}))},showErrorMessageBar:!1,setShowErrorMessageBar:function(t){return e((function(e){return d(d({},e),{},{showErrorMessageBar:t})}))},errorMessage:"",setErrorMessage:function(t){return e((function(e){return d(d({},e),{},{errorMessage:t})}))},showInputErrorModal:{showModal:!1,titleText:"Error"},setShowInputErrorModal:function(t){return e((function(e){return d(d({},e),{},{showInputErrorModal:t})}))},isDataLoaded:!1,setIsDataLoaded:function(t){return e((function(e){return d(d({},e),{},{isDataLoaded:t})}))},unforcedSorts:[],setUnforcedSorts:function(t){return e((function(e){return d(d({},e),{},{unforcedSorts:t})}))},continueAnalysis:!1,setContinueAnalysis:function(t){return e((function(e){return d(d({},e),{},{continueAnalysis:t})}))},showWarningBox:!1,setShowWarningBox:function(t){return e((function(e){return d(d({},e),{},{showWarningBox:t})}))}}})),y=m,w=function(){var e=l.Z.BrowserVersion,t=Number.parseInt(e.slice(0,3),10);console.log("short version "+JSON.stringify(t));var n=l.Z.Browser;return y.setState({browser:n}),"Chrome"===n?+t<53?(0,r.jsxs)("div",{className:"flex flex-col items-center text-4xl bg-yellow-300  rounded-lg p-4 border-2 border-gray-400",children:[(0,r.jsx)("p",{className:"mb-2",children:"Your browser:"}),(0,r.jsx)("p",{children:" ".concat(n," ").concat(t)}),(0,r.jsx)("p",{className:"mt-4",children:"Please update your browser "}),(0,r.jsx)("p",{children:"before using Ken-Q Analysis"})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center text-4xl bg-green-300  rounded-lg p-4 border-2 border-gray-400",children:[(0,r.jsx)("p",{className:"mb-2",children:"Your browser:"}),(0,r.jsx)("p",{children:" ".concat(n," ").concat(t)}),(0,r.jsx)("p",{className:"mt-4",children:"Ready for analysis"})]}):"Firefox"===n?+t<98?(0,r.jsxs)("div",{className:"flex flex-col items-center text-4xl bg-yellow-300  rounded-lg p-4 border-2 border-gray-400",children:[(0,r.jsx)("p",{className:"mb-2",children:"Your browser:"}),(0,r.jsx)("p",{children:" ".concat(n," ").concat(t)}),(0,r.jsx)("p",{className:"mt-4",children:"Please update your browser "}),(0,r.jsx)("p",{children:"before using Ken-Q Analysis"})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center text-4xl bg-green-300  rounded-lg p-4 border-2 border-gray-400",children:[(0,r.jsx)("p",{className:"mb-2",children:"Your browser:"}),(0,r.jsx)("p",{children:" ".concat(n," ").concat(t)}),(0,r.jsx)("p",{className:"mt-4",children:"Ready for analysis"})]}):"Chromium"===n?+t<53?(0,r.jsxs)("div",{className:"flex flex-col items-center text-4xl bg-yellow-300  rounded-lg p-4 border-2 border-gray-400",children:[(0,r.jsx)("p",{className:"mb-2",children:"Your browser:"}),(0,r.jsx)("p",{children:" ".concat(n," ").concat(t)}),(0,r.jsx)("p",{className:"mt-4",children:"Please update your browser "}),(0,r.jsx)("p",{children:"before using Ken-Q Analysis"})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center text-4xl bg-green-300  rounded-lg p-4 border-2 border-gray-400",children:[(0,r.jsx)("p",{className:"mb-2",children:"Your browser:"}),(0,r.jsx)("p",{children:" ".concat(n," ").concat(t)}),(0,r.jsx)("p",{className:"mt-4",children:"Ready for analysis"})]}):(0,r.jsx)("div",{className:"shouldUpdate",children:(0,r.jsxs)("p",{children:["You seem to be using"," "+n+" "+t,(0,r.jsx)("br",{}),"Please use one of the supported browsers."]})})},b=function(){return(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("span",{children:(0,r.jsx)("strong",{children:"Supported Browsers:"})}),(0,r.jsx)("div",{children:(0,r.jsx)(s,{})}),(0,r.jsxs)("div",{className:"m-8",children:[" ",(0,r.jsx)(w,{})," "]})]})},C=function(e){var t=e.handleClick,n=e.buttonText,i=e.buttonColor,o=e.buttonId,a=e.disabled,s=e.otherFormatting;return void 0===i&&(i="bg-gray-100 hover:bg-gray-400"),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("button",{id:o,className:"btn text-black ".concat(i," ").concat(s," rounded-md hover:bg-gray-400 border border-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-700 focus:ring-opacity-70"),onClick:t,disabled:a,children:n})})},S=function(){return(0,r.jsx)("div",{className:"flex flex-row justify-center w-[280px]",children:(0,r.jsx)("a",{href:"https://github.com/shawnbanasick/eq-web-sort",target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)(C,{id:"eqWebSortLink",buttonText:"EQ Web Sort"})})})},E=function(){return(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("a",{href:"https://github.com/shawnbanasick/kade",target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)(C,{id:"kadeLink",buttonText:"KADE",buttonColor:"bg-gray-100"})})})},k=function(){return(0,r.jsxs)("div",{className:"flex flex-col items-center bg-gray-300 rounded-lg p-2   w-[1200px] justify-around",children:[(0,r.jsx)("span",{className:"m-5 py-3",children:(0,r.jsx)("strong",{children:"Other Q Methodology Tools:"})}),(0,r.jsxs)("div",{className:"flex flex-row justify-center gap-4 m-2 w-10/12",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("p",{className:"mt-8 mb-2",children:"Online Q Sorting"}),(0,r.jsx)(S,{})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("p",{className:"",children:"Desktop Software"}),(0,r.jsx)("p",{className:"mb-2",children:"for Q Analysis"}),(0,r.jsx)(E,{})]})]})]})},x=function(){return(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("a",{href:"https://github.com/shawnbanasick/ken-q-analysis/wiki",target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)(C,{id:"referenceGuideLink",buttonText:"Reference Manual",buttonColor:"bg-gray-100"})})})};function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t,n){return t&&R(e.prototype,t),n&&R(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _(e,t){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_(e,t)}function O(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=D(e);if(t){var i=D(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===N(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return P(e)}(this,n)}}var I=function(e){O(n,e);var t=F(n);function n(){var e;T(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={isActive:!1},e.setIsActive=function(t){e.setState({isActive:t})},e}return A(n,[{key:"render",value:function(){var e=this;return(0,r.jsxs)("div",{className:"accordion-item",children:[(0,r.jsxs)("div",{className:"accordion-title",onClick:function(){return e.setIsActive(!e.state.isActive)},children:[(0,r.jsx)("div",{children:this.props.title}),(0,r.jsx)("div",{children:this.state.isActive?"-":"+"})]}),this.state.isActive&&(0,r.jsx)("div",{className:"accordion-content",children:(0,r.jsx)("ul",{children:this.props.content.map((function(e){return(0,r.jsx)("li",{children:e},e)}))})})]})}}]),n}(e.Component),L=I,M=[{title:"Version 2.0.0",content:["added databook export","added text format results export","updated React version","changed state management to Zustand","changed css styling to Tailwind","began Typescript conversion","expanded unit tests"]},{title:"Version 1.0.8",content:["fixed browser version","fixed degree display when restarting analysis","fixed manual rotation scatter plot axis label display","improved change log listings"]},{title:"Version 1.0.7",content:["fixed bug in CSV Q-sort file data import. Version 1.0.6\n      gave incorrect correlation values for the last participant in the\n      data set when importing CSV data."]},{title:"Version 1.0.6",content:["added attribution data","changed KADE button and information"]},{title:"Version 1.0.5",content:["added KADE button","fixed autoflag history bug"]},{title:"Version 1.0.4",content:["changed links for help buttons to github wiki pages","added unit test coverage reports"]},{title:"Version 1.0.3",content:["fixed readme typos"]},{title:"Version 1.0.2",content:["various readme additions","readme updates"]},{title:"Version 1.0.1",content:["react js version update"]}],G=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"render",value:function(){return(0,r.jsx)("div",{style:{maxWidth:850},children:(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"accordion",children:M.map((function(e){var t=e.title,n=e.content;return(0,r.jsx)(L,{title:t,content:n},t)}))})})})}}]),n}(e.Component),B=G,j=function(){return(0,r.jsxs)("div",{className:"flex flex-col w-[1200px] mb-8 items-center p-4 rounded-lg bg-gray-300",children:[(0,r.jsx)("span",{className:"py-5 font-bold",children:"Change Log"}),(0,r.jsx)(B,{}),(0,r.jsx)("span",{className:"py-5 font-bold",children:"Reference Manual / Help File / FAQ:"}),(0,r.jsx)(x,{}),(0,r.jsx)("div",{})]})},H=function(){return(0,r.jsxs)("div",{className:"flex flex-col items-center text-2xl bg-blue-100 rounded-md p-6",children:[(0,r.jsx)(o,{}),(0,r.jsx)(b,{}),(0,r.jsx)(j,{}),(0,r.jsx)(k,{})]})},V=function(e){var t=e.handleClick,n=e.buttonText,i=e.buttonColor,o=e.buttonId,a=e.disabled,s=e.otherFormatting;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("button",{id:o,className:"btn text-black ".concat(i," ").concat(s," hover:bg-gray-400 rounded-md border border-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-700 focus:ring-opacity-70"),onClick:t,disabled:a,children:[(0,r.jsxs)("svg",{className:"mr-1 ",width:"22",height:"22",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M30 15C30 23.2843 23.2843 30 15 30C6.71573 30 0 23.2843 0 15C0 6.71573 6.71573 0 15 0C23.2843 0 30 6.71573 30 15ZM2.54503 15C2.54503 21.8787 8.12131 27.455 15 27.455C21.8787 27.455 27.455 21.8787 27.455 15C27.455 8.12131 21.8787 2.54503 15 2.54503C8.12131 2.54503 2.54503 8.12131 2.54503 15Z",fill:"#1E1E1E"}),(0,r.jsx)("path",{d:"M13.652 18.8864V18.7798C13.6638 17.6494 13.7822 16.7498 14.0071 16.081C14.232 15.4122 14.5516 14.8706 14.9659 14.4563C15.3802 14.042 15.8774 13.6603 16.4574 13.3111C16.8066 13.098 17.1203 12.8465 17.3984 12.5565C17.6766 12.2605 17.8956 11.9202 18.0554 11.5355C18.2211 11.1508 18.304 10.7247 18.304 10.2571C18.304 9.67708 18.1679 9.17401 17.8956 8.74787C17.6233 8.32173 17.2594 7.99325 16.8036 7.76243C16.3479 7.5316 15.8419 7.41619 15.2855 7.41619C14.8002 7.41619 14.3326 7.51681 13.8828 7.71804C13.433 7.91927 13.0572 8.23591 12.7553 8.66797C12.4535 9.10002 12.2789 9.66525 12.2315 10.3636H9.99432C10.0417 9.35748 10.3021 8.49633 10.7756 7.78018C11.255 7.06404 11.8853 6.51657 12.6665 6.13778C13.4537 5.759 14.3267 5.5696 15.2855 5.5696C16.3272 5.5696 17.2327 5.77675 18.0021 6.19105C18.7775 6.60535 19.3752 7.17353 19.7955 7.8956C20.2216 8.61766 20.4347 9.44034 20.4347 10.3636C20.4347 11.0147 20.334 11.6036 20.1328 12.1303C19.9375 12.6571 19.6534 13.1276 19.2805 13.5419C18.9136 13.9562 18.4697 14.3232 17.9489 14.6428C17.428 14.9683 17.0108 15.3116 16.6971 15.6726C16.3834 16.0277 16.1555 16.4509 16.0135 16.9421C15.8714 17.4334 15.7945 18.0459 15.7827 18.7798V18.8864H13.652ZM14.7884 24.142C14.3504 24.142 13.9746 23.9852 13.6609 23.6715C13.3472 23.3578 13.1903 22.982 13.1903 22.544C13.1903 22.1061 13.3472 21.7302 13.6609 21.4165C13.9746 21.1029 14.3504 20.946 14.7884 20.946C15.2263 20.946 15.6022 21.1029 15.9158 21.4165C16.2295 21.7302 16.3864 22.1061 16.3864 22.544C16.3864 22.834 16.3124 23.1004 16.1644 23.343C16.0224 23.5857 15.83 23.781 15.5874 23.929C15.3506 24.071 15.0843 24.142 14.7884 24.142Z",fill:"black"})]}),n]})})},W=function(){return(0,r.jsx)("div",{className:"my-7",children:(0,r.jsx)("a",{href:"https://github.com/shawnbanasick/ken-q-analysis/wiki/1.-DATA-INPUT",target:"_blank",rel:"noopener noreferrer",style:{targetNew:"tab"},children:(0,r.jsx)(V,{buttonText:"Help - Section 1",buttonId:"section1HelpButton",buttonColor:"bg-gray-100"})})})},z=function(){return y().showWarningBox?(0,r.jsx)("div",{className:"flex flex-col p-10  h-[120px] items-center  bg-red-500 hover:bg-red-700 rounded-md",children:(0,r.jsx)("p",{className:"text-5xl text-white w-[600px] text-center rounded-md",onClick:function(e){e.stopPropagation(),window.location.reload()},children:"RELOAD REQUIRED"})}):null},U=function(){return(0,r.jsxs)("div",{id:"section1Header",className:"m-8 w-10/12",children:[(0,r.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,r.jsx)("div",{className:"flex flex-row",children:(0,r.jsx)("p",{className:"text-6xl my-4",children:"1. Data Input"})}),(0,r.jsx)(W,{})]}),(0,r.jsx)(z,{})]})},K=n(4909);function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function X(e,t){if(e){if("string"===typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(e,t):void 0}}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||X(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Q=n(2007),Z=n.n(Q);function J(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function ee(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function te(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function ne(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}Object.create;var re=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function ie(e,t){var n=function(e){var t=e.name;if(t&&-1!==t.lastIndexOf(".")&&!e.type){var n=t.split(".").pop().toLowerCase(),r=re.get(n);r&&Object.defineProperty(e,"type",{value:r,writable:!1,configurable:!1,enumerable:!0})}return e}(e);if("string"!==typeof n.path){var r=e.webkitRelativePath;Object.defineProperty(n,"path",{value:"string"===typeof t?t:"string"===typeof r&&r.length>0?r:e.name,writable:!1,configurable:!1,enumerable:!0})}return n}var oe=[".DS_Store","Thumbs.db"];function ae(e){return"object"===typeof e&&null!==e}function se(e){return de(e.target.files).map((function(e){return ie(e)}))}function le(e){return J(this,void 0,void 0,(function(){return ee(this,(function(t){switch(t.label){case 0:return[4,Promise.all(e.map((function(e){return e.getFile()})))];case 1:return[2,t.sent().map((function(e){return ie(e)}))]}}))}))}function ue(e,t){return J(this,void 0,void 0,(function(){var n;return ee(this,(function(r){switch(r.label){case 0:return e.items?(n=de(e.items).filter((function(e){return"file"===e.kind})),"drop"!==t?[2,n]:[4,Promise.all(n.map(he))]):[3,2];case 1:return[2,ce(fe(r.sent()))];case 2:return[2,ce(de(e.files).map((function(e){return ie(e)})))]}}))}))}function ce(e){return e.filter((function(e){return-1===oe.indexOf(e.name)}))}function de(e){if(null===e)return[];for(var t=[],n=0;n<e.length;n++){var r=e[n];t.push(r)}return t}function he(e){if("function"!==typeof e.webkitGetAsEntry)return pe(e);var t=e.webkitGetAsEntry();return t&&t.isDirectory?ge(t):pe(e)}function fe(e){return e.reduce((function(e,t){return ne(ne([],te(e),!1),te(Array.isArray(t)?fe(t):[t]),!1)}),[])}function pe(e){var t=e.getAsFile();if(!t)return Promise.reject("".concat(e," is not a File"));var n=ie(t);return Promise.resolve(n)}function ve(e){return J(this,void 0,void 0,(function(){return ee(this,(function(t){return[2,e.isDirectory?ge(e):me(e)]}))}))}function ge(e){var t=e.createReader();return new Promise((function(e,n){var r=[];!function i(){var o=this;t.readEntries((function(t){return J(o,void 0,void 0,(function(){var o,a,s;return ee(this,(function(l){switch(l.label){case 0:if(t.length)return[3,5];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,Promise.all(r)];case 2:return o=l.sent(),e(o),[3,4];case 3:return a=l.sent(),n(a),[3,4];case 4:return[3,6];case 5:s=Promise.all(t.map(ve)),r.push(s),i(),l.label=6;case 6:return[2]}}))}))}),(function(e){n(e)}))}()}))}function me(e){return J(this,void 0,void 0,(function(){return ee(this,(function(t){return[2,new Promise((function(t,n){e.file((function(n){var r=ie(n,e.fullPath);t(r)}),(function(e){n(e)}))}))]}))}))}var ye=n(9998);function we(e){return function(e){if(Array.isArray(e))return xe(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ke(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){Se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}(e,t)||ke(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(e,t){if(e){if("string"===typeof e)return xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xe(e,t):void 0}}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Te="file-invalid-type",Re="file-too-large",Ae="file-too-small",_e="too-many-files",Oe=function(e){e=Array.isArray(e)&&1===e.length?e[0]:e;var t=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:Te,message:"File type must be ".concat(t)}},De=function(e){return{code:Re,message:"File is larger than ".concat(e," ").concat(1===e?"byte":"bytes")}},Ne=function(e){return{code:Ae,message:"File is smaller than ".concat(e," ").concat(1===e?"byte":"bytes")}},Pe={code:_e,message:"Too many files"};function Fe(e,t){var n="application/x-moz-file"===e.type||(0,ye.Z)(e,t);return[n,n?null:Oe(t)]}function Ie(e,t,n){if(Le(e.size))if(Le(t)&&Le(n)){if(e.size>n)return[!1,De(n)];if(e.size<t)return[!1,Ne(t)]}else{if(Le(t)&&e.size<t)return[!1,Ne(t)];if(Le(n)&&e.size>n)return[!1,De(n)]}return[!0,null]}function Le(e){return void 0!==e&&null!==e}function Me(e){return"function"===typeof e.isPropagationStopped?e.isPropagationStopped():"undefined"!==typeof e.cancelBubble&&e.cancelBubble}function Ge(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,(function(e){return"Files"===e||"application/x-moz-file"===e})):!!e.target&&!!e.target.files}function Be(e){e.preventDefault()}function je(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t.some((function(t){return!Me(e)&&t&&t.apply(void 0,[e].concat(r)),Me(e)}))}}function He(e){return"audio/*"===e||"video/*"===e||"image/*"===e||"text/*"===e||/\w+\/[-+.\w]+/g.test(e)}function Ve(e){return/^.*\.[\w]+$/.test(e)}var We=["children"],ze=["open"],Ue=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],Ke=["refKey","onChange","onClick"];function qe(e){return function(e){if(Array.isArray(e))return Qe(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ye(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}(e,t)||Ye(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ye(e,t){if(e){if("string"===typeof e)return Qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qe(e,t):void 0}}function Qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){$e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function et(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var tt=(0,e.forwardRef)((function(t,n){var r=t.children,i=it(et(t,We)),o=i.open,a=et(i,ze);return(0,e.useImperativeHandle)(n,(function(){return{open:o}}),[o]),e.createElement(e.Fragment,null,r(Je(Je({},a),{},{open:o})))}));tt.displayName="Dropzone";var nt={disabled:!1,getFilesFromEvent:function(e){return J(this,void 0,void 0,(function(){return ee(this,(function(t){return ae(e)&&function(e){return ae(e)}(e.dataTransfer)?[2,ue(e.dataTransfer,e.type)]:function(e){return ae(e)&&ae(e.target)}(e)?[2,se(e)]:Array.isArray(e)&&e.every((function(e){return"getFile"in e&&"function"===typeof e.getFile}))?[2,le(e)]:[2,[]]}))}))},maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};tt.defaultProps=nt,tt.propTypes={children:Z().func,accept:Z().objectOf(Z().arrayOf(Z().string)),multiple:Z().bool,preventDropOnDocument:Z().bool,noClick:Z().bool,noKeyboard:Z().bool,noDrag:Z().bool,noDragEventsBubbling:Z().bool,minSize:Z().number,maxSize:Z().number,maxFiles:Z().number,disabled:Z().bool,getFilesFromEvent:Z().func,onFileDialogCancel:Z().func,onFileDialogOpen:Z().func,useFsAccessApi:Z().bool,autoFocus:Z().bool,onDragEnter:Z().func,onDragLeave:Z().func,onDragOver:Z().func,onDrop:Z().func,onDropAccepted:Z().func,onDropRejected:Z().func,onError:Z().func,validator:Z().func};var rt={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function it(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Je(Je({},nt),t),r=n.accept,i=n.disabled,o=n.getFilesFromEvent,a=n.maxSize,s=n.minSize,l=n.multiple,u=n.maxFiles,c=n.onDragEnter,d=n.onDragLeave,h=n.onDragOver,f=n.onDrop,p=n.onDropAccepted,v=n.onDropRejected,g=n.onFileDialogCancel,m=n.onFileDialogOpen,y=n.useFsAccessApi,w=n.autoFocus,b=n.preventDropOnDocument,C=n.noClick,S=n.noKeyboard,E=n.noDrag,k=n.noDragEventsBubbling,x=n.onError,T=n.validator,R=(0,e.useMemo)((function(){return function(e){if(Le(e))return Object.entries(e).reduce((function(e,t){var n=Ee(t,2),r=n[0],i=n[1];return[].concat(we(e),[r],we(i))}),[]).filter((function(e){return He(e)||Ve(e)})).join(",")}(r)}),[r]),A=(0,e.useMemo)((function(){return function(e){return Le(e)?[{accept:Object.entries(e).filter((function(e){var t=Ee(e,2),n=t[0],r=t[1],i=!0;return He(n)||(console.warn('Skipped "'.concat(n,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),i=!1),Array.isArray(r)&&r.every(Ve)||(console.warn('Skipped "'.concat(n,'" because an invalid file extension was provided.')),i=!1),i})).reduce((function(e,t){var n=Ee(t,2),r=n[0],i=n[1];return Ce(Ce({},e),{},Se({},r,i))}),{})}]:e}(r)}),[r]),_=(0,e.useMemo)((function(){return"function"===typeof m?m:at}),[m]),O=(0,e.useMemo)((function(){return"function"===typeof g?g:at}),[g]),D=(0,e.useRef)(null),N=(0,e.useRef)(null),P=Xe((0,e.useReducer)(ot,rt),2),F=P[0],I=P[1],L=F.isFocused,M=F.isFileDialogActive,G=(0,e.useRef)("undefined"!==typeof window&&window.isSecureContext&&y&&"showOpenFilePicker"in window),B=function(){!G.current&&M&&setTimeout((function(){N.current&&(N.current.files.length||(I({type:"closeDialog"}),O()))}),300)};(0,e.useEffect)((function(){return window.addEventListener("focus",B,!1),function(){window.removeEventListener("focus",B,!1)}}),[N,M,O,G]);var j=(0,e.useRef)([]),H=function(e){D.current&&D.current.contains(e.target)||(e.preventDefault(),j.current=[])};(0,e.useEffect)((function(){return b&&(document.addEventListener("dragover",Be,!1),document.addEventListener("drop",H,!1)),function(){b&&(document.removeEventListener("dragover",Be),document.removeEventListener("drop",H))}}),[D,b]),(0,e.useEffect)((function(){return!i&&w&&D.current&&D.current.focus(),function(){}}),[D,w,i]);var V=(0,e.useCallback)((function(e){x?x(e):console.error(e)}),[x]),W=(0,e.useCallback)((function(e){e.preventDefault(),e.persist(),ne(e),j.current=[].concat(qe(j.current),[e.target]),Ge(e)&&Promise.resolve(o(e)).then((function(t){if(!Me(e)||k){var n=t.length,r=n>0&&function(e){var t=e.files,n=e.accept,r=e.minSize,i=e.maxSize,o=e.multiple,a=e.maxFiles,s=e.validator;return!(!o&&t.length>1||o&&a>=1&&t.length>a)&&t.every((function(e){var t=Ee(Fe(e,n),1)[0],o=Ee(Ie(e,r,i),1)[0],a=s?s(e):null;return t&&o&&!a}))}({files:t,accept:R,minSize:s,maxSize:a,multiple:l,maxFiles:u,validator:T});I({isDragAccept:r,isDragReject:n>0&&!r,isDragActive:!0,type:"setDraggedFiles"}),c&&c(e)}})).catch((function(e){return V(e)}))}),[o,c,V,k,R,s,a,l,u,T]),z=(0,e.useCallback)((function(e){e.preventDefault(),e.persist(),ne(e);var t=Ge(e);if(t&&e.dataTransfer)try{e.dataTransfer.dropEffect="copy"}catch(n){}return t&&h&&h(e),!1}),[h,k]),U=(0,e.useCallback)((function(e){e.preventDefault(),e.persist(),ne(e);var t=j.current.filter((function(e){return D.current&&D.current.contains(e)})),n=t.indexOf(e.target);-1!==n&&t.splice(n,1),j.current=t,t.length>0||(I({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Ge(e)&&d&&d(e))}),[D,d,k]),K=(0,e.useCallback)((function(e,t){var n=[],r=[];e.forEach((function(e){var t=Xe(Fe(e,R),2),i=t[0],o=t[1],l=Xe(Ie(e,s,a),2),u=l[0],c=l[1],d=T?T(e):null;if(i&&u&&!d)n.push(e);else{var h=[o,c];d&&(h=h.concat(d)),r.push({file:e,errors:h.filter((function(e){return e}))})}})),(!l&&n.length>1||l&&u>=1&&n.length>u)&&(n.forEach((function(e){r.push({file:e,errors:[Pe]})})),n.splice(0)),I({acceptedFiles:n,fileRejections:r,type:"setFiles"}),f&&f(n,r,t),r.length>0&&v&&v(r,t),n.length>0&&p&&p(n,t)}),[I,l,R,s,a,u,f,p,v,T]),q=(0,e.useCallback)((function(e){e.preventDefault(),e.persist(),ne(e),j.current=[],Ge(e)&&Promise.resolve(o(e)).then((function(t){Me(e)&&!k||K(t,e)})).catch((function(e){return V(e)})),I({type:"reset"})}),[o,K,V,k]),X=(0,e.useCallback)((function(){if(G.current){I({type:"openDialog"}),_();var e={multiple:l,types:A};window.showOpenFilePicker(e).then((function(e){return o(e)})).then((function(e){K(e,null),I({type:"closeDialog"})})).catch((function(e){!function(e){return e instanceof DOMException&&("AbortError"===e.name||e.code===e.ABORT_ERR)}(e)?!function(e){return e instanceof DOMException&&("SecurityError"===e.name||e.code===e.SECURITY_ERR)}(e)?V(e):(G.current=!1,N.current?(N.current.value=null,N.current.click()):V(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):(O(e),I({type:"closeDialog"}))}))}else N.current&&(I({type:"openDialog"}),_(),N.current.value=null,N.current.click())}),[I,_,O,y,K,V,A,l]),Y=(0,e.useCallback)((function(e){D.current&&D.current.isEqualNode(e.target)&&(" "!==e.key&&"Enter"!==e.key&&32!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),X()))}),[D,X]),Q=(0,e.useCallback)((function(){I({type:"focus"})}),[]),Z=(0,e.useCallback)((function(){I({type:"blur"})}),[]),J=(0,e.useCallback)((function(){C||(!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return function(e){return-1!==e.indexOf("MSIE")||-1!==e.indexOf("Trident/")}(e)||function(e){return-1!==e.indexOf("Edge/")}(e)}()?X():setTimeout(X,0))}),[C,X]),$=function(e){return i?null:e},ee=function(e){return S?null:$(e)},te=function(e){return E?null:$(e)},ne=function(e){k&&e.stopPropagation()},re=(0,e.useMemo)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.refKey,n=void 0===t?"ref":t,r=e.role,o=e.onKeyDown,a=e.onFocus,s=e.onBlur,l=e.onClick,u=e.onDragEnter,c=e.onDragOver,d=e.onDragLeave,h=e.onDrop,f=et(e,Ue);return Je(Je($e({onKeyDown:ee(je(o,Y)),onFocus:ee(je(a,Q)),onBlur:ee(je(s,Z)),onClick:$(je(l,J)),onDragEnter:te(je(u,W)),onDragOver:te(je(c,z)),onDragLeave:te(je(d,U)),onDrop:te(je(h,q)),role:"string"===typeof r&&""!==r?r:"presentation"},n,D),i||S?{}:{tabIndex:0}),f)}}),[D,Y,Q,Z,J,W,z,U,q,S,E,i]),ie=(0,e.useCallback)((function(e){e.stopPropagation()}),[]),oe=(0,e.useMemo)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.refKey,n=void 0===t?"ref":t,r=e.onChange,i=e.onClick,o=et(e,Ke);return Je(Je({},$e({accept:R,multiple:l,type:"file",style:{display:"none"},onChange:$(je(r,q)),onClick:$(je(i,ie)),tabIndex:-1},n,N)),o)}}),[N,r,l,q,i]);return Je(Je({},F),{},{isFocused:L&&!i,getRootProps:re,getInputProps:oe,rootRef:D,inputRef:N,open:$(X)})}function ot(e,t){switch(t.type){case"focus":return Je(Je({},e),{},{isFocused:!0});case"blur":return Je(Je({},e),{},{isFocused:!1});case"openDialog":return Je(Je({},rt),{},{isFileDialogActive:!0});case"closeDialog":return Je(Je({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return Je(Je({},e),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return Je(Je({},e),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"reset":return Je({},rt);default:return e}}function at(){}var st=g((function(e){return{excelErrorMessage1:"",setExcelErrorMessage1:function(t){return e((function(e){return d(d({},e),{},{excelErrorMessage1:t})}))},showExcelErrorModal:!1,setShowExcelErrorModal:function(t){return e((function(e){return d(d({},e),{},{showExcelErrorModal:t})}))},csvErrorMessage:"",setCsvErrorMessage:function(t){return e((function(e){return d(d({},e),{},{csvErrorMessage:t})}))},showCsvErrorModal:!1,setShowCsvErrorModal:function(t){return e((function(e){return d(d({},e),{},{showCsvErrorModal:t})}))}}})),lt=st,ut=function(t){var n=y(),i=n.isDataLoaded,o=n.sortsAreLoaded,a=n.setStatements,s=n.setStatementNumArray,l=n.setNumStatements,u=n.setHasImportedStatements,c=n.setIsDataLoaded,h=n.setShowInputErrorModal,f=n.setStatementsAreLoaded,p=lt(),v=p.setExcelErrorMessage1,g=p.setShowExcelErrorModal,m=(0,e.useCallback)((function(e){e.forEach((function(e){if(i)h({showModal:!0,titleText:"Data Loading Error",bodyText:"Data are already loaded.",bodyText2:"Reload the webpage to start a new project."});else{var n,r=[],d=new FileReader;d.onabort=function(){console.log("file reading was aborted"),v("The file reader aborted the load process!"),g(!0)},d.onerror=function(){console.log("file reading has failed"),v("The file reader encountered an error!"),g(!0)},d.onload=function(e){try{var i=d.result.split(/[\r\n]+/g).filter((function(e){return 0===e||e}));n=i.map((function(e){return e.trim()}));for(var h=0;h<n.length;h++)r.push(h+1);if(n.length<1)throw new Error("Can't find any statements in the file!")}catch(p){console.log(p.message)}a(n),s(r),l(n.length),u(!0),t.updateColor(),f(!0),o&&c(!0)},d.readAsText(e)}}))}),[i,o,a,v,g,l,s,u,c,h,f,t]),w=it({onDrop:m}),b=w.getRootProps,C=w.getInputProps;return(0,r.jsxs)("div",d(d({className:"flex justify-center pt-5 items-center"},b()),{},{children:[(0,r.jsx)("input",d({className:""},C())),(0,r.jsx)("p",{children:"Drag and drop STA file here, or click to select"})]}))},ct=function(){var t=Y((0,e.useState)("bg-gray-300 hover:bg-gray-400"),2),n=t[0],i=t[1];return(0,r.jsx)("div",{className:"w-[300px] mr-4",children:(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"flex flex-col justify-center  items-center rounded-md bg-white h-[500px] w-[300px]",children:[(0,r.jsx)("h6",{className:"text-[22px] font-bold tracking-tight text-gray-900",children:"1. Load Statements STA file"}),(0,r.jsx)("p",{className:"font-normal text-gray-700 dark:text-gray-400",children:"One statement per line"}),(0,r.jsx)("div",{children:(0,r.jsx)("img",{alt:"statements",className:"h-[175px] w-[250px] m-6 border-2 border-black",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWkAAADnCAMAAADraFdgAAAC/VBMVEX///8AAAD///P/+M5cAABPkc3y//////efTwD5///SmFyRze8AQZgAAE9BAAD//+3u///N8//z0phPAAAuLi7Vn1wAAEEAAC6YTwAuAAD/88sAAGDu7u///uQuickAT5dcm9LV9/+75vsAQZHI8v+rZQCYQQCHye6l2Pb/7sjk5eKf0/L08vDp//9BicgAT5/XpGbC7/9PmNAuLkF5TwAAAHlBLi7/89gAXKf41p/Mj0+Y0vPS1NGxs7EuLgCRQQD0zpEALi7m4NxvrdxPi7/c+/+CaVLZyLT6362NLgChn5+RlJj/+t6Qj5BvQQCCQQCv2fP79ODY19v03btmT0BnAABBkc3TtaFBQUHg//9EXXDy9vrc3+V5uOXTwa+Ynp2syN6+ztKOlaGul5HZq26ZvtjP4ubJx8cudrfq+v9okbaYmJjTmE+IAAD17ujJ0tfZtY6rpI6w4PvH5PKvy+VgotjvyYmpjnC9eS7z6+FBiMK4pZVBT2b/6rv+5bfgvojMsJn3+fr79+5eY2nU7fafzOnX3OBmn84ALo5BUVaCLgDu9/f/+eng2tqhtbcuZomgXAB5AADd7vvN6vvm8vqrzerjzbC+pYPgsHK+hEiJQQDk7e7RzsPqwony6td1pdX75cgAZq3Zv6JPfZhwhpeplIQALoK9jGbGjEHq7vfg3+CJutz87tjmuX91XE+ycS7f0cuRm7FjjKcAT4YAL2Xf4ery38KfpqwAAHCmbS65t7CgmJdPQUGakZEALnixq7gAcLGXXS7Mzc1cjLursbEAXJ4AQYi3lHNiOzvA1+tccpNxcWqKwuqpws2bqsHqx5JDQSmJXACnTwBwLgDc5vKCwOl5oMLgwpjy5dwuYphDb5FweZCjeE13t+C3wsiRt8LyzZjIt5hBQVEogsBtm7pweU9BLkHNiS7S1+VPXFxgfIixf0G3yOUALk9cT0GfZgCJqcFBgLyOq6QXQXC3cAAAAIJceHpcXlq/wbexq5suQUG0z+rv4dHIoW0ALgBmS6t4AAAgDklEQVR42uxdZ3gUVRSdG3XHNSYbE0jcQEjUgFiCKIoUIxgkQgApiiIWFJUiKFIiKIIFLFgRFUSx94piBcGOXSzYe+9dsf/wld3c73o2z+/p9y27fHt+4Lyd++67e3bmzZuZ40mQLTjqphuD7EOzVc9vaJgSKPS/dsDkwKJCb6595LWjNkHWoZmqw/k7ElEHvVleSI2BRVeiLYO0oCVtF3HVvEGQGcA6PavuP5AU7J6dhzZFFBNtE6QFG9HGRc3uDK8fdnmQGcA6PasuL6HSH1dbhvM2pTHRwOAiKtgkSAPMsRINsgD/u86dn/y+KNzQMh0upI0jwbFb3x0NxtN1NfqTE/fu1Hn4wak6Xja9fvmwD695Ktk+a8G3nYYNXzUWWjJLxaEjRz2xvPPxh5sd+/YbsSeVjhw3rt/5MrvdO6Kh4f4pZjt26Mjfn+z08WX1LX7aXGSxuGLFHUXzb/t0zluTzXk6tfMXnZ+ebIcbYCvceYUagmvBnFjn7H33fqHTq5FUdQ6+9slOc2bdMTtwVG2zyJ15mmmNjRS/sSOpbHvFeWVElTeQDHaP4lzUlywS50mfEttsgy3OYq8F3FJjJYBXBbPXXkG4m8ZO+8ksGj2p9JOmAfdKDH6zJn0oXRm1Jym1F7VAzmbqfChFnTPj/PUcVessyHSi4ILq8pLdKF/NI/uoTj2Izj3koD2JDkzBdNk17+4yXdUzSTe3UhtvHrJoKrWBlsyy3vpEdx18lSIjPwjCPR5b9iIVnFNb++C8ABAedO/EQl2Z7fbGb6rrxwuobJLMYi8rClfXXluoBqw4T21OWEBUpo/Ubuor2YlxiyJRC+RMUedzHxSqXVBnOI1oyYRFE0sE01C1ydIM012pdPuuRFQVu1ivQo4hOk1Ttan6zSHh7WPNr1tIOwTmC1Evcxp/DS2RRX+DVuoKMKMwcay557/wJWa6uzrlTq+pOIPyMUux4vUUPWm9HASXEu2uNp8nOk6fXZa4GXFq/GctMifW+cBmvAYTdcba0RjD242Oqt1Mr1dC3Q8joi5qIz8I26rDYtvWrc88jAq2T5XwqNatB19sulacx1dm2ZJZ9Nj2p5lGrTZLXtMdq7wNmel8FVoZUZ/kY5Zi0m2L8bbaWA9TRKwvdVEMdaTSzf9Zi8yJdfbS4w61iblOe4JU9g4AULWDafXjnjKNflx/Td36qjCVsAnt8VI6NU4GVWYFwytI2ZJZEpQpdFRntR/T7XUoM81ZLNODkn1uUFE28eM1geF4e0W74VvWInNind1tAVXAdPgzEX15zoTIf2TabizZsXRUj4KJapGnW7RbC41dy5hpZlPv3ZVUV/7mGrIls/C+nmoEL6bVbFGcYAWzFKvJhE/tJNMF1Xbe6GXmEKhF5ExdJxfAdfK1s2DQf2PaTrDDC6+rWUiz4lsU6Y/Vv80uL+mIC2xXO+008j7R4iw84Src6st0AbOCWYrVf3m2qozYCu/bzKbYLrqR2c+1YE65z8W0vUpNvI2IWvX+z0x3JKIxqn6iLpHk9VqC54QuUZMqeUyP4Z2iZbKIfe+Y35Rnj0pfpiELM20S7qQJCBcnEl9E6iw1izWuBXPKfcg01jn4baLunkyHGyan/WIifa7FyYS2bLolj8KqsZ1l+iIbGbbVVxyNk6Alsqix1SFmrghb1AQK5h7Jk2nIIpjuaJcL5SW6QrsxJ64/krVATrEPmcY6exLl+zB91ujRi1bTG4+MnhC1S/L2erlP79hlcenh0eDkPXbcB7JN03cG4dGkmbajFkyJhpd91wZaIotZpz4aiX1F1NhEzBGXtG4dDQDhtvsP7kvHnbTttlFkmrMIps14egK95WKiZ5PTCdkliqxF5oQ6mWmoM+/hJaOiwS0Pq+PJXbVkuiclUFqtZ1hVk67N/lonUAIdIGFXfUGME1HyRp4jRUtmsRxpqFO8iRiN/ADQjZLYRx2YlpUidZLnY5ZiPYvwJcRiZZFtX0pEH+kNWYvMCXWWmM/Urg2gzrx2RNSCSC3mnVXrLIIyA/uzx8z0y0uwvXYkjeMvxIyv6ZHL3luaXAWpGzaFb07BFmexTP+i992pRrO4p35XgieHzJhGlVrXmnVCl0jeXOqOWbry2kPhaHMEPJogWvVNpJe1yJxYp+mjdlVBneH1cdI4YmzgrBrmaSeOHbL1Afunno3O3vqASMAI606tuyQKLZHFrhrybqq7O/gfwCxY2pALnN/Icx/etG1dd2okyGjo+S9TsqzbyDGdLpQX0paZkmXdRsX0EbMzJUsOOeSQQ9bj9Ud22WWXz6OilRUvsgFh3ZCxwdpHUsOUeAs9YEDyRfVnpHB60T9a2Yj1MmCxwhomiz6q1Zi8rZ31TJwqI6KVmXdGqDDCBbh/P4z0B2qYOCOpnNy0D8C5lZlMo8IImfbvh5H+QA2TRkIzoN+8aeArkY0ylWm3wsg+mnP0S6+GyWJGXL2xpQM9mPZQAwFEZN70fqvMl7mq38h5qFPiSKmSkgojjLynvsWwpxcNBaahH2ufnJFSM6Wva1OChFzqT+zXzDsCK8ib3Y6ujHow7aEGAojIG6xMpA+pNymgU+JIqZKSCiOMfJ4sgGnox9ond6TUTFUcqVYJ9jN6B/s1y3Q4lyqj3dSzag+mPdRAEiLSiFp0TP/zqKBaqp0gUqikhMJIRtp3+K/e/jAyDf2E9skZKTVTh1kFRLhYsYb9kGmetqt0nnwfpv3UQAxQSZWvT2tqppnRpU4JIlklBbOoiNQ8vGIe6P/LPC20T85IqZkylHUwzKXsh0zzcO21jvojH6b91EAMVEm9zwshqVOSkaySwsJkpCpoTY2hhpmGfqh9ckUKzZQ9mO/rbd5dD/JgOpxmDoTF6l8Ppj3VQAwZaQcgqtRfVOqUZCSrpLAwGalHHRM1ydxMo/bJzbShlRvPBjGQbDiYtiLY0nNqfxuoivRg2lMNxECVVDkLfIVOKUVO5AFz6laH4N+YRu2TK1JqpqzGrkt0ppZKeTBdTBZ8crCgBFv+aiAJVEmFXxHRA71B7cSRqJJCpjnSg2mhfXJEgurBSP+qx4tPEKgWozm/KsT1OssOwFdUaPmrgSRkpGVVY0wU1E4ciSopPgQwZ6ydbc2MC6axH2qfMBKYZoXJxwO5IABomMx5YH+4bk1Lnff5hpFbEl5qIAkZqcRTihe7rJA6JREJKilWGGHOG2xgSwKmuR9qnxyRkmnW7rByDIEapj7JWaPYflt7G3HnKPV/vkCL4asGYshItZLWtFT0VatqqXaSkaiZYoURRHYlenx28BoB09iPtU+uSGDaVuPSvKGGiQ8HtSTbLsK/l94HLYanGoghI8PF9mZjZqE6j0GnxJGokmKFEUSqpBrINPZj7ZMrkjVTjIrVxAsrBGqYwqXmYmDq01sGsSfixFdabjE81EAAjjSV/BBNzNaNoFPiSFRJscIII/OuJ4UvS+Dshn6sfXJGsmaK8ZKebdMIVAP5R6JOCSJRJeXOeeypdSBocmmfPMDrvJWZ+YxzXVPPmFv+7EW2MH3FgHrzCDN7kS06pWPITN9ZjGzRKd1yf8OqeUEOOeSQwzoMcC1y6amgHzeHnH32vyUK16aS/6+Jtw3rPOf7scn5feryP4bNumOUR4Y0eC2Bggr6xd4mhTYZvJ5pSRalgwJ+k0xpcKzx8lpiBRX24+/xR/y0DF6jdyMafu/ve5J6zmHVHnT1u8vq9UOkNMDTa4kVVNyPaV85NrPvhm5dMk8XupRMCS0Tjwz7P9g7yDw4FFThhtSYHfedxeaxX9hWSKIqpo8830iC+v3p4bUEPkUerkWsdnIxjf3GrSihu0aMWzEFagGmD1+wvPOHWhcF6iOnzxTD7QLFo9vEqZ6d9jJM37cfXD/UmdnBw2sJfIo8XItY7eRgGvvFKYGPoBZgWsM8ngX1kdNniuFygRKjmxfgqd4odLcigHMnp3oD6OG1JHyKPF2LUO2ETGO/2LLaZavp8dra2qegFmS6ldFFvRKA+sjhMyXgdIGSo3cDpmfGlQApefiV/bLqAmDax2uJfYo8XYtQ7YRMy35o5+Bwj2JdVAmtjID6yOEzJeB0gZKj96FAov8ZyadR81kFKJj28FpinyJf1yJUOyHT2I8bWAtyZMMWUkG1VB+5fKYkHC5QMHqsr+wZm0vUK1nyHlNfIIVnJdM+XkvsU+TlWoRqJ3+msZbUa49L1Q0DqI8cPlMCDhcoGL2j/KpLjfZPurFsFxFMe3ktsU+Rl2uRHM+faaylWaaPUUyD+sjhMyXgcIGC0WeIk2Sh1bIw7DWiKWOsh4/XEvoUcet/M13pZJprcXkosIqA1UdunykJhwsUjp4n7xLpygiMU1BtMxpSPbyWwKcIWt5Mo4LKPXu4me7F2jtWH7l9piRcLlBydFzfvdFE9F+TbfxcI7Iot8dtTy+vJfQpwpY/06ygcjMNtQBH+rRQFpdr9gP1kcNnSsDhAoWjSyXcc6M1Zhtt1dMTzjzpr7eN8Y1R5w8K9irx8loCnyIf1yI306ygkv1EH1kLckS7R2ILiapAfeTwmRJwu0Dh6Ggb1MYwbZFgZTwpeHotgU+Rh2uRQ+0kFVSyn+jjcI8yI1hY3RCrj5w+UxIOFyjn6B3ZNsjodExyevN8ew595e+1BD5FHq5FDrWTVFDJfrZPI+qiUnF0jabpzk1QfeT2mWI4XKBgdBdCpfhhHU/w+gE3Ffl4LaFPEbfSAKwFwbooUB+hz5S3CxSPngOoj9ZZzU/mIKE+yjHdHNa6+ihb1FWZA6M+WofVVTnkkEMO2QOjb8qAv1aX9GEK901s3NPQsCo7/ZYAqG9K/1+rQx+mvB5kXieGbc3ThWyCwyUJ9E2goEq3D5N9YVA2SZs/GLlYNsHhkgT6JlBQpdOHiZmmKv0kNeuYli5JqG/KsL8lp5huoaaPsK1h2stPiRVNoP9Jsw8TA/VNXJlUQoEWycOHSVbGI7h8mOwfzqFJ5SWt6hXTXn5KrGgC/U+6fZgYqG/iykAJJbRIHj5MojIxgunXLNNVf7N3Ji87hWEYR4YkkTEppRSKDEVmC7OQQoYSyrSwkSg2pghFsjAsLNiwIVNZGFMUFjYsDFngDyALQ4jnEZfbj+t4yHzuhfG8132f63ud9/We33fd7Ruu3N9w6evkdEGeUiCaAv/zq3OYVOCbMFkgoQKLVJDDFCeLHZTDRKf7j294anrD7u2T0wV5SoFoCvzPL81h8lEPmEwkFNKVUOrgqCV2+KrTTVptS99BnrcnVecpgWgi//MLc5gcJMXJ8JdikTxs4qgldDBOJwjyQIPkdHWeEokm8j+/MofJO83J6DSxMXZw1BI6GKfT69Gt7PS35ynJFfI/vy6HyTvNyei0WCTntKOW0ME53Wz75qbZ6eo8JRBN5H9+aQ6Td5qT0emW3+C0oZbQwTqdKjtdnacEoon8z6/OYfJOa7Jip9XBUUvswBdnOl2QpxSIpsD//OocJu+0Jit2Wh0MtRQ7mBym6HRBnlIgmgL/86tzmJzTmCyQUN5pdXDUUuxgcpgEAi1L/2JL8pRENIH/+bU5TCx1jpOBhBKLVJbDpMliB5PDJHho4bvfFeUpiWgC//Prc5hU4Js0GQgqsUgFOUycTB1+Vp6SiCbxP784h8lX6WTlLqnD3xXKVPMrX6na6b+2alKoov67HKa66qqrrn+s/s6NdH5qz0WRYcp3eScvavCT6q/eSOen9lwUGaZ8zM8z4adupCNv9NOnZj9yUWSY9K3AP8+En7qRjrzRz5+a/chFkWGS0+UmlBvhm/wBvJGburwfGSY6re1qk84kfOdDbNEKkTvgfwzfhJlF/JTkN5GL0pyeaPKZSVffO3IuPVCawWnkU6GfuCjzUTmc1na19H/juVrs1x1MkagexzdpZqQdFeQ3gYvSnJ5o8plJmSvJt0t6RE1NjXyq2I9c1LRvcDpuV0ukzpqPOEzLbkg7Av9DvglOB+KnIL8pclFxTk80+cyklt10XzBoamrcUUU/cVF5skqnuV1tSBqgWa/16VdXeiPtSFSP45s0M5migvymwEWFOf1102cmJcPzv9iV0DROo5+4qKRS6TS3q+1PtxkOv3sT+O6YNSB3AtVzbNiHunQz8kaamUxRQX5T4KLinP7Fy2cm5ZutfdO9TGgap9lPf7Gs0mluV0t8XI9WE9506PfugnYL5I6oHl1EU3URbxSdJlNUkN8UuKg4p3Ha00fZ437J2uQ3NcudTiqVTnO7WqIBRr1zu+Gt8enSBfooUz26iCquIs9Fp8kUFeQ3hXONc3qnfWZSCmTK1xBofo/TWaXSaW5XSy9QD9c2fJl+GDA7kDtkJcA3EVIB8ePym6zTcc5qp0kf6fd9mmf+ApphauVTeaezSrXT3K52pOHJsR0XbHs6NjFGoI/gNHgj5CmR+KnOb6LTmNMRTT4zaW/DDotH5jeO1NTUMZ+K/eKTnQyTvqy5Eber5eX653snzmIU6CPjNHgj5SmB+KnOb6LTmNMQTTYzKQts7ZSlqKmpYz6V+sHprPJlhikf0/n+kly74na1/Na+4ZMG+9PLB8gd4zR4I+UpBeLH5TdZp8Ocjmhy9JHSh9ITl5qaGvlUoV/gopLKlxmm8HLcJWxXy3OkL3PPtmkWMEWG/wFvpDylQPwU5DdFLirO6Ykmn5m0/0PcLzU1NfKp1I9cVPsvM0wZ9/lQK7FdrW/DzhmvHdSc5I6oHsc3MU9JxE9BfhO4KM1piSZPH+X353qQNDE18qnUD1wUq3y7WjnfZJgik99UPGc5fVSgqXyqv+1mRl111VVXXXXVVVddv6/8Nrcf3xD3R3BRRuX7z48M08fb3qlOLy7a5vbjG+L+CC7KqHz/+X3GMHFL0O2uBdvcPMfDouYfwUUZle8/PzBMyo/vcP369Pxt8gXb3CzHw6Lmn8JFlXNK5TlMYSfMtMb4+L2M4/FFzT+Fi5LKz81h0s2PI+kjQMPxBFbHcDwuo4ma/A7AdrOuLV43L/fXLEbFsE+eYTJ0lT8/sk/SZDWC04PTldtwPIHVcRyPz2jyTt+QZpjFqBj2yTNMhq6y5wf2CZrW6fyoW4bjiayO4XhsRhM0uSXo0bB7+RP2MItRMeyTZ5gcXeXOD+wTNOF0uE7vftegh+F4wOoYjsdkNHmnF+athc3yNtIwi1Fx7JNnmAxdZc8vsk/QdE53fPYsrTgb1NRwPHico0tMRhMeGAUG9E4XsuQ0ZjEqhn0yDJOhq+z5BfYJmtbp93VnjOF4Spz2GU3e6aWKFQmzGBXDPnmGydBV9vwC+wRN6/T506cnXrgJhul7nfYZTd7p/pkhTs/pOItRMeyTZ5gsXeWdFvtETX+dzmU4ngKnfUYTNaPAE32h4ixeheyTZ5g8XWWcBvsETee0vDMcD7sZjsdlNFHz0yPzwtfx+TkdZ/EqZJ88w+TpKsMpkX2iJhkmOG04HnQzHI/LaKJmPOt8W39fcjrOYlQM+2QZJkdX+fMT+wRNFRkmOe05nsjqOI7HZDRBM1S6/HWYv+F1ej+NWYyKYZ8Mw2TpKnd+YJ+kaXKYBPWB47Hb3BzHYzKaqMnla9LULFbFsE+GYfJ0lTs/sU/QNDlM6Tkt8sZxPGB1DMdjMpqiJiod+nT4jIYtMItRMeyTYZgsXeXOT+wTNW2Vs0E/M6Op2fr16bnUArN4FbJP5QwTO7D+mV1yq3flf6npk466fmodbnhnx/N3294u/m3BCX9dvV/1mj7EqOvn1oZxZyZfvzu/fkbXVVdddZl3wU3/FJXSfp430pG/kJJ6tfzorIFbH+f/UM2crDreOqcr/H1ZjupH3ohH/mxKih9tdJia79OoOvbLHw3/QfmkoogK+4k34pE/kZJiJMSc0y+m5P39zQ5tfFcjGnZMP10b86c5LYqosJ94Ix756yipIyd2pa/6+zvQ8Sbwn+a0Bivq54/85elRbcK9z9YfJ9l0kGlHIIUcuZNVFu05O/DBopjtBKYI6Up2m5tUVJxavBG4KBwZSpvsHN8ERgtOsAYnJoPpCl9OOwIp5MgdqTyBSmCKzNY5UERBRYWpxRuBi8KRTHqq5pvIaNEJfuo+FIom7SiQQiB3cOad8064W1AJTFHo57a5UUUFFfFG4KJMv7DJzvBNkdFyTghl29IbiibtKJBCjtzRTri2DS83DSpgikI/c52migoq4o3ARZl+cZOd55vEaMEJ1KRtumcgRZN2FEghS+7o3uS+dF8pqogpYj8VBoOKCiq6uwouyvSLm+ws3yRGi06gWu3UVVqKLu0okEKW3NEr/P50rzSoiClCP+s0VFRQkdPgoky/uMnO8U2R0fJO5Ld4o3lCPu1IpJAndzTzquR0UBFThH7WaaiwH7aYgYsy/bDJzvBNOpJcFOM38k4x7zQookAKkdzhcyzf/4dK+tNip6lS7TS4KNMPm+wM3xQYLTiB/yUeeNveuYPuGIZh3FmRMzmUCGEhQk4LQohIUYwoFIOBUCwOg9HikGRwGhSxKJOBLAyEDDaTkRRZPI53dz9+PJ7I4X9PeD/P9d4XPn/f+3NdPbCQpx0lUgjkDt834/dfOqXS6RBOp1Q4HVyUOY0mO+GbyGiFE/z67kncrTgNoilIoUzu8J7f29HvZOdX63CKOC1tbjjl+06DixI9NNkJ35QZLTqRGwnvbn4/B9XpTBElUgjkDr8yXdijX9luNE4Rp6XNDaeI04k3Ci7KnUaTnfJNwWiJE4HjIElX044SKQRyB5lJH6a8peKUYIqg521ucYplNJE3Ci5K9dBkZ3xTMFrqxBTEBg2JBD5JOwpSCOQO7/ns+9u+NgBcVDBF0JM2N5wiGU3gjYKLMj002RnfFIyWOdFANGVSyMmd6IRr5aIaTgEXhbEmO/JNYLT+WobJpp2L6uhXq5gmLqrD6Ypp4aL+tKef/9x85qI6muw6pmM6pmNkGgij9nQlV+BLVm9t0yfDhBymXzzthFE9fVSv0JUvaWeYkMP0m4ZpTu1f0ZI+qlWQl7QzTMhh+j3DNKf2JUkfQaHB6WaGCTlMDdPMKdUv6fRRhQI+GMS0MkzIYZK+ODBMwRQJi4RGOklzEsJIeu0ko6lCIWinU2uKEXQidleXyt19lWFCDpP0xSWGKTNFwiKhkU7SnIQwkl47yWhSBUmB6g0yKe1uLpWMpq8yTMhhkr64xDAlpsjYIDTSSZqTnCK9dprR5ApMgXp05eZHp5NC3t1dmtP5qwwTcpisLy4YJjBFxgblRjpJc5JTtNdOMppcgSlQDz82VPQGmZR2V5eWFKfJMCGHSfrigmEiU2RsUG6kszwWO8V67SSjSRUYefJq0seVe4NMSrurS/2WfoVhQg6T9sUFwwSmyNig3EhnTtsp1msnGU2mYClQcCLtLi6VmUKGiTlM1heXGCYwRfLMOTXSmdN2ivXaSUaTKtDpyfGSrJB3d5f2kWFiDpP1xSWGCUyRbJAa6X7Waem1k6SnBqdDgbu7S13IMDEdyPriEsMEpkg2SI10nubkp7DXzpOeKhX6jS9nfvxSoXdyAru7S2SY6PSP9cXNY0qSbZAa6STNyX2QXjtJeqpTuPgRGRoCRgu7i0vCMCWnpS8ODFMwRbYBGukkzUlOkV47y2hyBf5T7vbBTo8jBSoU0u7ikjBMKYfJ+uLIMAVTZGwQGukkzanilLhPT3qqUrgc/0ZMCthdXBKGKeUwSV8cGKZgioQNQiOdpDlVnRL3qRlNVQpdLrw/8fmgznOhELubS+2ZQmCYwBT9puF9gjBqO/LwgrIQFGL3vzh5qWM6pmM6pmM6pmM6pmP+t6lvsvuN43rsklt+bsXnwIyR77/5R019k91vHNdjl1x55rwzPmCZ0JCL1PzzKprsMHqt/V7q9dglN3PNl9cPjHCEtlyk9p/nTXYcv9Z+L/V67JLrMuzLx/PH+dFffS7Sn9k6134v7V1yPU+8X2VP+ST30+flQed4LlImd/ptXPGlZu3tz+cphbo32RW9DW/uTHt2evHgl2PSNfBU0hAHPUllStt6s1zPb7SM9Cr+Fs5n6NTi+ageic7RXKRM7ozc/ulvrnklIebn85Sozia7FJlUZsa6dA08lTTE2bZxCjklb5brR6c/HdBn3IhB8zv3Lu8jaxOdY7lIIHc2fXwO3/Mymlpq8pSozia7zw+pnrwu+MSzYwVGStfAKUlDHPQslSm2tWY5+T09uzxwe//IYnQJLtgJOkfe4zK5U977J3/8K2BvQ54S1dlkF9hGrwJhFTihd1wDpyQNcdTzVKbYVprlrKOoa3nCsOk9wPT+uY9kCmHxTO6U38zXF334A7Tqp/OUqM7Wr3C694dH3uVHesc1cErSEAc9S2WKbb1ZzpwuvykO7e78oturBd3KC5kp5E6HrQPfP7nth0f3NXlKUFenJ76/BqfBKUlDHPQklSm29Wa5NEjPuTq9dEj12VG+yEt0jjoNcmfkkSK0/33F2k/nKUHdnC7SA+E0SANpiIOepTLFtt4sZ06X9/P1fc8XjuLA8LH9Qee40x/vIX5hx22LH6nNU/KmNzrd54ecloY46EkqU2zrzXLu9Psn5VvKeR9YU5I7WBxOBynybGXEE1XlKXnTW4PT0hBHPU9lotNslvMuuYEfqKAl5b2sO+gcy0UK7SAsPnJk9XlK3vTW4LQ0xEHPUpliW2+W0y65/cXjiR8IoaegcywXKbSDpIodfiJPCerSZJecztey09IQBz1NZYptvVmufEe65MprymtB7mguEsmdkQ8CX/6ZPCWoS5PdiEEfne5f3gB652uZU5KGOOhJKlPe1pvl5nyrS67fhzeyiJgMOsdzkUju3Mc/+6rylKAuTXZd13z42mNWjwIjzc3XwClZQ1zoWSoTttVmuSGtDBOHLPmtHo15SlRvH/JN1LNUpj9vPvyHnH9n/tSsoDMrFn/4WO3fmT/V6V2dP7z1/UPzp6YyXbqx7N7RTv/S/Hwq0ztYyb28iUo3eAAAAABJRU5ErkJggg=="})}),(0,r.jsx)("div",{className:"flex justify-center ".concat(n," items-center mt-2 border-4 border-dashed font-bold text-gray-900 text-center hover:scale-105 border-black  h-[150px] w-[250px] cursor-pointer p-4"),children:(0,r.jsx)(ut,{updateColor:function(){i("bg-green-300 hover:bg-green-400")}})})]})})})},dt=n(1025),ht=n.n(dt);function ft(e){return e.map((function(e){return e.name+": "+e.displaySort}))}var pt=n(8121),vt=n.n(pt),gt=n(2064),mt=n.n(gt),yt=function(e){var t=vt()(e),n=mt()(t);if(e.length!==n.length)for(var r=0;r<e.length;r++){var i=r+1,o=e[r].replace(/\./g,"");e[r]=i+"_"+o}else for(var a=0;a<e.length;a++)e[a]=e[a].replace(/\./g," ");return e};function wt(e){return function(e){if(Array.isArray(e))return q(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||X(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var bt=function(e,t){var n=Math.abs(t),r=e.map((function(e){return e+n+1}));return r},Ct=function(e,t){var n=[],r=0;return e.length>0&&e.forEach((function(e){var t=Math.min.apply(Math,wt(e));t<r&&(r=t)})),e.forEach((function(e,i){var o={},a=bt(e,r);o.name=t[i],o.rawSort=wt(e),o.displaySort=e.toString(),o.posShiftSort=wt(a),n.push(o)})),n},St=function(t){var n=y(),i=n.isDataLoaded,o=n.statementsAreLoaded,a=n.setNumQsorts,s=n.setQSortPattern,l=n.setRespondentNames,u=n.setMainDataObject,c=n.setSortsDisplayText,h=n.setMultiplierArray,f=n.setDataOrigin,p=n.setProjectName,v=n.setHasImportedSorts,g=n.setIsDataLoaded,m=n.setShowInputErrorModal,w=n.setSortsAreLoaded,b=lt(),C=b.setCsvErrorMessage,S=b.setShowCsvErrorModal,E=b.setExcelErrorMessage1,k=b.setShowExcelErrorModal,x=(0,e.useCallback)((function(e){if(i)m({showModal:!0,titleText:"Data Loading Error",bodyText:"Data are already loaded.",bodyText2:"Reload the webpage to start a new project."});else{var n,r,d,y,b,x,T,R={delimiter:"",newline:"",quoteChar:'"',escapeChar:'"',header:!1,transformHeader:void 0,dynamicTyping:!1,preview:0,encoding:"",worker:!1,comments:!1,step:void 0,complete:void 0,error:void 0,download:!1,downloadRequestHeaders:void 0,downloadRequestBody:void 0,skipEmptyLines:!1,chunk:void 0,chunkSize:void 0,fastMode:void 0,beforeFirstChunk:void 0,withCredentials:void 0,transform:void 0,delimitersToGuess:[",","\t","|",";",ht().RECORD_SEP,ht().UNIT_SEP]},A=[];e.forEach((function(e){var i=new FileReader,m=[];i.onabort=function(){console.log("file reading was aborted"),E("The file reader aborted the load process!"),k(!0)},i.onerror=function(){console.log("file reading has failed"),E("The file reader encountered an error!"),k(!0)},i.onload=function(e){var E=ht().parse(i.result,R);try{var k=(r=E.data).shift();x=k[0].slice(10,30);var _=r.shift(),O=_[0].slice(0,6).split(" "),D=_[0].slice(7).split(" ");O.filter((function(e){return""!==e})).map((function(e){return parseInt(e,10)}));if(b=D.filter((function(e){return""!==e})).map((function(e){return parseInt(e,10)})),r.length<1)throw new Error("Can't find any Q sorts in the file!");var N=[-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13];T=[];for(var P=0;P<b.length;P++){var F=b[P],I=N[P];if(0!==F)for(var L=0;L<F;L++)T.push(I)}var M=r.filter((function(e){return""!==e[0]})).map((function(e){var t=e[0].slice(0,8).trim(),n=e[0].slice(9);m.push(t);var r=n.replace(/[\-]/g," -").trim().split(" ").map((function(e){return Number(e)}));return r}));n=M.length,A=Ct(M,m),d=yt(m),y=ft(A)}catch(G){C(G.message),S(!0)}a(n),s(T),l(d),u(A),c(y),h(b),f("pqmethod"),p(x),v(!0),t.updateColor(),w(!0),o&&g(!0)},i.readAsText(e)}))}}),[i,o,g,m,C,S,a,s,l,u,c,h,f,E,k,p,v,w,t]),T=it({onDrop:x}),R=T.getRootProps,A=T.getInputProps;return(0,r.jsxs)("div",d(d({className:"flex justify-center items-center pt-[20px]"},R()),{},{children:[(0,r.jsx)("input",d({className:""},A())),(0,r.jsx)("p",{children:"Drag and drop CSV Q sort file here, or click to select"})]}))},Et=function(){var t=Y((0,e.useState)("bg-gray-300 hover:bg-gray-400"),2),n=t[0],i=t[1];return(0,r.jsx)("div",{className:"w-[300px]",children:(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"flex flex-col justify-center  items-center rounded-md bg-white h-[500px] w-[300px]",children:[(0,r.jsx)("h6",{className:"text-[22px] font-bold tracking-tight text-gray-900",children:"2. Load Q sorts DAT file"}),(0,r.jsx)("p",{className:"font-normal text-gray-700 dark:text-gray-400",children:"PQMethod DAT format"}),(0,r.jsx)("div",{children:(0,r.jsx)("img",{alt:"sorts",className:"h-[175px] w-[250px] m-6 border-2 border-black",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATEAAACvCAMAAACioBndAAADAFBMVEX///8AAADl5eXy//////H7//8AAFCFzfCLLgDL9/9eAAAvAACTLgDu7/LL8v8AAEL///vG8v/3///0041QAADt/////9/11JVCAELu9/8AAHv//+0AAIr38vLUoGKVzPT78ur/98sAAJPy8vL52JyaLgAAZa0AP5oAAF57AADX8v+NzvH/8saFzPUekM8AgcpyAACU0vTy8vjPiiHR+P90tt//+/j/++3S0ubz5czPkkn78vLy8t/0zo0AXGeZcE2hLgD/99AAAGjk///u8vj4+PgATaeo2PT006P///f/9/L//+T85bvq6u/W5e3/+99oAABCAADQ8v/y7+7/99bf/P/y+/u74fjf8/ff7/JgsOL/99v79+VJkMutcQD/9+V1sNk4kMoAeL8AP6Gyq5AATosALHouLi7BzeFWpNr46tHz6tG9uML92JwAP5PsvmuaTwDr6urz5cfOvb1kgab0zpUAToQAQISZeW/UkjlxXCvv06P52KLsyZUALIRwgmXPkjnL+//78u7l99//+9X48tH53ajz3Zz9042ggzwvAC/r3bWPvbHEkkqv3O///9D//MsAZLldAEIAK5OazOvzzIX39/LJnWoAAC+GAADd29//78Cv2vTiv4eCvuNko9SiTQC+7v/H1uf77tvl4OD51o3/5rUAKpsAAHLQoFcAYaffy6b93aJLUFmUwuOPrdofiMuIn6wALV3ZmTivYQCIQwCu4/3G7fqNzfWnzuNsqt46gr/85KwzY6LXnEi/ijqiXQiVQQCAx+7y8dv97NVImNOesc743K/qyJ24pZfgrV1xXD9CAC6TAADb+v/m9P3R6PnA5fjMxtLp2c/Qq3TluG+uhl5sv+ze4+k3l9RWnNLOwLPu166/kYEALkJdUjFCLgDz//Lp5dU4kM8Ab7tsLi3FfwAuNACwwtODrtEAiMrh0sEleK0AP4sAQHGKgmVBLkGneiZ1vd0igb+fkbKrn6vh2Jy3vZbYsZaYq4grQHuJiXhxQHEtLVB7QUAALi4BTwbIAAAP5UlEQVR42uyXZXATURDHd4kALU2ahCClSHApNpQiM3ygSCke3B2Ku7u7t4VSKFrc3d3d3d11BhgY7F1uJ0tzw10JA5/4fXlz/+yt9b3XW5BA+M/voOxYSBYDKBjq97OY3o8XT/zPn4bEUd7PCqCkbWWlNvggMOUrGUAVNkk8C84VNVDy/s/btzb8Rsf6+WLLmp5dmI748hQQJX0Qe1UDWgh9tqTgIt2My/ALwm/OSugTt7lF5lF+8CTId54c1rgVIA5xiUm/p6Ndvyc0WBIx8m4KlLhqi9RBamOwbAKpEc1PDcroDIs78PtOHSUffsmZ2Z74jqUq0HBEyqaQkJEYVX/jGiAat6/bLlc+oIXQp6COQZLTv+zYybz8sAhXTVu+2i0y69eAJ8eaWwEcKefce5szWCxVNj7Qz8VNMzGnSTzFx14xxF+5EFA59rRNVJrabJFNwBZQ+QLWU0ZnWFyY2QqcfIfMusR3rL95SAfM4fFCCeHhWKQdmEL5afHsWLk3K8MAanxbia02Axxxolk83vDBVmehnC/eujMHiOiAUiAgscaXYOi/0wpxGIP3IW6nHYIebuL9K9XtcOYBh2+YTeyhhTnrdH587SIaTQ5nQaCSRc62SKvomEk2CbYJaZecNQeiXCgzEks+fIwRO3Vy8lQvWUpb7nOwWsdKBAwrMCinbMLikpqwK9AORJXefTGMFs+OheyfkVTaD9vv7s6h058sDOfPwEzf2ZAh0C5+mp2+NBAznevWzgcg0THWIvK078CoA7nuQ5AzDI7xyUg3Iy9IPmfrL8RYosXJK2HenG38w6+fzCaHD0Y8ls6T1B5IjRERvkaTbGIRktQ/kKFAlAtlRqJ/lrjAuqWBkidnZCkqi7Godcw2cEz+UWYPkyq5Xr3GgJruCrq18G3iXrhjfKE5TsyDFWaLfq6rKyVw5crbMfPET3mBWXD0OG43kOhIY5G2SbRIVTqVjx78fB1WcNUhmoPm1XBxsQ6izZtTRG1Y/MEsncok8VeoSOkcXrlgNMkmJlfHuBQ5EOUiZ0Yivc63sbgPOWvoksSq1rHUGFBqNG0npsj1J3HCC9NJMqGFOpZX2THQX7+EcyA6sG6XSn4GYZPHY++GBpPoSJMcLka6O7bD+DH0FPBfY59rj+1zVSN+ELd7irwLzogNJB1VLpl2lWSSVe7YxcBSIEOBKBfKjERFxwLtbAkhZVTvseE+bdJ1bgYJ8Y+31sh1FYi2rWs1aNTcSov7L/guvZ+fFULSpdjnL6q7BksD7eGxOv8Nz2ARRkGDc1YI39DUagCi4qG04UsDSpFYpcC+dBty6HbgrAp77wtve/AgMIOzi9eoOeKw6Bstk7a0fMkXFmEN3DFJdJmUtdoC6yx3shs5EOVCmZFIr1Py0v/msDLurPWdzaqnEgYgtsoNCdHvRXxhByIrIobWpsVtMhcFBWlxpEQ0z3KJoWcB4oS2TOe6bhsCcdgpTKKARP8JiLfL6mA6oqtXncRxYGZKTyVType8cCZOVbYtIhFjctfXhdFEB0n+ukgumYS6vi5inlqBoECUC2XmTsm2WOeuQfRxOhotZClU4TEBqPiwNIAn/nRj01OZLLwokQ9Zeleu02RnIX6eO5t+Y9LX+nkZXFa8zhS/BkzIDd96oAK7VsK5sImGZZBzDUt/bUoKwnnwB5SsigVBhWK54d9R/33uf9AxcU3AH6CPrQP/+Q/P7Noiz+xK8d+T+JS4InUmGE3aIs/s2mJFH8SeuYHheV41EN9qiFu8FNmndnTOU1mRGlmR/KuKPLNri+W6V+5aNR8wPM8nJpDjxNb42LReiexTKzrnqV2Rp0Wu8VMtmiLP7Koi04c/FxTzvEYgR5raWQC8FdmndnTOU7siZvCUSWksmiLP7GoiU8OnHjA8zycmUJATcclmr0T2qRWd89Qok8mAEhlHGpNPFjNeQlhUzuwqIlMhWXYdMDzPJyZQeCWosKes1RuRfWpF5zw1ymQyJZFIWwgjEHN6HHsWVWZ2hcikUiTC87xaIGZ9ZrsXorrPTtp5KitSMrRLpXFjJxo0RZ7ZtcX6yTrWqV7aQ+RBXivQgfllFuxtBl6J7FMzOuepXZFyKNQWeWbXFnugwOPypEFePRBbtqzmtcg+ldG18+SK/hye2ZWiNjzIaxPyg117SYkoiKEwXI34aJw4cBc6scG3qFNX42YcOnfiHtyaFAR/2qOnQygEm8os5iZVfQXhM80vvvLD+ul8ohkzZvyPYEc9GutA19XsFF+rS5wsHX3N0P/dGzvqdv2wOGvVoF0UC3RNzU/J13zGeepy7RPI91VCXwzEjvr08P74pFWDdlEs0DU1OyVf8xnnict50kC+r6v6G4sd9eXV0eN+qwXtqlig62puSr7mMz0Pl/OkQF7fWOyo2dXWgnYUK9D1NT8lX/MZ5+FyfRLI6xuLHXXpjQH5RjuKjRrQ3VRzU/I1m3EeLl+fEllAPrL4y7/sC/zYUbNYT4RCvtGOYqMGdDfV3JR8zWWK7ufvUyILyEfWerwvXp4+3nZiR91u7w7OV2UW0I5iBbqu5qfkaz7jPHU5Tyrk+erb3uvXjvqmL5mXrRa0i2KBrqn5KfmazzhPXc6TDvIXq12zJR6PdWp/MCXt8hkzZmxBhMRB6WCJq4VdNl7+9e25kzhELUTayei3IGPj5Lzu6aPm7mkkDlErkXcy+s3L2Ds5r3v6tObvqRKHqLXIOxn95mXsnZzXPX1a8/dUiUPUQuSdjH7zMrZO9rr3fdTMPY3EIepQiatwQ79Gxvbz6Aqf89Zm/nwzfK01e0+VOEQdKnEVbujXydiIWlb4nLc+85eb4Wut2XuqxD/ZuXubBoMgCMORIyJqIHTkEiiESmiEHqiAzgixrEOvrEUzo0GyjLjJVt7vRxYOHu1yELVI7GT0m8tYOFnK317HZ/49p8QhapXcyeg3l7F3cq57ruMz8Z53IXH06z/rn7eVvrPzr9JLvPd1L/j+XXzF073EgWcR9GsqLOwET6dSuupUlZ/We4kDzyLo11RY2AmeTqV01akqN633EgeeVdCvqbCwFTydSumiU1ZuWu8lDjyLoF9XYWEneDql0kWnrPy03ksceBaZ+p3VsLAV/HXnj0oPOlUlpvVe4sCzyNDvrIaFreDnVHoqPehUlZjWe4kDzyLo11RY2AmeTqV01akqO633EgeeRdCvqbCwFTydSumiU1V2Wu8lfjfw7AQ/O1Uln74lvrPzJzO201uJl4au1VzPy33lt9PBbBHjZD/pbtWc676YyJvtdDBbxDjZT7pbNee6zyfy2XY6mC1inewn3bWac93HE/lwOx3MFnFO9pPuWs257uOJfLydvjDbRjlZ7YCvaoXOeZ1Sc6B7njDuOZ6XbaczZK6inCx2wFdF6BzXCTUHuucB857jedF2OpgtIpwcT7p7Nee6zyfyfjsdzBYRTg4n3a2ac93nE/kbbKf/ftLdq5nkvt5T8J2dnUbpt7uLN3szE+dEpdM6mpxDz4rg1lLiatKtJ+u+02/K+x13jol8fzh+H03OoWdFcGsncTXp1pN13+k35f2OO3k+X72OJufQsyK4tZO4nHTLybrv9JvydsedXL6tdTQ5h54Vwa2dxNWkW0/WfafflLc77uT8bR3X0eTj0LMww63W1/k3tu45pu48T3QOs4s3Ezvu81d5WkeTj0PP0mgLo9/if7rXPefUneepzmuJqzcTO+5X+fw4vL49Xn6ZHHpWBbe2EleTbjFZl535przccSeXI8JfDpe/Mw49a4Jba4mrSbecrPtOvylvd9yB59NXe2fzElUUhvFzUqPUcrp2N45hpYiGbYSWs+jLdFFmOREJGSSEhNA/UEGLFrX0Ax3LDCR0CnEzEpFCkBsXES0Ka1WLCPpa1K5N584IZ3G7z7nz+hIq748hOQzHQ6e5zfzmfe9zWlHo2abp88Z1dsloE4SNzdlWZUnsOMfp3oSqNPNv4e+G785pnfWUmhmdD8zzNN3E4xsurnu7jRr1v0O7p3fDWzomb7y++ttXyW26PzjNKXveHL1ExW24qO4d36hB/zt2fXo3vOW5ni/8bOqr9VXD1jN7KVclwXBB3dtt1Kj/Hdk9vRveklrdz8W2lop5owiGIUXGbbig7k0watD/7jZXWFnH3emG5Fi/eZgdG1LLpt5LJlwFh1Xp8MgadfykN5D7hswfVdajvj8wNBQOc3pUkbeBoDdqwOxhsaAqOKpKh0fWqOMnvaHcN2D+sLIeWZ9Xycqs3/vGW6711ZPRh4d3z6oZwncXRRournu7jRr2v0O7p3fDW17mtG77OLkUHOJ3KBDzqhOKjNtwQd07vlHjbnhs9/RueEv9cd7mTmy49rn1k2Vufuc6/f5AEIT/BFM+On0FOvTsdPNQ1/VEKv924ysi/Pno2O7xPPcI19lxd7p5tOtnqjeT+TQ2p6jw56Nju8fz3CNcZ8fd6anLdyseqIBxo5d0+PPRsd3jeXhEqbPbHTMK3lhWUHJK0BF/PjrB7sE8NHLX2SN27KauK7zQ3ykya8xHBw4N7R7ZNniOUme33enV+73F/PU6bP7JyKwxHx04NLR7ZNvoueLr7LY73eyYn6xsCw6DnlN0+PPRsd3jee4RrrPj7vTg08V414X8V7Jk+PPRsd3jee4RrrPj7nQGmPPRpX4tCAL1PvGR4AcdehIawdL5wKuj+8RX3zl5TNydhIbsF9s2/witDu4T39c1kbyY9VhM3J2EBu0X2zb/CK0O7hNvubOd1AeLatSoJg7sF9s2/wiuHn2feMfnpj+6jsnE3UloyH6xbfOP4OrR94n35Bb6yt8X/x9thG27ktCQ/ULbBiNLcc/B1aMT24anj6oBgouHbDtmEhqyX2TbYGQp8jmwOkhsa9D3EjPTaebENlwTx/aLbZt/hFcP3yeefKv16CxvYhuqiSP7xbbNPwKrw/vER+o9xY215nVTBVdqY6wuCAKBW4TLll735k89B+bP9DcqndRaV+1qN38uHMi/c35/xZrYBowapp4Du4euz3SmWXie/Sh3aSqT8aprTj0ubyy7rYd6cnOsiW3AqGHqObB76PpMZ5qF51ldeJq3gUFPLdb6KfPpf3nQ50xsA0YNU8+B3WPX5zzTzM6zlF4zVpAtMa+xr7lfKjWdDjaOM7ENGDVMPQd2j12f+UwzO89elVumThp/uqKPpFVn84+fuibNmNiG696x8tHDdg8712NX5GGOe3ienXpw9arsbF4yr8kPX+4PlnAmtuG6tzv1/J92jzrX41bkcY57xDy72aYmroardiamvO7mFcWZ2AaMGqeeA7uHrs9zpll4nt3swo6ZF1aycqX0hdbffN7ENmDUKPUc2D10fc4zzey8aBJ7jikC1HQ1/lPMxKEFQRAEQRAEQRAEQRAEQRAEQRAEQRAEQRAEQRAEQdhw/AVTNjAe8MRQMgAAAABJRU5ErkJggg=="})}),(0,r.jsx)("div",{className:"flex justify-center items-center ".concat(n," mt-2 border-4 border-dashed font-bold text-gray-900  text-center hover:scale-105 border-black h-[150px] w-[250px] cursor-pointer p-4"),children:(0,r.jsx)(St,{updateColor:function(){i("bg-green-300 hover:bg-green-400")}})})]})})})},kt=function(e){var t=e.removeOverlay,n=y().csvErrorMessage1;return(0,r.jsx)("div",{className:"overlay_background",onClick:function(e){return t()},children:(0,r.jsxs)("div",{className:"overlay_card p-8 min-h-[400px] min-w-[600px]",onClick:function(e){return function(e){e.stopPropagation()}(e)},children:[(0,r.jsx)("div",{className:"mb-4 border-bottom",children:(0,r.jsx)("span",{style:{fontSize:40,display:"block"},children:"There was a file read error!"})}),(0,r.jsx)("div",{className:"m-4",children:(0,r.jsx)("span",{style:{fontSize:30,display:"block"},children:n})}),(0,r.jsx)("span",{style:{fontSize:30,display:"block"},children:"Please check your PQMethod file data and try again"}),(0,r.jsx)("form",{className:"mt-8",onSubmit:function(e){e.preventDefault(),t()},children:(0,r.jsx)("button",{className:"btn btn-primary form_submit ",type:"submit",children:"Close"})})]})})},xt=function(){var e=y(),t=e.showCsvErrorModal,n=e.setShowCsvErrorModal;return(0,r.jsxs)("div",{id:"modal-root",className:"flex flex-row rounded-md p-8 pt-2 bg-gray-300 min-w-[700px] min-h-[600px]",children:[(0,r.jsx)("div",{children:(0,r.jsx)(ct,{})}),(0,r.jsx)(Et,{}),(0,r.jsx)("div",{className:t?"overlay_shown":"overlay_hidden",children:(0,r.jsx)(kt,{removeOverlay:function(){n(!1)}})})]})};function Tt(){Tt=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(T){s=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof d?t:d,o=Object.create(i.prototype),a=new E(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return x()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=u(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(e,n,a),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(T){return{type:"throw",arg:T}}}e.wrap=l;var c={};function d(){}function h(){}function f(){}var p={};s(p,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(k([])));g&&g!==t&&n.call(g,i)&&(p=g);var m=f.prototype=d.prototype=Object.create(p);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(i,o,a,s){var l=u(e[i],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==N(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(l.arg)}var i;this._invoke=function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,c;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function k(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return h.prototype=f,s(m,"constructor",f),s(f,"constructor",h),h.displayName=s(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,o,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(m),s(m,a,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=k,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},e}function Rt(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(r,i)}function At(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Rt(o,r,i,a,s,"next",e)}function s(e){Rt(o,r,i,a,s,"throw",e)}a(void 0)}))}}var _t={version:"0.18.5"},Ot=1200,Dt=1252,Nt=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Pt={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ft=function(e){-1!=Nt.indexOf(e)&&(Dt=Pt[0]=e)};var It=function(e){Ot=e,Ft(e)};function Lt(){It(1200),Ft(1252)}function Mt(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function Gt(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var Bt,jt=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return 255==t&&254==n?function(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==n?Gt(e.slice(2)):65279==t?e.slice(1):e},Ht=function(e){return String.fromCharCode(e)},Vt=function(e){return String.fromCharCode(e)};var Wt=null,zt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ut(e){for(var t="",n=0,r=0,i=0,o=0,a=0,s=0,l=0,u=0;u<e.length;)o=(n=e.charCodeAt(u++))>>2,a=(3&n)<<4|(r=e.charCodeAt(u++))>>4,s=(15&r)<<2|(i=e.charCodeAt(u++))>>6,l=63&i,isNaN(r)?s=l=64:isNaN(i)&&(l=64),t+=zt.charAt(o)+zt.charAt(a)+zt.charAt(s)+zt.charAt(l);return t}function Kt(e){var t="",n=0,r=0,i=0,o=0,a=0,s=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=zt.indexOf(e.charAt(l++))<<2|(o=zt.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&o)<<4|(a=zt.indexOf(e.charAt(l++)))>>2,64!==a&&(t+=String.fromCharCode(r)),i=(3&a)<<6|(s=zt.indexOf(e.charAt(l++))),64!==s&&(t+=String.fromCharCode(i));return t}var qt=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),Xt=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Yt(e){return qt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Qt(e){return qt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Zt=function(e){return qt?Xt(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function Jt(e){if("undefined"===typeof ArrayBuffer)return Zt(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function $t(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function en(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return en(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var tn=qt?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:Xt(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var nn=/\u0000/g,rn=/[\u0001-\u0006]/g;function on(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function an(e,t){var n=""+e;return n.length>=t?n:Cr("0",t-n.length)+n}function sn(e,t){var n=""+e;return n.length>=t?n:Cr(" ",t-n.length)+n}function ln(e,t){var n=""+e;return n.length>=t?n:n+Cr(" ",t-n.length)}var un=Math.pow(2,32);function cn(e,t){return e>un||e<-un?function(e,t){var n=""+Math.round(e);return n.length>=t?n:Cr("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:Cr("0",t-n.length)+n}(Math.round(e),t)}function dn(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var hn=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],fn=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var pn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},vn={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},gn={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function mn(e,t,n){for(var r=e<0?-1:1,i=e*r,o=0,a=1,s=0,l=1,u=0,c=0,d=Math.floor(i);u<t&&(s=(d=Math.floor(i))*a+o,c=d*u+l,!(i-d<5e-8));)i=1/(i-d),o=a,a=s,l=u,u=c;if(c>t&&(u>t?(c=l,s=o):(c=u,s=a)),!n)return[0,r*s,c];var h=Math.floor(r*s/c);return[h,r*s-h*c,c]}function yn(e,t,n){if(e>2958465||e<0)return null;var r=0|e,i=Math.floor(86400*(e-r)),o=0,a=[],s={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(r+=1462),s.u>.9999&&(s.u=0,86400==++i&&(s.T=i=0,++r,++s.D)),60===r)a=n?[1317,10,29]:[1900,2,29],o=3;else if(0===r)a=n?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],o=l.getDay(),r<60&&(o=(o+6)%7),n&&(o=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,a))}return s.y=a[0],s.m=a[1],s.d=a[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=o,s}var wn=new Date(1899,11,31,0,0,0),bn=wn.getTime(),Cn=new Date(1900,2,1,0,0,0);function Sn(e,t){var n=e.getTime();return t?n-=1262304e5:e>=Cn&&(n+=864e5),(n-(bn+6e4*(e.getTimezoneOffset()-wn.getTimezoneOffset())))/864e5}function En(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function kn(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=En(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=En(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),En(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function xn(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):kn(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Kn(14,Sn(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Tn(e,t,n,r){var i,o="",a=0,s=0,l=n.y,u=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:i=l%100,u=2;break;default:i=l%1e4,u=4}break;case 109:switch(t.length){case 1:case 2:i=n.m,u=t.length;break;case 3:return fn[n.m-1][1];case 5:return fn[n.m-1][0];default:return fn[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:i=n.d,u=t.length;break;case 3:return hn[n.q][0];default:return hn[n.q][1]}break;case 104:switch(t.length){case 1:case 2:i=1+(n.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:i=n.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:i=n.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(s=r>=2?3===r?1e3:100:1===r?10:1,(a=Math.round(s*(n.S+n.u)))>=60*s&&(a=0),"s"===t?0===a?"0":""+a/s:(o=an(a,2+r),"ss"===t?o.substr(0,2):"."+o.substr(2,t.length-1))):an(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":i=24*n.D+n.H;break;case"[m]":case"[mm]":i=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":i=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}u=3===t.length?1:2;break;case 101:i=l,u=1}return u>0?an(i,u):""}function Rn(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var An=/%/g;function _n(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+_n(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%i;if(o<0&&(o+=i),-1===(n=(t/Math.pow(10,o)).toPrecision(r+1+(i+o)%i)).indexOf("e")){var a=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(a-n.length+o):n+="E+"+(a-o);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(i+o)%i)+"."+r.substr(o)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var On=/# (\?+)( ?)\/( ?)(\d+)/;var Dn=/^#*0*\.([0#]+)/,Nn=/\).*[0#]/,Pn=/\(###\) ###\\?-####/;function Fn(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function In(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function Ln(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function Mn(e,t,n){if(40===e.charCodeAt(0)&&!t.match(Nn)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Mn("n",r,n):"("+Mn("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return jn(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(An,""),i=t.length-r.length;return jn(e,r,n*Math.pow(10,2*i))+Cr("%",i)}(e,t,n);if(-1!==t.indexOf("E"))return _n(t,n);if(36===t.charCodeAt(0))return"$"+Mn(e,t.substr(" "==t.charAt(1)?2:1),n);var i,o,a,s,l=Math.abs(n),u=n<0?"-":"";if(t.match(/^00+$/))return u+cn(l,t.length);if(t.match(/^[#?]+$/))return"0"===(i=cn(n,0))&&(i=""),i.length>t.length?i:Fn(t.substr(0,t.length-i.length))+i;if(o=t.match(On))return function(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),o=Math.floor(i/r),a=i-o*r,s=r;return n+(0===o?"":""+o)+" "+(0===a?Cr(" ",e[1].length+1+e[4].length):sn(a,e[1].length)+e[2]+"/"+e[3]+an(s,e[4].length))}(o,l,u);if(t.match(/^#+0+$/))return u+cn(l,t.length-t.indexOf("0"));if(o=t.match(Dn))return i=In(n,o[1].length).replace(/^([^\.]+)$/,"$1."+Fn(o[1])).replace(/\.$/,"."+Fn(o[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+Cr("0",Fn(o[1]).length-t.length)})),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return u+In(l,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return u+Rn(cn(l,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Mn(e,t,-n):Rn(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,o[1].length)))+"."+an(Ln(n,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return Mn(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=on(Mn(e,t.replace(/[\\-]/g,""),n)),a=0,on(on(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return a<i.length?i.charAt(a++):"0"===e?"0":""})));if(t.match(Pn))return"("+(i=Mn(e,"##########",n)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(o[4].length,7),s=mn(l,Math.pow(10,a)-1,!1),i=""+u," "==(c=jn("n",o[1],s[1])).charAt(c.length-1)&&(c=c.substr(0,c.length-1)+"0"),i+=c+o[2]+"/"+o[3],(c=ln(s[2],a)).length<o[4].length&&(c=Fn(o[4].substr(o[4].length-c.length))+c),i+=c;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(o[1].length,o[4].length),7),u+((s=mn(l,Math.pow(10,a)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?sn(s[1],a)+o[2]+"/"+o[3]+ln(s[2],a):Cr(" ",2*a+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return i=cn(n,0),t.length<=i.length?i:Fn(t.substr(0,t.length-i.length))+i;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=t.indexOf(".")-a,h=t.length-i.length-d;return Fn(t.substr(0,d)+i+t.substr(t.length-h))}if(o=t.match(/^00,000\.([#0]*0)$/))return a=Ln(n,o[1].length),n<0?"-"+Mn(e,t,-n):Rn(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?an(0,3-e.length):"")+e}))+"."+an(a,o[1].length);switch(t){case"###,##0.00":return Mn(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var f=Rn(cn(l,0));return"0"!==f?u+f:"";case"###,###.00":return Mn(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Mn(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Gn(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Gn(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%i;if(o<0&&(o+=i),!(n=(t/Math.pow(10,o)).toPrecision(r+1+(i+o)%i)).match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(a-n.length+o):n+="E+"+(a-o),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(i+o)%i)+"."+r.substr(o)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Bn(e,t,n){if(40===e.charCodeAt(0)&&!t.match(Nn)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Bn("n",r,n):"("+Bn("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return jn(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(An,""),i=t.length-r.length;return jn(e,r,n*Math.pow(10,2*i))+Cr("%",i)}(e,t,n);if(-1!==t.indexOf("E"))return Gn(t,n);if(36===t.charCodeAt(0))return"$"+Bn(e,t.substr(" "==t.charAt(1)?2:1),n);var i,o,a,s,l=Math.abs(n),u=n<0?"-":"";if(t.match(/^00+$/))return u+an(l,t.length);if(t.match(/^[#?]+$/))return i=""+n,0===n&&(i=""),i.length>t.length?i:Fn(t.substr(0,t.length-i.length))+i;if(o=t.match(On))return function(e,t,n){return n+(0===t?"":""+t)+Cr(" ",e[1].length+2+e[4].length)}(o,l,u);if(t.match(/^#+0+$/))return u+an(l,t.length-t.indexOf("0"));if(o=t.match(Dn))return i=(i=(""+n).replace(/^([^\.]+)$/,"$1."+Fn(o[1])).replace(/\.$/,"."+Fn(o[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+Cr("0",Fn(o[1]).length-t.length)})),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return u+Rn(""+l);if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Bn(e,t,-n):Rn(""+n)+"."+Cr("0",o[1].length);if(o=t.match(/^#,#*,#0/))return Bn(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=on(Bn(e,t.replace(/[\\-]/g,""),n)),a=0,on(on(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return a<i.length?i.charAt(a++):"0"===e?"0":""})));if(t.match(Pn))return"("+(i=Bn(e,"##########",n)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(o[4].length,7),s=mn(l,Math.pow(10,a)-1,!1),i=""+u," "==(c=jn("n",o[1],s[1])).charAt(c.length-1)&&(c=c.substr(0,c.length-1)+"0"),i+=c+o[2]+"/"+o[3],(c=ln(s[2],a)).length<o[4].length&&(c=Fn(o[4].substr(o[4].length-c.length))+c),i+=c;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(o[1].length,o[4].length),7),u+((s=mn(l,Math.pow(10,a)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?sn(s[1],a)+o[2]+"/"+o[3]+ln(s[2],a):Cr(" ",2*a+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:Fn(t.substr(0,t.length-i.length))+i;if(o=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=t.indexOf(".")-a,h=t.length-i.length-d;return Fn(t.substr(0,d)+i+t.substr(t.length-h))}if(o=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Bn(e,t,-n):Rn(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?an(0,3-e.length):"")+e}))+"."+an(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=Rn(""+l);return"0"!==f?u+f:"";default:if(t.match(/\.[0#?]*$/))return Bn(e,t.slice(0,t.lastIndexOf(".")),n)+Fn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function jn(e,t,n){return(0|n)===n?Bn(e,t,n):Mn(e,t,n)}var Hn=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Vn(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":dn(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(Hn))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Wn=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function zn(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function Un(e,t){var n=function(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var o=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,o];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var a=n[0].match(Wn),s=n[1].match(Wn);return zn(t,a)?[r,n[0]]:zn(t,s)?[r,n[1]]:[r,n[null!=a&&null!=s?2:1]]}return[r,o]}function Kn(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:pn)[e])&&(r=n.table&&n.table[vn[e]]||pn[vn[e]]),null==r&&(r=gn[e]||"General")}if(dn(r,0))return xn(t,n);t instanceof Date&&(t=Sn(t,n.date1904));var i=Un(r,t);if(dn(i[1]))return xn(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var i,o,a,s=[],l="",u=0,c="",d="t",h="H";u<e.length;)switch(c=e.charAt(u)){case"G":if(!dn(e,u))throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"G",v:"General"},u+=7;break;case'"':for(l="";34!==(a=e.charCodeAt(++u))&&u<e.length;)l+=String.fromCharCode(a);s[s.length]={t:"t",v:l},++u;break;case"\\":var f=e.charAt(++u),p="("===f||")"===f?f:"t";s[s.length]={t:p,v:f},++u;break;case"_":s[s.length]={t:"t",v:" "},u+=2;break;case"@":s[s.length]={t:"T",v:t},++u;break;case"B":case"b":if("1"===e.charAt(u+1)||"2"===e.charAt(u+1)){if(null==i&&null==(i=yn(t,n,"2"===e.charAt(u+1))))return"";s[s.length]={t:"X",v:e.substr(u,2)},d=c,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=yn(t,n)))return"";for(l=c;++u<e.length&&e.charAt(u).toLowerCase()===c;)l+=c;"m"===c&&"h"===d.toLowerCase()&&(c="M"),"h"===c&&(c=h),s[s.length]={t:c,v:l},d=c;break;case"A":case"a":case"\u4e0a":var v={t:c,v:c};if(null==i&&(i=yn(t,n)),"A/P"===e.substr(u,3).toUpperCase()?(null!=i&&(v.v=i.H>=12?"P":"A"),v.t="T",h="h",u+=3):"AM/PM"===e.substr(u,5).toUpperCase()?(null!=i&&(v.v=i.H>=12?"PM":"AM"),v.t="T",u+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(u,5).toUpperCase()?(null!=i&&(v.v=i.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),v.t="T",u+=5,h="h"):(v.t="t",++u),null==i&&"T"===v.t)return"";s[s.length]=v,d=c;break;case"[":for(l=c;"]"!==e.charAt(u++)&&u<e.length;)l+=e.charAt(u);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Hn)){if(null==i&&null==(i=yn(t,n)))return"";s[s.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Vn(e)||(s[s.length]={t:"t",v:l}));break;case".":if(null!=i){for(l=c;++u<e.length&&"0"===(c=e.charAt(u));)l+=c;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=c;++u<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(u))>-1;)l+=c;s[s.length]={t:"n",v:l};break;case"?":for(l=c;e.charAt(++u)===c;)l+=c;s[s.length]={t:c,v:l},d=c;break;case"*":++u," "!=e.charAt(u)&&"*"!=e.charAt(u)||++u;break;case"(":case")":s[s.length]={t:1===r?"t":c,v:c},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=c;u<e.length&&"0123456789".indexOf(e.charAt(++u))>-1;)l+=e.charAt(u);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:c,v:c},++u;break;case"$":s[s.length]={t:"t",v:"$"},++u;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(c))throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"t",v:c},++u}var g,m=0,y=0;for(u=s.length-1,d="t";u>=0;--u)switch(s[u].t){case"h":case"H":s[u].t=h,d="h",m<1&&(m=1);break;case"s":(g=s[u].v.match(/\.0+$/))&&(y=Math.max(y,g[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":d=s[u].t;break;case"m":"s"===d&&(s[u].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&s[u].v.match(/[Hh]/)&&(m=1),m<2&&s[u].v.match(/[Mm]/)&&(m=2),m<3&&s[u].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M)}var w,b="";for(u=0;u<s.length;++u)switch(s[u].t){case"t":case"T":case" ":case"D":break;case"X":s[u].v="",s[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[u].v=Tn(s[u].t.charCodeAt(0),s[u].v,i,y),s[u].t="t";break;case"n":case"?":for(w=u+1;null!=s[w]&&("?"===(c=s[w].t)||"D"===c||(" "===c||"t"===c)&&null!=s[w+1]&&("?"===s[w+1].t||"t"===s[w+1].t&&"/"===s[w+1].v)||"("===s[u].t&&(" "===c||"n"===c||")"===c)||"t"===c&&("/"===s[w].v||" "===s[w].v&&null!=s[w+1]&&"?"==s[w+1].t));)s[u].v+=s[w].v,s[w]={v:"",t:";"},++w;b+=s[u].v,u=w-1;break;case"G":s[u].t="t",s[u].v=xn(t,n)}var C,S,E="";if(b.length>0){40==b.charCodeAt(0)?(C=t<0&&45===b.charCodeAt(0)?-t:t,S=jn("n",b,C)):(S=jn("n",b,C=t<0&&r>1?-t:t),C<0&&s[0]&&"t"==s[0].t&&(S=S.substr(1),s[0].v="-"+s[0].v)),w=S.length-1;var k=s.length;for(u=0;u<s.length;++u)if(null!=s[u]&&"t"!=s[u].t&&s[u].v.indexOf(".")>-1){k=u;break}var x=s.length;if(k===s.length&&-1===S.indexOf("E")){for(u=s.length-1;u>=0;--u)null!=s[u]&&-1!=="n?".indexOf(s[u].t)&&(w>=s[u].v.length-1?(w-=s[u].v.length,s[u].v=S.substr(w+1,s[u].v.length)):w<0?s[u].v="":(s[u].v=S.substr(0,w+1),w=-1),s[u].t="t",x=u);w>=0&&x<s.length&&(s[x].v=S.substr(0,w+1)+s[x].v)}else if(k!==s.length&&-1===S.indexOf("E")){for(w=S.indexOf(".")-1,u=k;u>=0;--u)if(null!=s[u]&&-1!=="n?".indexOf(s[u].t)){for(o=s[u].v.indexOf(".")>-1&&u===k?s[u].v.indexOf(".")-1:s[u].v.length-1,E=s[u].v.substr(o+1);o>=0;--o)w>=0&&("0"===s[u].v.charAt(o)||"#"===s[u].v.charAt(o))&&(E=S.charAt(w--)+E);s[u].v=E,s[u].t="t",x=u}for(w>=0&&x<s.length&&(s[x].v=S.substr(0,w+1)+s[x].v),w=S.indexOf(".")+1,u=k;u<s.length;++u)if(null!=s[u]&&(-1!=="n?(".indexOf(s[u].t)||u===k)){for(o=s[u].v.indexOf(".")>-1&&u===k?s[u].v.indexOf(".")+1:0,E=s[u].v.substr(0,o);o<s[u].v.length;++o)w<S.length&&(E+=S.charAt(w++));s[u].v=E,s[u].t="t",x=u}}}for(u=0;u<s.length;++u)null!=s[u]&&"n?".indexOf(s[u].t)>-1&&(C=r>1&&t<0&&u>0&&"-"===s[u-1].v?-t:t,s[u].v=jn(s[u].t,s[u].v,C),s[u].t="t");var T="";for(u=0;u!==s.length;++u)null!=s[u]&&(T+=s[u].v);return T}(i[1],t,n,i[0])}function qn(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=pn[n]){if(pn[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return pn[t]=e,t}function Xn(e){for(var t=0;392!=t;++t)void 0!==e[t]&&qn(e[t],t)}function Yn(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',pn=e}var Qn={format:Kn,load:qn,_table:pn,load_table:Xn,parse_date_code:yn,is_date:Vn,get_table:function(){return Qn._table=pn}},Zn={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Jn=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var $n=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,i="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)i[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=i[t]=n>>>8^e[255&n];var o=[];for(r=1;16!=r;++r)o[r-1]="undefined"!==typeof Int32Array?i.subarray(256*r,256*r+256):i.slice(256*r,256*r+256);return o}(t),r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],l=n[5],u=n[6],c=n[7],d=n[8],h=n[9],f=n[10],p=n[11],v=n[12],g=n[13],m=n[14];return e.table=t,e.bstr=function(e,n){for(var r=-1^n,i=0,o=e.length;i<o;)r=r>>>8^t[255&(r^e.charCodeAt(i++))];return~r},e.buf=function(e,n){for(var y=-1^n,w=e.length-15,b=0;b<w;)y=m[e[b++]^255&y]^g[e[b++]^y>>8&255]^v[e[b++]^y>>16&255]^p[e[b++]^y>>>24]^f[e[b++]]^h[e[b++]]^d[e[b++]]^c[e[b++]]^u[e[b++]]^l[e[b++]]^s[e[b++]]^a[e[b++]]^o[e[b++]]^i[e[b++]]^r[e[b++]]^t[e[b++]];for(w+=15;b<w;)y=y>>>8^t[255&(y^e[b++])];return~y},e.str=function(e,n){for(var r=-1^n,i=0,o=e.length,a=0,s=0;i<o;)(a=e.charCodeAt(i++))<128?r=r>>>8^t[255&(r^a)]:a<2048?r=(r=r>>>8^t[255&(r^(192|a>>6&31))])>>>8^t[255&(r^(128|63&a))]:a>=55296&&a<57344?(a=64+(1023&a),s=1023&e.charCodeAt(i++),r=(r=(r=(r=r>>>8^t[255&(r^(240|a>>8&7))])>>>8^t[255&(r^(128|a>>2&63))])>>>8^t[255&(r^(128|s>>6&15|(3&a)<<4))])>>>8^t[255&(r^(128|63&s))]):r=(r=(r=r>>>8^t[255&(r^(224|a>>12&15))])>>>8^t[255&(r^(128|a>>6&63))])>>>8^t[255&(r^(128|63&a))];return~r},e}(),er=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function i(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function o(e){oo(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),i=e.read_shift(2),o=e.l+i,a={};if(21589===r)1&(n=e.read_shift(1))&&(a.mtime=e.read_shift(4)),i>5&&(2&n&&(a.atime=e.read_shift(4)),4&n&&(a.ctime=e.read_shift(4))),a.mtime&&(a.mt=new Date(1e3*a.mtime));e.l=o,t[r]=a}return t}function a(){return e||(e={})}function s(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=S(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(qt&&Buffer.isBuffer(e)?e.toString("binary"):S(e)).split("\r\n"),i=0,o="";for(i=0;i<r.length;++i)if(o=r[i],/^Content-Location:/i.test(o)&&(o=o.slice(o.indexOf("file")),n||(n=o.slice(0,o.lastIndexOf("/")+1)),o.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),o.slice(0,n.length)!=n););var a=(r[1]||"").match(/boundary="(.*?)"/);if(!a)throw new Error("MAD cannot find boundary");var s="--"+(a[1]||""),l=[],u=[],c={FileIndex:l,FullPaths:u};h(c);var d,f=0;for(i=0;i<r.length;++i){var p=r[i];p!==s&&p!==s+"--"||(f++&&ue(c,r.slice(d,i),n),d=i)}return c}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,i,o,a,s,f=512,p=[],v=e.slice(0,512);oo(v,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(v);switch(n=g[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==g[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==f&&oo(v=e.slice(0,f),28);var w=e.slice(0,f);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(v,n);var b=v.read_shift(4,"i");if(3===n&&0!==b)throw new Error("# Directory Sectors: Expected 0 saw "+b);v.l+=4,o=v.read_shift(4,"i"),v.l+=4,v.chk("00100000","Mini Stream Cutoff Size: "),a=v.read_shift(4,"i"),r=v.read_shift(4,"i"),s=v.read_shift(4,"i"),i=v.read_shift(4,"i");for(var C=-1,E=0;E<109&&!((C=v.read_shift(4,"i"))<0);++E)p[E]=C;var k=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],i=1;i<n;++i)r[i-1]=e.slice(i*t,(i+1)*t);return r[n-1]=e.slice(n*t),r}(e,f);u(s,i,k,f,p);var x=function(e,t,n,r){var i=e.length,o=[],a=[],s=[],l=[],u=r-1,c=0,d=0,h=0,f=0;for(c=0;c<i;++c)if(s=[],(h=c+t)>=i&&(h-=i),!a[h]){l=[];var p=[];for(d=h;d>=0;){p[d]=!0,a[d]=!0,s[s.length]=d,l.push(e[d]);var v=n[Math.floor(4*d/r)];if(r<4+(f=4*d&u))throw new Error("FAT boundary crossed: "+d+" 4 "+r);if(!e[v])break;if(p[d=Zi(e[v],f)])break}o[h]={nodes:s,data:Ti([l])}}return o}(k,o,p,f);x[o].name="!Directory",r>0&&a!==m&&(x[a].name="!MiniFAT"),x[p[0]].name="!FAT",x.fat_addrs=p,x.ssz=f;var T=[],R=[],A=[];!function(e,t,n,r,i,o,a,s){for(var u,h=0,f=r.length?2:0,p=t[e].data,v=0,g=0;v<p.length;v+=128){var y=p.slice(v,v+128);oo(y,64),g=y.read_shift(2),u=Ai(y,0,g-f),r.push(u);var w={name:u,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(w.ct=d(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(w.mt=d(y,y.l-8)),w.start=y.read_shift(4,"i"),w.size=y.read_shift(4,"i"),w.size<0&&w.start<0&&(w.size=w.type=0,w.start=m,w.name=""),5===w.type?(h=w.start,i>0&&h!==m&&(t[h].name="!StreamData")):w.size>=4096?(w.storage="fat",void 0===t[w.start]&&(t[w.start]=c(n,w.start,t.fat_addrs,t.ssz)),t[w.start].name=w.name,w.content=t[w.start].data.slice(0,w.size)):(w.storage="minifat",w.size<0?w.size=0:h!==m&&w.start!==m&&t[h]&&(w.content=l(w,t[h].data,(t[s]||{}).data))),w.content&&oo(w.content,0),o[u]=w,a.push(w)}}(o,x,k,T,r,{},R,a),function(e,t,n){for(var r=0,i=0,o=0,a=0,s=0,l=n.length,u=[],c=[];r<l;++r)u[r]=c[r]=r,t[r]=n[r];for(;s<c.length;++s)i=e[r=c[s]].L,o=e[r].R,a=e[r].C,u[r]===r&&(-1!==i&&u[i]!==i&&(u[r]=u[i]),-1!==o&&u[o]!==o&&(u[r]=u[o])),-1!==a&&(u[a]=r),-1!==i&&r!=u[r]&&(u[i]=u[r],c.lastIndexOf(i)<s&&c.push(i)),-1!==o&&r!=u[r]&&(u[o]=u[r],c.lastIndexOf(o)<s&&c.push(o));for(r=1;r<l;++r)u[r]===r&&(-1!==o&&u[o]!==o?u[r]=u[o]:-1!==i&&u[i]!==i&&(u[r]=u[i]));for(r=1;r<l;++r)if(0!==e[r].type){if((s=r)!=u[s])do{s=u[s],t[r]=t[s]+"/"+t[r]}while(0!==s&&-1!==u[s]&&s!=u[s]);u[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(R,A,T),T.shift();var _={FileIndex:R,FullPaths:A};return t&&t.raw&&(_.raw={header:w,sectors:k}),_}function l(e,t,n){for(var r=e.start,i=e.size,o=[],a=r;n&&i>0&&a>=0;)o.push(t.slice(a*g,a*g+g)),i-=g,a=Zi(n,4*a);return 0===o.length?so(0):tn(o).slice(0,e.size)}function u(e,t,n,r,i){var o=m;if(e===m){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var a=n[e],s=(r>>>2)-1;if(!a)return;for(var l=0;l<s&&(o=Zi(a,4*l))!==m;++l)i.push(o);u(Zi(a,r-4),t-1,n,r,i)}}function c(e,t,n,r,i){var o=[],a=[];i||(i=[]);var s=r-1,l=0,u=0;for(l=t;l>=0;){i[l]=!0,o[o.length]=l,a.push(e[l]);var c=n[Math.floor(4*l/r)];if(r<4+(u=4*l&s))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[c])break;l=Zi(e[c],u)}return{nodes:o,data:Ti([a])}}function d(e,t){return new Date(1e3*(Qi(e,t+4)/1e7*Math.pow(2,32)+Qi(e,t)/1e7-11644473600))}function h(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(er.find(e,"/"+t))return;var n=so(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var i=!1,o=!1,a=e.FullPaths.length-1;a>=0;--a){var s=e.FileIndex[a];switch(s.type){case 0:o?i=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:o=!0,isNaN(s.R*s.L*s.C)&&(i=!0),s.R>-1&&s.L>-1&&s.R==s.L&&(i=!0);break;default:i=!0}}if(i||t){var l=new Date(1987,1,19),u=0,c=Object.create?Object.create(null):{},d=[];for(a=0;a<e.FullPaths.length;++a)c[e.FullPaths[a]]=!0,0!==e.FileIndex[a].type&&d.push([e.FullPaths[a],e.FileIndex[a]]);for(a=0;a<d.length;++a){var f=n(d[a][0]);(o=c[f])||(d.push([f,{name:r(f).replace("/",""),type:1,clsid:b,ct:l,mt:l,content:null}]),c[f]=!0)}for(d.sort((function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0,o=0,a=Math.min(n.length,r.length);i<a;++i){if(o=n[i].length-r[i].length)return o;if(n[i]!=r[i])return n[i]<r[i]?-1:1}return n.length-r.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],a=0;a<d.length;++a)e.FullPaths[a]=d[a][0],e.FileIndex[a]=d[a][1];for(a=0;a<d.length;++a){var p=e.FileIndex[a],v=e.FullPaths[a];if(p.name=r(v).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||b,0===a)p.C=d.length>1?1:-1,p.size=0,p.type=5;else if("/"==v.slice(-1)){for(u=a+1;u<d.length&&n(e.FullPaths[u])!=v;++u);for(p.C=u>=d.length?-1:u,u=a+1;u<d.length&&n(e.FullPaths[u])!=n(v);++u);p.R=u>=d.length?-1:u,p.type=1}else n(e.FullPaths[a+1]||"")==n(v)&&(p.R=a+1),p.type=2}}}function p(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",i=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],o=e.FullPaths[0],a=o,s=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(a=e.FullPaths[l].slice(o.length),(s=e.FileIndex[l]).size&&s.content&&"\x01Sh33tJ5"!=a){a=a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var u=s.content,c=qt&&Buffer.isBuffer(u)?u.toString("binary"):S(u),d=0,h=Math.min(1024,c.length),f=0,p=0;p<=h;++p)(f=c.charCodeAt(p))>=32&&f<128&&++d;var v=d>=4*h/5;i.push(r),i.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+a),i.push("Content-Transfer-Encoding: "+(v?"quoted-printable":"base64")),i.push("Content-Type: "+ae(s,a)),i.push(""),i.push(v?le(c):se(c))}return i.push(r+"--\r\n"),i.join("\r\n")}(e,n);if(f(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],o=[],a=so(1),s=n.compression?8:0,l=0;0;var u=0,c=0,d=0,h=0,f=e.FullPaths[0],p=f,v=e.FileIndex[0],g=[],m=0;for(u=1;u<e.FullPaths.length;++u)if(p=e.FullPaths[u].slice(f.length),(v=e.FileIndex[u]).size&&v.content&&"\x01Sh33tJ5"!=p){var y=d,w=so(p.length);for(c=0;c<p.length;++c)w.write_shift(1,127&p.charCodeAt(c));w=w.slice(0,w.l),g[h]=$n.buf(v.content,0);var b=v.content;8==s&&(b=E(b)),(a=so(30)).write_shift(4,67324752),a.write_shift(2,20),a.write_shift(2,l),a.write_shift(2,s),v.mt?i(a,v.mt):a.write_shift(4,0),a.write_shift(-4,8&l?0:g[h]),a.write_shift(4,8&l?0:b.length),a.write_shift(4,8&l?0:v.content.length),a.write_shift(2,w.length),a.write_shift(2,0),d+=a.length,r.push(a),d+=w.length,r.push(w),d+=b.length,r.push(b),8&l&&((a=so(12)).write_shift(-4,g[h]),a.write_shift(4,b.length),a.write_shift(4,v.content.length),d+=a.l,r.push(a)),(a=so(46)).write_shift(4,33639248),a.write_shift(2,0),a.write_shift(2,20),a.write_shift(2,l),a.write_shift(2,s),a.write_shift(4,0),a.write_shift(-4,g[h]),a.write_shift(4,b.length),a.write_shift(4,v.content.length),a.write_shift(2,w.length),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a.write_shift(4,y),m+=a.l,o.push(a),m+=w.length,o.push(w),++h}return a=so(22),a.write_shift(4,101010256),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,h),a.write_shift(2,h),a.write_shift(4,m),a.write_shift(4,d),a.write_shift(2,0),tn([tn(r),tn(o),a])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var i=e.FileIndex[r];if(i.content){var o=i.content.length;o>0&&(o<4096?t+=o+63>>6:n+=o+511>>9)}}for(var a=e.FullPaths.length+3>>2,s=t+127>>7,l=(t+7>>3)+n+a+s,u=l+127>>7,c=u<=109?0:Math.ceil((u-109)/127);l+u+c+127>>7>u;)c=++u<=109?0:Math.ceil((u-109)/127);var d=[1,c,u,s,a,n,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),o=so(r[7]<<9),a=0,s=0;for(a=0;a<8;++a)o.write_shift(1,w[a]);for(a=0;a<8;++a)o.write_shift(2,0);for(o.write_shift(2,62),o.write_shift(2,3),o.write_shift(2,65534),o.write_shift(2,9),o.write_shift(2,6),a=0;a<3;++a)o.write_shift(2,0);for(o.write_shift(4,0),o.write_shift(4,r[2]),o.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),o.write_shift(4,0),o.write_shift(4,4096),o.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:m),o.write_shift(4,r[3]),o.write_shift(-4,r[1]?r[0]-1:m),o.write_shift(4,r[1]),a=0;a<109;++a)o.write_shift(-4,a<r[2]?r[1]+a:-1);if(r[1])for(s=0;s<r[1];++s){for(;a<236+127*s;++a)o.write_shift(-4,a<r[2]?r[1]+a:-1);o.write_shift(-4,s===r[1]-1?m:s+1)}var l=function(e){for(s+=e;a<s-1;++a)o.write_shift(-4,a+1);e&&(++a,o.write_shift(-4,m))};for(s=a=0,s+=r[1];a<s;++a)o.write_shift(-4,C.DIFSECT);for(s+=r[2];a<s;++a)o.write_shift(-4,C.FATSECT);l(r[3]),l(r[4]);for(var u=0,c=0,d=e.FileIndex[0];u<e.FileIndex.length;++u)(d=e.FileIndex[u]).content&&((c=d.content.length)<4096||(d.start=s,l(c+511>>9)));for(l(r[6]+7>>3);511&o.l;)o.write_shift(-4,C.ENDOFCHAIN);for(s=a=0,u=0;u<e.FileIndex.length;++u)(d=e.FileIndex[u]).content&&(!(c=d.content.length)||c>=4096||(d.start=s,l(c+63>>6)));for(;511&o.l;)o.write_shift(-4,C.ENDOFCHAIN);for(a=0;a<r[4]<<2;++a){var h=e.FullPaths[a];if(h&&0!==h.length){d=e.FileIndex[a],0===a&&(d.start=d.size?d.start-1:m);var p=0===a&&n.root||d.name;if(c=2*(p.length+1),o.write_shift(64,p,"utf16le"),o.write_shift(2,c),o.write_shift(1,d.type),o.write_shift(1,d.color),o.write_shift(-4,d.L),o.write_shift(-4,d.R),o.write_shift(-4,d.C),d.clsid)o.write_shift(16,d.clsid,"hex");else for(u=0;u<4;++u)o.write_shift(4,0);o.write_shift(4,d.state||0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,d.start),o.write_shift(4,d.size),o.write_shift(4,0)}else{for(u=0;u<17;++u)o.write_shift(4,0);for(u=0;u<3;++u)o.write_shift(4,-1);for(u=0;u<12;++u)o.write_shift(4,0)}}for(a=1;a<e.FileIndex.length;++a)if((d=e.FileIndex[a]).size>=4096)if(o.l=d.start+1<<9,qt&&Buffer.isBuffer(d.content))d.content.copy(o,o.l,0,d.size),o.l+=d.size+511&-512;else{for(u=0;u<d.size;++u)o.write_shift(1,d.content[u]);for(;511&u;++u)o.write_shift(1,0)}for(a=1;a<e.FileIndex.length;++a)if((d=e.FileIndex[a]).size>0&&d.size<4096)if(qt&&Buffer.isBuffer(d.content))d.content.copy(o,o.l,0,d.size),o.l+=d.size+63&-64;else{for(u=0;u<d.size;++u)o.write_shift(1,d.content[u]);for(;63&u;++u)o.write_shift(1,0)}if(qt)o.l=o.length;else for(;o.l<o.length;)o.write_shift(1,0);return o}t.version="1.2.1";var v,g=64,m=-2,y="d0cf11e0a1b11ae1",w=[208,207,17,224,161,177,26,225],b="00000000000000000000000000000000",C={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:m,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:b,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function S(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function E(e){return v?v.deflateRawSync(e):X(e)}var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function R(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var A="undefined"!==typeof Uint8Array,_=A?new Uint8Array(256):[],O=0;O<256;++O)_[O]=R(O);function D(e,t){var n=_[255&e];return t<=8?n>>>8-t:(n=n<<8|_[e>>8&255],t<=16?n>>>16-t:(n=n<<8|_[e>>16&255])>>>24-t)}function N(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function P(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function F(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function I(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function L(e,t,n){var r=7&t,i=t>>>3,o=(1<<n)-1,a=e[i]>>>r;return n<8-r?a&o:(a|=e[i+1]<<8-r,n<16-r?a&o:(a|=e[i+2]<<16-r,n<24-r?a&o:(a|=e[i+3]<<24-r)&o))}function M(e,t,n){var r=7&t,i=t>>>3;return r<=5?e[i]|=(7&n)<<r:(e[i]|=n<<r&255,e[i+1]=(7&n)>>8-r),t+3}function G(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function B(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function j(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function H(e,t){var n=e.length,r=2*n>t?2*n:t+5,i=0;if(n>=t)return e;if(qt){var o=Qt(r);if(e.copy)e.copy(o);else for(;i<e.length;++i)o[i]=e[i];return o}if(A){var a=new Uint8Array(r);if(a.set)a.set(e);else for(;i<n;++i)a[i]=e[i];return a}return e.length=r,e}function V(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function W(e,t,n){var r=1,i=0,o=0,a=0,s=0,l=e.length,u=A?new Uint16Array(32):V(32);for(o=0;o<32;++o)u[o]=0;for(o=l;o<n;++o)e[o]=0;l=e.length;var c=A?new Uint16Array(l):V(l);for(o=0;o<l;++o)u[i=e[o]]++,r<i&&(r=i),c[o]=0;for(u[0]=0,o=1;o<=r;++o)u[o+16]=s=s+u[o-1]<<1;for(o=0;o<l;++o)0!=(s=e[o])&&(c[o]=u[s+16]++);var d=0;for(o=0;o<l;++o)if(0!=(d=e[o]))for(s=D(c[o],r)>>r-d,a=(1<<r+4-d)-1;a>=0;--a)t[s|a<<d]=15&d|o<<4;return r}var z=A?new Uint16Array(512):V(512),U=A?new Uint16Array(32):V(32);if(!A){for(var K=0;K<512;++K)z[K]=0;for(K=0;K<32;++K)U[K]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);W(e,U,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);W(n,z,288)}();var q=function(){for(var e=A?new Uint8Array(32768):[],t=0,n=0;t<T.length-1;++t)for(;n<T[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=A?new Uint8Array(259):[];for(t=0,n=0;t<x.length-1;++t)for(;n<x[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),i=n+r==e.length;for(t.write_shift(1,+i),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var i=0,o=0,a=A?new Uint16Array(32768):[];o<t.length;){var s=Math.min(65535,t.length-o);if(s<10){for(7&(i=M(n,i,+!(o+s!=t.length)))&&(i+=8-(7&i)),n.l=i/8|0,n.write_shift(2,s),n.write_shift(2,65535&~s);s-- >0;)n[n.l++]=t[o++];i=8*n.l}else{i=M(n,i,+!(o+s!=t.length)+2);for(var l=0;s-- >0;){var u=t[o],c=-1,d=0;if((c=a[l=32767&(l<<5^u)])&&((c|=-32768&o)>o&&(c-=32768),c<o))for(;t[c+d]==t[o+d]&&d<250;)++d;if(d>2){(u=r[d])<=22?i=B(n,i,_[u+1]>>1)-1:(B(n,i,3),B(n,i+=5,_[u-23]>>5),i+=3);var h=u<8?0:u-4>>2;h>0&&(j(n,i,d-x[u]),i+=h),u=e[o-c],i=B(n,i,_[u]>>3),i-=3;var f=u<4?0:u-2>>1;f>0&&(j(n,i,o-c-T[u]),i+=f);for(var p=0;p<d;++p)a[l]=32767&o,l=32767&(l<<5^t[o]),++o;s-=d-1}else u<=143?u+=48:i=G(n,i,1),i=B(n,i,_[u]),a[l]=32767&o,++o}i=B(n,i,0)-1}}return n.l=(i+7)/8|0,n.l}(t,n)}}();function X(e){var t=so(50+Math.floor(1.1*e.length)),n=q(e,t);return t.slice(0,n)}var Y=A?new Uint16Array(32768):V(32768),Q=A?new Uint16Array(32768):V(32768),Z=A?new Uint16Array(128):V(128),J=1,$=1;function ee(e,t){var n=F(e,t)+257,r=F(e,t+=5)+1,i=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var o=0,a=A?new Uint8Array(19):V(19),s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,u=A?new Uint8Array(8):V(8),c=A?new Uint8Array(8):V(8),d=a.length,h=0;h<i;++h)a[k[h]]=o=P(e,t),l<o&&(l=o),u[o]++,t+=3;var f=0;for(u[0]=0,h=1;h<=l;++h)c[h]=f=f+u[h-1]<<1;for(h=0;h<d;++h)0!=(f=a[h])&&(s[h]=c[f]++);var p=0;for(h=0;h<d;++h)if(0!=(p=a[h])){f=_[s[h]]>>8-p;for(var v=(1<<7-p)-1;v>=0;--v)Z[f|v<<p]=7&p|h<<3}var g=[];for(l=1;g.length<n+r;)switch(t+=7&(f=Z[I(e,t)]),f>>>=3){case 16:for(o=3+N(e,t),t+=2,f=g[g.length-1];o-- >0;)g.push(f);break;case 17:for(o=3+P(e,t),t+=3;o-- >0;)g.push(0);break;case 18:for(o=11+I(e,t),t+=7;o-- >0;)g.push(0);break;default:g.push(f),l<f&&(l=f)}var m=g.slice(0,n),y=g.slice(n);for(h=n;h<286;++h)m[h]=0;for(h=r;h<30;++h)y[h]=0;return J=W(m,Y,286),$=W(y,Q,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[Yt(t),2];for(var n=0,r=0,i=Qt(t||1<<18),o=0,a=i.length>>>0,s=0,l=0;0==(1&r);)if(r=P(e,n),n+=3,r>>>1!=0)for(r>>1==1?(s=9,l=5):(n=ee(e,n),s=J,l=$);;){!t&&a<o+32767&&(a=(i=H(i,o+32767)).length);var u=L(e,n,s),c=r>>>1==1?z[u]:Y[u];if(n+=15&c,0===((c>>>=4)>>>8&255))i[o++]=c;else{if(256==c)break;var d=(c-=257)<8?0:c-4>>2;d>5&&(d=0);var h=o+x[c];d>0&&(h+=L(e,n,d),n+=d),u=L(e,n,l),n+=15&(c=r>>>1==1?U[u]:Q[u]);var f=(c>>>=4)<4?0:c-2>>1,p=T[c];for(f>0&&(p+=L(e,n,f),n+=f),!t&&a<h&&(a=(i=H(i,h+100)).length);o<h;)i[o]=i[o-p],++o}}else{7&n&&(n+=8-(7&n));var v=e[n>>>3]|e[1+(n>>>3)]<<8;if(n+=32,v>0)for(!t&&a<o+v&&(a=(i=H(i,o+v)).length);v-- >0;)i[o++]=e[n>>>3],n+=8}return t?[i,n+7>>>3]:[i.slice(0,o),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;oo(n,0);var r={FileIndex:[],FullPaths:[]};h(r,{root:t.root});for(var i=n.length-4;(80!=n[i]||75!=n[i+1]||5!=n[i+2]||6!=n[i+3])&&i>=0;)--i;n.l=i+4,n.l+=4;var a=n.read_shift(2);n.l+=6;var s=n.read_shift(4);for(n.l=s,i=0;i<a;++i){n.l+=20;var l=n.read_shift(4),u=n.read_shift(4),c=n.read_shift(2),d=n.read_shift(2),f=n.read_shift(2);n.l+=8;var p=n.read_shift(4),v=o(n.slice(n.l+c,n.l+c+d));n.l+=c+d+f;var g=n.l;n.l=p+4,ie(n,l,u,r,v),n.l=g}return r}function ie(e,t,n,r,i){e.l+=2;var a=e.read_shift(2),s=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,i=31&n,o=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(o-1),r.setDate(i);var a=31&t,s=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(s),r.setSeconds(a<<1),r}(e);if(8257&a)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var u=e.read_shift(4),c=e.read_shift(4),d=e.read_shift(2),h=e.read_shift(2),f="",p=0;p<d;++p)f+=String.fromCharCode(e[e.l++]);if(h){var g=o(e.slice(e.l,e.l+h));(g[21589]||{}).mt&&(l=g[21589].mt),((i||{})[21589]||{}).mt&&(l=i[21589].mt)}e.l+=h;var m=e.slice(e.l,e.l+u);switch(s){case 8:m=function(e,t){if(!v)return te(e,t);var n=new(0,v.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,c);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+s)}var y=!1;8&a&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),u=e.read_shift(4),c=e.read_shift(4)),u!=t&&ne(y,"Bad compressed size: "+t+" != "+u),c!=n&&ne(y,"Bad uncompressed size: "+n+" != "+c),ce(r,f,m,{unsafe:!0,mt:l})}var oe={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ae(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&oe[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&oe[r[1]]?oe[r[1]]:"application/octet-stream"}function se(e){for(var t=Ut(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),i=0;i<r.length;++i){var o=r[i];if(0!=o.length)for(var a=0;a<o.length;){var s=76,l=o.slice(a,a+s);"="==l.charAt(s-1)?s--:"="==l.charAt(s-2)?s-=2:"="==l.charAt(s-3)&&(s-=3),l=o.slice(a,a+s),(a+=s)<o.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ue(e,t,n){for(var r,i="",o="",a="",s=0;s<10;++s){var l=t[s];if(!l||l.match(/^\s*$/))break;var u=l.match(/^(.*?):\s*([^\s].*)$/);if(u)switch(u[1].toLowerCase()){case"content-location":i=u[2].trim();break;case"content-type":a=u[2].trim();break;case"content-transfer-encoding":o=u[2].trim()}}switch(++s,o.toLowerCase()){case"base64":r=Zt(Kt(t.slice(s).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var i=0;i<t.length;++i)t[i]=t[i].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return Zt(t.join("\r\n"))}(t.slice(s));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+o)}var c=ce(e,i.slice(n.length),r,{unsafe:!0});a&&(c.ctype=a)}function ce(e,t,n,i){var o=i&&i.unsafe;o||h(e);var a=!o&&er.find(e,t);if(!a){var s=e.FullPaths[0];t.slice(0,s.length)==s?s=t:("/"!=s.slice(-1)&&(s+="/"),s=(s+t).replace("//","/")),a={name:r(t),type:2},e.FileIndex.push(a),e.FullPaths.push(s),o||er.utils.cfb_gc(e)}return a.content=n,a.size=n?n.length:0,i&&(i.CLSID&&(a.clsid=i.CLSID),i.mt&&(a.mt=i.mt),i.ct&&(a.ct=i.ct)),a}return t.find=function(e,t){var n=e.FullPaths.map((function(e){return e.toUpperCase()})),r=n.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),i=!1;47===t.charCodeAt(0)?(i=!0,t=n[0].slice(0,-1)+t):i=-1!==t.indexOf("/");var o=t.toUpperCase(),a=!0===i?n.indexOf(o):r.indexOf(o);if(-1!==a)return e.FileIndex[a];var s=!o.match(rn);for(o=o.replace(nn,""),s&&(o=o.replace(rn,"!")),a=0;a<n.length;++a){if((s?n[a].replace(rn,"!"):n[a]).replace(nn,"")==o)return e.FileIndex[a];if((s?r[a].replace(rn,"!"):r[a]).replace(nn,"")==o)return e.FileIndex[a]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||qt&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return a(),s(e.readFileSync(t),n)}(t,n);case"base64":return s(Zt(Kt(t)),n);case"binary":return s(Zt(t),n)}return s(t,n)},t.parse=s,t.write=function(t,n){var r=p(t,n);switch(n&&n.type||"buffer"){case"file":return a(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:S(r);case"base64":return Ut("string"==typeof r?r:S(r));case"buffer":if(qt)return Buffer.isBuffer(r)?r:Xt(r);case"array":return"string"==typeof r?Zt(r):r}return r},t.writeFile=function(t,n,r){a();var i=p(t,r);e.writeFileSync(n,i)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:ce,cfb_del:function(e,t){h(e);var n=er.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){h(e);var i=er.find(e,t);if(i)for(var o=0;o<e.FileIndex.length;++o)if(e.FileIndex[o]==i)return e.FileIndex[o].name=r(n),e.FullPaths[o]=n,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:$i,CheckField:io,prep_blob:oo,bconcat:tn,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");v=e}catch(n){console.error("cannot use native zlib: "+(n.message||n))}},_deflateRaw:X,_inflateRaw:te,consts:C},t}(),tr=void 0;function nr(e){return"string"===typeof e?Jt(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function rr(e,t,n){if("undefined"!==typeof tr&&tr.writeFileSync)return n?tr.writeFileSync(e,t,n):tr.writeFileSync(e,t);if("undefined"!==typeof Deno){if(n&&"string"==typeof t)switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Jt(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r="utf8"==n?li(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var i=new Blob([nr(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if("undefined"!==typeof saveAs)return saveAs(i,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(i);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(o)}),6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var a=document.createElement("a");if(null!=a.download)return a.download=e,a.href=o,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(o)}),6e4),o}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var s=File(e);return s.open("w"),s.encoding="binary",Array.isArray(t)&&(t=$t(t)),s.write(t),s.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function ir(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function or(e,t){for(var n=[],r=ir(e),i=0;i!==r.length;++i)null==n[e[r[i]][t]]&&(n[e[r[i]][t]]=r[i]);return n}function ar(e){for(var t=[],n=ir(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function sr(e){for(var t=[],n=ir(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var lr=new Date(1899,11,30,0,0,0);function ur(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(lr.getTime()+6e4*(e.getTimezoneOffset()-lr.getTimezoneOffset())))/864e5}var cr=new Date,dr=lr.getTime()+6e4*(cr.getTimezoneOffset()-lr.getTimezoneOffset()),hr=cr.getTimezoneOffset();function fr(e){var t=new Date;return t.setTime(24*e*60*60*1e3+dr),t.getTimezoneOffset()!==hr&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-hr)),t}function pr(e){var t=0,n=0,r=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(n=1,o>3&&(r=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":n*=24;case"H":n*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");n*=60}t+=n*parseInt(i[o],10)}return t}var vr=new Date("2017-02-19T19:06:09.000Z"),gr=isNaN(vr.getFullYear())?new Date("2/19/17"):vr,mr=2017==gr.getFullYear();function yr(e,t){var n=new Date(e);if(mr)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==gr.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-60*o.getTimezoneOffset()*1e3)),o}function wr(e,t){if(qt&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return li(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return li(Gt(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return li(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return li(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return n[e]||e}))}catch(o){}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function br(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=br(e[n]));return t}function Cr(e,t){for(var n="";n.length<t;)n+=e;return n}function Sr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return n*=100,""}));return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,(function(e,t){return n=-n,t})),isNaN(t=Number(r))?t:t/n):t/n}var Er=["january","february","march","april","may","june","july","august","september","october","november","december"];function kr(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),o=t.getDate();if(isNaN(o))return n;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Er.indexOf(a))return n}else if(a.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||o>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}var xr=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,n,r){if(e||"string"==typeof n)return t.split(n);for(var i=t.split(n),o=[i[0]],a=1;a<i.length;++a)o.push(r),o.push(i[a]);return o}}();function Tr(e){return e?e.content&&e.type?wr(e.content,!0):e.data?jt(e.data):e.asNodeBuffer&&qt?jt(e.asNodeBuffer().toString("binary")):e.asBinary?jt(e.asBinary()):e._data&&e._data.getContent?jt(wr(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Rr(e){if(!e)return null;if(e.data)return Mt(e.data);if(e.asNodeBuffer&&qt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?Mt(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Ar(e,t){for(var n=e.FullPaths||ir(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),i=r.replace(/\\/g,"/"),o=0;o<n.length;++o){var a=n[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==a||i==a)return e.files?e.files[n[o]]:e.FileIndex[o]}return null}function _r(e,t){var n=Ar(e,t);if(null==n)throw new Error("Cannot find file "+t+" in zip");return n}function Or(e,t,n){if(!n)return function(e){return e&&".bin"===e.name.slice(-4)?Rr(e):Tr(e)}(_r(e,t));if(!t)return null;try{return Or(e,t)}catch(r){return null}}function Dr(e,t,n){if(!n)return Tr(_r(e,t));if(!t)return null;try{return Dr(e,t)}catch(r){return null}}function Nr(e,t,n){if(!n)return Rr(_r(e,t));if(!t)return null;try{return Nr(e,t)}catch(r){return null}}function Pr(e){for(var t=e.FullPaths||ir(e.files),n=[],r=0;r<t.length;++r)"/"!=t[r].slice(-1)&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function Fr(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=qt?Xt(n):function(e){for(var t=[],n=0,r=e.length+250,i=Yt(e.length+255),o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a<128)i[n++]=a;else if(a<2048)i[n++]=192|a>>6&31,i[n++]=128|63&a;else if(a>=55296&&a<57344){a=64+(1023&a);var s=1023&e.charCodeAt(++o);i[n++]=240|a>>8&7,i[n++]=128|a>>2&63,i[n++]=128|s>>6&15|(3&a)<<4,i[n++]=128|63&s}else i[n++]=224|a>>12&15,i[n++]=128|a>>6&63,i[n++]=128|63&a;n>r&&(t.push(i.slice(0,n)),n=0,i=Yt(65535),r=65530)}return t.push(i.slice(0,n)),tn(t)}(n),er.utils.cfb_add(e,t,r);er.utils.cfb_add(e,t,n)}else e.file(t,n)}function Ir(){return er.utils.cfb_new()}function Lr(e,t){switch(t.type){case"base64":return er.read(e,{type:"base64"});case"binary":return er.read(e,{type:"binary"});case"buffer":case"array":return er.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Mr(e,t){if("/"==e.charAt(0))return e.slice(1);var n=t.split("/");"/"!=t.slice(-1)&&n.pop();for(var r=e.split("/");0!==r.length;){var i=r.shift();".."===i?n.pop():"."!==i&&n.push(i)}return n.join("/")}var Gr='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Br=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,jr=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Hr=Gr.match(jr)?jr:/<[^>]*>/g,Vr=/<\w*:/,Wr=/<(\/?)\w+:/;function zr(e,t,n){for(var r={},i=0,o=0;i!==e.length&&(32!==(o=e.charCodeAt(i))&&10!==o&&13!==o);++i);if(t||(r[0]=e.slice(0,i)),i===e.length)return r;var a=e.match(Br),s=0,l="",u=0,c="",d="",h=1;if(a)for(u=0;u!=a.length;++u){for(d=a[u],o=0;o!=d.length&&61!==d.charCodeAt(o);++o);for(c=d.slice(0,o).trim();32==d.charCodeAt(o+1);)++o;for(h=34==(i=d.charCodeAt(o+1))||39==i?1:0,l=d.slice(o+1+h,d.length-h),s=0;s!=c.length&&58!==c.charCodeAt(s);++s);if(s===c.length)c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),r[c]=l,n||(r[c.toLowerCase()]=l);else{var f=(5===s&&"xmlns"===c.slice(0,5)?"xmlns":"")+c.slice(s+1);if(r[f]&&"ext"==c.slice(s-3,s))continue;r[f]=l,n||(r[f.toLowerCase()]=l)}}return r}function Ur(e){return e.replace(Wr,"<$1")}var Kr={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},qr=ar(Kr),Xr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function n(r){var i=r+"",o=i.indexOf("<![CDATA[");if(-1==o)return i.replace(e,(function(e,t){return Kr[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var a=i.indexOf("]]>");return n(i.slice(0,o))+i.slice(o+9,a)+n(i.slice(a+3))}}(),Yr=/[&<>'"]/g,Qr=/[\u0000-\u0008\u000b-\u001f]/g;function Zr(e){return(e+"").replace(Yr,(function(e){return qr[e]})).replace(Qr,(function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"}))}function Jr(e){return Zr(e).replace(/ /g,"_x0020_")}var $r=/[\u0000-\u001f]/g;function ei(e){return(e+"").replace(Yr,(function(e){return qr[e]})).replace(/\n/g,"<br/>").replace($r,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}var ti=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(n){return n.replace(e,t)}}();function ni(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ri(e){for(var t="",n=0,r=0,i=0,o=0,a=0,s=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(i=e.charCodeAt(n++),r>191&&r<224?(a=(31&r)<<6,a|=63&i,t+=String.fromCharCode(a)):(o=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&o):(s=((7&r)<<18|(63&i)<<12|(63&o)<<6|63&(a=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(1023&s)))));return t}function ii(e){var t,n,r,i=Yt(2*e.length),o=1,a=0,s=0;for(n=0;n<e.length;n+=o)o=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),o=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),o=3):(o=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(i[a++]=255&s,i[a++]=s>>>8,s=0),i[a++]=t%256,i[a++]=t>>>8;return i.slice(0,a).toString("ucs2")}function oi(e){return Xt(e,"binary").toString("utf8")}var ai="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",si=qt&&(oi(ai)==ri(ai)&&oi||ii(ai)==ri(ai)&&ii)||ri,li=qt?function(e){return Xt(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(63&i)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},ui=function(){var e={};return function(t,n){var r=t+"|"+(n||"");return e[r]?e[r]:e[r]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),ci=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}(),di=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),hi=/<\/?(?:vt:)?variant>/g,fi=/<(?:vt:)([^>]*)>([\s\S]*)</;function pi(e,t){var n=zr(e),r=e.match(di(n.baseType))||[],i=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return i}return r.forEach((function(e){var t=e.replace(hi,"").match(fi);t&&i.push({v:si(t[2]),t:t[1]})})),i}var vi=/(^\s|\s$|\n)/;function gi(e,t){return"<"+e+(t.match(vi)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function mi(e){return ir(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function yi(e,t,n){return"<"+e+(null!=n?mi(n):"")+(null!=t?(t.match(vi)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function wi(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function bi(e){if(qt&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return si($t(en(e)));throw new Error("Bad input format: expected Buffer or string")}var Ci=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Si={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ei=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ki={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};var xi=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,i=e[0][n].length;r<i;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},Ti=qt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:Xt(e)}))):xi(e)}:xi,Ri=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(Xi(e,i)));return r.join("").replace(nn,"")},Ai=qt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(nn,""):Ri(e,t,n)}:Ri,_i=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},Oi=qt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):_i(e,t,n)}:_i,Di=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(qi(e,i)));return r.join("")},Ni=qt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):Di(e,t,n)}:Di,Pi=function(e,t){var n=Qi(e,t);return n>0?Ni(e,t+4,t+4+n-1):""},Fi=Pi,Ii=function(e,t){var n=Qi(e,t);return n>0?Ni(e,t+4,t+4+n-1):""},Li=Ii,Mi=function(e,t){var n=2*Qi(e,t);return n>0?Ni(e,t+4,t+4+n-1):""},Gi=Mi,Bi=function(e,t){var n=Qi(e,t);return n>0?Ai(e,t+4,t+4+n):""},ji=Bi,Hi=function(e,t){var n=Qi(e,t);return n>0?Ni(e,t+4,t+4+n):""},Vi=Hi,Wi=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),i=15&e[t+6],o=5;o>=0;--o)i=256*i+e[t+o];return 2047==r?0==i?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}(e,t)},zi=Wi,Ui=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function Ki(){Ai=function(e,t,n){return Bt.utils.decode(1200,e.slice(t,n)).replace(nn,"")},Ni=function(e,t,n){return Bt.utils.decode(65001,e.slice(t,n))},Fi=function(e,t){var n=Qi(e,t);return n>0?Bt.utils.decode(Dt,e.slice(t+4,t+4+n-1)):""},Li=function(e,t){var n=Qi(e,t);return n>0?Bt.utils.decode(Ot,e.slice(t+4,t+4+n-1)):""},Gi=function(e,t){var n=2*Qi(e,t);return n>0?Bt.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},ji=function(e,t){var n=Qi(e,t);return n>0?Bt.utils.decode(1200,e.slice(t+4,t+4+n)):""},Vi=function(e,t){var n=Qi(e,t);return n>0?Bt.utils.decode(65001,e.slice(t+4,t+4+n)):""}}qt&&(Fi=function(e,t){if(!Buffer.isBuffer(e))return Pi(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Li=function(e,t){if(!Buffer.isBuffer(e))return Ii(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Gi=function(e,t){if(!Buffer.isBuffer(e))return Mi(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},ji=function(e,t){if(!Buffer.isBuffer(e))return Bi(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},Vi=function(e,t){if(!Buffer.isBuffer(e))return Hi(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},zi=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Wi(e,t)},Ui=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof Bt&&Ki();var qi=function(e,t){return e[t]},Xi=function(e,t){return 256*e[t+1]+e[t]},Yi=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},Qi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Zi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Ji=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function $i(e,t){var n,r,i,o,a,s,l="",u=[];switch(t){case"dbcs":if(s=this.l,qt&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(a=0;a<e;++a)l+=String.fromCharCode(Xi(this,s)),s+=2;e*=2;break;case"utf8":l=Ni(this,this.l,this.l+e);break;case"utf16le":e*=2,l=Ai(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof Bt)return $i.call(this,e,"dbcs");l=Bt.utils.decode(Ot,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=Fi(this,this.l),e=4+Qi(this,this.l);break;case"lpstr-cp":l=Li(this,this.l),e=4+Qi(this,this.l);break;case"lpwstr":l=Gi(this,this.l),e=4+2*Qi(this,this.l);break;case"lpp4":e=4+Qi(this,this.l),l=ji(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Qi(this,this.l),l=Vi(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(i=qi(this,this.l+e++));)u.push(Ht(i));l=u.join("");break;case"_wstr":for(e=0,l="";0!==(i=Xi(this,this.l+e));)u.push(Ht(i)),e+=2;e+=2,l=u.join("");break;case"dbcs-cont":for(l="",s=this.l,a=0;a<e;++a){if(this.lens&&-1!==this.lens.indexOf(s))return i=qi(this,s),this.l=s+1,o=$i.call(this,e-a,i?"dbcs-cont":"sbcs-cont"),u.join("")+o;u.push(Ht(Xi(this,s))),s+=2}l=u.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof Bt){l=Bt.utils.decode(Ot,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",s=this.l,a=0;a!=e;++a){if(this.lens&&-1!==this.lens.indexOf(s))return i=qi(this,s),this.l=s+1,o=$i.call(this,e-a,i?"dbcs-cont":"sbcs-cont"),u.join("")+o;u.push(Ht(qi(this,s))),s+=1}l=u.join("");break;default:switch(e){case 1:return n=qi(this,this.l),this.l++,n;case 2:return n=("i"===t?Yi:Xi)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?Zi:Ji)(this,this.l),this.l+=4,n):(r=Qi(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?zi(this,this.l):zi([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=Oi(this,this.l,e)}}return this.l+=e,l}var eo=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},to=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},no=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function ro(e,t,n){var r=0,i=0;if("dbcs"===n){for(i=0;i!=t.length;++i)no(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof Bt&&874==Dt)for(i=0;i!=t.length;++i){var o=Bt.utils.encode(Dt,t.charAt(i));this[this.l+i]=o[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=255&t.charCodeAt(i);r=t.length}else{if("hex"===n){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===n){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=255&s,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,eo(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,o=0,a=r?-t:t;isFinite(a)?0==a?i=o=0:(i=Math.floor(Math.log(a)/Math.LN2),o=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(t)?26985:0);for(var s=0;s<=5;++s,o/=256)e[n+s]=255&o;e[n+6]=(15&i)<<4|15&o,e[n+7]=i>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,to(this,t,this.l)}}return this.l+=r,this}function io(e,t){var n=Oi(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function oo(e,t){e.l=t,e.read_shift=$i,e.chk=io,e.write_shift=ro}function ao(e,t){e.l+=t}function so(e){var t=Yt(e);return oo(t,0),t}function lo(e,t,n){if(e){var r,i,o;oo(e,e.l||0);for(var a=e.length,s=0,l=0;e.l<a;){128&(s=e.read_shift(1))&&(s=(127&s)+((127&e.read_shift(1))<<7));var u=Sh[s]||Sh[65535];for(o=127&(r=e.read_shift(1)),i=1;i<4&&128&r;++i)o+=(127&(r=e.read_shift(1)))<<7*i;l=e.l+o;var c=u.f&&u.f(e,o,n);if(e.l=l,t(c,u,s))return}}}function uo(){var e=[],t=qt?256:2048,n=function(e){var t=so(e);return oo(t,0),t},r=n(t),i=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},o=function(e){return r&&e<r.length-r.l?r:(i(),r=n(Math.max(e+1,t)))};return{next:o,push:function(e){i(),null==(r=e).l&&(r.l=r.length),o(t)},end:function(){return i(),tn(e)},_bufs:e}}function co(e,t,n,r){var i,o=+t;if(!isNaN(o)){r||(r=Sh[o].p||(n||[]).length||0),i=1+(o>=128?1:0)+1,r>=128&&++i,r>=16384&&++i,r>=2097152&&++i;var a=e.next(i);o<=127?a.write_shift(1,o):(a.write_shift(1,128+(127&o)),a.write_shift(1,o>>7));for(var s=0;4!=s;++s){if(!(r>=128)){a.write_shift(1,r);break}a.write_shift(1,128+(127&r)),r>>=7}r>0&&Ui(n)&&e.push(n)}}function ho(e,t,n){var r=br(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function fo(e,t,n){var r=br(e);return r.s=ho(r.s,t.s,n),r.e=ho(r.e,t.s,n),r}function po(e,t){if(e.cRel&&e.c<0)for(e=br(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=br(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=Co(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function vo(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?po(e.s,t.biff)+":"+po(e.e,t.biff):(e.s.rRel?"":"$")+mo(e.s.r)+":"+(e.e.rRel?"":"$")+mo(e.e.r):(e.s.cRel?"":"$")+wo(e.s.c)+":"+(e.e.cRel?"":"$")+wo(e.e.c)}function go(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function mo(e){return""+(e+1)}function yo(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function wo(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function bo(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function Co(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function So(e){var t=e.indexOf(":");return-1==t?{s:bo(e),e:bo(e)}:{s:bo(e.slice(0,t)),e:bo(e.slice(t+1))}}function Eo(e,t){return"undefined"===typeof t||"number"===typeof t?Eo(e.s,e.e):("string"!==typeof e&&(e=Co(e)),"string"!==typeof t&&(t=Co(t)),e==t?e:e+":"+t)}function ko(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,o=e.length;for(n=0;r<o&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<o&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===o||10!=i)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=o&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=o&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function xo(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Kn(e.z,n?ur(t):t)}catch(r){}try{return e.w=Kn((e.XF||{}).numFmtId||(n?14:0),n?ur(t):t)}catch(r){return""+t}}function To(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?va[e.v]||e.v:xo(e,void 0==t?e.v:t))}function Ro(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function Ao(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense;null!=Wt&&null==i&&(i=Wt);var o=e||(i?[]:{}),a=0,s=0;if(o&&null!=r.origin){if("number"==typeof r.origin)a=r.origin;else{var l="string"==typeof r.origin?bo(r.origin):r.origin;a=l.r,s=l.c}o["!ref"]||(o["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var c=ko(o["!ref"]);u.s.c=c.s.c,u.s.r=c.s.r,u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),-1==a&&(u.e.r=a=c.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if("undefined"!==typeof t[d][h]){var f={v:t[d][h]},p=a+d,v=s+h;if(u.s.r>p&&(u.s.r=p),u.s.c>v&&(u.s.c=v),u.e.r<p&&(u.e.r=p),u.e.c<v&&(u.e.c=v),!t[d][h]||"object"!==typeof t[d][h]||Array.isArray(t[d][h])||t[d][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[d][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(r.nullError)f.t="e",f.v=0;else{if(!r.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=r.dateNF||pn[14],r.cellDates?(f.t="d",f.w=Kn(f.z,ur(f.v))):(f.t="n",f.v=ur(f.v),f.w=Kn(f.z,f.v))):f.t="s";else f=t[d][h];if(i)o[p]||(o[p]=[]),o[p][v]&&o[p][v].z&&(f.z=o[p][v].z),o[p][v]=f;else{var g=Co({c:v,r:p});o[g]&&o[g].z&&(f.z=o[g].z),o[g]=f}}}return u.s.c<1e7&&(o["!ref"]=Eo(u)),o}function _o(e,t){return Ao(null,e,t)}function Oo(e,t){return t||(t=so(4)),t.write_shift(4,e),t}function Do(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function No(e,t){var n=!1;return null==t&&(n=!0,t=so(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function Po(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Fo(e,t){var n=e.l,r=e.read_shift(1),i=Do(e),o=[],a={t:i,h:i};if(0!==(1&r)){for(var s=e.read_shift(4),l=0;l!=s;++l)o.push(Po(e));a.r=o}else a.r=[{ich:0,ifnt:0}];return e.l=n+t,a}var Io=Fo;function Lo(e,t){var n=!1;return null==t&&(n=!0,t=so(23+4*e.t.length)),t.write_shift(1,1),No(e.t,t),t.write_shift(4,1),function(e,t){t||(t=so(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function Mo(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function Go(e,t){return null==t&&(t=so(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Bo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function jo(e,t){return null==t&&(t=so(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Ho=Do,Vo=No;function Wo(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function zo(e,t){var n=!1;return null==t&&(n=!0,t=so(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var Uo=Do,Ko=Wo,qo=zo;function Xo(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var i=0===r?zi([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Zi(t,0)>>2;return n?i/100:i}function Yo(e,t){null==t&&(t=so(4));var n=0,r=0,i=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:i==(0|i)&&i>=-(1<<29)&&i<1<<29&&(r=1,n=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((n?i:e)<<2)+(n+2))}function Qo(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Zo=Qo,Jo=function(e,t){return t||(t=so(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function $o(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ea(e,t){return(t||so(8)).write_shift(8,e,"f")}function ta(e,t){if(t||(t=so(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function na(e,t){var n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var ra=2,ia=3,oa=12,aa=80,sa=81,la=[aa,sa],ua={1:{n:"CodePage",t:ra},2:{n:"Category",t:aa},3:{n:"PresentationFormat",t:aa},4:{n:"ByteCount",t:ia},5:{n:"LineCount",t:ia},6:{n:"ParagraphCount",t:ia},7:{n:"SlideCount",t:ia},8:{n:"NoteCount",t:ia},9:{n:"HiddenCount",t:ia},10:{n:"MultimediaClipCount",t:ia},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:aa},15:{n:"Company",t:aa},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:ia},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:ia,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:aa},27:{n:"ContentStatus",t:aa},28:{n:"Language",t:aa},29:{n:"Version",t:aa},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},ca={1:{n:"CodePage",t:ra},2:{n:"Title",t:aa},3:{n:"Subject",t:aa},4:{n:"Author",t:aa},5:{n:"Keywords",t:aa},6:{n:"Comments",t:aa},7:{n:"Template",t:aa},8:{n:"LastAuthor",t:aa},9:{n:"RevNumber",t:aa},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:ia},15:{n:"WordCount",t:ia},16:{n:"CharCount",t:ia},17:{n:"Thumbnail",t:71},18:{n:"Application",t:aa},19:{n:"DocSecurity",t:ia},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},da={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ha=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function fa(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var pa=br(fa([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),va={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ga={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ma={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ya={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function wa(e,t){var n,r=function(e){for(var t=[],n=ir(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(ma),i=[];i[i.length]=Gr,i[i.length]=yi("Types",null,{xmlns:Si.CT,"xmlns:xsd":Si.xsd,"xmlns:xsi":Si.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map((function(e){return yi("Default",null,{Extension:e[0],ContentType:e[1]})})));var o=function(r){e[r]&&e[r].length>0&&(n=e[r][0],i[i.length]=yi("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:ya[r][t.bookType]||ya[r].xlsx}))},a=function(n){(e[n]||[]).forEach((function(e){i[i.length]=yi("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:ya[n][t.bookType]||ya[n].xlsx})}))},s=function(t){(e[t]||[]).forEach((function(e){i[i.length]=yi("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})}))};return o("workbooks"),a("sheets"),a("charts"),s("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("threadedcomments"),s("drawings"),a("metadata"),s("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var ba={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ca(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Sa(e,t){var n={"!id":{}};if(!e)return n;"/"!==t.charAt(0)&&(t="/"+t);var r={};return(e.match(Hr)||[]).forEach((function(e){var i=zr(e);if("<Relationship"===i[0]){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var a="External"===i.TargetMode?i.Target:Mr(i.Target,t);n[a]=o,r[i.Id]=o}})),n["!id"]=r,n}function Ea(e){var t=[Gr,yi("Relationships",null,{xmlns:Si.RELS})];return ir(e["!id"]).forEach((function(n){t[t.length]=yi("Relationship",null,e["!id"][n])})),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ka(e,t,n,r,i,o){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,o?i.TargetMode=o:[ba.HLINK,ba.XPATH,ba.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var xa="application/vnd.oasis.opendocument.spreadsheet";function Ta(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function Ra(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+_t.version+"</meta:generator></office:meta></office:document-meta>"}var Aa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],_a=function(){for(var e=new Array(Aa.length),t=0;t<Aa.length;++t){var n=Aa[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function Oa(e){var t={};e=si(e);for(var n=0;n<Aa.length;++n){var r=Aa[n],i=e.match(_a[n]);null!=i&&i.length>0&&(t[r[1]]=Xr(i[1])),"date"===r[2]&&t[r[1]]&&(t[r[1]]=yr(t[r[1]]))}return t}function Da(e,t,n,r,i){null==i[e]&&null!=t&&""!==t&&(i[e]=t,t=Zr(t),r[r.length]=n?yi(e,t,n):gi(e,t))}function Na(e,t){var n=t||{},r=[Gr,yi("cp:coreProperties",null,{"xmlns:cp":Si.CORE_PROPS,"xmlns:dc":Si.dc,"xmlns:dcterms":Si.dcterms,"xmlns:dcmitype":Si.dcmitype,"xmlns:xsi":Si.xsi})],i={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&Da("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:wi(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),null!=e.ModifiedDate&&Da("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:wi(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var o=0;o!=Aa.length;++o){var a=Aa[o],s=n.Props&&null!=n.Props[a[1]]?n.Props[a[1]]:e?e[a[1]]:null;!0===s?s="1":!1===s?s="0":"number"==typeof s&&(s=String(s)),null!=s&&Da(a[0],s,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Pa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Fa=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ia(e,t,n,r){var i=[];if("string"==typeof e)i=pi(e,r);else for(var o=0;o<e.length;++o)i=i.concat(e[o].map((function(e){return{v:e}})));var a="string"==typeof t?pi(t,r).map((function(e){return e.v})):t,s=0,l=0;if(a.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":n.Worksheets=l,n.SheetNames=a.slice(s,s+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":n.NamedRanges=l,n.DefinedNames=a.slice(s,s+l);break;case"Charts":case"Diagramme":n.Chartsheets=l,n.ChartNames=a.slice(s,s+l)}s+=l}}function La(e){var t=[],n=yi;return e||(e={}),e.Application="SheetJS",t[t.length]=Gr,t[t.length]=yi("Properties",null,{xmlns:Si.EXT_PROPS,"xmlns:vt":Si.vt}),Pa.forEach((function(r){if(void 0!==e[r[1]]){var i;switch(r[2]){case"string":i=Zr(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false"}void 0!==i&&(t[t.length]=n(r[0],i))}})),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map((function(e){return"<vt:lpstr>"+Zr(e)+"</vt:lpstr>"})).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Ma=/<[^>]+>[^<]*/g;function Ga(e){var t=[Gr,yi("Properties",null,{xmlns:Si.CUST_PROPS,"xmlns:vt":Si.vt})];if(!e)return t.join("");var n=1;return ir(e).forEach((function(r){++n,t[t.length]=yi("property",function(e,t){switch(typeof e){case"string":var n=yi("vt:lpwstr",Zr(e));return t&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return yi((0|e)==e?"vt:i4":"vt:r8",Zr(String(e)));case"boolean":return yi("vt:bool",e?"true":"false")}if(e instanceof Date)return yi("vt:filetime",wi(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Zr(r)})})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Ba,ja={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Ha(e,t,n){Ba||(Ba=ar(ja)),e[t=Ba[t]||t]=n}function Va(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date(1e3*(n/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Wa(e,t,n){var r=e.l,i=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return i}function za(e,t,n){var r=e.read_shift(0,"lpwstr");return n&&(e.l+=4-(r.length+1&3)&3),r}function Ua(e,t,n){return 31===t?za(e):Wa(e,0,n)}function Ka(e,t,n){return Ua(e,t,!1===n?0:4)}function qa(e){var t=e.l,n=Qa(e,sa);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[n,Qa(e,ia)]}function Xa(e,t){for(var n=e.read_shift(4),r={},i=0;i!=n;++i){var o=e.read_shift(4),a=e.read_shift(4);r[o]=e.read_shift(a,1200===t?"utf16le":"utf8").replace(nn,"").replace(rn,"!"),1200===t&&a%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),r}function Ya(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),n}function Qa(e,t,n){var r,i=e.read_shift(2),o=n||{};if(e.l+=2,t!==oa&&i!==t&&-1===la.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&i)))throw new Error("Expected type "+t+" saw "+i);switch(t===oa?i:t){case 2:return r=e.read_shift(2,"i"),o.raw||(e.l+=2),r;case 3:return r=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return r=e.read_shift(4);case 30:return Wa(e,0,4).replace(nn,"");case 31:return za(e);case 64:return Va(e);case 65:return Ya(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return Ka(e,i,!o.raw).replace(nn,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Ua(e,t,0)}(e,i).replace(nn,"");case 4108:return function(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(qa(e));return n}(e);case 4126:case 4127:return 4127==i?function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var i=e.l;n[r]=e.read_shift(0,"lpwstr").replace(nn,""),e.l-i&2&&(e.l+=2)}return n}(e):function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(nn,"");return n}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+i)}}function Za(e,t){var n=so(4),r=so(4);switch(n.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=so(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),r=(t-n)/Math.pow(2,32);r*=1e7;var i=(n*=1e7)/Math.pow(2,32)|0;i>0&&(n%=Math.pow(2,32),r+=i);var o=so(8);return o.write_shift(4,n),o.write_shift(4,r),o}(t);break;case 31:case 80:for((r=so(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return tn([n,r])}function Ja(e,t){var n=e.l,r=e.read_shift(4),i=e.read_shift(4),o=[],a=0,s=0,l=-1,u={};for(a=0;a!=i;++a){var c=e.read_shift(4),d=e.read_shift(4);o[a]=[c,d+n]}o.sort((function(e,t){return e[1]-t[1]}));var h={};for(a=0;a!=i;++a){if(e.l!==o[a][1]){var f=!0;if(a>0&&t)switch(t[o[a-1][0]].t){case 2:e.l+2===o[a][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=o[a][1]&&(e.l=o[a][1],f=!1)}if((!t||0==a)&&e.l<=o[a][1]&&(f=!1,e.l=o[a][1]),f)throw new Error("Read Error: Expected address "+o[a][1]+" at "+e.l+" :"+a)}if(t){var p=t[o[a][0]];if(h[p.n]=Qa(e,p.t,{raw:!0}),"version"===p.p&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(65535&h[p.n])).slice(-4)),"CodePage"==p.n)switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:It(s=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(1===o[a][0]){if(s=h.CodePage=Qa(e,ra),It(s),-1!==l){var v=e.l;e.l=o[l][1],u=Xa(e,s),e.l=v}}else if(0===o[a][0]){if(0===s){l=a,e.l=o[a+1][1];continue}u=Xa(e,s)}else{var g,m=u[o[a][0]];switch(e[e.l]){case 65:e.l+=4,g=Ya(e);break;case 30:case 31:e.l+=4,g=Ka(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=os(e,4);break;case 64:e.l+=4,g=yr(Va(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[m]=g}}return e.l=n+r,h}var $a=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function es(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function ts(e,t,n){var r=so(8),i=[],o=[],a=8,s=0,l=so(8),u=so(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),o.push(l),i.push(u),a+=8+l.length,!t){(u=so(8)).write_shift(4,0),i.unshift(u);var c=[so(4)];for(c[0].write_shift(4,e.length),s=0;s<e.length;++s){var d=e[s][0];for((l=so(8+2*(d.length+1)+(d.length%2?0:2))).write_shift(4,s+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=tn(c),o.unshift(l),a+=8+l.length}for(s=0;s<e.length;++s)if((!t||t[e[s][0]])&&!($a.indexOf(e[s][0])>-1||Fa.indexOf(e[s][0])>-1)&&null!=e[s][1]){var h=e[s][1],f=0;if(t){var p=n[f=+t[e[s][0]]];if("version"==p.p&&"string"==typeof h){var v=h.split(".");h=(+v[0]<<16)+(+v[1]||0)}l=Za(p.t,h)}else{var g=es(h);-1==g&&(g=31,h=String(h)),l=Za(g,h)}o.push(l),(u=so(8)).write_shift(4,t?f:2+s),i.push(u),a+=8+l.length}var m=8*(o.length+1);for(s=0;s<o.length;++s)i[s].write_shift(4,m),m+=o[s].length;return r.write_shift(4,a),r.write_shift(4,o.length),tn([r].concat(i).concat(o))}function ns(e,t,n){var r=e.content;if(!r)return{};oo(r,0);var i,o,a,s,l=0;r.chk("feff","Byte Order: "),r.read_shift(2);var u=r.read_shift(4),c=r.read_shift(16);if(c!==er.utils.consts.HEADER_CLSID&&c!==n)throw new Error("Bad PropertySet CLSID "+c);if(1!==(i=r.read_shift(4))&&2!==i)throw new Error("Unrecognized #Sets: "+i);if(o=r.read_shift(16),s=r.read_shift(4),1===i&&s!==r.l)throw new Error("Length mismatch: "+s+" !== "+r.l);2===i&&(a=r.read_shift(16),l=r.read_shift(4));var d,h=Ja(r,t),f={SystemIdentifier:u};for(var p in h)f[p]=h[p];if(f.FMTID=o,1===i)return f;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);try{d=Ja(r,null)}catch(v){}for(p in d)f[p]=d[p];return f.FMTID=[o,a],f}function rs(e,t,n,r,i,o){var a=so(i?68:48),s=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,er.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=ts(e,n,r);if(s.push(l),i){var u=ts(i,null,null);a.write_shift(16,o,"hex"),a.write_shift(4,68+l.length),s.push(u)}return tn(s)}function is(e,t){return e.read_shift(t),null}function os(e,t){return 1===e.read_shift(t)}function as(e,t){return t||(t=so(2)),t.write_shift(2,+!!e),t}function ss(e){return e.read_shift(2,"u")}function ls(e,t){return t||(t=so(2)),t.write_shift(2,e),t}function us(e,t){return function(e,t,n){for(var r=[],i=e.l+t;e.l<i;)r.push(n(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return r}(e,t,ss)}function cs(e,t,n){return n||(n=so(2)),n.write_shift(1,"e"==t?+e:+!!e),n.write_shift(1,"e"==t?1:0),n}function ds(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont",o=Ot;(n&&n.biff>=8&&(Ot=1200),n&&8!=n.biff)?12==n.biff&&(i="wstr"):e.read_shift(1)&&(i="dbcs-cont");n.biff>=2&&n.biff<=5&&(i="cpstr");var a=r?e.read_shift(r,i):"";return Ot=o,a}function hs(e){var t=Ot;Ot=1200;var n,r=e.read_shift(2),i=e.read_shift(1),o=4&i,a=8&i,s=1+(1&i),l=0,u={};a&&(l=e.read_shift(2)),o&&(n=e.read_shift(4));var c=2==s?"dbcs-cont":"sbcs-cont",d=0===r?"":e.read_shift(r,c);return a&&(e.l+=4*l),o&&(e.l+=n),u.t=d,a||(u.raw="<t>"+u.t+"</t>",u.r=u.t),Ot=t,u}function fs(e){var t=e.t||"",n=so(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=so(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),tn([n,r])}function ps(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function vs(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):ps(e,r,n)}function gs(e,t,n){if(n.biff>5)return vs(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ms(e,t,n){return n||(n=so(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function ys(e,t){var n=e.read_shift(16);switch(16,n){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(r=!0),e.l=n);var i=e.read_shift((r?t-24:t)>>1,"utf16le").replace(nn,"");return r&&(e.l+=24),i}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return n+r.replace(/\\/g,"/");var i=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return n+e.read_shift(i>>1,"utf16le").replace(nn,"")}(e);default:throw new Error("Unsupported Moniker "+n)}}function ws(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(nn,""):""}function bs(e,t){t||(t=so(6+2*e.length)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function Cs(e){var t=so(512),n=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var i=r.indexOf("#"),o=i>-1?31:23;switch(r.charAt(0)){case"#":o=28;break;case".":o&=-3}t.write_shift(4,2),t.write_shift(4,o);var a=[8,6815827,6619237,4849780,83];for(n=0;n<a.length;++n)t.write_shift(4,a[n]);if(28==o)bs(r=r.slice(1),t);else if(2&o){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<a.length;++n)t.write_shift(1,parseInt(a[n],16));var s=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(s.length+1)),n=0;n<s.length;++n)t.write_shift(2,s.charCodeAt(n));t.write_shift(2,0),8&o&&bs(i>-1?r.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<a.length;++n)t.write_shift(1,parseInt(a[n],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,255&r.charCodeAt(n+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function Ss(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function Es(e,t){var n=Ss(e);return n[3]=0,n}function ks(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function xs(e,t,n,r){return r||(r=so(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function Ts(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function Rs(e){return[e.read_shift(2),Xo(e)]}function As(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function _s(e,t){return t||(t=so(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Os(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:n}}}var Ds=Os;function Ns(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function Ps(e){e.l+=2,e.l+=e.read_shift(2)}var Fs={0:Ps,4:Ps,5:Ps,6:Ps,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:Ps,9:Ps,10:Ps,11:Ps,12:Ps,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:Ps,15:Ps,16:Ps,17:Ps,18:Ps,19:Ps,20:Ps,21:Ns};function Is(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),(t-=2)>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function Ls(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":case"xla":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;default:throw new Error("unsupported BIFF version")}var o=so(i);return o.write_shift(2,r),o.write_shift(2,t),i>4&&o.write_shift(2,29282),i>6&&o.write_shift(2,1997),i>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function Ms(e,t){var n=!t||t.biff>=8?2:1,r=so(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function Gs(e,t,n){var r=0;n&&2==n.biff||(r=e.read_shift(2));var i=e.read_shift(2);return n&&2==n.biff&&(r=1-(i>>15),i&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},i]}function Bs(e,t,n,r){var i=n&&5==n.biff;r||(r=so(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var o=r.length>r.l?r.slice(0,r.l):r;return null==o.l&&(o.l=o.length),o}var js=gs;function Hs(e,t,n){var r=e.l+t,i=8!=n.biff&&n.biff?2:4,o=e.read_shift(i),a=e.read_shift(i),s=e.read_shift(2),l=e.read_shift(2);return e.l=r,{s:{r:o,c:s},e:{r:a,c:l}}}function Vs(e,t,n,r){var i=n&&5==n.biff;r||(r=so(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var o=0;return e.numFmtId>0&&i&&(o|=1024),r.write_shift(4,o),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function Ws(e,t,n){var r=ks(e);2!=n.biff&&9!=t||++e.l;var i=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return r.val=i,r.t=!0===i||!1===i?"b":"e",r}var zs=function(e,t,n){return 0===t?"":gs(e,0,n)};function Us(e,t,n){var r,i=e.read_shift(2),o={fBuiltIn:1&i,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return 14849===n.sbcch&&(r=function(e,t,n){e.l+=4,t-=4;var r=e.l+t,i=ds(e,0,n),o=e.read_shift(2);if(o!==(r-=e.l))throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,i}(e,t-2,n)),o.body=r||e.read_shift(t-2),"string"===typeof r&&(o.Name=r),o}var Ks=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function qs(e,t,n){var r=e.l+t,i=e.read_shift(2),o=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(n&&2==n.biff?1:2),l=0;(!n||n.biff>=5)&&(5!=n.biff&&(e.l+=2),l=e.read_shift(2),5==n.biff&&(e.l+=2),e.l+=4);var u=ps(e,a,n);32&i&&(u=Ks[u.charCodeAt(0)]);var c=r-e.l;n&&2==n.biff&&--c;var d=r!=e.l&&0!==s&&c>0?function(e,t,n,r){var i,o=e.l+t,a=dc(e,r,n);o!==e.l&&(i=cc(e,o-e.l,a,n));return[a,i]}(e,c,n,s):[];return{chKey:o,Name:u,itab:l,rgce:d}}function Xs(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=ds(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],i=e.l+t,o=e.read_shift(n.biff>8?4:2);0!==o--;)r.push(Ts(e,n.biff,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function Ys(e,t,n){var r=Ds(e,6);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,mc(e,t,n)]}var Qs={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=n,{fmt:r}}};function Zs(e){var t=so(24),n=bo(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return tn([t,Cs(e[1])])}function Js(e){var t=e[1].Tooltip,n=so(10+2*(t.length+1));n.write_shift(2,2048);var r=bo(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function $s(e,t,n){if(!n.cellStyles)return ao(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),o=e.read_shift(r),a=e.read_shift(r),s=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var u={s:i,e:o,w:a,ixfe:s,flags:l};return(n.biff>=5||!n.biff)&&(u.level=l>>8&7),u}var el=ks,tl=us,nl=vs;var rl=[2,3,48,49,131,139,140,245],il=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ar({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var i=_o(function(t,n){var r=[],i=Yt(1);switch(n.type){case"base64":i=Zt(Kt(t));break;case"binary":i=Zt(t);break;case"buffer":case"array":i=t}oo(i,0);var o=i.read_shift(1),a=!!(136&o),s=!1,l=!1;switch(o){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:s=!0,a=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+o.toString(16))}var u=0,c=521;2==o&&(u=i.read_shift(2)),i.l+=3,2!=o&&(u=i.read_shift(4)),u>1048576&&(u=1e6),2!=o&&(c=i.read_shift(2));var d=i.read_shift(2),h=n.codepage||1252;2!=o&&(i.l+=16,i.read_shift(1),0!==i[i.l]&&(h=e[i[i.l]]),i.l+=1,i.l+=2),l&&(i.l+=36);for(var f=[],p={},v=Math.min(i.length,2==o?521:c-10-(s?264:0)),g=l?32:11;i.l<v&&13!=i[i.l];)switch((p={}).name=Bt.utils.decode(h,i.slice(i.l,i.l+g)).replace(/[\u0000\r\n].*$/g,""),i.l+=g,p.type=String.fromCharCode(i.read_shift(1)),2==o||l||(p.offset=i.read_shift(4)),p.len=i.read_shift(1),2==o&&(p.offset=i.read_shift(2)),p.dec=i.read_shift(1),p.name.length&&f.push(p),2!=o&&(i.l+=l?13:14),p.type){case"B":s&&8==p.len||!n.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==i[i.l]&&(i.l=c-1),13!==i.read_shift(1))throw new Error("DBF Terminator not found "+i.l+" "+i[i.l]);i.l=c;var m=0,y=0;for(r[0]=[],y=0;y!=f.length;++y)r[0][y]=f[y].name;for(;u-- >0;)if(42!==i[i.l])for(++i.l,r[++m]=[],y=0,y=0;y!=f.length;++y){var w=i.slice(i.l,i.l+f[y].len);i.l+=f[y].len,oo(w,0);var b=Bt.utils.decode(h,w);switch(f[y].type){case"C":b.trim().length&&(r[m][y]=b.replace(/\s+$/,""));break;case"D":8===b.length?r[m][y]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):r[m][y]=b;break;case"F":r[m][y]=parseFloat(b.trim());break;case"+":case"I":r[m][y]=l?2147483648^w.read_shift(-4,"i"):w.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":r[m][y]=!0;break;case"N":case"F":r[m][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!a)throw new Error("DBF Unexpected MEMO for type "+o.toString(16));r[m][y]="##MEMO##"+(l?parseInt(b.trim(),10):w.read_shift(4));break;case"N":(b=b.replace(/\u0000/g,"").trim())&&"."!=b&&(r[m][y]=+b||0);break;case"@":r[m][y]=new Date(w.read_shift(-8,"f")-621356832e5);break;case"T":r[m][y]=new Date(864e5*(w.read_shift(4)-2440588)+w.read_shift(4));break;case"Y":r[m][y]=w.read_shift(4,"i")/1e4+w.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[m][y]=-w.read_shift(-8,"f");break;case"B":if(s&&8==f[y].len){r[m][y]=w.read_shift(8,"f");break}case"G":case"P":w.l+=f[y].len;break;case"0":if("_NullFlags"===f[y].name)break;default:throw new Error("DBF Unsupported data type "+f[y].type)}}else i.l+=d;if(2!=o&&i.l<i.length&&26!=i[i.l++])throw new Error("DBF EOF Marker missing "+(i.l-1)+" of "+i.length+" "+i[i.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=f,r}(t,r),r);return i["!cols"]=r.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete r.DBF,i}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return Ro(n(e,t),t)}catch(r){if(t&&t.WTF)throw r}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var i=n||{};if(+i.codepage>=0&&It(+i.codepage),"string"==i.type)throw new Error("Cannot write DBF to JS string");var o=uo(),a=zf(e,{header:1,raw:!0,cellDates:!0}),s=a[0],l=a.slice(1),u=e["!cols"]||[],c=0,d=0,h=0,f=1;for(c=0;c<s.length;++c)if(((u[c]||{}).DBF||{}).name)s[c]=u[c].DBF.name,++h;else if(null!=s[c]){if(++h,"number"===typeof s[c]&&(s[c]=s[c].toString(10)),"string"!==typeof s[c])throw new Error("DBF Invalid column name "+s[c]+" |"+typeof s[c]+"|");if(s.indexOf(s[c])!==c)for(d=0;d<1024;++d)if(-1==s.indexOf(s[c]+"_"+d)){s[c]+="_"+d;break}}var p=ko(e["!ref"]),v=[],g=[],m=[];for(c=0;c<=p.e.c-p.s.c;++c){var y="",w="",b=0,C=[];for(d=0;d<l.length;++d)null!=l[d][c]&&C.push(l[d][c]);if(0!=C.length&&null!=s[c]){for(d=0;d<C.length;++d){switch(typeof C[d]){case"number":w="B";break;case"string":default:w="C";break;case"boolean":w="L";break;case"object":w=C[d]instanceof Date?"D":"C"}b=Math.max(b,String(C[d]).length),y=y&&y!=w?"C":w}b>250&&(b=250),"C"==(w=((u[c]||{}).DBF||{}).type)&&u[c].DBF.len>b&&(b=u[c].DBF.len),"B"==y&&"N"==w&&(y="N",m[c]=u[c].DBF.dec,b=u[c].DBF.len),g[c]="C"==y||"N"==w?b:r[y]||0,f+=g[c],v[c]=y}else v[c]="?"}var S=o.next(32);for(S.write_shift(4,318902576),S.write_shift(4,l.length),S.write_shift(2,296+32*h),S.write_shift(2,f),c=0;c<4;++c)S.write_shift(4,0);for(S.write_shift(4,0|(+t[Dt]||3)<<8),c=0,d=0;c<s.length;++c)if(null!=s[c]){var E=o.next(32),k=(s[c].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);E.write_shift(1,k,"sbcs"),E.write_shift(1,"?"==v[c]?"C":v[c],"sbcs"),E.write_shift(4,d),E.write_shift(1,g[c]||r[v[c]]||0),E.write_shift(1,m[c]||0),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(1,0),E.write_shift(4,0),E.write_shift(4,0),d+=g[c]||r[v[c]]||0}var x=o.next(264);for(x.write_shift(4,13),c=0;c<65;++c)x.write_shift(4,0);for(c=0;c<l.length;++c){var T=o.next(f);for(T.write_shift(1,0),d=0;d<s.length;++d)if(null!=s[d])switch(v[d]){case"L":T.write_shift(1,null==l[c][d]?63:l[c][d]?84:70);break;case"B":T.write_shift(8,l[c][d]||0,"f");break;case"N":var R="0";for("number"==typeof l[c][d]&&(R=l[c][d].toFixed(m[d]||0)),h=0;h<g[d]-R.length;++h)T.write_shift(1,32);T.write_shift(1,R,"sbcs");break;case"D":l[c][d]?(T.write_shift(4,("0000"+l[c][d].getFullYear()).slice(-4),"sbcs"),T.write_shift(2,("00"+(l[c][d].getMonth()+1)).slice(-2),"sbcs"),T.write_shift(2,("00"+l[c][d].getDate()).slice(-2),"sbcs")):T.write_shift(8,"00000000","sbcs");break;case"C":var A=String(null!=l[c][d]?l[c][d]:"").slice(0,g[d]);for(T.write_shift(1,A,"sbcs"),h=0;h<g[d]-A.length;++h)T.write_shift(1,32)}}return o.next(1).write_shift(1,26),o.end()}}}(),ol=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+ir(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?Vt(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:Vt(r)};function i(e,i){var o,a=e.split(/[\n\r]+/),s=-1,l=-1,u=0,c=0,d=[],h=[],f=null,p={},v=[],g=[],m=[],y=0;for(+i.codepage>=0&&It(+i.codepage);u!==a.length;++u){y=0;var w,b=a[u].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),C=b.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),S=C[0];if(b.length>0)switch(S){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==C[1].charAt(0)&&h.push(b.slice(3).replace(/;;/g,";"));break;case"C":var E=!1,k=!1,x=!1,T=!1,R=-1,A=-1;for(c=1;c<C.length;++c)switch(C[c].charAt(0)){case"A":case"G":break;case"X":l=parseInt(C[c].slice(1))-1,k=!0;break;case"Y":for(s=parseInt(C[c].slice(1))-1,k||(l=0),o=d.length;o<=s;++o)d[o]=[];break;case"K":'"'===(w=C[c].slice(1)).charAt(0)?w=w.slice(1,w.length-1):"TRUE"===w?w=!0:"FALSE"===w?w=!1:isNaN(Sr(w))?isNaN(kr(w).getDate())||(w=yr(w)):(w=Sr(w),null!==f&&Vn(f)&&(w=fr(w))),"undefined"!==typeof Bt&&"string"==typeof w&&"string"!=(i||{}).type&&(i||{}).codepage&&(w=Bt.utils.decode(i.codepage,w)),E=!0;break;case"E":T=!0;var _=Bu(C[c].slice(1),{r:s,c:l});d[s][l]=[d[s][l],_];break;case"S":x=!0,d[s][l]=[d[s][l],"S5S"];break;case"R":R=parseInt(C[c].slice(1))-1;break;case"C":A=parseInt(C[c].slice(1))-1;break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+b)}if(E&&(d[s][l]&&2==d[s][l].length?d[s][l][0]=w:d[s][l]=w,f=null),x){if(T)throw new Error("SYLK shared formula cannot have own formula");var O=R>-1&&d[R][A];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");d[s][l][1]=Vu(O[1],{r:s-R,c:l-A})}break;case"F":var D=0;for(c=1;c<C.length;++c)switch(C[c].charAt(0)){case"X":l=parseInt(C[c].slice(1))-1,++D;break;case"Y":for(s=parseInt(C[c].slice(1))-1,o=d.length;o<=s;++o)d[o]=[];break;case"M":y=parseInt(C[c].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(C[c].slice(1))];break;case"W":for(m=C[c].slice(1).split(" "),o=parseInt(m[0],10);o<=parseInt(m[1],10);++o)y=parseInt(m[2],10),g[o-1]=0===y?{hidden:!0}:{wch:y},Xl(g[o-1]);break;case"C":g[l=parseInt(C[c].slice(1))-1]||(g[l]={});break;case"R":v[s=parseInt(C[c].slice(1))-1]||(v[s]={}),y>0?(v[s].hpt=y,v[s].hpx=Zl(y)):0===y&&(v[s].hidden=!0);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+b)}D<1&&(f=null);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+b)}}return v.length>0&&(p["!rows"]=v),g.length>0&&(p["!cols"]=g),i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),[d,p]}function o(e,t){var n=function(e,t){switch(t.type){case"base64":return i(Kt(e),t);case"binary":return i(e,t);case"buffer":return i(qt&&Buffer.isBuffer(e)?e.toString("binary"):$t(e),t);case"array":return i(wr(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],o=n[1],a=_o(r,t);return ir(o).forEach((function(e){a[e]=o[e]})),a}function a(e,t,n,r){var i="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":i+=e.v||0,e.f&&!e.F&&(i+=";E"+Hu(e.f,{r:n,c:r}));break;case"b":i+=e.v?"TRUE":"FALSE";break;case"e":i+=e.w||e.v;break;case"d":i+='"'+(e.w||e.v)+'"';break;case"s":i+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return i}return e["|"]=254,{to_workbook:function(e,t){return Ro(o(e,t),t)},to_sheet:o,from_sheet:function(e,t){var n,r,i=["ID;PWXL;N;E"],o=[],s=ko(e["!ref"]),l=Array.isArray(e),u="\r\n";i.push("P;PGeneral"),i.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=i,e["!cols"].forEach((function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Wl(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=zl(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)}))),e["!rows"]&&function(e,t){t.forEach((function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*Ql(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))}))}(i,e["!rows"]),i.push("B;Y"+(s.e.r-s.s.r+1)+";X"+(s.e.c-s.s.c+1)+";D"+[s.s.c,s.s.r,s.e.c,s.e.r].join(" "));for(var c=s.s.r;c<=s.e.r;++c)for(var d=s.s.c;d<=s.e.c;++d){var h=Co({r:c,c:d});(n=l?(e[c]||[])[d]:e[h])&&(null!=n.v||n.f&&!n.F)&&o.push(a(n,0,c,d))}return i.join(u)+u+o.join(u)+u+"E"+u}}}(),al=function(){function e(e,t){for(var n=e.split("\n"),r=-1,i=-1,o=0,a=[];o!==n.length;++o)if("BOT"!==n[o].trim()){if(!(r<0)){for(var s=n[o].trim().split(","),l=s[0],u=s[1],c=n[++o]||"";1&(c.match(/["]/g)||[]).length&&o<n.length-1;)c+="\n"+n[++o];switch(c=c.trim(),+l){case-1:if("BOT"===c){a[++r]=[],i=0;continue}if("EOD"!==c)throw new Error("Unrecognized DIF special command "+c);break;case 0:"TRUE"===c?a[r][i]=!0:"FALSE"===c?a[r][i]=!1:isNaN(Sr(u))?isNaN(kr(u).getDate())?a[r][i]=u:a[r][i]=yr(u):a[r][i]=Sr(u),++i;break;case 1:(c=(c=c.slice(1,c.length-1)).replace(/""/g,'"'))&&c.match(/^=".*"$/)&&(c=c.slice(2,-1)),a[r][i++]=""!==c?c:null}if("EOD"===c)break}}else a[++r]=[],i=0;return t&&t.sheetRows&&(a=a.slice(0,t.sheetRows)),a}function t(t,n){return _o(function(t,n){switch(n.type){case"base64":return e(Kt(t),n);case"binary":return e(t,n);case"buffer":return e(qt&&Buffer.isBuffer(t)?t.toString("binary"):$t(t),n);case"array":return e(wr(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}var n=function(){var e=function(e,t,n,r,i){e.push(t),e.push(n+","+r),e.push('"'+i.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,i=[],o=ko(n["!ref"]),a=Array.isArray(n);e(i,"TABLE",0,1,"sheetjs"),e(i,"VECTORS",0,o.e.r-o.s.r+1,""),e(i,"TUPLES",0,o.e.c-o.s.c+1,""),e(i,"DATA",0,0,"");for(var s=o.s.r;s<=o.e.r;++s){t(i,-1,0,"BOT");for(var l=o.s.c;l<=o.e.c;++l){var u=Co({r:s,c:l});if(r=a?(n[s]||[])[l]:n[u])switch(r.t){case"n":var c=r.w;c||null==r.v||(c=r.v),null==c?r.f&&!r.F?t(i,1,0,"="+r.f):t(i,1,0,""):t(i,0,c,"V");break;case"b":t(i,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(i,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=Kn(r.z||pn[14],ur(yr(r.v)))),t(i,0,r.w,"V");break;default:t(i,1,0,"")}else t(i,1,0,"")}}t(i,-1,0,"EOD");return i.join("\r\n")}}();return{to_workbook:function(e,n){return Ro(t(e,n),n)},to_sheet:t,from_sheet:n}}(),sl=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return _o(function(e,t){for(var n=e.split("\n"),r=-1,i=-1,o=0,a=[];o!==n.length;++o){var s=n[o].trim().split(":");if("cell"===s[0]){var l=bo(s[1]);if(a.length<=l.r)for(r=a.length;r<=l.r;++r)a[r]||(a[r]=[]);switch(r=l.r,i=l.c,s[2]){case"t":a[r][i]=s[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":a[r][i]=+s[3];break;case"vtf":var u=s[s.length-1];case"vtc":"nl"===s[3]?a[r][i]=!!+s[4]:a[r][i]=+s[4],"vtf"==s[2]&&(a[r][i]=[a[r][i],u])}}}return t&&t.sheetRows&&(a=a.slice(0,t.sheetRows)),a}(e,t),t)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),r=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),o="--SocialCalcSpreadsheetControlSave--";function a(t){if(!t||!t["!ref"])return"";for(var n,r=[],i=[],o="",a=So(t["!ref"]),s=Array.isArray(t),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u)if(o=Co({r:l,c:u}),(n=s?(t[l]||[])[u]:t[o])&&null!=n.v&&"z"!==n.t){switch(i=["cell",o,"t"],n.t){case"s":case"str":i.push(e(n.v));break;case"n":n.f?(i[2]="vtf",i[3]="n",i[4]=n.v,i[5]=e(n.f)):(i[2]="v",i[3]=n.v);break;case"b":i[2]="vt"+(n.f?"f":"c"),i[3]="nl",i[4]=n.v?"1":"0",i[5]=e(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var c=ur(yr(n.v));i[2]="vtc",i[3]="nd",i[4]=""+c,i[5]=n.w||Kn(n.z||pn[14],c);break;case"e":continue}r.push(i.join(":"))}return r.push("sheet:c:"+(a.e.c-a.s.c+1)+":r:"+(a.e.r-a.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,n){return Ro(t(e,n),n)},to_sheet:t,from_sheet:function(e){return[n,r,i,r,a(e),o].join("\n")}}}(),ll=function(){function e(e,t,n,r,i){i.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN(Sr(e))?isNaN(kr(e).getDate())?t[n][r]=e:t[n][r]=yr(e):t[n][r]=Sr(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},i=!1,o=0,a=0;o<e.length;++o)34==(a=e.charCodeAt(o))?i=!i:!i&&a in t&&(r[a]=(r[a]||0)+1);for(o in a=[],r)Object.prototype.hasOwnProperty.call(r,o)&&a.push([r[o],o]);if(!a.length)for(o in r=n)Object.prototype.hasOwnProperty.call(r,o)&&a.push([r[o],o]);return a.sort((function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]})),t[a.pop()[1]]||44}function i(e,t){var n=t||{},i="";null!=Wt&&null==n.dense&&(n.dense=Wt);var o=n.dense?[]:{},a={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(i=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(i=e.charAt(4),e=e.slice(6)):i=r(e.slice(0,1024)):i=n&&n.FS?n.FS:r(e.slice(0,1024));var s=0,l=0,u=0,c=0,d=0,h=i.charCodeAt(0),f=!1,p=0,v=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=n.dateNF?function(e){var t="number"==typeof e?pn[e]:e;return t=t.replace(Jn,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function m(){var t=e.slice(c,d),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):!function(e){return 1!=e.length}(t)?(r.t="s",r.v=t):(r.t="n",r.f=t.slice(1));else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(u=Sr(t)))if(!isNaN(kr(t).getDate())||g&&t.match(g)){r.z=n.dateNF||pn[14];var i=0;g&&t.match(g)&&(t=function(e,t,n){var r=-1,i=-1,o=-1,a=-1,s=-1,l=-1;(t.match(Jn)||[]).forEach((function(e,t){var u=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=u;break;case"d":o=u;break;case"h":a=u;break;case"s":l=u;break;case"m":a>=0?s=u:i=u}})),l>=0&&-1==s&&i>=0&&(s=i,i=-1);var u=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);7==u.length&&(u="0"+u),8==u.length&&(u="20"+u);var c=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==a&&-1==s&&-1==l?u:-1==r&&-1==i&&-1==o?c:u+"T"+c}(0,n.dateNF,t.match(g)||[]),i=1),n.cellDates?(r.t="d",r.v=yr(t,i)):(r.t="n",r.v=ur(yr(t,i))),!1!==n.cellText&&(r.w=Kn(r.z,r.v instanceof Date?ur(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=u;if("z"==r.t||(n.dense?(o[s]||(o[s]=[]),o[s][l]=r):o[Co({c:l,r:s})]=r),c=d+1,v=e.charCodeAt(c),a.e.c<l&&(a.e.c=l),a.e.r<s&&(a.e.r=s),p==h)++l;else if(l=0,++s,n.sheetRows&&n.sheetRows<=s)return!0}e:for(;d<e.length;++d)switch(p=e.charCodeAt(d)){case 34:34===v&&(f=!f);break;case h:case 10:case 13:if(!f&&m())break e}return d-c>0&&m(),o["!ref"]=Eo(a),o}function o(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?i(t,n):_o(function(t,n){var r=n||{},i=[];if(!t||0===t.length)return i;for(var o=t.split(/[\r\n]/),a=o.length-1;a>=0&&0===o[a].length;)--a;for(var s=10,l=0,u=0;u<=a;++u)-1==(l=o[u].indexOf(" "))?l=o[u].length:l++,s=Math.max(s,l);for(u=0;u<=a;++u){i[u]=[];var c=0;for(e(o[u].slice(0,s).trim(),i,u,c,r),c=1;c<=(o[u].length-s)/10+1;++c)e(o[u].slice(s+10*(c-1),s+10*c).trim(),i,u,c,r)}return r.sheetRows&&(i=i.slice(0,r.sheetRows)),i}(t,n),n):i(t,n)}function a(e,t){var n="",r="string"==t.type?[0,0,0,0]:Ff(e,t);switch(t.type){case"base64":n=Kt(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof Bt?Bt.utils.decode(t.codepage,e):qt&&Buffer.isBuffer(e)?e.toString("binary"):$t(e);break;case"array":n=wr(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=si(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=si(n):"binary"==t.type&&"undefined"!==typeof Bt&&t.codepage&&(n=Bt.utils.decode(t.codepage,Bt.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?sl.to_sheet("string"==t.type?n:si(n),t):o(n,t)}return{to_workbook:function(e,t){return Ro(a(e,t),t)},to_sheet:a,from_sheet:function(e){for(var t,n=[],r=ko(e["!ref"]),i=Array.isArray(e),o=r.s.r;o<=r.e.r;++o){for(var a=[],s=r.s.c;s<=r.e.c;++s){var l=Co({r:o,c:s});if((t=i?(e[o]||[])[s]:e[l])&&null!=t.v){for(var u=(t.w||(To(t),t.w)||"").slice(0,10);u.length<10;)u+=" ";a.push(u+(0===s?" ":""))}else a.push("          ")}n.push(a.join(""))}return n.join("\n")}}}();var ul=function(){function e(e,t,n){if(e){oo(e,e.l||0);for(var r=n.Enum||m;e.l<e.length;){var i=e.read_shift(2),o=r[i]||r[65535],a=e.read_shift(2),s=e.l+a,l=o.f&&o.f(e,a,n);if(e.l=s,t(l,o,i))return}}}function t(t,n){if(!t)return t;var r=n||{};null!=Wt&&null==r.dense&&(r.dense=Wt);var i=r.dense?[]:{},o="Sheet1",a="",s=0,l={},u=[],c=[],d={s:{r:0,c:0},e:{r:0,c:0}},h=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=m,e(t,(function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:d=e;break;case 204:e&&(a=e);break;case 222:a=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||pn[14],r.cellDates&&(e[1].t="d",e[1].v=fr(e[1].v))),r.qpro&&e[3]>s&&(i["!ref"]=Eo(d),l[o]=i,u.push(o),i=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],o=a||"Sheet"+(s+1),a="");var c=r.dense?(i[e[0].r]||[])[e[0].c]:i[Co(e[0])];if(c){c.t=e[1].t,c.v=e[1].v,null!=e[1].z&&(c.z=e[1].z),null!=e[1].f&&(c.f=e[1].f);break}r.dense?(i[e[0].r]||(i[e[0].r]=[]),i[e[0].r][e[0].c]=e[1]):i[Co(e[0])]=e[1]}}),r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=y,14==t[2]&&(r.qpro=!0,t.l=0),e(t,(function(e,t,n){switch(n){case 204:o=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>s&&(i["!ref"]=Eo(d),l[o]=i,u.push(o),i=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],o="Sheet"+(s+1)),h>0&&e[0].r>=h)break;r.dense?(i[e[0].r]||(i[e[0].r]=[]),i[e[0].r][e[0].c]=e[1]):i[Co(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(c[e[14e3][0]]=e[14e3][1]);break;case 1537:c[e[0]]=e[1],e[0]==s&&(o=e[1])}}),r)}if(i["!ref"]=Eo(d),l[a||o]=i,u.push(a||o),!c.length)return{SheetNames:u,Sheets:l};for(var f={},p=[],v=0;v<c.length;++v)l[u[v]]?(p.push(c[v]||u[v]),f[c[v]]=l[c[v]]||l[u[v]]):(p.push(c[v]),f[c[v]]={"!ref":"A1"});return{SheetNames:p,Sheets:f}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var i=e.l+t,o=n(e,0,r);if(o[1].t="s",20768==r.vers){e.l++;var a=e.read_shift(1);return o[1].v=e.read_shift(a,"utf8"),o}return r.qpro&&e.l++,o[1].v=e.read_shift(i-e.l,"cstr"),o}function i(e,t,n){var r=so(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var i=0;i<r.length;++i){var o=n.charCodeAt(i);r.write_shift(1,o>=128?95:o)}return r.write_shift(1,0),r}function o(e,t,n){var r=so(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function a(e,t,n){var r=so(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function s(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?wo(t):mo(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},u=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function c(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,n,r){var i=so(6+r.length);i.write_shift(2,e),i.write_shift(1,n),i.write_shift(1,t),i.write_shift(1,39);for(var o=0;o<r.length;++o){var a=r.charCodeAt(o);i.write_shift(1,a>=128?95:a)}return i.write_shift(1,0),i}function h(e,t){var n=c(e),r=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(2);if(65535==o)return 0===r&&3221225472===i?(n[1].t="e",n[1].v=15):0===r&&3489660928===i?(n[1].t="e",n[1].v=42):n[1].v=0,n;var a=32768&o;return o=(32767&o)-16446,n[1].v=(1-2*a)*(i*Math.pow(2,o+32)+r*Math.pow(2,o)),n}function f(e,t,n,r){var i=so(14);if(i.write_shift(2,e),i.write_shift(1,n),i.write_shift(1,t),0==r)return i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,65535),i;var o,a=0,s=0,l=0;return r<0&&(a=1,r=-r),s=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,s-31))>>>0))&&(++s,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,o=(r*=Math.pow(2,32))>>>0,i.write_shift(4,o),i.write_shift(4,l),s+=16383+(a?32768:0),i.write_shift(2,s),i}function p(e,t){var n=c(e),r=e.read_shift(8,"f");return n[1].v=r,n}function v(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var n=so(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var i=e.charCodeAt(r);n[n.l++]=i>127?95:i}return n[n.l++]=0,n}var m={0:{n:"BOF",f:ss},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var i=n(e,0,r);return i[1].v=e.read_shift(2,"i"),i}},14:{n:"NUMBER",f:function(e,t,r){var i=n(e,0,r);return i[1].v=e.read_shift(8,"f"),i}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var i=e.l+t,o=n(e,0,r);if(o[1].v=e.read_shift(8,"f"),r.qpro)e.l=i;else{var a=e.read_shift(2);!function(e,t){oo(e,0);var n=[],r=0,i="",o="",a="",c="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:n.push(e.read_shift(8,"f"));break;case 1:o=s(t[0].c,e.read_shift(2),!0),i=s(t[0].r,e.read_shift(2),!1),n.push(o+i);break;case 2:var h=s(t[0].c,e.read_shift(2),!0),f=s(t[0].r,e.read_shift(2),!1);o=s(t[0].c,e.read_shift(2),!0),i=s(t[0].r,e.read_shift(2),!1),n.push(h+f+":"+o+i);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var p="";d=e[e.l++];)p+=String.fromCharCode(d);n.push('"'+p.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:c=n.pop(),a=n.pop(),n.push(["AND","OR"][d-20]+"("+a+","+c+")");break;default:if(d<32&&u[d])c=n.pop(),a=n.pop(),n.push(a+u[d]+c);else{if(!l[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(r=l[d][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+n.join("|")+"|");var v=n.slice(-r);n.length-=r,n.push(l[d][0]+"("+v.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+a),o),e.l+=a}return o}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:v},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=c(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var n=c(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=h(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var i=e.read_shift(2);if(14e3==i){for(n[i]=[0,""],n[i][0]=e.read_shift(2);e[e.l];)n[i][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=c(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var n=p(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:v},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&It(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=uo(),s=ko(e["!ref"]),l=Array.isArray(e),u=[];kh(r,0,function(e){var t=so(2);return t.write_shift(2,e),t}(1030)),kh(r,6,function(e){var t=so(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(s));for(var c=Math.min(s.e.r,8191),d=s.s.r;d<=c;++d)for(var h=mo(d),f=s.s.c;f<=s.e.c;++f){d===s.s.r&&(u[f]=wo(f));var p=u[f]+h,v=l?(e[d]||[])[f]:e[p];if(v&&"z"!=v.t)if("n"==v.t)(0|v.v)==v.v&&v.v>=-32768&&v.v<=32767?kh(r,13,o(d,f,v.v)):kh(r,14,a(d,f,v.v));else kh(r,15,i(d,f,To(v).slice(0,239)))}return kh(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&It(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=uo();kh(r,0,function(e){var t=so(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,i=0,o=0;o<e.SheetNames.length;++o){var a=e.SheetNames[o],s=e.Sheets[a];if(s&&s["!ref"]){++i;var l=So(s["!ref"]);n<l.e.r&&(n=l.e.r),r<l.e.c&&(r=l.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,i),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var i=0,o=0;i<e.SheetNames.length;++i)(e.Sheets[e.SheetNames[i]]||{})["!ref"]&&kh(r,27,g(e.SheetNames[i],o++));var a=0;for(i=0;i<e.SheetNames.length;++i){var s=e.Sheets[e.SheetNames[i]];if(s&&s["!ref"]){for(var l=ko(s["!ref"]),u=Array.isArray(s),c=[],h=Math.min(l.e.r,8191),p=l.s.r;p<=h;++p)for(var v=mo(p),m=l.s.c;m<=l.e.c;++m){p===l.s.r&&(c[m]=wo(m));var y=c[m]+v,w=u?(s[p]||[])[m]:s[y];if(w&&"z"!=w.t)if("n"==w.t)kh(r,23,f(p,m,a,w.v));else kh(r,22,d(p,m,a,To(w).slice(0,239)))}++a}}return kh(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(Zt(Kt(e)),n);case"binary":return t(Zt(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var cl=function(){var e=ui("t"),t=ui("rPr");function n(n){var r=n.match(e);if(!r)return{t:"s",v:""};var i={t:"s",v:Xr(r[1])},o=n.match(t);return o&&(i.s=function(e){var t={},n=e.match(Hr),r=0,i=!1;if(n)for(;r!=n.length;++r){var o=zr(n[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==o.val)break;t.cp=Pt[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==o.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==o.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(47!==o[0].charCodeAt(1)&&!i)throw new Error("Unrecognized rich format "+o[0])}}return t}(o[1])),i}var r=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(e){return e.replace(r,"").split(i).map(n).filter((function(e){return e.v}))}}(),dl=function(){var e=/(\r\n|\n)/g;function t(t){var n=[[],t.v,[]];return t.v?(t.s&&function(e,t,n){var r=[];e.u&&r.push("text-decoration: underline;"),e.uval&&r.push("text-underline-style:"+e.uval+";"),e.sz&&r.push("font-size:"+e.sz+"pt;"),e.outline&&r.push("text-effect: outline;"),e.shadow&&r.push("text-shadow: auto;"),t.push('<span style="'+r.join("")+'">'),e.b&&(t.push("<b>"),n.push("</b>")),e.i&&(t.push("<i>"),n.push("</i>")),e.strike&&(t.push("<s>"),n.push("</s>"));var i=e.valign||"";"superscript"==i||"super"==i?i="sup":"subscript"==i&&(i="sub"),""!=i&&(t.push("<"+i+">"),n.push("</"+i+">")),n.push("</span>")}(t.s,n[0],n[2]),n[0].join("")+n[1].replace(e,"<br/>")+n[2].join("")):""}return function(e){return e.map(t).join("")}}(),hl=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,fl=/<(?:\w+:)?r>/,pl=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function vl(e,t){var n=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Xr(si(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=si(e),n&&(r.h=ei(r.t))):e.match(fl)&&(r.r=si(e),r.t=Xr(si((e.replace(pl,"").match(hl)||[]).join("").replace(Hr,""))),n&&(r.h=dl(cl(r.r)))),r):{t:""}}var gl=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,ml=/<(?:\w+:)?(?:si|sstItem)>/g,yl=/<\/(?:\w+:)?(?:si|sstItem)>/;var wl=/^\s|\s$|[\t\n\r]/;function bl(e,t){if(!t.bookSST)return"";var n=[Gr];n[n.length]=yi("sst",null,{xmlns:Ei[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var i=e[r],o="<si>";i.r?o+=i.r:(o+="<t",i.t||(i.t=""),i.t.match(wl)&&(o+=' xml:space="preserve"'),o+=">"+Zr(i.t)+"</t>"),o+="</si>",n[n.length]=o}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}var Cl=function(e,t){var n=!1;return null==t&&(n=!0,t=so(15+4*e.t.length)),t.write_shift(1,0),No(e.t,t),n?t.slice(0,t.l):t};function Sl(e){var t=uo();co(t,159,function(e,t){return t||(t=so(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var n=0;n<e.length;++n)co(t,19,Cl(e[n]));return co(t,160),t.end()}function El(e){if("undefined"!==typeof Bt)return Bt.utils.encode(Dt,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function kl(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function xl(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},i=e.read_shift(4),o=[];i-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function Tl(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=kl(e,4),t.U=kl(e,4),t.W=kl(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function Rl(e,t){var n=e.l+t,r={};r.Flags=63&e.read_shift(4),e.l+=4,r.AlgID=e.read_shift(4);var i=!1;switch(r.AlgID){case 26126:case 26127:case 26128:i=36==r.Flags;break;case 26625:i=4==r.Flags;break;case 0:i=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function Al(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function _l(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:Rl(e,t),v:Al(e,e.length-e.l)}}function Ol(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Dl(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(Hr,(function(e){var n=zr(e);switch(Ur(n[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){r[e]=n[e]}));break;case"<dataIntegrity":r.encryptedHmacKey=n.encryptedHmacKey,r.encryptedHmacValue=n.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"<keyEncryptor":r.uri=n.uri;break;case"<encryptedKey":r.encs.push(n);break;default:throw n[0]}})),r}function Nl(e){var t,n,r=0,i=El(e),o=i.length+1;for((t=Yt(o))[0]=i.length,n=1;n!=o;++n)t[n]=i[n-1];for(n=o-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var Pl=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(e,t){return 255&((n=e^t)/2|128*n);var n};return function(i){for(var o,a,s,l=El(i),u=function(e){for(var r=t[e.length-1],i=104,o=e.length-1;o>=0;--o)for(var a=e[o],s=0;7!=s;++s)64&a&&(r^=n[i]),a*=2,--i;return r}(l),c=l.length,d=Yt(16),h=0;16!=h;++h)d[h]=0;for(1===(1&c)&&(o=u>>8,d[c]=r(e[0],o),--c,o=255&u,a=l[l.length-1],d[c]=r(a,o));c>0;)o=u>>8,d[--c]=r(l[c],o),o=255&u,d[--c]=r(l[c],o);for(c=15,s=15-l.length;s>0;)o=u>>8,d[c]=r(e[s],o),--s,o=255&u,d[--c]=r(l[c],o),--c,--s;return d}}(),Fl=function(e){var t=0,n=Pl(e);return function(e){var r=function(e,t,n,r,i){var o,a;for(i||(i=t),r||(r=Pl(e)),o=0;o!=t.length;++o)a=t[o],a=255&((a^=r[n])>>5|a<<3),i[o]=a,++n;return[i,n,r]}("",e,t,n);return t=r[1],r[0]}};function Il(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,1===r.Info?r.Data=function(e){var t={},n=t.EncryptionVersionInfo=kl(e,4);if(1!=n.Major||1!=n.Minor)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):r.Data=function(e,t){var n={},r=n.EncryptionVersionInfo=kl(e,4);if(t-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,n.EncryptionHeader=Rl(e,i),t-=i,n.EncryptionVerifier=Al(e,t),n}(e,t),r}var Ll=function(){function e(e,n){switch(n.type){case"base64":return t(Kt(e),n);case"binary":return t(e,n);case"buffer":return t(qt&&Buffer.isBuffer(e)?e.toString("binary"):$t(e),n);case"array":return t(wr(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var i={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach((function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,o=/\\\w+\b/g,a=0,s=-1;r=o.exec(e);){if("\\cell"===r[0]){var l=e.slice(a,o.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++s,l.length){var u={v:l,t:"s"};Array.isArray(n)?n[t][s]=u:n[Co({r:t,c:s})]=u}}a=o.lastIndex}s>i.e.c&&(i.e.c=s)})),n["!ref"]=Eo(i),n}return{to_workbook:function(t,n){return Ro(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=ko(e["!ref"]),i=Array.isArray(e),o=r.s.r;o<=r.e.r;++o){n.push("\\trowd\\trautofit1");for(var a=r.s.c;a<=r.e.c;++a)n.push("\\cellx"+(a+1));for(n.push("\\pard\\intbl"),a=r.s.c;a<=r.e.c;++a){var s=Co({r:o,c:a});(t=i?(e[o]||[])[a]:e[s])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(To(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function Ml(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function Gl(e,t){if(0===t)return e;var n=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.max(t,n,r),o=Math.min(t,n,r),a=i-o;if(0===a)return[0,0,t];var s,l=0,u=i+o;switch(s=a/(u>1?2-u:u),i){case t:l=((n-r)/a+6)%6;break;case n:l=(r-t)/a+2;break;case r:l=(t-n)/a+4}return[l/6,s,u/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return n[2]=t<0?n[2]*(1+t):1-(1-n[2])*(1-t),Ml(function(e){var t,n=e[0],r=e[1],i=e[2],o=2*r*(i<.5?i:1-i),a=i-o/2,s=[a,a,a],l=6*n;if(0!==r)switch(0|l){case 0:case 6:t=o*l,s[0]+=o,s[1]+=t;break;case 1:t=o*(2-l),s[0]+=t,s[1]+=o;break;case 2:t=o*(l-2),s[1]+=o,s[2]+=t;break;case 3:t=o*(4-l),s[1]+=t,s[2]+=o;break;case 4:t=o*(l-4),s[2]+=o,s[0]+=t;break;case 5:t=o*(6-l),s[2]+=t,s[0]+=o}for(var u=0;3!=u;++u)s[u]=Math.round(255*s[u]);return s}(n))}var Bl=6,jl=15,Hl=1,Vl=Bl;function Wl(e){return Math.floor((e+Math.round(128/Vl)/256)*Vl)}function zl(e){return Math.floor((e-5)/Vl*100+.5)/100}function Ul(e){return Math.round((e*Vl+5)/Vl*256)/256}function Kl(e){return Ul(zl(Wl(e)))}function ql(e){var t=Math.abs(e-Kl(e)),n=Vl;if(t>.005)for(Vl=Hl;Vl<jl;++Vl)Math.abs(e-Kl(e))<=t&&(t=Math.abs(e-Kl(e)),n=Vl);Vl=n}function Xl(e){e.width?(e.wpx=Wl(e.width),e.wch=zl(e.wpx),e.MDW=Vl):e.wpx?(e.wch=zl(e.wpx),e.width=Ul(e.wch),e.MDW=Vl):"number"==typeof e.wch&&(e.width=Ul(e.wch),e.wpx=Wl(e.width),e.MDW=Vl),e.customWidth&&delete e.customWidth}var Yl=96;function Ql(e){return 96*e/Yl}function Zl(e){return e*Yl/96}var Jl={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var $l=["numFmtId","fillId","fontId","borderId","xfId"],eu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var tu=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,a,s){var l,u={};return o?((l=(o=o.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,n){t.NumberFmt=[];for(var r=ir(pn),i=0;i<r.length;++i)t.NumberFmt[r[i]]=pn[r[i]];var o=e[0].match(Hr);if(o)for(i=0;i<o.length;++i){var a=zr(o[i]);switch(Ur(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var s=Xr(si(a.formatCode)),l=parseInt(a.numFmtId,10);if(t.NumberFmt[l]=s,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=s}qn(s,l)}break;default:if(n.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}(l,u,s),(l=o.match(r))&&function(e,t,n,r){t.Fonts=[];var i={},o=!1;(e[0].match(Hr)||[]).forEach((function(e){var a=zr(e);switch(Ur(a[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=si(a.val));break;case"<b":i.bold=a.val?ni(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?ni(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?ni(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?ni(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?ni(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?ni(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?ni(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<charset":if("1"==a.val)break;a.codepage=Pt[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=ni(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var s=pa[i.color.index];81==i.color.index&&(s=pa[1]),s||(s=pa[1]),i.color.rgb=s[0].toString(16)+s[1].toString(16)+s[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&n.themeElements&&n.themeElements.clrScheme&&(i.color.rgb=Gl(n.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<AlternateContent":case"<ext":o=!0;break;case"</AlternateContent>":case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+a[0]+" in fonts")}}))}(l,u,a,s),(l=o.match(n))&&function(e,t,n,r){t.Fills=[];var i={},o=!1;(e[0].match(Hr)||[]).forEach((function(e){var n=zr(e);switch(Ur(n[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":n.patternType&&(i.patternType=n.patternType);break;case"<bgColor":i.bgColor||(i.bgColor={}),n.indexed&&(i.bgColor.indexed=parseInt(n.indexed,10)),n.theme&&(i.bgColor.theme=parseInt(n.theme,10)),n.tint&&(i.bgColor.tint=parseFloat(n.tint)),n.rgb&&(i.bgColor.rgb=n.rgb.slice(-6));break;case"<fgColor":i.fgColor||(i.fgColor={}),n.theme&&(i.fgColor.theme=parseInt(n.theme,10)),n.tint&&(i.fgColor.tint=parseFloat(n.tint)),null!=n.rgb&&(i.fgColor.rgb=n.rgb.slice(-6));break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+n[0]+" in fills")}}))}(l,u,0,s),(l=o.match(i))&&function(e,t,n,r){t.Borders=[];var i={},o=!1;(e[0].match(Hr)||[]).forEach((function(e){var n=zr(e);switch(Ur(n[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":i={},n.diagonalUp&&(i.diagonalUp=ni(n.diagonalUp)),n.diagonalDown&&(i.diagonalDown=ni(n.diagonalDown)),t.Borders.push(i);break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+n[0]+" in borders")}}))}(l,u,0,s),(l=o.match(t))&&function(e,t,n){var r;t.CellXf=[];var i=!1;(e[0].match(Hr)||[]).forEach((function(e){var o=zr(e),a=0;switch(Ur(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(r=o)[0],a=0;a<$l.length;++a)r[$l[a]]&&(r[$l[a]]=parseInt(r[$l[a]],10));for(a=0;a<eu.length;++a)r[eu[a]]&&(r[eu[a]]=ni(r[eu[a]]));if(t.NumberFmt&&r.numFmtId>392)for(a=392;a>60;--a)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[a]){r.numFmtId=a;break}t.CellXf.push(r);break;case"<alignment":case"<alignment/>":var s={};o.vertical&&(s.vertical=o.vertical),o.horizontal&&(s.horizontal=o.horizontal),null!=o.textRotation&&(s.textRotation=o.textRotation),o.indent&&(s.indent=o.indent),o.wrapText&&(s.wrapText=ni(o.wrapText)),r.alignment=s;break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}}))}(l,u,s),u):u}}();function nu(e,t){var n,r=[Gr,yi("styleSheet",null,{xmlns:Ei[0],"xmlns:vt":Si.vt})];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=yi("numFmt",null,{numFmtId:r,formatCode:Zr(e[r])}))})),1===t.length?"":(t[t.length]="</numFmts>",t[0]=yi("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=yi("cellXfs",null),e.forEach((function(e){t[t.length]=yi("xf",null,e)})),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=yi("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ru(e,t,n){n||(n=so(6+4*t.length)),n.write_shift(2,e),No(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return null==n.l&&(n.l=n.length),r}function iu(e,t){t||(t=so(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=so(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,n),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var n=0;"superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ta(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),No(e.name,t),t.length>t.l?t.slice(0,t.l):t}var ou,au=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],su=ao;function lu(e,t){t||(t=so(84)),ou||(ou=ar(au));var n=ou[e.patternType];null==n&&(n=40),t.write_shift(4,n);var r=0;if(40!=n)for(ta({auto:1},t),ta({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function uu(e,t,n){n||(n=so(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);return n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function cu(e,t){return t||(t=so(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var du=ao;function hu(e){var t;co(e,613,Oo(1)),co(e,46,(t||(t=so(51)),t.write_shift(1,0),cu(0,t),cu(0,t),cu(0,t),cu(0,t),cu(0,t),t.length>t.l?t.slice(0,t.l):t)),co(e,614)}function fu(e){co(e,619,Oo(1)),co(e,48,function(e,t){return t||(t=so(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),zo(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}({xfId:0,builtinId:0,name:"Normal"})),co(e,620)}function pu(e){co(e,508,function(e,t,n){var r=so(2052);return r.write_shift(4,e),zo(t,r),zo(n,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),co(e,509)}function vu(e,t){var n=uo();return co(n,278),function(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach((function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++n})),0!=n&&(co(e,615,Oo(n)),[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&co(e,44,ru(r,t[r]))})),co(e,616))}}(n,e.SSF),function(e){co(e,611,Oo(1)),co(e,43,iu({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),co(e,612)}(n),function(e){co(e,603,Oo(2)),co(e,45,lu({patternType:"none"})),co(e,45,lu({patternType:"gray125"})),co(e,604)}(n),hu(n),function(e){co(e,626,Oo(1)),co(e,47,uu({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),co(e,627)}(n),function(e,t){co(e,617,Oo(t.length)),t.forEach((function(t){co(e,47,uu(t,0))})),co(e,618)}(n,t.cellXfs),fu(n),function(e){co(e,505,Oo(0)),co(e,506)}(n),pu(n),co(n,279),n.end()}var gu=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function mu(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(Hr)||[]).forEach((function(e){var i=zr(e);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=i.val;break;case"<a:sysClr":r.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===i[0].charAt(1)?(t.themeElements.clrScheme[gu.indexOf(i[0])]=r,r={}):r.name=i[0].slice(3,i[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}}))}function yu(){}function wu(){}var bu=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Cu=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Su=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var Eu=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ku(e,t){var n;e&&0!==e.length||(e=xu());var r={};if(!(n=e.match(Eu)))throw new Error("themeElements not found in theme");return function(e,t,n){var r;t.themeElements={},[["clrScheme",bu,mu],["fontScheme",Cu,yu],["fmtScheme",Su,wu]].forEach((function(i){if(!(r=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](r,t,n)}))}(n[0],r,t),r.raw=e,r}function xu(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[Gr];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function Tu(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return ao(e,t)}(e,4);break;case 2:t.xclrValue=Ss(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function Ru(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=Tu(e);break;case 6:r[1]=function(e,t){return ao(e,t)}(e,n);break;case 14:case 15:r[1]=e.read_shift(1===n?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function Au(){var e=uo();return co(e,332),co(e,334,Oo(1)),co(e,335,function(e){var t=so(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),No(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),co(e,336),co(e,339,function(e,t){var n=so(8+2*t.length);return n.write_shift(4,e),No(t,n),n.slice(0,n.l)}(1,"XLDAPR")),co(e,52),co(e,35,Oo(514)),co(e,4096,Oo(0)),co(e,4097,ls(1)),co(e,36),co(e,53),co(e,340),co(e,337,function(e,t){var n=so(8);return n.write_shift(4,e),n.write_shift(4,t?1:0),n}(1,!0)),co(e,51,function(e){var t=so(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}([[1,0]])),co(e,338),co(e,333),e.end()}function _u(){var e=[Gr];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var Ou=1024;function Du(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[yi("xml",null,{"xmlns:v":ki.v,"xmlns:o":ki.o,"xmlns:x":ki.x,"xmlns:mv":ki.mv}).replace(/\/>/,">"),yi("o:shapelayout",yi("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),yi("v:shapetype",[yi("v:stroke",null,{joinstyle:"miter"}),yi("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Ou<1e3*e;)Ou+=1e3;return t.forEach((function(e){var t=bo(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var r="gradient"==n.type?yi("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,o=yi("v:fill",r,n);++Ou,i=i.concat(["<v:shape"+mi({id:"_x0000_s"+Ou,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",o,yi("v:shadow",null,{on:"t",obscured:"t"}),yi("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",gi("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),gi("x:AutoFill","False"),gi("x:Row",String(t.r)),gi("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])})),i.push("</xml>"),i.join("")}function Nu(e,t,n,r){var i,o=Array.isArray(e);t.forEach((function(t){var a=bo(t.ref);if(o?(e[a.r]||(e[a.r]=[]),i=e[a.r][a.c]):i=e[t.ref],!i){i={t:"z"},o?e[a.r][a.c]=i:e[t.ref]=i;var s=ko(e["!ref"]||"BDWGO1000001:A1");s.s.r>a.r&&(s.s.r=a.r),s.e.r<a.r&&(s.e.r=a.r),s.s.c>a.c&&(s.s.c=a.c),s.e.c<a.c&&(s.e.c=a.c);var l=Eo(s);l!==e["!ref"]&&(e["!ref"]=l)}i.c||(i.c=[]);var u={a:t.author,t:t.t,r:t.r,T:n};t.h&&(u.h=t.h);for(var c=i.c.length-1;c>=0;--c){if(!n&&i.c[c].T)return;n&&!i.c[c].T&&i.c.splice(c,1)}if(n&&r)for(c=0;c<r.length;++c)if(u.a==r[c].id){u.a=r[c].name||u.a;break}i.c.push(u)}))}function Pu(e){var t=[Gr,yi("comments",null,{xmlns:Ei[0]})],n=[];return t.push("<authors>"),e.forEach((function(e){e[1].forEach((function(e){var r=Zr(e.a);-1==n.indexOf(r)&&(n.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==n.indexOf("tc="+e.ID)&&(n.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))}))})),0==n.length&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach((function(e){var r=0,i=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=n.indexOf("tc="+e[1][0].ID):e[1].forEach((function(e){e.a&&(r=n.indexOf(Zr(e.a))),i.push(e.t||"")})),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),i.length<=1)t.push(gi("t",Zr(i[0]||"")));else{for(var o="Comment:\n    "+i[0]+"\n",a=1;a<i.length;++a)o+="Reply:\n    "+i[a]+"\n";t.push(gi("t",Zr(o)))}t.push("</text></comment>")})),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Fu(e,t,n){var r=[Gr,yi("ThreadedComments",null,{xmlns:Si.TCMNT}).replace(/[\/]>/,">")];return e.forEach((function(e){var i="";(e[1]||[]).forEach((function(o,a){if(o.T){o.a&&-1==t.indexOf(o.a)&&t.push(o.a);var s={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};0==a?i=s.id:s.parentId=i,o.ID=s.id,o.a&&(s.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(yi("threadedComment",gi("text",o.t||""),s))}else delete o.ID}))})),r.push("</ThreadedComments>"),r.join("")}var Iu=Do;function Lu(e){var t=uo(),n=[];return co(t,628),co(t,630),e.forEach((function(e){e[1].forEach((function(e){n.indexOf(e.a)>-1||(n.push(e.a.slice(0,54)),co(t,632,function(e){return No(e.slice(0,54))}(e.a)))}))})),co(t,631),co(t,633),e.forEach((function(e){e[1].forEach((function(r){r.iauthor=n.indexOf(r.a);var i={s:bo(e[0]),e:bo(e[0])};co(t,635,function(e,t){return null==t&&(t=so(36)),t.write_shift(4,e[1].iauthor),Jo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([i,r])),r.t&&r.t.length>0&&co(t,637,Lo(r)),co(t,636),delete r.iauthor}))})),co(t,634),co(t,629),t.end()}var Mu="application/vnd.ms-office.vbaProject";var Gu=["xlsb","xlsm","xlam","biff8","xla"];var Bu=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,i){var o=!1,a=!1;0==r.length?a=!0:"["==r.charAt(0)&&(a=!0,r=r.slice(1,-1)),0==i.length?o=!0:"["==i.charAt(0)&&(o=!0,i=i.slice(1,-1));var s=r.length>0?0|parseInt(r,10):0,l=i.length>0?0|parseInt(i,10):0;return o?l+=t.c:--l,a?s+=t.r:--s,n+(o?"":"$")+wo(l)+(a?"":"$")+mo(s)}return function(r,i){return t=i,r.replace(e,n)}}(),ju=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Hu=function(){return function(e,t){return e.replace(ju,(function(e,n,r,i,o,a){var s=yo(i)-(r?0:t.c),l=go(a)-(o?0:t.r);return n+"R"+(0==l?"":o?l+1:"["+l+"]")+"C"+(0==s?"":r?s+1:"["+s+"]")}))}}();function Vu(e,t){return e.replace(ju,(function(e,n,r,i,o,a){return n+("$"==r?r+i:wo(yo(i)+t.c))+("$"==o?o+a:mo(go(a)+t.r))}))}function Wu(e,t,n){var r=So(t).s,i=bo(n);return Vu(e,{r:i.r-r.r,c:i.c-r.c})}function zu(e){return e.replace(/_xlfn\./g,"")}function Uu(e){e.l+=1}function Ku(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function qu(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return Xu(e);12==n.biff&&(r=4)}var i=e.read_shift(r),o=e.read_shift(r),a=Ku(e,2),s=Ku(e,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:o,c:s[0],cRel:s[1],rRel:s[2]}}}function Xu(e){var t=Ku(e,2),n=Ku(e,2),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function Yu(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=Ku(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),i=Ku(e,2);return{r:r,c:i[0],cRel:i[1],rRel:i[2]}}function Qu(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function Zu(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Ju(e){return[e.read_shift(1),e.read_shift(1)]}function $u(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=os(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=va[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=$o(e);break;case 2:n[1]=gs(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function ec(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),i=[],o=0;o!=r;++o)i.push((12==n.biff?Zo:As)(e,8));return i}function tc(e,t,n){var r=0,i=0;12==n.biff?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--i&&(i=256));for(var o=0,a=[];o!=r&&(a[o]=[]);++o)for(var s=0;s!=i;++s)a[o][s]=$u(e,n.biff);return a}function nc(e,t,n){return e.l+=2,[Qu(e)]}function rc(e){return e.l+=6,[]}function ic(e){return e.l+=2,[ss(e),1&e.read_shift(2)]}var oc=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var ac={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:ao},3:{n:"PtgAdd",f:Uu},4:{n:"PtgSub",f:Uu},5:{n:"PtgMul",f:Uu},6:{n:"PtgDiv",f:Uu},7:{n:"PtgPower",f:Uu},8:{n:"PtgConcat",f:Uu},9:{n:"PtgLt",f:Uu},10:{n:"PtgLe",f:Uu},11:{n:"PtgEq",f:Uu},12:{n:"PtgGe",f:Uu},13:{n:"PtgGt",f:Uu},14:{n:"PtgNe",f:Uu},15:{n:"PtgIsect",f:Uu},16:{n:"PtgUnion",f:Uu},17:{n:"PtgRange",f:Uu},18:{n:"PtgUplus",f:Uu},19:{n:"PtgUminus",f:Uu},20:{n:"PtgPercent",f:Uu},21:{n:"PtgParen",f:Uu},22:{n:"PtgMissArg",f:Uu},23:{n:"PtgStr",f:function(e,t,n){return e.l++,ds(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,va[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,$o(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[Ac[i],Rc[i],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],i=e.read_shift(1),o=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[i,(0===o[0]?Rc:Tc)[o[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,o=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,o]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,Yu(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,qu(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:ao},40:{n:"PtgMemNoMem",f:ao},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,i=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==i&&n>=128&&(n-=256),{r:t,c:n,cRel:i,rRel:r}}(e);var i=e.read_shift(r>=12?4:2),o=e.read_shift(2),a=(16384&o)>>14,s=(32768&o)>>15;if(o&=16383,1==s)for(;i>524287;)i-=1048576;if(1==a)for(;o>8191;)o-=16384;return{r:i,c:o,cRel:a,rRel:s}}(e,0,n);return[r,i]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=function(e,t,n){if(n.biff<8)return Xu(e);var r=e.read_shift(12==n.biff?4:2),i=e.read_shift(12==n.biff?4:2),o=Ku(e,2),a=Ku(e,2);return{s:{r:r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}(e,0,n);return[r,i]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,i,Yu(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12,6;break;case 12:12}return[r,i,qu(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e.read_shift(2),o=4;if(n)switch(n.biff){case 5:o=15;break;case 12:o=6}return e.l+=o,[r,i]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e.read_shift(2),o=8;if(n)switch(n.biff){case 5:e.l+=12,o=6;break;case 12:o=12}return e.l+=o,[r,i]}},255:{}},sc={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},lc={1:{n:"PtgElfLel",f:ic},2:{n:"PtgElfRw",f:nc},3:{n:"PtgElfCol",f:nc},6:{n:"PtgElfRwV",f:nc},7:{n:"PtgElfColV",f:nc},10:{n:"PtgElfRadical",f:nc},11:{n:"PtgElfRadicalS",f:rc},13:{n:"PtgElfColS",f:rc},15:{n:"PtgElfColSV",f:rc},16:{n:"PtgElfRadicalLel",f:ic},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),o=e.read_shift(2);return{ixti:t,coltype:3&n,rt:oc[n>>2&31],idx:r,c:i,C:o}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},uc={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),i=[],o=0;o<=r;++o)i.push(e.read_shift(n&&2==n.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Zu},33:{n:"PtgAttrBaxcel",f:Zu},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Ju(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Ju(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function cc(e,t,n,r){if(r.biff<8)return ao(e,t);for(var i=e.l+t,o=[],a=0;a!==n.length;++a)switch(n[a][0]){case"PtgArray":n[a][1]=tc(e,0,r),o.push(n[a][1]);break;case"PtgMemArea":n[a][2]=ec(e,n[a][1],r),o.push(n[a][2]);break;case"PtgExp":r&&12==r.biff&&(n[a][1][1]=e.read_shift(4),o.push(n[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[a][0]}return 0!==(t=i-e.l)&&o.push(ao(e,t)),o}function dc(e,t,n){for(var r,i,o=e.l+t,a=[];o!=e.l;)t=o-e.l,i=e[e.l],r=ac[i]||ac[sc[i]],24!==i&&25!==i||(r=(24===i?lc:uc)[e[e.l+1]]),r&&r.f?a.push([r.n,r.f(e,t,n)]):ao(e,t);return a}function hc(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],o=0;o<r.length;++o){var a=r[o];if(a)if(2===a[0])i.push('"'+a[1].replace(/"/g,'""')+'"');else i.push(a[1]);else i.push("")}t.push(i.join(","))}return t.join(";")}var fc={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function pc(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[r[0]][0][3]?(i=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function vc(e,t,n){var r=pc(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function gc(e,t,n,r,i){var o,a,s,l,u=i&&i.biff||8,c={s:{c:0,r:0},e:{c:0,r:0}},d=[],h=0,f=0,p="";if(!e[0]||!e[0][0])return"";for(var v=-1,g="",m=0,y=e[0].length;m<y;++m){var w=e[0][m];switch(w[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=d.pop(),a=d.pop(),v>=0){switch(e[0][v][1][0]){case 0:g=Cr(" ",e[0][v][1][1]);break;case 1:g=Cr("\r",e[0][v][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}a+=g,v=-1}d.push(a+fc[w[0]]+o);break;case"PtgIsect":o=d.pop(),a=d.pop(),d.push(a+" "+o);break;case"PtgUnion":o=d.pop(),a=d.pop(),d.push(a+","+o);break;case"PtgRange":o=d.pop(),a=d.pop(),d.push(a+":"+o);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":s=ho(w[1][1],c,i),d.push(po(s,u));break;case"PtgRefN":s=n?ho(w[1][1],n,i):w[1][1],d.push(po(s,u));break;case"PtgRef3d":h=w[1][1],s=ho(w[1][2],c,i);p=vc(r,h,i);d.push(p+"!"+po(s,u));break;case"PtgFunc":case"PtgFuncVar":var b=w[1][0],C=w[1][1];b||(b=0);var S=0==(b&=127)?[]:d.slice(-b);d.length-=b,"User"===C&&(C=S.shift()),d.push(C+"("+S.join(",")+")");break;case"PtgBool":d.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(w[1]);break;case"PtgNum":d.push(String(w[1]));break;case"PtgStr":d.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=fo(w[1][1],n?{s:n}:c,i),d.push(vo(l,i));break;case"PtgArea":l=fo(w[1][1],c,i),d.push(vo(l,i));break;case"PtgArea3d":h=w[1][1],l=w[1][2],p=vc(r,h,i),d.push(p+"!"+vo(l,i));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":f=w[1][2];var E=(r.names||[])[f-1]||(r[0]||[])[f],k=E?E.Name:"SH33TJSNAME"+String(f);k&&"_xlfn."==k.slice(0,6)&&!i.xlfn&&(k=k.slice(6)),d.push(k);break;case"PtgNameX":var x,T=w[1][1];if(f=w[1][2],!(i.biff<=5)){var R="";if(14849==((r[T]||[])[0]||[])[0]||(1025==((r[T]||[])[0]||[])[0]?r[T][f]&&r[T][f].itab>0&&(R=r.SheetNames[r[T][f].itab-1]+"!"):R=r.SheetNames[f-1]+"!"),r[T]&&r[T][f])R+=r[T][f].Name;else if(r[0]&&r[0][f])R+=r[0][f].Name;else{var A=(pc(r,T,i)||"").split(";;");A[f-1]?R=A[f-1]:R+="SH33TJSERRX"}d.push(R);break}T<0&&(T=-T),r[T]&&(x=r[T][f]),x||(x={Name:"SH33TJSERRY"}),d.push(x.Name);break;case"PtgParen":var _="(",O=")";if(v>=0){switch(g="",e[0][v][1][0]){case 2:_=Cr(" ",e[0][v][1][1])+_;break;case 3:_=Cr("\r",e[0][v][1][1])+_;break;case 4:O=Cr(" ",e[0][v][1][1])+O;break;case 5:O=Cr("\r",e[0][v][1][1])+O;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}d.push(_+d.pop()+O);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":s={c:w[1][1],r:w[1][0]};var D={c:n.c,r:n.r};if(r.sharedf[Co(s)]){var N=r.sharedf[Co(s)];d.push(gc(N,c,D,r,i))}else{var P=!1;for(o=0;o!=r.arrayf.length;++o)if(a=r.arrayf[o],!(s.c<a[0].s.c||s.c>a[0].e.c)&&!(s.r<a[0].s.r||s.r>a[0].e.r)){d.push(gc(a[1],c,D,r,i)),P=!0;break}P||d.push(w[1])}break;case"PtgArray":d.push("{"+hc(w[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=m;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(w))}if(3!=i.biff&&v>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][m][0])){var F=!0;switch((w=e[0][v])[1][0]){case 4:F=!1;case 0:g=Cr(" ",w[1][1]);break;case 5:F=!1;case 1:g=Cr("\r",w[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}d.push((F?g:"")+d.pop()+(F?"":g)),v=-1}}if(d.length>1&&i.WTF)throw new Error("bad formula stack");return d[0]}function mc(e,t,n){var r,i=e.l+t,o=2==n.biff?1:2,a=e.read_shift(o);if(65535==a)return[[],ao(e,t-2)];var s=dc(e,a,n);return t!==a+o&&(r=cc(e,t-a-o,s,n)),e.l=i,[s,r]}function yc(e,t,n){var r,i=e.l+t,o=e.read_shift(2),a=dc(e,o,n);return 65535==o?[[],ao(e,t-2)]:(t!==o+2&&(r=cc(e,i-o-2,a,n)),[a,r])}function wc(e,t,n){var r=e.l+t,i=ks(e);2==n.biff&&++e.l;var o=function(e){var t;if(65535!==Xi(e,e.l+6))return[$o(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),a=e.read_shift(1);2!=n.biff&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var s=function(e,t,n){var r,i=e.l+t,o=2==n.biff?1:2,a=e.read_shift(o);if(65535==a)return[[],ao(e,t-2)];var s=dc(e,a,n);return t!==a+o&&(r=cc(e,t-a-o,s,n)),e.l=i,[s,r]}(e,r-e.l,n);return{cell:i,val:o[0],formula:s,shared:a>>3&1,tt:o[1]}}function bc(e,t,n,r,i){var o=xs(t,n,i),a=function(e){if(null==e){var t=so(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return ea("number"==typeof e?e:0)}(e.v),s=so(6);s.write_shift(2,33),s.write_shift(4,0);for(var l=so(e.bf.length),u=0;u<e.bf.length;++u)l[u]=e.bf[u];return tn([o,a,s,l])}function Cc(e,t,n){var r=e.read_shift(4),i=dc(e,r,n),o=e.read_shift(4);return[i,o>0?cc(e,o,i,n):null]}var Sc=Cc,Ec=Cc,kc=Cc,xc=Cc,Tc={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Rc={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Ac={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _c(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Oc(e){return("of:="+e.replace(ju,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function Dc(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Nc(e){return e.replace(/\./,"!")}var Pc={},Fc={},Ic="undefined"!==typeof Map;function Lc(e,t,n){var r=0,i=e.length;if(n){if(Ic?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var o=Ic?n.get(t):n[t];r<o.length;++r)if(e[o[r]].t===t)return e.Count++,o[r]}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t:t},e.Count++,e.Unique++,n&&(Ic?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function Mc(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(Vl=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?r=zl(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(n.width=Ul(r),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),null!=t.level&&(n.outlineLevel=n.level=t.level),n}function Gc(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function Bc(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],i=60,o=e.length;if(null==r&&n.ssf)for(;i<392;++i)if(null==n.ssf[i]){qn(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}for(i=0;i!=o;++i)if(e[i].numFmtId===r)return i;return e[o]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function jc(e,t,n,r,i,o){try{r.cellNF&&(e.z=pn[t])}catch(s){if(r.WTF)throw s}if("z"!==e.t||r.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=yr(e.v)),(!r||!1!==r.cellText)&&"z"!==e.t)try{if(null==pn[t]&&qn(Zn[t]||"General",t),"e"===e.t)e.w=e.w||va[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=kn(e.v);else if("d"===e.t){var a=ur(e.v);e.w=(0|a)===a?a.toString(10):kn(a)}else{if(void 0===e.v)return"";e.w=xn(e.v,Fc)}else"d"===e.t?e.w=Kn(t,ur(e.v),Fc):e.w=Kn(t,e.v,Fc)}catch(s){if(r.WTF)throw s}if(r.cellStyles&&null!=n)try{e.s=o.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Gl(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Gl(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(s){if(r.WTF&&o.Fills)throw s}}}function Hc(e,t,n){if(e&&e["!ref"]){var r=ko(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var Vc=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Wc=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,zc=/<(?:\w:)?hyperlink [^>]*>/gm,Uc=/"(\w*:\w*)"/,Kc=/<(?:\w:)?col\b[^>]*[\/]?>/g,qc=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Xc=/<(?:\w:)?pageMargins[^>]*\/>/g,Yc=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Qc=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Zc=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Jc(e,t,n,r,i,o,a){if(!e)return e;r||(r={"!id":{}}),null!=Wt&&null==t.dense&&(t.dense=Wt);var s=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",c="",d=e.match(Wc);d?(u=e.slice(0,d.index),c=e.slice(d.index+d[0].length)):u=c=e;var h=u.match(Yc);h?$c(h[0],s,i,n):(h=u.match(Qc))&&function(e,t,n,r,i){$c(e.slice(0,e.indexOf(">")),n,r,i)}(h[0],h[1],s,i,n);var f=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=u.slice(f,f+50).match(Uc);p&&function(e,t){var n=ko(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=Eo(n))}(s,p[1])}var v=u.match(Zc);v&&v[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(nd)||[]).forEach((function(e,n){var r=zr(e);t.Views[n]||(t.Views[n]={}),+r.zoomScale&&(t.Views[n].zoom=+r.zoomScale),ni(r.rightToLeft)&&(t.Views[n].RTL=!0)}))}(v[1],i);var g=[];if(t.cellStyles){var m=u.match(Kc);m&&function(e,t){for(var n=!1,r=0;r!=t.length;++r){var i=zr(t[r],!0);i.hidden&&(i.hidden=ni(i.hidden));var o=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!n&&i.width&&(n=!0,ql(i.width)),Xl(i);o<=a;)e[o++]=br(i)}}(g,m)}d&&id(d[1],s,t,l,o,a);var y=c.match(qc);y&&(s["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(y[0]));var w=[],b=c.match(Vc);if(b)for(f=0;f!=b.length;++f)w[f]=ko(b[f].slice(b[f].indexOf('"')+1));var C=c.match(zc);C&&function(e,t,n){for(var r=Array.isArray(e),i=0;i!=t.length;++i){var o=zr(si(t[i]),!0);if(!o.ref)return;var a=((n||{})["!id"]||[])[o.id];a?(o.Target=a.Target,o.location&&(o.Target+="#"+Xr(o.location))):(o.Target="#"+Xr(o.location),a={Target:o.Target,TargetMode:"Internal"}),o.Rel=a,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var s=ko(o.ref),l=s.s.r;l<=s.e.r;++l)for(var u=s.s.c;u<=s.e.c;++u){var c=Co({c:u,r:l});r?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=o):(e[c]||(e[c]={t:"z",v:void 0}),e[c].l=o)}}}(s,C,r);var S=c.match(Xc);if(S&&(s["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach((function(n){e[n]&&(t[n]=parseFloat(e[n]))})),t}(zr(S[0]))),!s["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(s["!ref"]=Eo(l)),t.sheetRows>0&&s["!ref"]){var E=ko(s["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),s["!fullref"]=s["!ref"],s["!ref"]=Eo(E))}return g.length>0&&(s["!cols"]=g),w.length>0&&(s["!merges"]=w),s}function $c(e,t,n,r){var i=zr(e);n.Sheets[r]||(n.Sheets[r]={}),i.codeName&&(n.Sheets[r].CodeName=Xr(si(i.codeName)))}var ed=["objects","scenarios","selectLockedCells","selectUnlockedCells"],td=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var nd=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function rd(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var i="",o=e.t,a=e.v;if("z"!==e.t)switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=va[e.v];break;case"d":r&&r.cellDates?i=yr(e.v,-1).toISOString():((e=br(e)).t="n",i=""+(e.v=ur(yr(e.v)))),"undefined"===typeof e.z&&(e.z=pn[14]);break;default:i=e.v}var s=gi("v",Zr(i)),l={r:t},u=Bc(r.cellXfs,e,r);switch(0!==u&&(l.s=u),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){s=gi("v",""+Lc(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=o&&(e.t=o,e.v=a),"string"==typeof e.f&&e.f){var c=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;s=yi("f",Zr(e.f),c)+(null!=e.v?s:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),yi("c",s,l)}var id=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=ui("v"),a=ui("f");return function(s,l,u,c,d,h){for(var f,p,v,g,m,y=0,w="",b=[],C=[],S=0,E=0,k=0,x="",T=0,R=0,A=0,_=0,O=Array.isArray(h.CellXf),D=[],N=[],P=Array.isArray(l),F=[],I={},L=!1,M=!!u.sheetStubs,G=s.split(t),B=0,j=G.length;B!=j;++B){var H=(w=G[B].trim()).length;if(0!==H){var V=0;e:for(y=0;y<H;++y)switch(w[y]){case">":if("/"!=w[y-1]){++y;break e}if(u&&u.cellStyles){if(T=null!=(p=zr(w.slice(V,y),!0)).r?parseInt(p.r,10):T+1,R=-1,u.sheetRows&&u.sheetRows<T)continue;I={},L=!1,p.ht&&(L=!0,I.hpt=parseFloat(p.ht),I.hpx=Zl(I.hpt)),"1"==p.hidden&&(L=!0,I.hidden=!0),null!=p.outlineLevel&&(L=!0,I.level=+p.outlineLevel),L&&(F[T-1]=I)}break;case"<":V=y}if(V>=y)break;if(T=null!=(p=zr(w.slice(V,y),!0)).r?parseInt(p.r,10):T+1,R=-1,!(u.sheetRows&&u.sheetRows<T)){c.s.r>T-1&&(c.s.r=T-1),c.e.r<T-1&&(c.e.r=T-1),u&&u.cellStyles&&(I={},L=!1,p.ht&&(L=!0,I.hpt=parseFloat(p.ht),I.hpx=Zl(I.hpt)),"1"==p.hidden&&(L=!0,I.hidden=!0),null!=p.outlineLevel&&(L=!0,I.level=+p.outlineLevel),L&&(F[T-1]=I)),b=w.slice(y).split(e);for(var W=0;W!=b.length&&"<"==b[W].trim().charAt(0);++W);for(b=b.slice(W),y=0;y!=b.length;++y)if(0!==(w=b[y].trim()).length){if(C=w.match(n),S=y,E=0,k=0,w="<c "+("<"==w.slice(0,1)?">":"")+w,null!=C&&2===C.length){for(S=0,x=C[1],E=0;E!=x.length&&!((k=x.charCodeAt(E)-64)<1||k>26);++E)S=26*S+k;R=--S}else++R;for(E=0;E!=w.length&&62!==w.charCodeAt(E);++E);if(++E,(p=zr(w.slice(0,E),!0)).r||(p.r=Co({r:T-1,c:R})),f={t:""},null!=(C=(x=w.slice(E)).match(o))&&""!==C[1]&&(f.v=Xr(C[1])),u.cellFormula){if(null!=(C=x.match(a))&&""!==C[1]){if(f.f=Xr(si(C[1])).replace(/\r\n/g,"\n"),u.xlfn||(f.f=zu(f.f)),C[0].indexOf('t="array"')>-1)f.F=(x.match(i)||[])[1],f.F.indexOf(":")>-1&&D.push([ko(f.F),f.F]);else if(C[0].indexOf('t="shared"')>-1){g=zr(C[0]);var z=Xr(si(C[1]));u.xlfn||(z=zu(z)),N[parseInt(g.si,10)]=[g,z,p.r]}}else(C=x.match(/<f[^>]*\/>/))&&N[(g=zr(C[0])).si]&&(f.f=Wu(N[g.si][1],N[g.si][2],p.r));var U=bo(p.r);for(E=0;E<D.length;++E)U.r>=D[E][0].s.r&&U.r<=D[E][0].e.r&&U.c>=D[E][0].s.c&&U.c<=D[E][0].e.c&&(f.F=D[E][1])}if(null==p.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!M)continue;f.t="z"}else f.t=p.t||"n";switch(c.s.c>R&&(c.s.c=R),c.e.c<R&&(c.e.c=R),f.t){case"n":if(""==f.v||null==f.v){if(!M)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if("undefined"==typeof f.v){if(!M)continue;f.t="z"}else v=Pc[parseInt(f.v,10)],f.v=v.t,f.r=v.r,u.cellHTML&&(f.h=v.h);break;case"str":f.t="s",f.v=null!=f.v?si(f.v):"",u.cellHTML&&(f.h=ei(f.v));break;case"inlineStr":C=x.match(r),f.t="s",null!=C&&(v=vl(C[1]))?(f.v=v.t,u.cellHTML&&(f.h=v.h)):f.v="";break;case"b":f.v=ni(f.v);break;case"d":u.cellDates?f.v=yr(f.v,1):(f.v=ur(yr(f.v,1)),f.t="n");break;case"e":u&&!1===u.cellText||(f.w=f.v),f.v=ga[f.v]}if(A=_=0,m=null,O&&void 0!==p.s&&null!=(m=h.CellXf[p.s])&&(null!=m.numFmtId&&(A=m.numFmtId),u.cellStyles&&null!=m.fillId&&(_=m.fillId)),jc(f,A,_,u,d,h),u.cellDates&&O&&"n"==f.t&&Vn(pn[A])&&(f.t="d",f.v=fr(f.v)),p.cm&&u.xlmeta){var K=(u.xlmeta.Cell||[])[+p.cm-1];K&&"XLDAPR"==K.type&&(f.D=!0)}if(P){var q=bo(p.r);l[q.r]||(l[q.r]=[]),l[q.r][q.c]=f}else l[p.r]=f}}}}F.length>0&&(l["!rows"]=F)}}();function od(e,t,n,r){var i,o=[Gr,yi("worksheet",null,{xmlns:Ei[0],"xmlns:r":Si.r})],a=n.SheetNames[e],s="",l=n.Sheets[a];null==l&&(l={});var u=l["!ref"]||"A1",c=ko(u);if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),u=Eo(c)}r||(r={}),l["!comments"]=[];var d=[];!function(e,t,n,r,i){var o=!1,a={},s=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch(c){}o=!0,a.codeName=li(Zr(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),s=(s||"")+yi("outlinePr",null,u)}(o||s)&&(i[i.length]=yi("sheetPr",s,a))}(l,n,e,t,o),o[o.length]=yi("dimension",null,{ref:u}),o[o.length]=function(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),yi("sheetViews",yi("sheetView",null,i),{})}(0,0,0,n),t.sheetFormat&&(o[o.length]=yi("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(o[o.length]=function(e,t){for(var n,r=["<cols>"],i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=yi("col",null,Mc(i,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),o[i=o.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(s=function(e,t,n,r){var i,o,a=[],s=[],l=ko(e["!ref"]),u="",c="",d=[],h=0,f=0,p=e["!rows"],v=Array.isArray(e),g={r:c},m=-1;for(f=l.s.c;f<=l.e.c;++f)d[f]=wo(f);for(h=l.s.r;h<=l.e.r;++h){for(s=[],c=mo(h),f=l.s.c;f<=l.e.c;++f){i=d[f]+c;var y=v?(e[h]||[])[f]:e[i];void 0!==y&&null!=(u=rd(y,i,e,t))&&s.push(u)}(s.length>0||p&&p[h])&&(g={r:c},p&&p[h]&&((o=p[h]).hidden&&(g.hidden=1),m=-1,o.hpx?m=Ql(o.hpx):o.hpt&&(m=o.hpt),m>-1&&(g.ht=m,g.customHeight=1),o.level&&(g.outlineLevel=o.level)),a[a.length]=yi("row",s.join(""),g))}if(p)for(;h<p.length;++h)p&&p[h]&&(g={r:h+1},(o=p[h]).hidden&&(g.hidden=1),m=-1,o.hpx?m=Ql(o.hpx):o.hpt&&(m=o.hpt),m>-1&&(g.ht=m,g.customHeight=1),o.level&&(g.outlineLevel=o.level),a[a.length]=yi("row","",g));return a.join("")}(l,t,0,0),s.length>0&&(o[o.length]=s)),o.length>i+1&&(o[o.length]="</sheetData>",o[i]=o[i].replace("/>",">")),l["!protect"]&&(o[o.length]=function(e){var t={sheet:1};return ed.forEach((function(n){null!=e[n]&&e[n]&&(t[n]="1")})),td.forEach((function(n){null==e[n]||e[n]||(t[n]="0")})),e.password&&(t.password=Nl(e.password).toString(16).toUpperCase()),yi("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(o[o.length]=function(e,t,n,r){var i="string"==typeof e.ref?e.ref:Eo(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,a=So(i);a.s.r==a.e.r&&(a.e.r=So(t["!ref"]).e.r,i=Eo(a));for(var s=0;s<o.length;++s){var l=o[s];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return s==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),yi("autoFilter",null,{ref:i})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(o[o.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+Eo(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var h,f,p=-1,v=-1;return l["!links"].length>0&&(o[o.length]="<hyperlinks>",l["!links"].forEach((function(e){e[1].Target&&(h={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(v=ka(r,-1,Zr(e[1].Target).replace(/#.*$/,""),ba.HLINK),h["r:id"]="rId"+v),(p=e[1].Target.indexOf("#"))>-1&&(h.location=Zr(e[1].Target.slice(p+1))),e[1].Tooltip&&(h.tooltip=Zr(e[1].Tooltip)),o[o.length]=yi("hyperlink",null,h))})),o[o.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(o[o.length]=(Gc(f=l["!margins"]),yi("pageMargins",null,f))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(o[o.length]=gi("ignoredErrors",yi("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(v=ka(r,-1,"../drawings/drawing"+(e+1)+".xml",ba.DRAW),o[o.length]=yi("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=d),l["!comments"].length>0&&(v=ka(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ba.VML),o[o.length]=yi("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function ad(e,t,n,r){var i=function(e,t,n){var r=so(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var o=320;i.hpx?o=20*Ql(i.hpx):i.hpt&&(o=20*i.hpt),r.write_shift(2,o),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var s=0,l=r.l;r.l+=4;for(var u={r:e,c:0},c=0;c<16;++c)if(!(t.s.c>c+1<<10||t.e.c<c<<10)){for(var d=-1,h=-1,f=c<<10;f<c+1<<10;++f)u.c=f,(Array.isArray(n)?(n[u.r]||[])[u.c]:n[Co(u)])&&(d<0&&(d=f),h=f);d<0||(++s,r.write_shift(4,d),r.write_shift(4,h))}var p=r.l;return r.l=l,r.write_shift(4,s),r.l=p,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&co(e,0,i)}var sd=Zo,ld=Jo;function ud(e){return[Bo(e),$o(e),"n"]}var cd=Zo,dd=Jo;var hd=["left","right","top","bottom","header","footer"];function fd(e,t,n,r,i,o,a){if(void 0===t.v)return!1;var s="";switch(t.t){case"b":s=t.v?"1":"0";break;case"d":(t=br(t)).z=t.z||pn[14],t.v=ur(yr(t.v)),t.t="n";break;case"n":case"e":s=""+t.v;break;default:s=t.v}var l={r:n,c:r};switch(l.s=Bc(i.cellXfs,t,i),t.l&&o["!links"].push([Co(l),t.l]),t.c&&o["!comments"].push([Co(l),t.c]),t.t){case"s":case"str":return i.bookSST?(s=Lc(i.Strings,t.v,i.revStrings),l.t="s",l.v=s,a?co(e,18,function(e,t,n){return null==n&&(n=so(8)),jo(t,n),n.write_shift(4,t.v),n}(0,l)):co(e,7,function(e,t,n){return null==n&&(n=so(12)),Go(t,n),n.write_shift(4,t.v),n}(0,l))):(l.t="str",a?co(e,17,function(e,t,n){return null==n&&(n=so(8+4*e.v.length)),jo(t,n),No(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l)):co(e,6,function(e,t,n){return null==n&&(n=so(12+4*e.v.length)),Go(t,n),No(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?a?co(e,13,function(e,t,n){return null==n&&(n=so(8)),jo(t,n),Yo(e.v,n),n}(t,l)):co(e,2,function(e,t,n){return null==n&&(n=so(12)),Go(t,n),Yo(e.v,n),n}(t,l)):a?co(e,16,function(e,t,n){return null==n&&(n=so(12)),jo(t,n),ea(e.v,n),n}(t,l)):co(e,5,function(e,t,n){return null==n&&(n=so(16)),Go(t,n),ea(e.v,n),n}(t,l)),!0;case"b":return l.t="b",a?co(e,15,function(e,t,n){return null==n&&(n=so(5)),jo(t,n),n.write_shift(1,e.v?1:0),n}(t,l)):co(e,4,function(e,t,n){return null==n&&(n=so(9)),Go(t,n),n.write_shift(1,e.v?1:0),n}(t,l)),!0;case"e":return l.t="e",a?co(e,14,function(e,t,n){return null==n&&(n=so(8)),jo(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}(t,l)):co(e,3,function(e,t,n){return null==n&&(n=so(9)),Go(t,n),n.write_shift(1,e.v),n}(t,l)),!0}return a?co(e,12,function(e,t,n){return null==n&&(n=so(4)),jo(t,n)}(0,l)):co(e,1,function(e,t,n){return null==n&&(n=so(8)),Go(t,n)}(0,l)),!0}function pd(e,t){var n,r;t&&t["!merges"]&&(co(e,177,(n=t["!merges"].length,null==r&&(r=so(4)),r.write_shift(4,n),r)),t["!merges"].forEach((function(t){co(e,176,dd(t))})),co(e,178))}function vd(e,t){t&&t["!cols"]&&(co(e,390),t["!cols"].forEach((function(t,n){t&&co(e,60,function(e,t,n){null==n&&(n=so(18));var r=Mc(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,256*(r.width||10)),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),"number"==typeof r.width&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}(n,t))})),co(e,391))}function gd(e,t){t&&t["!ref"]&&(co(e,648),co(e,649,function(e){var t=so(24);return t.write_shift(4,4),t.write_shift(4,1),Jo(e,t),t}(ko(t["!ref"]))),co(e,650))}function md(e,t,n){t["!links"].forEach((function(t){if(t[1].Target){var r=ka(n,-1,t[1].Target.replace(/#.*$/,""),ba.HLINK);co(e,494,function(e,t){var n=so(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Jo({s:bo(e[0]),e:bo(e[0])},n),qo("rId"+t,n);var r=e[1].Target.indexOf("#");return No((-1==r?"":e[1].Target.slice(r+1))||"",n),No(e[1].Tooltip||"",n),No("",n),n.slice(0,n.l)}(t,r))}})),delete t["!links"]}function yd(e,t,n){co(e,133),co(e,137,function(e,t,n){null==n&&(n=so(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}(0,n)),co(e,138),co(e,134)}function wd(e,t){var n,r;t["!protect"]&&co(e,535,(n=t["!protect"],null==r&&(r=so(66)),r.write_shift(2,n.password?Nl(n.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach((function(e){e[1]?r.write_shift(4,null==n[e[0]]||n[e[0]]?0:1):r.write_shift(4,null!=n[e[0]]&&n[e[0]]?0:1)})),r))}function bd(e,t,n,r){var i=uo(),o=n.SheetNames[e],a=n.Sheets[o]||{},s=o;try{n&&n.Workbook&&(s=n.Workbook.Sheets[e].CodeName||s)}catch(d){}var l,u,c=ko(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],co(i,129),(n.vbaraw||a["!outline"])&&co(i,147,function(e,t,n){null==n&&(n=so(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return ta({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),Vo(e,n),n.slice(0,n.l)}(s,a["!outline"])),co(i,148,ld(c)),yd(i,0,n.Workbook),vd(i,a),function(e,t,n,r){var i,o=ko(t["!ref"]||"A1"),a="",s=[];co(e,145);var l=Array.isArray(t),u=o.e.r;t["!rows"]&&(u=Math.max(o.e.r,t["!rows"].length-1));for(var c=o.s.r;c<=u;++c){a=mo(c),ad(e,t,o,c);var d=!1;if(c<=o.e.r)for(var h=o.s.c;h<=o.e.c;++h){c===o.s.r&&(s[h]=wo(h)),i=s[h]+a;var f=l?(t[c]||[])[h]:t[i];d=!!f&&fd(e,f,c,h,r,t,d)}}co(e,146)}(i,a,0,t),wd(i,a),function(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],o="string"===typeof i.ref?i.ref:Eo(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var a=n.Workbook.Names,s=So(o);s.s.r==s.e.r&&(s.e.r=So(t["!ref"]).e.r,o=Eo(s));for(var l=0;l<a.length;++l){var u=a[l];if("_xlnm._FilterDatabase"==u.Name&&u.Sheet==r){u.Ref="'"+n.SheetNames[r]+"'!"+o;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+o}),co(e,161,Jo(ko(o))),co(e,162)}}(i,a,n,e),pd(i,a),md(i,a,r),a["!margins"]&&co(i,476,(l=a["!margins"],null==u&&(u=so(48)),Gc(l),hd.forEach((function(e){ea(l[e],u)})),u)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||gd(i,a),function(e,t,n,r){if(t["!comments"].length>0){var i=ka(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",ba.VML);co(e,551,qo("rId"+i)),t["!legacy"]=i}}(i,a,e,r),co(i,130),i.end()}function Cd(e,t,n,r,i,o){var a=o||{"!type":"chart"};if(!e)return o;var s=0,l=0,u="A",c={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var t=function(e){var t,n=[],r=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(n[+t[1]]=r?+t[2]:t[2])}));var i=Xr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){t=e.replace(/<.*?>/g,"")})),[n,i,t]}(e);c.s.r=c.s.c=0,c.e.c=s,u=wo(s),t[0].forEach((function(e,n){a[u+mo(n)]={t:"n",v:e,z:t[1]},l=n})),c.e.r<l&&(c.e.r=l),++s})),s>0&&(a["!ref"]=Eo(c)),a}var Sd=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Ed=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],kd=[],xd=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Td(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],i=0;i!=t.length;++i){var o=t[i];if(null==r[o[0]])r[o[0]]=o[1];else switch(o[2]){case"bool":"string"==typeof r[o[0]]&&(r[o[0]]=ni(r[o[0]]));break;case"int":"string"==typeof r[o[0]]&&(r[o[0]]=parseInt(r[o[0]],10))}}}function Rd(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(null==e[r[0]])e[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof e[r[0]]&&(e[r[0]]=ni(e[r[0]]));break;case"int":"string"==typeof e[r[0]]&&(e[r[0]]=parseInt(e[r[0]],10))}}}function Ad(e){Rd(e.WBProps,Sd),Rd(e.CalcPr,xd),Td(e.WBView,Ed),Td(e.Sheets,kd),Fc.date1904=ni(e.WBProps.date1904)}var _d="][*?/\\".split("");function Od(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return _d.forEach((function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}})),n}function Dd(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];!function(e,t,n){e.forEach((function(r,i){Od(r);for(var o=0;o<i;++o)if(r==e[o])throw new Error("Duplicate Sheet Name: "+r);if(n){var a=t&&t[i]&&t[i].CodeName||r;if(95==a.charCodeAt(0)&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}}))}(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)Hc(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}var Nd=/<\w+:workbook/;function Pd(e){var t=[Gr];t[t.length]=yi("workbook",null,{xmlns:Ei[0],"xmlns:r":Si.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Sd.forEach((function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])})),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=yi("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],o=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&i[o]&&i[o].Hidden;++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var a={name:Zr(e.SheetNames[o].slice(0,31))};if(a.sheetId=""+(o+1),a["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden"}t[t.length]=yi("sheet",null,a)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach((function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=yi("definedName",Zr(e.Ref),n))})),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Fd(e,t){return t||(t=so(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),qo(e.strRelID,t),No(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Id(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function Ld(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n,r,i=t.Workbook.Sheets,o=0,a=-1,s=-1;o<i.length;++o)!i[o]||!i[o].Hidden&&-1==a?a=o:1==i[o].Hidden&&-1==s&&(s=o);if(!(s>a))co(e,135),co(e,158,(n=a,r||(r=so(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,n),r.write_shift(4,n),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),co(e,136)}}function Md(e,t){var n=uo();return co(n,131),co(n,128,function(e,t){t||(t=so(127));for(var n=0;4!=n;++n)t.write_shift(4,0);return No("SheetJS",t),No(_t.version,t),No(_t.version,t),No("7262",t),t.length>t.l?t.slice(0,t.l):t}()),co(n,153,function(e,t){t||(t=so(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),Vo(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),Ld(n,e),function(e,t){co(e,143);for(var n=0;n!=t.SheetNames.length;++n)co(e,156,Fd({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]}));co(e,144)}(n,e),co(n,132),n.end()}function Gd(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],i=!1;t||(t={}),t.biff=12;var o=[],a=[[]];return a.SheetNames=[],a.XTI=[],Sh[16]={n:"BrtFRTArchID$",f:Id},lo(e,(function(e,s,l){switch(l){case 156:a.SheetNames.push(e.name),n.Sheets.push(e);break;case 153:n.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=gc(e.Ptg,0,null,a,t),delete t.SID,delete e.Ptg,o.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:a[0].length?a.push([l,e]):a[0]=[l,e],a[a.length-1].XTI=[];break;case 362:0===a.length&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(e),a.XTI=a.XTI.concat(e);break;case 35:case 37:r.push(l),i=!0;break;case 36:case 38:r.pop(),i=!1;break;default:if(s.T);else if(!i||t.WTF&&37!=r[r.length-1]&&35!=r[r.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}}),t),Ad(n),n.Names=o,n.supbooks=a,n}(e,n):function(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,i="xmlns",o={},a=0;if(e.replace(Hr,(function(s,l){var u=zr(s);switch(Ur(u[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":s.match(Nd)&&(i="xmlns"+s.match(/<(\w+):/)[1]),n.xmlns=u[i];break;case"<fileVersion":delete u[0],n.AppVersion=u;break;case"<workbookPr":case"<workbookPr/>":Sd.forEach((function(e){if(null!=u[e[0]])switch(e[2]){case"bool":n.WBProps[e[0]]=ni(u[e[0]]);break;case"int":n.WBProps[e[0]]=parseInt(u[e[0]],10);break;default:n.WBProps[e[0]]=u[e[0]]}})),u.codeName&&(n.WBProps.CodeName=si(u.codeName));break;case"<workbookView":case"<workbookView/>":delete u[0],n.WBView.push(u);break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Xr(si(u.name)),delete u[0],n.Sheets.push(u);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":r=!1;break;case"<definedName":(o={}).Name=si(u.name),u.comment&&(o.Comment=u.comment),u.localSheetId&&(o.Sheet=+u.localSheetId),ni(u.hidden||"0")&&(o.Hidden=!0),a=l+s.length;break;case"</definedName>":o.Ref=Xr(si(e.slice(a,l))),n.Names.push(o);break;case"<calcPr":case"<calcPr/>":delete u[0],n.CalcPr=u;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return s})),-1===Ei.indexOf(n.xmlns))throw new Error("Unknown Namespace: "+n.xmlns);return Ad(n),n}(e,n)}function Bd(e,t,n,r,i,o,a,s){return".bin"===t.slice(-4)?function(e,t,n,r,i,o,a){if(!e)return e;var s=t||{};r||(r={"!id":{}}),null!=Wt&&null==s.dense&&(s.dense=Wt);var l,u,c,d,h,f,p,v,g,m,y=s.dense?[]:{},w={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=[],C=!1,S=!1,E=[];s.biff=12,s["!row"]=0;var k=0,x=!1,T=[],R={},A=s.supbooks||i.supbooks||[[]];if(A.sharedf=R,A.arrayf=T,A.SheetNames=i.SheetNames||i.Sheets.map((function(e){return e.name})),!s.supbooks&&(s.supbooks=A,i.Names))for(var _=0;_<i.Names.length;++_)A[0][_+1]=i.Names[_];var O,D,N=[],P=[],F=!1;if(Sh[16]={n:"BrtShortReal",f:ud},lo(e,(function(e,t,_){if(!S)switch(_){case 148:l=e;break;case 0:u=e,s.sheetRows&&s.sheetRows<=u.r&&(S=!0),g=mo(h=u.r),s["!row"]=u.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=Zl(e.hpt)),P[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(c={t:e[2]},e[2]){case"n":c.v=e[1];break;case"s":v=Pc[e[1]],c.v=v.t,c.r=v.r;break;case"b":c.v=!!e[1];break;case"e":c.v=e[1],!1!==s.cellText&&(c.w=va[c.v]);break;case"str":c.t="s",c.v=e[1];break;case"is":c.t="s",c.v=e[1].t}if((d=a.CellXf[e[0].iStyleRef])&&jc(c,d.numFmtId,null,s,o,a),f=-1==e[0].c?f+1:e[0].c,s.dense?(y[h]||(y[h]=[]),y[h][f]=c):y[wo(f)+g]=c,s.cellFormula){for(x=!1,k=0;k<T.length;++k){var I=T[k];u.r>=I[0].s.r&&u.r<=I[0].e.r&&f>=I[0].s.c&&f<=I[0].e.c&&(c.F=Eo(I[0]),x=!0)}!x&&e.length>3&&(c.f=e[3])}if(w.s.r>u.r&&(w.s.r=u.r),w.s.c>f&&(w.s.c=f),w.e.r<u.r&&(w.e.r=u.r),w.e.c<f&&(w.e.c=f),s.cellDates&&d&&"n"==c.t&&Vn(pn[d.numFmtId])){var L=yn(c.v);L&&(c.t="d",c.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}O&&("XLDAPR"==O.type&&(c.D=!0),O=void 0),D&&(D=void 0);break;case 1:case 12:if(!s.sheetStubs||C)break;c={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,s.dense?(y[h]||(y[h]=[]),y[h][f]=c):y[wo(f)+g]=c,w.s.r>u.r&&(w.s.r=u.r),w.s.c>f&&(w.s.c=f),w.e.r<u.r&&(w.e.r=u.r),w.e.c<f&&(w.e.c=f),O&&("XLDAPR"==O.type&&(c.D=!0),O=void 0),D&&(D=void 0);break;case 176:E.push(e);break;case 49:O=((s.xlmeta||{}).Cell||[])[e-1];break;case 494:var M=r["!id"][e.relId];for(M?(e.Target=M.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=M):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)s.dense?(y[h]||(y[h]=[]),y[h][f]||(y[h][f]={t:"z",v:void 0}),y[h][f].l=e):(p=Co({c:f,r:h}),y[p]||(y[p]={t:"z",v:void 0}),y[p].l=e);break;case 426:if(!s.cellFormula)break;T.push(e),(m=s.dense?y[h][f]:y[wo(f)+g]).f=gc(e[1],0,{r:u.r,c:f},A,s),m.F=Eo(e[0]);break;case 427:if(!s.cellFormula)break;R[Co(e[0].s)]=e[1],(m=s.dense?y[h][f]:y[wo(f)+g]).f=gc(e[1],0,{r:u.r,c:f},A,s);break;case 60:if(!s.cellStyles)break;for(;e.e>=e.s;)N[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},F||(F=!0,ql(e.w/256)),Xl(N[e.e+1]);break;case 161:y["!autofilter"]={ref:Eo(e)};break;case 476:y["!margins"]=e;break;case 147:i.Sheets[n]||(i.Sheets[n]={}),e.name&&(i.Sheets[n].CodeName=e.name),(e.above||e.left)&&(y["!outline"]={above:e.above,left:e.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),e.RTL&&(i.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:C=!0;break;case 36:C=!1;break;case 37:b.push(_),C=!0;break;case 38:b.pop(),C=!1;break;default:if(t.T);else if(!C||s.WTF)throw new Error("Unexpected record 0x"+_.toString(16))}}),s),delete s.supbooks,delete s["!row"],!y["!ref"]&&(w.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(y["!ref"]=Eo(l||w)),s.sheetRows&&y["!ref"]){var I=ko(y["!ref"]);s.sheetRows<=+I.e.r&&(I.e.r=s.sheetRows-1,I.e.r>w.e.r&&(I.e.r=w.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>w.e.c&&(I.e.c=w.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),y["!fullref"]=y["!ref"],y["!ref"]=Eo(I))}return E.length>0&&(y["!merges"]=E),N.length>0&&(y["!cols"]=N),P.length>0&&(y["!rows"]=P),y}(e,r,n,i,o,a,s):Jc(e,r,n,i,o,a,s)}function jd(e,t,n,r,i,o,a,s){return".bin"===t.slice(-4)?function(e,t,n,r,i){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},a=[],s=!1;return lo(e,(function(e,r,l){switch(l){case 550:o["!rel"]=e;break;case 651:i.Sheets[n]||(i.Sheets[n]={}),e.name&&(i.Sheets[n].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(l);break;case 38:a.pop();break;default:if(r.T>0)a.push(l);else if(r.T<0)a.pop();else if(!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}(e,r,n,i,o):function(e,t,n,r,i){if(!e)return e;r||(r={"!id":{}});var o,a={"!type":"chart","!drawel":null,"!rel":""},s=e.match(Yc);return s&&$c(s[0],0,i,n),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),r["!id"][a["!rel"]]&&(a["!drawel"]=r["!id"][a["!rel"]]),a}(e,0,n,i,o)}function Hd(e,t,n,r){return".bin"===t.slice(-4)?function(e,t,n){var r={NumberFmt:[]};for(var i in pn)r.NumberFmt[i]=pn[i];r.CellXf=[],r.Fonts=[];var o=[],a=!1;return lo(e,(function(e,i,s){switch(s){case 44:r.NumberFmt[e[0]]=e[1],qn(e[1],e[0]);break;case 43:r.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=Gl(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==o[o.length-1]&&r.CellXf.push(e);break;case 35:a=!0;break;case 36:a=!1;break;case 37:o.push(s),a=!0;break;case 38:o.pop(),a=!1;break;default:if(i.T>0)o.push(s);else if(i.T<0)o.pop();else if(!a||n.WTF&&37!=o[o.length-1])throw new Error("Unexpected record 0x"+s.toString(16))}})),r}(e,n,r):tu(e,n,r)}function Vd(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=!1;return lo(e,(function(e,i,o){switch(o){case 159:n.Count=e[0],n.Unique=e[1];break;case 19:n.push(e);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(i.T,!r||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}})),n}(e,n):function(e,t){var n=[],r="";if(!e)return n;var i=e.match(gl);if(i){r=i[2].replace(ml,"").split(yl);for(var o=0;o!=r.length;++o){var a=vl(r[o].trim(),t);null!=a&&(n[n.length]=a)}i=zr(i[1]),n.Count=i.count,n.Unique=i.uniqueCount}return n}(e,n)}function Wd(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=[],i={},o=!1;return lo(e,(function(e,a,s){switch(s){case 632:r.push(e);break;case 635:i=e;break;case 637:i.t=e.t,i.h=e.h,i.r=e.r;break;case 636:if(i.author=r[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,n.push(i);break;case 3072:case 37:case 38:break;case 35:o=!0;break;case 36:o=!1;break;default:if(a.T);else if(!o||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}})),n}(e,n):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&n.push(t[1])}}));var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var i=e.match(/<(?:\w+:)?comment[^>]*>/);if(i){var o=zr(i[0]),a={author:o.authorId&&n[o.authorId]||"sheetjsghost",ref:o.ref,guid:o.guid},s=bo(o.ref);if(!(t.sheetRows&&t.sheetRows<=s.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),u=!!l&&!!l[1]&&vl(l[1])||{r:"",t:"",h:""};a.r=u.r,"<t></t>"==u.r&&(u.t=u.h=""),a.t=(u.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(a.h=u.h),r.push(a)}}}})),r}(e,n)}function zd(e,t,n){return".bin"===t.slice(-4)?function(e,t,n){var r=[];return lo(e,(function(e,t,n){if(63===n)r.push(e);else if(!t.T)throw new Error("Unexpected record 0x"+n.toString(16))})),r}(e):function(e){var t=[];if(!e)return t;var n=1;return(e.match(Hr)||[]).forEach((function(e){var r=zr(e);switch(r[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?n=r.i:r.i=n,t.push(r)}})),t}(e)}function Ud(e,t,n,r){if(".bin"===n.slice(-4))return function(e,t,n,r){if(!e)return e;var i=r||{},o=!1;lo(e,(function(e,t,n){switch(n){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(t.T);else if(!o||i.WTF)throw new Error("Unexpected record 0x"+n.toString(16))}}),i)}(e,0,0,r)}function Kd(e,t,n){return".bin"===t.slice(-4)?function(e,t,n){var r={Types:[],Cell:[],Value:[]},i=n||{},o=[],a=!1,s=2;return lo(e,(function(e,t,n){switch(n){case 335:r.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==s?r.Cell.push({type:r.Types[e[0]-1].name,index:e[1]}):0==s&&r.Value.push({type:r.Types[e[0]-1].name,index:e[1]})}));break;case 337:s=e?1:0;break;case 338:s=2;break;case 35:o.push(n),a=!0;break;case 36:o.pop(),a=!1;break;default:if(t.T);else if(!a||i.WTF&&35!=o[o.length-1])throw new Error("Unexpected record 0x"+n.toString(16))}})),r}(e,0,n):function(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var i,o=!1,a=2;return e.replace(Hr,(function(e){var t=zr(e);switch(Ur(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":r.Types.push({name:t.name});break;case"<futureMetadata":for(var s=0;s<r.Types.length;++s)r.Types[s].name==t.name&&(i=r.Types[s]);break;case"<rc":1==a?r.Cell.push({type:r.Types[t.t-1].name,index:+t.v}):0==a&&r.Value.push({type:r.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":a=1;break;case"</cellMetadata>":case"</valueMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"<ext":o=!0;break;case"</ext>":o=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+t.i);break;default:if(!o&&n.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),r}(e,0,n)}function qd(e,t,n,r,i){return(".bin"===t.slice(-4)?bd:od)(e,n,r,i)}function Xd(e,t,n){return(".bin"===t.slice(-4)?Lu:Pu)(e,n)}var Yd,Qd=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Zd=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Jd(e,t){var n=e.split(/\s+/),r=[];if(t||(r[0]=n[0]),1===n.length)return r;var i,o,a,s=e.match(Qd);if(s)for(a=0;a!=s.length;++a)-1===(o=(i=s[a].match(Zd))[1].indexOf(":"))?r[i[1]]=i[2].slice(1,i[2].length-1):r["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(o+1)]=i[2].slice(1,i[2].length-1);return r}function $d(e){var t={};if(1===e.split(/\s+/).length)return t;var n,r,i,o=e.match(Qd);if(o)for(i=0;i!=o.length;++i)-1===(r=(n=o[i].match(Zd))[1].indexOf(":"))?t[n[1]]=n[2].slice(1,n[2].length-1):t["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(r+1)]=n[2].slice(1,n[2].length-1);return t}function eh(e,t,n,r){var i=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=ni(r);break;case"i2":case"int":i=parseInt(r,10);break;case"r4":case"float":i=parseFloat(r);break;case"date":case"dateTime.tz":i=yr(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[Xr(t)]=i}function th(e,t,n){if("z"!==e.t){if(!n||!1!==n.cellText)try{"e"===e.t?e.w=e.w||va[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=kn(e.v):e.w=xn(e.v):e.w=function(e,t){var n=Yd[e]||Xr(e);return"General"===n?xn(t):Kn(n,t)}(t||"General",e.v)}catch(o){if(n.WTF)throw o}try{var r=Yd[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&"n"==e.t&&Vn(r)){var i=yn(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(o){if(n.WTF)throw o}}}function nh(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=Jl[r.Pattern]||r.Pattern)}e[t.ID]=t}function rh(e,t,n,r,i,o,a,s,l,u){var c="General",d=r.StyleID,h={};u=u||{};var f=[],p=0;for(void 0===d&&s&&(d=s.StyleID),void 0===d&&a&&(d=a.StyleID);void 0!==o[d]&&(o[d].nf&&(c=o[d].nf),o[d].Interior&&f.push(o[d].Interior),o[d].Parent);)d=o[d].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=ni(e);break;case"String":r.t="s",r.r=ti(Xr(e)),r.v=e.indexOf("<")>-1?Xr(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),r.v=(yr(e)-new Date(Date.UTC(1899,11,30)))/864e5,r.v!==r.v?r.v=Xr(e):r.v<60&&(r.v=r.v-1),c&&"General"!=c||(c="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=ga[e],!1!==u.cellText&&(r.w=e);break;default:""==e&&""==t?r.t="z":(r.t="s",r.v=ti(t||e))}if(th(r,c,u),!1!==u.cellFormula)if(r.Formula){var v=Xr(r.Formula);61==v.charCodeAt(0)&&(v=v.slice(1)),r.f=Bu(v,i),delete r.Formula,"RC"==r.ArrayRange?r.F=Bu("RC:RC",i):r.ArrayRange&&(r.F=Bu(r.ArrayRange,i),l.push([ko(r.F),r.F]))}else for(p=0;p<l.length;++p)i.r>=l[p][0].s.r&&i.r<=l[p][0].e.r&&i.c>=l[p][0].s.c&&i.c<=l[p][0].e.c&&(r.F=l[p][1]);u.cellStyles&&(f.forEach((function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)})),r.s=h),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}function ih(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function oh(e,t){var n=t||{};Yn();var r=jt(bi(e));"binary"!=n.type&&"array"!=n.type&&"base64"!=n.type||(r="undefined"!==typeof Bt?Bt.utils.decode(65001,Mt(r)):si(r));var i,o=r.slice(0,1024).toLowerCase(),a=!1;if((1023&(o=o.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&o.indexOf(","),1023&o.indexOf(";"))){var s=br(n);return s.type="string",ll.to_workbook(r,s)}if(-1==o.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){o.indexOf("<"+e)>=0&&(a=!0)})),a)return function(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||0==n.length)throw new Error("Invalid HTML: could not find <table>");if(1==n.length)return Ro(Fh(n[0],t),t);var r={SheetNames:[],Sheets:{}};return n.forEach((function(e,n){Jf(r,Fh(e,t),"Sheet"+(n+1))})),r}(r,n);Yd={"General Number":"General","General Date":pn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":pn[15],"Short Date":pn[14],"Long Time":pn[19],"Medium Time":pn[18],"Short Time":pn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:pn[2],Standard:pn[4],Percent:pn[10],Scientific:pn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u=[];null!=Wt&&null==n.dense&&(n.dense=Wt);var c,d={},h=[],f=n.dense?[]:{},p="",v={},g={},m=Jd('<Data ss:Type="String">'),y=0,w=0,b=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},E={},k="",x=0,T=[],R={},A={},_=0,O=[],D=[],N={},P=[],F=!1,I=[],L=[],M={},G=0,B=0,j={Sheets:[],WBProps:{date1904:!1}},H={};Ci.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,"");for(var V="";i=Ci.exec(r);)switch(i[3]=(V=i[3]).toLowerCase()){case"data":if("data"==V){if("/"===i[1]){if((l=u.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&u.push([i[3],!0]);break}if(u[u.length-1][1])break;"/"===i[1]?rh(r.slice(y,i.index),k,m,"comment"==u[u.length-1][0]?N:v,{c:w,r:b},S,P[w],g,I,n):(k="",m=Jd(i[0]),y=i.index+i[0].length);break;case"cell":if("/"===i[1])if(D.length>0&&(v.c=D),(!n.sheetRows||n.sheetRows>b)&&void 0!==v.v&&(n.dense?(f[b]||(f[b]=[]),f[b][w]=v):f[wo(w)+mo(b)]=v),v.HRef&&(v.l={Target:Xr(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(G=w+(0|parseInt(v.MergeAcross,10)),B=b+(0|parseInt(v.MergeDown,10)),T.push({s:{c:w,r:b},e:{c:G,r:B}})),n.sheetStubs)if(v.MergeAcross||v.MergeDown){for(var W=w;W<=G;++W)for(var z=b;z<=B;++z)(W>w||z>b)&&(n.dense?(f[z]||(f[z]=[]),f[z][W]={t:"z"}):f[wo(W)+mo(z)]={t:"z"});w=G+1}else++w;else v.MergeAcross?w=G+1:++w;else(v=$d(i[0])).Index&&(w=+v.Index-1),w<C.s.c&&(C.s.c=w),w>C.e.c&&(C.e.c=w),"/>"===i[0].slice(-2)&&++w,D=[];break;case"row":"/"===i[1]||"/>"===i[0].slice(-2)?(b<C.s.r&&(C.s.r=b),b>C.e.r&&(C.e.r=b),"/>"===i[0].slice(-2)&&(g=Jd(i[0])).Index&&(b=+g.Index-1),w=0,++b):((g=Jd(i[0])).Index&&(b=+g.Index-1),M={},("0"==g.AutoFitHeight||g.Height)&&(M.hpx=parseInt(g.Height,10),M.hpt=Ql(M.hpx),L[b]=M),"1"==g.Hidden&&(M.hidden=!0,L[b]=M));break;case"worksheet":if("/"===i[1]){if((l=u.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"));h.push(p),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(f["!ref"]=Eo(C),n.sheetRows&&n.sheetRows<=C.e.r&&(f["!fullref"]=f["!ref"],C.e.r=n.sheetRows-1,f["!ref"]=Eo(C))),T.length&&(f["!merges"]=T),P.length>0&&(f["!cols"]=P),L.length>0&&(f["!rows"]=L),d[p]=f}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=w=0,u.push([i[3],!1]),l=Jd(i[0]),p=Xr(l.Name),f=n.dense?[]:{},T=[],I=[],L=[],H={name:p,Hidden:0},j.Sheets.push(H);break;case"table":if("/"===i[1]){if((l=u.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==i[0].slice(-2))break;u.push([i[3],!1]),P=[],F=!1}break;case"style":"/"===i[1]?nh(S,E,n):E=Jd(i[0]);break;case"numberformat":E.nf=Xr(Jd(i[0]).Format||"General"),Yd[E.nf]&&(E.nf=Yd[E.nf]);for(var U=0;392!=U&&pn[U]!=E.nf;++U);if(392==U)for(U=57;392!=U;++U)if(null==pn[U]){qn(E.nf,U);break}break;case"column":if("table"!==u[u.length-1][0])break;if((c=Jd(i[0])).Hidden&&(c.hidden=!0,delete c.Hidden),c.Width&&(c.wpx=parseInt(c.Width,10)),!F&&c.wpx>10){F=!0,Vl=Bl;for(var K=0;K<P.length;++K)P[K]&&Xl(P[K])}F&&Xl(c),P[c.Index-1||P.length]=c;for(var q=0;q<+c.Span;++q)P[P.length]=br(c);break;case"namedrange":if("/"===i[1])break;j.Names||(j.Names=[]);var X=zr(i[0]),Y={Name:X.Name,Ref:Bu(X.RefersTo.slice(1),{r:0,c:0})};j.Sheets.length>0&&(Y.Sheet=j.Sheets.length-1),j.Names.push(Y);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===i[0].slice(-2))break;"/"===i[1]?k+=r.slice(x,i.index):x=i.index+i[0].length;break;case"interior":if(!n.cellStyles)break;E.Interior=Jd(i[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===i[0].slice(-2))break;"/"===i[1]?Ha(R,V,r.slice(_,i.index)):_=i.index+i[0].length;break;case"styles":case"workbook":if("/"===i[1]){if((l=u.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else u.push([i[3],!1]);break;case"comment":if("/"===i[1]){if((l=u.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"));ih(N),D.push(N)}else u.push([i[3],!1]),N={a:(l=Jd(i[0])).Author};break;case"autofilter":if("/"===i[1]){if((l=u.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==i[0].charAt(i[0].length-2)){var Q=Jd(i[0]);f["!autofilter"]={ref:Bu(Q.Range).replace(/\$/g,"")},u.push([i[3],!0])}break;case"datavalidation":if("/"===i[1]){if((l=u.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&u.push([i[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===i[1]){if((l=u.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&u.push([i[3],!0]);break;default:if(0==u.length&&"document"==i[3])return qh(r,n);if(0==u.length&&"uof"==i[3])return qh(r,n);var Z=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(i[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Z=!1}break;case"componentoptions":switch(i[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Z=!1}break;case"excelworkbook":switch(i[3]){case"date1904":j.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Z=!1}break;case"workbookoptions":switch(i[3]){case"owcversion":case"height":case"width":break;default:Z=!1}break;case"worksheetoptions":switch(i[3]){case"visible":if("/>"===i[0].slice(-2));else if("/"===i[1])switch(r.slice(_,i.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2}else _=i.index+i[0].length;break;case"header":f["!margins"]||Gc(f["!margins"]={},"xlml"),isNaN(+zr(i[0]).Margin)||(f["!margins"].header=+zr(i[0]).Margin);break;case"footer":f["!margins"]||Gc(f["!margins"]={},"xlml"),isNaN(+zr(i[0]).Margin)||(f["!margins"].footer=+zr(i[0]).Margin);break;case"pagemargins":var J=zr(i[0]);f["!margins"]||Gc(f["!margins"]={},"xlml"),isNaN(+J.Top)||(f["!margins"].top=+J.Top),isNaN(+J.Left)||(f["!margins"].left=+J.Left),isNaN(+J.Right)||(f["!margins"].right=+J.Right),isNaN(+J.Bottom)||(f["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":j.Views||(j.Views=[]),j.Views[0]||(j.Views[0]={}),j.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:Z=!1}break;case"pivottable":case"pivotcache":switch(i[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Z=!1}break;case"pagebreaks":switch(i[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Z=!1}break;case"autofilter":switch(i[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Z=!1}break;case"querytable":switch(i[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Z=!1}break;case"datavalidation":switch(i[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Z=!1}break;case"sorting":case"conditionalformatting":switch(i[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Z=!1}break;case"mapinfo":case"schema":case"data":switch(i[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Z=!1}break;case"smarttags":break;default:Z=!1}if(Z)break;if(i[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+i[3]+"|"+u.join("|");if("customdocumentproperties"===u[u.length-1][0]){if("/>"===i[0].slice(-2))break;"/"===i[1]?eh(A,V,O,r.slice(_,i.index)):(O=i,_=i.index+i[0].length);break}if(n.WTF)throw"Unrecognized tag: "+i[3]+"|"+u.join("|")}var $={};return n.bookSheets||n.bookProps||($.Sheets=d),$.SheetNames=h,$.Workbook=j,$.SSF=br(pn),$.Props=R,$.Custprops=A,$}function ah(e,t){switch(Tf(t=t||{}),t.type||"base64"){case"base64":return oh(Kt(e),t);case"binary":case"buffer":case"file":return oh(e,t);case"array":return oh($t(e),t)}}function sh(e,t){var n=[];return e.Props&&n.push(function(e,t){var n=[];return ir(ja).map((function(e){for(var t=0;t<Aa.length;++t)if(Aa[t][1]==e)return Aa[t];for(t=0;t<Pa.length;++t)if(Pa[t][1]==e)return Pa[t];throw e})).forEach((function(r){if(null!=e[r[1]]){var i=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof i?i=String(i):!0===i||!1===i?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(gi(ja[r[1]]||r[1],i))}})),yi("DocumentProperties",n.join(""),{xmlns:ki.o})}(e.Props,t)),e.Custprops&&n.push(function(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&ir(e).forEach((function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<Aa.length;++r)if(t==Aa[r][1])return;for(r=0;r<Pa.length;++r)if(t==Pa[r][1])return;for(r=0;r<n.length;++r)if(t==n[r])return;var o=e[t],a="string";"number"==typeof o?(a="float",o=String(o)):!0===o||!1===o?(a="boolean",o=o?"1":"0"):o=String(o),i.push(yi(Jr(t),o,{"dt:dt":a}))}})),t&&ir(t).forEach((function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&(!e||!Object.prototype.hasOwnProperty.call(e,n))){var r=t[n],o="string";"number"==typeof r?(o="float",r=String(r)):!0===r||!1===r?(o="boolean",r=r?"1":"0"):r instanceof Date?(o="dateTime.tz",r=r.toISOString()):r=String(r),i.push(yi(Jr(n),r,{"dt:dt":o}))}})),"<"+r+' xmlns="'+ki.o+'">'+i.join("")+"</"+r+">"}(e.Props,e.Custprops)),n.join("")}function lh(e){return yi("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Hu(e.Ref,{r:0,c:0})})}function uh(e,t,n,r,i,o,a){if(!e||void 0==e.v&&void 0==e.f)return"";var s={};if(e.f&&(s["ss:Formula"]="="+Zr(Hu(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=bo(e.F.slice(t.length+1));s["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(s["ss:HRef"]=Zr(e.l.Target),e.l.Tooltip&&(s["x:HRefScreenTip"]=Zr(e.l.Tooltip))),n["!merges"])for(var u=n["!merges"],c=0;c!=u.length;++c)u[c].s.c==a.c&&u[c].s.r==a.r&&(u[c].e.c>u[c].s.c&&(s["ss:MergeAcross"]=u[c].e.c-u[c].s.c),u[c].e.r>u[c].s.r&&(s["ss:MergeDown"]=u[c].e.r-u[c].s.r));var d="",h="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=va[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||pn[14]);break;case"s":d="String",h=((e.v||"")+"").replace(Yr,(function(e){return qr[e]})).replace($r,(function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"}))}var f=Bc(r.cellXfs,e,r);s["ss:StyleID"]="s"+(21+f),s["ss:Index"]=a.c+1;var p=null!=e.v?h:"",v="z"==e.t?"":'<Data ss:Type="'+d+'">'+p+"</Data>";return(e.c||[]).length>0&&(v+=e.c.map((function(e){var t=yi("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return yi("Comment",t,{"ss:Author":e.a})})).join("")),yi("Cell",v,s)}function ch(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Zl(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function dh(e,t,n){var r=[],i=n.SheetNames[e],o=n.Sheets[i],a=o?function(e,t,n,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,o=[],a=0;a<i.length;++a){var s=i[a];s.Sheet==n&&(s.Name.match(/^_xlfn\./)||o.push(lh(s)))}return o.join("")}(o,0,e,n):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=o?function(e,t,n,r){if(!e["!ref"])return"";var i=ko(e["!ref"]),o=e["!merges"]||[],a=0,s=[];e["!cols"]&&e["!cols"].forEach((function(e,t){Xl(e);var n=!!e.width,r=Mc(t,e),i={"ss:Index":t+1};n&&(i["ss:Width"]=Wl(r.width)),e.hidden&&(i["ss:Hidden"]="1"),s.push(yi("Column",null,i))}));for(var l=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var c=[ch(u,(e["!rows"]||[])[u])],d=i.s.c;d<=i.e.c;++d){var h=!1;for(a=0;a!=o.length;++a)if(!(o[a].s.c>d)&&!(o[a].s.r>u)&&!(o[a].e.c<d)&&!(o[a].e.r<u)){o[a].s.c==d&&o[a].s.r==u||(h=!0);break}if(!h){var f={r:u,c:d},p=Co(f),v=l?(e[u]||[])[d]:e[p];c.push(uh(v,p,e,t,0,0,f))}}c.push("</Row>"),c.length>2&&s.push(c.join(""))}return s.join("")}(o,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(function(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(yi("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(yi("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(yi("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(yi("Visible",1==r.Workbook.Sheets[n].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<n&&(!r.Workbook.Sheets[o]||r.Workbook.Sheets[o].Hidden);++o);o==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(gi("ProtectContents","True")),e["!protect"].objects&&i.push(gi("ProtectObjects","True")),e["!protect"].scenarios&&i.push(gi("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||i.push(gi("EnableSelection","UnlockedCells")):i.push(gi("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach((function(t){e["!protect"][t[0]]&&i.push("<"+t[1]+"/>")}))),0==i.length?"":yi("WorksheetOptions",i.join(""),{xmlns:ki.x})}(o,0,e,n)),r.join("")}function hh(e,t){t||(t={}),e.SSF||(e.SSF=br(pn)),e.SSF&&(Yn(),Xn(e.SSF),t.revssf=sr(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Bc(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(sh(e,t)),n.push(""),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(yi("Worksheet",dh(r,t,e),{"ss:Name":Zr(e.SheetNames[r])}));return n[2]=function(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach((function(e,t){var r=[];r.push(yi("NumberFormat",null,{"ss:Format":Zr(pn[e.numFmtId])}));var i={"ss:ID":"s"+(21+t)};n.push(yi("Style",r.join(""),i))})),yi("Styles",n.join(""))}(0,t),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];null==i.Sheet&&(i.Name.match(/^_xlfn\./)||n.push(lh(i)))}return yi("Names",n.join(""))}(e),Gr+yi("Workbook",n.join(""),{xmlns:ki.ss,"xmlns:o":ki.o,"xmlns:x":ki.x,"xmlns:ss":ki.ss,"xmlns:dt":ki.dt,"xmlns:html":ki.html})}function fh(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return na(e,1)}(n),n.length-n.l<=4)return t;var r=n.read_shift(4);return 0==r||r>40?t:(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4||1907505652!==(r=n.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return na(e,2)}(n),0==(r=n.read_shift(4))||r>40?t:(n.l-=4,void(t.Reserved2=n.read_shift(0,"lpwstr")))))}var ph=[60,1084,2066,2165,2175];function vh(e,t,n,r,i){var o=r,a=[],s=n.slice(n.l,n.l+o);if(i&&i.enc&&i.enc.insitu&&s.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:i.enc.insitu(s)}a.push(s),n.l+=o;for(var l=Xi(n,n.l),u=Eh[l],c=0;null!=u&&ph.indexOf(l)>-1;)o=Xi(n,n.l+2),c=n.l+4,2066==l?c+=4:2165!=l&&2175!=l||(c+=12),s=n.slice(c,n.l+4+o),a.push(s),n.l+=4+o,u=Eh[l=Xi(n,n.l)];var d=tn(a);oo(d,0);var h=0;d.lens=[];for(var f=0;f<a.length;++f)d.lens.push(h),h+=a[f].length;if(d.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+r;return t.f(d,d.length,i)}function gh(e,t,n){if("z"!==e.t&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=pn[r])}catch(o){if(t.WTF)throw o}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||va[e.v]:0===r||"General"==r?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=kn(e.v):e.w=xn(e.v):e.w=Kn(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(o){if(t.WTF)throw o}if(t.cellDates&&r&&"n"==e.t&&Vn(pn[r]||String(r))){var i=yn(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function mh(e,t,n){return{v:e,ixfe:t,t:n}}function yh(e,t){var n={opts:{}},r={};null!=Wt&&null==t.dense&&(t.dense=Wt);var i,o,a,s,l,u,c,d,h=t.dense?[]:{},f={},p={},v=null,g=[],m="",y={},w="",b={},C=[],S=[],E=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},x={},T=function(e){return e<8?pa[e]:e<64&&E[e-8]||pa[e]},R=function(e,t,n){if(!(M>1)&&!(n.sheetRows&&e.r>=n.sheetRows)){if(n.cellStyles&&t.XF&&t.XF.data&&function(e,t,n){var r,i=t.XF.data;i&&i.patternType&&n&&n.cellStyles&&(t.s={},t.s.patternType=i.patternType,(r=Ml(T(i.icvFore)))&&(t.s.fgColor={rgb:r}),(r=Ml(T(i.icvBack)))&&(t.s.bgColor={rgb:r}))}(0,t,n),delete t.ixfe,delete t.XF,i=e,w=Co(e),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),n.cellFormula&&t.f)for(var r=0;r<C.length;++r)if(!(C[r][0].s.c>e.c||C[r][0].s.r>e.r)&&!(C[r][0].e.c<e.c||C[r][0].e.r<e.r)){t.F=Eo(C[r][0]),C[r][0].s.c==e.c&&C[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+gc(C[r][1],0,e,F,A));break}n.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=t):h[w]=t}},A={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var _=[],O=[],D=[],N=[],P=!1,F=[];F.SheetNames=A.snames,F.sharedf=A.sharedf,F.arrayf=A.arrayf,F.names=[],F.XTI=[];var I,L=0,M=0,G=0,B=[],j=[];A.codepage=1200,It(1200);for(var H=!1;e.l<e.length-1;){var V=e.l,W=e.read_shift(2);if(0===W&&10===L)break;var z=e.l===e.length?0:e.read_shift(2),U=Eh[W];if(U&&U.f){if(t.bookSheets&&133===L&&133!==W)break;if(L=W,2===U.r||12==U.r){var K=e.read_shift(2);if(z-=2,!A.enc&&K!==W&&((255&K)<<8|K>>8)!==W)throw new Error("rt mismatch: "+K+"!="+W);12==U.r&&(e.l+=10,z-=10)}var q={};if(q=10===W?U.f(e,z,A):vh(W,U,e,z,A),0==M&&-1===[9,521,1033,2057].indexOf(L))continue;switch(W){case 34:n.opts.Date1904=k.WBProps.date1904=q;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=q,!t.password)throw new Error("File is password-protected");if(null==q.valid)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=q;break;case 66:var X=Number(q);switch(X){case 21010:X=1200;break;case 32768:X=1e4;break;case 32769:X=1252}It(A.codepage=X),H=!0;break;case 317:A.rrtabid=q;break;case 25:A.winlocked=q;break;case 439:n.opts.RefreshAll=q;break;case 12:n.opts.CalcCount=q;break;case 16:n.opts.CalcDelta=q;break;case 17:n.opts.CalcIter=q;break;case 13:n.opts.CalcMode=q;break;case 14:n.opts.CalcPrecision=q;break;case 95:n.opts.CalcSaveRecalc=q;break;case 15:A.CalcRefMode=q;break;case 2211:n.opts.FullCalc=q;break;case 129:q.fDialog&&(h["!type"]="dialog"),q.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),q.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:S.push(q);break;case 430:F.push([q]),F[F.length-1].XTI=[];break;case 35:case 547:F[F.length-1].push(q);break;case 24:case 536:I={Name:q.Name,Ref:gc(q.rgce,0,null,F,A)},q.itab>0&&(I.Sheet=q.itab-1),F.names.push(I),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(q),"_xlnm._FilterDatabase"==q.Name&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&"PtgArea3d"==q.rgce[0][0][0]&&(j[q.itab-1]={ref:Eo(q.rgce[0][0][1][2])});break;case 22:A.ExternCount=q;break;case 23:0==F.length&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(q),F.XTI=F.XTI.concat(q);break;case 2196:if(A.biff<8)break;null!=I&&(I.Comment=q[1]);break;case 18:h["!protect"]=q;break;case 19:0!==q&&A.WTF&&console.error("Password verifier: "+q);break;case 133:f[q.pos]=q,A.snames.push(q.name);break;case 10:if(--M)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,h["!ref"]=Eo(p),t.sheetRows&&t.sheetRows<=p.e.r){var Y=p.e.r;p.e.r=t.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=Eo(p),p.e.r=Y}p.e.r++,p.e.c++}_.length>0&&(h["!merges"]=_),O.length>0&&(h["!objects"]=O),D.length>0&&(h["!cols"]=D),N.length>0&&(h["!rows"]=N),k.Sheets.push(x)}""===m?y=h:r[m]=h,h=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===A.biff&&(A.biff={9:2,521:3,1033:4}[W]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),A.biffguess=0==q.BIFFVer,0==q.BIFFVer&&4096==q.dt&&(A.biff=5,H=!0,It(A.codepage=28591)),8==A.biff&&0==q.BIFFVer&&16==q.dt&&(A.biff=2),M++)break;if(h=t.dense?[]:{},A.biff<8&&!H&&(H=!0,It(A.codepage=t.codepage||1252)),A.biff<5||0==q.BIFFVer&&4096==q.dt){""===m&&(m="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var Q={pos:e.l-z,name:m};f[Q.pos]=Q,A.snames.push(m)}else m=(f[V]||{name:""}).name;32==q.dt&&(h["!type"]="chart"),64==q.dt&&(h["!type"]="macro"),_=[],O=[],A.arrayf=C=[],D=[],N=[],P=!1,x={Hidden:(f[V]||{hs:0}).hs,name:m};break;case 515:case 3:case 2:"chart"==h["!type"]&&(t.dense?(h[q.r]||[])[q.c]:h[Co({c:q.c,r:q.r})])&&++q.c,u={ixfe:q.ixfe,XF:S[q.ixfe]||{},v:q.val,t:"n"},G>0&&(u.z=B[u.ixfe>>8&63]),gh(u,t,n.opts.Date1904),R({c:q.c,r:q.r},u,t);break;case 5:case 517:u={ixfe:q.ixfe,XF:S[q.ixfe],v:q.val,t:q.t},G>0&&(u.z=B[u.ixfe>>8&63]),gh(u,t,n.opts.Date1904),R({c:q.c,r:q.r},u,t);break;case 638:u={ixfe:q.ixfe,XF:S[q.ixfe],v:q.rknum,t:"n"},G>0&&(u.z=B[u.ixfe>>8&63]),gh(u,t,n.opts.Date1904),R({c:q.c,r:q.r},u,t);break;case 189:for(var Z=q.c;Z<=q.C;++Z){var J=q.rkrec[Z-q.c][0];u={ixfe:J,XF:S[J],v:q.rkrec[Z-q.c][1],t:"n"},G>0&&(u.z=B[u.ixfe>>8&63]),gh(u,t,n.opts.Date1904),R({c:Z,r:q.r},u,t)}break;case 6:case 518:case 1030:if("String"==q.val){v=q;break}if((u=mh(q.val,q.cell.ixfe,q.tt)).XF=S[u.ixfe],t.cellFormula){var $=q.formula;if($&&$[0]&&$[0][0]&&"PtgExp"==$[0][0][0]){var ee=$[0][0][1][0],te=$[0][0][1][1],ne=Co({r:ee,c:te});b[ne]?u.f=""+gc(q.formula,0,q.cell,F,A):u.F=((t.dense?(h[ee]||[])[te]:h[ne])||{}).F}else u.f=""+gc(q.formula,0,q.cell,F,A)}G>0&&(u.z=B[u.ixfe>>8&63]),gh(u,t,n.opts.Date1904),R(q.cell,u,t),v=q;break;case 7:case 519:if(!v)throw new Error("String record expects Formula");v.val=q,(u=mh(q,v.cell.ixfe,"s")).XF=S[u.ixfe],t.cellFormula&&(u.f=""+gc(v.formula,0,v.cell,F,A)),G>0&&(u.z=B[u.ixfe>>8&63]),gh(u,t,n.opts.Date1904),R(v.cell,u,t),v=null;break;case 33:case 545:C.push(q);var re=Co(q[0].s);if(o=t.dense?(h[q[0].s.r]||[])[q[0].s.c]:h[re],t.cellFormula&&o){if(!v)break;if(!re||!o)break;o.f=""+gc(q[1],0,q[0],F,A),o.F=Eo(q[0])}break;case 1212:if(!t.cellFormula)break;if(w){if(!v)break;b[Co(v.cell)]=q[0],((o=t.dense?(h[v.cell.r]||[])[v.cell.c]:h[Co(v.cell)])||{}).f=""+gc(q[0],0,i,F,A)}break;case 253:u=mh(g[q.isst].t,q.ixfe,"s"),g[q.isst].h&&(u.h=g[q.isst].h),u.XF=S[u.ixfe],G>0&&(u.z=B[u.ixfe>>8&63]),gh(u,t,n.opts.Date1904),R({c:q.c,r:q.r},u,t);break;case 513:t.sheetStubs&&(u={ixfe:q.ixfe,XF:S[q.ixfe],t:"z"},G>0&&(u.z=B[u.ixfe>>8&63]),gh(u,t,n.opts.Date1904),R({c:q.c,r:q.r},u,t));break;case 190:if(t.sheetStubs)for(var ie=q.c;ie<=q.C;++ie){var oe=q.ixfe[ie-q.c];u={ixfe:oe,XF:S[oe],t:"z"},G>0&&(u.z=B[u.ixfe>>8&63]),gh(u,t,n.opts.Date1904),R({c:ie,r:q.r},u,t)}break;case 214:case 516:case 4:(u=mh(q.val,q.ixfe,"s")).XF=S[u.ixfe],G>0&&(u.z=B[u.ixfe>>8&63]),gh(u,t,n.opts.Date1904),R({c:q.c,r:q.r},u,t);break;case 0:case 512:1===M&&(p=q);break;case 252:g=q;break;case 1054:if(4==A.biff){B[G++]=q[1];for(var ae=0;ae<G+163&&pn[ae]!=q[1];++ae);ae>=163&&qn(q[1],G+163)}else qn(q[1],q[0]);break;case 30:B[G++]=q;for(var se=0;se<G+163&&pn[se]!=q;++se);se>=163&&qn(q,G+163);break;case 229:_=_.concat(q);break;case 93:O[q.cmo[0]]=A.lastobj=q;break;case 438:A.lastobj.TxO=q;break;case 127:A.lastobj.ImData=q;break;case 440:for(l=q[0].s.r;l<=q[0].e.r;++l)for(s=q[0].s.c;s<=q[0].e.c;++s)(o=t.dense?(h[l]||[])[s]:h[Co({c:s,r:l})])&&(o.l=q[1]);break;case 2048:for(l=q[0].s.r;l<=q[0].e.r;++l)for(s=q[0].s.c;s<=q[0].e.c;++s)(o=t.dense?(h[l]||[])[s]:h[Co({c:s,r:l})])&&o.l&&(o.l.Tooltip=q[1]);break;case 28:if(A.biff<=5&&A.biff>=2)break;o=t.dense?(h[q[0].r]||[])[q[0].c]:h[Co(q[0])];var le=O[q[2]];o||(t.dense?(h[q[0].r]||(h[q[0].r]=[]),o=h[q[0].r][q[0].c]={t:"z"}):o=h[Co(q[0])]={t:"z"},p.e.r=Math.max(p.e.r,q[0].r),p.s.r=Math.min(p.s.r,q[0].r),p.e.c=Math.max(p.e.c,q[0].c),p.s.c=Math.min(p.s.c,q[0].c)),o.c||(o.c=[]),a={a:q[1],t:le.TxO.t},o.c.push(a);break;case 2173:S[q.ixfe],q.ext.forEach((function(e){e[0]}));break;case 125:if(!A.cellStyles)break;for(;q.e>=q.s;)D[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(1&q.flags)},P||(P=!0,ql(q.w/256)),Xl(D[q.e+1]);break;case 520:var ue={};null!=q.level&&(N[q.r]=ue,ue.level=q.level),q.hidden&&(N[q.r]=ue,ue.hidden=!0),q.hpt&&(N[q.r]=ue,ue.hpt=q.hpt,ue.hpx=Zl(q.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||Gc(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[W]]=q;break;case 161:h["!margins"]||Gc(h["!margins"]={}),h["!margins"].header=q.header,h["!margins"].footer=q.footer;break;case 574:q.RTL&&(k.Views[0].RTL=!0);break;case 146:E=q;break;case 2198:d=q;break;case 140:c=q;break;case 442:m?x.CodeName=q||x.name:k.WBProps.CodeName=q||"ThisWorkbook"}}else U||console.error("Missing Info for XLS Record 0x"+W.toString(16)),e.l+=z}return n.SheetNames=ir(f).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return f[e].name})),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&y["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=y)):n.Preamble=y,n.Sheets&&j.forEach((function(e,t){n.Sheets[n.SheetNames[t]]["!autofilter"]=e})),n.Strings=g,n.SSF=br(pn),A.enc&&(n.Encryption=A.enc),d&&(n.Themes=d),n.Metadata={},void 0!==c&&(n.Metadata.Country=c),F.names.length>0&&(k.Names=F.names),n.Workbook=k,n}var wh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function bh(e,t){var n,r,i,o;if(t||(t={}),Tf(t),Lt(),t.codepage&&Ft(t.codepage),e.FullPaths){if(er.find(e,"/encryption"))throw new Error("File is password-protected");n=er.find(e,"!CompObj"),r=er.find(e,"/Workbook")||er.find(e,"/Book")}else{switch(t.type){case"base64":e=Zt(Kt(e));break;case"binary":e=Zt(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}oo(e,0),r={content:e}}if(n&&fh(n),t.bookProps&&!t.bookSheets)i={};else{var a=qt?"buffer":"array";if(r&&r.content)i=yh(r.content,t);else if((o=er.find(e,"PerfectOffice_MAIN"))&&o.content)i=ul.to_workbook(o.content,(t.type=a,t));else{if(!(o=er.find(e,"NativeContent_MAIN"))||!o.content)throw(o=er.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");i=ul.to_workbook(o.content,(t.type=a,t))}t.bookVBA&&e.FullPaths&&er.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=function(e){var t=er.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(n,r){if("/"!==n.slice(-1)&&n.match(/_VBA_PROJECT_CUR/)){var i=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");er.utils.cfb_add(t,i,e.FileIndex[r].content)}})),er.write(t)}(e))}var s={};return e.FullPaths&&function(e,t,n){var r=er.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var i=ns(r,ua,wh.DSI);for(var o in i)t[o]=i[o]}catch(u){if(n.WTF)throw u}var a=er.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var s=ns(a,ca,wh.SI);for(var l in s)null==t[l]&&(t[l]=s[l])}catch(u){if(n.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(Ia(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,s,t),i.Props=i.Custprops=s,t.bookFiles&&(i.cfb=e),i}function Ch(e,t){var n=t||{},r=er.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return er.utils.cfb_add(r,i,Ph(e,n)),8==n.biff&&(e.Props||e.Custprops)&&function(e,t){var n,r=[],i=[],o=[],a=0,s=or(ua,"n"),l=or(ca,"n");if(e.Props)for(n=ir(e.Props),a=0;a<n.length;++a)(Object.prototype.hasOwnProperty.call(s,n[a])?r:Object.prototype.hasOwnProperty.call(l,n[a])?i:o).push([n[a],e.Props[n[a]]]);if(e.Custprops)for(n=ir(e.Custprops),a=0;a<n.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},n[a])||(Object.prototype.hasOwnProperty.call(s,n[a])?r:Object.prototype.hasOwnProperty.call(l,n[a])?i:o).push([n[a],e.Custprops[n[a]]]);var u=[];for(a=0;a<o.length;++a)$a.indexOf(o[a][0])>-1||Fa.indexOf(o[a][0])>-1||null!=o[a][1]&&u.push(o[a]);i.length&&er.utils.cfb_add(t,"/\x05SummaryInformation",rs(i,wh.SI,l,ca)),(r.length||u.length)&&er.utils.cfb_add(t,"/\x05DocumentSummaryInformation",rs(r,wh.DSI,s,ua,u.length?u:null,wh.UDI))}(e,r),8==n.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach((function(n,r){if(0!=r){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==i.slice(-1)&&er.utils.cfb_add(e,i,t.FileIndex[r].content)}}))}(r,er.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var Sh={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,7&o&&(n.level=7&o),16&o&&(n.hidden=!0),32&o&&(n.hpt=i/20),n}},1:{f:function(e){return[Mo(e)]}},2:{f:function(e){return[Mo(e),Xo(e),"n"]}},3:{f:function(e){return[Mo(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Mo(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Mo(e),$o(e),"n"]}},6:{f:function(e){return[Mo(e),Do(e),"str"]}},7:{f:function(e){return[Mo(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,i=Mo(e);i.r=n["!row"];var o=[i,Do(e),"str"];if(n.cellFormula){e.l+=2;var a=Ec(e,r-e.l,n);o[3]=gc(a,0,i,n.supbooks,n)}else e.l=r;return o}},9:{f:function(e,t,n){var r=e.l+t,i=Mo(e);i.r=n["!row"];var o=[i,$o(e),"n"];if(n.cellFormula){e.l+=2;var a=Ec(e,r-e.l,n);o[3]=gc(a,0,i,n.supbooks,n)}else e.l=r;return o}},10:{f:function(e,t,n){var r=e.l+t,i=Mo(e);i.r=n["!row"];var o=[i,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var a=Ec(e,r-e.l,n);o[3]=gc(a,0,i,n.supbooks,n)}else e.l=r;return o}},11:{f:function(e,t,n){var r=e.l+t,i=Mo(e);i.r=n["!row"];var o=[i,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var a=Ec(e,r-e.l,n);o[3]=gc(a,0,i,n.supbooks,n)}else e.l=r;return o}},12:{f:function(e){return[Bo(e)]}},13:{f:function(e){return[Bo(e),Xo(e),"n"]}},14:{f:function(e){return[Bo(e),e.read_shift(1),"e"]}},15:{f:function(e){return[Bo(e),e.read_shift(1),"b"]}},16:{f:ud},17:{f:function(e){return[Bo(e),Do(e),"str"]}},18:{f:function(e){return[Bo(e),e.read_shift(4),"s"]}},19:{f:Fo},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),o=Uo(e),a=kc(e,0,n),s=Wo(e);e.l=r;var l={Name:o,Ptg:a};return i<268435455&&(l.Sheet=i),s&&(l.Comment=s),l}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var o=e.read_shift(1);0!=o&&(r.underline=o);var a=e.read_shift(1);a>0&&(r.family=a);var s=e.read_shift(1);switch(s>0&&(r.charset=s),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=pa[r];l&&(t.rgb=Ml(l));break;case 2:t.rgb=Ml([o,a,s]);break;case 3:t.theme=r}return 0!=i&&(t.tint=i>0?i/32767:i/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=Do(e),r}},44:{f:function(e,t){return[e.read_shift(2),Do(e)]}},45:{f:su},46:{f:du},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:$s},62:{f:function(e){return[Mo(e),Fo(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=Co(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ao,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=Ho(e,t-19),n}},148:{f:sd,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?Do(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=Ko(e,t-8),n.name=Do(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Zo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cd},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Do(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ko},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Xs},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,i=Qo(e),o=e.read_shift(1),a=[i];if(a[2]=o,n.cellFormula){var s=Sc(e,r-e.l,n);a[1]=s}else e.l=r;return a}},427:{f:function(e,t,n){var r=e.l+t,i=[Zo(e,16)];if(n.cellFormula){var o=xc(e,r-e.l,n);i[1]=o,e.l=r}else e.l=r;return i}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return hd.forEach((function(n){t[n]=$o(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=Zo(e,16),i=Wo(e),o=Do(e),a=Do(e),s=Do(e);e.l=n;var l={rfx:r,relId:i,loc:o,display:s};return a&&(l.Tooltip=a),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ko},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Iu},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=Zo(e,16);return t.rfx=n.s,t.ref=Co(n.s),e.l+=16,t}},636:{T:-1},637:{f:Io},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:Do(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Eh={6:{f:wc},10:{f:is},12:{f:ss},13:{f:ss},14:{f:os},15:{f:os},16:{f:$o},17:{f:os},18:{f:os},19:{f:ss},20:{f:zs},21:{f:zs},23:{f:Xs},24:{f:qs},25:{f:os},26:{},27:{},28:{f:function(e,t,n){return function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),s=gs(e,0,n);return n.biff<8&&e.read_shift(1),[{r:r,c:i},s,a,o]}}(e,0,n)}},29:{},34:{f:os},35:{f:Us},38:{f:$o},39:{f:$o},40:{f:$o},41:{f:$o},42:{f:os},43:{f:os},47:{f:function(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?Il(e,t-2,r):function(e,t,n,r){var i={key:ss(e),verificationBytes:ss(e)};n.password&&(i.verifier=Nl(n.password)),r.valid=i.verificationBytes===i.verifier,r.valid&&(r.insitu=Fl(n.password))}(e,n.biff,n,r),r}},49:{f:function(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return r.name=ds(e,0,n),r}},51:{f:ss},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:os},65:{f:function(){}},66:{f:ss},77:{},80:{},81:{},82:{},85:{f:ss},89:{},90:{},91:{},92:{f:function(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,i=gs(e,0,n);return e.read_shift(t+r-e.l),i}},93:{f:function(e,t,n){if(n&&n.biff<8)return function(e,t,n){e.l+=4;var r=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var a=[];return a.push((Qs[r]||ao)(e,t,n)),{cmo:[i,r,o],ft:a}}(e,t,n);var r=Ns(e),i=function(e,t){for(var n=e.l+t,r=[];e.l<n;){var i=e.read_shift(2);e.l-=2;try{r.push(Fs[i](e,n-e.l))}catch(o){return e.l=n,r}}return e.l!=n&&(e.l=n),r}(e,t-22,r[1]);return{cmo:r,ft:i}}},94:{},95:{f:os},96:{},97:{},99:{f:os},125:{f:$s},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,n){var r=n&&8==n.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&r,fBelow:64&r,fRight:128&r}}},130:{f:ss},131:{f:os},132:{f:os},133:{f:function(e,t,n){var r=e.read_shift(4),i=3&e.read_shift(1),o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule"}var a=ds(e,0,n);return 0===a.length&&(a="Sheet1"),{pos:r,hs:i,dt:o,name:a}}},134:{},140:{f:function(e){var t,n=[0,0];return t=e.read_shift(2),n[0]=da[t]||t,t=e.read_shift(2),n[1]=da[t]||t,n}},141:{f:ss},144:{},146:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(Es(e));return n}},151:{},152:{},153:{},154:{},155:{},156:{f:ss},157:{},158:{},160:{f:tl},161:{f:function(e,t){var n={};return t<32||(e.l+=16,n.header=$o(e),n.footer=$o(e),e.l+=2),n}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),i=e.read_shift(2),o=[];e.l<n;)o.push(Rs(e));if(e.l!==n)throw new Error("MulRK read error");var a=e.read_shift(2);if(o.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:r,c:i,C:a,rkrec:o}}},190:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),i=e.read_shift(2),o=[];e.l<n;)o.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var a=e.read_shift(2);if(o.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:r,c:i,C:a,ixfe:o}}},193:{f:is},197:{},198:{},199:{},200:{},201:{},202:{f:os},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ss},220:{},221:{f:os},222:{},224:{f:function(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,6,r.data=function(e,t,n,r){var i={},o=e.read_shift(4),a=e.read_shift(4),s=e.read_shift(4),l=e.read_shift(2);return i.patternType=ha[s>>26],r.cellStyles?(i.alc=7&o,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=15&a,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=127&s,i.icvBottom=s>>7&127,i.icvDiag=s>>14&127,i.dgDiag=s>>21&15,i.icvFore=127&l,i.icvBack=l>>7&127,i.fsxButton=l>>14&1,i):i}(e,0,r.fStyle,n),r}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:is},227:{},229:{f:function(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(As(e));return n}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var n=e.l+t,r=e.read_shift(4),i=e.read_shift(4),o=[],a=0;a!=i&&e.l<n;++a)o.push(hs(e));return o.Count=r,o.Unique=i,o}},253:{f:function(e){var t=ks(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:us},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:os},353:{f:is},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,n){var r=e.l+t,i=e.read_shift(2),o=e.read_shift(2);if(n.sbcch=o,1025==o||14849==o)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var a=ps(e,o),s=[];r>e.l;)s.push(vs(e));return[o,i,a,s]}},431:{f:os},432:{},433:{},434:{},437:{},438:{f:function(e,t,n){var r=e.l,i="";try{e.l+=4;var o=(n.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(o)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}(e);var a=e.read_shift(2);e.read_shift(2),ss(e);var s=e.read_shift(2);e.l+=s;for(var l=1;l<e.lens.length-1;++l){if(e.l-r!=e.lens[l])throw new Error("TxO: bad continue record");var u=e[e.l];if((i+=ps(e,e.lens[l+1]-e.lens[l]-1)).length>=(u?a:2*a))break}if(i.length!==a&&i.length!==2*a)throw new Error("cchText: "+a+" != "+i.length);return e.l=r+t,{t:i}}catch(c){return e.l=r+t,{t:i}}}},439:{f:os},440:{f:function(e,t){var n=As(e);e.l+=16;var r=function(e,t){var n=e.l+t,r=e.read_shift(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);var i=e.read_shift(2);e.l+=2;var o,a,s,l,u,c,d="";16&i&&(o=ws(e,e.l)),128&i&&(a=ws(e,e.l)),257===(257&i)&&(s=ws(e,e.l)),1===(257&i)&&(l=ys(e,e.l)),8&i&&(d=ws(e,e.l)),32&i&&(u=e.read_shift(16)),64&i&&(c=Va(e)),e.l=n;var h=a||s||l||"";h&&d&&(h+="#"+d),h||(h="#"+d),2&i&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var f={Target:h};return u&&(f.guid=u),c&&(f.time=c),o&&(f.Tooltip=o),f}(e,t-24);return[n,r]}},441:{},442:{f:vs},443:{},444:{f:ss},445:{},446:{},448:{f:is},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:is},512:{f:Hs},513:{f:el},515:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5);var r=ks(e),i=$o(e);return r.val=i,r}},516:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5),e.l;var r=ks(e);2==n.biff&&e.l++;var i=vs(e,e.l,n);return r.val=i,r}},517:{f:Ws},519:{f:nl},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,7&r&&(t.level=7&r),32&r&&(t.hidden=!0),64&r&&(t.hpt=n/20),t}},523:{},545:{f:Ys},549:{f:Gs},566:{},574:{f:function(e,t,n){return n&&n.biff>=2&&n.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=Rs(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}},659:{},1048:{},1054:{f:function(e,t,n){return[e.read_shift(2),gs(e,0,n)]}},1084:{},1212:{f:function(e,t,n){var r=Os(e);e.l++;var i=e.read_shift(1);return[yc(e,t-=8,n),i,r]}},2048:{f:function(e,t){e.read_shift(2);var n=As(e),r=e.read_shift((t-10)/2,"dbcs-cont");return[n,r=r.replace(nn,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Is},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:is},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var n=e.read_shift(2);e.l+=2;for(var r=e.read_shift(2),i=[];r-- >0;)i.push(Ru(e,e.l));return{ixfe:n,ext:i}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:os,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),i=e.read_shift(2);return[ps(e,r,n),ps(e,i,n)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,n){var r=e.l+t;if(124226!==e.read_shift(4))if(n.cellStyles){var i,o=e.slice(e.l);e.l=r;try{i=Lr(o,{type:"array"})}catch(s){return}var a=Dr(i,"theme/theme/theme1.xml",!0);if(a)return ku(a,n)}else e.l=r},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:is},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ss},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,n){var r={area:!1};if(5!=n.biff)return e.l+=t,r;var i=e.read_shift(1);return e.l+=3,16&i&&(r.area=!0),r}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(Es(e));return n}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Hs},1:{},2:{f:function(e){var t=ks(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}},3:{f:function(e){var t=ks(e);++e.l;var n=$o(e);return t.t="n",t.val=n,t}},4:{f:function(e,t,n){n.biffguess&&5==n.biff&&(n.biff=2);var r=ks(e);++e.l;var i=gs(e,0,n);return r.t="str",r.val=i,r}},5:{f:Ws},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:Is},11:{},22:{f:ss},30:{f:js},31:{},32:{},33:{f:Ys},36:{},37:{f:Gs},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:ss},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,i}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,n){var r=e.l+t,i=ks(e),o=e.read_shift(2),a=ps(e,o,n);return e.l=r,i.t="str",i.val=a,i}},223:{},234:{},354:{},421:{},518:{f:wc},521:{f:Is},536:{f:qs},547:{f:Us},561:{},579:{},1030:{f:wc},1033:{f:Is},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function kh(e,t,n,r){var i=t;if(!isNaN(i)){var o=r||(n||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,o),o>0&&Ui(n)&&e.push(n)}}function xh(e,t,n){return e||(e=so(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function Th(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var i="d"==t.t?ur(yr(t.v)):t.v;return void(i==(0|i)&&i>=0&&i<65536?kh(e,2,function(e,t,n){var r=so(9);return xh(r,e,t),r.write_shift(2,n),r}(n,r,i)):kh(e,3,function(e,t,n){var r=so(15);return xh(r,e,t),r.write_shift(8,n,"f"),r}(n,r,i)));case"b":case"e":return void kh(e,5,function(e,t,n,r){var i=so(9);return xh(i,e,t),cs(n,r||"b",i),i}(n,r,t.v,t.t));case"s":case"str":return void kh(e,4,function(e,t,n){var r=so(8+2*n.length);return xh(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(n,r,(t.v||"").slice(0,255)))}kh(e,1,xh(null,n,r))}function Rh(e,t){var n=t||{};null!=Wt&&null==n.dense&&(n.dense=Wt);for(var r=uo(),i=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==n.sheet&&(i=o);if(0==i&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return kh(r,4==n.biff?1033:3==n.biff?521:9,Ls(0,16,n)),function(e,t,n,r){var i,o=Array.isArray(t),a=ko(t["!ref"]||"A1"),s="",l=[];if(a.e.c>255||a.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Eo(a)}for(var u=a.s.r;u<=a.e.r;++u){s=mo(u);for(var c=a.s.c;c<=a.e.c;++c){u===a.s.r&&(l[c]=wo(c)),i=l[c]+s;var d=o?(t[u]||[])[c]:t[i];d&&Th(e,d,u,c)}}}(r,e.Sheets[e.SheetNames[i]],0,n),kh(r,10),r.end()}function Ah(e,t,n){kh(e,49,function(e,t){var n=e.name||"Arial",r=t&&5==t.biff,i=so(r?15+n.length:16+2*n.length);return i.write_shift(2,20*(e.sz||12)),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,n.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),i}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function _h(e,t){if(t){var n=0;t.forEach((function(t,r){++n<=256&&t&&kh(e,125,function(e,t){var n=so(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,256*e.width),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}(Mc(r,t),r))}))}}function Oh(e,t,n,r,i){var o=16+Bc(i.cellXfs,t,i);if(null!=t.v||t.bf)if(t.bf)kh(e,6,bc(t,n,r,0,o));else switch(t.t){case"d":case"n":kh(e,515,function(e,t,n,r){var i=so(14);return xs(e,t,r,i),ea(n,i),i}(n,r,"d"==t.t?ur(yr(t.v)):t.v,o));break;case"b":case"e":kh(e,517,function(e,t,n,r,i,o){var a=so(8);return xs(e,t,r,a),cs(n,o,a),a}(n,r,t.v,o,0,t.t));break;case"s":case"str":if(i.bookSST)kh(e,253,function(e,t,n,r){var i=so(10);return xs(e,t,r,i),i.write_shift(4,n),i}(n,r,Lc(i.Strings,t.v,i.revStrings),o));else kh(e,516,function(e,t,n,r,i){var o=!i||8==i.biff,a=so(+o+8+(1+o)*n.length);return xs(e,t,r,a),a.write_shift(2,n.length),o&&a.write_shift(1,1),a.write_shift((1+o)*n.length,n,o?"utf16le":"sbcs"),a}(n,r,(t.v||"").slice(0,255),o,i));break;default:kh(e,513,xs(n,r,o))}else kh(e,513,xs(n,r,o))}function Dh(e,t,n){var r,i=uo(),o=n.SheetNames[e],a=n.Sheets[o]||{},s=(n||{}).Workbook||{},l=(s.Sheets||[])[e]||{},u=Array.isArray(a),c=8==t.biff,d="",h=[],f=ko(a["!ref"]||"A1"),p=c?65536:16384;if(f.e.c>255||f.e.r>=p){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,p-1)}kh(i,2057,Ls(0,16,t)),kh(i,13,ls(1)),kh(i,12,ls(100)),kh(i,15,as(!0)),kh(i,17,as(!1)),kh(i,16,ea(.001)),kh(i,95,as(!0)),kh(i,42,as(!1)),kh(i,43,as(!1)),kh(i,130,ls(1)),kh(i,128,function(e){var t=so(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),kh(i,131,as(!1)),kh(i,132,as(!1)),c&&_h(i,a["!cols"]),kh(i,512,function(e,t){var n=8!=t.biff&&t.biff?2:4,r=so(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(f,t)),c&&(a["!links"]=[]);for(var v=f.s.r;v<=f.e.r;++v){d=mo(v);for(var g=f.s.c;g<=f.e.c;++g){v===f.s.r&&(h[g]=wo(g)),r=h[g]+d;var m=u?(a[v]||[])[g]:a[r];m&&(Oh(i,m,v,g,t),c&&m.l&&a["!links"].push([r,m.l]))}}var y=l.CodeName||l.name||o;return c&&kh(i,574,function(e){var t=so(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((s.Views||[])[0])),c&&(a["!merges"]||[]).length&&kh(i,229,function(e){var t=so(2+8*e.length);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)_s(e[n],t);return t}(a["!merges"])),c&&function(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];kh(e,440,Zs(r)),r[1].Tooltip&&kh(e,2048,Js(r))}delete t["!links"]}(i,a),kh(i,442,ms(y)),c&&function(e,t){var n=so(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),kh(e,2151,n),(n=so(39)).write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),_s(ko(t["!ref"]||"A1"),n),n.write_shift(4,4),kh(e,2152,n)}(i,a),kh(i,10),i.end()}function Nh(e,t,n){var r=uo(),i=(e||{}).Workbook||{},o=i.Sheets||[],a=i.WBProps||{},s=8==n.biff,l=5==n.biff;(kh(r,2057,Ls(0,5,n)),"xla"==n.bookType&&kh(r,135),kh(r,225,s?ls(1200):null),kh(r,193,function(e,t){t||(t=so(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}(2)),l&&kh(r,191),l&&kh(r,192),kh(r,226),kh(r,92,function(e,t){var n=!t||8==t.biff,r=so(n?112:54);for(r.write_shift(8==t.biff?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}(0,n)),kh(r,66,ls(s?1200:1252)),s&&kh(r,353,ls(0)),s&&kh(r,448),kh(r,317,function(e){for(var t=so(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}(e.SheetNames.length)),s&&e.vbaraw&&kh(r,211),s&&e.vbaraw)&&kh(r,442,ms(a.CodeName||"ThisWorkbook"));kh(r,156,ls(17)),kh(r,25,as(!1)),kh(r,18,as(!1)),kh(r,19,ls(0)),s&&kh(r,431,as(!1)),s&&kh(r,444,ls(0)),kh(r,61,function(){var e=so(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),kh(r,64,as(!1)),kh(r,141,ls(0)),kh(r,34,as("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&ni(e.Workbook.WBProps.date1904)?"true":"false"}(e))),kh(r,14,as(!0)),s&&kh(r,439,as(!1)),kh(r,218,ls(0)),Ah(r,0,n),function(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var i=r[0];i<=r[1];++i)null!=t[i]&&kh(e,1054,Bs(i,t[i],n))}))}(r,e.SSF,n),function(e,t){for(var n=0;n<16;++n)kh(e,224,Vs({numFmtId:0,style:!0},0,t));t.cellXfs.forEach((function(n){kh(e,224,Vs(n,0,t))}))}(r,n),s&&kh(r,352,as(!1));var u,c=r.end(),d=uo();s&&kh(d,140,(u||(u=so(4)),u.write_shift(2,1),u.write_shift(2,1),u)),s&&n.Strings&&function(e,t,n,r){var i=r||(n||[]).length||0;if(i<=8224)return kh(e,t,n,i);var o=t;if(!isNaN(o)){for(var a=n.parts||[],s=0,l=0,u=0;u+(a[s]||8224)<=8224;)u+=a[s]||8224,s++;var c=e.next(4);for(c.write_shift(2,o),c.write_shift(2,u),e.push(n.slice(l,l+u)),l+=u;l<i;){for((c=e.next(4)).write_shift(2,60),u=0;u+(a[s]||8224)<=8224;)u+=a[s]||8224,s++;c.write_shift(2,u),e.push(n.slice(l,l+u)),l+=u}}}(d,252,function(e,t){var n=so(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],i=0;i<e.length;++i)r[i]=fs(e[i]);var o=tn([n].concat(r));return o.parts=[n.length].concat(r.map((function(e){return e.length}))),o}(n.Strings)),kh(d,10);var h=d.end(),f=uo(),p=0,v=0;for(v=0;v<e.SheetNames.length;++v)p+=(s?12:11)+(s?2:1)*e.SheetNames[v].length;var g=c.length+p+h.length;for(v=0;v<e.SheetNames.length;++v){kh(f,133,Ms({pos:g,hs:(o[v]||{}).Hidden||0,dt:0,name:e.SheetNames[v]},n)),g+=t[v].length}var m=f.end();if(p!=m.length)throw new Error("BS8 "+p+" != "+m.length);var y=[];return c.length&&y.push(c),m.length&&y.push(m),h.length&&y.push(h),tn(y)}function Ph(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(r&&r["!ref"])So(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}var i=t||{};switch(i.biff||2){case 8:case 5:return function(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=br(pn)),e&&e.SSF&&(Yn(),Xn(e.SSF),n.revssf=sr(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Rf(n),n.cellXfs=[],Bc(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=Dh(i,n,e);return r.unshift(Nh(e,r,n)),tn(r)}(e,t);case 4:case 3:case 2:return Rh(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Fh(e,t){var n=t||{};null!=Wt&&null==n.dense&&(n.dense=Wt);var r=n.dense?[]:{},i=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),a=i.index,s=o&&o.index||e.length,l=xr(e.slice(a,s),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,c=0,d=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(a=0;a<l.length;++a){var v=l[a].trim(),g=v.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var m=v.split(/<\/t[dh]>/i);for(s=0;s<m.length;++s){var y=m[s].trim();if(y.match(/<t[dh]/i)){for(var w=y,b=0;"<"==w.charAt(0)&&(b=w.indexOf(">"))>-1;)w=w.slice(b+1);for(var C=0;C<p.length;++C){var S=p[C];S.s.c==c&&S.s.r<u&&u<=S.e.r&&(c=S.e.c+1,C=-1)}var E=zr(y.slice(0,y.indexOf(">")));h=E.colspan?+E.colspan:1,((d=+E.rowspan)>1||h>1)&&p.push({s:{r:u,c:c},e:{r:u+(d||1)-1,c:c+h-1}});var k=E.t||E["data-t"]||"";if(w.length)if(w=ci(w),f.s.r>u&&(f.s.r=u),f.e.r<u&&(f.e.r=u),f.s.c>c&&(f.s.c=c),f.e.c<c&&(f.e.c=c),w.length){var x={t:"s",v:w};n.raw||!w.trim().length||"s"==k||("TRUE"===w?x={t:"b",v:!0}:"FALSE"===w?x={t:"b",v:!1}:isNaN(Sr(w))?isNaN(kr(w).getDate())||(x={t:"d",v:yr(w)},n.cellDates||(x={t:"n",v:ur(x.v)}),x.z=n.dateNF||pn[14]):x={t:"n",v:Sr(w)}),n.dense?(r[u]||(r[u]=[]),r[u][c]=x):r[Co({r:u,c:c})]=x,c+=h}else c+=h;else c+=h}}}}else{if(++u,n.sheetRows&&n.sheetRows<=u){--u;break}c=0}}return r["!ref"]=Eo(f),p.length&&(r["!merges"]=p),r}function Ih(e,t,n,r){for(var i=e["!merges"]||[],o=[],a=t.s.c;a<=t.e.c;++a){for(var s=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>n||i[u].s.c>a)&&!(i[u].e.r<n||i[u].e.c<a)){if(i[u].s.r<n||i[u].s.c<a){s=-1;break}s=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(s<0)){var c=Co({r:n,c:a}),d=r.dense?(e[n]||[])[a]:e[c],h=d&&null!=d.v&&(d.h||ei(d.w||(To(d),d.w)||""))||"",f={};s>1&&(f.rowspan=s),l>1&&(f.colspan=l),r.editable?h='<span contenteditable="true">'+h+"</span>":d&&(f["data-t"]=d&&d.t||"z",null!=d.v&&(f["data-v"]=d.v),null!=d.z&&(f["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),f.id=(r.id||"sjs")+"-"+c,o.push(yi("td",h,f))}}return"<tr>"+o.join("")+"</tr>"}var Lh='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Mh="</body></html>";function Gh(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Bh(e,t){var n=t||{},r=null!=n.header?n.header:Lh,i=null!=n.footer?n.footer:Mh,o=[r],a=So(e["!ref"]);n.dense=Array.isArray(e),o.push(Gh(0,0,n));for(var s=a.s.r;s<=a.e.r;++s)o.push(Ih(e,a,s,n));return o.push("</table>"+i),o.join("")}function jh(e,t,n){var r=n||{};null!=Wt&&(r.dense=Wt);var i=0,o=0;if(null!=r.origin)if("number"==typeof r.origin)i=r.origin;else{var a="string"==typeof r.origin?bo(r.origin):r.origin;i=a.r,o=a.c}var s=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,s.length),u={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var c=So(e["!ref"]);u.s.r=Math.min(u.s.r,c.s.r),u.s.c=Math.min(u.s.c,c.s.c),u.e.r=Math.max(u.e.r,c.e.r),u.e.c=Math.max(u.e.c,c.e.c),-1==i&&(u.e.r=i=c.e.r+1)}var d=[],h=0,f=e["!rows"]||(e["!rows"]=[]),p=0,v=0,g=0,m=0,y=0,w=0;for(e["!cols"]||(e["!cols"]=[]);p<s.length&&v<l;++p){var b=s[p];if(Vh(b)){if(r.display)continue;f[v]={hidden:!0}}var C=b.children;for(g=m=0;g<C.length;++g){var S=C[g];if(!r.display||!Vh(S)){var E=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):ci(S.innerHTML),k=S.getAttribute("data-z")||S.getAttribute("z");for(h=0;h<d.length;++h){var x=d[h];x.s.c==m+o&&x.s.r<v+i&&v+i<=x.e.r&&(m=x.e.c+1-o,h=-1)}w=+S.getAttribute("colspan")||1,((y=+S.getAttribute("rowspan")||1)>1||w>1)&&d.push({s:{r:v+i,c:m+o},e:{r:v+i+(y||1)-1,c:m+o+(w||1)-1}});var T={t:"s",v:E},R=S.getAttribute("data-t")||S.getAttribute("t")||"";null!=E&&(0==E.length?T.t=R||"z":r.raw||0==E.trim().length||"s"==R||("TRUE"===E?T={t:"b",v:!0}:"FALSE"===E?T={t:"b",v:!1}:isNaN(Sr(E))?isNaN(kr(E).getDate())||(T={t:"d",v:yr(E)},r.cellDates||(T={t:"n",v:ur(T.v)}),T.z=r.dateNF||pn[14]):T={t:"n",v:Sr(E)})),void 0===T.z&&null!=k&&(T.z=k);var A="",_=S.getElementsByTagName("A");if(_&&_.length)for(var O=0;O<_.length&&(!_[O].hasAttribute("href")||"#"==(A=_[O].getAttribute("href")).charAt(0));++O);A&&"#"!=A.charAt(0)&&(T.l={Target:A}),r.dense?(e[v+i]||(e[v+i]=[]),e[v+i][m+o]=T):e[Co({c:m+o,r:v+i})]=T,u.e.c<m+o&&(u.e.c=m+o),m+=w}}++v}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,v-1+i),e["!ref"]=Eo(u),v>=l&&(e["!fullref"]=Eo((u.e.r=s.length-p+v-1+i,u))),e}function Hh(e,t){return jh((t||{}).dense?[]:{},e,t)}function Vh(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function Wh(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[Xr(t.replace(/<[^>]*>/g,""))]}var zh={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Uh(e,t){var n=t||{};null!=Wt&&null==n.dense&&(n.dense=Wt);var r,i,o,a,s,l,u=bi(e),c=[],d={name:""},h="",f=0,p={},v=[],g=n.dense?[]:{},m={value:""},y="",w=0,b=[],C=-1,S=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,x={},T=[],R={},A=[],_=1,O=1,D=[],N={Names:[]},P={},F=["",""],I=[],L={},M="",G=0,B=!1,j=!1,H=0;for(Ci.lastIndex=0,u=u.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");s=Ci.exec(u);)switch(s[3]=s[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===s[1]?(E.e.c>=E.s.c&&E.e.r>=E.s.r?g["!ref"]=Eo(E):g["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=E.e.r&&(g["!fullref"]=g["!ref"],E.e.r=n.sheetRows-1,g["!ref"]=Eo(E)),T.length&&(g["!merges"]=T),A.length&&(g["!rows"]=A),o.name=o["\u540d\u79f0"]||o.name,"undefined"!==typeof JSON&&JSON.stringify(o),v.push(o.name),p[o.name]=g,j=!1):"/"!==s[0].charAt(s[0].length-2)&&(o=zr(s[0],!1),C=S=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,g=n.dense?[]:{},T=[],A=[],j=!0);break;case"table-row-group":"/"===s[1]?--k:++k;break;case"table-row":case"\u884c":if("/"===s[1]){C+=_,_=1;break}if((a=zr(s[0],!1))["\u884c\u53f7"]?C=a["\u884c\u53f7"]-1:-1==C&&(C=0),(_=+a["number-rows-repeated"]||1)<10)for(H=0;H<_;++H)k>0&&(A[C+H]={level:k});S=-1;break;case"covered-table-cell":"/"!==s[1]&&++S,n.sheetStubs&&(n.dense?(g[C]||(g[C]=[]),g[C][S]={t:"z"}):g[Co({r:C,c:S})]={t:"z"}),y="",b=[];break;case"table-cell":case"\u6570\u636e":if("/"===s[0].charAt(s[0].length-2))++S,m=zr(s[0],!1),O=parseInt(m["number-columns-repeated"]||"1",10),l={t:"z",v:null},m.formula&&0!=n.cellFormula&&(l.f=_c(Xr(m.formula))),"string"==(m["\u6570\u636e\u7c7b\u578b"]||m["value-type"])&&(l.t="s",l.v=Xr(m["string-value"]||""),n.dense?(g[C]||(g[C]=[]),g[C][S]=l):g[Co({r:C,c:S})]=l),S+=O-1;else if("/"!==s[1]){y="",w=0,b=[],O=1;var V=_?C+_-1:C;if(++S>E.e.c&&(E.e.c=S),S<E.s.c&&(E.s.c=S),C<E.s.r&&(E.s.r=C),V>E.e.r&&(E.e.r=V),I=[],L={},l={t:(m=zr(s[0],!1))["\u6570\u636e\u7c7b\u578b"]||m["value-type"],v:null},n.cellFormula)if(m.formula&&(m.formula=Xr(m.formula)),m["number-matrix-columns-spanned"]&&m["number-matrix-rows-spanned"]&&(R={s:{r:C,c:S},e:{r:C+(parseInt(m["number-matrix-rows-spanned"],10)||0)-1,c:S+(parseInt(m["number-matrix-columns-spanned"],10)||0)-1}},l.F=Eo(R),D.push([R,l.F])),m.formula)l.f=_c(m.formula);else for(H=0;H<D.length;++H)C>=D[H][0].s.r&&C<=D[H][0].e.r&&S>=D[H][0].s.c&&S<=D[H][0].e.c&&(l.F=D[H][1]);switch((m["number-columns-spanned"]||m["number-rows-spanned"])&&(R={s:{r:C,c:S},e:{r:C+(parseInt(m["number-rows-spanned"],10)||0)-1,c:S+(parseInt(m["number-columns-spanned"],10)||0)-1}},T.push(R)),m["number-columns-repeated"]&&(O=parseInt(m["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=ni(m["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(m.value);break;case"date":l.t="d",l.v=yr(m["date-value"]),n.cellDates||(l.t="n",l.v=ur(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=pr(m["time-value"])/86400,n.cellDates&&(l.t="d",l.v=fr(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(m["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=m["string-value"]&&(y=Xr(m["string-value"]),b=[])}}else{if(B=!1,"s"===l.t&&(l.v=y||"",b.length&&(l.R=b),B=0==w),P.Target&&(l.l=P),I.length>0&&(l.c=I,I=[]),y&&!1!==n.cellText&&(l.w=y),B&&(l.t="z",delete l.v),(!B||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=C))for(var W=0;W<_;++W){if(O=parseInt(m["number-columns-repeated"]||"1",10),n.dense)for(g[C+W]||(g[C+W]=[]),g[C+W][S]=0==W?l:br(l);--O>0;)g[C+W][S+O]=br(l);else for(g[Co({r:C+W,c:S})]=l;--O>0;)g[Co({r:C+W,c:S+O})]=br(l);E.e.c<=S&&(E.e.c=S)}S+=(O=parseInt(m["number-columns-repeated"]||"1",10))-1,O=0,l={},y="",b=[]}P={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===s[1]){if((r=c.pop())[0]!==s[3])throw"Bad state: "+r}else"/"!==s[0].charAt(s[0].length-2)&&c.push([s[3],!0]);break;case"annotation":if("/"===s[1]){if((r=c.pop())[0]!==s[3])throw"Bad state: "+r;L.t=y,b.length&&(L.R=b),L.a=M,I.push(L)}else"/"!==s[0].charAt(s[0].length-2)&&c.push([s[3],!1]);M="",G=0,y="",w=0,b=[];break;case"creator":"/"===s[1]?M=u.slice(G,s.index):G=s.index+s[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===s[1]){if((r=c.pop())[0]!==s[3])throw"Bad state: "+r}else"/"!==s[0].charAt(s[0].length-2)&&c.push([s[3],!1]);y="",w=0,b=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===s[1]){if(x[d.name]=h,(r=c.pop())[0]!==s[3])throw"Bad state: "+r}else"/"!==s[0].charAt(s[0].length-2)&&(h="",d=zr(s[0],!1),c.push([s[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(c[c.length-1][0]){case"time-style":case"date-style":i=zr(s[0],!1),h+=zh[s[3]]["long"===i.style?1:0]}break;case"text":if("/>"===s[0].slice(-2))break;if("/"===s[1])switch(c[c.length-1][0]){case"number-style":case"date-style":case"time-style":h+=u.slice(f,s.index)}else f=s.index+s[0].length;break;case"named-range":F=Dc((i=zr(s[0],!1))["cell-range-address"]);var z={Name:i.name,Ref:F[0]+"!"+F[1]};j&&(z.Sheet=v.length),N.Names.push(z);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(c[c.length-1][0])>-1)break;if("/"!==s[1]||m&&m["string-value"])zr(s[0],!1),w=s.index+s[0].length;else{var U=Wh(u.slice(w,s.index));y=(y.length>0?y+"\n":"")+U[0]}break;case"database-range":if("/"===s[1])break;try{p[(F=Dc(zr(s[0])["target-range-address"]))[0]]["!autofilter"]={ref:F[1]}}catch(q){}break;case"a":if("/"!==s[1]){if(!(P=zr(s[0],!1)).href)break;P.Target=Xr(P.href),delete P.href,"#"==P.Target.charAt(0)&&P.Target.indexOf(".")>-1?(F=Dc(P.Target.slice(1)),P.Target="#"+F[0]+"!"+F[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;default:switch(s[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(n.WTF)throw new Error(s)}}var K={Sheets:p,SheetNames:v,Workbook:N};return n.bookSheets&&delete K.Sheets,K}function Kh(e,t){t=t||{},Ar(e,"META-INF/manifest.xml")&&function(e,t){for(var n,r,i=bi(e);n=Ci.exec(i);)switch(n[3]){case"manifest":break;case"file-entry":if("/"==(r=zr(n[0],!1)).path&&r.type!==xa)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}(Or(e,"META-INF/manifest.xml"),t);var n=Dr(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=Uh(si(n),t);return Ar(e,"meta.xml")&&(r.Props=Oa(Or(e,"meta.xml"))),r}function qh(e,t){return Uh(e,t)}var Xh=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+mi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Gr+t}}(),Yh=function(){var e="          <table:table-cell />\n",t=function(t,n,r){var i=[];i.push('      <table:table table:name="'+Zr(n.SheetNames[r])+'" table:style-name="ta1">\n');var o=0,a=0,s=So(t["!ref"]||"A1"),l=t["!merges"]||[],u=0,c=Array.isArray(t);if(t["!cols"])for(a=0;a<=s.e.c;++a)i.push("        <table:table-column"+(t["!cols"][a]?' table:style-name="co'+t["!cols"][a].ods+'"':"")+"></table:table-column>\n");var d="",h=t["!rows"]||[];for(o=0;o<s.s.r;++o)d=h[o]?' table:style-name="ro'+h[o].ods+'"':"",i.push("        <table:table-row"+d+"></table:table-row>\n");for(;o<=s.e.r;++o){for(d=h[o]?' table:style-name="ro'+h[o].ods+'"':"",i.push("        <table:table-row"+d+">\n"),a=0;a<s.s.c;++a)i.push(e);for(;a<=s.e.c;++a){var f=!1,p={},v="";for(u=0;u!=l.length;++u)if(!(l[u].s.c>a)&&!(l[u].s.r>o)&&!(l[u].e.c<a)&&!(l[u].e.r<o)){l[u].s.c==a&&l[u].s.r==o||(f=!0),p["table:number-columns-spanned"]=l[u].e.c-l[u].s.c+1,p["table:number-rows-spanned"]=l[u].e.r-l[u].s.r+1;break}if(f)i.push("          <table:covered-table-cell/>\n");else{var g=Co({r:o,c:a}),m=c?(t[o]||[])[a]:t[g];if(m&&m.f&&(p["table:formula"]=Zr(Oc(m.f)),m.F&&m.F.slice(0,g.length)==g)){var y=So(m.F);p["table:number-matrix-columns-spanned"]=y.e.c-y.s.c+1,p["table:number-matrix-rows-spanned"]=y.e.r-y.s.r+1}if(m){switch(m.t){case"b":v=m.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=m.v?"true":"false";break;case"n":v=m.w||String(m.v||0),p["office:value-type"]="float",p["office:value"]=m.v||0;break;case"s":case"str":v=null==m.v?"":m.v,p["office:value-type"]="string";break;case"d":v=m.w||yr(m.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=yr(m.v).toISOString(),p["table:style-name"]="ce1";break;default:i.push(e);continue}var w=Zr(v).replace(/  +/g,(function(e){return'<text:s text:c="'+e.length+'"/>'})).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");if(m.l&&m.l.Target){var b=m.l.Target;"#"==(b="#"==b.charAt(0)?"#"+Nc(b.slice(1)):b).charAt(0)||b.match(/^\w+:/)||(b="../"+b),w=yi("text:a",w,{"xlink:href":b.replace(/&/g,"&amp;")})}i.push("          "+yi("table:table-cell",yi("text:p",w,{}),p)+"\n")}else i.push(e)}}i.push("        </table:table-row>\n")}return i.push("      </table:table>\n"),i.join("")};return function(e,n){var r=[Gr],i=mi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),o=mi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==n.bookType?(r.push("<office:document"+i+o+">\n"),r.push(Ra().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+i+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var n=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var i=t["!cols"][r];if(null==i.width&&null==i.wpx&&null==i.wch)continue;Xl(i),i.ods=n;var o=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+n+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+o+'"/>\n'),e.push("  </style:style>\n"),++n}}));var r=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!rows"])for(var n=0;n<t["!rows"].length;++n)if(t["!rows"][n]){t["!rows"][n].ods=r;var i=t["!rows"][n].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+i+'"/>\n'),e.push("  </style:style>\n"),++r}})),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var a=0;a!=e.SheetNames.length;++a)r.push(t(e.Sheets[e.SheetNames[a]],e,a));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==n.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function Qh(e,t){if("fods"==t.bookType)return Yh(e,t);var n=Ir(),r="",i=[],o=[];return Fr(n,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Fr(n,r="content.xml",Yh(e,t)),i.push([r,"text/xml"]),o.push([r,"ContentFile"]),Fr(n,r="styles.xml",Xh(e,t)),i.push([r,"text/xml"]),o.push([r,"StylesFile"]),Fr(n,r="meta.xml",Gr+Ra()),i.push([r,"text/xml"]),o.push([r,"MetadataFile"]),Fr(n,r="manifest.rdf",function(e){var t,n,r=[Gr];r.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var i=0;i!=e.length;++i)r.push(Ta(e[i][0],e[i][1])),r.push((t="",n=e[i][0],['  <rdf:Description rdf:about="'+t+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+'"/>\n',"  </rdf:Description>\n"].join("")));return r.push(Ta("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}(o)),i.push([r,"application/rdf+xml"]),Fr(n,r="META-INF/manifest.xml",function(e){var t=[Gr];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(i)),n}function Zh(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Jh(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):si($t(e))}function $h(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):Zt(li(e))}function ef(e){var t=e.reduce((function(e,t){return e+t.length}),0),n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(e,r),r+=e.length})),n}function tf(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function nf(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function rf(e){var t=new Uint8Array(7);t[0]=127&e;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383)break e;if(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)break e;if(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)break e;if(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)break e;if(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103)break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function of(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function af(e){for(var t=[],n=[0];n[0]<e.length;){var r,i=n[0],o=nf(e,n),a=7&o,s=0;if(0==(o=Math.floor(o/8)))break;switch(a){case 0:for(var l=n[0];e[n[0]++]>=128;);r=e.slice(l,n[0]);break;case 5:s=4,r=e.slice(n[0],n[0]+s),n[0]+=s;break;case 1:s=8,r=e.slice(n[0],n[0]+s),n[0]+=s;break;case 2:s=nf(e,n),r=e.slice(n[0],n[0]+s),n[0]+=s;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(o," at offset ").concat(i))}var u={data:r,type:a};null==t[o]?t[o]=[u]:t[o].push(u)}return t}function sf(e){var t=[];return e.forEach((function(e,n){e.forEach((function(e){e.data&&(t.push(rf(8*n+e.type)),2==e.type&&t.push(rf(e.data.length)),t.push(e.data))}))})),ef(t)}function lf(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function uf(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=nf(e,r),o=af(e.slice(r[0],r[0]+i));r[0]+=i;var a={id:of(o[1][0].data),messages:[]};o[2].forEach((function(t){var n=af(t.data),i=of(n[3][0].data);a.messages.push({meta:n,data:e.slice(r[0],r[0]+i)}),r[0]+=i})),(null==(t=o[3])?void 0:t[0])&&(a.merge=of(o[3][0].data)>>>0>0),n.push(a)}return n}function cf(e){var t=[];return e.forEach((function(e){var n=[];n[1]=[{data:rf(e.id),type:0}],n[2]=[],null!=e.merge&&(n[3]=[{data:rf(+!!e.merge),type:0}]);var r=[];e.messages.forEach((function(e){r.push(e.data),e.meta[3]=[{type:0,data:rf(e.data.length)}],n[2].push({data:sf(e.meta),type:2})}));var i=sf(n);t.push(rf(i.length)),t.push(i),r.forEach((function(e){return t.push(e)}))})),ef(t)}function df(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=nf(t,n),i=[];n[0]<t.length;){var o=3&t[n[0]];if(0!=o){var a=0,s=0;if(1==o?(s=4+(t[n[0]]>>2&7),a=(224&t[n[0]++])<<3,a|=t[n[0]++]):(s=1+(t[n[0]++]>>2),2==o?(a=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(a=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[ef(i)],0==a)throw new Error("Invalid offset 0");if(a>i[0].length)throw new Error("Invalid offset beyond length");if(s>=a)for(i.push(i[0].slice(-a)),s-=a;s>=i[i.length-1].length;)i.push(i[i.length-1]),s-=i[i.length-1].length;i.push(i[0].slice(-a,-a+s))}else{var l=t[n[0]++]>>2;if(l<60)++l;else{var u=l-59;l=t[n[0]],u>1&&(l|=t[n[0]+1]<<8),u>2&&(l|=t[n[0]+2]<<16),u>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=u}i.push(t.slice(n[0],n[0]+l)),n[0]+=l}}var c=ef(i);if(c.length!=r)throw new Error("Unexpected length: ".concat(c.length," != ").concat(r));return c}function hf(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(df(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return ef(t)}function ff(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var o=rf(r),a=o.length;t.push(o),r<=60?(a++,t.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),a+=r,i[0]=0,i[1]=255&a,i[2]=a>>8&255,i[3]=a>>16&255,n+=r}return ef(t)}function pf(e,t,n){var r,i=Zh(e),o=i.getUint32(8,!0),a=12,s=-1,l=-1,u=NaN,c=NaN,d=new Date(2001,0,1);switch(1&o&&(u=function(e,t){for(var n=(127&e[t+15])<<7|e[t+14]>>1,r=1&e[t+14],i=t+13;i>=t;--i)r=256*r+e[i];return(128&e[t+15]?-r:r)*Math.pow(10,n-6176)}(e,a),a+=16),2&o&&(c=i.getFloat64(a,!0),a+=8),4&o&&(d.setTime(d.getTime()+1e3*i.getFloat64(a,!0)),a+=8),8&o&&(l=i.getUint32(a,!0),a+=4),16&o&&(s=i.getUint32(a,!0),a+=4),e[1]){case 0:break;case 2:case 10:r={t:"n",v:u};break;case 3:r={t:"s",v:t[l]};break;case 5:r={t:"d",v:d};break;case 6:r={t:"b",v:c>0};break;case 7:r={t:"n",v:c/86400};break;case 8:r={t:"e",v:0};break;case 9:if(!(s>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&o," : ").concat(e.slice(0,4)));r={t:"s",v:n[s]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&o," : ").concat(e.slice(0,4)))}return r}function vf(e,t){var n=new Uint8Array(32),r=Zh(n),i=12,o=0;switch(n[0]=5,e.t){case"n":n[1]=2,function(e,t,n){var r=Math.floor(0==n?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var o=0;i>=1;++o,i/=256)e[t+o]=255&i;e[t+15]|=n>=0?0:128}(n,i,e.v),o|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),o|=2,i+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),o|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,o,!0),n.slice(0,i)}function gf(e,t){var n=new Uint8Array(32),r=Zh(n),i=12,o=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),o|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),o|=32,i+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),o|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,o,!0),n.slice(0,i)}function mf(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,n,r){var i,o=Zh(e),a=o.getUint32(4,!0),s=(r>1?12:8)+4*tf(a&(r>1?3470:398)),l=-1,u=-1,c=NaN,d=new Date(2001,0,1);switch(512&a&&(l=o.getUint32(s,!0),s+=4),s+=4*tf(a&(r>1?12288:4096)),16&a&&(u=o.getUint32(s,!0),s+=4),32&a&&(c=o.getFloat64(s,!0),s+=8),64&a&&(d.setTime(d.getTime()+1e3*o.getFloat64(s,!0)),s+=8),e[2]){case 0:break;case 2:i={t:"n",v:c};break;case 3:i={t:"s",v:t[u]};break;case 5:i={t:"d",v:d};break;case 6:i={t:"b",v:c>0};break;case 7:i={t:"n",v:c/86400};break;case 8:i={t:"e",v:0};break;case 9:if(l>-1)i={t:"s",v:n[l]};else if(u>-1)i={t:"s",v:t[u]};else{if(isNaN(c))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));i={t:"n",v:c}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return i}(e,t,n,e[0]);case 5:return pf(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function yf(e){return nf(af(e)[1][0].data)}function wf(e,t){var n=af(t.data),r=of(n[1][0].data),i=n[3],o=[];return(i||[]).forEach((function(t){var n=af(t.data),i=of(n[1][0].data)>>>0;switch(r){case 1:o[i]=Jh(n[3][0].data);break;case 8:var a=af(e[yf(n[9][0].data)][0].data),s=e[yf(a[1][0].data)][0],l=of(s.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var u=af(s.data);o[i]=u[3].map((function(e){return Jh(e.data)})).join("")}})),o}function bf(e,t){var n,r=af(t.data),i=(null==(n=null==r?void 0:r[7])?void 0:n[0])?of(r[7][0].data)>>>0>0?1:0:-1,o=lf(r[5],(function(e){return function(e,t){var n,r,i,o,a,s,l,u,c,d,h,f,p,v,g,m,y=af(e),w=of(y[1][0].data)>>>0,b=of(y[2][0].data)>>>0,C=(null==(r=null==(n=y[8])?void 0:n[0])?void 0:r.data)&&of(y[8][0].data)>0||!1;if((null==(o=null==(i=y[7])?void 0:i[0])?void 0:o.data)&&0!=t)g=null==(s=null==(a=y[7])?void 0:a[0])?void 0:s.data,m=null==(u=null==(l=y[6])?void 0:l[0])?void 0:u.data;else{if(!(null==(d=null==(c=y[4])?void 0:c[0])?void 0:d.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(f=null==(h=y[4])?void 0:h[0])?void 0:f.data,m=null==(v=null==(p=y[3])?void 0:p[0])?void 0:v.data}for(var S=C?4:1,E=Zh(g),k=[],x=0;x<g.length/2;++x){var T=E.getUint16(2*x,!0);T<65535&&k.push([x,T])}if(k.length!=b)throw"Expected ".concat(b," cells, found ").concat(k.length);var R=[];for(x=0;x<k.length-1;++x)R[k[x][0]]=m.subarray(k[x][1]*S,k[x+1][1]*S);return k.length>=1&&(R[k[k.length-1][0]]=m.subarray(k[k.length-1][1]*S)),{R:w,cells:R}}(e,i)}));return{nrows:of(r[4][0].data)>>>0,data:o.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(n,r){if(e[t.R][r])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(r));e[t.R][r]=n})),e}),[])}}function Cf(e,t){var n={"!ref":"A1"},r=e[yf(af(t.data)[2][0].data)],i=of(r[0].meta[1][0].data);if(6001!=i)throw new Error("6000 unexpected reference to ".concat(i));return function(e,t,n){var r,i=af(t.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(of(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(of(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));n["!ref"]=Eo(o);var a=af(i[4][0].data),s=wf(e,e[yf(a[4][0].data)][0]),l=(null==(r=a[17])?void 0:r[0])?wf(e,e[yf(a[17][0].data)][0]):[],u=af(a[3][0].data),c=0;u[1].forEach((function(t){var r=af(t.data),i=e[yf(r[2][0].data)][0],o=of(i.meta[1][0].data);if(6002!=o)throw new Error("6001 unexpected reference to ".concat(o));var a=bf(0,i);a.data.forEach((function(e,t){e.forEach((function(e,r){var i=Co({r:c+t,c:r}),o=mf(e,s,l);o&&(n[i]=o)}))})),c+=a.nrows}))}(e,r[0],n),n}function Sf(e,t){var n={SheetNames:[],Sheets:{}};if(lf(af(t.data)[1],yf).forEach((function(t){e[t].forEach((function(t){if(2==of(t.meta[1][0].data)){var r=function(e,t){var n,r=af(t.data),i={name:(null==(n=r[1])?void 0:n[0])?Jh(r[1][0].data):"",sheets:[]};return lf(r[2],yf).forEach((function(t){e[t].forEach((function(t){6e3==of(t.meta[1][0].data)&&i.sheets.push(Cf(e,t))}))})),i}(e,t);r.sheets.forEach((function(e,t){Jf(n,e,0==t?r.name:r.name+"_"+t,!0)}))}}))})),0==n.SheetNames.length)throw new Error("Empty NUMBERS file");return n}function Ef(e){var t,n,r,i,o={},a=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)){var t,n;try{t=hf(e.content)}catch(r){return console.log("?? "+e.content.length+" "+(r.message||r))}try{n=uf(t)}catch(r){return console.log("## "+(r.message||r))}n.forEach((function(e){o[e.id]=e.messages,a.push(e.id)}))}})),!a.length)throw new Error("File has no messages");var s=(null==(i=null==(r=null==(n=null==(t=null==o?void 0:o[1])?void 0:t[0])?void 0:n.meta)?void 0:r[1])?void 0:i[0].data)&&1==of(o[1][0].meta[1][0].data)&&o[1][0];if(s||a.forEach((function(e){o[e].forEach((function(e){if(1==of(e.meta[1][0].data)>>>0){if(s)throw new Error("Document has multiple roots");s=e}}))})),!s)throw new Error("Cannot find Document root");return Sf(o,s)}function kf(e,t,n){var r,i,o,a;if(!(null==(r=e[6])?void 0:r[0])||!(null==(i=e[7])?void 0:i[0]))throw"Mutation only works on post-BNC storages!";if((null==(a=null==(o=e[8])?void 0:o[0])?void 0:a.data)&&of(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var s=0,l=Zh(e[7][0].data),u=0,c=[],d=Zh(e[4][0].data),h=0,f=[],p=0;p<t.length;++p)if(null!=t[p]){var v,g;switch(l.setUint16(2*p,u,!0),d.setUint16(2*p,h,!0),typeof t[p]){case"string":v=vf({t:"s",v:t[p]},n),g=gf({t:"s",v:t[p]},n);break;case"number":v=vf({t:"n",v:t[p]},n),g=gf({t:"n",v:t[p]},n);break;case"boolean":v=vf({t:"b",v:t[p]},n),g=gf({t:"b",v:t[p]},n);break;default:throw new Error("Unsupported value "+t[p])}c.push(v),u+=v.length,f.push(g),h+=g.length,++s}else l.setUint16(2*p,65535,!0),d.setUint16(2*p,65535);for(e[2][0].data=rf(s);p<e[7][0].data.length/2;++p)l.setUint16(2*p,65535,!0),d.setUint16(2*p,65535,!0);return e[6][0].data=ef(c),e[3][0].data=ef(f),s}function xf(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function Tf(e){xf([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Rf(e){xf([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Af(e,t,n,r,i,o,a,s,l,u,c,d){try{o[r]=Sa(Dr(e,n,!0),t);var h,f=Or(e,t);switch(s){case"sheet":h=Bd(f,t,i,l,o[r],u,c,d);break;case"chart":if(!(h=jd(f,t,i,l,o[r],u))||!h["!drawel"])break;var p=Mr(h["!drawel"].Target,t),v=Ca(p),g=function(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}(Dr(e,p,!0),Sa(Dr(e,v,!0),p)),m=Mr(g,p),y=Ca(m);h=Cd(Dr(e,m,!0),0,0,Sa(Dr(e,y,!0),m),0,h);break;case"macro":b=t,o[r],b.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,t,n,r,i,o,a,s){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,o[r]);break;default:throw new Error("Unrecognized sheet type "+s)}a[r]=h;var w=[];o&&o[r]&&ir(o[r]).forEach((function(n){var i="";if(o[r][n].Type==ba.CMNT){i=Mr(o[r][n].Target,t);var a=Wd(Or(e,i,!0),i,l);if(!a||!a.length)return;Nu(h,a,!1)}o[r][n].Type==ba.TCMNT&&(i=Mr(o[r][n].Target,t),w=w.concat(function(e,t){var n=[],r=!1,i={},o=0;return e.replace(Hr,(function(a,s){var l=zr(a);switch(Ur(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=i.t&&n.push(i);break;case"<text>":case"<text":o=s+a.length;break;case"</text>":i.t=e.slice(o,s).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":r=!0;break;case"</mentions>":case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return a})),n}(Or(e,i,!0),l)))})),w&&w.length&&Nu(h,w,!0,l.people||[])}catch(C){if(l.WTF)throw C}var b}function _f(e){return"/"==e.charAt(0)?e.slice(1):e}function Of(e,t){if(Yn(),Tf(t=t||{}),Ar(e,"META-INF/manifest.xml"))return Kh(e,t);if(Ar(e,"objectdata.xml"))return Kh(e,t);if(Ar(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return Ef(e);var n=er.utils.cfb_new();return Pr(e).forEach((function(t){Fr(n,t,Nr(e,t))})),Ef(n)}if(!Ar(e,"[Content_Types].xml")){if(Ar(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Ar(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var r,i,o=Pr(e),a=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var n={};if((e.match(Hr)||[]).forEach((function(e){var r=zr(e);switch(r[0].replace(Vr,"<")){case"<?xml":break;case"<Types":t.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[r.Extension]=r.ContentType;break;case"<Override":void 0!==t[ma[r.ContentType]]&&t[ma[r.ContentType]].push(r.PartName)}})),t.xmlns!==Si.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}(Dr(e,"[Content_Types].xml")),s=!1;if(0===a.workbooks.length&&Or(e,i="xl/workbook.xml",!0)&&a.workbooks.push(i),0===a.workbooks.length){if(!Or(e,i="xl/workbook.bin",!0))throw new Error("Could not find workbook");a.workbooks.push(i),s=!0}"bin"==a.workbooks[0].slice(-3)&&(s=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(Pc=[],a.sst)try{Pc=Vd(Or(e,_f(a.sst)),a.sst,t)}catch(O){if(t.WTF)throw O}t.cellStyles&&a.themes.length&&(l=function(e,t,n){return ku(e,n)}(Dr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=Hd(Or(e,_f(a.style)),a.style,l,t))}a.links.map((function(n){try{Sa(Dr(e,Ca(_f(n))),n);return Ud(Or(e,_f(n)),0,n,t)}catch(O){}}));var c=Gd(Or(e,_f(a.workbooks[0])),a.workbooks[0],t),d={},h="";a.coreprops.length&&((h=Or(e,_f(a.coreprops[0]),!0))&&(d=Oa(h)),0!==a.extprops.length&&(h=Or(e,_f(a.extprops[0]),!0))&&function(e,t,n){var r={};t||(t={}),e=si(e),Pa.forEach((function(n){var i=(e.match(ui(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=Xr(i));break;case"bool":t[n[1]]="true"===i;break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(r[n[1]]=o[1])}})),r.HeadingPairs&&r.TitlesOfParts&&Ia(r.HeadingPairs,r.TitlesOfParts,t,n)}(h,d,t));var f={};t.bookSheets&&!t.bookProps||0!==a.custprops.length&&(h=Dr(e,_f(a.custprops[0]),!0))&&(f=function(e,t){var n={},r="",i=e.match(Ma);if(i)for(var o=0;o!=i.length;++o){var a=i[o],s=zr(a);switch(s[0]){case"<?xml":case"<Properties":break;case"<property":r=Xr(s.name);break;case"</property>":r=null;break;default:if(0===a.indexOf("<vt:")){var l=a.split(">"),u=l[0].slice(4),c=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":n[r]=Xr(c);break;case"bool":n[r]=ni(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(c,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(c);break;case"filetime":case"date":n[r]=yr(c);break;default:if("/"==u.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",a,u,l)}}else if("</"===a.slice(0,2));else if(t.WTF)throw new Error(a)}}return n}(h,t));var p={};if((t.bookSheets||t.bookProps)&&(c.Sheets?r=c.Sheets.map((function(e){return e.name})):d.Worksheets&&d.SheetNames.length>0&&(r=d.SheetNames),t.bookProps&&(p.Props=d,p.Custprops=f),t.bookSheets&&"undefined"!==typeof r&&(p.SheetNames=r),t.bookSheets?p.SheetNames:t.bookProps))return p;r={};var v={};t.bookDeps&&a.calcchain&&(v=zd(Or(e,_f(a.calcchain)),a.calcchain));var g,m,y=0,w={},b=c.Sheets;d.Worksheets=b.length,d.SheetNames=[];for(var C=0;C!=b.length;++C)d.SheetNames[C]=b[C].name;var S=s?"bin":"xml",E=a.workbooks[0].lastIndexOf("/"),k=(a.workbooks[0].slice(0,E+1)+"_rels/"+a.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Ar(e,k)||(k="xl/_rels/workbook."+S+".rels");var x=Sa(Dr(e,k,!0),k.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Kd(Or(e,_f(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=function(e,t){var n=[],r=!1;return e.replace(Hr,(function(e){var i=zr(e);switch(Ur(i[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":n.push({name:i.displayname,id:i.id});break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return e})),n}(Or(e,_f(a.people[0])),t)),x&&(x=function(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(n=e["!id"][t.id].Type,ba.WS.indexOf(n)>-1?"sheet":ba.CS&&n==ba.CS?"chart":ba.DS&&n==ba.DS?"dialog":ba.MS&&n==ba.MS?"macro":n&&n.length?n:"sheet")];var n}))}catch(O){return null}return e&&0!==e.length?e:null}(x,c.Sheets));var T=Or(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=d.Worksheets;++y){var R="sheet";if(x&&x[y]?(g="xl/"+x[y][1].replace(/[\/]?xl\//,""),Ar(e,g)||(g=x[y][1]),Ar(e,g)||(g=k.replace(/_rels\/.*$/,"")+x[y][1]),R=x[y][2]):g=(g="xl/worksheets/sheet"+(y+1-T)+"."+S).replace(/sheet0\./,"sheet."),m=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(d.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,_=0;_!=t.sheets.length;++_)"number"==typeof t.sheets[_]&&t.sheets[_]==y&&(A=1),"string"==typeof t.sheets[_]&&t.sheets[_].toLowerCase()==d.SheetNames[y].toLowerCase()&&(A=1);if(!A)continue e}}Af(e,g,m,d.SheetNames[y],y,w,r,R,t,c,l,u)}return p={Directory:a,Workbook:c,Props:d,Custprops:f,Deps:v,Sheets:r,SheetNames:d.SheetNames,Strings:Pc,Styles:u,Themes:l,SSF:br(pn)},t&&t.bookFiles&&(e.files?(p.keys=o,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach((function(t,n){t=t.replace(/^Root Entry[\/]/,""),p.keys.push(t),p.files[t]=e.FileIndex[n]})))),t&&t.bookVBA&&(a.vba.length>0?p.vbaraw=Or(e,_f(a.vba[0]),!0):a.defaults&&a.defaults.bin===Mu&&(p.vbaraw=Or(e,"xl/vbaProject.bin",!0))),p}function Df(e,t){var n=t||{},r="Workbook",i=er.find(e,r);try{if(r="/!DataSpaces/Version",!(i=er.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=kl(e,4),t.U=kl(e,4),t.W=kl(e,4)}(i.content),r="/!DataSpaces/DataSpaceMap",!(i=er.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(xl(e));return t}(i.content);if(1!==o.length||1!==o[0].comps.length||0!==o[0].comps[0].t||"StrongEncryptionDataSpace"!==o[0].name||"EncryptedPackage"!==o[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(i=er.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var a=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(i.content);if(1!=a.length||"StrongEncryptionTransform"!=a[0])throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(i=er.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);Tl(i.content)}catch(l){}if(r="/EncryptionInfo",!(i=er.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=function(e){var t=kl(e);switch(t.Minor){case 2:return[t.Minor,_l(e)];case 3:return[t.Minor,Ol()];case 4:return[t.Minor,Dl(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(i.content);if(r="/EncryptedPackage",!(i=er.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(4==s[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(s[1],i.content,n.password||"",n);if(2==s[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(s[1],i.content,n.password||"",n);throw new Error("File is password-protected")}function Nf(e,t){return"ods"==t.bookType?Qh(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=So(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Eo(r)));var o=zf(n,{range:r,header:1}),a=["~Sh33tJ5~"];o.forEach((function(e){return e.forEach((function(e){"string"==typeof e&&a.push(e)}))}));var s={},l=[],u=er.read(t.numbers,{type:"base64"});u.FileIndex.map((function(e,t){return[e,u.FullPaths[t]]})).forEach((function(e){var t=e[0],n=e[1];2==t.type&&t.name.match(/\.iwa/)&&uf(hf(t.content)).forEach((function(e){l.push(e.id),s[e.id]={deps:[],location:n,type:of(e.messages[0].meta[1][0].data)}}))})),l.sort((function(e,t){return e-t}));var c=l.filter((function(e){return e>1})).map((function(e){return[e,rf(e)]}));u.FileIndex.map((function(e,t){return[e,u.FullPaths[t]]})).forEach((function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&uf(hf(t.content)).forEach((function(e){e.messages.forEach((function(t){c.forEach((function(t){e.messages.some((function(e){return 11006!=of(e.meta[1][0].data)&&function(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])}))&&s[t[0]].deps.push(e.id)}))}))}))}));for(var d,h=er.find(u,s[1].location),f=uf(hf(h.content)),p=0;p<f.length;++p){var v=f[p];1==v.id&&(d=v)}var g=yf(af(d.messages[0].data)[1][0].data);for(f=uf(hf((h=er.find(u,s[g].location)).content)),p=0;p<f.length;++p)(v=f[p]).id==g&&(d=v);for(g=yf(af(d.messages[0].data)[2][0].data),f=uf(hf((h=er.find(u,s[g].location)).content)),p=0;p<f.length;++p)(v=f[p]).id==g&&(d=v);for(g=yf(af(d.messages[0].data)[2][0].data),f=uf(hf((h=er.find(u,s[g].location)).content)),p=0;p<f.length;++p)(v=f[p]).id==g&&(d=v);var m=af(d.messages[0].data);m[6][0].data=rf(r.e.r+1),m[7][0].data=rf(r.e.c+1);for(var y=yf(m[46][0].data),w=er.find(u,s[y].location),b=uf(hf(w.content)),C=0;C<b.length&&b[C].id!=y;++C);if(b[C].id!=y)throw"Bad ColumnRowUIDMapArchive";var S=af(b[C].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var E=0;E<=r.e.c;++E){var k=[];k[1]=k[2]=[{type:0,data:rf(E+420690)}],S[1].push({type:2,data:sf(k)}),S[2].push({type:0,data:rf(E)}),S[3].push({type:0,data:rf(E)})}S[4]=[],S[5]=[],S[6]=[];for(var x=0;x<=r.e.r;++x)(k=[])[1]=k[2]=[{type:0,data:rf(x+726270)}],S[4].push({type:2,data:sf(k)}),S[5].push({type:0,data:rf(x)}),S[6].push({type:0,data:rf(x)});b[C].messages[0].data=sf(S),w.content=ff(cf(b)),w.size=w.content.length,delete m[46];var T=af(m[4][0].data);T[7][0].data=rf(r.e.r+1);var R=yf(af(T[1][0].data)[2][0].data);if((b=uf(hf((w=er.find(u,s[R].location)).content)))[0].id!=R)throw"Bad HeaderStorageBucket";var A=af(b[0].messages[0].data);for(x=0;x<o.length;++x){var _=af(A[2][0].data);_[1][0].data=rf(x),_[4][0].data=rf(o[x].length),A[2][x]={type:A[2][0].type,data:sf(_)}}b[0].messages[0].data=sf(A),w.content=ff(cf(b)),w.size=w.content.length;var O=yf(T[2][0].data);if((b=uf(hf((w=er.find(u,s[O].location)).content)))[0].id!=O)throw"Bad HeaderStorageBucket";for(A=af(b[0].messages[0].data),E=0;E<=r.e.c;++E)(_=af(A[2][0].data))[1][0].data=rf(E),_[4][0].data=rf(r.e.r+1),A[2][E]={type:A[2][0].type,data:sf(_)};b[0].messages[0].data=sf(A),w.content=ff(cf(b)),w.size=w.content.length;var D=yf(T[4][0].data);!function(){for(var e,t=er.find(u,s[D].location),n=uf(hf(t.content)),r=0;r<n.length;++r){var i=n[r];i.id==D&&(e=i)}var o=af(e.messages[0].data);o[3]=[];var l=[];a.forEach((function(e,t){l[1]=[{type:0,data:rf(t)}],l[2]=[{type:0,data:rf(1)}],l[3]=[{type:2,data:$h(e)}],o[3].push({type:2,data:sf(l)})})),e.messages[0].data=sf(o);var c=ff(cf(n));t.content=c,t.size=t.content.length}();var N=af(T[3][0].data),P=N[1][0];delete N[2];var F=af(P.data),I=yf(F[2][0].data);!function(){for(var e,t=er.find(u,s[I].location),n=uf(hf(t.content)),i=0;i<n.length;++i){var l=n[i];l.id==I&&(e=l)}var c=af(e.messages[0].data);delete c[6],delete N[7];var d=new Uint8Array(c[5][0].data);c[5]=[];for(var h=0,f=0;f<=r.e.r;++f){var p=af(d);h+=kf(p,o[f],a),p[1][0].data=rf(f),c[5].push({data:sf(p),type:2})}c[1]=[{type:0,data:rf(r.e.c+1)}],c[2]=[{type:0,data:rf(r.e.r+1)}],c[3]=[{type:0,data:rf(h)}],c[4]=[{type:0,data:rf(r.e.r+1)}],e.messages[0].data=sf(c);var v=ff(cf(n));t.content=v,t.size=t.content.length}(),P.data=sf(F),T[3][0].data=sf(N),m[4][0].data=sf(T),d.messages[0].data=sf(m);var L=ff(cf(f));return h.content=L,h.size=h.content.length,u}(e,t):"xlsb"==t.bookType?function(e,t){Ou=1024,e&&!e.SSF&&(e.SSF=br(pn));e&&e.SSF&&(Yn(),Xn(e.SSF),t.revssf=sr(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ic?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",r=Gu.indexOf(t.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Rf(t=t||{});var o=Ir(),a="",s=0;t.cellXfs=[],Bc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(a="docProps/core.xml",Fr(o,a,Na(e.Props,t)),i.coreprops.push(a),ka(t.rels,2,a,ba.CORE_PROPS),a="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],u=0;u<e.SheetNames.length;++u)2!=(e.Workbook.Sheets[u]||{}).Hidden&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Fr(o,a,La(e.Props)),i.extprops.push(a),ka(t.rels,3,a,ba.EXT_PROPS),e.Custprops!==e.Props&&ir(e.Custprops||{}).length>0&&(Fr(o,a="docProps/custom.xml",Ga(e.Custprops)),i.custprops.push(a),ka(t.rels,4,a,ba.CUST_PROPS));for(s=1;s<=e.SheetNames.length;++s){var c={"!id":{}},d=e.Sheets[e.SheetNames[s-1]];(d||{})["!type"];if(Fr(o,a="xl/worksheets/sheet"+s+"."+n,qd(s-1,a,t,e,c)),i.sheets.push(a),ka(t.wbrels,-1,"worksheets/sheet"+s+"."+n,ba.WS[0]),d){var h=d["!comments"],f=!1,p="";h&&h.length>0&&(Fr(o,p="xl/comments"+s+"."+n,Xd(h,p,t)),i.comments.push(p),ka(c,-1,"../comments"+s+"."+n,ba.CMNT),f=!0),d["!legacy"]&&f&&Fr(o,"xl/drawings/vmlDrawing"+s+".vml",Du(s,d["!comments"])),delete d["!comments"],delete d["!legacy"]}c["!id"].rId1&&Fr(o,Ca(a),Ea(c))}null!=t.Strings&&t.Strings.length>0&&(Fr(o,a="xl/sharedStrings."+n,function(e,t,n){return(".bin"===t.slice(-4)?Sl:bl)(e,n)}(t.Strings,a,t)),i.strs.push(a),ka(t.wbrels,-1,"sharedStrings."+n,ba.SST));a="xl/workbook."+n,Fr(o,a,function(e,t,n){return(".bin"===t.slice(-4)?Md:Pd)(e,n)}(e,a,t)),i.workbooks.push(a),ka(t.rels,1,a,ba.WB),a="xl/theme/theme1.xml",Fr(o,a,xu(e.Themes,t)),i.themes.push(a),ka(t.wbrels,-1,"theme/theme1.xml",ba.THEME),a="xl/styles."+n,Fr(o,a,function(e,t,n){return(".bin"===t.slice(-4)?vu:nu)(e,n)}(e,a,t)),i.styles.push(a),ka(t.wbrels,-1,"styles."+n,ba.STY),e.vbaraw&&r&&(Fr(o,a="xl/vbaProject.bin",e.vbaraw),i.vba.push(a),ka(t.wbrels,-1,"vbaProject.bin",ba.VBA));return a="xl/metadata."+n,Fr(o,a,function(e){return(".bin"===e.slice(-4)?Au:_u)()}(a)),i.metadata.push(a),ka(t.wbrels,-1,"metadata."+n,ba.XLMETA),Fr(o,"[Content_Types].xml",wa(i,t)),Fr(o,"_rels/.rels",Ea(t.rels)),Fr(o,"xl/_rels/workbook."+n+".rels",Ea(t.wbrels)),delete t.revssf,delete t.ssf,o}(e,t):Pf(e,t)}function Pf(e,t){Ou=1024,e&&!e.SSF&&(e.SSF=br(pn)),e&&e.SSF&&(Yn(),Xn(e.SSF),t.revssf=sr(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ic?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=Gu.indexOf(t.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Rf(t=t||{});var o=Ir(),a="",s=0;if(t.cellXfs=[],Bc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Fr(o,a="docProps/core.xml",Na(e.Props,t)),i.coreprops.push(a),ka(t.rels,2,a,ba.CORE_PROPS),a="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],u=0;u<e.SheetNames.length;++u)2!=(e.Workbook.Sheets[u]||{}).Hidden&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Fr(o,a,La(e.Props)),i.extprops.push(a),ka(t.rels,3,a,ba.EXT_PROPS),e.Custprops!==e.Props&&ir(e.Custprops||{}).length>0&&(Fr(o,a="docProps/custom.xml",Ga(e.Custprops)),i.custprops.push(a),ka(t.rels,4,a,ba.CUST_PROPS));var c=["SheetJ5"];for(t.tcid=0,s=1;s<=e.SheetNames.length;++s){var d={"!id":{}},h=e.Sheets[e.SheetNames[s-1]];(h||{})["!type"];if(Fr(o,a="xl/worksheets/sheet"+s+"."+n,od(s-1,t,e,d)),i.sheets.push(a),ka(t.wbrels,-1,"worksheets/sheet"+s+"."+n,ba.WS[0]),h){var f=h["!comments"],p=!1,v="";if(f&&f.length>0){var g=!1;f.forEach((function(e){e[1].forEach((function(e){1==e.T&&(g=!0)}))})),g&&(Fr(o,v="xl/threadedComments/threadedComment"+s+"."+n,Fu(f,c,t)),i.threadedcomments.push(v),ka(d,-1,"../threadedComments/threadedComment"+s+"."+n,ba.TCMNT)),Fr(o,v="xl/comments"+s+"."+n,Pu(f)),i.comments.push(v),ka(d,-1,"../comments"+s+"."+n,ba.CMNT),p=!0}h["!legacy"]&&p&&Fr(o,"xl/drawings/vmlDrawing"+s+".vml",Du(s,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Fr(o,Ca(a),Ea(d))}return null!=t.Strings&&t.Strings.length>0&&(Fr(o,a="xl/sharedStrings."+n,bl(t.Strings,t)),i.strs.push(a),ka(t.wbrels,-1,"sharedStrings."+n,ba.SST)),Fr(o,a="xl/workbook."+n,Pd(e)),i.workbooks.push(a),ka(t.rels,1,a,ba.WB),Fr(o,a="xl/theme/theme1.xml",xu(e.Themes,t)),i.themes.push(a),ka(t.wbrels,-1,"theme/theme1.xml",ba.THEME),Fr(o,a="xl/styles."+n,nu(e,t)),i.styles.push(a),ka(t.wbrels,-1,"styles."+n,ba.STY),e.vbaraw&&r&&(Fr(o,a="xl/vbaProject.bin",e.vbaraw),i.vba.push(a),ka(t.wbrels,-1,"vbaProject.bin",ba.VBA)),Fr(o,a="xl/metadata."+n,_u()),i.metadata.push(a),ka(t.wbrels,-1,"metadata."+n,ba.XLMETA),c.length>1&&(Fr(o,a="xl/persons/person.xml",function(e){var t=[Gr,yi("personList",null,{xmlns:Si.TCMNT,"xmlns:x":Ei[0]}).replace(/[\/]>/,">")];return e.forEach((function(e,n){t.push(yi("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))})),t.push("</personList>"),t.join("")}(c)),i.people.push(a),ka(t.wbrels,-1,"persons/person.xml",ba.PEOPLE)),Fr(o,"[Content_Types].xml",wa(i,t)),Fr(o,"_rels/.rels",Ea(t.rels)),Fr(o,"xl/_rels/workbook.xml.rels",Ea(t.wbrels)),delete t.revssf,delete t.ssf,o}function Ff(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Kt(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function If(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return ah(e.slice(n),t);default:break e}return ll.to_workbook(e,t)}function Lf(e,t,n,r){return r?(n.type="string",ll.to_workbook(e,n)):ll.to_workbook(t,n)}function Mf(e,t){Lt();var n=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return Mf(new Uint8Array(e),((n=br(n)).type="array",n));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!n.type&&(n.type="undefined"!==typeof Deno?"buffer":"array");var r,i=e,o=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),Fc={},n.dateNF&&(Fc.dateNF=n.dateNF),n.type||(n.type=qt&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==n.type&&(n.type=qt?"buffer":"binary",i=function(e){if("undefined"!==typeof tr)return tr.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||qt||(n.type="array")),"string"==n.type&&(o=!0,n.type="binary",n.codepage=65001,i=function(e){return e.match(/[^\x00-\x7F]/)?li(e):e}(e)),"array"==n.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var a=new ArrayBuffer(3),s=new Uint8Array(a);if(s.foo="bar",!s.foo)return(n=br(n)).type="array",Mf(en(i),n)}switch((r=Ff(i,n))[0]){case 208:if(207===r[1]&&17===r[2]&&224===r[3]&&161===r[4]&&177===r[5]&&26===r[6]&&225===r[7])return function(e,t){return er.find(e,"EncryptedPackage")?Df(e,t):bh(e,t)}(er.read(i,n),n);break;case 9:if(r[1]<=8)return bh(i,n);break;case 60:return ah(i,n);case 73:if(73===r[1]&&42===r[2]&&0===r[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===r[1])return function(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var i=ol.to_workbook(e,n);return n.WTF=r,i}catch(o){if(n.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return ll.to_workbook(e,t)}}(i,n);break;case 84:if(65===r[1]&&66===r[2]&&76===r[3])return al.to_workbook(i,n);break;case 80:return 75===r[1]&&r[2]<9&&r[3]<9?function(e,t){var n=e,r=t||{};return r.type||(r.type=qt&&Buffer.isBuffer(e)?"buffer":"base64"),Of(Lr(n,r),r)}(i,n):Lf(e,i,n,o);case 239:return 60===r[3]?ah(i,n):Lf(e,i,n,o);case 255:if(254===r[1])return function(e,t){var n=e;return"base64"==t.type&&(n=Kt(n)),n=Bt.utils.decode(1200,n.slice(2),"str"),t.type="binary",If(n,t)}(i,n);if(0===r[1]&&2===r[2]&&0===r[3])return ul.to_workbook(i,n);break;case 0:if(0===r[1]){if(r[2]>=2&&0===r[3])return ul.to_workbook(i,n);if(0===r[2]&&(8===r[3]||9===r[3]))return ul.to_workbook(i,n)}break;case 3:case 131:case 139:case 140:return il.to_workbook(i,n);case 123:if(92===r[1]&&114===r[2]&&116===r[3])return Ll.to_workbook(i,n);break;case 10:case 13:case 32:return function(e,t){var n="",r=Ff(e,t);switch(t.type){case"base64":n=Kt(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=wr(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]&&(n=si(n)),t.type="binary",If(n,t)}(i,n);case 137:if(80===r[1]&&78===r[2]&&71===r[3])throw new Error("PNG Image File is not a spreadsheet")}return rl.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?il.to_workbook(i,n):Lf(e,i,n,o)}function Gf(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return rr(t.file,er.write(e,{type:qt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return er.write(e,t)}function Bf(e,t){var n={},r=qt?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?er.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if("undefined"!==typeof Deno&&"string"==typeof i){if("binary"==t.type||"base64"==t.type)return i;i=new Uint8Array(Jt(i))}return t.password&&"undefined"!==typeof encrypt_agile?Gf(encrypt_agile(i,t.password),t):"file"===t.type?rr(t.file,i):"string"==t.type?si(i):i}function jf(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return Ut(li(r));case"binary":return li(r);case"string":return e;case"file":return rr(t.file,r,"utf8");case"buffer":return qt?Xt(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):jf(r,{type:"binary"}).split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}function Hf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?Ut(n):"string"==t.type?si(n):n;case"file":return rr(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Vf(e,t){Lt(),Dd(e);var n=br(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var r=Vf(e,n);return n.type="array",Jt(r)}var i=0;if(n.sheet&&(i="number"==typeof n.sheet?n.sheet:e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return jf(hh(e,n),n);case"slk":case"sylk":return jf(ol.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return jf(Bh(e.Sheets[e.SheetNames[i]],n),n);case"txt":return function(e,t){switch(t.type){case"base64":return Ut(e);case"binary":case"string":return e;case"file":return rr(t.file,e,"binary");case"buffer":return qt?Xt(e,"binary"):e.split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}(Xf(e.Sheets[e.SheetNames[i]],n),n);case"csv":return jf(qf(e.Sheets[e.SheetNames[i]],n),n,"\ufeff");case"dif":return jf(al.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return Hf(il.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return jf(ll.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return jf(Ll.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return jf(sl.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return jf(Qh(e,n),n);case"wk1":return Hf(ul.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return Hf(ul.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),Hf(Ph(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),function(e,t){var n=t||{};return Gf(Ch(e,n),n)}(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var n=br(t||{});return Bf(Nf(e,n),n)}(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function Wf(e,t,n,r,i,o,a,s){var l=mo(n),u=s.defval,c=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),d=!0,h=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch(g){h.__rowNum__=n}else h.__rowNum__=n;if(!a||e[n])for(var f=t.s.c;f<=t.e.c;++f){var p=a?e[n][f]:e[r[f]+l];if(void 0!==p&&void 0!==p.t){var v=p.v;switch(p.t){case"z":if(null==v)break;continue;case"e":v=0==v?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=o[f]){if(null==v)if("e"==p.t&&null===v)h[o[f]]=null;else if(void 0!==u)h[o[f]]=u;else{if(!c||null!==v)continue;h[o[f]]=null}else h[o[f]]=c&&("n"!==p.t||"n"===p.t&&!1!==s.rawNumbers)?v:To(p,v,s);null!=v&&(d=!1)}}else{if(void 0===u)continue;null!=o[f]&&(h[o[f]]=u)}}return{row:h,isempty:d}}function zf(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,i=1,o=[],a=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},c=null!=u.range?u.range:e["!ref"];switch(1===u.header?r=1:"A"===u.header?r=2:Array.isArray(u.header)?r=3:null==u.header&&(r=0),typeof c){case"string":l=ko(c);break;case"number":(l=ko(e["!ref"])).s.r=c;break;default:l=c}r>0&&(i=0);var d=mo(l.s.r),h=[],f=[],p=0,v=0,g=Array.isArray(e),m=l.s.r,y=0,w={};g&&!e[m]&&(e[m]=[]);var b=u.skipHidden&&e["!cols"]||[],C=u.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(b[y]||{}).hidden)switch(h[y]=wo(y),n=g?e[m][y]:e[h[y]+d],r){case 1:o[y]=y-l.s.c;break;case 2:o[y]=h[y];break;case 3:o[y]=u.header[y-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),s=a=To(n,null,u),v=w[a]||0){do{s=a+"_"+v++}while(w[s]);w[a]=v,w[s]=1}else w[a]=1;o[y]=s}for(m=l.s.r+i;m<=l.e.r;++m)if(!(C[m]||{}).hidden){var S=Wf(e,l,m,h,r,o,g,u);(!1===S.isempty||(1===r?!1!==u.blankrows:u.blankrows))&&(f[p++]=S.row)}return f.length=p,f}var Uf=/"/g;function Kf(e,t,n,r,i,o,a,s){for(var l=!0,u=[],c="",d=mo(n),h=t.s.c;h<=t.e.c;++h)if(r[h]){var f=s.dense?(e[n]||[])[h]:e[r[h]+d];if(null==f)c="";else if(null!=f.v){l=!1,c=""+(s.rawNumbers&&"n"==f.t?f.v:To(f,null,s));for(var p=0,v=0;p!==c.length;++p)if((v=c.charCodeAt(p))===i||v===o||34===v||s.forceQuotes){c='"'+c.replace(Uf,'""')+'"';break}"ID"==c&&(c='"ID"')}else null==f.f||f.F?c="":(l=!1,(c="="+f.f).indexOf(",")>=0&&(c='"'+c.replace(Uf,'""')+'"'));u.push(c)}return!1===s.blankrows&&l?null:u.join(a)}function qf(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var i=ko(e["!ref"]),o=void 0!==r.FS?r.FS:",",a=o.charCodeAt(0),s=void 0!==r.RS?r.RS:"\n",l=s.charCodeAt(0),u=new RegExp(("|"==o?"\\|":o)+"+$"),c="",d=[];r.dense=Array.isArray(e);for(var h=r.skipHidden&&e["!cols"]||[],f=r.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(h[p]||{}).hidden||(d[p]=wo(p));for(var v=0,g=i.s.r;g<=i.e.r;++g)(f[g]||{}).hidden||null!=(c=Kf(e,i,g,d,a,l,o,r))&&(r.strip&&(c=c.replace(u,"")),(c||!1!==r.blankrows)&&n.push((v++?s:"")+c));return delete r.dense,n.join("")}function Xf(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=qf(e,t);if("undefined"==typeof Bt||"string"==t.type)return n;var r=Bt.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function Yf(e,t,n){var r,i=n||{},o=+!i.skipHeader,a=e||{},s=0,l=0;if(a&&null!=i.origin)if("number"==typeof i.origin)s=i.origin;else{var u="string"==typeof i.origin?bo(i.origin):i.origin;s=u.r,l=u.c}var c={s:{c:0,r:0},e:{c:l,r:s+t.length-1+o}};if(a["!ref"]){var d=ko(a["!ref"]);c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==s&&(s=d.e.r+1,c.e.r=s+t.length-1+o)}else-1==s&&(s=0,c.e.r=t.length-1+o);var h=i.header||[],f=0;t.forEach((function(e,t){ir(e).forEach((function(n){-1==(f=h.indexOf(n))&&(h[f=h.length]=n);var u=e[n],c="z",d="",p=Co({c:l+f,r:s+t+o});r=Qf(a,p),!u||"object"!==typeof u||u instanceof Date?("number"==typeof u?c="n":"boolean"==typeof u?c="b":"string"==typeof u?c="s":u instanceof Date?(c="d",i.cellDates||(c="n",u=ur(u)),d=i.dateNF||pn[14]):null===u&&i.nullError&&(c="e",u=0),r?(r.t=c,r.v=u,delete r.w,delete r.R,d&&(r.z=d)):a[p]=r={t:c,v:u},d&&(r.z=d)):a[p]=u}))})),c.e.c=Math.max(c.e.c,l+h.length-1);var p=mo(s);if(o)for(f=0;f<h.length;++f)a[wo(f+l)+p]={t:"s",v:h[f]};return a["!ref"]=Eo(c),a}function Qf(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=bo(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return Qf(e,Co("number"!=typeof t?t:{r:t,c:n||0}))}function Zf(){return{SheetNames:[],Sheets:{}}}function Jf(e,t,n,r){var i=1;if(!n)for(;i<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+i);++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var o=n.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var a=o&&o[1]||n;for(++i;i<=65535&&-1!=e.SheetNames.indexOf(n=a+i);++i);}if(Od(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function $f(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var ep={encode_col:wo,encode_row:mo,encode_cell:Co,encode_range:Eo,decode_col:yo,decode_row:go,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:bo,decode_range:So,format_cell:To,sheet_add_aoa:Ao,sheet_add_json:Yf,sheet_add_dom:jh,aoa_to_sheet:_o,json_to_sheet:function(e,t){return Yf(null,e,t)},table_to_sheet:Hh,table_to_book:function(e,t){return Ro(Hh(e,t),t)},sheet_to_csv:qf,sheet_to_txt:Xf,sheet_to_json:zf,sheet_to_html:Bh,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var i,o=ko(e["!ref"]),a="",s=[],l=[],u=Array.isArray(e);for(i=o.s.c;i<=o.e.c;++i)s[i]=wo(i);for(var c=o.s.r;c<=o.e.r;++c)for(a=mo(c),i=o.s.c;i<=o.e.c;++i)if(n=s[i]+a,r="",void 0!==(t=u?(e[c]||[])[i]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:zf,sheet_get_cell:Qf,book_new:Zf,book_append_sheet:Jf,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:$f,cell_set_internal_link:function(e,t,n){return $f(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var i="string"!=typeof t?t:ko(t),o="string"==typeof t?t:Eo(t),a=i.s.r;a<=i.e.r;++a)for(var s=i.s.c;s<=i.e.c;++s){var l=Qf(e,a,s);l.t="n",l.F=o,delete l.v,a==i.s.r&&s==i.s.c&&(l.f=n,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};_t.version;var tp=function(e,t){var n=t[0].reduce((function(e,t){return Math.min(e,t)})),r=[];return e.forEach((function(i,o){var a={},s=bt(t[o],n);a.name=e[o],a.posShiftSort=s,a.rawSort=t[o],a.displaySort=t[o].toString(),r.push(a)})),r};var np=n(8042),rp=n.n(np),ip=function(e){return rp().apply(void 0,wt(e))},op=function(e,t,n){var r=function(e){return e.map((function(e){return e.filter((function(e){return""!==e}))}))}(e),i=function(e){return e.filter((function(e){return e.length>0}))}(r);i.shift();var o,a,s=ip(i),l=s.shift(),u=[],c=[],d=[],h=[];s.forEach((function(e,r){var i=[];e.forEach((function(e,s){var h={};a=parseInt(l[s],10),isNaN(a)&&d.push(n[r]),h.sortValue=a,o=parseInt(e,10),h.statementNum=o,i.push(h),o>+t&&u.push(n[r]),o<1&&c.push(n[r]),isNaN(o)&&d.push(n[r])})),h.push(i)}));var f=[];return h.forEach((function(e){var t=[];e.sort((function(e,t){return e.statementNum-t.statementNum})),e.forEach((function(e){t.push(e.sortValue)})),f.push(t)})),u=mt()(u),c=mt()(c),d=mt()(d),{participantSorts:f,overRangeSorts:u,underRangeSorts:c,nonNumericSorts:d}},ap=function(e){var t=[];return e[0].forEach((function(e){if("undefined"!==typeof e.Statements){var n=e.Statements.trim();t.push(n)}})),t},sp=function(e){var t=[];return[-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13].forEach((function(n,r){for(var i=0;i<e[r];i++)t.push(n)})),t},lp=function(e){for(var t=[],n=0;n<e;n++)t.push(n+1);return t},up=function(e){return e.toString()},cp=function(e,t){return e.map((function(e,n){return e+": "+t[n]}))},dp=function(e){var t=e.split(",").filter((function(e){return e})).map((function(e){return parseInt(e,10)}));if(20!==t.length)throw y.setState({showWarningBox:!0}),alert("There are missing values in the Q sort pattern Check your Excel file, reload the webpage, and try again."),new Error("Multiplier Array must contain 20 values");return t},hp=function(e){return e.reduce((function(e,t){return e+t}),0)},fp=function(e,t,n){var r=Math.max.apply(Math,wt(e)),i=Math.min.apply(Math,wt(e)),o=[],a=[],s=[],l=wt(e);if(t.forEach((function(e,t){wt(e).length!==l.length&&s.push(n[t]),e.forEach((function(e){+e>r&&o.push(n[t]),+e<i&&a.push(e)}))})),o=mt()(o),a=mt()(a),s=mt()(s),o.length>0)throw y.setState({showWarningBox:!0}),alert("There are Q sorts with a value higher than the maximum allowed sort value! [ ".concat(o.join()," ] Check your Excel file, reload the webpage, and try again.")),new Error("There are Q sorts with a value higher than the maximum allowed sort value! [ ".concat(o.join()," ] Check your Excel file, reload the webpage, and try again."));if(a.length>0)throw y.setState({showWarningBox:!0}),alert("There are Q sorts with a value lower than the minimum allowed sort value! [ ".concat(a.join()," ] Check your Excel file, reload the webpage, and try again.")),new Error("There are Q sorts with a value lower than the minimum allowed sort value! [ ".concat(a.join()," ] Check your Excel file, reload the webpage, and try again."));if(s.length>0)throw y.setState({showWarningBox:!0}),alert("There are problems with Q sort values in the participant sorts! [ ".concat(s.join()," ] Check your Excel file, reload the webpage, and try again.")),new Error("There are problems with Q sort values in the participant sorts! [ ".concat(s.join()," ] Check your Excel file, reload the webpage, and try again."))},pp=function(e){var t=e.overRangeSorts,n=e.underRangeSorts,r=e.nonNumericSorts;if(t.length>0)throw y.setState({showWarningBox:!0}),alert("There are Q sorts with a value higher than the maximum allowed sort value! [ ".concat(t.join()," ] Check your Excel file, reload the webpage, and try again.")),new Error("There are Q sorts with a value higher than the maximum allowed sort value! [ ".concat(t.join()," ] Check your Excel file, reload the webpage, and try again."));if(n.length>0)throw y.setState({showWarningBox:!0}),alert("There are Q sorts with a value lower than the minimum allowed sort value! [ ".concat(n.join()," ] Check your Excel file, reload the webpage, and try again.")),new Error("There are Q sorts with a value lower than the minimum allowed sort value! [ ".concat(n.join()," ] Check your Excel file, reload the webpage, and try again."));if(r.length>0)throw y.setState({showWarningBox:!0}),alert("There are problems with Q sort values in the participant sorts! [ ".concat(r.join()," ] Check your Excel file, reload the webpage, and try again.")),new Error("There are problems with Q sort values in the participant sorts! [ ".concat(r.join()," ] Check your Excel file, reload the webpage, and try again."))},vp=function(e){var t={};try{var n=e.projectName,r=vt()(e.multiplierArray),i=dp(r),o=Math.max.apply(Math,wt(i));if(isNaN(o))throw new Error("Multiplier Array contains non-numeric values");var a=wt(i),s=hp(a),l=wt(e.sortsArray[0]).filter((function(e){return e}));l.shift();var u=yt(l),c=u.length,d=vt()(e.sortsArray),h=op(d,s,u),f=vt()(h.participantSorts);pp(h);var p=vt()(e.statementsArray),v=ap(p),g=sp(i);fp(g,f,u);var m=lp(s),y=up(u);t={projectHistoryArray:[n+" data loaded from Excel Type 1 file"],statements:v,sortsDisplayText:cp(u,f),projectName:n,numQsorts:c,numStatements:s,qSortPattern:g,mainDataObject:tp(u,f),multiplierArray:i,statementNumArray:m,respondentNames:u,excelType1NonsymmetricArrayText:y}}catch(w){console.log(w),console.log(w.message),console.log(w.stack)}return t};function gp(e){var t=vt()(e.sortsArray),r=e.statementsArray,i={};if(null!==e&&void 0!==e&&e.version)console.log("version 2 processing"),i=vp(e);else{console.log("version 1 processing"),t.shift();try{var o=t[0][1],a=t,s=function(e){for(var t=[],n=[],r=1;r<21;r++){var i=+e[r][1];if(i<1||isNaN(i))n.push(0);else{var o=+e[r][1];n.push(o);for(var a=+e[r][0],s=0,l=o;s<l;s++)t.push(a)}}return[n,t]}(a),l=wt(s[0]);if(0===l.length||0===Math.max.apply(Math,wt(l)))throw y.setState({showWarningBox:!0}),alert("Can't find Q sort pattern information in the Excel file."),new Error("Can't find the number of sorts for each column on the 'sorts' worksheet!");var u=wt(s[1]),c=u.length,d=function(e,t){for(var n=[],r=e[22].length-1,i=22;i<e.length;i++){for(var o,a,s=e[i][0],l=[],u=1,c=0;c<r;c++)o=e[i][u],22===i&&""!==o?((a={}).sortValue=s,a.statementNum=o,l.push(a)):""!==o&&((a={}).sortValue=+s,a.statementNum=+o,l.push(a)),u+=1;n.push(l)}return n}(a);if(0===d[1].length&&0===d[2].length)throw y.setState({showWarningBox:!0}),alert("Can't find any Q sorts on the 'sorts' worksheet! Check your Excel file, reload the webpage, and try again."),new Error("Can't find any Q sorts on the 'sorts' worksheet!");var h=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n].statementNum;""!==i&&t.push(i)}return t}(d.shift()),f=yt(h),p=h.length,v=function(e,t,r){for(var i=[],o=0;o<r;o++)i.push(o+1);var a=i.join(","),s=e[0].map((function(t,n){return e.map((function(e){return e[n]}))}));if(s.length!==t.length)throw y.setState({showWarningBox:!0}),alert("The number of participants in the Excel file does not match the number of Q sorts listed in the file. Please check your Excel file"),new Error("The number of participants in the Excel file does not match the number of participants in the Q sort pattern information!");s.forEach((function(e,n){var i=[],o=t[n];e.forEach((function(e,t){if(i.push(+e.statementNum),e.statementNum>r)throw y.setState({showWarningBox:!0}),alert("A statement number for particpant ".concat(o," is larger than the number of statements")),new Error("The statement number is larger than the number of statements!")}));var s=i.sort((function(e,t){return e-t})).join(",");if(s!==a)throw y.setState({showWarningBox:!0}),alert("There is a problem with the statement numbers for participant ".concat(o)),new Error("The sort values for participant "+o+" are not correct!")}));for(var l,u=n(4286),c=[],d=0;d<s.length;d++){var h=u(s[d],(function(e){return e.statementNum}));c.push(h)}for(var f=[],p=0;p<c.length;p++){for(var v=c[p],g=[],m=0;m<v.length;m++)l=v[m].sortValue,g.push(l);[].push(p+1),f.push(g)}return[f,i]}(d,h,c),g=wt(v[0]),m=wt(v[1]),w=v[2],b=function(e){for(var t=[],n=0,r=e[0].length;n<r;n++){var i=e[0][n].Statements;""===i||void 0===i||null===i||t.push(i.trim())}return t}(wt(r));if(0===b.length)throw y.setState({showWarningBox:!0}),alert("Can't find any statements on the statements worksheet! Check your Excel file, reload the webpage, and try again."),new Error("Can't find any statements on the 'statements' worksheet!");var C=h.map((function(e,t){return e+": "+g[t]}));i={projectHistoryArray:[o+" data loaded from Excel Type 1 file"],statements:b,sortsDisplayText:C,projectName:o,numQsorts:p,numStatements:c,qSortPattern:u,mainDataObject:tp(h,g),multiplierArray:l,statementNumArray:m,respondentNames:f,excelType1NonsymmetricArrayText:w}}catch(S){console.log(S.message),console.log(S.stack),y.setState({showInputErrorModal:{showModal:!0,titleText:"Data Error",bodyText:S.message}})}}return i}var mp=n(806),yp=n.n(mp),wp=function(){var e=At(Tt().mark((function e(t){var n,r;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e){t.forEach((function(t){var n,r,i,o,a,s,l,u=new FileReader,c=[],d=[],h=[],f={},p=!1,v=!1;u.onload=function(){var t=At(Tt().mark((function t(u){var g;return Tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=u.target.result,s=Mf(a,{type:"binary"}),s.SheetNames.forEach((function(e){var t=e.toLowerCase();if(l=s.Sheets[e],"name"!==t&&"names"!==t||(n=ep.sheet_to_csv(l,{blankrows:!1}),r=n.split(/\n/),i=r.filter(Boolean),f.projectName=i[1]),"pattern"!==t&&"patterns"!==t||(c.push("pattern"),n=ep.sheet_to_csv(l,{blankrows:!1}),r=n.split(/\n/),i=r.filter(Boolean),f.multiplierArray=i[1]),"minmax"===t&&(n=ep.sheet_to_csv(l,{blankrows:!1}),r=n.split(/\n/),i=r.filter(Boolean),f.minMax=i[1]),"version"===t&&(c.push("version"),n=ep.sheet_to_csv(l,{blankrows:!1}),r=n.split(/\n/),i=r.filter(Boolean),f.version=i[1]),"sorts"===t||"qsorts"===t||"q-sorts"===t){p=!0,n=ep.sheet_to_csv(l,{blankrows:!1}),r=n.split(/\n/);for(var a=0;a<200;a++)void 0!==r[a]&&(i=r[a].split(","),d.push(i));f.sortsArray=d}"statements"!==t&&"statement"!==t||(v=!0,[],o=ep.sheet_to_json(l),h.push(o),f.statementsArray=h)})),!1!==p){t.next=9;break}throw y.setState({showWarningBox:!0}),alert("Can't find the 'sorts' worksheet! Check your Excel file, reload the webpage, and try again."),new Error("Can't find the 'sorts' worksheet!");case 9:if(!1!==v){t.next=13;break}throw y.setState({showWarningBox:!0}),alert("Can't find the 'statements' worksheet! Check your Excel file, reload the webpage, and try again."),new Error("Can't find the 'statements' worksheet!");case 13:if(!yp()(c,"pattern")&&!yp()(c,"patterns")){t.next=18;break}if(!1!==yp()(c,"version")){t.next=18;break}throw y.setState({showWarningBox:!0}),alert("Can't find the 'version' worksheet tab! Check your Excel file, reload the webpage, and try again."),new Error("Can't find the 'version' worksheet tab!");case 18:g=gp(f),e(g),t.next=26;break;case 22:t.prev=22,t.t0=t.catch(0),console.log(t.t0.message),alert(t.t0.message);case 26:case"end":return t.stop()}}),t,null,[[0,22]])})));return function(e){return t.apply(this,arguments)}}(),u.onabort=function(){console.log("file reading was aborted")},u.onerror=function(){console.log("The file reader encountered an error")},u.readAsBinaryString(t)}))})),e.next=3,n;case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bp=wp;function Cp(t){var n=y(),i=n.isDataLoaded,o=n.setNumQsorts,a=n.setQSortPattern,s=n.setNumStatements,l=n.setRespondentNames,u=n.setMainDataObject,c=n.setSortsDisplayText,h=n.setMultiplierArray,f=n.setDataOrigin,p=n.setStatements,v=n.setProjectName,g=n.setProjectHistoryArray,m=n.setStatementNumArray,w=n.setExcelType1NonsymmetricArrayText,b=n.setHasImportedSorts,C=n.setHasImportedStatements,S=n.setIsDataLoaded,E=n.setShowInputErrorModal,k=(0,e.useCallback)(function(){var e=At(Tt().mark((function e(n){var r;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=3;break}return E({showModal:!0,titleText:"Data Loading Error",bodyText:"Data are already loaded.",bodyText2:"Reload the webpage to start a new project."}),e.abrupt("return");case 3:return e.prev=3,e.next=6,bp(n);case 6:r=e.sent,o(r.numQsorts),v(r.projectName),a(wt(r.qSortPattern)),s(r.numStatements),p(wt(r.statements)),l(wt(r.respondentNames)),u(wt(r.mainDataObject)),c(wt(r.sortsDisplayText)),h(wt(r.multiplierArray)),f("excel"),g(wt(r.projectHistoryArray)),m(wt(r.statementNumArray)),w(r.excelType1NonsymmetricArrayText),b(!0),C(!0),t.updateColor(),S(!0),e.next=31;break;case 26:e.prev=26,e.t0=e.catch(3),y.setState({showWarningBox:!0}),console.log(e.t0.message),alert("".concat(e.t0.message," \n        There is an unexpected Excel input error. Check your Excel file, reload the webpage, and try again"));case 31:case"end":return e.stop()}}),e,null,[[3,26]])})));return function(t){return e.apply(this,arguments)}}(),[i,S,E,o,v,a,s,p,l,u,c,h,f,g,m,w,b,C,t]),x=it({onDrop:k,multiple:!1}),T=x.getRootProps,R=x.getInputProps;return(0,r.jsxs)("div",d(d({className:"flex justify-center items-center pt-[20px]"},T()),{},{children:[(0,r.jsx)("input",d({className:""},R())),(0,r.jsx)("p",{children:"Drag and drop Excel file here, or click to select"})]}))}var Sp=function(){var t=Y((0,e.useState)("bg-gray-300 hover:bg-gray-400"),2),n=t[0],i=t[1];return(0,r.jsx)("div",{className:"w-[300px] mr-4",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center  items-center rounded-md bg-white h-[500px] w-[300px]",children:[(0,r.jsx)("h6",{className:"text-[22px] font-bold tracking-tight text-gray-900",children:"1. Load Excel Type 1 file"}),(0,r.jsx)("div",{className:"text-gray-900",children:" Q sort Data in Columns"}),(0,r.jsx)("a",{href:"https://docs.google.com/spreadsheets/d/1vsz-X9_EIo3bi4nxBTtQbEWB21qOxBLprWaluaNmvec/edit?usp=sharing",target:"_blank",rel:"noopener noreferrer",style:{targetNew:"tab",color:"firebrick",fontSize:18},children:"Click here to get a sample file"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"",children:(0,r.jsx)("img",{alt:"excel type 1",className:"w-[250px] h-[175px] m-4 border-2 border-black",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAasAAAE0CAMAAACl/+zJAAABaFBMVEX///+23egAAACZmZkKCgoAZrb//7YAADpmAAD//9vbkDqQ2/86AADb//86kNud3ei23cgAMoL/25CB3egAOpAAAF2QOgBmMgAAAGa2//8AWaYoAABJAACBWQCdfTS2ZgAofci2voK23aa22//btmb/tmZmtv9mttsAADRnAQE6OgC2ZjpJnei2nV3/27a2vqZmOgAAOmaQttzbtpCBvui2kDpmvuhmWTQ6OmadnV1JMgBmMwE6ZpBJfcgAMl2QZrZJfaZmtpC2ZwGQtv9JnchmADoofaZtbXO13ei2kGZmOjoAOjo6kLY6ZraBfTQoWYKBfXJmncgoWaaQZjqBWTQAMjSd3aadfV0oMl22vsidvsiMuLudvoLb2/+Q29vb27ZmtrZmkLY6Zo8zfYI6Zma2ZzsoWTQoMgDa/v+12/+P2v5mtf6AvegAWaU6OpAoWYGQtma1/v7+/rZmnaadnYKcnV22kDtmWQBZayqwAAAQP0lEQVR42uyczWvbQBDFo2nvlinBYNnByUkHC0MxDXawySGEnNIk5LPtLdBeEnop9N/v7FeeU9luS7WJF95ApF15tIf3Q6Nd6UVbb99kGx6yFSNSHJWs0hmVrNIZlazSGZWs0hmVrNIZdT2rvri4Hf+n4Duy/W7FT/nk9h1ZNcdKyg/Ns8JPZNUkK+mS1auP+idW7ZbuRh27H+2LlIfmQL5fiMz1WtvryfFpIfNzW80u9ej3sTvvy1TkwuTuTvWkUwMEAyAh74iIjk5WTbGamv1uIV7XvBMKo7JyMbTcQrns42qsfFNZYQAkkFXzNXBgALUfjN4Ds5llo550LZ8jbaramlyePzXluDXqKSA9a3ucTQrXbI/dAAsJrIENs/KX1dDcXrS9G6qeYdXVXaVXkzYHvpn1jf6WgkNjDywMEBLIqnFW889ZpqxQzS51V168zzIHyHI0f77pa+cOANkmBrAJZNX4/SpXMN0WbjxhlqAx+CdWlZBVZFZma4A41RF3P1XklTUQrFADMQBZxWKVHxj9847MH9yMojITivxSRV4xtwCKvGPOnYhrzscm4ZGsIrGydQ1zdlXWYLPRrc3Z3e+LKKpCMGdfmsA5e5OsVFQZ+JvUx7H28zOV/eqwZe9XN4Uui7EWNicAhVsLH7u1MAZAgq6ryeolnrNbVrWDfM5OVumoSlbpqEpW6ai6kazqQVZbZJWSqmSVjqpklY6qZJWOqmSVjqpklY6qZJWOqq/Kqi8ybGzpC68ZWcVh1W6RVSqsZEBWybBSaT2rm0KknGXmnWN38s00J4WUR1kGu6YNpC6zd5JVPFbS9ax2BJZBF1/Du2HYNU0gdZm9k6xisWqfBv+LbmbZ3lS6ltXM8hmc6FYPwK5pA6mL9s4DZ+8kq2isrnvmz1G4O5uKsaNZn3vYKpFFu6YJpC6xd5JVNFatSuTespqEQmf5ZNjC7+kxIPU3yyDnFnFZ2buTc7NfHX7qLGNVyTNWIZWsXpqVKm9ZVSqyQ1NjZTEgkOpGYA18KVZ+leWcnBNZxirYNbVpAqmLrJw1dMJ5YFRWez3vYV91v3KXHigg9bm9k3P2yKy8p9MtZWfGt15jBbumC6TW7Z1cC/M5+yaoSlbpqEpW6ahKVumoSlbpqEpW6ahKVumoSlbpqEpW6ahKVumoSlbpqEpW6aj6qqxG++4f72vf0UT/rwPn8dltBFbh3fxj7X2u69MfuDms+uJjSFYbzso5lbIfBb7NGEyaoQ8TZ83gufZ7nGTVOCsV3ckaNA4mzdCHiXOdwROOTrKKw8o7Zcv7cahdMGn6fn4QTJwnCwbPrGbwhKOTNTASK1PxNPAaHiZN24eJc53BE45Osoq5vsoNGQnXUTBpghVMnOsMntZ1QVbRWCHedILGMGl6VpWsZlUJWb0cq8r9L07eV0OSZwOTJmqgjbUGT7KKywo2P9Q8mDQxt/AmzpM1Bk+yis/qyX1ZDrVtkF3DpFnZHUycNVarvsfJOXvE54Gl8Wj672jCpOn6MHHWWK38HidZ8Tn766tKVumoSla/2Du3F6ehIIzHkTa2TVYtRdSXCNtWVCxeUAQFUfF+QVBfFK8o6KOI/7+TjPETU2XxfAcy5MxD92yyfJvOL+eyJ99O/WQ1sfKT1cTKT1YTKz9ZTaz8ZDWx8pPVxMpPVhMrP1lNrPxkNbHyk9UesNpTdU78QHRW06PHmq/jAzv6Orl/WuTh+zKzqEbZP+K/VC9q8/xuoOqpP1WX2rxWRmB1+GBfWU2OSBOL0s5JIKuu6qpp5bNwVlDVE01Lz9JZyYm+slrJQm/5zRFZ1/ftGQlkBdUvpqoJzi9kk0syCmeFa9Xfok293DWdFapzGo9DbQmt73BvNqzuPG0+gxhGTjtafzJ07U87yGc1zWfWHtUv+Y0DYay6qvNCv1diizKYFVTtpGnTWcnxDquOe1PPScfIqUetEYnVSvB2x9fLcTgrqCKUVWi/gipEq3zGZYXqnF1WcG8aTO1ejWUTRs7m6OV9L/dFYpWdkfzjq9ftOQorqOKsrMNZQdXwS36Lu7ZAdc4uK7g3r9as8KnDvxk57Wi8dWD29lkhkp+ksoKqxVJUNoxVR3V8+7Sw+xWqc3bnq3vmrWhZ4dO8YeS0o7FYWUwuPpAdKiuo2pJlUTJYQdVicwC6NFY2Oe2d1VmJySqfdWZmnfs/B7LarlrWr5pcsipO81nVBP7NqjsGWvBZrWT9aw4Zt3dmdfRrAKu/qx7Tb2zQoqrOi1EcVqjOaQ7NQ09kKyt88jqMnC0r4tpiXjTJWxb1G63k2q7eqssirF91Vb+YapndRD4DVXGtpfZVPb6UGGNg0z9QHH87K6zZYeRkssKizGKngSPYVwhg9VfVeSHYYqCpZquibbFZoTrnoeciL75tHwPxtzCMnERWCJ2eRa5cqJu2x5brDRvA6l+qUwErmqrG/Jwe3k377MPdZ99LJFZZYuUpq4mVn6wmVn6yGkf17n5J4SO0X2U9D489IIpqYuVINbHyo5pY+VHlssIz2X69/5t2PZtnIg9PMlTNKfahbFSxRxSkCq8cVOOzqqRfrGr/GXZM1wRVOMVU1VrMa4VqbFZT6RWrX/6zSh6X2VyfHYWrmlPsU819Ko9KdaLtMK8VqpFZzYt3fRoDzX9m+S1JqnCK2bNdeyVeK1TjsMJk1av5qvafnRrhySyP1UQfPtrcbM+NKddqelCNyqpalL1ipfGTVf7mfkFaW8Appn0Lz+CFtS6DakxWq3zWu3WgsZrmp0WDMbPAKeaT1bTJg/6S/q3Zf7Jq/sdjWTBGKzjFHLOaikU+6x0r7fHUrJqWuggxs9BYQTXiGNhjVvNiTWMFpxhWbExWUB3avkXDyv4nR8dARlbhFMuq+i+hM5gFOblrVQe3x6SsrDOw9i3gFMMOA5MVVIfKKts8EDk/46jCKbbRlq5aiKygmvbZnaomVn5UEys/qomVH9XEyo9q8py5idSvHKkmVn5UEys/qomVH9XEyo/qAPYDUUmO6uSDvqpeK4mq2GaWfDYof+BKRGLsiEPfVH2y6pU/EJXkmE4+hBW9uFiMIoyBq4H5A1FJjvwEF/oo4UNlZYbGQfkD20pyPCcfoutiYUZVaw7NH2iVdZBV8hh4oR4DuarwdAzNH2iV5GKwghsIqtxuNTB/oFWSizZaLQvJT9JV2yQOyx/YVpJjO/kQfFXY7wflD7RF9XbPHXvJJlz6g9u3QNlfqpMPvfborlbvJqvaPTU0VqgkF2HfAiOJJVaoORzcfiAqycFzx19bPC7ZqroSSvvsflUTqx/snbFqG1EURIUgjiOMCxfGnQuTmDTBwd/hH0kghPx/Ea2k9cFRcDUX7nBni/Cq4emdbCJ2j+b6pIaVT2pY+aTGObO5cl8ZpYaVT2pY+aSGlU+qlhWjInt9/kPPGb6JtpGM9jR9aiUrCsA6sdpt37Jq2552nlrJ6uLraVRkH1an7jDcoLbtae+l6lnx4LENq7U7jBdNfdvT3knVs2JUZB9Wa88Zb7N0jWS8vtWnFrOiAKzVdwtY4QZp3vzQnlabqmdFAVij+wpW3Fa6U6U9rTpV78ZQANaR1XIQYla0p9WklrPa7Pq4MSsr3CApK9rTqlNhpZNFG7PCDZKdKu1p4tRqVhSAtfw3EDdId6q0pxWm6llRANb0u8VyDmJWtKfVpupZUQDW8jv7zdW1mBXtaTWpec5umhpWPqlh5ZMaVj6pYeWTGufM5sp9ZZQaVj6pYeWTGlY+qYOcs+Pjr+8PytmadHMpWbHXqc7Z5obHyrLZmnRzKVmx16nO2f32cUN3lma2Jt1cUlbsdahztm8fWp9j62Zr0s0lZMVepzpnu+3j8se1dLYm3VxCVux1qnO2/8dwf71IZ2vSzSVkxV7HOmdLZQJNFJqPSTeXkhV7HeqcrQ7DstbN1qSbS8mKvc50zm6udN1ZfEy6uZSs2OtM50zZScfHpJtLzGq0c3ZxWTFbE+1a2/Y53Dk7PGFQz9akm0vfJD7ZOXt+0s/WpJtL3dAf58w4Nax8UsPKJzWsfFLDyic1zpnNlfvKKDWsfFLDyic1rHxSBzhnbEg/r5EfIyp7zlgNc87YkHzuAf7h9oPUj2M1yjm7uFw3VDGvkQGVUj+O1SznbN1QyZweBlQK/ThW03rO1g3p5zXyn9UfWAl6zljN6zk7bKhmrhwDKpWdCazGOWfHDelZMaDSjVVj5+y4oRpWS6o1q2Ye03FDNfMaGXpoxKqpc8aG+B4YVj2dMzb0Oq+x9XOLf1mNcs7WDfHcIqzaOmds6DCvsfnzwDes8pzdNTWsfFLDyic1rHxSw8onNc6ZzZX7yig1rHxSw8onNax8UsPKJ1XMaq1o6/Q88MwUlJl82qY7Do9VFSt+lNzqOfu5Kdi36e50eD84xkJWVLT1Y/VqCrZtuuPwWBWyWiva2rxr/M8G2zbdcXisyljxF6ThfYUpqDL51E13HB6rcla7Po70uSmoeyuobbrj8H5yjJWs1oq2lt8DURc1rLRNdxweq2rnbKlo6/SbnnNTUMVK3XTH4bEqZLVWtLVlpZ+CqbMOOTxWclZcx4q2lqwwBdWsSFUcHqtqVktfb09WmIIqVuqmO/rtWBWyoqKtHStMQRUrddMdh8eqkNVu25cVpqCIlbrpjsNjlefslqlh5ZMaVj6pYeWTGufM5sp9ZZQaVj6pYeWTGlY+qWHlkzrKObvfLte1eA4qc1b1ftxY5+zTrYoV/hr2WY0fN9Q52z/GxgJRzUHFPqvx46Y6Z0tzkrrpDvusyI8b6pzt7n5f8fZCMweVOas1ftxU5+x+e7i+yOegylmRP9Q5OxpHvMOX+Wt6VuSPds4Wk0HZdFfDivw4Z7qmuxpW5E91zgQmH/5aKSvypzpnHx/5nYzKX6thRf5U54xHKrqmuxpW5E92zn49qJvu9KzIz3N209Sw8kkNK5/UsPJJjXNmc+W+MkoNK5/UsPJJDSuf1LDySR3gnGFv0U2m7Dl7flrylazG9pzV2GFkfSZfxmpozxn2ltAOI+v0vu6ZLhLFNbrnTG2HrVn0W2gnoA3uOVvsLbrJhD1nRRM75/acYW8xp0jcRfJ8JWU1t+cMe0vOirerSlaze85WO0zPaun32X583ClZDe85W86yiNVGPF11bs8Z9lYFK9ay6aqDe86wtypYLfl3D5tvt7K+29E9Z9hbdd8t6FAVXVN7zrC36r5bvIifB6bnzDw1rHxSw8onNax8UuOc2Vy5r4xS/7Z3dicIA2AMHMX99N35/aHtLXB9CIkDHCkfgsg12a1yqLtVDnW3yqHuVjnUKueMaOoKpk+lk63VOfPeF4Z1C/VJJ1upc0Y0awXz/WWJVFh0spU6Z0SzVzB96tXJ1tdz9nPOiGavYPpUOtmKnTM8Lu8xferr/GlR7ZzhcZmP6VPpZKt1zoimrmD6VKyLVueMaN4Kpk/t7TnDOSOavYLpU+lkK3XOHkRTVzB9Kp1spc4Z0ewVTJ/6/wejsOfsdM6IZq9g+tSjk209Z6nU3SqHulvlUHerHOqcs5jPvlc51A9MfoJrHFu+ggAAAABJRU5ErkJggg=="})}),(0,r.jsx)("div",{className:"flex justify-center ".concat(n," text-center items-center ml-4 mt-1 border-4 border-dashed hover:scale-105 border-black h-[150px] w-[250px] cursor-pointer p-4 font-bold"),children:(0,r.jsx)(Cp,{updateColor:function(){i("bg-green-300 hover:bg-green-400")}})})]})]})})},Ep=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n].Statements;""===i||void 0===i||null===i||t.push(i)}return t},kp=function(e){for(var t,n=[],r=0,i=e.length;r<i;r++)e[r]!==t?n.push(1):n[n.length-1]++,t=e[r];for(var o=e[0],a=Math.abs(-6-o),s=0;s<a;s++)n.unshift(0);for(var l=0;l<20;l++)n.length<20&&n.push(0);return n};var xp=function(e){var t=e.replace(/,,/g,"");t=function(e){return","===e.slice(-1)&&(e=e.slice(0,-1)),e}(t);var n=t.replace(/Sort Pattern,/,"").split(",");for(var r in n)n[r]=parseInt(n[r],10);return[vt()(n),vt()(n),vt()(n)]};function Tp(e){return","===e.slice(-1)&&(e=e.slice(0,-1)),e}var Rp=function(e){for(var t=[],n=[],r=[],i=[],o=4;o<e.length;o++){var a=e[o].toString().replace(/,,/g,"");if(a.length<5)break;var s=(a=Tp(a)).split(","),l=s.shift(),u=s.map(Number),c=u.toString(),d=l+","+c;r.push(d),n.push(l),i.push(c),t.push(u)}return[n,r,t]},Ap=function(e,t){var n=Math.max.apply(Math,wt(t)),r=Math.min.apply(Math,wt(t)),i=t.length,o=[],a=[],s=[],l=[],u=[],c=[];if(e.forEach((function(e){var t=[];""!==(e=e.split(","))[0]&&(e.forEach((function(i,o){""!==i&&(o>0?((i=parseInt(i,10))>n&&a.push(e[0]),i<r&&s.push(e[0]),isNaN(i)&&l.push(e[0]),t.push(i)):c.push(i))})),t.length!==i&&o.push(e[0]),u.push(t))})),a.length>0)throw y.setState({showWarningBox:!0}),alert("There are Q sorts with values greater than allowed [ ".concat(a.join()," ]. Check your Excel file, reload the webpage, and try again.")),new Error("Q sort values greater than allowed");if(s.length>0)throw y.setState({showWarningBox:!0}),alert("There are Q sorts with values less than allowed [ ".concat(s.join()," ]. Check your Excel file, reload the webpage, and try again.")),new Error("Q sort values less than allowed");if(l.length>0)throw y.setState({showWarningBox:!0}),alert("There are Q sorts with non-numeric values [ ".concat(l.join()," ]. Check your Excel file, reload the webpage, and try again.")),new Error("Q sort values non-numeric");return c=yt(c),{sortsArray:u,namesArray:c}},_p=function(e){var t=[];return e[0].forEach((function(e){if("undefined"!==typeof e.Statements){var n=e.Statements.trim();t.push(n)}})),t},Op=function(e){var t={};try{var n=e.projectName,r=vt()(e.multiplierArray);if(void 0===r)throw y.setState({showWarningBox:!0}),alert("Can't find the Q sort pattern worksheet! Check your Excel file, reload the webpage, and try again."),new Error("Can't find the Q sort pattern worksheet!");var i=dp(r),o=sp(i),a=wt(i),s=hp(a),l=vt()(e.sortsArray),u=Ap(l,o),c=u.sortsArray;if(0===c.length)throw y.setState({showWarningBox:!0}),alert("No sorts found. Check your Excel file, reload the webpage, and try again."),new Error("No sorts found");var d=u.namesArray,h=d.length,f=vt()(e.statementsArray),p=_p(f),v=lp(s),g=up(d);t={projectHistoryArray:[n+" data loaded from Excel Type 2 file"],statements:p,sortsDisplayText:cp(d,c),projectName:n,numQsorts:h,numStatements:s,qSortPattern:o,mainDataObject:tp(d,c),multiplierArray:i,statementNumArray:v,respondentNames:d,excelType1NonsymmetricArrayText:g}}catch(m){console.log(m),console.log(m.message),console.log(m.stack)}return t};function Dp(e){var t=e.sortsArray,n={},r="my Project";if(null!==e&&void 0!==e&&e.version)n=Op(e);else try{var i=t[1].toString().replace(/,/g,"");i.length>0&&(r=i);var o=xp(t[2]),a=o[0];if(a.length<3)throw y.setState({showWarningBox:!0}),alert("Can't find the Q sort pattern on the 'sorts' worksheet! Check your Excel file, reload the webpage, and try again."),new Error("Can't find the Q sort pattern on the 'sorts' worksheet!");var s,l=o[2];s=kp(a);var u=l.length,c=Rp(t),d=c[1],h=c[2];if(0===h.length)throw y.setState({showWarningBox:!0}),alert("Can't find any sorts on the 'sorts' worksheet tab! Check your Excel file, reload the webpage, and try again."),new Error("Can't find any Q sorts on the 'sorts' worksheet!");var f=c[0],p=yt(f);fp(l,h,f);var v=f.length,g=e.statementsArray,m=Ep(g[0]);if(0===m.length)throw y.setState({showWarningBox:!0}),alert("Can't find any statements on the 'statements' worksheet! Check your statements worksheet, reload the webpage, and try again."),new Error("Can't find any statements on the 'statements' worksheet! Check your statements worksheet, reload the webpage, and try again.");for(var w=[],b=0;b<m.length;b++)w.push(b+1);n={projectName:r,projectHistoryArray:[r+" data loaded from Excel Type 2 file"],multiplierArray:s,statements:m,numQsorts:v,qSortPattern:l,numStatements:u,mainDataObject:tp(f,h),statementNumArray:w,sortsDisplayText:d,respondentNames:p}}catch(C){console.log(C.message),console.log(C.stack)}return n}var Np=function(){var e=At(Tt().mark((function e(t){var n,r;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e){t.forEach((function(t){var n,r,i,o,a,s,l,u=new FileReader,c=[],d={},h=[],f=!1,p=!1;u.onload=function(t){try{if(a=t.target.result,s=Mf(a,{type:"binary"}),s.SheetNames.forEach((function(e){var t=e.toLowerCase();if(l=s.Sheets[e],"version"===t&&(c.push("version"),n=ep.sheet_to_csv(l,{blankrows:!1}),r=n.split(/\n/),i=r.filter(Boolean),d.version=i[1]),"name"!==t&&"names"!==t||(n=ep.sheet_to_csv(l,{blankrows:!1}),r=n.split(/\n/),i=r.filter(Boolean),d.projectName=i[1]),("pattern"===t||"patterns"===t)&&(c.push("pattern"),n=ep.sheet_to_csv(l,{blankrows:!1}),r=n.split(/\n/),i=r.filter(Boolean),d.multiplierArray=i[1],void 0===r[1]))throw y.setState({showWarningBox:!0}),alert("Can't find the Q sort pattern! Check your Excel file, reload the webpage, and try again."),new Error("Can't find the Q sort pattern!");("minmax"===t&&(n=ep.sheet_to_csv(l,{blankrows:!1}),r=n.split(/\n/),i=r.filter(Boolean),d.minMax=i[1]),"sorts"===t||"qsorts"===t||"q-sorts"===t)&&(f=!0,n=ep.sheet_to_csv(l,{blankrows:!1}),r=n.split(/\n/),i=r.filter(Boolean),d.sortsArray=i);"statements"!==t&&"statement"!==t||(p=!0,[],o=ep.sheet_to_json(l,{blankrows:!1}),h.push(o),d.statementsArray=h)})),!1===f)throw y.setState({showWarningBox:!0}),alert("Can't find the 'sorts' worksheet tab! Check your Excel file, reload the webpage, and try again."),new Error("Can't find the 'sorts' worksheet tab!");if(!1===p)throw y.setState({showWarningBox:!0}),alert("Can't find the 'statements' worksheet tab! Check your Excel file, reload the webpage, and try again."),new Error("Can't find the 'statements' worksheet tab!");if((yp()(c,"pattern")||yp()(c,"patterns"))&&!1===yp()(c,"version"))throw y.setState({showWarningBox:!0}),alert("Can't find the 'version' worksheet tab! Check your Excel file, reload the webpage, and try again."),new Error("Can't find the 'version' worksheet tab!");var u=Dp(d);e(u)}catch(v){console.log(v.message)}},u.onabort=function(){console.log("file reading was aborted")},u.onerror=function(){console.log("The file reader encountered an error")},u.readAsBinaryString(t)}))})),e.next=3,n;case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Pp=Np;function Fp(t){var n=y(),i=n.isDataLoaded,o=n.setNumQsorts,a=n.setQSortPattern,s=n.setNumStatements,l=n.setRespondentNames,u=n.setMainDataObject,c=n.setSortsDisplayText,h=n.setMultiplierArray,f=n.setDataOrigin,p=n.setStatements,v=n.setProjectName,g=n.setProjectHistoryArray,m=n.setStatementNumArray,w=n.setExcelType1NonsymmetricArrayText,b=n.setHasImportedSorts,C=n.setHasImportedStatements,S=n.setIsDataLoaded,E=n.setShowInputErrorModal,k=(0,e.useCallback)(function(){var e=At(Tt().mark((function e(n){var r;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=3;break}return E({showModal:!0,titleText:"Data Loading Error",bodyText:"Data are already loaded.",bodyText2:"Reload the webpage to start a new project."}),e.abrupt("return");case 3:return e.next=5,Pp(n);case 5:r=e.sent,o(r.numQsorts),v(r.projectName),a(wt(r.qSortPattern)),s(r.numStatements),p(wt(r.statements)),l(wt(r.respondentNames)),u(wt(r.mainDataObject)),c(wt(r.sortsDisplayText)),h(wt(r.multiplierArray)),f("excel"),g(wt(r.projectHistoryArray)),m(wt(r.statementNumArray)),w(r.excelType1NonsymmetricArrayText),b(!0),C(!0),t.updateColor(),S(!0);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i,S,E,o,v,a,s,p,l,u,c,h,f,g,m,w,b,C,t]),x=it({onDrop:k,multiple:!1}),T=x.getRootProps,R=x.getInputProps;return(0,r.jsxs)("div",d(d({className:"flex justify-center items-center pt-[20px]"},T()),{},{children:[(0,r.jsx)("input",d({className:""},R())),(0,r.jsx)("p",{children:"Drag and drop Excel file here, or click to select"})]}))}var Ip=function(){var t=Y((0,e.useState)("bg-gray-300 hover:bg-gray-400"),2),n=t[0],i=t[1];return(0,r.jsx)("div",{className:"w-[300px] mr-4",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center  items-center rounded-md bg-white h-[500px] w-[300px]",children:[(0,r.jsx)("h6",{className:"text-[22px] font-bold tracking-tight text-gray-900",children:"2. Load Excel Type 2 file"}),(0,r.jsx)("div",{className:"text-gray-900",children:" Q sort Data in Rows"}),(0,r.jsx)("a",{href:"https://docs.google.com/spreadsheets/d/1Rr0XBwTVls1Z2b1ydzTCEKDqzMgJ0pRrhr5NAac4NTI/edit?usp=sharing",target:"_blank",rel:"noopener noreferrer",style:{targetNew:"tab",color:"firebrick",fontSize:18},children:"Click here to get a sample file"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("img",{alt:"excel type 1",className:"w-[250px] h-[175px] m-4 border-2 border-black",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAisAAAFqCAMAAADsnOpOAAAAzFBMVEX///8AAAD//9vbkDoAAGa2//8AADo6kNuQOgBmtv//tmaQ2//b/////7ZmAAA6AAC2ZgAAZrYBAQAAOpD/25BmOgD/27a22/+QOwFmtf46ZpBmtts6ZrbbtpDbtmYAOjoAOmZmOjqQZjq2kGbb27ZmkLYAOo86Ojr/29u229s7AQBmkNvb2/9nAQGQtts6Omba/v+2ZwG2ZjqQOjrb25DbkGaQo7aQkDrb29tnOwFmZpA6Zma2ZzsBATpmOgE6OgBmZkm12v7+/9s7OgDwAFRiAAAdLElEQVR42uxci3bSQBR0UanYtKWo1Vjfj6r1/X7//2+5UGEK17OTeAnMssw5HilndnL3Mglkk8yFDUTY8pfM31yo9a40fk5Q611p/Jyg1rvS+DlBrXel8XOCWu9K4+cEtd6Vxs8Jar0rjZ8T1HpXGr8JLoawcwG4ij97dx8ehBDu/7i5MGRv/9JlJuv3it0k5x89ihX3b99so997/Gw8y9s3BfQT3SX1rNcr9w7CFNfmiuldCSv0CjbJ+Ci5/5LqY8xp+Is7XP+0G33WXT7ftXolvgDmqu8Nwyq9gk0S/lzJA6pvx4TD5vq1X59O1THf1Xplbz+EB2+q+Orb4+jek+qc71fqFWyS8SclxyPgkxtgJ/gY8+LC2aD+7tr0WXd5PWv0Snz72tQf1w9g3LsHYbVewSYJHyX3rozCTjP9q5O9fTrokOmf/NUPXejbqfL5op41emUY9wJwpjM+ihYOt2+s0itH3/+9yWB3yVnJ109h9LT+EF8nGMT1DzrQJ92l9Yh4JdZyOCX3j1f72/biCJtM8vf2Zw3r3UL1TB/jX8fxRP/d7BixZH3SXTJf2GblXsHbhty/U11YsVd+Y5MpPg73Ee9DGDg+S6o/HPn1W3SX14P5rsEr498od14tkp9XKz9nxiZ573Ywqfa9u4rfE1x/tER93l1ez1q9Et+P6P/8cuaXDNZX0C/MIsW3h/T+bmP9kV+fTrXlfCXW4t6+qTbfK70hW//gXuH6m+qVuMZ/I5yh/7TacK9gCczhFaq/uV4Z48njh2GMk2qjvRL18Q3h8ArR32yvnF2gCnizU69gPTIC3XV6hesfYVHV4RWqn71XsBlrHayvxPrVvWLPC7g+fpk9gHzL8yC/PiB+HjTbJM7U8d/59YQMvGLWV5j+7IzvTtVuPWO0XH1Aen0lHjNOqsWFY6zqYz9S/73yv+u2v+a+YR3rth59QHndFuf9+LbB/+d6o+6VxPUgdg1h1339xa+PzeheD4rHr7ghbD8cTl88uImvw1i/uldaXmfGkfwS7uRyX2fm+twruteZoynHCyivxmvMj8cvd2fvhtsvqukyy478OfP0XpGW95dgr1+TPp+qvx4/cJScAaa4F87jUH8trt19Ytg3AXysVL926DOv6N4XN39nbf8Yx5sbePdlBmv8EZ/Z/adWt9Vn+fnUoe/1in++fuCO/f7ClZ8nj55N3v2SxfWg/7mvfW/ffJZr08dUZe/jV4Ha8zKl8XOCWu9K4+cEtd6Vxs8Jar0rjZ8T1HpXGj8nqPWuNH5OUOvdxvDDFls0wkYeXmT3y0L4OUGtd6Xxc4Ja70rj5wS13pXGzwlqvSuNnxPUelcaPyeo9a40fk5Q611p/Jyg1rvS+MvKt02HtWaeb0v0Le4+HLfgaUX4pFuBSFM+MoBi6YL5tnjvLKxV7B5Kkvfq0wf1DP1Bgs+7Ff4lPbLSvJ7R2r1i8m1TYa355ttSfWsVuxHL590KSema8E3pavm2JqwVyDXfluvbdk3SaD7FjVyrEnzWrZCUPqkIH6Wv3ysm33YhrHV+V8k237aNPh4M5ZlevFuhkTTPwxXwism3xdP49gnafPNtW+gjvRU5Fin++3S3QkNpnoer5RVMwzykP0HO+bYJ/TSGxCukW6GRNM/DFfhti7f57LPOtyX6iQ5giMMrRJrm4SqcBy3k26Y+mLzzbZvp25WTA3IexLoVEtLkPAili5wzI9+WPP6vsr7iyE9r65XhpDfHCT7vVkhK57W+YvJtTVhr4V65f1wl+LRbIS2dl1fm823t+k+5Xul9fBavfpD1FdatkJQ+qfLyykK+rQ1rLdUrsxPWwyaf5a1/dysQ6fy8YvJtbVirSg4l8QrXb8jH2zQjw3aL8iEt6JXm+bYmrFXLK+Y8qDOv2FbZemi3Aona2tH3SiLf1oS1ynkF6yur8MpV6hXbrTQf0ppeaZdv+2F0rkFav1fMuq1Xn4F75UOYUDbGK63ybaOFQBbzCrke5NbH945dibd82q2QlI77pqBXGufbmrBWMa+Q68xOfexL/V0b+mv5tFuBSSt6pWG+rTkEyXmF5L169bFecFyZk0PDp90KRFrxnLlxvq0NaxXziiPvlekDR/tzTUnwSbdCWlpy3bZxvm2sStwrJO/Vq48FkwhzghPMGhzxSlL6napXGubb7u2rewX38Xv1+X38ixsJ5vZ64pWktOa1QxWoPS9TGj8nqPWuNH5OUOtdafycoNa70vg5Qa13pfFzglrvSuPnBLXebQw/bLHFNt92y99+B13IrHel8XOCWu9K4+cEtd6Vxs8Jar0rjZ8T1HpXGj8nqPWuNH5OUOtdafycoNa70vhLzbe1Cax++PNh+SA/397MPlDL5x0XVQtkaiDf1iSwOuHPh6WDOP+U8u3jAoMO7tFELa3uF0ZRtVS+rUlg9cKfD8sH+fk2IWXQdT5vTfVtUbVSvq1JYHXDnQ9LBrn4CXMNpPJ5/xZVK+XbkgRWB9z5sHwQ548YHw8zDDrK5z2ppqXvMH1bVC2RWRo5hzaBtWOvDJvkw9JBnF9P+adJPn54fCVe8efz8vnaolS8ApOYz8QHd+YnG9SG/zrJxz4y/tdRPu+781kDhG+KqjXzbScJrAV6Je40OzimdpDPy3ISUkXVivm2JoHVC38+LB/E+SPK792KdoJXOszn5V6xRdV6+bZIYHXDnw9LBi2ZPxxFCveKPxuRZ/XYoiTW4vCUs01g9cOfD8sH+fnojZpXUFQtl29rE1j98OfD8kF+/t5+nLSaVyZFrd8rJt/WJLC60UU+LCJ4l8wfjj9vNa9MitLwCvJtuwrk9+fD2pzIo+/4g/DNRuhniRdc3+cVrj9XVC2Xb2sSWF1w5cPa3plBbr5ZY3J4xXseZPXniqrV8m2N831w5cPa3plBHr4tBXDkcjvWV4y+KUop33a1XuH5sHQQ5/8C3+eVBDpat7VFyeTbmgRWP7z5sHQQ54/GfAGvLF4PEvRK43xbksDqgDMf1g7qju84D+roOjMG10r5tiaB1Q9/PiwfxPkaXpnP55X0SsN8W5vA6oc/H5YNcvA79Qq/L07TK3/YO9Mdp4EgCDNBikhYRMIibi0g7lMcQoI/gHj/h4JMsArSyIXVaqd6Z+oXYsvpmU7Fsb0z3/4X39YSWAOzwmi68LODqF8pKxc+Yb2talY435YQWAOyQmi68JODmF8qK1jHr5sVBantl2nNn0lqvWvNn0lqvWvNn0lqvWvNn0lqvWvNn0lqvWvNn0lqvTs3/tLV1fm23d+/gy4k611r/kxS611r/kxS611r/kxS611r/kxS611r/kxS611r/kxS611r/kxS611r/gC+rSG8xmSF03QLQckyvy3i49Vyf9B8cZAAUwN8W0N4Dc0KVsMuVyN+slyR+m8NRW5zPw4yRTxrKDk92PrtQVp8W0N4jcwKooJyxk/gGMSPVpsihFd7zRTx8m0tPZj5bZOU+LaDJT4rBzRd7HbjnEiSFVLEwat1+i09ePr4dfi2+AYKzwqn6RaGkuV+W8TFq+V+/3zJQQLMUuyEN4TXoKxwmm75J6sFKFnqRxHs7yd+FPlqinC+rXu+fPwCWRlGBJhqWFYI4ZjtlQdKlvltEd5rFLHXtpxv654vH78W39YQXqOzApouz8rSoGSNnxexfluEZIXwbR3zJQdJ8W1BeI3PCmi65D6IoGSNnxThvFpkxcW3JfTg6ePX4tsawmtoVkDTDXi+QooEP1/xz9ceJPAsbtjljJ+GZ8XSdAOzgiIqWcFQpo1fiW8LmGpwVgxN9/QkMCsocvSsGHrwtPEL8W0BU43OiqXpBmYFRY6eFTZfcpAO35YQXn0qnGnnz4rlREJX3uA/iB9Z8XAo+Xynj1+Fb0sIr04VFujArKCIRlZAD546fhW+LSExRmZlPUdW1jpZARF2yviF+LbnJStjRSSuV5CVaeMX4tvOmxWcUnGa82dlrMh7FJk/KyP04Cnjl+HbVs10vUJouv6s2CJYkxKTFf98+fhl+LYzZoXQdB1ZIUVCs+KfLzlIiG87W1YITdebFV4kPiv++dqDpPi2M2XF0nTjnvHf+IIix8yKpQczv22SGN92nqxwmq4/K7bI8X93SOc7dlDfH9T9OvuDVKTWu9b8maTWu9b8maTWu9b8maTWu9b8maTWu9b8maTWu3PjL11dnW/b/f076EKy3rXmzyS13rXmzyS13rXmzyS13rXmzyS13rXmzyS13rXmzyS13rXmzyS13rXmn77wduD0DFo+e/KaEA+jswKkrghPlrw+tfr9tjUKWfml5athDsfJCpC6rjWLnJ8bsIYS1oA1oNjHLJOVYSTrcsSsbMqUrCzeT+HJYkJuvi23+vm8lhN31Kyg+OLsaiEgjXn2qJKsGL4xGu7g57r5ttbq99vWiGRlgNsCvgLNlBUgdQV4suT1mdXvt60Rysru9L+trTUfvpmyYpG6nD8bwpPlfFtu9fN5bWt0slKRCTXAW3J8TFYsUpfzZ3+E8GQ535Zb/Xxe2xq5rKxLWd14WHaoQUcJlhWO1OX82SieLOfbcqufz2tbI5SVzQAAW34ve90x30WhfNtLQOoG8WTx2i6+Lbf6+by2NUJZGa5tNwXChcsMWXlfBqSuDE9W5flKBeHLZOXzh6s1Gnt4wxMDb4jNChBHdUwyPFmRrFSQ0/GzAlUiC+4rDUnGK35PeHoSlxWgYfNlpbZGKyvLy2Y2GFxoVg6Rujo8WYms1NYIZeU+MBsGUuYW5yzuSt0eaq50eLIKWakdUcjKasy3ni0reF4WlRWkP1lWrr/81ZqeFbw3Bn0ZxZPNlxWQ29Ca8KwsPn47PQHFlmTF/Dz0eoVkxciTlWTXK6FZ4U8tNzYr9iyNb/fkWTnk5/asQGO/wV+BeIysWCT/3r/BXUNkVuy5TIAnq5MVKPh6xf71xv2d4+nJQXELUn38y7bvcfKsHKBh890zz5oVXFEPWqG4/Rgenu+SZ+VvNGzG57YkKyFaX0UGbHHwbg8W4GbPyp9o2JTP+I+Qld1ZeAdXr4RUFDda/F71PizsT5+VP9CwOX93iNb0/UHdL7s/aIp6Vs6ZP5PUeteaP5PUeteaP5PUeteaP5PUeteaP5PUendu/KWrq/Ntu79/B11I1rvW/Jmk1rvW/Jmk1rvW/Jmk1rvW/Jmk1rvW/Jmk1rvW/Jmk1rvW/Jmk1rvW/FP/8PtvmC20NrvCF2fPdkYDFnDJz3vl0NpCFwQG8HDhj+PVLh49K6F/993Saqqw8hRUxNU/13E/8JMSgtYgAlpL/WdXf1tfsdcH3xIvHcLPBcqX+zGHqnuRWcG7AQ3nEazd3/57Mf9T+Bzy8mEJtJbwS4wVIjzc29zP+bkc5cv96wJtZ9lLVh683X37PH5YUHHP/fq23wyEyC/v1hORb+NHDO/VQmsZv6Q8uFl3PJkShIeLT4qDn+vk1WIOLy5g21ZQVpBjvO9n+4ECBnOGH2J/Hi5kfPLzXgm0lr2XpydDIDFJPw+X+/28WiRri4/8Njgr13GKQAOxIxy7nTF77Gd1ys+HJdBa+l4OR2HSDh4u8UfwajfwXn+JSQRl5eJwQsVO+Jt/oOswGsw+QD4+LGsj/BahhdhE8HDhD+fVXnkTlRUE+eBC7XOth08bznIB3BUfH5bjH0b8mBjeTD8Pl/s5r1Y2K5V/MAY7qp85hH7/SOI+IJ9e+fmwHFpr/Ug+ZjaBh2vvg/z83DpXB692HXi9gqdt78YuE2tk8J10Uf35ym+QDKC1hLeG3Dh4uE4/xk14tYx5d5ys4OoEZ54N0Nm7mxPxrABa680K5+FyfySvFlSc8Kxsxy/IFpfwj1/aPUt+/pO9M91xGgiCcIYgIJERCTcs932JI9yHhHj/lyLpXVOQRipMq6DH4/5DiMrjcbvWnvPLpmwPS+sVB62NesUXzcdXfFU4r9aK5V7hP1Glf674Bhkk5hWMxCx3Iz9ZvQJobdArvOi4Ps6rtVuD+6Fs2zqvuMHjvh4r+MrYckm84jmReIELvIKiY3rOq+XXCzPiPzKv+Ms49gyD64iT+MUPYPJze8Ua5YJ+EOiuUX6ubx4O9QqmD11fQzq+ghRewyzhLy3ZeV1eMTMIxldw9XEmKkdu8uudFw+m0o/b4uEBX6B1+0t253m8Qm7Qn47bVuOVvdichfjfzgct7RmCVxMmiY56z/naKxxaG58PQtG4+oH8XJFX5nieKr2CSmKe+cg5mEcGCtYued0d6naWSugVB60NzDPTouP6OP9tWTB/929YyEYMNHig5Q/NWEjWdvmHqyUebcxfCb3ioLVs/cpjsn6FFB3Qh72CroncKzjfx4KwBjXeNng/961brIvL6BUHrQ2siyNFh/Vxr/ifetKvt92UvfW28/7qMId5WP+3/Xrbq9uBloxe+QVay/Rv/3C9rS/65UB9p/AKRjb0XkE8uot1/HZ/9qv7yt5Npvy6rdOL3bK9nF4BtFa2jl+iH+4VdJ/hlWl/0KRPtD8oQWTLXWv6miJb7lrT1xTZcteavqbIlrvW9DVFtty1pq8psuVuNPoyxRQT33bST++gWWW5a01fU2TLXWv6miJb7lrT1xTZcteavqbIlrvW9DVFtty1pq8psuWuNX1NkS13reld0C1xtpPFLc46bXsg9xZ3KvYHcXRrfJ0bPwnn7YbrEy/fH5TCK0dWEXuFo1s5r/aJqen6WX8MThL/DX/Oz42X7w/K4ZXeKmqvcHRrcF1+nA8LeEWkPvHy/UE5vLL1bDn+zR0l4K9wdGuYV8tOEuft8vrEy/cH5fCKWWX/hbuU7g/y6FbKL8HObNNju3GED8t5uwF+bqB8f1AOr8Aqbreb1it7sFTLOmcPO9Qr5cMaJQIHcd7uBXIv+X7pePn+oARe8VYBS0HoFedNnmsTvez3FMHLMean5+2StifnMMTL9wdlaNs6q/wMWE/mFXudYOvbQuAV4+2Se8n4LvHy/UEZ+kFmFdTBPVzVXvFpl3CawIflvF3cllB94uXjoBR9Ztvpj2skfSCdV9A80rACcZLA+Aetz6jHVw5OoX3N7lw8CkG3Cr2Ck0xe+Tuv7OLmGWTQvxD0XsFAk9ArOMnklb/3yrluWez/pLUi5iTghBKvgA87eeVvvWLdghWS6MYK9F4BujV+bzgfthKvuPrLveIuA9bBoKNVzD54b4m94tCt8X5HnA8b6QeNzys2EoCrO2TErckrSOIVj26Nj6/E+bB/Ob4yDq9svfCgc1aAVyyVC/IKEnnFIQwV47ZfcJLAveTjtiNor6ALjB+AcfPMUKheQbPC0K2K+SCDOtthUa/w+aAReGW2QoMEM7rmFbgJj55XlgBBFIJuFcwz4yRhr/B55jGsdbIGyYn7z4wbeKaYFXwrvqwd6U/iFT7mF+fV+pPEvcLrMwqvbJ/CfrUbvIKfIscEmyIKQ7cG1qEF+bD8XvL6jGINpfUZka0D38uzvxCri7UEZF7h6FbKq2XrbX2OFV5BfUa23tZOdd3wtidePO9m3itmEXv32of1TBKFoVsF6+ZxEo1XUJ/xeCVDZNsv05q+psiWu9b0NUW23LWmrymy5a41fU2RLXet6WuKbLlrTV9TZMvdaPRliikmvu2kn95Bs8py15q+psiWu9b0NUW23LWmrymy5a41fU2RLXet6WuKbLlrTV9TZMtda/qaIlvuWtMH9qhitdzNT5dmiHtY6RWL4fzZJDzcox9zv985PVkBf4XpIV0I6q/xiluFe66vzLHN2WKhZIBx/izn4Ur5s0cHLQaxigv3CqQLQf1lXrEPfWDLwgpfxc0ynD+bgIfbW8UdVMgmLOYVt2lCUH+RV2xziy3V/rDbNfSg67cS7R54F7EVMRLD+bP/nYdreyF3r583F2y1OtXjrnKvQLoQ8HOFTA2kwiyyAP1LQKIM82e9VLAvEBtPCTPM31XqFUjhFUH9JV5ZIRPwiH0pgDuF+bNgEUAq2G9syrXfFcO51sffU69AioKH1D+JVyxDAq+EmKJMKuAYOG8yPVw1p16BFAXH66/2Cr722jUSVblXCB+FcyvRSKB94JMz6hVI4RVB/QVesTbKtWc+P4dt2ztyHj/nzxKplod77O4Z2g/Cu+JcR7wCNp5JUXK4/mqvYFf4ic/vnjn4uwWYWYEYzJ9NwsNdWW4OqB4UEu4VK/esSVGxIfVPMRa33eUMs1wuFlcFjHXOn83CwzWv3DzomN6KNhYM8wpqUaVXtmP8/VPERhSAoMBfVSiG82eT8HCPvX5osx9kfAUtUOIVSB90lXrFpn/u3i7bsIswrTViHm1KvG0r48+qebh4Ha+5fmW+ZV6BtGKvHE5QFfvy50mNGyXMdxrMn83Dw0WriOhhEfvA65PbK7/l2yJAHNzrpZ2NPliG8mfz8HB/ShXRY+iOeuWHNHE/6Pd8W3TY4QyrEcBh0UF+AX8W0vj4BPfKkntlXn4Jr0c4acLxld/wbf3vvsydV5Zhrwj4s5uzkMrHPb1XfES8knDc9nd82/5fOMg6/tp3UJw/Cx6uhD+L9w7+mIVeSTgf5Pm2/Ydbl3AdW+dYlfqX7jK8KCHMnyVSxTytpcCuG0mh94a1V7w07Tyz59v++LZcfdzZMEtv8xX6zPq5Qzz1EvFwrUd+0KFzKPKKqP4Svq31igtijVabYJA/yJ/V83ARFy0FSIrCK2nXxTm+bR/nL+Dbp2i4FAv7mYRIxPmzTCriz2JK7Fon9Yqg/gK+LdbsP7Rv33U/fXfbVo4/jp4yzp9lUvE6fjtI5JWs6/izRLb9Mq3pa4psuWtNX1Nky11r+poiW+5a09cU2XLXmr6myJa71vQ1RbbcjUZfpphi4ttO+ukdNKssd63pa4psuWtNX1Nky11r+poiW+5a09cU2XLXmr6myJa71vQ1RbbctaavKbLlrjU9CyzaRJzcX4H7EHxbx3bVeIWcjjI/pb/LjvJFfFt/0Zznm8Ur39s7g5aGgSCMuiKVloIXPWiKHkT04EE9eVPw//8nu8FlpKM85GPsbJM9CR3WzO5Lk910XrZt49yuUO8hsuJVsjHv2Gc/LPev+205afb55mGlnHq3aywr/O8KGTU4fqX2r/ttIWnB5xtfz+yLlR8qvU32YHrbkxCvE6tkuX4H5hL8sEL/gt8Wk2afbwZWakmMKTVOQW+rsMIqWb6/OSswl1C3J/Qv+G0hafb5bv/MwUorhF8Z6SZhDGLFq2QpvpXuXF3AXHI9sN4/+211f+7z+Lkdfw5WKsGu7jvAsc4qWa59H+DeEzwDQv+C35aS5u+tNKyMrr4d/UqAA4xUsjyXi83a1im6v4T7l/22kHR3rJyfOT9ihI+fVLIc/7CGNS14kYT+Bb8tJ80+3yT3K6+3bR1Uj8hAjmTFq2QD9j/Qt8b9635bSFrw+Qax4tbpbn9l2QAZ2jjHsuJVst2yAn5b0Z9rPt8krFTCTb8yukcCWAGVbKesgN+Wk+Zr3HP93s/Byv3d2qsI3oNZ8SrZTlkBvy0nzcczStL2vm9b77BuBu8eWQyrAFbggtwNK+S3/bs/l32++2fl63Uf3wbq+qOUxeYxYs3MwmaOD1gHQf+635b9uezzTcFK/dh9/s97cfp5z/srMayw35b9uezzfTpKwsp4OMsfN4o6ZwX2bdX+2Vmq+3NfyhiShpXj8aGyPXWwczKAFVDJCnPJz4NSsOKSZp9vIlbqQJrzdtmePNvVN4AVUMnyXIb5bV3/oi+OkmafbypWxpPjsnE81BvcRk8AK6CSFeYS/LA5WHFJk883GSvtKmQ3YX5s9VZAJavNJf8uLgcrvybNPt8UrLSrkO2vmH49iBWvktXmkv2wWVhBf669RzMlK7YWOr59K/UFiNCnyopXyWpzyb/jz8MK+XPtvcI7rMz1QXN8ovqgLC3b2E0tvqeWbeymFt9TyzZ2U4vvqWUbu6nF99Syjd3U4ntq2cbuYOLL3OY2+23n+PkadNTZ2B1K/Cf81ChYRMhmgAAAAABJRU5ErkJggg=="}),(0,r.jsx)("div",{className:"flex justify-center ".concat(n," items-center ml-4 mt-1 border-4 border-dashed font-bold text-center hover:scale-105 border-black h-[150px] w-[250px] cursor-pointer p-4"),children:(0,r.jsx)(Fp,{updateColor:function(){i("bg-green-300 hover:bg-green-400")}})})]})]})})},Lp=function(e){var t=e.removeOverlay,n=y().csvErrorMessage1;return(0,r.jsx)("div",{className:"overlay_background",onClick:function(e){return t()},children:(0,r.jsxs)("div",{className:"overlay_card p-8 min-h-[400px] min-w-[600px]",onClick:function(e){return function(e){e.stopPropagation()}(e)},children:[(0,r.jsx)("div",{className:"mb-4 border-bottom",children:(0,r.jsx)("span",{style:{fontSize:40,display:"block"},children:"There was a file read error!"})}),(0,r.jsx)("div",{className:"m-4",children:(0,r.jsx)("span",{style:{fontSize:30,display:"block"},children:n})}),(0,r.jsx)("span",{style:{fontSize:30,display:"block"},children:"Please check your csv file data and try again"}),(0,r.jsx)("form",{className:"mt-8",onSubmit:function(e){e.preventDefault(),t()},children:(0,r.jsx)("button",{className:"btn btn-primary form_submit ",type:"submit",children:"Close"})})]})})},Mp=function(){var e=y(),t=e.showCsvErrorModal,n=e.setShowCsvErrorModal;return(0,r.jsxs)("div",{id:"modal-root",className:"flex flex-row bg-gray-300 p-8 pt-2 min-w-[700px] min-h-[600px]",children:[(0,r.jsx)("div",{children:(0,r.jsx)(Sp,{})}),(0,r.jsx)(Ip,{}),(0,r.jsx)("div",{className:t?"overlay_shown":"overlay_hidden",children:(0,r.jsx)(Lp,{removeOverlay:function(){n(!1)}})})]})},Gp=function(){return{projectName:"Lipset Demo",projectHistoryArray:["Lipset project loaded from demo data"],statements:["1. We accept improvements in status and power of lower class  ","2. All men expected to try to improve selves                  ","3. Success in life by a previously deprived person is resented","4. Men can expect fair treatment according to merit           ","5. Lower-class not revolutionary                              ","6. Political goals relatively moderate, even conservative     ","7. Those born to high place in society should retain it       ","8. Person with wealth deserves place in high society          ","9. We try to eliminate privileged classes                     ","10. We accept aristocratic-type titles and other honors        ","11. The government has its secrets, this is generally accepted ","12. Emphasis on publicity in political matters: no secrets     ","13. Encouraged to think of ourselves as competing for success  ","14. Social status equated with manner of speech                ","15. We take law into our own hands, mob action and vigilantes  ","16. Close ties to Mother Country, as Britain still is for many ","17. We prefer companionship and helping hand                   ","18. Some disdain for acquiring wealth for its own sake         ","19. High value placed on protecting and promoting underdog     ","20. We like the idea of a welfare state                        ","21. We value the race for success                              ","22. Corrupt means of achieving success are accepted            ","23. One law for the rich, another for the poor                 ","24. Lack of respect for the police, and law enforcement        ","25. Trust in police has sunk deeply into our national character","26. Worth of a man is judged by what he is, not by education   ","27. Deep respect for the rich, the educated, the social elite  ","28. We are tolerant of popular opinion, don&#39;t like extremes","29. Poor on earth will enjoy higher status in after-life       ","30. Respect for civil liberties and minority rights            ","31. Virtue tends to be its own reward                          ","32. Position of depressed classes must be raised               ","33. Emphasis is on getting ahead"],numQsorts:9,numStatements:33,qSortPattern:[-4,-4,-3,-3,-3,-2,-2,-2,-2,-1,-1,-1,-1,-1,0,0,0,0,0,1,1,1,1,1,2,2,2,2,3,3,3,4,4],multiplierArray:[].concat([0,0,2,3,4,5,5,5,4,3,2,0,0,0,0,0,0,0,0,0]),mainDataObject:[{name:"US1",posShiftSort:[4,5,3,5,3,6,5,4,5,4,6,6,7,8,4,1,2,2,4,1,8,7,8,6,6,5,9,7,7,2,3,3,9],rawSort:[-1,0,-2,0,-2,1,0,-1,0,-1,1,1,2,3,-1,-4,-3,-3,-1,-4,3,2,3,1,1,0,4,2,2,-3,-2,-2,4],displaySort:"-1,0,-2,0,-2,1,0,-1,0,-1,1,1,2,3,-1,-4,-3,-3,-1,-4,3,2,3,1,1,0,4,2,2,-3,-2,-2,4"},{name:"US2",posShiftSort:[4,5,4,2,7,8,6,6,1,5,7,4,9,4,6,2,5,3,3,5,8,3,6,5,7,6,7,8,4,1,3,2,9],rawSort:[-1,0,-1,-3,2,3,1,1,-4,0,2,-1,4,-1,1,-3,0,-2,-2,0,3,-2,1,0,2,1,2,3,-1,-4,-2,-3,4],displaySort:"-1,0,-1,-3,2,3,1,1,-4,0,2,-1,4,-1,1,-3,0,-2,-2,0,3,-2,1,0,2,1,2,3,-1,-4,-2,-3,4"},{name:"US3",posShiftSort:[7,3,3,9,4,5,1,2,6,1,2,8,8,7,5,2,7,4,6,5,6,3,5,7,3,8,6,4,5,4,4,9,6],rawSort:[2,-2,-2,4,-1,0,-4,-3,1,-4,-3,3,3,2,0,-3,2,-1,1,0,1,-2,0,2,-2,3,1,-1,0,-1,-1,4,1],displaySort:"2,-2,-2,4,-1,0,-4,-3,1,-4,-3,3,3,2,0,-3,2,-1,1,0,1,-2,0,2,-2,3,1,-1,0,-1,-1,4,1"},{name:"US4",posShiftSort:[8,6,2,4,4,8,2,3,5,1,4,5,8,3,2,1,4,7,9,3,9,6,6,3,5,6,4,7,5,7,6,7,5],rawSort:[3,1,-3,-1,-1,3,-3,-2,0,-4,-1,0,3,-2,-3,-4,-1,2,4,-2,4,1,1,-2,0,1,-1,2,0,2,1,2,0],displaySort:"3,1,-3,-1,-1,3,-3,-2,0,-4,-1,0,3,-2,-3,-4,-1,2,4,-2,4,1,1,-2,0,1,-1,2,0,2,1,2,0"},{name:"JP5",posShiftSort:[1,4,8,4,6,6,9,7,1,9,7,5,4,8,5,7,5,3,3,5,4,7,6,2,2,2,8,5,6,3,6,3,4],rawSort:[-4,-1,3,-1,1,1,4,2,-4,4,2,0,-1,3,0,2,0,-2,-2,0,-1,2,1,-3,-3,-3,3,0,1,-2,1,-2,-1],displaySort:"-4,-1,3,-1,1,1,4,2,-4,4,2,0,-1,3,0,2,0,-2,-2,0,-1,2,1,-3,-3,-3,3,0,1,-2,1,-2,-1"},{name:"CA6",posShiftSort:[6,2,5,8,8,9,3,5,3,3,6,4,6,5,1,8,4,5,6,4,3,2,4,1,7,7,5,9,4,7,6,7,2],rawSort:[1,-3,0,3,3,4,-2,0,-2,-2,1,-1,1,0,-4,3,-1,0,1,-1,-2,-3,-1,-4,2,2,0,4,-1,2,1,2,-3],displaySort:"1,-3,0,3,3,4,-2,0,-2,-2,1,-1,1,0,-4,3,-1,0,1,-1,-2,-3,-1,-4,2,2,0,4,-1,2,1,2,-3"},{name:"UK7",posShiftSort:[7,5,3,6,5,6,4,2,5,4,6,4,6,7,1,9,8,7,5,7,3,4,2,1,8,3,5,9,2,6,4,8,3],rawSort:[2,0,-2,1,0,1,-1,-3,0,-1,1,-1,1,2,-4,4,3,2,0,2,-2,-1,-3,-4,3,-2,0,4,-3,1,-1,3,-2],displaySort:"2,0,-2,1,0,1,-1,-3,0,-1,1,-1,1,2,-4,4,3,2,0,2,-2,-1,-3,-4,3,-2,0,4,-3,1,-1,3,-2"},{name:"US8",posShiftSort:[3,7,5,2,1,9,5,4,4,4,6,4,6,4,9,5,5,6,2,6,7,7,8,8,2,6,1,8,5,3,3,3,7],rawSort:[-2,2,0,-3,-4,4,0,-1,-1,-1,1,-1,1,-1,4,0,0,1,-3,1,2,2,3,3,-3,1,-4,3,0,-2,-2,-2,2],displaySort:"-2,2,0,-3,-4,4,0,-1,-1,-1,1,-1,1,-1,4,0,0,1,-3,1,2,2,3,3,-3,1,-4,3,0,-2,-2,-2,2"},{name:"FR9",posShiftSort:[8,6,5,6,1,2,7,7,3,5,5,3,6,9,4,3,7,4,7,6,8,2,2,3,6,5,4,1,5,4,8,4,9],rawSort:[3,1,0,1,-4,-3,2,2,-2,0,0,-2,1,4,-1,-2,2,-1,2,1,3,-3,-3,-2,1,0,-1,-4,0,-1,3,-1,4],displaySort:"3,1,0,1,-4,-3,2,2,-2,0,0,-2,1,4,-1,-2,2,-1,2,1,3,-3,-3,-2,1,0,-1,-4,0,-1,3,-1,4"}],sortsDisplayText:["US1: -1,0,-2,0,-2,1,0,-1,0,-1,1,1,2,3,-1,-4,-3,-3,-1,-4,3,2,3,1,1,0,4,2,2,-3,-2,-2,4","US2: -1,0,-1,-3,2,3,1,1,-4,0,2,-1,4,-1,1,-3,0,-2,-2,0,3,-2,1,0,2,1,2,3,-1,-4,-2,-3,4","US3: 2,-2,-2,4,-1,0,-4,-3,1,-4,-3,3,3,2,0,-3,2,-1,1,0,1,-2,0,2,-2,3,1,-1,0,-1,-1,4,1","US4: 3,1,-3,-1,-1,3,-3,-2,0,-4,-1,0,3,-2,-3,-4,-1,2,4,-2,4,1,1,-2,0,1,-1,2,0,2,1,2,0","JP5: -4,-1,3,-1,1,1,4,2,-4,4,2,0,-1,3,0,2,0,-2,-2,0,-1,2,1,-3,-3,-3,3,0,1,-2,1,-2,-1","CA6: 1,-3,0,3,3,4,-2,0,-2,-2,1,-1,1,0,-4,3,-1,0,1,-1,-2,-3,-1,-4,2,2,0,4,-1,2,1,2,-3","UK7: 2,0,-2,1,0,1,-1,-3,0,-1,1,-1,1,2,-4,4,3,2,0,2,-2,-1,-3,-4,3,-2,0,4,-3,1,-1,3,-2","US8: -2,2,0,-3,-4,4,0,-1,-1,-1,1,-1,1,-1,4,0,0,1,-3,1,2,2,3,3,-3,1,-4,3,0,-2,-2,-2,2","FR9: 3,1,0,1,-4,-3,2,2,-2,0,0,-2,1,4,-1,-2,2,-1,2,1,3,-3,-3,-2,1,0,-1,-4,0,-1,3,-1,4"],statementNumArray:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33],respondentNames:["US1","US2","US3","US4","JP5","CA6","UK7","US8","FR9"]}},Bp=function(e){var t=e.handleClick,n=e.buttonText,i=e.buttonColor;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("button",{id:"onWhiteGeneralButton",className:"btn text-black ".concat(i," rounded-md border border-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-700 focus:ring-opacity-70"),onClick:t,children:[(0,r.jsx)("svg",{className:"fill-current w-4 h-4 mr-2 rotate-180",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{d:"M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"})}),n]})})},jp=function(){var t=y(),n=t.isDataLoaded,i=t.setProjectName,o=t.setStatements,a=t.setQSortPattern,s=t.setNumStatements,l=t.setNumQsorts,u=t.setSortsDisplayText,c=t.setMainDataObject,d=t.setMultiplierArray,h=t.setStatementNumArray,f=t.setRespondentNames,p=t.setHasImportedSorts,v=t.setHasImportedStatements,g=t.setProjectHistoryArray,m=t.setIsDataLoaded,w=t.setShowInputErrorModal,b=Y((0,e.useState)("bg-gray-300"),2),C=b[0],S=b[1];return(0,r.jsx)("div",{children:(0,r.jsx)(Bp,{id:"lipsetButton",handleClick:function(e){if(n)w({showModal:!0,titleText:"Data Loading Error",bodyText:"Data are already loaded.",bodyText2:"Reload the webpage to start a new project."});else{var t=Gp();i("Lipset Demo"),o(wt(t.statements)),a(wt(t.qSortPattern)),s(t.numStatements),l(t.numQsorts),u(t.sortsDisplayText),c(t.mainDataObject),d(t.multiplierArray),h(t.statementNumArray),f(t.respondentNames),g(t.projectHistoryArray),p(!0),v(!0),S("bg-green-300"),m(!0)}},buttonText:"Load Lipset",buttonColor:C})})},Hp=function(){return(0,r.jsx)("div",{className:"mr-4",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center  items-center rounded-md bg-white h-[250px] w-[300px] p-3",children:[(0,r.jsx)("div",{className:"font-bold",children:"Lipset Demo Data"}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{className:"date",children:"33 statements"})}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{children:"9 Participants"})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(jp,{})})]})})};var Vp,Wp=function(){var e=function(e,t,n){var r=function(e,t){var n=[],r=[],i=2*t+10;return e.forEach((function(e){if(e.length){var t=e.slice(0,8);n.push(t);var o=e.slice(10,i);r.push(o)}})),[n,r]}(e,t),i=r[0],o=r[1],a=[];return o.forEach((function(e,r){var o={},s=function(e,t){var n,r,i=0,o=2,a=[],s=t;for(n=0;n<s;n++)r=+e.slice(i,o),a.push(r),i+=2,o+=2;return a}(e,t),l=bt(s,n);o.name=i[r],o.posShiftSort=l,o.rawSort=s,o.displaySort=s.toString(),a.push(o)})),[i,a]}(["01Edelst   1 0-1-2 0 2 3-4 1 1 5 1-2-3 0-5-1-2-1-3 0-1 2 4 2 0-2 1 2 3 0-4-1 4 3-3","02Larsen   3-1 0-2-1 1 0 0 0 1 0 2-3-2 1-2 0-1-3-4 4 2-1 1 3 2-1 1 3 4-2-4-3 5 2-5","03Rubins   5-1-5-2-2 1 2-1 4 0 0-1 1-1 3-3-4-4 0-3 1-3 0 1 3 4 0 0 1 2 2-2-2 3 2-1","04Werner  -1-2 0 1-1 2 2-2 3 3 2 4 3-3 1-2-3-5-1-2-4 2 0 4-1 0 0-1 1 5 0-4-3 1 1 0","05Smith    5-2-1-2-3 4-1 0 3 3 2 1-1-4 1-4-1-2-2-3 0 0 0 3 4 0-3 2 1 2 1-5-1 0 2 1","06Roseng   2-3 0 1-2 2 3-4 2 2-1 1 3-5-1-1 1-1-2-3 4-1-4 0 1 0 3 0 0 5-3-2 0 4 1-2","07Berger   4 1-1-4-1 3 2 0 0 5-3 2 0-3 2-2-1-1-1-5-4-2 4 1 1 3-3 0 2 1 3-2 0-2 1 0","08Barcus  -2-2-3-4-1 0 2 0 1 2 0 1 4-4-1-3-1-5 4-3 2 0 2 0 0 3 1 1 1 5-1-2-1 3 3-2","09Linn     1 3-1-4-2 0 2-3 4 5 3 1-2-2-1-1-3 0-2-4 2 1 4 0-1 2-1 0 0 2 3 0-5 1 1-3","10Pool     5-5 0-3 0 2 1 1 3 3-1 1-3-4 0-2 0-1-2-3-2-1 1-4 4 2-1 3 0 0 2-1 1 2 4-2","11Himmel   2-3 2 1-2-3 2 0 3 4 1 0 3-1 0-4-2-3-2-2 0-4 1 4 3 0-1-1 1 1 2-5-1 5 0-1","12Beinst   1-1-1-1-2 2 2-3 4 1 0 1 0-2 1-3 0-2 0-4 0-3-2 2 5 0-1 3 2 3 3-5-1 1 4-4","13Pisare  -2 0 5 1 2 0 2-2-3 1-5-2 2-3-2 2 3 4-1-1-1 3 0 0-3-1 4-1 1 0-4-4 1 3 1 0","14Maletz   3 1-4-2-2 4 0 2 3 3 2 0-1 1 4-2-3-1-1-4 0 1 0 5-5 1-1 0 2 1 2-3-2-1 0-3","15Nakaji   3-1-2 0 1 3 1 2 4 2 0-1 2 0 1-5-1-4-4-3-3 0-2-2-2 5 1 0 0 4 1-1-1 3 2-3","16Sicins   3-3-1 0 0 2 0-4 5 2-1-2-1-2 0 1 1-3-1-4-1 1 0-2 3 4 4 0 3 2 1-3-5 1 2-2","17Kato     2-1-4-3 0 2-1 1 2 4 3 1-1 1 2-2 0 0-5-3-1 0-2 1 5 3-2-1 1 3 4-4-2 0 0-3","18Lyle    -2 1 1 1 2 4 0-2 2 5 1 0 3-5 1-2-2-1-4-3-3 3-1 2-3 4-1 0 0 2 0-4-1 3 0-1","19Lerg     0 1-1 0 0 3 0-4 3 5 1 1-1 0 2-3-1-3-1-2-2-3 2 1 1 2-5-4 4 2 3 0-2-2 4-1","20Escarp   2-1 0 1 0 0-3-3-1 3-3 0 3-1 0-2-1-1 3-2 1 0 5 2 1 2-2 4 1 1-4-5 4-2 2-4","21Rahl     5-1-1 2-4 1 1 0 4 1 1 0 0-2 0-3-3 0 0-3-1-1 1-5 4 2-2 2 3 3 2-4-2-2 3-1","22Tanaka   0-5 3-4 0 2 3-2 1 2 0-4-2 0 1-3 1 1-3-3-1 0 2 0-1 3 1-2 5-1 4-1-1 4 2-2","23Goyer    1 2 0 0-4 4 3-2 1 4 0-1-2 0-3-1 2-2 1-4 2-3-1-1 1 5-1 3 1 3 0-5-2 0 2-3","24Uno     -3-1 1 2-1 0 0-1 4 2 2 0 3-2 2 1-1 0-3-4-3 1-5-2 0 5-2-1 4 1-2-4 1 3 3 0","25Mestro   2-3 1-3 2 2 1 0-1 3-1-5-2-2-1-2 0 0-1-4 1 4 0-2-1 4 2 1 1 3-3-4 0 5 3 0","26Kubin    1-5 1 2 3 3 2 3-3 1 1 0-3-4 1-2-1-4 2-3-2 2-1 0-2 0 4-1 0 5-1 0-1 4 0-2","27Campea   4 2 2-1-3 2 0-2-2 0 1 3-1-1-4-2-1 0-5-3-2 2 4 1 3 1 3 0-1 1-3-4 0 1 0 5","28McQuai   1 0-2-3-3 2-1-1 4 3 0 0-1 0 2-5-2-1 1-2-3-4 0 3 5 1 2 0 2 1 1-2-4 3 4-1","29Barbic   1-1 5-4 2 4 2 1-2 1 0 0-5-4 3-1-2 3-3-3-1 0 1 0-1 2 1-3-1 4 0-2-2 2 3 0","30Singh    0 2-1-2-2 5 2-4 2 0 3 4 1-3 0-1-1-2-1-5 3-2 0 1 3 1-1 0 2 4 0-3-3 1 1-4","31Brown   -1 3 5 4-2 0 1 2-1 2 1 1 0-3 2-4-3-2-3-2 0 3-5 3 0 4-2 0 0 2-1-1 1-1 1-4","32Dajani   0-3 3-4 4 1 1-1 3 2-2 0 0-3-1-2-2-1 0-5 2 1 1-1 2 4-1 0 1 5 3-4-3 2 0-2","33Berlo    5 1-3-2 0 3 0-1 3 3-1-5 1-2-2-4 1-1 0-2 2-4 0-1 4 2-3 1 2 2 1-3 0 0 4-1","34Koning   1 1-1 1 1 4 2-4 0 5-1 3 2-1-3 0 0-2-3-5-1 1-2-2 0 2 0 0 4 3-2-3-4 2 3-1","35Lazars   2-3 2 4-4 0 1-3 4 3 0 0 0-5-2-4-1 1 0-3 2-1-2-2-1 3 1 0 2 1 5-1-1 1 3-2","36Cherry   4-1-1-3-1 5 1 3 2 4 0 1 0 1-2-3-1-2-3-5 0 1 0 0 2 0-2 1 2 2-1-4-2 3 3-4","37Noelle   1-1 4-3-1 0 1 0 2 0-5-1 0-3 3-2 0 1 5-2 0 1-2 4 3 2-2 2 3-1-1-4-4 2 1-3","38WS1975   3 1-2 0-1 5 1-4 2 1 4 2 1-5 2-2-1-1 0-4 2-3-3-1 1 4-2 3-3 0 3-2 0 0 0-1"],36,-5),t=ft(e[1]);return{projectName:"KOC Demo",projectHistoryArray:["KOC project loaded from demo data"],statements:["ce-All information is imperfect                             01","be-Methdlgy can dehumanize people and turn them into numbers02","cd-Anything unknown at present will evntlly be known entrly 03","ad-Scientists' road to knwldg more prfct than philosophers' 04","bd-Reslts of proper scntfc experiments speak for themslvs   05","ce-Information exchanged only within a play of tolerance    06","ad-The scntst strives to delineate man, not just sketch him 07","cd-Science separates the world from our perception of it    08","be-Human error cannot be taken out of scientific observation09","ce-The world shifts under our gaze, interacting with us ... 10","ae-Who claims absolute knowledge opens the door to tragedy  11","ce-Ragamuffin, barefoot irreverence important for students  12","ad-A true scientist has an itch for absolute knowledge      13","bd-Philosophers' road to knwldg more perfect than observtn  14","be-Observations are still fuzzy and as uncertain as ever    15","bd-Scientific methdlgy results in unimpeachable conclusions 16","bd-Whenever instruments of sufficient precision are avlble..17","bd-Fundamental units of world will not long evade our methds18","bd-Certainty is achieved through observation, never infrnce 19","cd-Physical scnce has shown to be the only avenue to knwldg 20","be-One cannot xpct to find a better estimate than the avrge 21","ad-Error not inextricbly bound up with the scntst's knwldg  22","ae-Scientific knwldg is subjtv knwldg, scntst is respnsble  23","ae-Sctst claiming absolute knwldg is arrogant and dogmatical24","be-No event can be measured with certainty                  25","be-Scntfc mthd tribute to wht we can know thgh bng fallible 26","ad-One of scntsts' aim is exact picture of the material wrld27","ae-The scientist expects the world to be inexact            28","ce-New ideas in science amount to dffrnt views of reality   29","ae-Would-be scntst: not to worship the known but to qustn it30","ae-All jdgmnts product of indvdl scntst and at edge of error31","cd-Where people argue and contradict science cannot exist   32","ad-Scientist completes work by arrvng at a mathmticl formltn33","cd-Science progresses step by step by eliminating error     34","ce-Judgment is built into acts of recognition               35","cd-Only in science can we be crtn that what we know is true 36"],numQsorts:38,numStatements:36,multiplierArray:[0,1,2,3,4,5,6,5,4,3,2,1,0,0,0,0,0,0,0,0],mainDataObject:e[1],sortsDisplayText:t,respondentNames:e[0],qSortPattern:[-5,-4,-4,-3,-3,-3,-2,-2,-2,-2,-1,-1,-1,-1,-1,0,0,0,0,0,0,1,1,1,1,1,2,2,2,2,3,3,3,4,4,5],statementNumArray:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36]}},zp=function(){var t=y(),n=t.isDataLoaded,i=t.setProjectName,o=t.setStatements,a=t.setQSortPattern,s=t.setNumStatements,l=t.setNumQsorts,u=t.setSortsDisplayText,c=t.setMainDataObject,d=t.setMultiplierArray,h=t.setStatementNumArray,f=t.setRespondentNames,p=t.setHasImportedSorts,v=t.setProjectHistoryArray,g=t.setHasImportedStatements,m=t.setIsDataLoaded,w=t.setShowInputErrorModal,b=Wp(),C=Y((0,e.useState)("bg-gray-300"),2),S=C[0],E=C[1];return(0,r.jsx)("div",{children:(0,r.jsx)(Bp,{id:"kocButton",handleClick:function(){n?w({showModal:!0,titleText:"Data Loading Error",bodyText:"Data are already loaded.",bodyText2:"Reload the webpage to start a new project."}):(i("KOC Demo"),o(wt(b.statements)),a(wt(b.qSortPattern)),s(b.numStatements),l(b.numQsorts),u(b.sortsDisplayText),c(b.mainDataObject),d(b.multiplierArray),h(b.statementNumArray),f(b.respondentNames),v(b.projectHistoryArray),p(!0),g(!0),E("bg-green-300"),m(!0))},buttonText:"Load KOC",buttonColor:S})})},Up=function(){return(0,r.jsx)("div",{className:"mr-4",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center  items-center rounded-md bg-white h-[250px] w-[300px]",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-bold",children:"KOC Demo Data"}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{className:"date",children:"36 statements"})}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{children:" 38 Participants"})})]}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(zp,{})})]})})},Kp=function(e,t,n){for(var r=[],i=0;i<e.length;i++){var o=e[i].shift();r.push(o)}for(var a=[],s=0;s<e.length;s++){var l={},u=wt(e[s]),c=bt(u,n);l.name=r[s],l.posShiftSort=c,l.rawSort=e[s],l.displaySort=e[s].toString(),a.push(l)}return[r,a]},qp=function(){var e=Kp([["res-1",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-2",-3,5,5,-1,0,-2,0,4,-1,2,-5,-3,-2,4,5,-3,-4,1,1,3,4,-3,-4,-1,3,-4,-1,-2,-2,0,-2,-4,-4,-1,2,2,4,1,4,-5,0,2,-5,-3,1,-2,0,-3,0,3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-3",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-4",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-5",-3,5,5,-1,0,-2,0,4,2,-1,4,2,-5,-4,4,-4,-3,-2,-2,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-6",-3,5,5,-1,1,0,4,2,-3,-1,0,4,-2,-2,-2,-4,1,0,1,5,-5,-4,5,-1,-3,2,-4,1,3,1,2,3,4,-2,-3,-2,3,-3,2,3,-1,4,0,3,-2,-5,-2,0,-1,-1,-4,-1,4,2,-5,-2,1,-4,0,1,-3,0,1,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-7",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-8",-3,5,5,-1,2,1,2,0,4,-1,-5,2,0,-3,1,-1,-4,-2,0,2,2,1,1,3,-5,0,-1,4,3,4,0,4,5,3,-3,-4,-4,-3,-2,4,1,0,-3,-2,-2,-4,-2,2,-1,4,-2,-2,2,-3,-1,-1,0,0,-3,1,-1,5,3,3,1,2,1,1,-2,-5,-4,0,3,-5,0,3,-5,5,-4,-1],["res-9",-3,5,5,-1,0,-2,0,4,2,-1,-1,-1,-2,5,-1,5,1,1,3,1,0,1,-5,0,3,-3,4,-4,2,-3,-3,-2,3,4,1,-3,0,2,1,3,-5,0,2,3,1,-1,0,-2,4,-1,-4,-2,-4,-4,-2,2,-2,1,4,-2,-5,-3,-4,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-10",-3,5,5,-1,0,-2,-4,-2,2,-3,1,-2,-4,-5,5,3,2,3,0,-2,5,1,4,-2,-3,-5,-1,-3,0,3,-2,-3,4,0,1,1,0,-1,1,3,1,-4,4,-1,3,1,3,-3,2,-2,0,2,-1,-2,-5,-4,-1,1,-1,2,0,4,4,-4,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-11",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-12",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,3,5,-5,0,-1,-2,1,-3,3,0,-2,-3,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-13",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,0,1,-4,4,-4,4,-3,1,0,-1,-2,-3,4,-1,2,-4,-4,-5,0,-3,-4,-3,-2,0,1,3,1,2,3,3,1,-3,5,-2,-1,-5,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-14",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-15",-3,5,5,0,0,-1,-4,-1,-1,-3,-4,-2,3,-2,4,1,2,-2,-4,-3,-3,-4,4,-2,2,0,1,-1,-2,3,4,2,-4,1,-5,5,1,1,1,-2,-2,-1,-3,1,3,-3,5,3,1,-1,0,2,2,0,-5,-5,0,0,4,4,-1,-2,3,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-16",-3,5,4,1,-1,-4,-3,-1,1,5,3,-5,4,3,1,4,-3,-4,-2,3,-1,-3,2,-2,2,5,2,0,-4,4,0,4,0,-2,-4,2,4,3,-1,2,3,-5,-2,-1,0,-2,2,1,-1,0,1,-3,-3,0,-1,5,-2,0,-5,3,0,0,0,-5,-2,2,5,-1,1,-2,1,-4,-5,1,2,-3,1,3,-4,-1],["res-17",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,-1,4,1,1,0,3,0,4,-2,-4,-5,1,0,1,2,-2,3,-4,-5,0,2,-3,3,5,-1,-1,-3,-3,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-18",-3,-5,-2,-1,2,-2,0,2,5,4,0,4,-1,-2,5,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-19",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-20",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-21",-3,-4,4,-4,0,-1,5,4,-2,-2,2,-4,-5,-2,4,4,2,5,0,-3,2,-1,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-22",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-1,0,1,-2,-3,1,4,-1,-4,0,4,5,-3,2,0,1,-5,-5,-3,3,-3,3,1,-2,-1,-2,-2,0,-4,-4,1,-3,-4,3,-4,2,4,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-23",-3,5,5,-1,0,-2,0,4,1,1,-2,4,-3,-4,-2,-2,2,-4,4,-5,-2,2,-4,-1,4,0,-4,0,1,-2,1,3,-2,-2,1,-5,0,2,0,-1,-1,0,-3,3,-3,2,-4,1,3,5,1,-3,4,-5,-3,-1,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-24",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,-3,-2,-1,2,1,5,1,0,-5,0,-2,-3,1,-5,-3,4,0,-4,1,1,-1,-1,1,3,-2,3,0,3,-3,-2,1,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-25",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,4,-3,-2,-4,-4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-26",-3,5,5,-2,-4,3,4,-3,3,-1,3,1,-1,4,2,-2,0,0,-2,-4,0,-2,1,0,-1,-3,1,-3,0,-2,-2,3,-4,1,2,-2,-1,-1,4,2,2,0,4,-1,1,-3,5,-3,-5,-1,3,3,5,2,1,-4,1,1,-4,-1,-5,-5,-5,-2,4,0,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-27",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,0,1,0,-1,2,-1,-3,3,3,0,-4,-5,-1,0,-3,-2,-3,-5,3,1,1,-2,5,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-28",-3,2,4,1,3,2,0,0,-2,1,1,0,1,-2,0,-2,-2,1,-2,5,5,5,0,-3,2,2,5,-2,-2,1,-1,1,-5,-4,4,1,2,3,3,-1,4,-1,-5,0,-5,0,5,-1,-4,-1,-5,-4,-1,4,2,-3,-3,2,3,3,-1,-4,4,3,-5,-3,-2,0,-3,-4,2,0,1,3,0,-3,-1,4,-4,-1],["res-29",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,5,-1,1,-2,-5,-2,1,5,4,1,3,1,0,3,0,0,3,3,1,-2,1,-4,0,2,4,1,-1,-3,-3,2,-3,-2,0,4,1,-5,-4,-3,-4,-1,-1,3,-2,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-30",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,1,3,1,-4,-2,3,-2,0,3,-1,1,0,-1,-3,0,1,-5,-3,1,-3,4,5,0,1,2,4,-3,-1,-2,-5,-4,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-31",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-4,1,-1,-4,2,0,-5,4,1,-5,2,-4,0,4,1,0,-3,-1,3,-3,-4,-1,-2,-2,5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-32",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,1,0,3,1,-3,0,-1,-1,1,-2,-4,-3,3,-2,1,2,-5,1,3,1,-1,3,-1,-4,0,-2,0,4,1,5,4,5,3,-2,0,-3,-3,-5,-4,-2,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-33",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-34",-3,5,5,-1,0,-2,-2,3,-1,2,-4,-1,-2,0,-1,-2,1,-5,2,-3,3,2,-5,-3,4,-1,1,-4,2,3,-2,-3,5,1,-2,3,1,-1,1,-3,-4,0,1,4,-3,2,-5,4,4,3,-2,0,1,-2,0,-3,2,-5,1,4,0,-4,-1,0,-1,3,5,-4,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-35",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,5,-2,-5,0,1,0,-5,-2,1,-3,0,0,3,-3,3,-1,-1,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-36",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,-2,-3,0,1,-2,2,-5,4,-1,0,-4,-4,-2,1,-4,-2,-4,-1,1,-2,3,0,-4,-2,-1,1,-1,0,5,3,1,0,2,-3,-5,2,3,1,-3,-3,-2,4,3,-3,3,4,1,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-37",-3,5,5,-1,0,-2,0,4,-1,2,0,-3,-2,2,-1,4,-2,-4,2,-4,-3,-4,2,-4,1,4,4,-5,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-38",-3,5,5,-1,4,-1,-4,-2,1,-3,-3,-4,-3,0,-2,-4,0,-5,2,3,2,-3,1,-5,-1,-2,-2,-4,-1,4,2,3,0,-2,5,-1,0,1,-4,0,-2,1,1,-2,0,-1,-2,3,2,3,0,4,3,-3,1,4,4,-5,1,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-39",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,5,2,-1,1,5,-1,-1,1,2,-1,-4,-5,-2,-3,3,-1,4,0,1,-3,0,3,1,-4,-2,1,-2,-2,-3,1,4,-2,-4,0,0,3,1,-4,1,-5,3,-4,-3,-3,2,3,0,4,-2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-40",-3,5,5,-1,0,-2,0,4,-1,2,-5,1,1,3,-1,1,-3,3,2,0,4,-2,2,4,0,-1,2,2,-4,-5,1,-1,4,0,-3,-4,-4,3,3,-1,4,-2,5,-1,-3,-4,0,-3,-2,3,-2,-2,2,3,-1,5,-5,-3,-5,1,-2,1,0,1,1,-4,-2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-41",1,1,3,-1,1,2,3,-4,5,1,1,1,4,-4,4,-2,-1,-5,-2,-4,-2,-1,0,-3,2,5,-3,-3,-2,1,-1,-2,0,-5,-1,3,-3,2,4,-2,-5,-3,2,5,1,-4,5,0,-2,-4,2,1,-2,0,0,0,0,0,4,-3,-5,-1,-1,3,-1,3,4,2,3,0,-3,4,2,2,0,3,-5,5,-4,-1],["res-42",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,3,-2,2,-1,-2,1,5,-1,-2,0,-3,1,0,-5,1,-4,-2,-5,-3,-4,4,2,-1,0,1,1,3,-3,1,3,-3,0,4,4,0,-4,-2,1,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-43",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,5,3,0,-5,-2,-1,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-44",-3,5,5,-1,-2,2,4,-2,0,2,2,-4,-1,-4,0,-3,4,4,1,-2,-1,-4,-4,2,-3,-5,4,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-45",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-4,1,1,-1,0,4,0,-5,0,-2,2,1,3,-3,-4,1,4,0,-3,2,-2,1,-4,3,4,-5,-4,3,1,-1,5,-2,-2,-3,-3,-4,-1,-2,-3,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-46",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,5,-2,0,-1,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-47",-3,5,5,-1,0,-2,0,4,-1,2,-5,3,5,-1,-2,1,1,-2,2,-4,2,0,4,0,3,-4,1,1,4,4,1,-1,0,2,-4,-2,-5,-2,-4,-5,1,0,0,-1,-3,-2,4,-3,-3,3,-2,-3,-2,-4,1,-3,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-48",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,-4,0,0,1,2,1,0,1,-2,3,4,1,-2,1,-3,3,-1,3,0,3,-3,-2,0,5,-1,1,-5,-3,-3,-2,-2,-1,1,-5,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-49",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-50",3,-1,-2,2,3,-4,5,0,3,-2,-3,-1,4,-4,-2,2,-1,2,-4,-3,3,5,-5,-1,-3,-2,0,1,-3,1,1,-2,2,1,-3,4,-5,-2,-5,0,-1,0,-3,-1,0,1,4,-1,3,2,3,-2,-1,0,0,-5,4,2,0,1,1,2,-4,3,5,0,-3,5,-2,0,-4,1,5,-5,2,1,4,-4,4,-1],["res-51",-3,5,5,-1,0,-2,0,-1,-3,4,2,2,-4,-5,-2,-4,4,-2,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-52",-3,5,-3,-1,-1,-3,0,0,-5,-4,0,-1,-3,4,3,-5,2,5,1,-2,5,2,3,1,-2,1,3,-2,5,1,2,-1,-3,4,0,3,2,3,-2,1,-2,-1,-2,0,2,-2,-4,-4,1,5,1,-5,4,3,-3,4,4,1,-1,-4,-4,-2,3,0,-1,-5,-3,0,2,0,2,1,0,0,-1,4,2,-5,-4,-1],["res-53",-3,5,5,-1,3,-4,-3,1,-2,5,4,1,-2,4,1,1,3,-2,-3,3,0,2,-2,2,-2,3,-3,3,4,-1,0,-2,3,0,0,5,1,-3,-1,0,-5,1,1,-1,2,-1,2,0,-5,-4,-4,-1,-4,-4,4,-5,-2,-5,4,1,0,-3,2,2,-3,-2,-1,-1,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-54",-3,5,5,-1,0,-2,0,4,-1,2,-5,-2,4,2,-4,1,-1,-1,-4,1,4,-4,-2,3,-3,-1,1,-3,4,-5,2,2,-4,0,0,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-55",-3,5,5,-1,-1,1,0,-3,-1,0,0,-5,-4,1,-1,1,4,1,3,4,3,1,1,-3,-2,-5,-1,4,3,-5,0,-2,0,-3,4,1,5,2,-4,3,-1,2,-5,3,2,-2,-2,-2,2,0,1,-2,-3,-4,2,-2,-1,-4,3,4,0,0,-2,-3,-1,5,0,2,-3,-4,1,4,2,2,0,3,-5,5,-4,-1],["res-56",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-57",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-3,1,1,5,1,-4,-3,3,-1,0,0,3,-2,-5,5,-2,2,0,-4,1,2,0,4,1,-1,-2,-2,3,1,-1,1,-3,-3,-1,-5,4,-4,-1,-4,3,0,4,1,3,-2,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-58",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-59",-3,5,5,-1,0,-3,-3,-1,-3,5,-2,3,1,-5,1,3,-3,0,4,2,0,-5,-5,-1,-4,2,0,4,5,0,-2,1,-4,0,-2,-5,4,3,0,-1,1,-2,-1,3,-2,4,-2,1,1,2,3,-4,2,2,-3,0,4,-3,1,3,-1,-2,-1,-2,1,2,-1,-4,0,2,2,4,1,-4,0,3,-5,5,-4,-1],["res-60",-3,5,5,-1,0,-2,0,4,-1,2,0,-2,-4,-5,-4,2,4,1,-3,-2,0,-1,-2,1,0,-2,4,-4,-4,1,5,2,-5,4,-1,3,-3,-5,2,-1,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-61",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,-3,4,-1,-4,0,1,0,-5,4,3,1,3,-3,5,-2,-5,-3,3,-2,0,-1,1,0,2,-1,1,-2,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-62",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,-4,-2,-4,4,4,2,2,-4,2,-4,-2,-3,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-63",-2,2,-5,-1,-5,2,1,-1,3,3,-4,0,0,-4,0,5,-3,3,5,2,-2,3,4,-2,4,-2,-3,-5,3,-3,4,-5,-2,2,-4,3,1,0,2,-4,5,4,0,-2,-3,0,0,2,-4,-5,0,0,1,4,1,2,3,-4,-2,-1,-3,-3,1,1,1,2,5,0,-1,-1,1,-1,-1,4,-1,-3,1,-1,5,-2],["res-64",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,2,-2,4,4,0,-4,0,-3,1,-5,-5,-1,5,-4,-1,1,1,3,2,0,-1,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-65",-3,5,5,0,-5,4,3,-4,4,-3,0,-3,-2,-1,0,4,-1,-2,-3,-3,5,4,-3,-1,0,2,0,0,2,-1,-1,3,-4,-5,0,3,-2,-2,3,-3,-4,1,-5,-4,4,-1,0,1,1,1,-1,2,1,0,2,-4,-1,-5,2,5,1,4,1,2,1,1,-2,3,2,-2,-2,3,-2,2,0,3,-5,5,-4,-1],["res-66",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-67",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,3,-3,-2,-3,5,0,-2,0,-5,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-68",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,1,1,-5,1,1,1,-3,3,3,0,-3,-1,-3,0,-4,5,1,-2,1,-5,-2,0,-4,3,2,2,4,-4,-1,-2,3,-4,5,3,4,-2,0,-2,-1,-3,-2,-3,-1,4,-4,0,1,-2,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-69",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,4,-4,2,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-70",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-71",-3,5,5,-1,0,-2,0,0,0,-3,4,-4,2,-5,-3,-1,0,4,-2,1,1,-4,-5,3,-4,1,-2,-1,0,1,-3,2,-1,-2,-3,1,3,-2,2,-1,1,-5,-5,-4,-2,2,3,4,-2,-1,3,4,-1,0,3,5,1,-1,-4,4,-3,-2,3,2,0,1,5,2,-3,0,1,4,2,2,0,3,-5,5,-4,-1],["res-72",2,1,0,0,4,-2,-3,2,1,-3,-1,-1,0,1,-4,0,1,2,-4,-2,0,-2,-1,-1,2,4,1,3,-1,-3,-5,-3,-1,-4,-2,-2,3,0,-4,5,5,3,0,3,-1,5,4,-2,-3,3,0,4,1,3,-2,2,1,1,4,3,1,2,-4,-1,-5,0,-5,-5,-2,5,0,4,2,2,-3,-3,-5,5,-4,-1],["res-73",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,-4,0,4,-1,-1,-4,-2,0,2,-3,3,1,3,-3,-2,1,5,4,-2,1,1,3,-5,0,1,0,-1,1,-3,-5,-3,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-74",-3,5,5,-1,4,2,0,-1,-3,2,4,1,-2,1,-2,-2,-5,0,2,-3,-1,-5,-4,3,-4,-4,-5,-3,4,4,-2,0,-1,-4,1,-2,-1,5,-3,0,0,2,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-75",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-76",-3,5,5,-1,0,-2,0,-2,-4,2,-4,1,-3,-5,0,-1,-1,1,-1,5,-2,1,-3,1,0,-4,4,2,-2,-3,-4,1,-3,2,1,-1,-2,-1,5,3,-2,0,1,2,0,4,-4,0,-3,4,-1,-1,-2,-3,2,1,1,3,0,0,3,3,4,-5,3,3,4,-2,2,-5,-5,4,2,2,0,3,-5,5,-4,-1],["res-77",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-78",5,-3,0,-2,2,-4,-4,5,2,3,1,1,3,4,2,3,5,-3,1,-1,-3,2,-1,-1,2,-1,-4,-5,0,2,0,0,-4,-1,4,1,4,-2,-4,-3,-2,-2,-2,-1,2,-5,0,2,-4,-1,5,1,4,-5,-5,-2,-3,5,-1,-3,0,1,-2,3,1,0,0,1,-2,4,-3,0,4,1,3,0,3,-1,3,-5],["res-79",-3,5,-1,-2,-2,0,2,-5,-1,-3,5,1,4,-4,1,-2,2,2,-3,-4,3,1,2,-5,-4,-1,-2,3,3,-3,0,4,-5,-2,1,1,-3,-1,-1,0,-2,-2,4,-3,5,1,-4,3,1,4,0,4,0,-4,-1,3,0,1,3,5,2,-1,-2,-1,0,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-80",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-81",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,-3,-5,0,-2,5,-2,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-82",-3,5,5,-1,-1,-3,-3,-1,-4,4,4,4,3,1,1,0,1,4,-2,0,-3,-5,3,3,1,0,-2,-2,-2,0,-1,-5,0,3,-2,-1,-1,-3,-4,-3,-2,2,-5,-1,1,1,0,1,-4,4,1,-2,0,-4,5,2,5,3,2,-4,-2,3,2,2,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-83",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-84",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-85",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-86",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-5,3,-2,0,-1,0,5,-3,1,-1,0,0,3,-2,1,-3,-3,-1,-5,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-87",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,4,-1,-2,-5,1,-4,4,1,-3,-1,3,0,1,-2,-4,-3,-1,-2,2,-3,3,0,2,0,5,-4,1,0,3,-3,-4,1,4,-5,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-88",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,0,-2,0,3,0,1,-1,1,-1,-2,1,5,-3,-5,-3,-1,-5,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-89",-3,5,5,-2,4,-4,-3,-1,-5,-2,2,-4,-4,-1,0,2,0,4,-2,2,4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-90",-3,5,5,-1,0,-2,0,4,-1,-1,-4,-3,3,-1,0,1,5,0,4,-4,-3,-2,4,-5,-2,2,4,2,-4,2,1,1,-3,4,1,-2,2,-5,1,3,-3,-3,0,0,-2,-4,3,1,-4,1,-2,-2,-1,-5,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-91",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-3,1,-4,-2,-1,-1,3,-3,-1,-2,5,1,3,-2,-3,4,1,-2,0,-2,3,4,-1,-4,0,4,-4,1,-5,1,-5,-4,1,2,1,0,3,-3,-4,0,5,-2,3,-3,-1,0,2,1,3,-1,2,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-92",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,3,3,1,1,-4,-2,4,0,3,-3,-2,5,-3,-2,4,1,3,-5,-2,1,1,4,-1,2,3,0,1,-3,2,1,-1,-4,-5,0,-1,-1,-4,-3,0,0,-2,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-93",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,-1,0,0,0,1,-3,-1,-2,-1,1,1,-5,3,2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-94",-3,5,5,-1,-4,5,4,1,1,3,-2,2,1,-5,-2,-5,1,-4,-5,-4,-3,3,0,5,1,1,-1,-1,2,2,4,3,-2,0,-2,-2,2,-1,-5,-3,1,4,1,-3,2,-1,-1,3,0,3,3,0,-2,0,-2,0,-4,4,0,-2,0,2,4,0,-1,-3,-3,4,-4,-1,-3,1,2,2,0,3,-5,5,-4,-1],["res-95",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-96",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,1,1,4,0,-1,-3,-2,3,-5,-3,5,-3,-4,-1,-1,1,-5,0,2,0,2,-4,-2,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-97",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,3,0,-3,-3,0,3,-2,-5,1,1,1,-1,-4,4,2,1,-3,3,-1,-2,-2,0,0,-4,4,-4,1,-5,5,-3,0,1,-2,-1,1,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-98",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-3,-1,0,-5,5,-2,1,-4,3,0,-2,0,4,-5,2,3,1,4,-4,-4,4,-4,1,-1,-3,0,3,-2,1,2,-4,-1,-2,-3,-3,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-99",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,0,-1,-3,0,-2,3,-2,-5,-5,-2,3,1,5,-3,3,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-100",-3,5,5,-1,-3,-1,0,0,1,-1,2,1,2,3,2,1,-4,4,-2,-2,4,-3,0,0,3,3,3,-1,0,-2,1,2,-2,1,-5,-5,-4,-1,4,-4,-3,-2,0,-2,5,3,-1,-2,0,-3,5,-4,-1,-2,-4,4,1,-5,1,2,4,1,-3,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-101",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-3,4,2,-3,4,-5,-4,1,-2,-4,-1,3,-4,0,-3,0,2,-1,0,5,-5,-1,1,1,0,-3,-4,-2,-2,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-102",-3,5,5,-1,2,-3,3,-5,0,4,0,1,-3,1,1,3,3,-3,-4,5,-4,1,-5,2,-2,4,4,1,-1,0,-1,-4,-2,5,0,0,2,1,-1,-2,3,-1,-4,4,-4,-5,-2,2,3,0,1,1,-2,-3,-1,-2,3,-1,4,0,-2,-3,-2,2,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-103",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,-4,3,0,-3,-2,2,1,-1,0,-1,5,3,-2,-4,0,-2,0,-4,-3,3,-2,-2,1,1,4,1,1,-3,1,-3,-5,2,1,0,-5,4,-1,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-104",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-105",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,2,-4,-4,1,2,4,-2,-1,1,0,-4,-3,-5,0,4,1,-1,3,-1,-4,0,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-106",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,0,-1,-5,5,3,1,1,-2,0,0,0,1,2,1,-2,-2,3,4,-3,-2,-3,-3,-1,-5,1,-1,3,-4,0,1,-3,1,-4,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-107",-3,5,-2,-2,0,4,3,-2,-4,4,-1,-2,0,-4,3,-3,2,2,-1,0,3,-1,1,2,1,3,3,-5,3,0,-2,1,0,-2,1,-3,-2,2,0,-4,-1,-5,4,-3,1,5,0,-5,-1,-3,-1,1,1,-4,-4,5,5,0,-1,1,2,-3,2,0,4,-2,-3,4,-1,-5,1,4,2,2,0,3,-5,5,-4,-1],["res-108",-3,3,-3,-3,3,5,1,0,-1,-1,-4,4,-3,-4,3,0,5,-1,2,-2,5,-1,-5,0,4,-3,-1,0,1,-2,-5,-1,2,1,1,0,-5,2,-4,2,4,3,-2,-4,4,0,-2,-1,-5,3,-1,5,-4,0,1,1,2,0,2,-3,5,-2,3,-2,2,-5,0,1,-3,-4,0,-2,1,4,4,-2,1,3,2,-1],["res-109",-3,-5,4,1,-4,1,0,-3,5,-1,-5,3,1,-3,0,-2,-2,5,1,3,0,-2,-3,-4,0,-3,2,2,-1,1,-3,5,1,5,-1,3,-1,-1,-2,0,-2,4,-5,0,-4,4,-5,-4,2,-2,4,3,-1,-4,4,3,2,-3,0,-2,-2,-1,0,3,0,1,-1,2,2,1,1,4,2,2,0,3,-5,5,-4,-1],["res-110",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-2,-3,2,4,-2,1,1,0,1,3,3,0,0,-5,-3,-3,1,-4,1,0,-3,1,-4,1,4,3,-2,-5,-4,-2,5,-1,-1,0,-1,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-111",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-112",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,-2,5,-5,-2,3,3,-5,-3,-2,-4,0,1,-3,-1,1,3,0,4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-113",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-114",-3,1,0,-1,-5,-2,-2,2,5,-3,4,-3,1,3,0,4,0,4,-3,1,5,1,-5,-1,-5,-4,1,2,0,0,-4,-1,0,5,-2,-4,0,-2,-3,2,-3,2,-5,1,0,1,-1,-1,-2,-3,-1,4,2,3,1,2,-1,3,5,4,-4,-4,1,0,-2,-2,3,3,3,-2,-1,4,2,2,0,3,-5,5,-4,-1],["res-115",-3,5,5,-1,0,-2,0,-4,4,1,3,1,-1,-4,0,1,3,-3,5,1,2,-1,-3,-1,-3,-2,0,-3,-4,-2,-5,2,5,4,2,-2,-1,-2,-4,1,4,3,-2,-1,1,-5,0,-3,-4,-2,3,-2,4,3,2,0,-5,1,4,0,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-116",-3,5,5,-1,0,-2,0,4,-1,2,-2,-4,4,4,-5,-3,2,-4,-2,4,2,-4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-117",-2,3,5,-5,5,2,0,-3,0,-3,-2,0,3,-4,-2,-2,-3,-5,1,3,0,2,-4,-4,-1,4,-5,4,3,0,0,1,0,1,2,5,2,2,-4,-5,3,3,-4,3,-5,-2,1,-1,1,1,4,2,-3,1,4,-1,4,-1,0,-3,2,-1,-2,-1,-3,-1,-2,-3,1,2,4,0,0,-2,-1,5,-1,-4,1,5],["res-118",-3,5,5,-1,0,-2,0,4,-1,-4,2,-3,4,-2,2,-5,-2,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-119",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,4,4,1,-3,1,1,-1,-1,1,-4,5,-3,1,2,-4,-5,-4,0,4,-3,2,0,-4,-4,0,-3,-2,3,-2,3,0,-3,1,-2,-5,3,-1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1],["res-120",-3,5,5,-1,0,-2,0,4,-1,2,-5,4,2,-2,-2,-3,-4,-4,4,2,-4,4,-4,2,1,-1,-3,0,1,0,-1,1,-5,3,-1,0,-2,5,-5,-2,-3,-3,0,3,3,1,-2,4,-4,-3,1,1,1,-2,0,-2,3,-1,3,5,1,-1,2,3,-1,-5,2,-3,0,0,1,4,2,2,0,3,-5,5,-4,-1]],80,-5),t=ft(e[1]);return{projectName:"Motivational",projectHistoryArray:["Motivational project loaded from demo data"],statements:["In times of stress, be bold and valiant","Do not play for safety; it is the most dangerous thing in the world","People are always blaming their circumstances for what they are","I do not believe in circumstances","The people who get on in this world are the people who get up and look for the circumstances they want, and, if they cannot find them, make them","Every man takes the limits of his own field of vision, for the limits of the world","Never be bullied into silence","Never allow yourself to be made a victim","Accept no ones definition of your life, but define yourself","Have no fear of perfection you will never reach it","The Universe Law is impartial","It will give you anything you believe","It will throw you garbage or roses depending on the energy you put in","You are the one in charge, and you must accept that and stand alone","Never be bullied into silence","Never allow yourself to be made a victim","Accept no ones definition of your life, but define yourself","If you are not afraid to face the music, you may someday lead the band","Do not tell me this a difficult problem","If it were not difficult it would not be a problem","Some people walk in the rain, others just get wet","Always do your best","The rich substance of the Universe is yours to do with as you wish","Why settle for so little in life when you can have so much, just be daring to be different in your thinking","Energy and persistence conquer all things","It is by what we ourselves have done, and not by what others have done for us, that we shall be remembered in after ages","To avoid criticism, do nothing, say nothing, be nothing","We achieve a sense of self from what we do for ourselves and how we develop our capacities","If all your efforts have gone into developing others, you are bound to feel empty","You cannot cross a chasm in two small jumps","First we will be best, and then we will be first","Normal is not something to aspire to, it is something to get away from","The grass is not, in fact, always greener on the other side of the fence","No, not at all","Fences have nothing to do with it","The grass is greenest where it is watered","When crossing over fences, carry water with you and tend the grass wherever you may be","Make the most of today","He who has begun his task has half done it","We can try to avoid making choices by doing nothing, but even that is a decision","There is a time for departure even when there is no certain place to go","When one door closes another opens","Expect that new door to reveal even greater wonders and glories and surprises","Feel yourself grow with every experience","And look for the reason for it In the long run, men hit only what they aim at","Therefore, they had better aim at something high","Make the most of today","Translate your good intentions into actual deeds","He who has begun his task has half done it","Do not be afraid to take big steps","You cannot cross a chasm in two small jumps","Some people have greatness thrust upon them","Very few have excellence thrust upon them","Make the most of today","Translate your good intentions into actual deeds","There is a time for departure even when there is no certain place to go","Every man takes the limits of his own field of vision, for the limits of the world","Men who try to do something and fail are infinitely better off than those who try to do nothing and succeed","Don't Sweat the Small Stuff, and it's All Small Stuff","Quit now, you will never make it","If you disregard this advice, you will be halfway there","The Universe Law is impartial","It will give you anything you believe","It will throw you garbage or roses depending on the energy you put in","You are the one in charge, and you must accept that and stand alone","If you think God is coming down to fix things for you, forget it, God is out playing golf","Never be bullied into silence","Never allow yourself to be made a victim","Accept no ones definition of your life, but define yourself","Remember, a dead fish can float downstream, but it takes a live one to swim upstream","Nurture your mind with great thoughts, for you will never go any higher than you think","Once you make the fundamental choice to be the predominant creative force in your life, any approach you choose to take for your own growth and development can work","Self-image sets the boundaries of individual accomplishment","Believing is one thing, doing another","Many talk like the sea but their lives are stagnant marshes","Self-image sets the boundaries of individual accomplishment","People are not remembered by how few times they fail but by how often they succeed","Every wrong step is another step forward","If you are not fired with enthusiasm, you will be fired with enthusiasm","Argue for your limitations, and sure enough, they are yours"],numQsorts:120,numStatements:80,multiplierArray:[0,5,6,7,8,9,10,9,8,7,6,5,0,0,0,0,0,0,0,0],mainDataObject:e[1],sortsDisplayText:t,respondentNames:e[0],qSortPattern:[-5,-5,-5,-5,-5,-4,-4,-4,-4,-4,-4,-3,-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5],statementNumArray:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80]}},Xp=function(){var t=y(),n=t.isDataLoaded,i=t.setProjectName,o=t.setStatements,a=t.setQSortPattern,s=t.setNumStatements,l=t.setNumQsorts,u=t.setSortsDisplayText,c=t.setMainDataObject,d=t.setMultiplierArray,h=t.setStatementNumArray,f=t.setRespondentNames,p=t.setHasImportedSorts,v=t.setProjectHistoryArray,g=t.setHasImportedStatements,m=t.setIsDataLoaded,w=t.setShowInputErrorModal,b=Y((0,e.useState)("bg-gray-300"),2),C=b[0],S=b[1],E=qp();return(0,r.jsx)("div",{children:(0,r.jsx)(Bp,{id:"motivationalButton",handleClick:function(){n?w({showModal:!0,titleText:"Data Loading Error",bodyText:"Data are already loaded.",bodyText2:"Reload the webpage to start a new project."}):(i("Motivation Demo"),o(wt(E.statements)),a(wt(E.qSortPattern)),s(E.numStatements),l(E.numQsorts),u(E.sortsDisplayText),c(E.mainDataObject),d(E.multiplierArray),h(E.statementNumArray),v(E.projectHistoryArray),f(E.respondentNames),p(!0),g(!0),S("bg-green-300"),m(!0))},buttonText:"Load Motivation",buttonColor:C})})},Yp=function(){return(0,r.jsx)("div",{className:"mr-4",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center  items-center rounded-md bg-white h-[200px] w-[300px] p-3 h-[250px]",children:[(0,r.jsx)("div",{className:"font-bold",children:"Motivational"}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{className:"",children:"80 statements"})}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{children:" 120 Participants "})}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)(Xp,{})," "]})]})})},Qp=function(){var e=Kp([["res-1",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,4,-2,-3,0,4,3,-2,1,-4,0,-1,0,-2,4,3,3,3,-3,-1,1,5,3,4,0,-1,2,1,0,-1,2,2,-4,1,1,1,-2,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-2",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,4,1,-1,-3,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-3",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,1,0,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-4",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-5",5,-3,-3,1,2,4,0,4,1,-5,1,-1,0,-1,-3,-4,4,-5,3,2,-3,0,-4,-4,4,3,1,-2,3,-2,-1,2,1,-2,1,1,2,3,-1,5,-5,0,-1,-2,2,4,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-6",5,-3,-3,1,2,1,4,-3,-5,-4,-1,-1,-4,-5,0,2,4,1,-3,5,-2,0,0,3,1,-1,-1,-2,4,0,1,1,3,4,2,2,-4,3,-5,4,-2,3,-2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-7",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,3,1,0,-3,3,0,-1,3,3,-4,4,-2,4,-2,1,4,4,-3,-1,2,1,-4,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-8",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,2,4,4,1,3,1,-2,1,0,0,1,3,3,-1,-3,1,4,0,-3,-4,-1,5,2,3,-2,-1,1,4,-4,-2,0,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-9",5,-3,-3,-4,4,-5,4,-1,4,-3,-5,5,0,-1,4,1,1,-5,3,3,-2,-1,0,2,4,-4,2,2,1,1,-2,-2,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-10",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,3,4,1,4,-1,-1,1,3,0,-1,3,-3,3,0,-4,1,4,4,-4,-3,-2,0,-2,0,5,1,2,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-11",5,-3,-3,1,2,4,-5,0,-1,0,0,-2,4,4,-3,-2,3,1,2,-4,-4,3,1,1,-1,-3,3,-2,4,2,-1,3,-1,2,-5,-4,1,0,1,5,-2,-5,4,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-12",5,-3,4,0,3,2,-4,-1,0,-4,0,1,-3,-5,0,-1,-4,1,1,-2,3,-5,0,-2,2,2,3,3,-5,4,4,1,-2,-1,-1,-1,1,0,-3,-2,1,-1,5,0,-1,4,5,1,2,-3,2,-4,3,4,-4,-2,-3,-5,0,5],["res-13",5,-3,-3,1,2,-1,-4,2,0,-5,4,3,-4,-2,-5,1,-3,0,4,-2,4,2,-5,1,-1,-4,-2,-1,1,-1,4,3,4,5,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-14",5,-3,-3,1,2,4,-5,1,1,-1,-4,2,1,1,3,3,0,3,-3,-2,-4,5,2,-1,0,-2,-3,4,0,1,4,3,-1,1,3,4,-5,2,2,-1,-2,-2,-4,-5,-1,4,0,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-15",5,-3,-3,1,2,4,-4,1,0,0,1,1,3,-2,1,3,-2,0,4,3,2,1,-5,2,-1,3,1,-5,4,-1,-2,-1,0,-3,2,-1,5,2,4,-4,-1,-2,-3,4,3,0,-4,-5,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-16",-2,0,3,-1,-1,-4,-3,2,2,0,-5,4,5,4,4,4,-5,-1,1,-2,-3,-5,4,1,1,2,5,1,-2,-3,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-17",5,-3,-3,1,2,4,-5,-5,-4,4,3,1,-4,1,0,0,1,-1,-2,3,-3,-5,1,-4,0,-2,-1,5,-3,-1,-1,0,-1,0,-2,-2,2,5,1,4,4,3,-4,0,4,2,2,2,3,1,3,-1,-1,0,-4,-2,-3,-5,0,5],["res-18",5,-3,-3,1,2,4,-5,-5,-4,2,-4,3,-4,-1,-3,-3,0,3,1,2,0,-5,-1,3,1,-1,0,4,4,1,4,4,3,-2,-2,1,5,-2,0,-2,-1,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-19",5,-3,-3,1,2,4,-5,-5,-4,2,3,-4,4,3,-1,-2,-1,4,-2,5,1,-5,1,4,-3,-2,1,-1,0,-4,-1,4,0,1,2,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-20",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-21",5,-3,-3,1,2,4,-5,-5,1,-1,-4,4,0,5,-2,-1,-5,2,1,0,-2,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-22",5,-3,-3,-4,5,4,1,2,0,-4,-1,5,4,-4,3,0,-2,0,4,0,-1,2,4,4,0,3,-2,1,-4,-2,-3,-1,-1,-2,3,-4,-5,-5,1,-2,-1,1,2,-5,1,2,0,0,3,1,-3,3,-1,-1,2,1,-3,-5,0,5],["res-23",3,4,-1,-1,0,4,1,-5,2,2,-3,-5,-3,0,-1,5,-3,5,0,-1,-4,-5,0,2,3,1,-4,4,0,-3,-2,0,3,1,-3,5,-2,0,0,4,-5,5,3,-1,2,-4,1,-2,1,2,1,-1,-2,3,4,-1,1,-4,-2,-4],["res-24",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,1,-3,4,-1,1,4,3,4,1,0,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-25",-4,1,-2,4,4,3,-1,-5,3,4,2,1,-1,5,-1,-1,2,-2,3,-3,5,-5,1,1,-2,-3,-4,-4,0,1,4,5,2,2,0,-3,3,0,3,-5,1,1,-2,-4,0,-3,-1,2,-3,-1,4,0,-1,-4,0,0,-2,-5,0,5],["res-26",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,4,-1,1,0,1,1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-27",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-28",5,-3,-3,1,2,-5,2,0,4,-1,-4,-1,3,-3,4,0,2,4,1,4,-2,4,1,1,1,-5,-2,-4,-5,-2,3,-1,-4,5,-1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-29",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,-2,2,3,-4,4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-30",5,4,0,1,2,-5,1,4,4,4,-3,5,0,-3,-2,-3,3,-1,2,-2,1,-4,-1,2,-4,-5,-4,-1,-5,-1,3,1,1,-2,4,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-31",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-32",5,-3,-3,1,2,4,-5,-5,0,-1,5,4,-1,4,-2,2,-2,-5,1,4,-1,1,0,-2,-1,-3,-3,0,3,-4,1,-4,1,0,3,-2,0,4,5,0,2,2,-4,3,3,-1,1,3,2,1,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-33",5,0,-2,5,-2,-2,-1,-5,1,4,1,2,-4,3,-1,4,4,4,-3,1,-4,2,-3,-3,-5,-1,-5,0,1,2,4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-34",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,2,4,-2,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-35",5,-3,-3,1,-5,4,2,0,-1,3,-5,-2,-4,-3,0,-2,0,1,-3,-2,-2,-4,4,3,5,1,-1,4,4,-1,1,1,-4,2,-5,3,-1,2,4,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-36",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,0,0,-1,5,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-37",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,4,1,-1,-1,1,0,-3,0,1,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-38",5,-3,-3,1,2,4,0,-3,2,-4,3,4,1,3,-5,-2,-5,0,-2,2,-1,1,1,3,-1,1,-1,-2,-4,0,-5,-1,-3,-4,0,4,1,0,5,3,4,2,0,-1,3,-2,-4,0,2,-1,5,4,1,-4,-1,-2,-3,-5,0,5],["res-39",5,-3,-3,1,2,4,4,4,-5,-4,-3,3,4,-1,4,2,0,2,-5,-2,-4,3,-2,1,-1,-4,1,-2,-5,0,-1,5,1,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-40",5,-5,2,-2,2,4,-3,3,0,-4,-1,-5,5,4,1,-5,-3,-2,-3,2,3,-1,-3,0,4,-2,-2,-4,4,-4,1,1,3,0,3,-1,1,4,-1,0,1,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-41",5,-3,-3,1,2,4,-5,-5,-4,3,0,-1,-4,-2,-1,-4,1,-2,4,1,4,5,-2,2,1,3,-1,-1,4,2,4,0,-5,-3,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-42",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-43",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,2,4,-1,4,-2,1,4,-3,3,3,-1,4,1,1,-4,-4,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-44",5,-3,-4,-3,-1,0,-1,1,1,4,2,-2,-1,5,-2,2,0,4,-5,-5,1,-3,1,-5,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-45",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,3,4,-2,-1,4,1,2,-4,3,3,-4,4,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-46",5,-3,-3,1,2,4,-5,-5,-4,2,-5,3,-1,3,3,1,3,2,1,-1,-2,1,4,1,2,0,1,0,-2,5,-4,4,4,1,0,-1,-4,-3,-2,-1,4,-2,-3,0,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-47",5,0,0,-4,-5,-5,2,1,-3,-1,-4,1,3,3,2,-1,-4,4,3,-2,3,-2,-2,1,4,1,0,-1,-4,0,-5,-2,5,0,-1,3,-3,-1,1,4,-3,-3,4,-1,1,-2,0,-4,0,-5,-1,5,1,0,-3,2,2,4,2,5],["res-48",5,-3,-3,1,2,4,-5,-5,-4,-1,-1,-5,4,0,1,-2,1,5,-2,2,0,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-49",5,1,2,2,0,-2,3,4,-1,1,4,-2,-2,-1,-1,4,-3,1,-1,0,0,-5,5,0,5,2,-4,-3,3,1,-3,-1,3,3,0,4,2,1,1,-5,-5,4,3,-2,-4,2,1,-3,-4,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-50",5,-3,-3,1,2,-1,3,1,1,0,0,2,2,4,5,-4,0,-1,1,2,-5,3,-2,5,4,-2,-1,-1,0,4,-2,-5,3,3,1,-1,-4,-4,-3,0,2,-2,-1,4,4,1,-1,0,-5,3,1,-3,-4,0,-4,-2,-3,-5,0,5],["res-51",5,-3,-3,1,2,-4,-5,-1,2,-2,-5,-5,5,4,1,0,-2,0,-1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-52",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,2,-2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-53",5,5,1,4,-5,0,4,1,4,4,-2,5,0,2,3,3,4,-1,-3,1,2,-2,-1,-3,-3,0,2,1,-5,1,3,-5,-2,0,1,-1,2,-1,3,1,-3,0,0,3,-4,-1,2,-4,-4,-1,-4,-2,-1,0,-4,-2,-3,-5,0,5],["res-54",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-4,4,2,-4,-2,3,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-55",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-56",5,-1,1,3,1,-1,4,5,-2,2,4,-3,-3,-5,0,0,-5,-3,-4,-2,-1,1,-5,4,1,4,2,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-57",5,-3,-3,-2,-3,1,0,-4,-5,0,1,-5,3,-1,4,4,5,-2,-4,4,-1,-2,4,2,-1,-5,2,2,1,4,1,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-58",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-59",5,1,1,4,-4,4,3,-3,0,3,1,1,-4,2,-4,-3,-5,-5,-1,2,0,-2,-4,-5,4,2,0,3,3,-4,-2,0,-3,-3,-1,0,-3,-5,4,4,-2,1,5,-1,-1,-2,3,-2,1,2,0,5,-1,-1,0,-1,1,2,0,5],["res-60",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-61",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,1,-2,1,0,-1,-2,5,1,4,0,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-62",5,0,5,-2,3,-5,-2,4,3,4,-1,3,1,2,5,0,-1,-3,-1,-4,-5,-4,0,0,1,-3,-1,1,1,-4,2,4,4,-1,-5,3,-3,0,-1,0,1,-3,0,-1,1,2,3,4,-2,-2,2,2,-4,1,-4,-2,-3,-5,0,5],["res-63",5,-3,-3,1,-5,-2,-4,2,0,5,-1,-5,2,-1,-5,-2,4,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-64",5,-3,-3,-1,-1,4,0,-2,5,4,2,1,-4,-5,-1,2,3,4,-5,1,0,2,1,-5,4,-2,-3,4,-2,1,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-65",2,-2,-3,0,5,0,1,3,-3,-5,-3,2,0,1,4,5,-5,-2,3,0,-1,-1,-4,0,0,4,4,-1,-2,2,-1,5,0,-1,3,-4,-1,3,1,-4,4,-1,-4,1,-3,-4,-2,2,4,1,1,-2,3,2,-5,1,-3,-5,0,5],["res-66",5,-3,-3,1,2,4,-5,-5,-4,-2,2,-2,0,-1,4,1,4,5,1,-5,-1,1,-3,0,4,-1,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-67",5,-3,-3,1,2,4,-1,1,4,-1,1,-4,-2,5,-5,-4,5,3,-5,-5,2,3,3,-1,0,2,4,-2,-1,-4,-1,3,0,-2,2,0,2,-4,-3,-2,0,0,-1,4,-3,4,-1,0,1,1,0,3,1,1,-4,-2,-3,-5,0,5],["res-68",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-3,0,2,-3,-1,4,4,-1,-4,1,1,0,-2,4,-4,0,3,0,3,-1,1,-2,4,1,3,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-69",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-70",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,5,3,-1,4,1,4,0,-1,4,1,1,-2,-3,-2,2,0,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-71",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,4,4,4,2,3,-1,-3,-2,1,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-72",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,3,-1,-2,3,1,1,-4,2,1,0,-3,-3,-2,2,0,3,1,1,-1,1,4,0,3,-1,0,4,-4,4,4,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-73",5,-3,-3,1,2,4,-5,-3,-1,1,3,-2,5,-5,4,-1,4,3,2,2,1,-2,0,0,-4,1,1,-4,3,2,-5,-4,3,-1,0,-3,-1,2,1,4,1,-2,3,-2,-1,4,0,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-74",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-75",5,-3,-3,1,2,2,-2,-4,3,1,-1,-2,4,-3,2,1,0,-1,-1,1,0,4,1,4,-5,-4,-2,-1,-3,5,-1,-2,5,2,3,0,0,4,-1,0,-4,0,3,1,1,3,-4,-1,-5,-5,2,3,4,0,-4,-2,-3,-5,0,5],["res-76",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-77",5,4,-5,4,2,-5,0,0,-4,1,-2,2,1,5,-3,-1,-1,1,-3,-3,4,-5,4,1,-1,-2,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-78",-1,3,-3,0,-5,3,2,4,-4,-5,-2,2,-5,0,2,-1,1,-5,2,4,-1,-4,4,-2,4,0,-1,-2,1,-4,1,-1,2,5,0,1,-3,-1,5,-2,0,1,3,0,-1,3,-3,3,-4,-4,1,4,-2,0,1,-3,5,0,-3,5],["res-79",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,1,-4,-3,0,-2,-3,4,3,1,0,2,4,-1,1,1,4,4,1,3,-1,3,0,-4,3,2,-2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5],["res-80",5,-3,-3,1,2,4,-5,-5,-4,2,-5,-1,-2,-2,5,-1,0,0,1,1,4,1,-1,-3,4,4,3,-2,2,4,-4,3,-4,-1,1,3,-3,-2,0,0,3,1,2,1,-1,2,3,0,5,0,-4,-1,-1,0,-4,-2,-3,-5,0,5]],60,-5),t=ft(e[1]);return{projectName:"iPad Survey (Japanese)",projectHistoryArray:["iPad project loaded from demo data"],statements:["\u79c1\u306f\u3001iPad\u304c\u3053\u306e\u6388\u696d\u3067\u826f\u3044\u5b66\u7fd2\u74b0\u5883\u4f5c\u308a\u306b\u5f79\u7acb\u3063\u305f\u3068\u601d\u3044\u307e\u3059","\u79c1\u305f\u3061\u306f\u3001iPad\u3092\u4f7f\u7528\u3057\u305f\u305f\u3081\u3001\u79c1\u306f\u3053\u306e\u6388\u696d\u3067\u306f\u3001\u3088\u308a\u7c21\u5358\u306b\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3057\u305f","\u79c1\u306f\u3001iPad\u306e\u305f\u3081\u3001\u79c1\u306e\u4ed6\u306e\u30af\u30e9\u30b9\u306b\u6bd4\u3079\u3066\u3001\u3053\u306e\u30af\u30e9\u30b9\u306e\u540c\u7d1a\u751f\u304b\u3089\u3088\u308a\u591a\u304f\u3092\u5b66\u3073\u307e\u3057\u305f","iPad\u306f\u3001\u79c1\u304c\u305d\u3046\u3067\u306a\u3051\u308c\u3070\u5b66\u3093\u3067\u306a\u304b\u3063\u305f\u3067\u3042\u308d\u3046\u3053\u3068\u306f\u3001\u3053\u306e\u30af\u30e9\u30b9\u3067\u7269\u4e8b\u3092\u5b66\u3076\u305f\u3081\u306b\u79c1\u3092\u52a9\u3051\u307e\u3057\u305f","iPad\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u305d\u308c\u304c\u7c21\u5358\u306b\u79c1\u304c\u30af\u30e9\u30b9\u3067\u4f7f\u7528\u3055\u308c\u308b\u6982\u5ff5\u9593\u306e\u63a5\u7d9a\u3092\u5206\u304b\u308b\u3088\u3046\u3088\u3046\u306b\u3057\u307e\u3057\u305f"," iPad\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3067\u3001\u5b66\u7fd2\u306e\u79c1\u306e\u597d\u307e\u3057\u3044\u65b9\u6cd5\u3068\u3088\u304f\u4e00\u81f4\u3057\u307e\u3057\u305f","\u79c1\u306f\u3001\u3053\u306e\u30af\u30e9\u30b9\u3067 iPad\u3092\u4f7f\u7528\u3057\u305f\u305f\u3081\u3001 \u5b66\u3076\u305f\u3081\u306b\u79c1\u306e\u3084\u308b\u6c17\u3092\u5f15\u304d\u51fa\u3057\u307e\u3059","\u79c1\u306f\u3001\u3053\u306e\u30af\u30e9\u30b9\u3067\u5b66\u3093\u3060\u306eiPad\u306e\u30b9\u30ad\u30eb\u304c\u4ed6\u306e\u30af\u30e9\u30b9\u3067\u79c1\u3092\u5f79\u306b\u7acb\u3064\u3068\u601d\u3044\u307e\u3059","iPad\u3092\u4f7f\u7528\u306b\u3088\u3063\u3066\u3001\u79c1\u306f\u3082\u3063\u3068\u30af\u30e9\u30b9\u306e\u6982\u5ff5\u306b\u96c6\u4e2d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f","iPad\u3092\u4f7f\u7528\u306b\u3088\u3063\u3066\u3001\u524d\u306e\u30af\u30e9\u30b9\u30bb\u30c3\u30b7\u30e7\u30f3\u304b\u3089\u306e\u6982\u5ff5\u3092\u899a\u3048\u3066\u79c1\u3092\u52a9\u3051\u307e\u3057\u305f","\u79c1\u304ciPad\u306e\u4f7f\u7528\u306b\u3088\u3063\u3066\u3001\u79c1\u306e\u4ed6\u306e\u30af\u30e9\u30b9\u3088\u308a\u3082\u3001\u3053\u306e\u30af\u30e9\u30b9\u3067\u306f\u3088\u308a\u591a\u304f\u306b\u53c2\u52a0\u3057\u307e\u3057\u305f","iPad\u306eSocrative\u30a2\u30d7\u30ea\u3092\u4f7f\u7528\u3057\u305f\u304b\u3089\u3001\u3088\u308a\u7c21\u5358\u306b\u6388\u696d\u306e\u6982\u5ff5\u306b\u3064\u3044\u3066\u610f\u898b\u3092\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f"," iPad\u306eSocrative\u30a2\u30d7\u30ea\u3092\u4f7f\u7528\u306b\u3088\u3063\u3066\u3001\u4ed6\u306e\u751f\u5f92\u306e\u610f\u898b\u3092\u53c2\u7167\u3092\u898b\u308b\u3053\u3068\u304c\u9762\u767d\u304b\u3063\u305f\u3067\u3059","\u30d5\u30a3\u30fc\u30c9\u30d0\u30c3\u30af\u3092\u4e0e\u3048\u308b\u305f\u3081\u306eiPad\u3092\u4f7f\u7528\u3057\u305f\u306e\u306f\u3001\u5b66\u751f\u306e\u30d7\u30ec\u30bc\u30f3\u30c6\u30fc\u30b7\u30e7\u30f3\u3088\u308a\u8208\u5473\u6df1\u3044\u306b\u306a\u3063\u305f","Kahoot\u306e\u30af\u30a4\u30ba\u306f\u3001\u30b3\u30fc\u30b9\u306e\u6982\u5ff5\u3092\u5b66\u3076\u305f\u3081\u306b\u79c1\u3092\u52a9\u3051\u307e\u3057\u305f","\u30af\u30e9\u30b9\u3067\u306eiPad\u3092\u4f7f\u7528\u3059\u308b\u306b\u306f\u3001\u79c1\u306f\u82f1\u8a9e\u3067\u8a71\u3059\u3053\u3068\u304c\u3088\u308a\u56f0\u96e3\u306b\u306a\u308a\u307e\u3059","\u79c1\u306f\u6388\u696d\u4e2d\u306b\u30bd\u30fc\u30b7\u30e3\u30eb\u30e1\u30c7\u30a3\u30a2\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff08LINE\u3084Facebook\uff09\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306eiPad\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3057\u305f","\u3053\u306e\u30af\u30e9\u30b9\u3067\u306eiPad\u3092\u4f7f\u7528\u3057\u3066\u8cb4\u91cd\u306a\u6388\u696d\u6642\u9593\u3092\u7121\u99c4\u306b\u3057\u305f","\u79c1\u306f\u3053\u306e\u30af\u30e9\u30b9\u306eiPad\u306e\u30a2\u30d7\u30ea\u3092\u4f7f\u7528\u3059\u308b\u65b9\u6cd5\u3092\u7406\u89e3\u3059\u308b\u306e\u306f\u56f0\u96e3\u3067\u3057\u305f","\u3053\u306e\u30af\u30e9\u30b9\u3067\u306eiPad\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u30b3\u30fc\u30b9\u306e\u6982\u5ff5\u306f\u3055\u3089\u306b\u6df7\u4e71\u88fd\u3055\u308c\u305f","iPad\u3092\u4f7f\u3063\u3066\u3001\u81ea\u5206\u306e\u8003\u3048\u3092\u8868\u73fe\u3059\u308b\u3053\u3068\u306f\u56f0\u96e3\u3067\u3057\u305f","\u30a2\u30d7\u30ea\u95a2\u9023\u306e\u6750\u6599\u306f\u3001\u4ed6\u306e\u30af\u30e9\u30b9\u306e\u6750\u6599\u3068\u3088\u304f\u7d71\u5408\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3067\u3057\u305f","\u6559\u5ba4\u306e\u524d\u306b\u753b\u9762\u306b\u8868\u793a\u3055\u308c\u308b\u6301\u3064\u79c1\u306e\u610f\u898b\u306f\u79c1\u306e\u610f\u898b\u3092\u8868\u73fe\u3059\u308b\u305f\u3081\u306b\u3001\u79c1\u306f\u3088\u308a\u6d88\u6975\u88fd\u306b\u306a\u3063\u305f","\u6388\u696d\u4e2d\u306eiPad\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u9593\u3001\u79c1\u306f\u9000\u5c48\u306b\u306a\u308a\u307e\u3057\u305f","iPad\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3068\u304d\u3001\u79c1\u306f\u3001\u4ed6\u306e\u5b66\u751f\u306e\u6280\u8853\u3068\u540c\u69d8\u306b\u719f\u7df4\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u79c1\u306f\u304e\u3053\u3061\u306a\u3044\u611f\u3058\u307e\u3057\u305f","iPad\u3092\u4f7f\u3063\u305f\u305f\u3081\u3001\u79c1\u306f\u30b3\u30fc\u30b9\u306e\u6982\u5ff5\u306b\u96c6\u4e2d\u3059\u308b\u306e\u306f\u3001\u3088\u308a\u56f0\u96e3\u306b\u306a\u308a\u307e\u3057\u305f","iPad\u3092\u4f7f\u3063\u305f\u305f\u3081\u3001\u6559\u6388\u3068\u82f1\u8a9e\u3067\u8a71\u3059\u3053\u3068\u304c\u3088\u308a\u56f0\u96e3\u306b\u306a\u308a\u307e\u3059","iPad\u3092\u4f7f\u3063\u305f\u305f\u3081\u3001\u4ed6\u306e\u5b66\u751f\u3068\u82f1\u8a9e\u3067\u8a71\u3059\u3053\u3068\u304c\u3088\u308a\u56f0\u96e3\u306b\u306a\u308a\u307e\u3059"," \u79c1\u306f\u7406\u7531\u306eiPad\u306e\u4f7f\u7528\u306e\u6388\u696d\u4e2d\u306b\u82f1\u8a9e\u3092\u8a71\u3059\u305f\u3081\u306b\u79c1\u306e\u80fd\u529b\u306b\u3044\u304f\u3064\u304b\u306e\u4fe1\u983c\u3092\u5931\u3044\u307e\u3057\u305f","\u6388\u696d\u4e2d\u306eiPad\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u4e0d\u4fbf\u3067\u3057\u305f","\u79c1\u306f\u3001iPad\u304c\u3053\u306e\u6388\u696d\u3067\u826f\u3044\u5b66\u7fd2\u74b0\u5883\u4f5c\u308a\u306b\u5f79\u7acb\u3063\u305f\u3068\u601d\u3044\u307e\u3059","\u79c1\u305f\u3061\u306f\u3001iPad\u3092\u4f7f\u7528\u3057\u305f\u305f\u3081\u3001\u79c1\u306f\u3053\u306e\u6388\u696d\u3067\u306f\u3001\u3088\u308a\u7c21\u5358\u306b\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3057\u305f","\u79c1\u306f\u3001iPad\u306e\u305f\u3081\u3001\u79c1\u306e\u4ed6\u306e\u30af\u30e9\u30b9\u306b\u6bd4\u3079\u3066\u3001\u3053\u306e\u30af\u30e9\u30b9\u306e\u540c\u7d1a\u751f\u304b\u3089\u3088\u308a\u591a\u304f\u3092\u5b66\u3073\u307e\u3057\u305f","iPad\u306f\u3001\u79c1\u304c\u305d\u3046\u3067\u306a\u3051\u308c\u3070\u5b66\u3093\u3067\u306a\u304b\u3063\u305f\u3067\u3042\u308d\u3046\u3053\u3068\u306f\u3001\u3053\u306e\u30af\u30e9\u30b9\u3067\u7269\u4e8b\u3092\u5b66\u3076\u305f\u3081\u306b\u79c1\u3092\u52a9\u3051\u307e\u3057\u305f","iPad\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u305d\u308c\u304c\u7c21\u5358\u306b\u79c1\u304c\u30af\u30e9\u30b9\u3067\u4f7f\u7528\u3055\u308c\u308b\u6982\u5ff5\u9593\u306e\u63a5\u7d9a\u3092\u5206\u304b\u308b\u3088\u3046\u3088\u3046\u306b\u3057\u307e\u3057\u305f"," iPad\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3067\u3001\u5b66\u7fd2\u306e\u79c1\u306e\u597d\u307e\u3057\u3044\u65b9\u6cd5\u3068\u3088\u304f\u4e00\u81f4\u3057\u307e\u3057\u305f","\u79c1\u306f\u3001\u3053\u306e\u30af\u30e9\u30b9\u3067 iPad\u3092\u4f7f\u7528\u3057\u305f\u305f\u3081\u3001 \u5b66\u3076\u305f\u3081\u306b\u79c1\u306e\u3084\u308b\u6c17\u3092\u5f15\u304d\u51fa\u3057\u307e\u3059","\u79c1\u306f\u3001\u3053\u306e\u30af\u30e9\u30b9\u3067\u5b66\u3093\u3060\u306eiPad\u306e\u30b9\u30ad\u30eb\u304c\u4ed6\u306e\u30af\u30e9\u30b9\u3067\u79c1\u3092\u5f79\u306b\u7acb\u3064\u3068\u601d\u3044\u307e\u3059","iPad\u3092\u4f7f\u7528\u306b\u3088\u3063\u3066\u3001\u79c1\u306f\u3082\u3063\u3068\u30af\u30e9\u30b9\u306e\u6982\u5ff5\u306b\u96c6\u4e2d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f","iPad\u3092\u4f7f\u7528\u306b\u3088\u3063\u3066\u3001\u524d\u306e\u30af\u30e9\u30b9\u30bb\u30c3\u30b7\u30e7\u30f3\u304b\u3089\u306e\u6982\u5ff5\u3092\u899a\u3048\u3066\u79c1\u3092\u52a9\u3051\u307e\u3057\u305f","\u79c1\u304ciPad\u306e\u4f7f\u7528\u306b\u3088\u3063\u3066\u3001\u79c1\u306e\u4ed6\u306e\u30af\u30e9\u30b9\u3088\u308a\u3082\u3001\u3053\u306e\u30af\u30e9\u30b9\u3067\u306f\u3088\u308a\u591a\u304f\u306b\u53c2\u52a0\u3057\u307e\u3057\u305f","iPad\u306eSocrative\u30a2\u30d7\u30ea\u3092\u4f7f\u7528\u3057\u305f\u304b\u3089\u3001\u3088\u308a\u7c21\u5358\u306b\u6388\u696d\u306e\u6982\u5ff5\u306b\u3064\u3044\u3066\u610f\u898b\u3092\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f"," iPad\u306eSocrative\u30a2\u30d7\u30ea\u3092\u4f7f\u7528\u306b\u3088\u3063\u3066\u3001\u4ed6\u306e\u751f\u5f92\u306e\u610f\u898b\u3092\u53c2\u7167\u3092\u898b\u308b\u3053\u3068\u304c\u9762\u767d\u304b\u3063\u305f\u3067\u3059","\u30d5\u30a3\u30fc\u30c9\u30d0\u30c3\u30af\u3092\u4e0e\u3048\u308b\u305f\u3081\u306eiPad\u3092\u4f7f\u7528\u3057\u305f\u306e\u306f\u3001\u5b66\u751f\u306e\u30d7\u30ec\u30bc\u30f3\u30c6\u30fc\u30b7\u30e7\u30f3\u3088\u308a\u8208\u5473\u6df1\u3044\u306b\u306a\u3063\u305f","Kahoot\u306e\u30af\u30a4\u30ba\u306f\u3001\u30b3\u30fc\u30b9\u306e\u6982\u5ff5\u3092\u5b66\u3076\u305f\u3081\u306b\u79c1\u3092\u52a9\u3051\u307e\u3057\u305f","\u30af\u30e9\u30b9\u3067\u306eiPad\u3092\u4f7f\u7528\u3059\u308b\u306b\u306f\u3001\u79c1\u306f\u82f1\u8a9e\u3067\u8a71\u3059\u3053\u3068\u304c\u3088\u308a\u56f0\u96e3\u306b\u306a\u308a\u307e\u3059","\u79c1\u306f\u6388\u696d\u4e2d\u306b\u30bd\u30fc\u30b7\u30e3\u30eb\u30e1\u30c7\u30a3\u30a2\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff08LINE\u3084Facebook\uff09\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306eiPad\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3057\u305f","\u3053\u306e\u30af\u30e9\u30b9\u3067\u306eiPad\u3092\u4f7f\u7528\u3057\u3066\u8cb4\u91cd\u306a\u6388\u696d\u6642\u9593\u3092\u7121\u99c4\u306b\u3057\u305f","\u79c1\u306f\u3053\u306e\u30af\u30e9\u30b9\u306eiPad\u306e\u30a2\u30d7\u30ea\u3092\u4f7f\u7528\u3059\u308b\u65b9\u6cd5\u3092\u7406\u89e3\u3059\u308b\u306e\u306f\u56f0\u96e3\u3067\u3057\u305f","\u3053\u306e\u30af\u30e9\u30b9\u3067\u306eiPad\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u30b3\u30fc\u30b9\u306e\u6982\u5ff5\u306f\u3055\u3089\u306b\u6df7\u4e71\u88fd\u3055\u308c\u305f","iPad\u3092\u4f7f\u3063\u3066\u3001\u81ea\u5206\u306e\u8003\u3048\u3092\u8868\u73fe\u3059\u308b\u3053\u3068\u306f\u56f0\u96e3\u3067\u3057\u305f","\u30a2\u30d7\u30ea\u95a2\u9023\u306e\u6750\u6599\u306f\u3001\u4ed6\u306e\u30af\u30e9\u30b9\u306e\u6750\u6599\u3068\u3088\u304f\u7d71\u5408\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3067\u3057\u305f","\u6559\u5ba4\u306e\u524d\u306b\u753b\u9762\u306b\u8868\u793a\u3055\u308c\u308b\u6301\u3064\u79c1\u306e\u610f\u898b\u306f\u79c1\u306e\u610f\u898b\u3092\u8868\u73fe\u3059\u308b\u305f\u3081\u306b\u3001\u79c1\u306f\u3088\u308a\u6d88\u6975\u88fd\u306b\u306a\u3063\u305f","\u6388\u696d\u4e2d\u306eiPad\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u9593\u3001\u79c1\u306f\u9000\u5c48\u306b\u306a\u308a\u307e\u3057\u305f","iPad\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3068\u304d\u3001\u79c1\u306f\u3001\u4ed6\u306e\u5b66\u751f\u306e\u6280\u8853\u3068\u540c\u69d8\u306b\u719f\u7df4\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u79c1\u306f\u304e\u3053\u3061\u306a\u3044\u611f\u3058\u307e\u3057\u305f","iPad\u3092\u4f7f\u3063\u305f\u305f\u3081\u3001\u79c1\u306f\u30b3\u30fc\u30b9\u306e\u6982\u5ff5\u306b\u96c6\u4e2d\u3059\u308b\u306e\u306f\u3001\u3088\u308a\u56f0\u96e3\u306b\u306a\u308a\u307e\u3057\u305f","iPad\u3092\u4f7f\u3063\u305f\u305f\u3081\u3001\u6559\u6388\u3068\u82f1\u8a9e\u3067\u8a71\u3059\u3053\u3068\u304c\u3088\u308a\u56f0\u96e3\u306b\u306a\u308a\u307e\u3059","iPad\u3092\u4f7f\u3063\u305f\u305f\u3081\u3001\u4ed6\u306e\u5b66\u751f\u3068\u82f1\u8a9e\u3067\u8a71\u3059\u3053\u3068\u304c\u3088\u308a\u56f0\u96e3\u306b\u306a\u308a\u307e\u3059"," \u79c1\u306f\u7406\u7531\u306eiPad\u306e\u4f7f\u7528\u306e\u6388\u696d\u4e2d\u306b\u82f1\u8a9e\u3092\u8a71\u3059\u305f\u3081\u306b\u79c1\u306e\u80fd\u529b\u306b\u3044\u304f\u3064\u304b\u306e\u4fe1\u983c\u3092\u5931\u3044\u307e\u3057\u305f","\u6388\u696d\u4e2d\u306eiPad\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u4e0d\u4fbf\u3067\u3057\u305f"],numQsorts:80,numStatements:60,multiplierArray:[0,4,5,5,5,7,8,7,5,5,5,4,0,0,0,0,0,0,0,0],mainDataObject:e[1],sortsDisplayText:t,respondentNames:e[0],qSortPattern:[-5,-5,-5,-5,-4,-4,-4,-4,-4,-3,-3,-3,-3,-3,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5],statementNumArray:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60]}},Zp=function(){var t=y(),n=t.isDataLoaded,i=t.setProjectName,o=t.setStatements,a=t.setQSortPattern,s=t.setNumStatements,l=t.setNumQsorts,u=t.setSortsDisplayText,c=t.setMainDataObject,d=t.setMultiplierArray,h=t.setStatementNumArray,f=t.setRespondentNames,p=t.setHasImportedSorts,v=t.setProjectHistoryArray,g=t.setHasImportedStatements,m=t.setIsDataLoaded,w=t.setShowInputErrorModal,b=Qp(),C=Y((0,e.useState)("bg-gray-300"),2),S=C[0],E=C[1];return(0,r.jsx)("div",{children:(0,r.jsx)(Bp,{handleClick:function(){n?w({showModal:!0,titleText:"Data Loading Error",bodyText:"Data are already loaded.",bodyText2:"Reload the webpage to start a new project."}):(i("Japanese Demo"),o(wt(b.statements)),a(wt(b.qSortPattern)),s(b.numStatements),l(b.numQsorts),u(b.sortsDisplayText),c(b.mainDataObject),d(b.multiplierArray),h(b.statementNumArray),f(b.respondentNames),v(b.projectHistoryArray),p(!0),g(!0),E("bg-green-300"),m(!0))},buttonText:"Load iPad",buttonColor:S})})},Jp=function(){return(0,r.jsx)("div",{className:"mr-4",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center  items-center rounded-md bg-white h-[250px] w-[300px] p-3",children:[(0,r.jsx)("div",{className:"font-bold",children:"Japanese Survey"}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{className:"",children:"60 statements"})}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{children:" 80 Participants "})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(Zp,{})})]})})},$p=function(e){var t=e.removeOverlay,n=y().csvErrorMessage1;return(0,r.jsx)("div",{className:"overlay_background",onClick:function(e){return t()},children:(0,r.jsxs)("div",{className:"overlay_card p-8 min-h-[400px] min-w-[600px]",onClick:function(e){return function(e){e.stopPropagation()}(e)},children:[(0,r.jsx)("div",{className:"mb-4 border-bottom",children:(0,r.jsx)("span",{style:{fontSize:40,display:"block"},children:"There was a file read error!"})}),(0,r.jsx)("div",{className:"m-4",children:(0,r.jsx)("span",{style:{fontSize:30,display:"block"},children:n})}),(0,r.jsx)("span",{style:{fontSize:30,display:"block"},children:"Please check your csv file data and try again"}),(0,r.jsx)("form",{className:"mt-8",onSubmit:function(e){e.preventDefault(),t()},children:(0,r.jsx)("button",{className:"btn btn-primary form_submit ",type:"submit",children:"Close"})})]})})},ev=function(){var e=y(),t=e.showCsvErrorModal,n=e.setShowCsvErrorModal;return(0,r.jsxs)("div",{id:"modal-root",className:"flex flex-row rounded-md p-8 pt-2 bg-gray-300 min-w-[700px] h-[600px]",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsx)(Hp,{}),(0,r.jsx)(Up,{}),(0,r.jsx)(Yp,{}),(0,r.jsx)(Jp,{})]}),(0,r.jsx)("div",{className:t?"overlay_shown":"overlay_hidden",children:(0,r.jsx)($p,{removeOverlay:function(){n(!1)}})})]})},tv=function(e){var t=e.split(/\r?\n/).filter((function(e){return e}));return t[0].split(",").length-1>t[0].split(";").length-1?t.map((function(e){return e.split(",").filter((function(e){return e})).map((function(e,t){return e.trim(),t>0?parseInt(e,10):e}))})):t.map((function(e){return e.split(";").filter((function(e){return e})).map((function(e,t){return e.trim(),t>0?parseInt(e,10):e}))}))},nv=function(e){var t=vt()(e),n=[],r=t.map((function(e){return n.push(e.shift()),e}));return r},rv=function(e){var t=[];return vt()(e).forEach((function(e){var n=e[0];t.push(n)})),yt(t)},iv=function(e){return e[0].map((function(e,t){return 0===t?parseInt(e,10):e}))},ov=n(5587),av=function(t){var n=lt(),i=n.setExcelErrorMessage1,o=n.setShowExcelErrorModal,a=y(),s=a.isDataLoaded,l=a.setProjectName,u=a.setStatements,c=a.setQSortPattern,h=a.setDataOrigin,f=a.setNumStatements,p=a.setNumQsorts,v=a.setSortsDisplayText,g=a.setMainDataObject,m=a.setMultiplierArray,w=a.setStatementNumArray,b=a.setRespondentNames,C=a.setHasImportedSorts,S=a.setHasImportedStatements,E=a.setIsDataLoaded,k=a.setShowInputErrorModal,x=(0,e.useCallback)((function(e){s?k({showModal:!0,titleText:"Data Loading Error",bodyText:"Data are already loaded.",bodyText2:"Reload the webpage to start a new project."}):e.forEach((function(e){var n=[],r=0,a=[],s=[],d=[],y=[],k=[],x=new FileReader;x.onabort=function(){console.log("file reading was aborted"),i("The file reader aborted the load process!"),o(!0)},x.onerror=function(){console.log("file reading has failed"),i("The file reader encountered an error!"),o(!0)},x.onload=function(i){try{ov.loadAsync(e).then((function(e){Object.keys(e.files).forEach((function(t){var i;(h("Kade"),"statements.txt"===t&&e.files["statements.txt"].async("string").then((function(e){var t=e.split(/\r?\n/).filter((function(e){return e})).map((function(e){return e.trim()}));f(t.length),n=lp(t.length),w(n),u(t)})),"sorts.txt"===t&&e.files["sorts.txt"].async("string").then((function(e){var t=tv(e);r=t.length,s=rv(t);var n=nv(t);k=tp(s,n),d=ft(k)})).then((function(){b(s),p(r),g(k),v(d)})),"pattern.txt"===t)&&e.files["pattern.txt"].async("string").then((function(e){i=tv(e),y=iv(i),a=sp(y),m(y),c(a)}));"name.txt"===t&&e.files["name.txt"].async("string").then((function(e){l(e)}))}))})),C(!0),S(!0),t.updateColor(),E(!0)}catch(o){console.log(o.message)}},x.readAsText(e)}))}),[s,E,k,l,u,c,h,f,p,v,g,m,w,b,C,S,i,o,t]),T=it({onDrop:x}),R=T.getRootProps,A=T.getInputProps;return(0,r.jsxs)("div",d(d({className:"flex justify-center items-center pt-[20px]"},R()),{},{children:[(0,r.jsx)("input",d({className:""},A())),(0,r.jsx)("p",{children:"Drag and drop KADE file here, or click to select file"})]}))},sv=function(){var t=Y((0,e.useState)("bg-gray-300 hover:bg-gray-400"),2),n=t[0],i=t[1];return(0,r.jsx)("div",{className:"w-[300px] mr-4",children:(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"flex flex-col justify-center  items-center rounded-md bg-white h-[500px] w-[300px]",children:[(0,r.jsx)("h6",{className:"text-[22px] font-bold tracking-tight text-gray-900",children:"1. KADE Zip File"}),(0,r.jsx)("p",{className:"font-normal text-gray-700 dark:text-gray-400",children:"A compressed zip file."}),(0,r.jsx)("div",{children:(0,r.jsx)("img",{alt:"kade zip file",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAR8AAAC0CAYAAACt+yjUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAABfeSURBVHhe7d1fTBtXvgfwr6FRAiZK+ZOQvpBkr+30Ihq1kaqk5kolSfsA3apSi5AqReLN7JtZ6eZpecx9ypVq7krbhe5Kyz7mKVITm4SivlzYQJtkE5kkME6gVbpXCVFoDCR2MDP3nDNje2wDgdrJqPH3Q394fGbmjEGab885QOwyBBARvWQV1iMR0UvF8CEiRzB8iMgRDB8icgTDh4gcwfAhIkcwfIjIEQwfInIEw4eIHMHwISJHMHyIyBEMHyJyBMOHiBzB8CEiRzB8iMgRDB8icgTDh4gcwfAhIkeU7J9RPX/+PLZt2wbZna7LLo3MtvoQ28lEEnsa9+DokSPYsWOHeSIRlaWShc/o6Cja2tpEzAjikwycDLnpAq5dvYrGxkbMzs3hvaNHsX37dnM/EZWdkk27ZIYVltmuy21dV9tutxtNTU0YGx/H6uqqdTYRlZuSjXxGRr5BXX0d4o/jVktut3KaVVFRgenpaRVCiWQSJ0+ehLu62jqCiMpJycLn0sgIjh87Zo520vMs8cTs3Pz8LPkMK6mUej47O4eDPh9qatxqHxGVl5KFz8VLl9BQ34B4/LHVsrGGht04cGC/CJ8aq4WIyknJwmd4+CJOnDihplRS9rMYAclH8z+1LQ+JadqrEz6RHrhON0MbC8JjNW1oq8cTvYJKFj6R4WG8sXcvFhcXrZZcmYtYG6/Xvo7fHDjA8LGaiMqODJ9i6bpuXAiHjfhi3HgcjxtPniaMRDJpViJpPM1UQu2Tdf36DUMEldXDRjQj5IcRCJuPciUJ8BshzdotaSHDb8aaWf6QOCsrHIDhD4XV+eljAmGxI+e8gCGb7LSQP3N8wTUtsu/sMaJEx+Z59v7M1y73FR5/wTqGqLwUHT5zs3eNC1+fM74a+NL4y+CXxsCf/mj8/W9/NYYjYVWXL08YExNmXbbVP69f31L42G9+dQPbAkYLBWzBkL3R08wbPnu+Fmo1b/xMH4XnqGPsIRYOiHMKA0qR+3ICz+zPb11QhVF+XznHE5Wfon7PJ6ZNYzj8NaZv38Ji/Gc8fbKMVGoFD+cf4I52W1VV1Q54vT54RMlHVR6vWveRCbBZ/tAQgtYcpf1UCP7xm9DMp/AEBzL7xDME+wJAdAYxq0UJ9GWO8QT/AHGEaEpPe/LPieC/f28gNGSbFrWfQsg/iHMR6/mGRH9DIaD3jOgpgjO9yO2LiIr7JcMr33+HpaUl1Dc0qPr4k0/R2fU5vL6DSCQSqqI3ruH+/fsikOateoD5h/Pi7K1ED9Diy791o5ixpUusvxUul8usjkGrNcvf7LW20vwoaEqLnMMgxtHrtfpT5UXvuLV/MzxB9AUG0eHqwKAt+IjI9ML/sLSyshLuGrdZbjeq3TXiscb8qVhJ1roj6BHh4D3bBTGNUf3KeVbxAhBTLLM/Ww20W7s3wdvsV4+FwUdERYWPHMnU1zeg7fgHqvbtP4A9jXtx6O3D6jeaZS0txpFaWTFHDxUuVFhVithRYjNiDCSCwvaTo9hM1Nr6hbzNYlyUO7Laslg/untbENbk9Ksb/cX0RfQKKip8DEMXgbMfTU1mpTU17YPv4JuqUqlVLD9ZxvJybpUufSRbUKibfivzozWIKdMfAv8Q064eMa5Ki6G/p99cExLXaHW1ol+zfRG2NSh1bLdc6DmFdtGXWv7pts5NyzmeqPwUFT61tXX46d49aDPTqn78YU7V7N07WFhYULWrthZ7976hfqPZXiVLn/TNnV6f6QaGSjDtav+zjrBas8mu+Zxt/mjtRWNrMVod2xNBpMeLXoQwZC30eIJ9CIz3ojs9/Mk5Pmy2EZWZon7J8NbNKL4dHcGKmFZJLpeZZYb4eK2yUm2/f/xDtQCdLxqdgs/rwc6dO60WIionLyx8xJxMbe+q240dVW41RZNN8nLyQ1/V0dn5GaqrqtRxRFReigofXddxayqKK1cm1fOFR4/U4+tiqvXO4XfVdstbh9Q/pUFEZFeyv+0iItoKDkmIyBEMHyJyBMOHiBzB8CEiRzB8iMgRDB8icgTDh4gcwfAhIkcwfIjIEQwfInIEw4eIHMHwISJHMHyIyBEMHyJyBMOHiBzB8CEiRzB8iMgRDB8icgTDh4gcwfAhIkcwfIjIESV794rz589j27Zt6n25dF12aWS21YfYTiaS2NO4B0ePHFHv405E5atk4TM6Ooq2tjYRM4L4JAMnQ266gGtXr6KxsRGzc3N47+hRbN++3dxPRGWnZNMumWGFZbbrcluX71hqwO12o6mpCWPj41hdXbXOJqJyU7KRz8jIN6irr0P8cdxqye1WTrPkO5dOT0+rEEokkzh58iTc1dXWEURUTkoWPpdGRnD82DFztJOeZ4knZufm52fJZ1hJpdTz2dk5HPT5UFPjVvuIqLyULHwuXrqEhvoGxOOPrZaNNTTsxoED+0X41FgtRFROShY+w8MXceLECTWlkrKfxQhIPpr/qW15SEzTXm74RHrgOt0MbSwIj9W0ZtuLttVriuMrxPEzL/M1Er0EpVtwFh9TU1FMTFxWNalqIvM4MSm2ZU1M4rvJSXU8EZUxOfIplq7rxoVw2Igvxo3H8bjx5GnCSCSTZiWSxtNMJdQ+Wdev3zAWFxetHjYWDsDwhzRDC/kNl0ullgF/yNCs/YoWMvzm4Kpgvzw/0y4rcGGNtrB1tOzKdh34DXFpi2aE/DAC4msNqH0BI5xpMx8Lz8la65oz4lpmP2lWP2LfRq+R6Neu6PCZm71rXPj6nPHVwJfGXwa/NAb+9Efj73/7qzEcCau6fHnCmJgw67Kt/nn9+pbCR958MoB01ZK9QdO0UKAgJHJu1nCgMLDWaJPBI9tmzAuZx2TCwezX71/jWrbAUa83/1ppBde0+rROTl8/s18c71qvL6JfsaKmXTFtGsPhrzF9+xYW4z/j6ZNlpFIreDj/AHe026qqqnbA6/XBI0o+qvJ41bqPTJRNC4QxFvSoFSTAg+BQCP7B0+iPqQZ4ggMQuy1if58Ym0RnYO3epAjO9AKhoSC85oWA9lMI+QdxLmI9l7pO2a5l8oeGMm3tp8RrG78JzXz6HObXgt4z4urZ63N9h151RYXPle+/w9LSEuobGlR9/Mmn6Oz6HF7fQSQSCVXRG9dw//59EUjzVj3A/MN5cfaWogf+Zq+1ZfH40GJtpsX6W+ES8yVVHYNW6xZEzmEQ4+gVyZPpx+VF77i139LiK4yGwrYoZjabfJ4g+gKD6HB1YDDQVxBsRK+iF/6HpZWVlXDXuM1yu1HtrhGPNeZPxayfjBUvgh4RFN6zXRDTE9W3nPv8MgGIKZbZh60G2q3dL4i32a8eC0KW6BVVVPjIkUx9fQPajn+gat/+A9jTuBeH3j6sfqNZ1tJiHKmVFXMUUeFChVVbjZ3xm3mTGDVKaYEacMRmxDhDhIbtx9Gxmai1tQXeZvi3MmIplVg/untbENbk9Ks7M5UkepUVFT6GoYvA2Y+mJrPSmpr2wXfwTVWp1CqWnyxjeTm3tpw+gx3oiaRPEyMdMa3yh04hOyCxhYa6mfPmStJa6zD2NjX9kdOuHjX6McXQ39O/xbUjG/FaWl2tuYGS8zpE/91yoUd8LeL6avmnO+96/9js+hHRr0dR4VNbW4ef7t2DNjOt6scf5lTN3r2DhYUFVbtqa7F37xvqN5rtteU1n1AYzaddqFTrMHJtxFyAVtI3bXqtphsYyp92WQvHHXJ/T3iNNnNFuX3AQDgwiN9WVGTWfM42f1S6BeC8a4Z7fOhFCEPW1+IJ9iEw3ovudFqJ47/wf5XzGoleBUX9hvOtm1F8OzqCFTGtklwuM8sM8fFaZaXafv/4h2oBOl80OgWf14OdO3daLeuL9LhwulnLhg0R/eq9sPARczK1vatuN3ZUudUUTTbJy8kPfVVHZ+dnqK6qUsdthOFD9OopKnx0XcetqSiuXJlUzxcePVKPr4up1juH31XbLW8dUv+URjEYPkSvnpL9YSkR0VYUNyQhIvqFGD5E5AiGDxE5guFDRI5g+BCRIxg+ROQIhg8ROYLhQ0SOYPgQkSMYPkTkCIYPETmC4UNEjmD4EJEjGD5E5AiGDxE5guFDRI5g+BCRIxg+ROQIhg8ROYLhQ0SOYPgQkSNK9u4V58+fx7Zt29T7cum67NLIbKsPsZ1MJLGncQ+OHjmi3sediMpXycJndHQUbW1tImYE8UkGTobcdAHXrl5FY2MjZufm8N7Ro9i+fbu5n4jKTsmmXTLDCsts1+W2Lt+x1IDb7UZTUxPGxsexurpqnU1E5aZkI5+RkW9QV1+H+OO41ZLbrZxmyXcunZ6eViGUSCZx8uRJuKurrSOIqJyULHwujYzg+LFj5mgnPc8ST8zOzc/Pks+wkkqp57Ozczjo86Gmxq32EVF5KVn4XLx0CQ31DYjHH1stG2to2I0DB/aL8KmxWoionJQsfIaHL+LEiRNqSiVlP4sRkHw0/1Pb8pCYpjkXPpHfwXX636GNBeGxmjYl0iPOa978eVs9nqiMlG7BWXxMTUUxMXFZ1aSqiczjxKTYljUxie8mJ9XxRFTG5MinWLquGxfCYSO+GDcex+PGk6cJI5FMmpVIGk8zlVD7ZF2/fsNYXFy0eniOcEAmlVV+I6RZ7YIW8tv2iQqErT2SZoT8MALitQXU/oARCNiOtR+fd40vZnSz3RJe47wZde2Akb2ieT25b63jiSir6GnXD3OzmIrewL/+9X9wiRnWaiqFqupq7Gl8Q+1/vbZetUv2C8mffv3bb37z/GlXrB+t3rPo0sYQlHOXSD/6vUG1Hetvhbe3BWFjAO3mwehv9aK3JQxjQLaYz88igK6hAfN8KX/atcE1chRMo6z+uzSMiYPV6znbld3PaRfRuoqadsW0aQyHv8b07VtYjP+Mp0+WkUqt4OH8A9zRbquqqtoBr9cHjyj5qMrjtX4qtlkt8KXv3vZ0KERwphcIaengkTwIDoXgHzwn9tp0nSoMkgJrXeN5zOuh94y4nvV6hhg0RJtRVPhc+f47LC0tob6hQdXHn3yKzq7P4fUdRCKRUBW9cQ33798XgTRv1QPMP5wXZ28yejwfocs/iA4xfOoRiZI5K3IOg/bASPP4RGsUMzHrudBScFCevGtsiSeIvoA8twODgb5NhhYRvfA/LK2srIS7xm2W241qd414rDF/KrapGZ8YXYwZMLQQoh0uVLh6ckc1JZF7DZe4RngLs1Fvs189+pu96pGInq+o8JEjmfr6BrQd/0DVvv0HsKdxLw69fVit6chaWowjtbIibmhxU1eI8LBq87e2RYwwxgwNodavcLpfDGu8zfDnjXCU2IxoXWNEtBnpa4hR0H/9T37H64j1o1uuO4ngQm835EsjoucrKnwMQxeBsx9NTWalNTXtg+/gm6pSqVUsP1nG8nJubTp9Ij0FUyE1jVLTnXH0eu0joRj6u+XCyynbOtA6xm9CszbXvIZXXEMuRLtacwPFfp79euL1qOWf7n7RapNzPBGlFRU+tbV1+OnePWgz06p+/GFO1ezdO1hYWFC1q7YWe/e+oX6j2V6bTh8xwjGnQrK8ONs5DfWDLKF9wIAWiqq1msx+6ydPG2r/TzW6UefJ1Mm/hujjz+J5gfZTOeeFe3zoRQhD1vU8wT4ExnvRnU6rvOOJKKuoH7XfuhnFt6MjWBHTKsnlMrNM/gLha5WVavv94x+qBeh80egUfGJ0sXPnTquFiMrJCwuf9GLyrrrd2FHlVlM02SQvJz/0VR2dnZ+huqpKHUdE5aWo8NF1HbemorhyZVI9X3j0SD2+LqZa7xx+V223vHVI/VMaRER2JfvDUiKireCQhIgcwfAhIkcwfIjIEQwfInIEw4eIHMHwISJHMHyIyBEMHyJyBMOHiBzB8CEiRzB8iMgRDB8icgTDh4gcwfAhIkcwfIjIEQwfInIEw4eIHMHwISJHMHyIyBEMHyJyBMOHiBxRsnevOH/+PLZt26bel0vXZZdGZlt9iO1kIok9jXtw9MgR9T7uRFS+ShY+o6OjaGtrEzEjiE8ycDLkpgu4dvUqGhsbMTs3h/eOHsX27dvN/URUdko27ZIZVlhmuy63dfmOpQbcbjeampowNj6O1dVV62wiKjclG/mMjHyDuvo6xB/HrZbcbuU0S75z6fT0tAqhRDKJkydPwl1dbR1BROWkZOFzaWQEx48dM0c76XmWeGJ2bn5+lnyGlVRKPZ+dncNBnw81NW61j4jKS8nC5+KlS2iob0A8/thq2VhDw24cOLBfhE+N1UJE5aRk4TM8fBEnTpxQUyop+1mMgOSj+Z/alofENK348In0wHW6GdpYEB6r6bnEORXinJmtnOOEX/K1SVs975deh6hIpVtwFh9TU1FMTFxWNalqIvM4MSm2ZU1M4rvJSXU8EZUxOfIplq7rxoVw2Igvxo3H8bjx5GnCSCSTZiWSxtNMJdQ+Wdev3zAWFxetHp4jHJBJZZXfCGmyKf3cqkDYPFYLGa0uV7bdHzLE4cq65whayG/b5ze+mNGtPeZ5/lDYCPmz58pTdXEtf+acgJHtzST7dLnS+83XbdJUX4GwfEy/1uz+wtd5Ib3D1m7vz7TW12d+XfbXZl5b7lv3OkQvQdHhMzd717jw9Tnjq4Evjb8MfmkM/OmPxt//9ldjOBJWdfnyhDExYdZlW/3z+vXNhY+6wW03Wjhk2xY3oy1cJC0UEPvTwZG90TLEOa6Cc8QNam+Tx7iyN6x5k2ZfQyao/F9Y5xReJ91nJsNUcKT7tI4XfaZDTl0j7zXkPN/o+2BX8D0xr+UXB8srrfW15h5P9HIUNe2KadMYDn+N6du3sBj/GU+fLCOVWsHD+Qe4o91WVVW1A16vDx5R8lGVx6vWfeQdvDkt8KUXJNqDCG6wOOEJDoj9cp1JPUOwLwBEZxCzWgpFcKYXCA3Z1jzaT+EL/1c4F7GeS4G+zHU9wT6IXhH4Q/qc/Otk+/SmX4roM+QfzOnTHxpC0Dqg/VQI/vGb0NSz9Wz++5AlXttQCOg9g4ixxtdK5JCiwufK999haWkJ9Q0Nqj7+5FN0dn0Or+8gEomEquiNa7h//74IpHmrHmD+4bw4e5PR4/kIXeKm7RDzlx5x427mrFj/f8AljlfVMWi1riNyDoMYR68Igcw5Li96x3Kv5G/2WltpfhQ0pa3X57i139KSSZK0KGbWS8m878OWeILoCwzitxUdGLSFKJGTXvgfllZWVsJd4zbL7Ua1u0Y81pg/FbN+MrYx8X9uEQRivoBohwsVrh4xrlhPBD3i5vSe7YSYRqhryPnM8wUgpkPm8bYaaLd2/yKl7jP3++Da8PtQyNvsVz94LAxRImcUFT5yJFNf34C24x+o2rf/APY07sWhtw+r32iWtbQYR2plxfy/f4UID6s2Oe7JEv/3HjM0hFq/wun+dYYHsRkxdgjgwv9mpxWxmai1tQ5vsxjDbDDi+CVeRJ9p6e+DGAWt+33IF+tHd28Lzk/L6Vc3Nnsa0YtUVPgYhi4CZz+amsxKa2raB9/BN1WlUqtYfrKM5eXc2nT6RHoKphk505WCdZIotPTNpW66vLmO9A/bOWpKIqdI9pFEDP2/699gneg5bH3K0Y9J9NmzxT7tX9t63wfxNba6WtGv2b6hOd8Tcd1uudBzCu3eINTyT3fe63juWhNR6RUVPrW1dfjp3j1oM9OqfvxhTtXs3TtYWFhQtau2Fnv3vqF+o9lem04fMYowpxnmusnZzuns1MVaxJXrIC55Z4qbXt5cvz9YYR7fDQzlT7usxeTMObJpwEA4YPWTvs6bHUUtyqb7/G2F9Vpkn80fbb7PnK8tXPh96NLWnsLlfU8iPV70IoShoEf9uqdaLB/vRXd6+JN/HaKXpKjfcL51M4pvR0ewIqZVkstlZpkhPl6rrFTb7x//UC1A54tGp+DzerBz506rhYjKyQsLHzEnU9u76nZjR5VbTdFkk7yc/NBXdXR2fobqqip1HBGVl6LCR9d13JqK4sqVSfV84dEj9fi6mGq9c/hdtd3y1iH1T2kQEdmV7A9LiYi2gkMSInIEw4eIHMHwISJHMHyIyBEMHyJyBMOHiBzB8CEiRzB8iMgRDB8icgTDh4gcwfAhIkcwfIjIEQwfInIEw4eIHMHwISJHMHyIyBEMHyJyBMOHiBwA/D9WSfDqzt0A6QAAAABJRU5ErkJggg==",className:"h-[175px] w-[250px] m-4 border-2 border-black"})}),(0,r.jsx)("div",{className:"flex justify-center ".concat(n," items-center mt-2 border-4 border-dashed font-bold text-center hover:scale-105 border-black h-[150px] w-[250px] cursor-pointer p-4"),children:(0,r.jsx)(av,{updateColor:function(){i("bg-green-300 hover:bg-green-400")}})})]})})})},lv=function(e){var t=e.removeOverlay,n=y().csvErrorMessage1;return(0,r.jsx)("div",{className:"overlay_background",onClick:function(e){return t()},children:(0,r.jsxs)("div",{className:"overlay_card p-8 min-h-[400px] min-w-[600px]",onClick:function(e){return function(e){e.stopPropagation()}(e)},children:[(0,r.jsx)("div",{className:"mb-4 border-bottom",children:(0,r.jsx)("span",{style:{fontSize:40,display:"block"},children:"There was a file read error!"})}),(0,r.jsx)("div",{className:"m-4",children:(0,r.jsx)("span",{style:{fontSize:30,display:"block"},children:n})}),(0,r.jsx)("span",{style:{fontSize:30,display:"block"},children:"Please check your csv file data and try again"}),(0,r.jsx)("form",{className:"mt-8",onSubmit:function(e){e.preventDefault(),t()},children:(0,r.jsx)("button",{className:"btn btn-primary form_submit ",type:"submit",children:"Close"})})]})})},uv=[{label:"MS Excel",Component:Mp},{label:"PQMethod",Component:xt},{label:"KADE Zip",Component:function(){var e=y(),t=e.showCsvErrorModal,n=e.setShowCsvErrorModal;return(0,r.jsxs)("div",{id:"modal-root",className:"flex flex-row bg-gray-300 p-8 pt-2 min-w-[700px] h-[600px]",children:[(0,r.jsx)(sv,{}),(0,r.jsx)("div",{className:t?"overlay_shown":"overlay_hidden",children:(0,r.jsx)(lv,{removeOverlay:function(){n(!1)}})})]})}},{label:"Demo",Component:ev}],cv=function(){return(0,r.jsx)("div",{id:"dataTabs",className:"flex justify-center bg-gray-300 w-full rounded-md",children:(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(K.m,{tabs:uv,className:""})})})},dv=function(){var e=y(),t=e.projectName,n=e.hasImportedSorts,i=e.hasImportedStatements;return n&&i?(0,r.jsx)("div",{className:"mt-10 mb-4 font-bold text-4xl text-center",children:(0,r.jsx)("div",{children:(0,r.jsx)("h2",{children:t})})}):null},hv=function(){var e,t=y(),n=t.numStatements,i=t.numQsorts,o=t.qSortPattern;void 0!==o&&(e=o.toString());var a=n+" statements, "+i+" participants";return n?(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"w-full text-center mb-14",children:[(0,r.jsx)("h3",{children:a}),(0,r.jsxs)("h3",{className:"break-words  mt-4",children:["Q-sort Design: "," "+e]})]})}):null},fv=function(){var e=y(),t=e.hasImportedSorts,n=e.hasImportedStatements;return t&&n?(0,r.jsx)("h1",{className:"font-bold mt-4",children:"Statement List"}):null},pv=function(e){return(0,r.jsx)("ol",{className:"list-decimal",children:e.statements.map((function(e,t){return(0,r.jsx)("li",{children:e},t)}))})},vv=function(){var e=y().statements;return(0,r.jsxs)("div",{className:"mt-8 w-full text-center transition-opacity duration-700 ease-in opacity-100",children:[(0,r.jsx)(fv,{}),(0,r.jsx)("div",{className:"flex flex-col  items-center p-4",children:(0,r.jsx)("div",{className:"text-left",children:(0,r.jsx)(pv,{statements:e})})})]})},gv=function(){return(0,r.jsx)("h3",{className:"font-bold mt-10 text-center",children:"Participant Q sorts"})},mv={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},yv=new Uint8Array(16);function wv(){if(!Vp&&!(Vp="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Vp(yv)}for(var bv=[],Cv=0;Cv<256;++Cv)bv.push((Cv+256).toString(16).slice(1));function Sv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(bv[e[t+0]]+bv[e[t+1]]+bv[e[t+2]]+bv[e[t+3]]+"-"+bv[e[t+4]]+bv[e[t+5]]+"-"+bv[e[t+6]]+bv[e[t+7]]+"-"+bv[e[t+8]]+bv[e[t+9]]+"-"+bv[e[t+10]]+bv[e[t+11]]+bv[e[t+12]]+bv[e[t+13]]+bv[e[t+14]]+bv[e[t+15]]).toLowerCase()}var Ev=function(e,t,n){if(mv.randomUUID&&!t&&!e)return mv.randomUUID();var r=(e=e||{}).random||(e.rng||wv)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return Sv(r)},kv=function(e){return(0,r.jsx)("ul",{className:"mt-8 flex flex-col items-center ml-6",children:e.sortsDisplayText.map((function(t,n){return(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"mb-2 text-left font-bold",children:"".concat(n+1,". ").concat(e.respondentNames[n])},t.key),t.sortArray.map((function(e,n){return 0===n?(0,r.jsx)("li",{className:"whitespace-pre font-mono underline",children:e},"".concat(t.key,"_").concat(n)):(0,r.jsx)("li",{className:"whitespace-pre font-mono",children:e},"".concat(t.key,"_").concat(n,"_99"))})),(0,r.jsx)("br",{}),(0,r.jsx)("br",{})]},Ev())}))})},xv=n(8111),Tv=n.n(xv),Rv=function(e,t){return e[1]===t[1]?0:e[1]<t[1]?-1:1},Av=function(e,t){if(e[1]===t[1])return e[0]<[0]?1:-1},_v=function(e,t,n,r){for(var i,o=mt()(e),a=[],s="",l=wt(o),u=0;u<l.length;u++)s=l[u]<0?s+"| "+l[u]+" ":s+"|  "+l[u]+" ";s+="|";var c=[];if(void 0!==t)for(var d=0;d<t.length;d++){i=wt(t[d].rawSort);var h=wt(t[d].rawSort).sort((function(e,t){return e-t})),f=kp(wt(h)),p=Tv()(r,f),v=t[d].name;p?c.push(v):(v="".concat(v,"     ** Unforced Q Sort **"),c.push(v),1);var g=Math.max.apply(Math,wt(f)),m=rp()(n,i);m.sort(Rv);var y=JSON.parse(JSON.stringify(m));y.sort(Av);for(var w=[],b={},C=0;C<g;C++){for(var S="",E=!1,k=0;k<o.length;k++){for(var x=!1,T=0;T<y.length;T++){var R=y[T],A=y[T+1];if(R[1]===o[k])if(void 0!==A){if(R[1]!==A[1])if(R[1]>99)S+="".concat(R[0]," ").padStart(4," "),R[1]=999,x=!0,E=!0;else S+="".concat(R[0]," ").padStart(5," "),R[1]=999,x=!0,E=!0}else if(R[1]>99)S+="".concat(R[0]," ").padStart(4," "),R[1]=999,x=!0,E=!0;else S+="".concat(R[0]," ").padStart(5," "),R[1]=999,x=!0,E=!0}!1===x&&(!0===E?S+="     ":S="     "+S)}w.push(S)}w.unshift(s),b.sortArray=w,b.key=Ev(),a.push(b)}return a},Ov=function(){var e=y(),t=e.qSortPattern,n=e.respondentNames,i=e.mainDataObject,o=e.statementNumArray,a=e.multiplierArray,s=e.hasImportedSorts,l=e.hasImportedStatements,u=_v(t,i,o,a);return s&&l?(0,r.jsxs)("div",{className:"mt-8 text-center w-full",children:[(0,r.jsx)(gv,{}),(0,r.jsx)("div",{className:"text-left",children:(0,r.jsx)(kv,{sortsDisplayText:u,respondentNames:n})})]}):null},Dv=n(9110),Nv=n(4802),Pv=function(e,t){return e[1]===t[1]?0:e[1]<t[1]?-1:1},Fv=function(e,t){if(e[1]===t[1])return e[0]<[0]?1:-1},Iv=function(e,t,n,r,i){for(var o,a=mt()(e),s=[new Dv.Paragraph({children:[new Dv.TextRun({text:"Participant Q Sorts",bold:!0})],heading:Dv.HeadingLevel.HEADING_1,thematicBreak:!0,spacing:{before:400,after:400}})],l="",u=wt(a),c=0;c<u.length;c++)l=u[c]<0?l+"| "+u[c]+" ":l+"|  "+u[c]+" ";l+="|";var d=[],h=[];if(void 0!==n)for(var f=0;f<n.length;f++){o=n[f].rawSort;var p=wt(n[f].rawSort).sort((function(e,t){return e-t})),v=kp(wt(p)),g=Tv()(i,v),m=n[f].name;g||(m="".concat(m,"     ** Unforced Q Sort **")),d.push(m);var y=Math.max.apply(Math,wt(v)),w=rp()(r,o);w.sort(Pv);var b=JSON.parse(JSON.stringify(w));b.sort(Fv);for(var C=[],S=0;S<y;S++){for(var E="",k=!1,x=0;x<a.length;x++){for(var T=!1,R=0;R<b.length;R++){var A=b[R],_=b[R+1];if(A[1]===a[x])if(void 0!==_){if(A[1]!==_[1])if(A[1]>99)E+="".concat(A[0]," ").padStart(4," "),A[1]=999,k=!0,T=!0;else E+="".concat(A[0]," ").padStart(5," "),A[1]=999,k=!0,T=!0}else if(A[1]>99)E+="".concat(A[0]," ").padStart(4," "),A[1]=999,k=!0,T=!0;else E+="".concat(A[0]," ").padStart(5," "),A[1]=999,k=!0,T=!0}!1===T&&(!0===k?E+="     ":E="     "+E)}C.push(E)}var O=new Dv.Paragraph({children:[new Dv.TextRun({text:"".concat(f+1,". ").concat(d[f]),bold:!0})],heading:Dv.HeadingLevel.HEADING_6,spacing:{after:100,before:500}}),D=new Dv.Paragraph({children:[new Dv.TextRun({text:l,underline:{type:Dv.UnderlineType.SINGLE}})]});s.push(O,D);for(var N=0;N<C.length;N++){var P=new Dv.Paragraph({text:C[N]});s.push(P)}var F=new Dv.Paragraph({text:"".concat(n[f].name,": ").concat(n[f].displaySort),indent:{start:600,hanging:500},spacing:{after:100,before:500}});h.push(F)}return s.push.apply(s,h),s},Lv=function(e,t,n){var r,i=new Date,o=i.getMinutes();r=o<10?"0".concat(o):o;for(var a=i.getDate()+"/"+(i.getMonth()+1)+"/"+i.getFullYear()+" @ "+i.getHours()+":"+r,s=[new Dv.Paragraph({text:"Project: ".concat(t),heading:Dv.HeadingLevel.HEADING_1,spacing:{after:100}}),new Dv.Paragraph({text:"Downloaded: ".concat(a),spacing:{after:50}}),new Dv.Paragraph({text:"".concat(e.length," statements, ").concat(n.length," participants"),spacing:{after:400}}),new Dv.Paragraph({text:"Statements",heading:Dv.HeadingLevel.HEADING_1,thematicBreak:!0,spacing:{after:400}})],l=0;l<e.length;l++){var u=new Dv.Paragraph({text:e[l].trim(),numbering:{reference:"my-number-numbering-reference",level:0}});s.push(u)}return s},Mv=function(e){var t=e.handleClick,n=e.buttonText,i=e.buttonColor,o=e.otherFormatting;return void 0===i&&(i="bg-gray-100 hover:bg-gray-400"),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("button",{id:"ExportGeneralButton",className:"btn text-black m-2 ".concat(i," ").concat(o," rounded-md border border-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-700 focus:ring-opacity-70"),onClick:t,children:[(0,r.jsx)("svg",{className:"fill-current w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{d:"M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"})}),n]})})},Gv=function(){var t=y(),n=t.qSortPattern,i=t.respondentNames,o=t.mainDataObject,a=t.statementNumArray,s=t.multiplierArray,l=t.statements,u=t.projectName,c=Y((0,e.useState)("bg-gray-200 hover:bg-gray-400"),2),d=c[0],h=c[1],f=function(){var e=At(Tt().mark((function e(){var t,r,c,d,f;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Iv(n,i,o,a,s);case 2:t=e.sent,r=Lv(l,u,i),c=new Dv.Document({styles:{paragraphStyles:[{id:"Normal",name:"Normal",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{font:"Courier New",size:24}}]},numbering:{config:[{levels:[{level:0,format:Dv.LevelFormat.UPPER_ROMAN,text:"%1",alignment:Dv.AlignmentType.START,style:{paragraph:{indent:{left:(0,Dv.convertInchesToTwip)(.5),hanging:(0,Dv.convertInchesToTwip)(.18)}}}}],reference:"my-crazy-reference"},{levels:[{level:0,format:Dv.LevelFormat.DECIMAL,text:"%1",alignment:Dv.AlignmentType.START,style:{paragraph:{indent:{left:(0,Dv.convertInchesToTwip)(.3),hanging:(0,Dv.convertInchesToTwip)(.3)}}}}],reference:"my-number-numbering-reference"},{levels:[{level:0,format:Dv.LevelFormat.DECIMAL_ZERO,text:"[%1]",alignment:Dv.AlignmentType.START,style:{paragraph:{indent:{left:(0,Dv.convertInchesToTwip)(.5),hanging:(0,Dv.convertInchesToTwip)(.18)}}}}],reference:"padded-numbering-reference"}]},sections:[{children:r},{children:t}]}),d=new Date,f=d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()+"_"+d.getHours()+"-"+d.getMinutes(),Dv.Packer.toBlob(c).then((function(e){Nv.saveAs(e,"Ken-Q - ".concat(u," - ").concat(f,".docx")),console.log("Document created successfully")})),h("bg-green-300 hover:bg-green-400");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,r.jsx)(Mv,{handleClick:f,buttonText:"Download Databook docx",buttonColor:d})},Bv=function(e){var t="";return e.forEach((function(e){t+=e+"\n"})),t},jv=function(e){var t="";return e.forEach((function(n,r){t+="".concat(e[r].name,",").concat(e[r].displaySort,"\n")})),t},Hv=n(5587),Vv=function(){var t=new Hv,n=y(),i=n.mainDataObject,o=n.multiplierArray,a=n.statements,s=n.projectName,l=Y((0,e.useState)("bg-gray-100 hover:bg-gray-400"),2),u=l[0],c=l[1],d="",h=function(){var e=At(Tt().mark((function e(){var n,r,l;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Bv(a),t.file("statements.txt",n),r=jv(i),t.file("sorts.txt",r),t.file("name.txt",s),t.file("pattern.txt",o.toString()),l=new Date,d=l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate()+"_"+l.getHours()+"-"+l.getMinutes(),t.generateAsync({type:"blob"}).then((function(e){Nv.saveAs(e,"KADE ZIP - ".concat(s," - ").concat(d,".zip"))})),c("bg-green-300 hover:bg-green-400");case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,r.jsx)(Mv,{handleClick:h,buttonText:"Download KADE Zip",buttonColor:u})},Wv=function(e){var t=vt()(e),n=mt()(t);if(e.length!==n.length)for(var r=0;r<e.length;r++){var i=r+1,o=e[r].replace(/\./g,"");e[r]=i+"_"+o}else for(var a=0;a<e.length;a++)e[a]=e[a].replace(/\./g," ");return e},zv=function(e,t,n,r,i){var o=n.substring(0,60),a=e.length.toString().padStart(3," "),s=r.toString().padStart(3," "),l=[-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13],u=[];t.forEach((function(e,t){0!==e&&u.push(l[t])}));var c=Math.min.apply(Math,u).toString().padStart(3," "),d=Math.max.apply(Math,u).toString().padStart(3," "),h="";t.forEach((function(e,t){h+=e.toString().padStart(3," ")}));var f=i.map((function(e){return e.substring(0,8)})),p=[];e.forEach((function(e){var t="";e.rawSort.forEach((function(e){t+=e.toString().padStart(2," ")})),p.push(t)}));var v=Wv(f),g=[];e.forEach((function(e,t){g.push("".concat(v[t].padEnd(10," ")).concat(p[t],"\n"))}));var m="  0".concat(a).concat(s," ").concat(o,"\n")+"".concat(c).concat(d).concat(h,"\n");return p.forEach((function(e,t){m+="".concat(g[t])})),m},Uv=function(){var t=y(),n=t.respondentNames,i=t.mainDataObject,o=t.multiplierArray,a=t.statements,s=t.projectName,l=Y((0,e.useState)("bg-gray-100 hover:bg-gray-400"),2),u=l[0],c=l[1],d=function(){var e=At(Tt().mark((function e(){var t,r;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=zv(i,o,s,a.length,n),r=new Blob([t],{type:"text/plain;charset=ascii"}),Nv.saveAs(r,"".concat(s.substring(0,8),".DAT")),c("bg-green-300 hover:bg-green-400");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,r.jsx)(Mv,{handleClick:d,buttonText:"Download PQMethod DAT",buttonColor:u})},Kv=function(){var t=y(),n=t.statements,i=t.projectName,o=Y((0,e.useState)("bg-gray-100 hover:bg-gray-400"),2),a=o[0],s=o[1],l=function(){var e=At(Tt().mark((function e(){var t,r;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="",n.forEach((function(e){t+=e+"\n"})),r=new Blob([t],{type:"text/plain;charset=ascii"}),Nv.saveAs(r,"".concat(i.substring(0,8),".STA")),s("bg-green-300 hover:bg-green-400");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,r.jsx)(Mv,{handleClick:l,buttonText:"Download PQMethod STA",buttonColor:a})},qv=g()((function(e){return{gridColDefs:{},setGridColDefs:function(t){return e((function(e){return d(d({},e),{},{gridColDefs:t})}))},gridRowData:{},setGridRowData:function(t){return e((function(e){return d(d({},e),{},{gridRowData:t})}))},correlationTableArray:[],setCorrelationTableArray:function(t){return e((function(e){return d(d({},e),{},{correlationTableArray:t})}))},correlation5Calcs:{},setCorrelation5Calcs:function(t){return e((function(e){return d(d({},e),{},{correlation5Calcs:t})}))},showCorrelationMatrix:!1,setShowCorrelationMatrix:function(t){return e((function(e){return d(d({},e),{},{showCorrelationMatrix:t})}))},activeStartAnalysisButton:!1,setActiveStartAnalysisButton:function(t){return e((function(e){return d(d({},e),{},{activeStartAnalysisButton:t})}))},isLoadingBeginAnalysis:!0,setIsLoadingBeginAnalysis:function(t){return e((function(e){return d(d({},e),{},{isLoadingBeginAnalysis:t})}))},showUnforcedWarningModal:!1,setShowUnforcedWarningModal:function(t){return e((function(e){return d(d({},e),{},{showUnforcedWarningModal:t})}))},unforcedQsorts:[],setUnforcedQsorts:function(t){return e((function(e){return d(d({},e),{},{unforcedQsorts:t})}))},firstColMaxWidth:90,setFirstColMaxWidth:function(t){return e((function(e){return d(d({},e),{},{firstColMaxWidth:t})}))},colMaxWidth:90,setColMaxWidth:function(t){return e((function(e){return d(d({},e),{},{colMaxWidth:t})}))},showSection2:!1,setShowSection2:function(t){return e((function(e){return d(d({},e),{},{showSection2:t})}))}}})),Xv=qv,Yv=function(e){return e.map((function(e){return wt(e.rawSort)}))},Qv=function(){var e=0,t=wt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(e,t){return e.length>t.length?e:t})),n=document.createElement("canvas").getContext("2d");n.font="14px Arial",(e=n.measureText(t).width+30)>170&&(e=170),Xv.setState({firstColMaxWidth:e})},Zv=function(e,t){var n,r,i,o;return t|=0,i=(e*=n=Math.pow(10,t))%1===.5*(o=e>0|-(e<0)),r=Math.floor(e),i&&(e=r+(o>0)),(i?e:Math.round(e))/n},Jv=function(e,t){var n=e.length;if(0===n)return 0;for(var r=0,i=0;i<n;i+=1)r+=e[i];for(var o=0,a=0;a<n;a+=1)o+=t[a];for(var s=0,l=0;l<n;l+=1)s+=Math.pow(e[l],2);for(var u=0,c=0;c<n;c+=1)u+=Math.pow(t[c],2);for(var d=0,h=0;h<n;h+=1)d+=e[h]*t[h];var f=d-r*o/n,p=Math.sqrt((s-Math.pow(r,2)/n)*(u-Math.pow(o,2)/n));if(0===p)return 0;var v=f/p;return[Zv(v,5),Zv(100*v,0)]};var $v=function(e,t){e.length>0&&(!function(e,t){for(var n=t.length,r=vt()(e),i=[],o=[],a=Xv.getState().firstColMaxWidth,s=Xv.getState().colMaxWidth,l=0;l<n;l+=1)i[l]=[],o[l]=[];for(var u=0;u<n;u+=1){var c=r[u],d=Jv(r[u],r[u]);i[0][0]=d[0],o[0][0]=d[1];for(var h=u;h<n;h+=1){var f=Jv(c,r[h]);i[u][h]=f[0],o[u][h]=f[1],h!==u&&(i[h][u]=f[0],o[h][u]=f[1])}}var p=[];o.forEach((function(e,n){var r={};r.respondent=t[n],e.forEach((function(e,n){var i=t[n];r[i]=e})),p.push(r)}));var v=[],g={headerName:"Participant",field:"respondent",pinned:!0,sortable:!0};g.width=a,g.cellStyle={textAlign:"center"},v.push(g),t.forEach((function(e){var t={};t.headerName=e,t.field=e,t.pinned=!1,t.sortable=!0,t.editable=!1,t.width=s,t.cellStyle=function(e){return e.value<0?{textAlign:"right",color:"red"}:{textAlign:"right"}},v.push(t)})),Xv.setState({gridColDefs:v,gridRowData:p,correlationTableArray:o,correlation5Calcs:i})}(t,e),Xv.setState({showCorrelationMatrix:!0,activeStartAnalysisButton:!0,isLoadingBeginAnalysis:!1}),y.setState({isDataAlreadyLoaded:!0}))},eg=function(){var e=y.getState().mainDataObject,t=y.getState().respondentNames,n=y.getState().statements,r=y.getState().numQsorts,i=y.getState().qSortPattern,o={},a=!1,s=Math.max.apply(Math,wt(i)),l=Math.min.apply(Math,wt(i)),u=i.length;if(n.length<=2)return[a=!0,o={showModal:!0,titleText:"Data Error",bodyText:"No statements loaded.",bodyText2:"Check your input file for statements."}];if(0===r)return[a=!0,o={showModal:!0,titleText:"Data Error",bodyText:"No Q sorts loaded.",bodyText2:"Check your input file for Q sorts."}];var c=[],d=[];if(e.forEach((function(e,t){var n=wt(e.rawSort);n.every((function(e,t,n){return e===n[0]}))&&d.push(t+1),c.push(n)})),d.length>0){var h=d.join(", ");return[a=!0,o={showModal:!0,titleText:"Data Error",bodyText:"Q sorts #".concat(h," have no variance - Correlations cannot be calculated"),bodyText2:"Check your Q sorts input file."}]}if(u!==n.length)return[a=!0,o={showModal:!0,titleText:"Data Error",bodyText:"The number of Q sort values in the Q sort pattern does not match the number of statements in your project",bodyText2:"Check your Q sorts input file."}];var f=[],p=[],v=[];return c.forEach((function(e,n){var r=Math.max.apply(Math,wt(e)),i=Math.min.apply(Math,wt(e)),o=e.length;r>s&&f.push(t[n]),i<l&&p.push(t[n]),o!==u&&v.push(t[n])})),f.length>0?[a=!0,o={showModal:!0,titleText:"Data Error",bodyText:"There are Q sorts with values higher the Q sort pattern range - [".concat(f.join(", "),"]"),bodyText2:"Check your Q sorts input file."}]:p.length>0?[a=!0,o={showModal:!0,titleText:"Data Error",bodyText:"There are Q sorts with values lower the Q sort pattern range - [".concat(p.join(", "),"]"),bodyText2:"Check your Q sorts input file."}]:v.length>0?[a=!0,o={showModal:!0,titleText:"Data Error",bodyText:"There are Q sorts with missing values - [".concat(v.join(", "),"]"),bodyText2:"Check your Q sorts input file."}]:[a,o]},tg=function(e,t,n){var r=wt(t).sort().join(","),i=[];return e.forEach((function(e,t){var o=wt(e.rawSort).sort().join(",");r!==o&&i.push(n[t])})),i},ng=function(){var t=y(),n=t.respondentNames,i=t.mainDataObject,o=t.qSortPattern,a=t.continueAnalysis,s=t.setShowInputErrorModal,l=t.setUnforcedSorts;n=vt()(n);var u=Xv(),c=u.setShowCorrelationMatrix,d=u.setActiveStartAnalysisButton,h=u.setIsLoadingBeginAnalysis,f=u.setShowSection2,p=u.setShowUnforcedWarningModal,v=Y((0,e.useState)("bg-orange-300 hover:bg-orange-400"),2),g=v[0],m=v[1];return(0,r.jsx)("div",{className:"",children:(0,r.jsxs)("button",{className:"flex flex-row items-center h-[80px] w-[220px] ".concat(g,' rounded-md font-4xl font-bold border border-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-700 focus:ring-opacity-70"'),id:"startAnalysisButton",onClick:function(){var e=eg();if(!0===e[0])throw s(e[1]),y.setState({showWarningBox:!0}),new Error("Input Error");var t=tg(i,o,n);if(t.length>0&&(l(t),!1===a&&p(!0),m("bg-green-300 hover:bg-green-400")),n){Qv(n),i=vt()(i);var r=Yv(i);$v(n,r),c(!0),d(!0),h(!1),f(!0),m("bg-green-300 hover:bg-green-400")}else y.setState({showErrorMessageBar:!0,errorMessage:"No data to calculate correlations"})},children:[(0,r.jsxs)("svg",{className:"mt-[1px] mr-2 ml-4",width:"30",height:"30",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10C0 4.47715 4.47715 0 10 0C15.5228 0 20 4.47715 20 10ZM1.69669 10C1.69669 14.5858 5.41421 18.3033 10 18.3033C14.5858 18.3033 18.3033 14.5858 18.3033 10C18.3033 5.41421 14.5858 1.69669 10 1.69669C5.41421 1.69669 1.69669 5.41421 1.69669 10Z",fill:"#1E1E1E"}),(0,r.jsx)("path",{d:"M15 10L7.5 14.3301L7.5 5.66987L15 10Z",fill:"#1E1E1E"})]}),"Start Analysis"]})})},rg=function(e){var t=e.handleClick,n=e.buttonText,i=e.buttonColor,o=e.otherFormatting;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("button",{id:"onWhiteGeneralButton",className:"btn text-black ".concat(i," ").concat(o," hover:bg-gray-400 rounded-md border border-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-700 focus:ring-opacity-70"),onClick:t,children:n})})},ig=function(){var e=y().showInputErrorModal;return e.showModal&&(window.inputErrorModal.showModal(),e.showModal=!1),(0,r.jsx)("dialog",{id:"inputErrorModal",className:"modal",children:(0,r.jsxs)("form",{method:"dialog",className:"modal-box border-2 border-gray-600 rounded-md",children:[(0,r.jsx)("p",{id:"titleText",className:"text-2xl mb-2 font-bold",children:e.titleText}),(0,r.jsx)("hr",{className:"w-full mb-6 border border-gray-700"}),(0,r.jsx)("p",{className:"w-[350px] text-center",children:e.bodyText}),(0,r.jsx)("p",{className:"mt-4 w-[350px] text-center",children:e.bodyText2}),(0,r.jsx)("div",{className:"",children:(0,r.jsx)("div",{className:"flex flex-row w-[450px] place-content-around mt-2 mb-2",children:(0,r.jsx)(rg,{id:"inputErrorModalCloseButton",buttonColor:"bg-gray-300",otherFormatting:"modal-action",buttonText:"Close"})})})]})})},og=function(){var t=y(),n=t.unforcedSorts,i=t.respondentNames,o=t.mainDataObject,a=t.setContinueAnalysis,s=Xv(),l=s.showUnforcedWarningModal,u=s.setShowCorrelationMatrix,c=s.setActiveStartAnalysisButton,d=s.setIsLoadingBeginAnalysis,h=s.setShowSection2,f=s.setShowUnforcedWarningModal;(0,e.useEffect)((function(){l&&(window.unforcedWarningModal.showModal(),f(!1))}),[l,f]);return(0,r.jsx)("dialog",{id:"unforcedWarningModal",className:"modal",children:(0,r.jsxs)("form",{method:"dialog",className:"modal-box border-2 border-gray-600 rounded-md",children:[(0,r.jsx)("p",{id:"titleText",className:"text-2xl mb-2 font-bold",children:"Data Warning"}),(0,r.jsx)("hr",{className:"w-full mb-6 border border-gray-700"}),(0,r.jsx)("p",{className:"w-[350px] text-center",children:"There are Q sorts that don't follow the Q sort pattern - [ ".concat(n.join(", ")," ]")}),(0,r.jsxs)("p",{className:"mt-4 w-[350px] text-center",children:["If your project required forced sorting, these Q sorts have input errors. Check your Q sorts input file. ",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"If your project allowed free sorting, these Q sorts require manual checking for input errors."]}),(0,r.jsx)("div",{className:"",children:(0,r.jsxs)("div",{className:"flex flex-row w-[450px] place-content-around mt-2 mb-2",children:[(0,r.jsx)(rg,{id:"inputErrorModalCloseButton",buttonColor:"bg-gray-300",otherFormatting:"modal-action",buttonText:"Close"}),(0,r.jsx)(rg,{id:"inputErrorModalCloseButton",buttonColor:"bg-orange-300",otherFormatting:"modal-action",buttonText:"Continue with Analysis",handleClick:function(){if(a(!0),i){Qv(i),o=vt()(o);var e=Yv(o);$v(i,e),u(!0),c(!0),d(!1),h(!0)}}})]})})]})})},ag=function(){var e=y(),t=e.hasImportedSorts,n=e.hasImportedStatements;return t&&n?(0,r.jsxs)("div",{id:"S1GrayBoxContainerDiv",className:"flex flex-col items-center text-2xl bg-blue-100 rounded-md p-6",children:[(0,r.jsx)(U,{}),(0,r.jsx)(cv,{}),(0,r.jsxs)("div",{className:"flex flex-col items-center w-full bg-gray-300 rounded-md mt-8",children:[(0,r.jsx)("p",{className:"text-5xl mt-6",children:"Project Information"}),(0,r.jsxs)("div",{className:"overflow-x-auto overflow-y-auto rounded-md bg-gray-100 h-[800px] w-11/12 mt-6 mb-6",children:[(0,r.jsx)(dv,{}),(0,r.jsx)(hv,{}),(0,r.jsx)(vv,{}),(0,r.jsx)(Ov,{})]}),(0,r.jsxs)("div",{className:"flex flex-col w-22/24 bg-gray-300 rounded-md p-4",children:[(0,r.jsx)("p",{children:"Export Project Data:"}),(0,r.jsxs)("div",{className:"flex flex-row justify-between rounded-md bg-gray-300 p-2 mb-1",children:[(0,r.jsx)(Gv,{}),(0,r.jsx)(Vv,{}),(0,r.jsxs)("div",{children:[(0,r.jsx)(Kv,{}),(0,r.jsx)(Uv,{})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-row w-22/24 justify-start mt-8 mb-8",children:[(0,r.jsx)(ng,{}),(0,r.jsx)(ig,{}),(0,r.jsx)(og,{})]})]})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center mb-2 p-6 text-2xl bg-blue-100 rounded-md",children:[(0,r.jsx)(U,{}),(0,r.jsx)(cv,{})]})},sg=function(){return Xv().showSection2?(0,r.jsx)("div",{className:"my-7",children:(0,r.jsx)("a",{href:"https://github.com/shawnbanasick/ken-q-analysis/wiki/2.-CORRELATION-MATRIX",target:"_blank",rel:"noopener noreferrer",style:{targetNew:"tab"},children:(0,r.jsx)(V,{buttonId:"section2HelpButton",buttonText:"Help - Section 2"})})}):null},lg=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"render",value:function(){return(0,r.jsx)("div",{className:"m-8 w-10/12",children:(0,r.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,r.jsx)("div",{className:"flex flex-row",children:(0,r.jsx)("p",{className:"text-6xl my-4",children:"2. Correlations"})}),(0,r.jsx)(sg,{})]})})}}]),n}(e.Component),ug=lg;function cg(){return cg="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=D(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},cg.apply(this,arguments)}function dg(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=X(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function hg(e){return null==e||""===e?null:e}function fg(e){return null!=e&&(""!==e||arguments.length>1&&void 0!==arguments[1]&&arguments[1])}function pg(e){return!fg(e)}function vg(e){return null==e||0===e.length}function gg(e){return null!=e&&"function"===typeof e.toString?e.toString():null}function mg(e){if(void 0!==e){if(null===e||""===e)return null;if("number"===typeof e)return isNaN(e)?void 0:e;var t=parseInt(e,10);return isNaN(t)?void 0:t}}function yg(e){if(void 0!==e)return null!==e&&""!==e&&("boolean"===typeof e?e:/true/i.test(e))}function wg(e){if(e instanceof Set||e instanceof Map){var t=[];return e.forEach((function(e){return t.push(e)})),t}return Object.values(e)}var bg=Object.freeze({__proto__:null,makeNull:hg,exists:fg,missing:pg,missingOrEmpty:vg,toStringOrNull:gg,attrToNumber:mg,attrToBoolean:yg,attrToString:function(e){if(null!=e&&""!==e)return e},referenceCompare:function(e,t){return null==e&&null==t||(null!=e||null==t)&&((null==e||null!=t)&&e===t)},jsonEquals:function(e,t){return(e?JSON.stringify(e):null)===(t?JSON.stringify(t):null)},defaultComparator:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=null==e,i=null==t;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),r&&i)return 0;if(r)return-1;if(i)return 1;function o(e,t){return e>t?1:e<t?-1:0}if("string"!==typeof e)return o(e,t);if(!n)return o(e,t);try{return e.localeCompare(t)}catch(a){return o(e,t)}},values:wg}),Cg=function(){function e(){T(this,e),this.existingKeys={}}return A(e,[{key:"addExistingKeys",value:function(e){for(var t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}},{key:"getUniqueKey",value:function(e,t){e=gg(e);for(var n=0;;){var r=void 0;if(e?(r=e,0!==n&&(r+="_"+n)):t?(r=t,0!==n&&(r+="_"+n)):r=""+n,!this.existingKeys[r])return this.existingKeys[r]=!0,r;n++}}}]),e}();function Sg(e,t){null!=e&&(Array.isArray(e)?e.forEach((function(e,n){return t("".concat(n),e)})):Object.keys(e).forEach((function(n){return t(n,e[n])})))}function Eg(e){for(var t={},n=Object.keys(e),r=0;r<n.length;r++){var i=n[r],o=e[i];t[i]=o}return t}function kg(e,t){if(e){var n=e,r={};return Object.keys(n).forEach((function(e){if(!(t&&t.indexOf(e)>=0)){var i=n[e],o=Pg(i)&&i.constructor===Object;r[e]=o?kg(i):i}})),r}}function xg(e,t){return e[t]}function Tg(e,t,n){e[t]=n}function Rg(e,t,n,r){var i=xg(e,n);void 0!==i&&Tg(t,n,r?r(i):i)}function Ag(e){var t={};return e.filter((function(e){return null!=e})).forEach((function(e){Object.keys(e).forEach((function(e){return t[e]=null}))})),Object.keys(t)}function _g(e){if(!e)return[];var t=Object;if("function"===typeof t.values)return t.values(e);var n=[];for(var r in e)e.hasOwnProperty(r)&&e.propertyIsEnumerable(r)&&n.push(e[r]);return n}function Og(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];fg(t)&&Sg(t,(function(t,i){var o=e[t];if(o!==i){if(r)if(null==o&&null!=i)"object"===typeof i&&i.constructor===Object&&(o={},e[t]=o);Pg(i)&&Pg(o)&&!Array.isArray(o)?Og(o,i,n,r):(n||void 0!==i)&&(e[t]=i)}}))}function Dg(e,t,n){if(t&&e){if(!n)return e[t];for(var r=t.split("."),i=e,o=0;o<r.length;o++){if(null==i)return;i=i[r[o]]}return i}}function Ng(e,t){Object.keys(e).forEach((function(t){"object"===typeof e[t]&&(e[t]=void 0)}));var n=Object.getPrototypeOf(e),r={};Object.keys(n).forEach((function(e){if("function"===typeof n[e]){r[e]={value:function(){console.warn("AG Grid: ".concat(t," function ").concat(e,"() cannot be called as the grid has been destroyed.\n                     Please don't call grid API functions on destroyed grids - as a matter of fact you shouldn't\n                     be keeping the API reference, your application has a memory leak! Remove the API reference\n                     when the grid is destroyed."))},writable:!0}}})),Object.defineProperties(e,r)}function Pg(e){return"object"===typeof e&&null!==e}var Fg=Object.freeze({__proto__:null,iterateObject:Sg,cloneObject:Eg,deepCloneObject:function(e){return JSON.parse(JSON.stringify(e))},deepCloneDefinition:kg,getProperty:xg,setProperty:Tg,copyPropertiesIfPresent:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];r.forEach((function(n){return Rg(e,t,n)}))},copyPropertyIfPresent:Rg,getAllKeysInObjects:Ag,getAllValuesInObject:_g,mergeDeep:Og,missingOrEmptyObject:function(e){return pg(e)||0===Object.keys(e).length},get:function(e,t,n){if(null==e)return n;for(var r=t.split("."),i=e;r.length>1;)if(null==(i=i[r.shift()]))return n;var o=i[r[0]];return null!=o?o:n},set:function(e,t,n){if(null!=e){var r=t.split("."),i=e;r.forEach((function(e,t){i[e]||(i[e]={}),t<r.length-1&&(i=i[e])})),i[r[r.length-1]]=n}},getValueUsingField:Dg,removeAllReferences:Ng,isNonNullObject:Pg}),Ig={};function Lg(e,t){Ig[t]||(e(),Ig[t]=!0)}function Mg(e){if(e.name)return e.name;var t=/function\s+([^\(]+)/.exec(e.toString());return t&&2===t.length?t[1].trim():null}function Gg(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Bg(e){Wg(e,400)}var jg=[],Hg=!1;function Vg(e){jg.push(e),Hg||(Hg=!0,window.setTimeout((function(){var e=jg.slice();jg.length=0,Hg=!1,e.forEach((function(e){return e()}))}),0))}function Wg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.length>0&&window.setTimeout((function(){return e.forEach((function(e){return e()}))}),t)}function zg(e,t){var n;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=this;window.clearTimeout(n),n=window.setTimeout((function(){e.apply(a,i)}),t)}}function Ug(e,t){var n=0;return function(){var r=(new Date).getTime();if(!(r-n<t)){n=r;for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];e.apply(this,o)}}}function Kg(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3?arguments[3]:void 0,i=(new Date).getTime(),o=null,a=!1,s=function(){var s=(new Date).getTime()-i>n;(e()||s)&&(t(),a=!0,null!=o&&(window.clearInterval(o),o=null),s&&r&&console.warn(r))};s(),a||(o=window.setInterval(s,10))}function qg(e){e&&e()}var Xg,Yg=Object.freeze({__proto__:null,doOnce:Lg,getFunctionName:Mg,isFunction:Gg,executeInAWhile:Bg,executeNextVMTurn:Vg,executeAfter:Wg,debounce:zg,throttle:Ug,waitUntil:Kg,compose:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},callIfPresent:qg,noop:function(){}});!function(e){e.CommunityCoreModule="@ag-grid-community/core",e.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",e.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",e.CsvExportModule="@ag-grid-community/csv-export",e.EnterpriseCoreModule="@ag-grid-enterprise/core",e.RowGroupingModule="@ag-grid-enterprise/row-grouping",e.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",e.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",e.MenuModule="@ag-grid-enterprise/menu",e.SetFilterModule="@ag-grid-enterprise/set-filter",e.MultiFilterModule="@ag-grid-enterprise/multi-filter",e.StatusBarModule="@ag-grid-enterprise/status-bar",e.SideBarModule="@ag-grid-enterprise/side-bar",e.RangeSelectionModule="@ag-grid-enterprise/range-selection",e.MasterDetailModule="@ag-grid-enterprise/master-detail",e.RichSelectModule="@ag-grid-enterprise/rich-select",e.GridChartsModule="@ag-grid-enterprise/charts",e.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",e.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",e.ExcelExportModule="@ag-grid-enterprise/excel-export",e.ClipboardModule="@ag-grid-enterprise/clipboard",e.SparklinesModule="@ag-grid-enterprise/sparklines",e.AngularModule="@ag-grid-community/angular",e.ReactModule="@ag-grid-community/react",e.VueModule="@ag-grid-community/vue"}(Xg||(Xg={}));var Qg=function(){function e(){T(this,e)}return A(e,null,[{key:"register",value:function(t){e.__register(t,!0,void 0)}},{key:"registerModules",value:function(t){e.__registerModules(t,!0,void 0)}},{key:"__register",value:function(t,n,r){e.runVersionChecks(t),void 0!==r?(e.areGridScopedModules=!0,void 0===e.gridModulesMap[r]&&(e.gridModulesMap[r]={}),e.gridModulesMap[r][t.moduleName]=t):e.globalModulesMap[t.moduleName]=t,e.setModuleBased(n)}},{key:"__unRegisterGridModules",value:function(t){delete e.gridModulesMap[t]}},{key:"__registerModules",value:function(t,n,r){e.setModuleBased(n),t&&t.forEach((function(t){return e.__register(t,n,r)}))}},{key:"isValidModuleVersion",value:function(t){var n=Y(t.version.split(".")||[],2),r=n[0],i=n[1],o=Y(e.currentModuleVersion.split(".")||[],2),a=o[0],s=o[1];return r===a&&i===s}},{key:"runVersionChecks",value:function(t){if(e.currentModuleVersion||(e.currentModuleVersion=t.version),t.version?e.isValidModuleVersion(t)||console.error("AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '".concat(t.moduleName,"' is version ").concat(t.version," but the other modules are version ").concat(this.currentModuleVersion,". Please update all modules to the same version.")):console.error("AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '".concat(t.moduleName,"' is incompatible. Please update all modules to the same version.")),t.validate){var n=t.validate();if(!n.isValid){var r=n;console.error("AG Grid: ".concat(r.message))}}}},{key:"setModuleBased",value:function(t){void 0===e.moduleBased?e.moduleBased=t:e.moduleBased!==t&&Lg((function(){console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/packages-modules/ for more information.")}),"ModulePackageCheck")}},{key:"__setIsBundled",value:function(){e.isBundled=!0}},{key:"__assertRegistered",value:function(t,n,r){var i;if(this.__isRegistered(t,r))return!0;var o,a=n+t;if(e.isBundled)o="AG Grid: unable to use ".concat(n," as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:\n        \n        <script src=\"https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js\"><\/script>\n        \nFor more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise");else if(e.moduleBased||void 0===e.moduleBased){var s=null===(i=Object.entries(Xg).find((function(e){var n=Y(e,2);n[0];return n[1]===t})))||void 0===i?void 0:i[0];o="AG Grid: unable to use ".concat(n," as the ").concat(s," is not registered").concat(e.areGridScopedModules?" for gridId: ".concat(r):"",". Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { ").concat(s," } from '").concat(t,"';\n    \n    ModuleRegistry.registerModules([ ").concat(s," ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/")}else o="AG Grid: unable to use ".concat(n," as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';\n            \nFor more info see: https://www.ag-grid.com/javascript-grid/packages/");return Lg((function(){console.warn(o)}),a),!1}},{key:"__isRegistered",value:function(t,n){var r;return!!e.globalModulesMap[t]||!!(null===(r=e.gridModulesMap[n])||void 0===r?void 0:r[t])}},{key:"__getRegisteredModules",value:function(t){return[].concat(wt(wg(e.globalModulesMap)),wt(wg(e.gridModulesMap[t]||{})))}},{key:"__getGridRegisteredModules",value:function(t){var n;return wg(null!==(n=e.gridModulesMap[t])&&void 0!==n?n:{})||[]}},{key:"__isPackageBased",value:function(){return!e.moduleBased}}]),e}();Qg.globalModulesMap={},Qg.gridModulesMap={},Qg.areGridScopedModules=!1;var Zg=function(){function e(t,n){if(T(this,e),this.beanWrappers={},this.destroyed=!1,t&&t.beanClasses){this.contextParams=t,this.logger=n,this.logger.log(">> creating ag-Application Context"),this.createBeans();var r=this.getBeanInstances();this.wireBeans(r),this.logger.log(">> ag-Application Context ready - component is alive")}}return A(e,[{key:"getBeanInstances",value:function(){return wg(this.beanWrappers).map((function(e){return e.beanInstance}))}},{key:"createBean",value:function(e,t){if(!e)throw Error("Can't wire to bean since it is null");return this.wireBeans([e],t),e}},{key:"wireBeans",value:function(e,t){this.autoWireBeans(e),this.methodWireBeans(e),this.callLifeCycleMethods(e,"preConstructMethods"),fg(t)&&e.forEach(t),this.callLifeCycleMethods(e,"postConstructMethods")}},{key:"createBeans",value:function(){var e=this;this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),Sg(this.beanWrappers,(function(t,n){var r;n.bean.__agBeanMetaData&&n.bean.__agBeanMetaData.autowireMethods&&n.bean.__agBeanMetaData.autowireMethods.agConstructor&&(r=n.bean.__agBeanMetaData.autowireMethods.agConstructor);var i=e.getBeansForParameters(r,n.bean.name),o=new(n.bean.bind.apply(n.bean,[null].concat(wt(i))));n.beanInstance=o}));var t=Object.keys(this.beanWrappers).join(", ");this.logger.log("created beans: ".concat(t))}},{key:"createBeanWrapper",value:function(e){var t,n=e.__agBeanMetaData;if(!n)return t=e.prototype.constructor?Mg(e.prototype.constructor):""+e,void console.error("Context item ".concat(t," is not a bean"));var r={bean:e,beanInstance:null,beanName:n.beanName};this.beanWrappers[n.beanName]=r}},{key:"autoWireBeans",value:function(e){var t=this;e.forEach((function(e){t.forEachMetaDataInHierarchy(e,(function(n,r){var i=n.agClassAttributes;i&&i.forEach((function(n){var i=t.lookupBeanInstance(r,n.beanName,n.optional);e[n.attributeName]=i}))}))}))}},{key:"methodWireBeans",value:function(e){var t=this;e.forEach((function(e){t.forEachMetaDataInHierarchy(e,(function(n,r){Sg(n.autowireMethods,(function(n,i){if("agConstructor"!==n){var o=t.getBeansForParameters(i,r);e[n].apply(e,o)}}))}))}))}},{key:"forEachMetaDataInHierarchy",value:function(e,t){for(var n=Object.getPrototypeOf(e);null!=n;){var r=n.constructor;if(r.hasOwnProperty("__agBeanMetaData"))t(r.__agBeanMetaData,this.getBeanName(r));n=Object.getPrototypeOf(n)}}},{key:"getBeanName",value:function(e){if(e.__agBeanMetaData&&e.__agBeanMetaData.beanName)return e.__agBeanMetaData.beanName;var t=e.toString();return t.substring(9,t.indexOf("("))}},{key:"getBeansForParameters",value:function(e,t){var n=this,r=[];return e&&Sg(e,(function(e,i){var o=n.lookupBeanInstance(t,i);r[Number(e)]=o})),r}},{key:"lookupBeanInstance",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.destroyed)return this.logger.log("AG Grid: bean reference ".concat(t," is used after the grid is destroyed!")),null;if("context"===t)return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(t))return this.contextParams.providedBeanInstances[t];var r=this.beanWrappers[t];return r?r.beanInstance:(n||console.error("AG Grid: unable to find bean reference ".concat(t," while initialising ").concat(e)),null)}},{key:"callLifeCycleMethods",value:function(e,t){var n=this;e.forEach((function(e){return n.callLifeCycleMethodsOnBean(e,t)}))}},{key:"callLifeCycleMethodsOnBean",value:function(e,t,n){var r={};this.forEachMetaDataInHierarchy(e,(function(e){var i=e[t];i&&i.forEach((function(e){e!=n&&(r[e]=!0)}))})),Object.keys(r).forEach((function(t){return e[t]()}))}},{key:"getBean",value:function(e){return this.lookupBeanInstance("getBean",e,!0)}},{key:"destroy",value:function(){if(!this.destroyed){this.logger.log(">> Shutting down ag-Application Context");var e=this.getBeanInstances();this.destroyBeans(e),this.contextParams.providedBeanInstances=null,Qg.__unRegisterGridModules(this.contextParams.gridId),this.destroyed=!0,this.logger.log(">> ag-Application Context shut down - component is dead")}}},{key:"destroyBean",value:function(e){e&&this.destroyBeans([e])}},{key:"destroyBeans",value:function(e){var t=this;return e?(e.forEach((function(e){t.callLifeCycleMethodsOnBean(e,"preDestroyMethods","destroy");var n=e;"function"===typeof n.destroy&&n.destroy()})),[]):[]}},{key:"isDestroyed",value:function(){return this.destroyed}},{key:"getGridId",value:function(){return this.contextParams.gridId}}]),e}();function Jg(e,t,n){var r=am(e.constructor);r.preConstructMethods||(r.preConstructMethods=[]),r.preConstructMethods.push(t)}function $g(e,t,n){var r=am(e.constructor);r.postConstructMethods||(r.postConstructMethods=[]),r.postConstructMethods.push(t)}function em(e,t,n){var r=am(e.constructor);r.preDestroyMethods||(r.preDestroyMethods=[]),r.preDestroyMethods.push(t)}function tm(e){return function(t){am(t).beanName=e}}function nm(e){return function(t,n,r){im(t,e,!1,t,n,null)}}function rm(e){return function(t,n,r){im(t,e,!0,t,n,null)}}function im(e,t,n,r,i,o){if(null!==t)if("number"!==typeof o){var a=am(e.constructor);a.agClassAttributes||(a.agClassAttributes=[]),a.agClassAttributes.push({attributeName:i,beanName:t,optional:n})}else console.error("AG Grid: Autowired should be on an attribute");else console.error("AG Grid: Autowired name should not be null")}function om(e){return function(t,n,r){var i,o,a="function"==typeof t?t:t.constructor;"number"===typeof r&&(n?(i=am(a),o=n):(i=am(a),o="agConstructor"),i.autowireMethods||(i.autowireMethods={}),i.autowireMethods[o]||(i.autowireMethods[o]={}),i.autowireMethods[o][r]=e)}}function am(e){return e.hasOwnProperty("__agBeanMetaData")||(e.__agBeanMetaData={}),e.__agBeanMetaData}var sm=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},lm=function(e,t){return function(n,r){t(n,r,e)}},um=function(){function e(){T(this,e),this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}return A(e,[{key:"setBeans",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.frameworkOverrides=n,this.gridOptionsService=t,r){var i=t.useAsyncEvents();this.addGlobalListener(r,i)}}},{key:"getListeners",value:function(e,t,n){var r=t?this.allAsyncListeners:this.allSyncListeners,i=r.get(e);return!i&&n&&(i=new Set,r.set(e,i)),i}},{key:"noRegisteredListenersExist",value:function(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size}},{key:"addEventListener",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.getListeners(e,n,!0).add(t)}},{key:"removeEventListener",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getListeners(e,n,!1);r&&(r.delete(t),0===r.size&&(n?this.allAsyncListeners:this.allSyncListeners).delete(e))}},{key:"addGlobalListener",value:function(e){(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.globalAsyncListeners:this.globalSyncListeners).add(e)}},{key:"removeGlobalListener",value:function(e){(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}},{key:"dispatchEvent",value:function(e){var t=e;if(this.gridOptionsService){var n=this.gridOptionsService,r=n.api,i=n.columnApi,o=n.context;t.api=r,t.columnApi=i,t.context=o}this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0}},{key:"dispatchEventOnce",value:function(e){this.firedEvents[e.type]||this.dispatchEvent(e)}},{key:"dispatchToListeners",value:function(e,t){var n=this,r=e.type;if(t&&"event"in e){var i=e.event;i instanceof Event&&(e.eventPath=i.composedPath())}var o=new Set(this.getListeners(r,t,!1));o&&function(r){r.forEach((function(r){t?n.dispatchAsync((function(){return r(e)})):r(e)}))}(o),new Set(t?this.globalAsyncListeners:this.globalSyncListeners).forEach((function(i){t?n.dispatchAsync((function(){return n.frameworkOverrides.dispatchEvent(r,(function(){return i(r,e)}),!0)})):n.frameworkOverrides.dispatchEvent(r,(function(){return i(r,e)}),!0)}))}},{key:"dispatchAsync",value:function(e){this.asyncFunctionsQueue.push(e),this.scheduled||(window.setTimeout(this.flushAsyncQueue.bind(this),0),this.scheduled=!0)}},{key:"flushAsyncQueue",value:function(){this.scheduled=!1;var e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach((function(e){return e()}))}}]),e}();sm([lm(0,om("loggerFactory")),lm(1,om("gridOptionsService")),lm(2,om("frameworkOverrides")),lm(3,om("globalEventListener"))],um.prototype,"setBeans",null),um=sm([tm("eventService")],um);var cm=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},dm=0;function hm(){return dm++}var fm=function(){function e(t,n,r,i){T(this,e),this.instanceId=hm(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.filterActive=!1,this.eventService=new um,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=t,this.userProvidedColDef=n,this.colId=r,this.primary=i,this.setState(t)}return A(e,[{key:"getInstanceId",value:function(){return this.instanceId}},{key:"setState",value:function(e){void 0!==e.sort?"asc"!==e.sort&&"desc"!==e.sort||(this.sort=e.sort):"asc"!==e.initialSort&&"desc"!==e.initialSort||(this.sort=e.initialSort);var t=mg(e.sortIndex),n=mg(e.initialSortIndex);void 0!==t?null!==t&&(this.sortIndex=t):null!==n&&(this.sortIndex=n);var r=yg(e.hide),i=yg(e.initialHide);this.visible=void 0!==r?!r:!i,void 0!==e.pinned?this.setPinned(e.pinned):this.setPinned(e.initialPinned);var o=mg(e.flex),a=mg(e.initialFlex);void 0!==o?this.flex=o:void 0!==a&&(this.flex=a)}},{key:"setColDef",value:function(e,t){this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged","api"))}},{key:"getUserProvidedColDef",value:function(){return this.userProvidedColDef}},{key:"setParent",value:function(e){this.parent=e}},{key:"getParent",value:function(){return this.parent}},{key:"setOriginalParent",value:function(e){this.originalParent=e}},{key:"getOriginalParent",value:function(){return this.originalParent}},{key:"initialise",value:function(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.validate()}},{key:"initDotNotation",value:function(){var e=this.gridOptionsService.is("suppressFieldDotNotation");this.fieldContainsDots=fg(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!e,this.tooltipFieldContainsDots=fg(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!e}},{key:"initMinAndMaxWidths",value:function(){var e=this.colDef;this.minWidth=this.columnUtils.calculateColMinWidth(e),this.maxWidth=this.columnUtils.calculateColMaxWidth(e)}},{key:"initTooltip",value:function(){this.tooltipEnabled=fg(this.colDef.tooltipField)||fg(this.colDef.tooltipValueGetter)||fg(this.colDef.tooltipComponent)}},{key:"resetActualWidth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"api",t=this.columnUtils.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}},{key:"isEmptyGroup",value:function(){return!1}},{key:"isRowGroupDisplayed",value:function(e){if(pg(this.colDef)||pg(this.colDef.showRowGroup))return!1;var t=!0===this.colDef.showRowGroup,n=this.colDef.showRowGroup===e;return t||n}},{key:"isPrimary",value:function(){return this.primary}},{key:"isFilterAllowed",value:function(){return!!this.colDef.filter}},{key:"isFieldContainsDots",value:function(){return this.fieldContainsDots}},{key:"isTooltipEnabled",value:function(){return this.tooltipEnabled}},{key:"isTooltipFieldContainsDots",value:function(){return this.tooltipFieldContainsDots}},{key:"validate",value:function(){var e=this.colDef;function t(e,t,n){Lg((function(){n?console.warn(e,n):Lg((function(){return console.warn(e)}),t)}),t)}if(this.gridOptionsService.isRowModelType("clientSide")&&!Qg.__isRegistered(Xg.RowGroupingModule,this.gridOptionsService.getGridId())){var n=["enableRowGroup","rowGroup","rowGroupIndex","enablePivot","enableValue","pivot","pivotIndex","aggFunc"].filter((function(t){return fg(e[t])}));n.length>0&&Qg.__assertRegistered(Xg.RowGroupingModule,n.map((function(e){return"colDef."+e})).join(", "),this.gridOptionsService.getGridId())}if("agRichSelect"!==this.colDef.cellEditor&&"agRichSelectCellEditor"!==this.colDef.cellEditor||Qg.__assertRegistered(Xg.RichSelectModule,this.colDef.cellEditor,this.gridOptionsService.getGridId()),this.gridOptionsService.isTreeData()){var r=["rowGroup","rowGroupIndex","pivot","pivotIndex"].filter((function(t){return fg(e[t])}));r.length>0&&t("AG Grid: ".concat(r.join()," is not possible when doing tree data, your column definition should not have ").concat(r.join()),"TreeDataCannotRowGroup")}if(fg(e.menuTabs))if(Array.isArray(e.menuTabs)){var i=["filterMenuTab"],o=["columnsMenuTab","generalMenuTab"],a=o.filter((function(t){return e.menuTabs.includes(t)}));a.length>0&&Qg.__assertRegistered(Xg.MenuModule,"menuTab(s): ".concat(a.map((function(e){return"'".concat(e,"'")})).join()),this.gridOptionsService.getGridId()),e.menuTabs.forEach((function(e){o.includes(e)||i.includes(e)||t("AG Grid: '".concat(e,"' is not valid for 'colDef.menuTabs'. Valid values are: ").concat([].concat(i,o).map((function(e){return"'".concat(e,"'")})).join(),"."),"wrongValue_menuTabs_"+e)}))}else t("AG Grid: The typeof 'colDef.menuTabs' should be an array not:"+typeof e.menuTabs,"wrongType_menuTabs");fg(e.columnsMenuParams)&&Qg.__assertRegistered(Xg.MenuModule,"columnsMenuParams",this.gridOptionsService.getGridId()),fg(e.columnsMenuParams)&&Qg.__assertRegistered(Xg.ColumnsToolPanelModule,"columnsMenuParams",this.gridOptionsService.getGridId()),fg(this.colDef.width)&&"number"!==typeof this.colDef.width&&t("AG Grid: colDef.width should be a number, not "+typeof this.colDef.width,"ColumnCheck"),fg(e.columnGroupShow)&&"closed"!==e.columnGroupShow&&"open"!==e.columnGroupShow&&t("AG Grid: '".concat(e.columnGroupShow,"' is not valid for columnGroupShow. Valid values are 'open', 'closed', undefined, null"),"columnGroupShow_invalid")}},{key:"addEventListener",value:function(e,t){this.eventService.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){this.eventService.removeEventListener(e,t)}},{key:"createColumnFunctionCallbackParams",value:function(e){return{node:e,data:e.data,column:this,colDef:this.colDef,context:this.gridOptionsService.context,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi}}},{key:"isSuppressNavigable",value:function(e){if("boolean"===typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"===typeof this.colDef.suppressNavigable){var t=this.createColumnFunctionCallbackParams(e);return(0,this.colDef.suppressNavigable)(t)}return!1}},{key:"isCellEditable",value:function(e){return!(e.group&&!this.gridOptionsService.is("enableGroupEdit"))&&this.isColumnFunc(e,this.colDef.editable)}},{key:"isSuppressFillHandle",value:function(){return!!yg(this.colDef.suppressFillHandle)}},{key:"isAutoHeight",value:function(){return!!yg(this.colDef.autoHeight)}},{key:"isAutoHeaderHeight",value:function(){return!!yg(this.colDef.autoHeaderHeight)}},{key:"isRowDrag",value:function(e){return this.isColumnFunc(e,this.colDef.rowDrag)}},{key:"isDndSource",value:function(e){return this.isColumnFunc(e,this.colDef.dndSource)}},{key:"isCellCheckboxSelection",value:function(e){return this.isColumnFunc(e,this.colDef.checkboxSelection)}},{key:"isSuppressPaste",value:function(e){return this.isColumnFunc(e,this.colDef?this.colDef.suppressPaste:null)}},{key:"isResizable",value:function(){return!!yg(this.colDef.resizable)}},{key:"isColumnFunc",value:function(e,t){return"boolean"===typeof t?t:"function"===typeof t&&t(this.createColumnFunctionCallbackParams(e))}},{key:"setMoving",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.moving=e,this.eventService.dispatchEvent(this.createColumnEvent("movingChanged",t))}},{key:"createColumnEvent",value:function(e,t){return{type:e,column:this,columns:[this],source:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}}},{key:"isMoving",value:function(){return this.moving}},{key:"getSort",value:function(){return this.sort}},{key:"setSort",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.sort!==e&&(this.sort=e,this.eventService.dispatchEvent(this.createColumnEvent("sortChanged",t))),this.dispatchStateUpdatedEvent("sort")}},{key:"setMenuVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.menuVisible!==e&&(this.menuVisible=e,this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",t)))}},{key:"isMenuVisible",value:function(){return this.menuVisible}},{key:"isSortAscending",value:function(){return"asc"===this.sort}},{key:"isSortDescending",value:function(){return"desc"===this.sort}},{key:"isSortNone",value:function(){return pg(this.sort)}},{key:"isSorting",value:function(){return fg(this.sort)}},{key:"getSortIndex",value:function(){return this.sortIndex}},{key:"setSortIndex",value:function(e){this.sortIndex=e,this.dispatchStateUpdatedEvent("sortIndex")}},{key:"setAggFunc",value:function(e){this.aggFunc=e,this.dispatchStateUpdatedEvent("aggFunc")}},{key:"getAggFunc",value:function(){return this.aggFunc}},{key:"getLeft",value:function(){return this.left}},{key:"getOldLeft",value:function(){return this.oldLeft}},{key:"getRight",value:function(){return this.left+this.actualWidth}},{key:"setLeft",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.oldLeft=this.left,this.left!==e&&(this.left=e,this.eventService.dispatchEvent(this.createColumnEvent("leftChanged",t)))}},{key:"isFilterActive",value:function(){return this.filterActive}},{key:"setFilterActive",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api",n=arguments.length>2?arguments[2]:void 0;this.filterActive!==e&&(this.filterActive=e,this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",t)));var r=this.createColumnEvent("filterChanged",t);n&&Og(r,n),this.eventService.dispatchEvent(r)}},{key:"isHovered",value:function(){return this.columnHoverService.isHovered(this)}},{key:"setPinned",value:function(e){this.pinned=!0===e||"left"===e?"left":"right"===e?"right":null,this.dispatchStateUpdatedEvent("pinned")}},{key:"setFirstRightPinned",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.firstRightPinned!==e&&(this.firstRightPinned=e,this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",t)))}},{key:"setLastLeftPinned",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",t)))}},{key:"isFirstRightPinned",value:function(){return this.firstRightPinned}},{key:"isLastLeftPinned",value:function(){return this.lastLeftPinned}},{key:"isPinned",value:function(){return"left"===this.pinned||"right"===this.pinned}},{key:"isPinnedLeft",value:function(){return"left"===this.pinned}},{key:"isPinnedRight",value:function(){return"right"===this.pinned}},{key:"getPinned",value:function(){return this.pinned}},{key:"setVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api",n=!0===e;this.visible!==n&&(this.visible=n,this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged",t))),this.dispatchStateUpdatedEvent("hide")}},{key:"isVisible",value:function(){return this.visible}},{key:"isSpanHeaderHeight",value:function(){var e=this.getColDef();return!e.suppressSpanHeaderHeight&&!e.autoHeaderHeight}},{key:"getColDef",value:function(){return this.colDef}},{key:"getColumnGroupShow",value:function(){return this.colDef.columnGroupShow}},{key:"getColId",value:function(){return this.colId}},{key:"getId",value:function(){return this.colId}},{key:"getUniqueId",value:function(){return this.colId}},{key:"getDefinition",value:function(){return this.colDef}},{key:"getActualWidth",value:function(){return this.actualWidth}},{key:"getAutoHeaderHeight",value:function(){return this.autoHeaderHeight}},{key:"setAutoHeaderHeight",value:function(e){var t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}},{key:"createBaseColDefParams",value:function(e){return{node:e,data:e.data,colDef:this.colDef,column:this,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}}},{key:"getColSpan",value:function(e){if(pg(this.colDef.colSpan))return 1;var t=this.createBaseColDefParams(e),n=this.colDef.colSpan(t);return Math.max(n,1)}},{key:"getRowSpan",value:function(e){if(pg(this.colDef.rowSpan))return 1;var t=this.createBaseColDefParams(e),n=this.colDef.rowSpan(t);return Math.max(n,1)}},{key:"setActualWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];null!=this.minWidth&&(e=Math.max(e,this.minWidth)),null!=this.maxWidth&&(e=Math.min(e,this.maxWidth)),this.actualWidth!==e&&(this.actualWidth=e,this.flex&&"flex"!==t&&"gridInitializing"!==t&&(this.flex=null),n||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}},{key:"fireColumnWidthChangedEvent",value:function(e){this.eventService.dispatchEvent(this.createColumnEvent("widthChanged",e))}},{key:"isGreaterThanMax",value:function(e){return null!=this.maxWidth&&e>this.maxWidth}},{key:"getMinWidth",value:function(){return this.minWidth}},{key:"getMaxWidth",value:function(){return this.maxWidth}},{key:"getFlex",value:function(){return this.flex||0}},{key:"setFlex",value:function(e){this.flex!==e&&(this.flex=e),this.dispatchStateUpdatedEvent("flex")}},{key:"setMinimum",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"api";fg(this.minWidth)&&this.setActualWidth(this.minWidth,e)}},{key:"setRowGroupActive",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.rowGroupActive!==e&&(this.rowGroupActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",t))),this.dispatchStateUpdatedEvent("rowGroup")}},{key:"isRowGroupActive",value:function(){return this.rowGroupActive}},{key:"setPivotActive",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.pivotActive!==e&&(this.pivotActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",t))),this.dispatchStateUpdatedEvent("pivot")}},{key:"isPivotActive",value:function(){return this.pivotActive}},{key:"isAnyFunctionActive",value:function(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}},{key:"isAnyFunctionAllowed",value:function(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}},{key:"setValueActive",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.aggregationActive!==e&&(this.aggregationActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged",t)))}},{key:"isValueActive",value:function(){return this.aggregationActive}},{key:"isAllowPivot",value:function(){return!0===this.colDef.enablePivot}},{key:"isAllowValue",value:function(){return!0===this.colDef.enableValue}},{key:"isAllowRowGroup",value:function(){return!0===this.colDef.enableRowGroup}},{key:"getMenuTabs",value:function(e){var t=this.getColDef().menuTabs;return null==t&&(t=e),t}},{key:"dispatchStateUpdatedEvent",value:function(t){this.eventService.dispatchEvent({type:e.EVENT_STATE_UPDATED,key:t})}}]),e}();fm.EVENT_MOVING_CHANGED="movingChanged",fm.EVENT_LEFT_CHANGED="leftChanged",fm.EVENT_WIDTH_CHANGED="widthChanged",fm.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged",fm.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged",fm.EVENT_VISIBLE_CHANGED="visibleChanged",fm.EVENT_FILTER_CHANGED="filterChanged",fm.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged",fm.EVENT_SORT_CHANGED="sortChanged",fm.EVENT_COL_DEF_CHANGED="colDefChanged",fm.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged",fm.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged",fm.EVENT_PIVOT_CHANGED="columnPivotChanged",fm.EVENT_VALUE_CHANGED="columnValueChanged",fm.EVENT_STATE_UPDATED="columnStateUpdated",cm([nm("gridOptionsService")],fm.prototype,"gridOptionsService",void 0),cm([nm("columnUtils")],fm.prototype,"columnUtils",void 0),cm([nm("columnHoverService")],fm.prototype,"columnHoverService",void 0),cm([$g],fm.prototype,"initialise",null);var pm=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},vm=function(){function e(t,n,r,i){T(this,e),this.localEventService=new um,this.expandable=!1,this.instanceId=hm(),this.expandableListenerRemoveCallback=null,this.colGroupDef=t,this.groupId=n,this.expanded=!!t&&!!t.openByDefault,this.padding=r,this.level=i}return A(e,[{key:"destroy",value:function(){this.expandableListenerRemoveCallback&&this.reset(null,void 0)}},{key:"reset",value:function(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}},{key:"getInstanceId",value:function(){return this.instanceId}},{key:"setOriginalParent",value:function(e){this.originalParent=e}},{key:"getOriginalParent",value:function(){return this.originalParent}},{key:"getLevel",value:function(){return this.level}},{key:"isVisible",value:function(){return!!this.children&&this.children.some((function(e){return e.isVisible()}))}},{key:"isPadding",value:function(){return this.padding}},{key:"setExpanded",value:function(t){this.expanded=void 0!==t&&t;var n={type:e.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(n)}},{key:"isExpandable",value:function(){return this.expandable}},{key:"isExpanded",value:function(){return this.expanded}},{key:"getGroupId",value:function(){return this.groupId}},{key:"getId",value:function(){return this.getGroupId()}},{key:"setChildren",value:function(e){this.children=e}},{key:"getChildren",value:function(){return this.children}},{key:"getColGroupDef",value:function(){return this.colGroupDef}},{key:"getLeafColumns",value:function(){var e=[];return this.addLeafColumns(e),e}},{key:"addLeafColumns",value:function(t){this.children&&this.children.forEach((function(n){n instanceof fm?t.push(n):n instanceof e&&n.addLeafColumns(t)}))}},{key:"getColumnGroupShow",value:function(){var e=this.colGroupDef;if(e)return e.columnGroupShow}},{key:"setupExpandable",value:function(){var e=this;this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();var t=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach((function(e){return e.addEventListener("visibleChanged",t)})),this.expandableListenerRemoveCallback=function(){e.getLeafColumns().forEach((function(e){return e.removeEventListener("visibleChanged",t)})),e.expandableListenerRemoveCallback=null}}},{key:"setExpandable",value:function(){if(!this.isPadding()){for(var t=!1,n=!1,r=!1,i=this.findChildrenRemovingPadding(),o=0,a=i.length;o<a;o++){var s=i[o];if(s.isVisible()){var l=s.getColumnGroupShow();"open"===l?(t=!0,r=!0):"closed"===l?(n=!0,r=!0):(t=!0,n=!0)}}var u=t&&n&&r;if(this.expandable!==u){this.expandable=u;var c={type:e.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(c)}}}},{key:"findChildrenRemovingPadding",value:function(){var t=[];return function n(r){r.forEach((function(r){r instanceof e&&r.isPadding()?n(r.children):t.push(r)}))}(this.children),t}},{key:"onColumnVisibilityChanged",value:function(){this.setExpandable()}},{key:"addEventListener",value:function(e,t){this.localEventService.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){this.localEventService.removeEventListener(e,t)}}]),e}();vm.EVENT_EXPANDED_CHANGED="expandedChanged",vm.EVENT_EXPANDABLE_CHANGED="expandableChanged",pm([em],vm.prototype,"destroy",null);var gm={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function mm(){for(var e=0;e<arguments.length;e++){var t=e<0||arguments.length<=e?void 0:arguments[e];if(fg(t))return t}return null}function ym(e){if(e&&e.length)return e[e.length-1]}function wm(e,t,n){return null==e&&null==t||null!=e&&null!=t&&e.length===t.length&&e.every((function(e,r){return n?n(e,t[r]):t[r]===e}))}function bm(e){return e.sort((function(e,t){return e-t}))}function Cm(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}function Sm(e,t){t.forEach((function(t){return Cm(e,t)}))}function Em(e,t,n){e.splice(n,0,t)}function km(e,t,n){Sm(e,t),t.slice().reverse().forEach((function(t){return Em(e,t,n)}))}function xm(e,t){return e.indexOf(t)>-1}function Tm(e){return[].concat.apply([],e)}function Rm(e,t){null!=t&&null!=e&&t.forEach((function(t){return e.push(t)}))}var Am=Object.freeze({__proto__:null,firstExistingValue:mm,existsAndNotEmpty:function(e){return null!=e&&e.length>0},last:ym,areEqual:wm,shallowCompare:function(e,t){return wm(e,t)},sortNumerically:bm,removeRepeatsFromArray:function(e,t){if(e)for(var n=e.length-2;n>=0;n--){var r=e[n]===t,i=e[n+1]===t;r&&i&&e.splice(n+1,1)}},removeFromArray:Cm,removeAllFromArray:Sm,insertIntoArray:Em,insertArrayIntoArray:function(e,t,n){if(null!=e&&null!=t)for(var r=t.length-1;r>=0;r--){Em(e,t[r],n)}},moveInArray:km,includes:xm,flatten:Tm,pushAll:Rm,toStrings:function(e){return e.map(gg)},forEachReverse:function(e,t){if(null!=e)for(var n=e.length-1;n>=0;n--)t(e[n],n)}}),_m="__ag_Grid_Stop_Propagation",Om=["touchstart","touchend","touchmove","touchcancel","scroll"],Dm={};function Nm(e){e[_m]=!0}function Pm(e){return!0===e[_m]}var Fm=function(){var e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return function(t){if("boolean"===typeof Dm[t])return Dm[t];var n=document.createElement(e[t]||"div");return Dm[t="on"+t]=t in n}}();function Im(e,t,n){for(var r=t;r;){var i=e.getDomData(r,n);if(i)return i;r=r.parentElement}return null}function Lm(e,t){return!(!t||!e)&&Gm(t).indexOf(e)>=0}function Mm(e){for(var t=[],n=e.target;n;)t.push(n),n=n.parentElement;return t}function Gm(e){var t=e;return t.path?t.path:t.composedPath?t.composedPath():Mm(t)}function Bm(e,t,n,r){var i=xm(Om,n)?{passive:!0}:void 0;e&&e.addEventListener&&e.addEventListener(t,n,r,i)}var jm=Object.freeze({__proto__:null,stopPropagationForAgGrid:Nm,isStopPropagationForAgGrid:Pm,isEventSupported:Fm,getCtrlForEventTarget:Im,isElementInEventPath:Lm,createEventPath:Mm,getEventPath:Gm,addSafePassiveEventListener:Bm}),Hm=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Vm=function(){function e(){var t=this;T(this,e),this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.isAlive=function(){return!t.destroyed}}return A(e,[{key:"getFrameworkOverrides",value:function(){return this.frameworkOverrides}},{key:"getContext",value:function(){return this.context}},{key:"destroy",value:function(){this.destroyFunctions.forEach((function(e){return e()})),this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:e.EVENT_DESTROYED})}},{key:"addEventListener",value:function(e,t){this.localEventService||(this.localEventService=new um),this.localEventService.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){this.localEventService&&this.localEventService.removeEventListener(e,t)}},{key:"dispatchEventAsync",value:function(e){var t=this;window.setTimeout((function(){return t.dispatchEvent(e)}),0)}},{key:"dispatchEvent",value:function(e){this.localEventService&&this.localEventService.dispatchEvent(e)}},{key:"addManagedListener",value:function(e,t,n){var r=this;if(!this.destroyed){e instanceof HTMLElement?Bm(this.getFrameworkOverrides(),e,t,n):e.addEventListener(t,n);var i=function i(){return e.removeEventListener(t,n),r.destroyFunctions=r.destroyFunctions.filter((function(e){return e!==i})),null};return this.destroyFunctions.push(i),i}}},{key:"addManagedPropertyListener",value:function(e,t){var n=this;if(!this.destroyed){this.gridOptionsService.addEventListener(e,t);var r=function r(){return n.gridOptionsService.removeEventListener(e,t),n.destroyFunctions=n.destroyFunctions.filter((function(e){return e!==r})),null};return this.destroyFunctions.push(r),r}}},{key:"addDestroyFunc",value:function(e){this.isAlive()?this.destroyFunctions.push(e):e()}},{key:"createManagedBean",value:function(e,t){var n=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),n}},{key:"createBean",value:function(e,t,n){return(t||this.getContext()).createBean(e,n)}},{key:"destroyBean",value:function(e,t){return(t||this.getContext()).destroyBean(e)}},{key:"destroyBeans",value:function(e,t){var n=this;return e&&e.forEach((function(e){return n.destroyBean(e,t)})),[]}}]),e}();Vm.EVENT_DESTROYED="destroyed",Hm([nm("frameworkOverrides")],Vm.prototype,"frameworkOverrides",void 0),Hm([nm("context")],Vm.prototype,"context",void 0),Hm([nm("eventService")],Vm.prototype,"eventService",void 0),Hm([nm("gridOptionsService")],Vm.prototype,"gridOptionsService",void 0),Hm([nm("localeService")],Vm.prototype,"localeService",void 0),Hm([nm("environment")],Vm.prototype,"environment",void 0),Hm([em],Vm.prototype,"destroy",null);var Wm,zm,Um=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Km=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"setBeans",value:function(e){this.logger=e.create("ColumnFactory")}},{key:"createColumnTree",value:function(e,t,n){var r=new Cg,i=this.extractExistingTreeData(n),o=i.existingCols,a=i.existingGroups,s=i.existingColKeys;r.addExistingKeys(s);var l=this.recursivelyCreateColumns(e,0,t,o,r,a),u=this.findMaxDept(l,0);this.logger.log("Number of levels for grouped columns is "+u);var c=this.balanceColumnTree(l,0,u,r);return this.columnUtils.depthFirstOriginalTreeSearch(null,c,(function(e,t){e instanceof vm&&e.setupExpandable(),e.setOriginalParent(t)})),{columnTree:c,treeDept:u}}},{key:"extractExistingTreeData",value:function(e){var t=[],n=[],r=[];return e&&this.columnUtils.depthFirstOriginalTreeSearch(null,e,(function(e){if(e instanceof vm){var i=e;n.push(i)}else{var o=e;r.push(o.getId()),t.push(o)}})),{existingCols:t,existingGroups:n,existingColKeys:r}}},{key:"createForAutoGroups",value:function(e,t){var n=this;return e.map((function(e){return n.createAutoGroupTreeItem(t,e)}))}},{key:"createAutoGroupTreeItem",value:function(e,t){for(var n=t,r=this.findDepth(e)-1;r>=0;r--){var i=new vm(null,"FAKE_PATH_".concat(t.getId(),"}_").concat(r),!0,r);this.createBean(i),i.setChildren([n]),n.setOriginalParent(i),n=i}return n}},{key:"findDepth",value:function(e){for(var t=0,n=e;n&&n[0]&&n[0]instanceof vm;)t++,n=n[0].getChildren();return t}},{key:"balanceColumnTree",value:function(e,t,n,r){for(var i=[],o=0;o<e.length;o++){var a=e[o];if(a instanceof vm){var s=a,l=this.balanceColumnTree(s.getChildren(),t+1,n,r);s.setChildren(l),i.push(s)}else{for(var u=void 0,c=void 0,d=n-1;d>=t;d--){var h=r.getUniqueKey(null,null),f=this.createMergedColGroupDef(null),p=new vm(f,h,!0,t);this.createBean(p),c&&c.setChildren([p]),c=p,u||(u=c)}if(u&&c){if(i.push(u),e.some((function(e){return e instanceof vm}))){c.setChildren([a]);continue}c.setChildren(e);break}i.push(a)}}return i}},{key:"findMaxDept",value:function(e,t){for(var n=t,r=0;r<e.length;r++){var i=e[r];if(i instanceof vm){var o=i,a=this.findMaxDept(o.getChildren(),t+1);n<a&&(n=a)}}return n}},{key:"recursivelyCreateColumns",value:function(e,t,n,r,i,o){var a=this;return(e||[]).map((function(e){return a.isColumnGroup(e)?a.createColumnGroup(n,e,t,r,i,o):a.createColumn(n,e,r,i)}))}},{key:"createColumnGroup",value:function(e,t,n,r,i,o){var a=this.createMergedColGroupDef(t),s=i.getUniqueKey(a.groupId||null,null),l=new vm(a,s,!1,n);this.createBean(l);var u=this.findExistingGroup(t,o);u&&Cm(o,u),u&&u.isExpanded()&&l.setExpanded(!0);var c=this.recursivelyCreateColumns(a.children,n+1,e,r,i,o);return l.setChildren(c),l}},{key:"createMergedColGroupDef",value:function(e){var t={};return Object.assign(t,this.gridOptionsService.get("defaultColGroupDef")),Object.assign(t,e),t}},{key:"createColumn",value:function(e,t,n,r){var i=this.findExistingColumn(t,n);if(n&&i&&Cm(n,i),i){var o=this.mergeColDefs(t,i.getColId());i.setColDef(o,t),this.applyColumnState(i,o)}else{var a=r.getUniqueKey(t.colId,t.field),s=this.mergeColDefs(t,a);i=new fm(s,t,a,e),this.context.createBean(i)}return this.dataTypeService.addColumnListeners(i),i}},{key:"applyColumnState",value:function(e,t){var n=mg(t.flex);if(void 0!==n&&e.setFlex(n),e.getFlex()<=0){var r=mg(t.width);if(null!=r)e.setActualWidth(r);else{var i=e.getActualWidth();e.setActualWidth(i)}}void 0!==t.sort&&("asc"==t.sort||"desc"==t.sort?e.setSort(t.sort):e.setSort(void 0));var o=mg(t.sortIndex);void 0!==o&&e.setSortIndex(o);var a=yg(t.hide);void 0!==a&&e.setVisible(!a),void 0!==t.pinned&&e.setPinned(t.pinned)}},{key:"findExistingColumn",value:function(e,t){return(t||[]).find((function(t){var n=t.getUserProvidedColDef();if(!n)return!1;var r=null!=e.colId,i=null!=e.field;return r?t.getId()===e.colId:i?n.field===e.field:n===e}))}},{key:"findExistingGroup",value:function(e,t){return t.find((function(t){return!!t.getColGroupDef()&&(!(null==e.groupId)&&t.getId()===e.groupId)}))}},{key:"mergeColDefs",value:function(e,t){var n={};Og(n,this.gridOptionsService.get("defaultColDef"),!1,!0);var r=this.dataTypeService.updateColDefAndGetColumnType(n,e,t);r&&this.assignColumnTypes(r,n),Og(n,e,!1,!0);var i=this.gridOptionsService.get("autoGroupColumnDef"),o=this.gridOptionsService.isColumnsSortingCoupledToGroup();return e.rowGroup&&i&&o&&Og(n,{sort:i.sort,initialSort:i.initialSort},!1,!0),this.dataTypeService.validateColDef(n),n}},{key:"assignColumnTypes",value:function(e,t){if(e.length){var n=Object.assign({},gm);Sg(this.gridOptionsService.get("columnTypes")||{},(function(e,t){e in n?console.warn("AG Grid: the column type '".concat(e,"' is a default column type and cannot be overridden.")):n[e]=t})),e.forEach((function(e){var r=n[e.trim()];r?Og(t,r,!1,!0):console.warn("AG Grid: colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes")}))}}},{key:"isColumnGroup",value:function(e){return void 0!==e.children}}]),n}(Vm);Um([nm("columnUtils")],Km.prototype,"columnUtils",void 0),Um([nm("dataTypeService")],Km.prototype,"dataTypeService",void 0),Um([(Wm=0,zm=om("loggerFactory"),function(e,t){zm(e,t,Wm)})],Km.prototype,"setBeans",null),Km=Um([tm("columnFactory")],Km);var qm=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Xm=function(){function e(t,n,r,i){T(this,e),this.displayedChildren=[],this.localEventService=new um,this.groupId=n,this.partId=r,this.providedColumnGroup=t,this.pinned=i}return A(e,[{key:"reset",value:function(){this.parent=null,this.children=null,this.displayedChildren=null}},{key:"getParent",value:function(){return this.parent}},{key:"setParent",value:function(e){this.parent=e}},{key:"getUniqueId",value:function(){return e.createUniqueId(this.groupId,this.partId)}},{key:"isEmptyGroup",value:function(){return 0===this.displayedChildren.length}},{key:"isMoving",value:function(){var e=this.getProvidedColumnGroup().getLeafColumns();return!(!e||0===e.length)&&e.every((function(e){return e.isMoving()}))}},{key:"checkLeft",value:function(){if(this.displayedChildren.forEach((function(t){t instanceof e&&t.checkLeft()})),this.displayedChildren.length>0)if(this.gridOptionsService.is("enableRtl")){var t=ym(this.displayedChildren).getLeft();this.setLeft(t)}else{var n=this.displayedChildren[0].getLeft();this.setLeft(n)}else this.setLeft(null)}},{key:"getLeft",value:function(){return this.left}},{key:"getOldLeft",value:function(){return this.oldLeft}},{key:"setLeft",value:function(t){this.oldLeft=t,this.left!==t&&(this.left=t,this.localEventService.dispatchEvent(this.createAgEvent(e.EVENT_LEFT_CHANGED)))}},{key:"getPinned",value:function(){return this.pinned}},{key:"createAgEvent",value:function(e){return{type:e}}},{key:"addEventListener",value:function(e,t){this.localEventService.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){this.localEventService.removeEventListener(e,t)}},{key:"getGroupId",value:function(){return this.groupId}},{key:"getPartId",value:function(){return this.partId}},{key:"isChildInThisGroupDeepSearch",value:function(t){var n=!1;return this.children.forEach((function(r){t===r&&(n=!0),r instanceof e&&r.isChildInThisGroupDeepSearch(t)&&(n=!0)})),n}},{key:"getActualWidth",value:function(){var e=0;return this.displayedChildren&&this.displayedChildren.forEach((function(t){e+=t.getActualWidth()})),e}},{key:"isResizable",value:function(){if(!this.displayedChildren)return!1;var e=!1;return this.displayedChildren.forEach((function(t){t.isResizable()&&(e=!0)})),e}},{key:"getMinWidth",value:function(){var e=0;return this.displayedChildren.forEach((function(t){e+=t.getMinWidth()||0})),e}},{key:"addChild",value:function(e){this.children||(this.children=[]),this.children.push(e)}},{key:"getDisplayedChildren",value:function(){return this.displayedChildren}},{key:"getLeafColumns",value:function(){var e=[];return this.addLeafColumns(e),e}},{key:"getDisplayedLeafColumns",value:function(){var e=[];return this.addDisplayedLeafColumns(e),e}},{key:"getDefinition",value:function(){return this.providedColumnGroup.getColGroupDef()}},{key:"getColGroupDef",value:function(){return this.providedColumnGroup.getColGroupDef()}},{key:"isPadding",value:function(){return this.providedColumnGroup.isPadding()}},{key:"isExpandable",value:function(){return this.providedColumnGroup.isExpandable()}},{key:"isExpanded",value:function(){return this.providedColumnGroup.isExpanded()}},{key:"setExpanded",value:function(e){this.providedColumnGroup.setExpanded(e)}},{key:"addDisplayedLeafColumns",value:function(t){this.displayedChildren.forEach((function(n){n instanceof fm?t.push(n):n instanceof e&&n.addDisplayedLeafColumns(t)}))}},{key:"addLeafColumns",value:function(t){this.children.forEach((function(n){n instanceof fm?t.push(n):n instanceof e&&n.addLeafColumns(t)}))}},{key:"getChildren",value:function(){return this.children}},{key:"getColumnGroupShow",value:function(){return this.providedColumnGroup.getColumnGroupShow()}},{key:"getProvidedColumnGroup",value:function(){return this.providedColumnGroup}},{key:"getPaddingLevel",value:function(){var e=this.getParent();return this.isPadding()&&e&&e.isPadding()?1+e.getPaddingLevel():0}},{key:"calculateDisplayedColumns",value:function(){var t=this;this.displayedChildren=[];for(var n=this;null!=n&&n.isPadding();)n=n.getParent();if(!(!!n&&n.providedColumnGroup.isExpandable()))return this.displayedChildren=this.children,void this.localEventService.dispatchEvent(this.createAgEvent(e.EVENT_DISPLAYED_CHILDREN_CHANGED));this.children.forEach((function(r){if(!(r instanceof e&&(!r.displayedChildren||!r.displayedChildren.length)))switch(r.getColumnGroupShow()){case"open":n.providedColumnGroup.isExpanded()&&t.displayedChildren.push(r);break;case"closed":n.providedColumnGroup.isExpanded()||t.displayedChildren.push(r);break;default:t.displayedChildren.push(r)}})),this.localEventService.dispatchEvent(this.createAgEvent(e.EVENT_DISPLAYED_CHILDREN_CHANGED))}}],[{key:"createUniqueId",value:function(e,t){return e+"_"+t}}]),e}();Xm.EVENT_LEFT_CHANGED="leftChanged",Xm.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged",qm([nm("gridOptionsService")],Xm.prototype,"gridOptionsService",void 0);var Ym=A((function e(){T(this,e)}));Ym.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged",Ym.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded",Ym.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged",Ym.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged",Ym.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll",Ym.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged",Ym.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged",Ym.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged",Ym.EVENT_COLUMN_MOVED="columnMoved",Ym.EVENT_COLUMN_VISIBLE="columnVisible",Ym.EVENT_COLUMN_PINNED="columnPinned",Ym.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened",Ym.EVENT_COLUMN_RESIZED="columnResized",Ym.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged",Ym.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged",Ym.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed",Ym.EVENT_ROW_GROUP_OPENED="rowGroupOpened",Ym.EVENT_ROW_DATA_CHANGED="rowDataChanged",Ym.EVENT_ROW_DATA_UPDATED="rowDataUpdated",Ym.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged",Ym.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged",Ym.EVENT_CHART_CREATED="chartCreated",Ym.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged",Ym.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged",Ym.EVENT_CHART_DESTROYED="chartDestroyed",Ym.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged",Ym.EVENT_TOOL_PANEL_SIZE_CHANGED="toolPanelSizeChanged",Ym.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart",Ym.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd",Ym.EVENT_MODEL_UPDATED="modelUpdated",Ym.EVENT_CUT_START="cutStart",Ym.EVENT_CUT_END="cutEnd",Ym.EVENT_PASTE_START="pasteStart",Ym.EVENT_PASTE_END="pasteEnd",Ym.EVENT_FILL_START="fillStart",Ym.EVENT_FILL_END="fillEnd",Ym.EVENT_RANGE_DELETE_START="rangeDeleteStart",Ym.EVENT_RANGE_DELETE_END="rangeDeleteEnd",Ym.EVENT_UNDO_STARTED="undoStarted",Ym.EVENT_UNDO_ENDED="undoEnded",Ym.EVENT_REDO_STARTED="redoStarted",Ym.EVENT_REDO_ENDED="redoEnded",Ym.EVENT_KEY_SHORTCUT_CHANGED_CELL_START="keyShortcutChangedCellStart",Ym.EVENT_KEY_SHORTCUT_CHANGED_CELL_END="keyShortcutChangedCellEnd",Ym.EVENT_CELL_CLICKED="cellClicked",Ym.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked",Ym.EVENT_CELL_MOUSE_DOWN="cellMouseDown",Ym.EVENT_CELL_CONTEXT_MENU="cellContextMenu",Ym.EVENT_CELL_VALUE_CHANGED="cellValueChanged",Ym.EVENT_CELL_EDIT_REQUEST="cellEditRequest",Ym.EVENT_ROW_VALUE_CHANGED="rowValueChanged",Ym.EVENT_CELL_FOCUSED="cellFocused",Ym.EVENT_CELL_FOCUS_CLEARED="cellFocusCleared",Ym.EVENT_FULL_WIDTH_ROW_FOCUSED="fullWidthRowFocused",Ym.EVENT_ROW_SELECTED="rowSelected",Ym.EVENT_SELECTION_CHANGED="selectionChanged",Ym.EVENT_CELL_KEY_DOWN="cellKeyDown",Ym.EVENT_CELL_MOUSE_OVER="cellMouseOver",Ym.EVENT_CELL_MOUSE_OUT="cellMouseOut",Ym.EVENT_FILTER_CHANGED="filterChanged",Ym.EVENT_FILTER_MODIFIED="filterModified",Ym.EVENT_FILTER_OPENED="filterOpened",Ym.EVENT_SORT_CHANGED="sortChanged",Ym.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved",Ym.EVENT_ROW_CLICKED="rowClicked",Ym.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked",Ym.EVENT_GRID_READY="gridReady",Ym.EVENT_GRID_SIZE_CHANGED="gridSizeChanged",Ym.EVENT_VIEWPORT_CHANGED="viewportChanged",Ym.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged",Ym.EVENT_FIRST_DATA_RENDERED="firstDataRendered",Ym.EVENT_DRAG_STARTED="dragStarted",Ym.EVENT_DRAG_STOPPED="dragStopped",Ym.EVENT_CHECKBOX_CHANGED="checkboxChanged",Ym.EVENT_ROW_EDITING_STARTED="rowEditingStarted",Ym.EVENT_ROW_EDITING_STOPPED="rowEditingStopped",Ym.EVENT_CELL_EDITING_STARTED="cellEditingStarted",Ym.EVENT_CELL_EDITING_STOPPED="cellEditingStopped",Ym.EVENT_BODY_SCROLL="bodyScroll",Ym.EVENT_BODY_SCROLL_END="bodyScrollEnd",Ym.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged",Ym.EVENT_PAGINATION_CHANGED="paginationChanged",Ym.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged",Ym.EVENT_STORE_REFRESHED="storeRefreshed",Ym.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged",Ym.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged",Ym.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged",Ym.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged",Ym.EVENT_FLASH_CELLS="flashCells",Ym.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged",Ym.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged",Ym.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged",Ym.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged",Ym.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged",Ym.EVENT_HEADER_HEIGHT_CHANGED="headerHeightChanged",Ym.EVENT_COLUMN_HEADER_HEIGHT_CHANGED="columnHeaderHeightChanged",Ym.EVENT_ROW_DRAG_ENTER="rowDragEnter",Ym.EVENT_ROW_DRAG_MOVE="rowDragMove",Ym.EVENT_ROW_DRAG_LEAVE="rowDragLeave",Ym.EVENT_ROW_DRAG_END="rowDragEnd",Ym.EVENT_GRID_STYLES_CHANGED="gridStylesChanged",Ym.EVENT_POPUP_TO_FRONT="popupToFront",Ym.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest",Ym.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest",Ym.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest",Ym.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest",Ym.EVENT_KEYBOARD_FOCUS="keyboardFocus",Ym.EVENT_MOUSE_FOCUS="mouseFocus",Ym.EVENT_STORE_UPDATED="storeUpdated",Ym.EVENT_FILTER_DESTROYED="filterDestroyed",Ym.EVENT_ROW_DATA_UPDATE_STARTED="rowDataUpdateStarted";var Qm=function(){function e(){T(this,e),this.existingIds={}}return A(e,[{key:"getInstanceIdForKey",value:function(e){var t,n=this.existingIds[e];return t="number"!==typeof n?0:n+1,this.existingIds[e]=t,t}}]),e}(),Zm=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Jm="ag-Grid-AutoColumn",$m=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"createAutoGroupColumns",value:function(e,t){var n=this,r=[],i=this.gridOptionsService.isTreeData(),o=this.gridOptionsService.isGroupMultiAutoColumn();return i&&o&&(console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),o=!1),o?t.forEach((function(t,i){r.push(n.createOneAutoGroupColumn(e,t,i))})):r.push(this.createOneAutoGroupColumn(e)),r}},{key:"createOneAutoGroupColumn",value:function(e,t,n){var r,i=this.generateDefaultColDef(t);(r=t?"".concat(Jm,"-").concat(t.getId()):Jm,Og(i,this.gridOptionsService.get("autoGroupColumnDef")),(i=this.columnFactory.mergeColDefs(i,r)).colId=r,this.gridOptionsService.isTreeData())||pg(i.field)&&pg(i.valueGetter)&&pg(i.filterValueGetter)&&"agGroupColumnFilter"!==i.filter&&(i.filter=!1);n&&n>0&&(i.headerCheckboxSelection=!1);var o=e.find((function(e){return e.getId()==r})),a=this.gridOptionsService.isColumnsSortingCoupledToGroup();if(o)return a&&(i.sort=void 0,i.sortIndex=void 0),o.setColDef(i,null),this.columnFactory.applyColumnState(o,i),o;a&&(i.sort||i.initialSort||"sortIndex"in i)&&!i.field&&(i.sort=null,i.sortIndex=null,i.initialSort=null);var s=new fm(i,null,r,!0);return this.context.createBean(s),s}},{key:"generateDefaultColDef",value:function(e){var t=this.gridOptionsService.get("autoGroupColumnDef"),n={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(t&&(t.cellRenderer||t.cellRendererSelector)||(n.cellRenderer="agGroupCellRenderer"),e){var r=e.getColDef();Object.assign(n,{headerName:this.columnModel.getDisplayNameForColumn(e,"header"),headerValueGetter:r.headerValueGetter}),r.cellRenderer&&Object.assign(n,{cellRendererParams:{innerRenderer:r.cellRenderer,innerRendererParams:r.cellRendererParams}}),n.showRowGroup=e.getColId()}else n.showRowGroup=!0;return n}}]),n}(Vm);Zm([nm("columnModel")],$m.prototype,"columnModel",void 0),Zm([nm("columnFactory")],$m.prototype,"columnFactory",void 0),$m=Zm([tm("autoGroupColService")],$m);var ey=/[&<>"']/g,ty={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function ny(e){return e[0].toUpperCase()+e.substr(1).toLowerCase()}function ry(e,t){if(null==e)return null;var n=e.toString().toString();return t?n:n.replace(ey,(function(e){return ty[e]}))}function iy(e){if(!e||null==e)return null;return e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map((function(e){return e.substring(0,1).toUpperCase()+(e.length>1?e.substring(1,e.length):"")})).join(" ")}function oy(e){return e.replace(/[A-Z]/g,(function(e){return"-".concat(e.toLocaleLowerCase())}))}var ay=Object.freeze({__proto__:null,utf8_encode:function(e){var t=String.fromCharCode;function n(e,n){return t(e>>n&63|128)}function r(e){if(e>=0&&e<=31&&10!==e){var r=e.toString(16).toUpperCase().padStart(4,"0");return"_x".concat(r,"_")}if(0==(4294967168&e))return t(e);var i="";return 0==(4294965248&e)?i=t(e>>6&31|192):0==(4294901760&e)?(!function(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}(e),i=t(e>>12&15|224),i+=n(e,6)):0==(4292870144&e)&&(i=t(e>>18&7|240),i+=n(e,12),i+=n(e,6)),i+=t(63&e|128)}for(var i=function(e){var t=[];if(!e)return[];for(var n,r,i=e.length,o=0;o<i;)(n=e.charCodeAt(o++))>=55296&&n<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?t.push(((1023&n)<<10)+(1023&r)+65536):(t.push(n),o--):t.push(n);return t}(e),o=i.length,a=-1,s="";++a<o;)s+=r(i[a]);return s},capitalise:ny,escapeString:ry,camelCaseToHumanText:iy,camelCaseToHyphenated:oy});function sy(e){var t=new Map;return e.forEach((function(e){return t.set(e[0],e[1])})),t}var ly=Object.freeze({__proto__:null,convertToMap:sy,mapById:function(e,t){var n=new Map;return e.forEach((function(e){return n.set(t(e),e)})),n},keys:function(e){var t=[];return e.forEach((function(e,n){return t.push(n)})),t}}),uy=A((function e(){T(this,e)}));uy.ColDefPropertyMap={headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0},uy.ALL_PROPERTIES=Object.keys(uy.ColDefPropertyMap);var cy=A((function e(){T(this,e)}));cy.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","serverSideStoreType","groupDisplayType","treeDataDisplayType","colResizeDefault"],cy.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions"],cy.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass"],cy.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","tabIndex"],cy.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHorizontalScroll","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSelectsChildren","groupIncludeFooter","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","rememberGroupStateWhenNewData","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","excludeHiddenColumnsFromQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","treeData","masterDetail","suppressMultiRangeSelection","enterMovesDown","enterMovesDownAfterEdit","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","enableChartToolPanelsButton","suppressChartToolPanelsButton","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilteringAlwaysResets","serverSideFilterAllLevels","serverSideSortingAlwaysResets","serverSideSortAllLevels","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","suppressReactUi","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","suppressCutToClipboard"],cy.FUNCTIONAL_PROPERTIES=["doesExternalFilterPass","processSecondaryColDef","processSecondaryColGroupDef","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer"],cy.CALLBACK_PROPERTIES=["getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideStoreParams","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","groupAggFiltering"],cy.FUNCTION_PROPERTIES=[].concat(wt(cy.FUNCTIONAL_PROPERTIES),wt(cy.CALLBACK_PROPERTIES)),cy.ALL_PROPERTIES=[].concat(wt(cy.ARRAY_PROPERTIES),wt(cy.OBJECT_PROPERTIES),wt(cy.STRING_PROPERTIES),wt(cy.NUMBER_PROPERTIES),wt(cy.FUNCTION_PROPERTIES),wt(cy.BOOLEAN_PROPERTIES));var dy=function(){function e(){T(this,e)}return A(e,null,[{key:"getCallbackForEvent",value:function(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substr(1)}},{key:"getCoercionLookup",value:function(){var t={};return[].concat(wt(e.ARRAY_PROPERTIES),wt(e.OBJECT_PROPERTIES),wt(e.STRING_PROPERTIES),wt(e.FUNCTION_PROPERTIES),wt(e.EVENT_CALLBACKS)).forEach((function(e){return t[e]="none"})),e.BOOLEAN_PROPERTIES.forEach((function(e){return t[e]="boolean"})),e.NUMBER_PROPERTIES.forEach((function(e){return t[e]="number"})),t}},{key:"getValue",value:function(t,n){var r=e.coercionLookup[t];if(r){var i=n;switch(r){case"number":i=e.toNumber(n);break;case"boolean":i=e.toBoolean(n);break;case"none":"groupAggFiltering"===t&&"function"!==typeof n&&(i=e.toBoolean(n))}return i}}},{key:"getGridOptionKeys",value:function(t,n){return n?Object.keys(e.coercionLookup):Object.keys(t)}},{key:"copyAttributesToGridOptions",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];"object"!==typeof t&&(t={});var i=t;return e.getGridOptionKeys(n,r).forEach((function(t){var r=n[t];if("undefined"!==typeof r){var o=e.getValue(t,r);void 0!==o&&(i[t]=o)}})),t}},{key:"processOnChange",value:function(t,n){if(t&&0!==Object.keys(t).length){var r=Object.assign({},t);r.columnTypes&&(n.setColumnTypes(r.columnTypes.currentValue,"gridOptionsChanged"),delete r.columnTypes),r.autoGroupColumnDef&&(n.setAutoGroupColumnDef(r.autoGroupColumnDef.currentValue,"gridOptionsChanged"),delete r.autoGroupColumnDef),r.defaultColDef&&(n.setDefaultColDef(r.defaultColDef.currentValue,"gridOptionsChanged"),delete r.defaultColDef),r.columnDefs&&(n.setColumnDefs(r.columnDefs.currentValue,"gridOptionsChanged"),delete r.columnDefs),Object.keys(r).forEach((function(t){var i=t,o=e.getValue(i,r[i].currentValue);n.__setProperty(i,o)}));var i={type:Ym.EVENT_COMPONENT_STATE_CHANGED};Sg(t,(function(e,t){i[e]=t})),n.dispatchEvent(i)}}},{key:"toBoolean",value:function(e){return"boolean"===typeof e?e:"string"===typeof e&&("TRUE"===e.toUpperCase()||""==e)}},{key:"toNumber",value:function(e){return"number"===typeof e?e:"string"===typeof e?Number(e):void 0}}]),e}();function hy(e,t,n){var r={},i=e.filter((function(e){return!t.some((function(t){return t===e}))}));return i.length>0&&i.forEach((function(e){return r[e]=fy(e,n)})),r}function fy(e,t,n,r){var i=t.map((function(t){return{value:t,relevance:py(e.toLowerCase(),t.toLocaleLowerCase())}}));if(i.sort((function(e,t){return t.relevance-e.relevance})),n&&(i=i.filter((function(e){return 0!==e.relevance}))),r&&r>0){var o=i[0].relevance*r;i=i.filter((function(e){return o-e.relevance<0}))}return i.map((function(e){return e.value}))}function py(e,t){for(var n=e.replace(/\s/g,""),r=t.replace(/\s/g,""),i=0,o=-1,a=0;a<n.length;a++){var s=r.indexOf(n[a],o+1);-1!==s&&(i+=100-100*(o=s)/1e4*100)}return i}dy.EVENTS=wg(Ym),dy.EXCLUDED_INTERNAL_EVENTS=[Ym.EVENT_SCROLLBAR_WIDTH_CHANGED,Ym.EVENT_CHECKBOX_CHANGED,Ym.EVENT_HEIGHT_SCALE_CHANGED,Ym.EVENT_BODY_HEIGHT_CHANGED,Ym.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,Ym.EVENT_SCROLL_VISIBILITY_CHANGED,Ym.EVENT_COLUMN_HOVER_CHANGED,Ym.EVENT_FLASH_CELLS,Ym.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,Ym.EVENT_DISPLAYED_ROWS_CHANGED,Ym.EVENT_LEFT_PINNED_WIDTH_CHANGED,Ym.EVENT_RIGHT_PINNED_WIDTH_CHANGED,Ym.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,Ym.EVENT_POPUP_TO_FRONT,Ym.EVENT_KEYBOARD_FOCUS,Ym.EVENT_MOUSE_FOCUS,Ym.EVENT_STORE_UPDATED,Ym.EVENT_COLUMN_PANEL_ITEM_DRAG_START,Ym.EVENT_COLUMN_PANEL_ITEM_DRAG_END,Ym.EVENT_FILL_START,Ym.EVENT_FILL_END,Ym.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,Ym.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,Ym.EVENT_FULL_WIDTH_ROW_FOCUSED,Ym.EVENT_HEADER_HEIGHT_CHANGED,Ym.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,Ym.EVENT_CELL_FOCUS_CLEARED,Ym.EVENT_GRID_STYLES_CHANGED,Ym.EVENT_FILTER_DESTROYED,Ym.EVENT_ROW_DATA_UPDATE_STARTED],dy.PUBLIC_EVENTS=dy.EVENTS.filter((function(e){return!xm(dy.EXCLUDED_INTERNAL_EVENTS,e)})),dy.EVENT_CALLBACKS=dy.EVENTS.map((function(e){return dy.getCallbackForEvent(e)})),dy.STRING_PROPERTIES=cy.STRING_PROPERTIES,dy.OBJECT_PROPERTIES=cy.OBJECT_PROPERTIES,dy.ARRAY_PROPERTIES=cy.ARRAY_PROPERTIES,dy.NUMBER_PROPERTIES=cy.NUMBER_PROPERTIES,dy.BOOLEAN_PROPERTIES=cy.BOOLEAN_PROPERTIES,dy.FUNCTION_PROPERTIES=cy.FUNCTION_PROPERTIES,dy.ALL_PROPERTIES=cy.ALL_PROPERTIES,dy.ALL_PROPERTIES_SET=new Set(cy.ALL_PROPERTIES),dy.coercionLookup=dy.getCoercionLookup();var vy=Object.freeze({__proto__:null,fuzzyCheckStrings:hy,fuzzySuggestions:fy}),gy=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};function my(e,t,n,r){var i=n?"Please use '".concat(n,"' instead. "):"";Lg((function(){return console.warn("AG Grid: since v".concat(e,", '").concat(t,"' is deprecated. ").concat(i).concat(null!==r&&void 0!==r?r:""))}),"Deprecated_".concat(t))}var yy=["__ob__","__v_skip","__metadata__"],wy=function(){function e(){T(this,e),this.deprecatedProperties={rememberGroupStateWhenNewData:{version:"24",message:"Now that transaction updates are possible and they keep group state, this feature is no longer needed."},serverSideFilteringAlwaysResets:{version:"28.0",newProp:"serverSideOnlyRefreshFilteredGroups",copyToNewProp:!0},serverSideSortingAlwaysResets:{version:"28.0",newProp:"serverSideSortAllLevels",copyToNewProp:!0},suppressReactUi:{version:"28",message:"The legacy React rendering engine is deprecated and will be removed in the next major version of the grid."},processSecondaryColDef:{version:"28",newProp:"processPivotResultColDef",copyToNewProp:!0},processSecondaryColGroupDef:{version:"28",newProp:"processPivotResultColGroupDef",copyToNewProp:!0},getServerSideStoreParams:{version:"28",newProp:"getServerSideGroupLevelParams",copyToNewProp:!0},serverSideInfiniteScroll:{version:"29",message:"Infinite Scrolling is now the default behaviour. This can be suppressed with `suppressServerSideInfiniteScroll`."},enableChartToolPanelsButton:{version:"29",message:"The Chart Tool Panels button is now enabled by default. To hide the Chart Tool Panels button and display the hamburger button instead, set suppressChartToolPanelsButton=true."},functionsPassive:{version:"29.2"},onColumnRowGroupChangeRequest:{version:"29.2"},onColumnPivotChangeRequest:{version:"29.2"},onColumnValueChangeRequest:{version:"29.2"},onColumnAggFuncChangeRequest:{version:"29.2"},serverSideFilterAllLevels:{version:"30",message:"All server-side group levels are now filtered by default. This can be toggled using `serverSideOnlyRefreshFilteredGroups`."},suppressAggAtRootLevel:{version:"30",message:"The root level aggregation is now suppressed by default. This can be toggled using  `alwaysAggregateAtRootLevel`."},excludeHiddenColumnsFromQuickFilter:{version:"30",message:"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `includeHiddenColumnsInQuickFilter`."},enterMovesDown:{version:"30",newProp:"enterNavigatesVertically",copyToNewProp:!0},enterMovesDownAfterEdit:{version:"30",newProp:"enterNavigatesVerticallyAfterEdit",copyToNewProp:!0}}}return A(e,[{key:"pickOneWarning",value:function(e,t){console.warn("AG Grid: ".concat(e," and ").concat(t," do not work with each other, you need to pick one."))}},{key:"init",value:function(){var e=this;if(this.checkForDeprecated(),this.checkForViolations(),!0!==this.gridOptions.suppressPropertyNamesCheck&&(this.checkGridOptionsProperties(),this.checkColumnDefProperties()),this.checkColumnDefViolations(),this.gridOptionsService.is("groupSelectsChildren")&&this.gridOptionsService.is("suppressParentsInRowNodes")&&console.warn("AG Grid: 'groupSelectsChildren' does not work with 'suppressParentsInRowNodes', this selection method needs the part in rowNode to work"),this.gridOptionsService.is("groupSelectsChildren")&&"multiple"!==this.gridOptionsService.get("rowSelection")&&console.warn("AG Grid: rowSelection must be 'multiple' for groupSelectsChildren to make sense"),this.gridOptionsService.is("groupRemoveSingleChildren")&&this.gridOptionsService.is("groupHideOpenParents")&&this.pickOneWarning("groupRemoveSingleChildren","groupHideOpenParents"),this.gridOptionsService.isRowModelType("serverSide")){var t=function(e,t){return"AG Grid: '".concat(e,"' is not supported on the Server-Side Row Model.")+(t?" Please use ".concat(t," instead."):"")};this.gridOptionsService.exists("groupDefaultExpanded")&&console.warn(t("groupDefaultExpanded","isServerSideGroupOpenByDefault callback")),this.gridOptionsService.exists("groupIncludeFooter")&&this.gridOptionsService.is("suppressServerSideInfiniteScroll")&&console.warn(t("groupIncludeFooter")),this.gridOptionsService.exists("groupIncludeTotalFooter")&&console.warn(t("groupIncludeTotalFooter"))}this.gridOptionsService.is("enableRangeSelection")?Qg.__assertRegistered(Xg.RangeSelectionModule,"enableRangeSelection",this.gridOptionsService.getGridId()):(this.gridOptionsService.is("enableRangeHandle")||this.gridOptionsService.is("enableFillHandle"))&&console.warn("AG Grid: 'enableRangeHandle' or 'enableFillHandle' will not work unless 'enableRangeSelection' is set to true");var n=function(t,n){return e.gridOptionsService.exists(t)&&Qg.__assertRegistered(n,t,e.gridOptionsService.getGridId())};n("sideBar",Xg.SideBarModule),n("statusBar",Xg.StatusBarModule),n("enableCharts",Xg.GridChartsModule),n("getMainMenuItems",Xg.MenuModule),n("getContextMenuItems",Xg.MenuModule),n("allowContextMenuWithControlKey",Xg.MenuModule)}},{key:"checkColumnDefProperties",value:function(){var e=this;if(null!=this.gridOptions.columnDefs){var t=uy.ALL_PROPERTIES,n=function n(r,i){var o=Object.getOwnPropertyNames(r);e.checkProperties(o,[].concat(wt(t),yy),t,i,"https://www.ag-grid.com/javascript-data-grid/column-properties/"),r.children&&r.children.forEach((function(e){return n(e,"columnDefs.children")}))};this.gridOptions.columnDefs.forEach((function(e){return n(e,"columnDefs")})),this.gridOptions.defaultColDef&&n(this.gridOptions.defaultColDef,"defaultColDef")}}},{key:"checkColumnDefViolations",value:function(){var e,t=null!==(e=this.gridOptionsService.get("rowModelType"))&&void 0!==e?e:"clientSide",n={infinite:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],viewport:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],serverSide:["headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],clientSide:[]}[t];if(null===n||void 0===n?void 0:n.length){var r=function(e){n.forEach((function(n){n in e&&e[n]&&console.warn("AG Grid: Column property ".concat(n," is not supported with the row model type ").concat(t,"."))}))};null!=this.gridOptions.columnDefs&&this.gridOptions.columnDefs.forEach((function(e){return r(e)})),null!=this.gridOptions.autoGroupColumnDef&&r(this.gridOptions.autoGroupColumnDef),null!=this.gridOptions.defaultColDef&&r(this.gridOptions.defaultColDef)}}},{key:"checkGridOptionsProperties",value:function(){var e=Object.getOwnPropertyNames(this.gridOptions),t=[].concat(wt(cy.ALL_PROPERTIES),wt(dy.EVENT_CALLBACKS)),n=[].concat(wt(t),["api","columnApi"],yy,wt(Object.keys(this.deprecatedProperties)));this.checkProperties(e,n,t,"gridOptions","https://www.ag-grid.com/javascript-data-grid/grid-options/")}},{key:"checkProperties",value:function(e,t,n,r,i){var o=hy(e,t,n);Sg(o,(function(e,t){Lg((function(){return console.warn("AG Grid: invalid ".concat(r," property '").concat(e,"' did you mean any of these: ").concat(t.slice(0,8).join(", ")))}),"invalidProperty"+r+e)})),Object.keys(o).length>0&&Lg((function(){return console.warn("AG Grid: to see all the valid ".concat(r," properties please check: ").concat(i))}),"invalidProperties"+r+i)}},{key:"checkForDeprecated",value:function(){var e=this.gridOptions;Object.entries(this.deprecatedProperties).forEach((function(t){var n,r=Y(t,2),i=r[0],o=r[1],a=e[i];a&&(my(o.version,i,o.newProp,o.message),o.copyToNewProp&&o.newProp&&null==e[o.newProp]&&(e[o.newProp]=null!==(n=o.newPropValue)&&void 0!==n?n:a))})),e.serverSideStoreType&&(console.warn("AG Grid: since v29.0, `serverSideStoreType` has been replaced by `suppressServerSideInfiniteScroll`. Set to false to use Partial Store, and true to use Full Store."),e.suppressServerSideInfiniteScroll="partial"!==e.serverSideStoreType)}},{key:"checkForViolations",value:function(){this.gridOptionsService.is("treeData")&&this.treeDataViolations()}},{key:"treeDataViolations",value:function(){this.gridOptionsService.isRowModelType("clientSide")&&(this.gridOptionsService.exists("getDataPath")||console.warn("AG Grid: property usingTreeData=true with rowModel=clientSide, but you did not provide getDataPath function, please provide getDataPath function if using tree data.")),this.gridOptionsService.isRowModelType("serverSide")&&(this.gridOptionsService.exists("isServerSideGroup")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide isServerSideGroup function, please provide isServerSideGroup function if using tree data."),this.gridOptionsService.exists("getServerSideGroupKey")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide getServerSideGroupKey function, please provide getServerSideGroupKey function if using tree data."))}}]),e}();function by(e,t){var n=["groupRows","multipleColumns","custom","singleColumn"];return n.indexOf(t)<0?(console.warn("AG Grid: '".concat(t,"' is not a valid groupDisplayType value - possible values are: '").concat(n.join("', '"),"'")),!1):t===e}gy([nm("gridOptions")],wy.prototype,"gridOptions",void 0),gy([nm("gridOptionsService")],wy.prototype,"gridOptionsService",void 0),gy([$g],wy.prototype,"init",null),wy=gy([tm("gridOptionsValidator")],wy);var Cy=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Sy=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Ey=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).primaryHeaderRowCount=0,e.secondaryHeaderRowCount=0,e.gridHeaderRowCount=0,e.displayedColumnsLeft=[],e.displayedColumnsRight=[],e.displayedColumnsCenter=[],e.displayedColumns=[],e.displayedColumnsAndGroupsMap={},e.viewportColumns=[],e.viewportColumnsHash="",e.headerViewportColumns=[],e.viewportColumnsCenter=[],e.headerViewportColumnsCenter=[],e.autoHeightActiveAtLeastOnce=!1,e.rowGroupColumns=[],e.valueColumns=[],e.pivotColumns=[],e.ready=!1,e.autoGroupsNeedBuilding=!1,e.forceRecreateAutoGroups=!1,e.pivotMode=!1,e.bodyWidth=0,e.leftWidth=0,e.rightWidth=0,e.bodyWidthDirty=!0,e.shouldQueueResizeOperations=!1,e.resizeOperationQueue=[],e}return A(n,[{key:"init",value:function(){var e=this;this.suppressColumnVirtualisation=this.gridOptionsService.is("suppressColumnVirtualisation");var t=this.gridOptionsService.is("pivotMode");this.isPivotSettingAllowed(t)&&(this.pivotMode=t),this.usingTreeData=this.gridOptionsService.isTreeData(),this.addManagedPropertyListener("groupDisplayType",(function(){return e.onAutoGroupColumnDefChanged()})),this.addManagedPropertyListener("autoGroupColumnDef",(function(){return e.onAutoGroupColumnDefChanged()})),this.addManagedPropertyListener("defaultColDef",(function(t){return e.onSharedColDefChanged(t.source)})),this.addManagedPropertyListener("columnTypes",(function(t){return e.onSharedColDefChanged(t.source)}))}},{key:"onAutoGroupColumnDefChanged",value:function(){this.columnDefs&&(this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns("gridOptionsChanged"))}},{key:"onSharedColDefChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"api";this.forceRecreateAutoGroups=!0,this.createColumnsFromColumnDefs(!0,e)}},{key:"setColumnDefs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api",n=!!this.columnDefs;this.columnDefs=e,this.createColumnsFromColumnDefs(n,t)}},{key:"recreateColumnDefs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"api";this.onSharedColDefChanged(e)}},{key:"destroyOldColumns",value:function(e,t){var n={};if(e){this.columnUtils.depthFirstOriginalTreeSearch(null,e,(function(e){n[e.getInstanceId()]=e})),t&&this.columnUtils.depthFirstOriginalTreeSearch(null,t,(function(e){n[e.getInstanceId()]=null}));var r=Object.values(n).filter((function(e){return null!=e}));this.destroyBeans(r)}}},{key:"destroyColumns",value:function(){this.destroyOldColumns(this.primaryColumnTree),this.destroyOldColumns(this.secondaryBalancedTree),this.destroyOldColumns(this.groupAutoColsBalancedTree)}},{key:"createColumnsFromColumnDefs",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api",r=e?this.compareColumnStatesAndDispatchEvents(n):void 0;this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;var i=this.primaryColumns,o=this.primaryColumnTree,a=this.columnFactory.createColumnTree(this.columnDefs,!0,o);this.destroyOldColumns(this.primaryColumnTree,a.columnTree),this.primaryColumnTree=a.columnTree,this.primaryHeaderRowCount=a.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach((function(e){return t.primaryColumnsMap[e.getId()]=e})),this.extractRowGroupColumns(n,i),this.extractPivotColumns(n,i),this.extractValueColumns(n,i),this.ready=!0;var s=void 0===this.gridColsArePrimary;(this.gridColsArePrimary||s)&&(this.updateGridColumns(),e&&!this.gridOptionsService.is("maintainColumnOrder")&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(n),this.checkViewportColumns()),this.dispatchEverythingChanged(n),r&&r(),this.dispatchNewColumnsLoaded()}},{key:"dispatchNewColumnsLoaded",value:function(){var e={type:Ym.EVENT_NEW_COLUMNS_LOADED};this.eventService.dispatchEvent(e)}},{key:"dispatchEverythingChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"api",t={type:Ym.EVENT_COLUMN_EVERYTHING_CHANGED,source:e};this.eventService.dispatchEvent(t)}},{key:"orderGridColumnsLikePrimary",value:function(){var e=this,t=this.primaryColumns;t&&(this.gridColumns.sort((function(n,r){var i=t.indexOf(n),o=t.indexOf(r),a=i>=0,s=o>=0;return a&&s?i-o:a?1:s?-1:e.gridColumns.indexOf(n)-e.gridColumns.indexOf(r)})),this.gridColumns=this.placeLockedColumns(this.gridColumns))}},{key:"getAllDisplayedAutoHeightCols",value:function(){return this.displayedAutoHeightCols}},{key:"setViewport",value:function(){this.gridOptionsService.is("enableRtl")?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)}},{key:"getDisplayedColumnsStartingAt",value:function(e){for(var t=e,n=[];null!=t;)n.push(t),t=this.getDisplayedColAfter(t);return n}},{key:"checkViewportColumns",value:function(){if(null!=this.displayedColumnsCenter&&this.extractViewport()){var e={type:Ym.EVENT_VIRTUAL_COLUMNS_CHANGED};this.eventService.dispatchEvent(e)}}},{key:"setViewportPosition",value:function(e,t){(e!==this.scrollWidth||t!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=e,this.scrollPosition=t,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns())}},{key:"isPivotMode",value:function(){return this.pivotMode}},{key:"isPivotSettingAllowed",value:function(e){return!e||!this.gridOptionsService.isTreeData()||(console.warn("AG Grid: Pivot mode not available in conjunction Tree Data i.e. 'gridOptions.treeData: true'"),!1)}},{key:"setPivotMode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";if(e!==this.pivotMode&&this.isPivotSettingAllowed(this.pivotMode)){this.pivotMode=e,this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(t);var n={type:Ym.EVENT_COLUMN_PIVOT_MODE_CHANGED};this.eventService.dispatchEvent(n)}}},{key:"getSecondaryPivotColumn",value:function(e,t){if(pg(this.secondaryColumns))return null;var n=this.getPrimaryColumn(t),r=null;return this.secondaryColumns.forEach((function(t){var i=t.getColDef().pivotKeys,o=t.getColDef().pivotValueColumn;wm(i,e)&&o===n&&(r=t)})),r}},{key:"setBeans",value:function(e){this.logger=e.create("columnModel")}},{key:"setFirstRightAndLastLeftPinned",value:function(e){var t,n;this.gridOptionsService.is("enableRtl")?(t=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,n=this.displayedColumnsRight?ym(this.displayedColumnsRight):null):(t=this.displayedColumnsLeft?ym(this.displayedColumnsLeft):null,n=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach((function(r){r.setLastLeftPinned(r===t,e),r.setFirstRightPinned(r===n,e)}))}},{key:"autoSizeColumns",value:function(e){var t=this;if(this.shouldQueueResizeOperations)this.resizeOperationQueue.push((function(){return t.autoSizeColumns(e)}));else{var n=e.columns,r=e.skipHeader,i=e.skipHeaderGroups,o=e.stopAtGroup,a=e.source,s=void 0===a?"api":a;this.animationFrameService.flushAllFrames();for(var l=[],u=-1,c=null!=r?r:this.gridOptionsService.is("skipHeaderOnAutoSize"),d=null!=i?i:c;0!==u;)u=0,this.actionOnGridColumns(n,(function(e){if(l.indexOf(e)>=0)return!1;var n=t.autoWidthCalculator.getPreferredWidthForColumn(e,c);if(n>0){var r=t.normaliseColumnWidth(e,n);e.setActualWidth(r,s),l.push(e),u++}return!0}),s);d||this.autoSizeColumnGroupsByColumns(n,s,o),this.dispatchColumnResizedEvent(l,!0,"autosizeColumns")}}},{key:"dispatchColumnResizedEvent",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e&&e.length){var i={type:Ym.EVENT_COLUMN_RESIZED,columns:e,column:1===e.length?e[0]:null,flexColumns:r,finished:t,source:n};this.eventService.dispatchEvent(i)}}},{key:"dispatchColumnChangedEvent",value:function(e,t,n){var r={type:e,columns:t,column:t&&1==t.length?t[0]:null,source:n};this.eventService.dispatchEvent(r)}},{key:"dispatchColumnMovedEvent",value:function(e){var t=e.movedColumns,n=e.source,r=e.toIndex,i=e.finished,o={type:Ym.EVENT_COLUMN_MOVED,columns:t,column:t&&1===t.length?t[0]:null,toIndex:r,finished:i,source:n};this.eventService.dispatchEvent(o)}},{key:"dispatchColumnPinnedEvent",value:function(e,t){if(e.length){var n=1===e.length?e[0]:null,r=this.getCommonValue(e,(function(e){return e.getPinned()})),i={type:Ym.EVENT_COLUMN_PINNED,pinned:null!=r?r:null,columns:e,column:n,source:t};this.eventService.dispatchEvent(i)}}},{key:"dispatchColumnVisibleEvent",value:function(e,t){if(e.length){var n=1===e.length?e[0]:null,r=this.getCommonValue(e,(function(e){return e.isVisible()})),i={type:Ym.EVENT_COLUMN_VISIBLE,visible:r,columns:e,column:n,source:t};this.eventService.dispatchEvent(i)}}},{key:"autoSizeColumn",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";e&&this.autoSizeColumns({columns:[e],skipHeader:t,skipHeaderGroups:!0,source:n})}},{key:"autoSizeColumnGroupsByColumns",value:function(e,t,n){var r,i=new Set;this.getGridColumns(e).forEach((function(e){for(var t=e.getParent();t&&t!=n;)t.isPadding()||i.add(t),t=t.getParent()}));var o,a=dg(i);try{for(a.s();!(o=a.n()).done;){var s,l=o.value,u=dg(this.ctrlsService.getHeaderRowContainerCtrls());try{for(u.s();!(s=u.n()).done;){if(r=s.value.getHeaderCtrlForColumn(l))break}}catch(c){u.e(c)}finally{u.f()}r&&r.resizeLeafColumnsToFit(t)}}catch(c){a.e(c)}finally{a.f()}return[]}},{key:"autoSizeAllColumns",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";if(this.shouldQueueResizeOperations)this.resizeOperationQueue.push((function(){return t.autoSizeAllColumns(e,n)}));else{var r=this.getAllDisplayedColumns();this.autoSizeColumns({columns:r,skipHeader:e,source:n})}}},{key:"getColumnsFromTree",value:function(e){var t=[];return function e(n){for(var r=0;r<n.length;r++){var i=n[r];i instanceof fm?t.push(i):i instanceof vm&&e(i.getChildren())}}(e),t}},{key:"getAllDisplayedTrees",value:function(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null}},{key:"getPrimaryColumnTree",value:function(){return this.primaryColumnTree}},{key:"getHeaderRowCount",value:function(){return this.gridHeaderRowCount}},{key:"getDisplayedTreeLeft",value:function(){return this.displayedTreeLeft}},{key:"getDisplayedTreeRight",value:function(){return this.displayedTreeRight}},{key:"getDisplayedTreeCentre",value:function(){return this.displayedTreeCentre}},{key:"isColumnDisplayed",value:function(e){return this.getAllDisplayedColumns().indexOf(e)>=0}},{key:"getAllDisplayedColumns",value:function(){return this.displayedColumns}},{key:"getViewportColumns",value:function(){return this.viewportColumns}},{key:"getDisplayedLeftColumnsForRow",value:function(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsLeft):this.displayedColumnsLeft}},{key:"getDisplayedRightColumnsForRow",value:function(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsRight):this.displayedColumnsRight}},{key:"isColSpanActive",value:function(){return this.colSpanActive}},{key:"getDisplayedColumnsForRow",value:function(e,t,n,r){for(var i=[],o=null,a=function(a){var l,u=t[a],c=t.length-a,d=Math.min(u.getColSpan(e),c),h=[u];if(d>1){for(var f=d-1,p=1;p<=f;p++)h.push(t[a+p]);a+=f}if(n?(l=!1,h.forEach((function(e){n(e)&&(l=!0)}))):l=!0,l){if(0===i.length&&o)!!r&&r(u)&&i.push(o);i.push(u)}o=u,s=a},s=0;s<t.length;s++)a(s);return i}},{key:"getViewportCenterColumnsForRow",value:function(e){var t=this;if(!this.colSpanActive)return this.viewportColumnsCenter;var n=this.suppressColumnVirtualisation?null:this.isColumnInRowViewport.bind(this);return this.getDisplayedColumnsForRow(e,this.displayedColumnsCenter,n,(function(e){var n=e.getLeft();return fg(n)&&n>t.viewportLeft}))}},{key:"getAriaColumnIndex",value:function(e){return this.getAllGridColumns().indexOf(e)+1}},{key:"isColumnInHeaderViewport",value:function(e){return!!e.isAutoHeaderHeight()||this.isColumnInRowViewport(e)}},{key:"isColumnInRowViewport",value:function(e){if(e.isAutoHeight())return!0;var t=e.getLeft()||0,n=t+e.getActualWidth(),r=this.viewportLeft-200,i=this.viewportRight+200;return!(t<r&&n<r)&&!(t>i&&n>i)}},{key:"getDisplayedColumnsLeftWidth",value:function(){return this.getWidthOfColsInList(this.displayedColumnsLeft)}},{key:"getDisplayedColumnsRightWidth",value:function(){return this.getWidthOfColsInList(this.displayedColumnsRight)}},{key:"updatePrimaryColumnList",value:function(e,t,n,r,i){var o=this,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"api";if(e&&!vg(e)){var s=!1;if(e.forEach((function(e){var i=o.getPrimaryColumn(e);if(i){if(n){if(t.indexOf(i)>=0)return;t.push(i)}else{if(t.indexOf(i)<0)return;Cm(t,i)}r(i),s=!0}})),s){this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(a);var l={type:i,columns:t,column:1===t.length?t[0]:null,source:a};this.eventService.dispatchEvent(l)}}}},{key:"setRowGroupColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(e,this.rowGroupColumns,Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,this.setRowGroupActive.bind(this),t)}},{key:"setRowGroupActive",value:function(e,t,n){e!==t.isRowGroupActive()&&(t.setRowGroupActive(e,n),e&&!this.gridOptionsService.is("suppressRowGroupHidesColumns")&&this.setColumnVisible(t,!1,n),e||this.gridOptionsService.is("suppressMakeColumnVisibleAfterUnGroup")||this.setColumnVisible(t,!0,n))}},{key:"addRowGroupColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";e&&this.addRowGroupColumns([e],t)}},{key:"addRowGroupColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,t)}},{key:"removeRowGroupColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,t)}},{key:"removeRowGroupColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";e&&this.removeRowGroupColumns([e],t)}},{key:"addPivotColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.updatePrimaryColumnList(e,this.pivotColumns,!0,(function(e){return e.setPivotActive(!0,t)}),Ym.EVENT_COLUMN_PIVOT_CHANGED,t)}},{key:"setPivotColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.setPrimaryColumnList(e,this.pivotColumns,Ym.EVENT_COLUMN_PIVOT_CHANGED,(function(e,n){n.setPivotActive(e,t)}),t)}},{key:"addPivotColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.addPivotColumns([e],t)}},{key:"removePivotColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.updatePrimaryColumnList(e,this.pivotColumns,!1,(function(e){return e.setPivotActive(!1,t)}),Ym.EVENT_COLUMN_PIVOT_CHANGED,t)}},{key:"removePivotColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.removePivotColumns([e],t)}},{key:"setPrimaryColumnList",value:function(e,t,n,r,i){var o=this;t.length=0,fg(e)&&e.forEach((function(e){var n=o.getPrimaryColumn(e);n&&t.push(n)})),(this.primaryColumns||[]).forEach((function(e){var n=t.indexOf(e)>=0;r(n,e)})),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(i),this.dispatchColumnChangedEvent(n,t,i)}},{key:"setValueColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.setPrimaryColumnList(e,this.valueColumns,Ym.EVENT_COLUMN_VALUE_CHANGED,this.setValueActive.bind(this),t)}},{key:"setValueActive",value:function(e,t,n){if(e!==t.isValueActive()&&(t.setValueActive(e,n),e&&!t.getAggFunc())){var r=this.aggFuncService.getDefaultAggFunc(t);t.setAggFunc(r)}}},{key:"addValueColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.updatePrimaryColumnList(e,this.valueColumns,!0,this.setValueActive.bind(this,!0),Ym.EVENT_COLUMN_VALUE_CHANGED,t)}},{key:"addValueColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";e&&this.addValueColumns([e],t)}},{key:"removeValueColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.removeValueColumns([e],t)}},{key:"removeValueColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.updatePrimaryColumnList(e,this.valueColumns,!1,this.setValueActive.bind(this,!1),Ym.EVENT_COLUMN_VALUE_CHANGED,t)}},{key:"normaliseColumnWidth",value:function(e,t){var n=e.getMinWidth();fg(n)&&t<n&&(t=n);var r=e.getMaxWidth();return fg(r)&&e.isGreaterThanMax(t)&&(t=r),t}},{key:"getPrimaryOrGridColumn",value:function(e){return this.getPrimaryColumn(e)||this.getGridColumn(e)}},{key:"setColumnWidths",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"api",o=[];e.forEach((function(e){var n=r.getPrimaryOrGridColumn(e.key);if(n&&(o.push({width:e.newWidth,ratios:[1],columns:[n]}),"shift"===r.gridOptionsService.get("colResizeDefault")&&(t=!t),t)){var i=r.getDisplayedColAfter(n);if(!i)return;var a=n.getActualWidth()-e.newWidth,s=i.getActualWidth()+a;o.push({width:s,ratios:[1],columns:[i]})}})),0!==o.length&&this.resizeColumnSets({resizeSets:o,finished:n,source:i})}},{key:"checkMinAndMaxWidthsForSet",value:function(e){var t=e.columns,n=e.width,r=0,i=0,o=!0;return t.forEach((function(e){var t=e.getMinWidth();r+=t||0;var n=e.getMaxWidth();fg(n)&&n>0?i+=n:o=!1})),n>=r&&(!o||n<=i)}},{key:"resizeColumnSets",value:function(e){var t=this,n=e.resizeSets,r=e.finished,i=e.source;if(!n||n.every((function(e){return t.checkMinAndMaxWidthsForSet(e)}))){var o=[],a=[];n.forEach((function(e){var t=e.width,n=e.columns,r=e.ratios,s={},l={};n.forEach((function(e){return a.push(e)}));for(var u=!0,c=0,d=function(){if(++c>1e3)return console.error("AG Grid: infinite loop in resizeColumnSets"),"break";u=!1;var e=[],i=0,o=t;n.forEach((function(t,n){if(l[t.getId()])o-=s[t.getId()];else{e.push(t);var a=r[n];i+=a}}));var a=1/i;e.forEach((function(n,i){var c;i===e.length-1?c=o:(c=Math.round(r[i]*t*a),o-=c);var d=n.getMinWidth(),h=n.getMaxWidth();fg(d)&&c<d?(c=d,l[n.getId()]=!0,u=!0):fg(h)&&h>0&&c>h&&(c=h,l[n.getId()]=!0,u=!0),s[n.getId()]=c}))};u;){if("break"===d())break}n.forEach((function(e){var t=s[e.getId()];e.getActualWidth()!==t&&(e.setActualWidth(t,i),o.push(e))}))}));var s=o.length>0,l=[];s&&(l=this.refreshFlexedColumns({resizingCols:a,skipSetLeft:!0}),this.setLeftValues(i),this.updateBodyWidths(),this.checkViewportColumns());var u=a.concat(l);(s||r)&&this.dispatchColumnResizedEvent(u,r,i,l)}else if(r){var c=n&&n.length>0?n[0].columns:null;this.dispatchColumnResizedEvent(c,r,i)}}},{key:"setColumnAggFunc",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";if(e){var r=this.getPrimaryColumn(e);r&&(r.setAggFunc(t),this.dispatchColumnChangedEvent(Ym.EVENT_COLUMN_VALUE_CHANGED,[r],n))}}},{key:"moveRowGroupColumn",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api",r=this.rowGroupColumns[e];this.rowGroupColumns.splice(e,1),this.rowGroupColumns.splice(t,0,r);var i={type:Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:this.rowGroupColumns,column:1===this.rowGroupColumns.length?this.rowGroupColumns[0]:null,source:n};this.eventService.dispatchEvent(i)}},{key:"moveColumns",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api",r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(this.columnAnimationService.start(),t>this.gridColumns.length-e.length)return console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+t),void console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");var i=this.getGridColumns(e);!this.doesMovePassRules(i,t)||(km(this.gridColumns,i,t),this.updateDisplayedColumns(n),this.dispatchColumnMovedEvent({movedColumns:i,source:n,toIndex:t,finished:r}),this.columnAnimationService.finish())}},{key:"doesMovePassRules",value:function(e,t){var n=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(n)}},{key:"doesOrderPassRules",value:function(e){return!!this.doesMovePassMarryChildren(e)&&!!this.doesMovePassLockedPositions(e)}},{key:"getProposedColumnOrder",value:function(e,t){var n=this.gridColumns.slice();return km(n,e,t),n}},{key:"sortColumnsLikeGridColumns",value:function(e){var t=this;!e||e.length<=1||(e.filter((function(e){return t.gridColumns.indexOf(e)<0})).length>0||e.sort((function(e,n){return t.gridColumns.indexOf(e)-t.gridColumns.indexOf(n)})))}},{key:"doesMovePassLockedPositions",value:function(e){var t=0,n=!0;return e.forEach((function(e){var r,i=(r=e.getColDef().lockPosition)?!0===r||"left"===r?0:2:1;i<t&&(n=!1),t=i})),n}},{key:"doesMovePassMarryChildren",value:function(e){var t=!0;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,(function(n){if(n instanceof vm){var r=n,i=r.getColGroupDef();if(i&&i.marryChildren){var o=[];r.getLeafColumns().forEach((function(t){var n=e.indexOf(t);o.push(n)})),Math.max.apply(Math,o)-Math.min.apply(Math,o)>r.getLeafColumns().length-1&&(t=!1)}}})),t}},{key:"moveColumn",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";this.moveColumns([e],t,n)}},{key:"moveColumnByIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api",r=this.gridColumns[e];this.moveColumn(r,t,n)}},{key:"getColumnDefs",value:function(){var e=this;if(this.primaryColumns){var t=this.primaryColumns.slice();return this.gridColsArePrimary?t.sort((function(t,n){return e.gridColumns.indexOf(t)-e.gridColumns.indexOf(n)})):this.lastPrimaryOrder&&t.sort((function(t,n){return e.lastPrimaryOrder.indexOf(t)-e.lastPrimaryOrder.indexOf(n)})),this.columnDefFactory.buildColumnDefs(t,this.rowGroupColumns,this.pivotColumns)}}},{key:"getBodyContainerWidth",value:function(){return this.bodyWidth}},{key:"getContainerWidth",value:function(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}},{key:"updateBodyWidths",value:function(){var e=this.getWidthOfColsInList(this.displayedColumnsCenter),t=this.getWidthOfColsInList(this.displayedColumnsLeft),n=this.getWidthOfColsInList(this.displayedColumnsRight);if(this.bodyWidthDirty=this.bodyWidth!==e,this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==n){this.bodyWidth=e,this.leftWidth=t,this.rightWidth=n;var r={type:Ym.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED};this.eventService.dispatchEvent(r)}}},{key:"getValueColumns",value:function(){return this.valueColumns?this.valueColumns:[]}},{key:"getPivotColumns",value:function(){return this.pivotColumns?this.pivotColumns:[]}},{key:"isPivotActive",value:function(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode}},{key:"getRowGroupColumns",value:function(){return this.rowGroupColumns?this.rowGroupColumns:[]}},{key:"getDisplayedCenterColumns",value:function(){return this.displayedColumnsCenter}},{key:"getDisplayedLeftColumns",value:function(){return this.displayedColumnsLeft}},{key:"getDisplayedRightColumns",value:function(){return this.displayedColumnsRight}},{key:"getDisplayedColumns",value:function(e){switch(e){case"left":return this.getDisplayedLeftColumns();case"right":return this.getDisplayedRightColumns();default:return this.getDisplayedCenterColumns()}}},{key:"getAllPrimaryColumns",value:function(){return this.primaryColumns?this.primaryColumns.slice():null}},{key:"getSecondaryColumns",value:function(){return this.secondaryColumns?this.secondaryColumns.slice():null}},{key:"getAllColumnsForQuickFilter",value:function(){return this.columnsForQuickFilter}},{key:"getAllGridColumns",value:function(){return this.gridColumns}},{key:"isEmpty",value:function(){return vg(this.gridColumns)}},{key:"isRowGroupEmpty",value:function(){return vg(this.rowGroupColumns)}},{key:"setColumnVisible",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";this.setColumnsVisible([e],t,n)}},{key:"setColumnsVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";this.applyColumnState({state:e.map((function(e){return{colId:"string"===typeof e?e:e.getColId(),hide:!t}}))},n)}},{key:"setColumnPinned",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";e&&this.setColumnsPinned([e],t,n)}},{key:"setColumnsPinned",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";this.gridOptionsService.isDomLayout("print")?console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'"):(this.columnAnimationService.start(),n=!0===t||"left"===t?"left":"right"===t?"right":null,this.actionOnGridColumns(e,(function(e){return e.getPinned()!==n&&(e.setPinned(n),!0)}),r,(function(){return{type:Ym.EVENT_COLUMN_PINNED,pinned:n,column:null,columns:null,source:r}})),this.columnAnimationService.finish())}},{key:"actionOnGridColumns",value:function(e,t,n,r){var i=this;if(!vg(e)){var o=[];if(e.forEach((function(e){var n=i.getGridColumn(e);n&&(!1!==t(n)&&o.push(n))})),o.length&&(this.updateDisplayedColumns(n),fg(r)&&r)){var a=r();a.columns=o,a.column=1===o.length?o[0]:null,this.eventService.dispatchEvent(a)}}}},{key:"getDisplayedColBefore",value:function(e){var t=this.getAllDisplayedColumns(),n=t.indexOf(e);return n>0?t[n-1]:null}},{key:"getDisplayedColAfter",value:function(e){var t=this.getAllDisplayedColumns(),n=t.indexOf(e);return n<t.length-1?t[n+1]:null}},{key:"getDisplayedGroupAfter",value:function(e){return this.getDisplayedGroupAtDirection(e,"After")}},{key:"getDisplayedGroupBefore",value:function(e){return this.getDisplayedGroupAtDirection(e,"Before")}},{key:"getDisplayedGroupAtDirection",value:function(e,t){for(var n=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),r=e.getDisplayedLeafColumns(),i="After"===t?ym(r):r[0],o="getDisplayedCol".concat(t);;){var a=this[o](i);if(!a)return null;var s=this.getColumnGroupAtLevel(a,n);if(s!==e)return s}}},{key:"getColumnGroupAtLevel",value:function(e,t){for(var n=e.getParent();;){if(n.getProvidedColumnGroup().getLevel()+n.getPaddingLevel()<=t)break;n=n.getParent()}return n}},{key:"isPinningLeft",value:function(){return this.displayedColumnsLeft.length>0}},{key:"isPinningRight",value:function(){return this.displayedColumnsRight.length>0}},{key:"getPrimaryAndSecondaryAndAutoColumns",value:function(){var e;return(e=[]).concat.apply(e,[this.primaryColumns||[],this.groupAutoColumns||[],this.secondaryColumns||[]])}},{key:"createStateItemFromColumn",value:function(e){var t=e.isRowGroupActive()?this.rowGroupColumns.indexOf(e):null,n=e.isPivotActive()?this.pivotColumns.indexOf(e):null,r=e.isValueActive()?e.getAggFunc():null,i=null!=e.getSort()?e.getSort():null,o=null!=e.getSortIndex()?e.getSortIndex():null,a=null!=e.getFlex()&&e.getFlex()>0?e.getFlex():null;return{colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:i,sortIndex:o,aggFunc:r,rowGroup:e.isRowGroupActive(),rowGroupIndex:t,pivot:e.isPivotActive(),pivotIndex:n,flex:a}}},{key:"getColumnState",value:function(){if(pg(this.primaryColumns)||!this.isAlive())return[];var e=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(e),e}},{key:"orderColumnStateList",value:function(e){var t=sy(this.gridColumns.map((function(e,t){return[e.getColId(),t]})));e.sort((function(e,n){return(t.has(e.colId)?t.get(e.colId):-1)-(t.has(n.colId)?t.get(n.colId):-1)}))}},{key:"resetColumnState",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"api",n=this.getColumnsFromTree(this.primaryColumnTree),r=[],i=1e3,o=1e3,a=[];this.groupAutoColumns&&(a=a.concat(this.groupAutoColumns)),n&&(a=a.concat(n)),a.forEach((function(t){var n=e.getColumnStateFromColDef(t);pg(n.rowGroupIndex)&&n.rowGroup&&(n.rowGroupIndex=i++),pg(n.pivotIndex)&&n.pivot&&(n.pivotIndex=o++),r.push(n)})),this.applyColumnState({state:r,applyOrder:!0},t)}},{key:"getColumnStateFromColDef",value:function(e){var t=function(e,t){return null!=e?e:null!=t?t:null},n=e.getColDef(),r=t(n.sort,n.initialSort),i=t(n.sortIndex,n.initialSortIndex),o=t(n.hide,n.initialHide),a=t(n.pinned,n.initialPinned),s=t(n.width,n.initialWidth),l=t(n.flex,n.initialFlex),u=t(n.rowGroupIndex,n.initialRowGroupIndex),c=t(n.rowGroup,n.initialRowGroup);null!=u||null!=c&&0!=c||(u=null,c=null);var d=t(n.pivotIndex,n.initialPivotIndex),h=t(n.pivot,n.initialPivot);null!=d||null!=h&&0!=h||(d=null,h=null);var f=t(n.aggFunc,n.initialAggFunc);return{colId:e.getColId(),sort:r,sortIndex:i,hide:o,pinned:a,width:s,flex:l,rowGroup:c,rowGroupIndex:u,pivot:h,pivotIndex:d,aggFunc:f}}},{key:"applyColumnState",value:function(e,t){var n=this;if(vg(this.primaryColumns))return!1;if(e&&e.state&&!e.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;var r=function(r,i,o){var a=n.compareColumnStatesAndDispatchEvents(t);n.autoGroupsNeedBuilding=!0;var s=i.slice(),l={},u={},c=[],d=[],h=0,f=n.rowGroupColumns.slice(),p=n.pivotColumns.slice();r.forEach((function(r){var i=r.colId||"";if(i.startsWith(Jm))return c.push(r),void d.push(r);var a=o(i);a?(n.syncColumnWithStateItem(a,r,e.defaultState,l,u,!1,t),Cm(s,a)):(d.push(r),h+=1)}));var v=function(r){return n.syncColumnWithStateItem(r,null,e.defaultState,l,u,!1,t)};s.forEach(v);var g=function(e,t,n,r){var i=e[n.getId()],o=e[r.getId()],a=null!=i,s=null!=o;if(a&&s)return i-o;if(a)return-1;if(s)return 1;var l=t.indexOf(n),u=t.indexOf(r),c=l>=0;return c&&u>=0?l-u:c?-1:1};n.rowGroupColumns.sort(g.bind(n,l,f)),n.pivotColumns.sort(g.bind(n,u,p)),n.updateGridColumns();var m=n.groupAutoColumns?n.groupAutoColumns.slice():[];return c.forEach((function(r){var i=n.getAutoColumn(r.colId);Cm(m,i),n.syncColumnWithStateItem(i,r,e.defaultState,null,null,!0,t)})),m.forEach(v),n.applyOrderAfterApplyState(e),n.updateDisplayedColumns(t),n.dispatchEverythingChanged(t),a(),{unmatchedAndAutoStates:d,unmatchedCount:h}};this.columnAnimationService.start();var i=r(e.state||[],this.primaryColumns||[],(function(e){return n.getPrimaryColumn(e)})),o=i.unmatchedAndAutoStates,a=i.unmatchedCount;return(o.length>0||fg(e.defaultState))&&(a=r(o,this.secondaryColumns||[],(function(e){return n.getSecondaryColumn(e)})).unmatchedCount),this.columnAnimationService.finish(),0===a}},{key:"applyOrderAfterApplyState",value:function(e){var t=this;if(e.applyOrder&&e.state){var n=[],r={};e.state.forEach((function(e){if(e.colId&&!r[e.colId]){var i=t.gridColumnsMap[e.colId];i&&(n.push(i),r[e.colId]=!0)}}));var i=0;this.gridColumns.forEach((function(e){var t=e.getColId();null!=r[t]||(t.startsWith(Jm)?Em(n,e,i++):n.push(e))})),n=this.placeLockedColumns(n),this.doesMovePassMarryChildren(n)?this.gridColumns=n:console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.")}}},{key:"compareColumnStatesAndDispatchEvents",value:function(e){var t=this,n={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},r=this.getColumnState(),i={};return r.forEach((function(e){i[e.colId]=e})),function(){var o=t.getPrimaryAndSecondaryAndAutoColumns(),a=function(n,r,i,o){if(!wm(r.map(o),i.map(o))){var a={type:n,columns:i,column:1===i.length?i[0]:null,source:e};t.eventService.dispatchEvent(a)}},s=function(e){var t=[];return o.forEach((function(n){var r=i[n.getColId()];r&&e(r,n)&&t.push(n)})),t},l=function(e){return e.getColId()};a(Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,n.rowGroupColumns,t.rowGroupColumns,l),a(Ym.EVENT_COLUMN_PIVOT_CHANGED,n.pivotColumns,t.pivotColumns,l);s((function(e,t){var n=null!=e.aggFunc,r=n!=t.isValueActive(),i=n&&e.aggFunc!=t.getAggFunc();return r||i})).length>0&&t.dispatchColumnChangedEvent(Ym.EVENT_COLUMN_VALUE_CHANGED,t.valueColumns,e);t.dispatchColumnResizedEvent(s((function(e,t){return e.width!=t.getActualWidth()})),!0,e);t.dispatchColumnPinnedEvent(s((function(e,t){return e.pinned!=t.getPinned()})),e);t.dispatchColumnVisibleEvent(s((function(e,t){return e.hide==t.isVisible()})),e);s((function(e,t){return e.sort!=t.getSort()||e.sortIndex!=t.getSortIndex()})).length>0&&t.sortController.dispatchSortChangedEvents(e),t.normaliseColumnMovedEventForColumnState(r,e)}}},{key:"getCommonValue",value:function(e,t){if(e&&0!=e.length){for(var n=t(e[0]),r=1;r<e.length;r++)if(n!==t(e[r]))return;return n}}},{key:"normaliseColumnMovedEventForColumnState",value:function(e,t){var n=this,r=this.getColumnState(),i={};r.forEach((function(e){return i[e.colId]=e}));var o={};e.forEach((function(e){i[e.colId]&&(o[e.colId]=!0)}));var a=e.filter((function(e){return o[e.colId]})),s=r.filter((function(e){return o[e.colId]})),l=[];s.forEach((function(e,t){var r=a&&a[t];if(r&&r.colId!==e.colId){var i=n.getGridColumn(r.colId);i&&l.push(i)}})),l.length&&this.dispatchColumnMovedEvent({movedColumns:l,source:t,finished:!0})}},{key:"syncColumnWithStateItem",value:function(e,t,n,r,i,o,a){if(e){var s=function(e,r){var i={value1:void 0,value2:void 0},o=!1;return t&&(void 0!==t[e]&&(i.value1=t[e],o=!0),fg(r)&&void 0!==t[r]&&(i.value2=t[r],o=!0)),!o&&n&&(void 0!==n[e]&&(i.value1=n[e]),fg(r)&&void 0!==n[r]&&(i.value2=n[r])),i},l=s("hide").value1;void 0!==l&&e.setVisible(!l,a);var u=s("pinned").value1;void 0!==u&&e.setPinned(u);var c=this.columnUtils.calculateColMinWidth(e.getColDef()),d=s("flex").value1;if(void 0!==d&&e.setFlex(d),e.getFlex()<=0){var h=s("width").value1;null!=h&&null!=c&&h>=c&&e.setActualWidth(h,a)}var f=s("sort").value1;void 0!==f&&("desc"===f||"asc"===f?e.setSort(f,a):e.setSort(void 0,a));var p=s("sortIndex").value1;if(void 0!==p&&e.setSortIndex(p),!o&&e.isPrimary()){var v=s("aggFunc").value1;void 0!==v&&("string"===typeof v?(e.setAggFunc(v),e.isValueActive()||(e.setValueActive(!0,a),this.valueColumns.push(e))):(fg(v)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),e.isValueActive()&&(e.setValueActive(!1,a),Cm(this.valueColumns,e))));var g=s("rowGroup","rowGroupIndex"),m=g.value1,y=g.value2;void 0===m&&void 0===y||("number"===typeof y||m?(e.isRowGroupActive()||(e.setRowGroupActive(!0,a),this.rowGroupColumns.push(e)),r&&"number"===typeof y&&(r[e.getId()]=y)):e.isRowGroupActive()&&(e.setRowGroupActive(!1,a),Cm(this.rowGroupColumns,e)));var w=s("pivot","pivotIndex"),b=w.value1,C=w.value2;void 0===b&&void 0===C||("number"===typeof C||b?(e.isPivotActive()||(e.setPivotActive(!0,a),this.pivotColumns.push(e)),i&&"number"===typeof C&&(i[e.getId()]=C)):e.isPivotActive()&&(e.setPivotActive(!1,a),Cm(this.pivotColumns,e)))}}}},{key:"getGridColumns",value:function(e){return this.getColumns(e,this.getGridColumn.bind(this))}},{key:"getColumns",value:function(e,t){var n=[];return e&&e.forEach((function(e){var r=t(e);r&&n.push(r)})),n}},{key:"getColumnWithValidation",value:function(e){if(null==e)return null;var t=this.getGridColumn(e);return t||console.warn("AG Grid: could not find column "+e),t}},{key:"getPrimaryColumn",value:function(e){return this.primaryColumns?this.getColumn(e,this.primaryColumns,this.primaryColumnsMap):null}},{key:"getGridColumn",value:function(e){return this.getColumn(e,this.gridColumns,this.gridColumnsMap)}},{key:"getSecondaryColumn",value:function(e){return this.secondaryColumns?this.getColumn(e,this.secondaryColumns,this.secondaryColumnsMap):null}},{key:"getColumn",value:function(e,t,n){if(!e)return null;if("string"==typeof e&&n[e])return n[e];for(var r=0;r<t.length;r++)if(this.columnsMatch(t[r],e))return t[r];return this.getAutoColumn(e)}},{key:"getSourceColumnsForGroupColumn",value:function(e){var t=e.getColDef().showRowGroup;if(!t)return null;if(!0===t)return this.rowGroupColumns.slice(0);var n=this.getPrimaryColumn(t);return n?[n]:null}},{key:"getAutoColumn",value:function(e){var t=this;return this.groupAutoColumns&&fg(this.groupAutoColumns)&&!pg(this.groupAutoColumns)&&this.groupAutoColumns.find((function(n){return t.columnsMatch(n,e)}))||null}},{key:"columnsMatch",value:function(e,t){var n=e===t,r=e.getColDef()===t,i=e.getColId()==t;return n||r||i}},{key:"getDisplayNameForColumn",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;var r=this.getHeaderName(e.getColDef(),e,null,null,t);return n?this.wrapHeaderNameWithAggFunc(e,r):r}},{key:"getDisplayNameForProvidedColumnGroup",value:function(e,t,n){var r=t?t.getColGroupDef():null;return r?this.getHeaderName(r,null,e,t,n):null}},{key:"getDisplayNameForColumnGroup",value:function(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}},{key:"getHeaderName",value:function(e,t,n,r,i){var o=e.headerValueGetter;if(o){var a={colDef:e,column:t,columnGroup:n,providedColumnGroup:r,location:i,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};return"function"===typeof o?o(a):"string"===typeof o?this.expressionService.evaluate(o,a):(console.warn("AG Grid: headerValueGetter must be a function or a string"),"")}return null!=e.headerName?e.headerName:e.field?iy(e.field):""}},{key:"wrapHeaderNameWithAggFunc",value:function(e,t){if(this.gridOptionsService.is("suppressAggFuncInHeader"))return t;var n,r=e.getColDef().pivotValueColumn,i=null;if(fg(r)){var o=this.gridOptionsService.is("removePivotHeaderRowWhenSingleValueColumn")&&1===this.valueColumns.length,a=void 0!==e.getColDef().pivotTotalColumnIds;if(o&&!a)return t;i=r?r.getAggFunc():null,n=!0}else{var s=e.isValueActive(),l=this.pivotMode||!this.isRowGroupEmpty();s&&l?(i=e.getAggFunc(),n=!0):n=!1}if(n){var u="string"===typeof i?i:"func",c=this.localeService.getLocaleTextFunc()(u,u);return"".concat(c,"(").concat(t,")")}return t}},{key:"getColumnGroup",value:function(e,t){if(!e)return null;if(e instanceof Xm)return e;var n=this.getAllDisplayedTrees(),r="number"===typeof t,i=null;return this.columnUtils.depthFirstAllColumnTreeSearch(n,(function(n){if(n instanceof Xm){var o=n;(r?e===o.getGroupId()&&t===o.getPartId():e===o.getGroupId())&&(i=o)}})),i}},{key:"isReady",value:function(){return this.ready}},{key:"extractValueColumns",value:function(e,t){this.valueColumns=this.extractColumns(t,this.valueColumns,(function(t,n){return t.setValueActive(n,e)}),(function(){}),(function(){}),(function(e){var t=e.aggFunc;return null===t||""===t?null:void 0!==t?!!t:void 0}),(function(e){return null!=e.initialAggFunc&&""!=e.initialAggFunc})),this.valueColumns.forEach((function(e){var t=e.getColDef();null!=t.aggFunc&&""!=t.aggFunc?e.setAggFunc(t.aggFunc):e.getAggFunc()||e.setAggFunc(t.initialAggFunc)}))}},{key:"extractRowGroupColumns",value:function(e,t){this.rowGroupColumns=this.extractColumns(t,this.rowGroupColumns,(function(t,n){return t.setRowGroupActive(n,e)}),(function(e){return e.rowGroupIndex}),(function(e){return e.initialRowGroupIndex}),(function(e){return e.rowGroup}),(function(e){return e.initialRowGroup}))}},{key:"extractColumns",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=[],l=[];(this.primaryColumns||[]).forEach((function(n){var u=e.indexOf(n)<0,c=n.getColDef(),d=yg(o(c)),h=yg(a(c)),f=mg(r(c)),p=mg(i(c));(void 0!==d?d:void 0!==f?null!==f&&f>=0:u?void 0!==h?h:!!(void 0!==p)&&(null!=p&&p>=0):t.indexOf(n)>=0)&&((u?null!=f||null!=p:null!=f)?s.push(n):l.push(n))}));var u=function(e){var t=r(e.getColDef()),n=i(e.getColDef());return null!=t?t:n};s.sort((function(e,t){var n=u(e),r=u(t);return n===r?0:n<r?-1:1}));var c=[].concat(s);return t.forEach((function(e){l.indexOf(e)>=0&&c.push(e)})),l.forEach((function(e){c.indexOf(e)<0&&c.push(e)})),t.forEach((function(e){c.indexOf(e)<0&&n(e,!1)})),c.forEach((function(e){t.indexOf(e)<0&&n(e,!0)})),c}},{key:"extractPivotColumns",value:function(e,t){this.pivotColumns=this.extractColumns(t,this.pivotColumns,(function(t,n){return t.setPivotActive(n,e)}),(function(e){return e.pivotIndex}),(function(e){return e.initialPivotIndex}),(function(e){return e.pivot}),(function(e){return e.initialPivot}))}},{key:"resetColumnGroupState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"api",t=[];this.columnUtils.depthFirstOriginalTreeSearch(null,this.primaryColumnTree,(function(e){if(e instanceof vm){var n=e.getColGroupDef(),r={groupId:e.getGroupId(),open:n?n.openByDefault:void 0};t.push(r)}})),this.setColumnGroupState(t,e)}},{key:"getColumnGroupState",value:function(){var e=[];return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,(function(t){t instanceof vm&&e.push({groupId:t.getGroupId(),open:t.isExpanded()})})),e}},{key:"setColumnGroupState",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.columnAnimationService.start();var r=[];e.forEach((function(e){var n=e.groupId,i=e.open,o=t.getProvidedColumnGroup(n);o&&o.isExpanded()!==i&&(t.logger.log("columnGroupOpened("+o.getGroupId()+","+i+")"),o.setExpanded(i),r.push(o))})),this.updateGroupsAndDisplayedColumns(n),this.setFirstRightAndLastLeftPinned(n),r.forEach((function(e){var n={type:Ym.EVENT_COLUMN_GROUP_OPENED,columnGroup:e};t.eventService.dispatchEvent(n)})),this.columnAnimationService.finish()}},{key:"setColumnGroupOpened",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";n=e instanceof vm?e.getId():e||"",this.setColumnGroupState([{groupId:n,open:t}],r)}},{key:"getProvidedColumnGroup",value:function(e){"string"!==typeof e&&console.error("AG Grid: group key must be a string");var t=null;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,(function(n){n instanceof vm&&n.getId()===e&&(t=n)})),t}},{key:"calculateColumnsForDisplay",value:function(){var e=this;return this.pivotMode&&pg(this.secondaryColumns)?this.gridColumns.filter((function(t){var n=e.groupAutoColumns&&xm(e.groupAutoColumns,t),r=e.valueColumns&&xm(e.valueColumns,t);return n||r})):this.gridColumns.filter((function(t){return e.groupAutoColumns&&xm(e.groupAutoColumns,t)||t.isVisible()}))}},{key:"checkColSpanActiveInCols",value:function(e){var t=!1;return e.forEach((function(e){fg(e.getColDef().colSpan)&&(t=!0)})),t}},{key:"calculateColumnsForGroupDisplay",value:function(){var e=this;this.groupDisplayColumns=[],this.groupDisplayColumnsMap={};this.gridColumns.forEach((function(t){var n=t.getColDef(),r=n.showRowGroup;n&&fg(r)&&(e.groupDisplayColumns.push(t),"string"===typeof r?e.groupDisplayColumnsMap[r]=t:!0===r&&e.getRowGroupColumns().forEach((function(n){e.groupDisplayColumnsMap[n.getId()]=t})))}))}},{key:"getGroupDisplayColumns",value:function(){return this.groupDisplayColumns}},{key:"getGroupDisplayColumnForGroup",value:function(e){return this.groupDisplayColumnsMap[e]}},{key:"updateDisplayedColumns",value:function(e){var t=this.calculateColumnsForDisplay();this.buildDisplayedTrees(t),this.updateGroupsAndDisplayedColumns(e),this.setFirstRightAndLastLeftPinned(e)}},{key:"isSecondaryColumnsPresent",value:function(){return fg(this.secondaryColumns)}},{key:"setSecondaryColumns",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api",r=e&&e.length>0;if(r||!pg(this.secondaryColumns)){if(r){this.processSecondaryColumnDefinitions(e);var i=this.columnFactory.createColumnTree(e,!1,this.secondaryBalancedTree||this.previousSecondaryColumns||void 0);this.destroyOldColumns(this.secondaryBalancedTree,i.columnTree),this.secondaryBalancedTree=i.columnTree,this.secondaryHeaderRowCount=i.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsMap={},this.secondaryColumns.forEach((function(e){return t.secondaryColumnsMap[e.getId()]=e})),this.previousSecondaryColumns=null}else this.previousSecondaryColumns=this.secondaryBalancedTree,this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsMap={};this.updateGridColumns(),this.updateDisplayedColumns(n)}}},{key:"processSecondaryColumnDefinitions",value:function(e){var t=this.gridOptionsService.get("processPivotResultColDef")||this.gridOptionsService.get("processSecondaryColDef"),n=this.gridOptionsService.get("processPivotResultColGroupDef")||this.gridOptionsService.get("processSecondaryColGroupDef");if(t||n){e&&function e(r){r.forEach((function(r){if(fg(r.children)){var i=r;n&&n(i),e(i.children)}else t&&t(r)}))}(e)}}},{key:"updateGridColumns",value:function(){var e,t=this,n=this.gridBalancedTree;if(this.gridColsArePrimary?this.lastPrimaryOrder=this.gridColumns:this.lastSecondaryOrder=this.gridColumns,this.secondaryColumns&&this.secondaryBalancedTree){var r=this.secondaryColumns.every((function(e){return void 0!==t.gridColumnsMap[e.getColId()]}));this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1,r&&(e=this.lastSecondaryOrder)}else this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,e=this.lastPrimaryOrder);if(this.createGroupAutoColumnsIfNeeded()&&e){var i=sy(this.groupAutoColumns.map((function(e){return[e,!0]})));e=e.filter((function(e){return!i.has(e)})),e=[].concat(wt(this.groupAutoColumns),wt(e))}if(this.addAutoGroupToGridColumns(),this.orderGridColsLike(e),this.gridColumns=this.placeLockedColumns(this.gridColumns),this.calculateColumnsForGroupDisplay(),this.refreshQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach((function(e){return t.gridColumnsMap[e.getId()]=e})),this.setAutoHeightActive(),!wm(n,this.gridBalancedTree)){var o={type:Ym.EVENT_GRID_COLUMNS_CHANGED};this.eventService.dispatchEvent(o)}}},{key:"setAutoHeightActive",value:function(){if((this.autoHeightActive=this.gridColumns.filter((function(e){return e.isAutoHeight()})).length>0,this.autoHeightActive)&&(this.autoHeightActiveAtLeastOnce=!0,!(this.gridOptionsService.isRowModelType("clientSide")||this.gridOptionsService.isRowModelType("serverSide")))){Lg((function(){return console.warn("AG Grid - autoHeight columns only work with Client Side Row Model and Server Side Row Model.")}),"autoHeightActive.wrongRowModel")}}},{key:"orderGridColsLike",value:function(e){if(!pg(e)){var t=sy(e.map((function(e,t){return[e,t]}))),n=!0;if(this.gridColumns.forEach((function(e){t.has(e)&&(n=!1)})),!n){var r=sy(this.gridColumns.map((function(e){return[e,!0]}))),i=e.filter((function(e){return r.has(e)})),o=sy(i.map((function(e){return[e,!0]}))),a=this.gridColumns.filter((function(e){return!o.has(e)})),s=i.slice();a.forEach((function(e){var t=e.getOriginalParent();if(t){for(var n=[];!n.length&&t;){t.getLeafColumns().forEach((function(e){var t=s.indexOf(e)>=0,r=n.indexOf(e)<0;t&&r&&n.push(e)})),t=t.getOriginalParent()}if(n.length){var r=n.map((function(e){return s.indexOf(e)})),i=Math.max.apply(Math,wt(r));Em(s,e,i+1)}else s.push(e)}else s.push(e)})),this.gridColumns=s}}}},{key:"isPrimaryColumnGroupsPresent",value:function(){return this.primaryHeaderRowCount>1}},{key:"refreshQuickFilterColumns",value:function(){var e,t=null!==(e=this.isPivotMode()?this.secondaryColumns:this.primaryColumns)&&void 0!==e?e:[];this.groupAutoColumns&&(t=t.concat(this.groupAutoColumns)),this.columnsForQuickFilter=this.gridOptionsService.is("includeHiddenColumnsInQuickFilter")?t:t.filter((function(e){return e.isVisible()||e.isRowGroupActive()}))}},{key:"placeLockedColumns",value:function(e){var t=[],n=[],r=[];return e.forEach((function(e){var i=e.getColDef().lockPosition;"right"===i?r.push(e):"left"===i||!0===i?t.push(e):n.push(e)})),[].concat(t,n,r)}},{key:"addAutoGroupToGridColumns",value:function(){if(pg(this.groupAutoColumns))return this.destroyOldColumns(this.groupAutoColsBalancedTree),void(this.groupAutoColsBalancedTree=null);this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;var e=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.destroyOldColumns(this.groupAutoColsBalancedTree,e),this.groupAutoColsBalancedTree=e,this.gridBalancedTree=e.concat(this.gridBalancedTree)}},{key:"clearDisplayedAndViewportColumns",value:function(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.viewportColumns=[],this.headerViewportColumns=[],this.viewportColumnsHash=""}},{key:"updateGroupsAndDisplayedColumns",value:function(e){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(e),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths();var t={type:Ym.EVENT_DISPLAYED_COLUMNS_CHANGED};this.eventService.dispatchEvent(t)}},{key:"deriveDisplayedColumns",value:function(e){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinDisplayedColumns(),this.setLeftValues(e),this.displayedAutoHeightCols=this.displayedColumns.filter((function(e){return e.isAutoHeight()}))}},{key:"isAutoRowHeightActive",value:function(){return this.autoHeightActive}},{key:"wasAutoRowHeightEverActive",value:function(){return this.autoHeightActiveAtLeastOnce}},{key:"joinDisplayedColumns",value:function(){this.gridOptionsService.is("enableRtl")?this.displayedColumns=this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumns=this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)}},{key:"setLeftValues",value:function(e){this.setLeftValuesOfColumns(e),this.setLeftValuesOfGroups()}},{key:"setLeftValuesOfColumns",value:function(e){var t=this;if(this.primaryColumns){var n=this.primaryColumns.slice(0),r=this.gridOptionsService.is("enableRtl");[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach((function(i){if(r){var o=t.getWidthOfColsInList(i);i.forEach((function(t){o-=t.getActualWidth(),t.setLeft(o,e)}))}else{var a=0;i.forEach((function(t){t.setLeft(a,e),a+=t.getActualWidth()}))}Sm(n,i)})),n.forEach((function(t){t.setLeft(null,e)}))}}},{key:"setLeftValuesOfGroups",value:function(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach((function(e){e.forEach((function(e){e instanceof Xm&&e.checkLeft()}))}))}},{key:"derivedDisplayedColumnsFromDisplayedTree",value:function(e,t){t.length=0,this.columnUtils.depthFirstDisplayedColumnTreeSearch(e,(function(e){e instanceof fm&&t.push(e)}))}},{key:"extractViewportColumns",value:function(){this.suppressColumnVirtualisation?(this.viewportColumnsCenter=this.displayedColumnsCenter,this.headerViewportColumnsCenter=this.displayedColumnsCenter):(this.viewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this)),this.headerViewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this))),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight),this.headerViewportColumns=this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)}},{key:"getVirtualHeaderGroupRow",value:function(e,t){var n;switch(e){case"left":n=this.viewportRowLeft[t];break;case"right":n=this.viewportRowRight[t];break;default:n=this.viewportRowCenter[t]}return pg(n)&&(n=[]),n}},{key:"calculateHeaderRows",value:function(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};var e={};this.headerViewportColumns.forEach((function(t){return e[t.getId()]=!0}));var t=function t(n,r,i){for(var o=!1,a=0;a<n.length;a++){var s=n[a],l=!1;if(s instanceof fm)l=!0===e[s.getId()];else{var u=s.getDisplayedChildren();u&&(l=t(u,r,i+1))}l&&(o=!0,r[i]||(r[i]=[]),r[i].push(s))}return o};t(this.displayedTreeLeft,this.viewportRowLeft,0),t(this.displayedTreeRight,this.viewportRowRight,0),t(this.displayedTreeCentre,this.viewportRowCenter,0)}},{key:"extractViewport",value:function(){this.extractViewportColumns();var e=this.viewportColumns.map((function(e){return"".concat(e.getId(),"-").concat(e.getPinned()||"normal")})).join("#"),t=this.viewportColumnsHash!==e;return t&&(this.viewportColumnsHash=e,this.calculateHeaderRows()),t}},{key:"refreshFlexedColumns",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.source?t.source:"flex";if(null!=t.viewportWidth&&(this.flexViewportWidth=t.viewportWidth),!this.flexViewportWidth)return[];var r=-1;t.resizingCols&&t.resizingCols.forEach((function(t){var n=e.displayedColumnsCenter.indexOf(t);r<n&&(r=n)}));var i=function(t){var n=e.displayedColumnsCenter.indexOf(t)>r;return t.getFlex()&&n},o=this.displayedColumnsCenter.filter((function(e){return!i(e)})),a=this.displayedColumnsCenter.filter((function(e){return i(e)})),s=[];if(!a.length)return[];var l,u=[];e:for(;;){var c=a.reduce((function(e,t){return e+t.getFlex()}),0);l=this.flexViewportWidth-this.getWidthOfColsInList(o);for(var d=0;d<a.length;d++){var h=a[d],f=l*h.getFlex()/c,p=0,v=h.getMinWidth(),g=h.getMaxWidth();if(fg(v)&&f<v?p=v:fg(g)&&f>g&&(p=g),p){h.setActualWidth(p,n),Cm(a,h),s.push(h),o.push(h);continue e}u[d]=Math.round(f)}break}var m=l;return a.forEach((function(e,t){e.setActualWidth(Math.min(u[t],m),n),s.push(e),m-=u[t]})),t.skipSetLeft||this.setLeftValues(n),t.updateBodyWidths&&this.updateBodyWidths(),t.fireResizedEvent&&this.dispatchColumnResizedEvent(s,!0,n,a),a}},{key:"sizeColumnsToFit",value:function(e){var t,n,r,i,o,a=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sizeColumnsToFit",l=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0;if(this.shouldQueueResizeOperations)this.resizeOperationQueue.push((function(){return a.sizeColumnsToFit(e,s,l,u)}));else{var c={};u&&(null===(t=null===u||void 0===u?void 0:u.columnLimits)||void 0===t||t.forEach((function(e){var t=e.key,n=Sy(e,["key"]);c["string"===typeof t?t:t.getColId()]=n})));var d=this.getAllDisplayedColumns(),h=e===this.getWidthOfColsInList(d);if(!(e<=0||!d.length||h)){var f=[],p=[];d.forEach((function(e){!0===e.getColDef().suppressSizeToFit?p.push(e):f.push(e)}));var v=f.slice(0),g=!1,m=function(e){Cm(f,e),p.push(e)};for(f.forEach((function(e){return e.resetActualWidth(s)}));!g;){g=!0;var y=e-this.getWidthOfColsInList(p);if(y<=0)f.forEach((function(e){var t,n,r=null!==(n=null===(t=null===c||void 0===c?void 0:c[e.getId()])||void 0===t?void 0:t.minWidth)&&void 0!==n?n:null===u||void 0===u?void 0:u.defaultMinWidth;"number"!==typeof r?e.setMinimum(s):e.setActualWidth(r)}));else for(var w=y/this.getWidthOfColsInList(f),b=y,C=f.length-1;C>=0;C--){var S=f[C],E=null===c||void 0===c?void 0:c[S.getId()],k=null!==(n=null===E||void 0===E?void 0:E.minWidth)&&void 0!==n?n:null===u||void 0===u?void 0:u.defaultMinWidth,x=null!==(r=null===E||void 0===E?void 0:E.maxWidth)&&void 0!==r?r:null===u||void 0===u?void 0:u.defaultMaxWidth,T=null!==(i=S.getMinWidth())&&void 0!==i?i:0,R=null!==(o=S.getMaxWidth())&&void 0!==o?o:Number.MAX_VALUE,A="number"===typeof k&&k>T?k:S.getMinWidth(),_="number"===typeof x&&x<R?x:S.getMaxWidth(),O=Math.round(S.getActualWidth()*w);fg(A)&&O<A?(O=A,m(S),g=!1):fg(_)&&O>_?(O=_,m(S),g=!1):0===C&&(O=b),S.setActualWidth(O,s,!0),b-=O}}v.forEach((function(e){e.fireColumnWidthChangedEvent(s)})),this.setLeftValues(s),this.updateBodyWidths(),l||this.dispatchColumnResizedEvent(v,!0,s)}}}},{key:"buildDisplayedTrees",value:function(e){var t=[],n=[],r=[];e.forEach((function(e){switch(e.getPinned()){case"left":t.push(e);break;case"right":n.push(e);break;default:r.push(e)}}));var i=new Qm;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(t,this.gridBalancedTree,i,"left",this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(n,this.gridBalancedTree,i,"right",this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(r,this.gridBalancedTree,i,null,this.displayedTreeCentre),this.updateDisplayedMap()}},{key:"updateDisplayedMap",value:function(){var e=this;this.displayedColumnsAndGroupsMap={};var t=function(t){e.displayedColumnsAndGroupsMap[t.getUniqueId()]=t};this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeCentre,t),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeLeft,t),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeRight,t)}},{key:"isDisplayed",value:function(e){return this.displayedColumnsAndGroupsMap[e.getUniqueId()]===e}},{key:"updateOpenClosedVisibilityInColumnGroups",value:function(){var e=this.getAllDisplayedTrees();this.columnUtils.depthFirstAllColumnTreeSearch(e,(function(e){e instanceof Xm&&e.calculateDisplayedColumns()}))}},{key:"getGroupAutoColumns",value:function(){return this.groupAutoColumns}},{key:"createGroupAutoColumnsIfNeeded",value:function(){var e=this.forceRecreateAutoGroups;if(this.forceRecreateAutoGroups=!1,!this.autoGroupsNeedBuilding)return!1;this.autoGroupsNeedBuilding=!1;var t=this.gridOptionsService.isGroupUseEntireRow(this.pivotMode),n=this.pivotMode?this.gridOptionsService.is("pivotSuppressAutoColumn"):this.isGroupSuppressAutoColumn();if((this.rowGroupColumns.length>0||this.usingTreeData)&&!n&&!t){var r=this.groupAutoColumns||[],i=this.autoGroupColService.createAutoGroupColumns(r,this.rowGroupColumns);if(!this.autoColsEqual(i,this.groupAutoColumns)||e)return this.groupAutoColumns=i,!0}else this.groupAutoColumns=null;return!1}},{key:"isGroupSuppressAutoColumn",value:function(){var e=this.gridOptionsService.get("groupDisplayType");if(!!e&&by("custom",e))return!0;var t=this.gridOptionsService.get("treeDataDisplayType");return!!t&&function(e,t){var n=["auto","custom"];return n.indexOf(t)<0?(console.warn("AG Grid: '".concat(t,"' is not a valid treeDataDisplayType value - possible values are: '").concat(n.join("', '"),"'")),!1):t===e}("custom",t)}},{key:"autoColsEqual",value:function(e,t){return wm(e,t,(function(e,t){return e.getColId()===t.getColId()}))}},{key:"getWidthOfColsInList",value:function(e){return e.reduce((function(e,t){return e+t.getActualWidth()}),0)}},{key:"getGridBalancedTree",value:function(){return this.gridBalancedTree}},{key:"hasFloatingFilters",value:function(){return!!this.gridColumns&&this.gridColumns.some((function(e){return e.getColDef().floatingFilter}))}},{key:"getFirstDisplayedColumn",value:function(){var e=this.gridOptionsService.is("enableRtl"),t=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];e&&t.reverse();for(var n=0;n<t.length;n++){var r=this[t[n]]();if(r.length)return e?ym(r):r[0]}return null}},{key:"setColumnHeaderHeight",value:function(e,t){if(e.setAutoHeaderHeight(t)){var n={type:Ym.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,column:e,columns:[e],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(n)}}},{key:"getColumnGroupHeaderRowHeight",value:function(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()}},{key:"getColumnHeaderRowHeight",value:function(){var e=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),t=this.getAllDisplayedColumns().filter((function(e){return e.isAutoHeaderHeight()})).map((function(e){return e.getAutoHeaderHeight()||0}));return Math.max.apply(Math,[e].concat(wt(t)))}},{key:"getHeaderHeight",value:function(){var e;return null!==(e=this.gridOptionsService.getNum("headerHeight"))&&void 0!==e?e:this.environment.getFromTheme(25,"headerHeight")}},{key:"getFloatingFiltersHeight",value:function(){var e;return null!==(e=this.gridOptionsService.getNum("floatingFiltersHeight"))&&void 0!==e?e:this.getHeaderHeight()}},{key:"getGroupHeaderHeight",value:function(){var e;return null!==(e=this.gridOptionsService.getNum("groupHeaderHeight"))&&void 0!==e?e:this.getHeaderHeight()}},{key:"getPivotHeaderHeight",value:function(){var e;return null!==(e=this.gridOptionsService.getNum("pivotHeaderHeight"))&&void 0!==e?e:this.getHeaderHeight()}},{key:"getPivotGroupHeaderHeight",value:function(){var e;return null!==(e=this.gridOptionsService.getNum("pivotGroupHeaderHeight"))&&void 0!==e?e:this.getGroupHeaderHeight()}},{key:"queueResizeOperations",value:function(){this.shouldQueueResizeOperations=!0}},{key:"processResizeOperations",value:function(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach((function(e){return e()})),this.resizeOperationQueue=[]}},{key:"resetColumnDefIntoColumn",value:function(e){var t=e.getUserProvidedColDef();if(!t)return!1;var n=this.columnFactory.mergeColDefs(t,e.getColId());return e.setColDef(n,t),!0}},{key:"generateColumnStateForRowGroupAndPivotIndexes",value:function(e,t){var n=this,r={},i=function(e,t,i,o,a,s){if(!t.length||!n.primaryColumns)return[];for(var l=Object.keys(e),u=new Set(l),c=new Set(l),d=new Set(t.map((function(e){var t=e.getColId();return c.delete(t),t})).concat(l)),h=[],f={},p=0,v=0;v<n.primaryColumns.length;v++){var g=n.primaryColumns[v].getColId();d.has(g)&&(h.push(g),f[g]=p++)}var m=1e3,y=!1,w=0,b=function(t){for(var n=f[t],r=w;r<n;r++){var i=h[r];c.has(i)&&(e[i][a]=m++,c.delete(i))}w=n};t.forEach((function(t){var n=t.getColId();if(u.has(n))b(n),e[n][a]=m++;else{var l=t.getColDef();if(null===l[a]||void 0===l[a]&&null==l[s]){if(!y)l[i]||void 0===l[i]&&l[o]?b(n):(c.forEach((function(t){e[t][a]=m+f[t]})),m+=h.length,y=!0);r[n]||(r[n]={colId:n}),r[n][a]=m++}}}))};return i(e,this.rowGroupColumns,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),i(t,this.pivotColumns,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(r)}}]),n}(Vm);Cy([nm("expressionService")],Ey.prototype,"expressionService",void 0),Cy([nm("columnFactory")],Ey.prototype,"columnFactory",void 0),Cy([nm("displayedGroupCreator")],Ey.prototype,"displayedGroupCreator",void 0),Cy([nm("ctrlsService")],Ey.prototype,"ctrlsService",void 0),Cy([nm("autoWidthCalculator")],Ey.prototype,"autoWidthCalculator",void 0),Cy([nm("columnUtils")],Ey.prototype,"columnUtils",void 0),Cy([nm("columnAnimationService")],Ey.prototype,"columnAnimationService",void 0),Cy([nm("autoGroupColService")],Ey.prototype,"autoGroupColService",void 0),Cy([rm("aggFuncService")],Ey.prototype,"aggFuncService",void 0),Cy([rm("valueCache")],Ey.prototype,"valueCache",void 0),Cy([rm("animationFrameService")],Ey.prototype,"animationFrameService",void 0),Cy([nm("sortController")],Ey.prototype,"sortController",void 0),Cy([nm("columnDefFactory")],Ey.prototype,"columnDefFactory",void 0),Cy([$g],Ey.prototype,"init",null),Cy([em],Ey.prototype,"destroyColumns",null),Cy([function(e,t){return function(n,r){t(n,r,e)}}(0,om("loggerFactory"))],Ey.prototype,"setBeans",null),Ey=Cy([tm("columnModel")],Ey);var ky=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},xy=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"calculateColMinWidth",value:function(e){return null!=e.minWidth?e.minWidth:this.environment.getMinColWidth()}},{key:"calculateColMaxWidth",value:function(e){return null!=e.maxWidth?e.maxWidth:Number.MAX_SAFE_INTEGER}},{key:"calculateColInitialWidth",value:function(e){var t,n=this.calculateColMinWidth(e),r=this.calculateColMaxWidth(e),i=mg(e.width),o=mg(e.initialWidth);return t=null!=i?i:null!=o?o:200,Math.max(Math.min(t,r),n)}},{key:"getOriginalPathForColumn",value:function(e,t){var n=[],r=!1;return function t(i,o){for(var a=0;a<i.length;a++){if(r)return;var s=i[a];if(s instanceof vm)t(s.getChildren(),o+1),n[o]=s;else s===e&&(r=!0)}}(t,0),r?n:null}},{key:"depthFirstOriginalTreeSearch",value:function(e,t,n){var r=this;t&&t.forEach((function(t){t instanceof vm&&r.depthFirstOriginalTreeSearch(t,t.getChildren(),n),n(t,e)}))}},{key:"depthFirstAllColumnTreeSearch",value:function(e,t){var n=this;e&&e.forEach((function(e){e instanceof Xm&&n.depthFirstAllColumnTreeSearch(e.getChildren(),t),t(e)}))}},{key:"depthFirstDisplayedColumnTreeSearch",value:function(e,t){var n=this;e&&e.forEach((function(e){e instanceof Xm&&n.depthFirstDisplayedColumnTreeSearch(e.getDisplayedChildren(),t),t(e)}))}}]),n}(Vm);xy=ky([tm("columnUtils")],xy);var Ty=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ry=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"createDisplayedGroups",value:function(e,t,n,r,i){var o,a,s=this,l=[],u=this.mapOldGroupsById(i);return e.forEach((function(e){for(var i=s.getOriginalPathForColumn(t,e),c=[],d=!a,h=0;h<i.length;h++)if(d||i[h]!==a[h]){var f=s.createColumnGroup(i[h],n,u,r);c[h]=f,0==h?l.push(f):c[h-1].addChild(f)}else c[h]=o[h];0===c.length?l.push(e):ym(c).addChild(e);o=c,a=i})),this.setupParentsIntoColumns(l,null),l}},{key:"createColumnGroup",value:function(e,t,n,r){var i=e.getGroupId(),o=t.getInstanceIdForKey(i),a=n[Xm.createUniqueId(i,o)];return a&&a.getProvidedColumnGroup()!==e&&(a=null),fg(a)?a.reset():(a=new Xm(e,i,o,r),this.context.createBean(a)),a}},{key:"mapOldGroupsById",value:function(e){var t={};return e&&function e(n){n.forEach((function(n){if(n instanceof Xm){var r=n;t[n.getUniqueId()]=r,e(r.getChildren())}}))}(e),t}},{key:"setupParentsIntoColumns",value:function(e,t){var n=this;e.forEach((function(e){if(e.setParent(t),e instanceof Xm){var r=e;n.setupParentsIntoColumns(r.getChildren(),r)}}))}},{key:"getOriginalPathForColumn",value:function(e,t){var n=[],r=!1;return function e(i,o){for(var a=0;a<i.length;a++){if(r)return;var s=i[a];s instanceof vm?(e(s.getChildren(),o+1),n[o]=s):s===t&&(r=!0)}}(e,0),r?n:(console.warn("AG Grid: could not get path"),null)}}]),n}(Vm);Ry=Ty([tm("displayedGroupCreator")],Ry);var Ay=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},_y=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).componentsMappedByName={},e}return A(n,[{key:"setupComponents",value:function(e){var t=this;e&&e.forEach((function(e){return t.addComponent(e)}))}},{key:"addComponent",value:function(e){var t=e.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[t]=e.componentClass}},{key:"getComponentClass",value:function(e){return this.componentsMappedByName[e]}}]),n}(Vm);function Oy(e,t,n){null==n||""==n?Ny(e,t):Dy(e,t,n)}function Dy(e,t,n){e.setAttribute(Py(t),n.toString())}function Ny(e,t){e.removeAttribute(Py(t))}function Py(e){return"aria-".concat(e)}function Fy(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function Iy(e){return"asc"===e?"ascending":"desc"===e?"descending":"mixed"===e?"other":"none"}function Ly(e){return parseInt(e.getAttribute("aria-level"),10)}function My(e){return parseInt(e.getAttribute("aria-posinset"),10)}function Gy(e,t){Oy(e,"label",t)}function By(e,t){Oy(e,"labelledby",t)}function jy(e,t){Oy(e,"description",t)}function Hy(e,t){Oy(e,"describedby",t)}function Vy(e,t){Oy(e,"live",t)}function Wy(e,t){Oy(e,"level",t)}function zy(e,t){Oy(e,"disabled",t)}function Uy(e,t){Oy(e,"hidden",t)}function Ky(e,t){Dy(e,"expanded",t)}function qy(e){Ny(e,"expanded")}function Xy(e,t){Dy(e,"setsize",t)}function Yy(e,t){Dy(e,"posinset",t)}function Qy(e,t){Dy(e,"multiselectable",t)}function Zy(e,t){Dy(e,"rowcount",t)}function Jy(e,t){Dy(e,"rowindex",t)}function $y(e,t){Dy(e,"colcount",t)}function ew(e,t){Dy(e,"colindex",t)}function tw(e,t){Dy(e,"colspan",t)}function nw(e,t){Dy(e,"sort",t)}function rw(e){Ny(e,"sort")}function iw(e,t){Oy(e,"selected",t)}function ow(e,t){Dy(e,"checked",void 0===t?"mixed":t)}function aw(e,t){return void 0===t?e("ariaIndeterminate","indeterminate"):!0===t?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}_y=Ay([tm("agStackComponentsRegistry")],_y);var sw,lw,uw,cw,dw,hw,fw,pw,vw=Object.freeze({__proto__:null,setAriaRole:Fy,getAriaSortState:Iy,getAriaLevel:Ly,getAriaPosInSet:My,getAriaDescribedBy:function(e){return e.getAttribute("aria-describedby")||""},setAriaLabel:Gy,setAriaLabelledBy:By,setAriaDescription:jy,setAriaDescribedBy:Hy,setAriaLive:Vy,setAriaLevel:Wy,setAriaDisabled:zy,setAriaHidden:Uy,setAriaExpanded:Ky,removeAriaExpanded:qy,setAriaSetSize:Xy,setAriaPosInSet:Yy,setAriaMultiSelectable:Qy,setAriaRowCount:Zy,setAriaRowIndex:Jy,setAriaColCount:$y,setAriaColIndex:ew,setAriaColSpan:tw,setAriaSort:nw,removeAriaSort:rw,setAriaSelected:iw,setAriaChecked:ow,setAriaControls:function(e,t){Oy(e,"controls",t.id),By(t,e.id)},getAriaCheckboxStateName:aw});function gw(){return void 0===sw&&(sw=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),sw}function mw(){if(void 0===lw)if(gw()){var e=navigator.userAgent.match(/version\/(\d+)/i);e&&(lw=null!=e[1]?parseFloat(e[1]):0)}else lw=0;return lw}function yw(){if(void 0===uw){var e=window;uw=!!e.chrome&&(!!e.chrome.webstore||!!e.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return uw}function ww(){return void 0===cw&&(cw=/(firefox)/i.test(navigator.userAgent)),cw}function bw(){return void 0===dw&&(dw=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),dw}function Cw(){return void 0===hw&&(hw=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),hw}function Sw(){return!gw()||mw()>=15}function Ew(e){if(!e)return null;var t=e.tabIndex,n=e.getAttribute("tabIndex");return-1!==t||null!==n&&(""!==n||ww())?t.toString():null}function kw(){if(!document.body)return-1;var e=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,n=document.createElement("div");for(document.body.appendChild(n);;){var r=2*e;if(n.style.height=r+"px",r>t||n.clientHeight!==r)break;e=r}return document.body.removeChild(n),e}function xw(){var e,t,n;return null!==(t=null===(e=document.body)||void 0===e?void 0:e.clientWidth)&&void 0!==t?t:window.innerHeight||(null===(n=document.documentElement)||void 0===n?void 0:n.clientWidth)||-1}function Tw(){var e,t,n;return null!==(t=null===(e=document.body)||void 0===e?void 0:e.clientHeight)&&void 0!==t?t:window.innerHeight||(null===(n=document.documentElement)||void 0===n?void 0:n.clientHeight)||-1}function Rw(){return null==pw&&Aw(),pw}function Aw(){var e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);var n=t.offsetWidth-t.clientWidth;0===n&&0===t.clientWidth&&(n=null),t.parentNode&&t.parentNode.removeChild(t),null!=n&&(pw=n,fw=0===n)}function _w(){return null==fw&&Aw(),fw}var Ow=Object.freeze({__proto__:null,isBrowserSafari:gw,getSafariVersion:mw,isBrowserChrome:yw,isBrowserFirefox:ww,isMacOsUserAgent:bw,isIOSUserAgent:Cw,browserSupportsPreventScroll:Sw,getTabIndex:Ew,getMaxDivHeight:kw,getBodyWidth:xw,getBodyHeight:Tw,getScrollbarWidth:Rw,isInvisibleScrollbar:_w});function Dw(e,t){return e.toString().padStart(t,"0")}function Nw(e,t){for(var n=[],r=e;r<=t;r++)n.push(r);return n}function Pw(e,t,n){return"number"!==typeof e?"":e.toString().replace(".",n).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1".concat(t))}var Fw=Object.freeze({__proto__:null,padStartWidthZeros:Dw,createArrayOfNumbers:Nw,cleanNumber:function(e){return"string"===typeof e&&(e=parseInt(e,10)),"number"===typeof e?Math.floor(e):null},decToHex:function(e,t){for(var n="",r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n},formatNumberTwoDecimalPlacesAndCommas:function(e,t,n){return"number"!==typeof e?"":Pw(Math.round(100*e)/100,t,n)},formatNumberCommas:Pw,sum:function(e){return null==e?null:e.reduce((function(e,t){return e+t}),0)},zeroOrGreater:function(e,t){return e>=0?e:t},oneOrGreater:function(e,t){var n=parseInt(e,10);return!isNaN(n)&&isFinite(n)&&n>0?n:t}});function Iw(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-";if(!e)return null;var r=[e.getFullYear(),e.getMonth()+1,e.getDate()].map((function(e){return Dw(e,2)})).join(n);return t&&(r+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map((function(e){return Dw(e,2)})).join(":")),r}var Lw=function(e){if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function Mw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD",n=Dw(e.getFullYear(),4),r=["January","February","March","April","May","June","July","August","September","October","November","December"],i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o={YYYY:function(){return n.slice(n.length-4,n.length)},YY:function(){return n.slice(n.length-2,n.length)},Y:function(){return"".concat(e.getFullYear())},MMMM:function(){return r[e.getMonth()]},MMM:function(){return r[e.getMonth()].slice(0,3)},MM:function(){return Dw(e.getMonth()+1,2)},Mo:function(){return"".concat(e.getMonth()+1).concat(Lw(e.getMonth()+1))},M:function(){return"".concat(e.getMonth()+1)},Do:function(){return"".concat(e.getDate()).concat(Lw(e.getDate()))},DD:function(){return Dw(e.getDate(),2)},D:function(){return"".concat(e.getDate())},dddd:function(){return i[e.getDay()]},ddd:function(){return i[e.getDay()].slice(0,3)},dd:function(){return i[e.getDay()].slice(0,2)},do:function(){return"".concat(e.getDay()).concat(Lw(e.getDay()))},d:function(){return"".concat(e.getDay())}},a=new RegExp(Object.keys(o).join("|"),"g");return t.replace(a,(function(e){return e in o?o[e]():e}))}function Gw(e){if(!e)return null;var t=Y(e.split(" "),2),n=t[0],r=t[1];if(!n)return null;var i=n.split("-").map((function(e){return parseInt(e,10)}));if(3!==i.filter((function(e){return!isNaN(e)})).length)return null;var o=Y(i,3),a=o[0],s=o[1],l=o[2],u=new Date(a,s-1,l);if(u.getFullYear()!==a||u.getMonth()!==s-1||u.getDate()!==l)return null;if(!r||"00:00:00"===r)return u;var c=Y(r.split(":").map((function(e){return parseInt(e,10)})),3),d=c[0],h=c[1],f=c[2];return d>=0&&d<24&&u.setHours(d),h>=0&&h<60&&u.setMinutes(h),f>=0&&f<60&&u.setSeconds(f),u}var Bw,jw=Object.freeze({__proto__:null,serialiseDate:Iw,dateToFormattedString:Mw,parseDateTimeFromString:Gw});var Hw="[tabindex], input, select, button, textarea, [href]",Vw=".ag-hidden, .ag-hidden *, [disabled], .ag-disabled:not(.ag-button), .ag-disabled *.mjs";function Ww(e){var t=Element.prototype.matches||Element.prototype.msMatchesSelector,n=t.call(e,"input, select, button, textarea"),r=t.call(e,Vw),i=ob(e);return n&&!r&&i}function zw(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipAriaHidden;e.classList.toggle("ag-hidden",!t),n||Uy(e,!t)}function Uw(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipAriaHidden;e.classList.toggle("ag-invisible",!t),n||Uy(e,!t)}function Kw(e,t){var n="disabled",r=t?function(e){return e.setAttribute(n,"")}:function(e){return e.removeAttribute(n)};r(e),Eb(e.querySelectorAll("input"),(function(e){return r(e)}))}function qw(e,t,n){for(var r=0;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,"number"==typeof n){if(++r>n)break}else if(e===n)break}return!1}function Xw(e){var t=window.getComputedStyle(e),n=t.height,r=t.width,i=t.borderTopWidth,o=t.borderRightWidth,a=t.borderBottomWidth,s=t.borderLeftWidth,l=t.paddingTop,u=t.paddingRight,c=t.paddingBottom,d=t.paddingLeft,h=t.marginTop,f=t.marginRight,p=t.marginBottom,v=t.marginLeft,g=t.boxSizing;return{height:parseFloat(n),width:parseFloat(r),borderTopWidth:parseFloat(i),borderRightWidth:parseFloat(o),borderBottomWidth:parseFloat(a),borderLeftWidth:parseFloat(s),paddingTop:parseFloat(l),paddingRight:parseFloat(u),paddingBottom:parseFloat(c),paddingLeft:parseFloat(d),marginTop:parseFloat(h),marginRight:parseFloat(f),marginBottom:parseFloat(p),marginLeft:parseFloat(v),boxSizing:g}}function Yw(e){var t=Xw(e);return"border-box"===t.boxSizing?t.height-t.paddingTop-t.paddingBottom:t.height}function Qw(e){var t=Xw(e);return"border-box"===t.boxSizing?t.width-t.paddingLeft-t.paddingRight:t.width}function Zw(e){var t=Xw(e),n=t.marginBottom+t.marginTop;return Math.ceil(e.offsetHeight+n)}function Jw(e){var t=Xw(e),n=t.marginLeft+t.marginRight;return Math.ceil(e.offsetWidth+n)}function $w(e){var t=e.getBoundingClientRect(),n=Xw(e),r=n.borderTopWidth,i=n.borderLeftWidth,o=n.borderRightWidth,a=n.borderBottomWidth;return{top:t.top+(r||0),left:t.left+(i||0),right:t.right+(o||0),bottom:t.bottom+(a||0)}}function eb(){if("boolean"===typeof Bw)return Bw;var e=document.createElement("div");return e.style.direction="rtl",e.style.width="1px",e.style.height="1px",e.style.position="fixed",e.style.top="0px",e.style.overflow="hidden",e.dir="rtl",e.innerHTML='<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>',document.body.appendChild(e),e.scrollLeft=1,Bw=0===Math.floor(e.scrollLeft),document.body.removeChild(e),Bw}function tb(e,t){var n=e.scrollLeft;return t&&(n=Math.abs(n),yw()&&!eb()&&(n=e.scrollWidth-e.clientWidth-n)),n}function nb(e,t,n){n&&(eb()?t*=-1:(gw()||yw())&&(t=e.scrollWidth-e.clientWidth-t)),e.scrollLeft=t}function rb(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function ib(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function ob(e){return null!==e.offsetParent}function ab(e){var t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function sb(e){return e&&e.clientHeight?e.clientHeight:0}function lb(e){return e&&e.clientWidth?e.clientWidth:0}function ub(e,t,n){if(!n||n.nextSibling!==t){var r=document.activeElement,i=t.contains(r);n?n.nextSibling?e.insertBefore(t,n.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t),i&&r&&Sw()&&r.focus({preventScroll:!0})}}function cb(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=e.children[n];i!==r&&e.insertBefore(r,i)}}function db(e,t,n){n?n.insertAdjacentElement("afterend",t):e.firstChild?e.insertAdjacentElement("afterbegin",t):e.appendChild(t)}function hb(e,t){if(t)for(var n=0,r=Object.entries(t);n<r.length;n++){var i=Y(r[n],2),o=i[0],a=i[1];if(o&&o.length&&null!=a){var s=oy(o),l=a.toString(),u=l.replace(/\s*!important/g,""),c=u.length!=l.length?"important":void 0;e.style.setProperty(s,u,c)}}}function fb(e){return e.clientWidth<e.scrollWidth}function pb(e){return e.clientHeight<e.scrollHeight}function vb(e,t){"flex"===t?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):gb(e,t)}function gb(e,t){t=yb(t),e.style.width=t.toString(),e.style.maxWidth=t.toString(),e.style.minWidth=t.toString()}function mb(e,t){t=yb(t),e.style.height=t.toString(),e.style.maxHeight=t.toString(),e.style.minHeight=t.toString()}function yb(e){return"number"===typeof e?"".concat(e,"px"):e}function wb(e){return e instanceof Node||e instanceof HTMLElement}function bb(e){if(null==e)return[];var t=[];return Eb(e,(function(e){return t.push(e)})),t}function Cb(e,t){if(e)for(var n=0;n<e.length;n++){var r=e[n];t(r.name,r.value)}}function Sb(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n.toString())}function Eb(e,t){if(null!=e)for(var n=0;n<e.length;n++)t(e[n])}var kb=Object.freeze({__proto__:null,radioCssClass:function(e,t,n){for(var r=e.parentElement,i=r&&r.firstChild;i;)t&&i.classList.toggle(t,i===e),n&&i.classList.toggle(n,i!==e),i=i.nextSibling},FOCUSABLE_SELECTOR:Hw,FOCUSABLE_EXCLUDE:Vw,isFocusableFormField:Ww,setDisplayed:zw,setVisible:Uw,setDisabled:Kw,isElementChildOfClass:qw,getElementSize:Xw,getInnerHeight:Yw,getInnerWidth:Qw,getAbsoluteHeight:Zw,getAbsoluteWidth:Jw,getElementRectWithOffset:$w,isRtlNegativeScroll:eb,getScrollLeft:tb,setScrollLeft:nb,clearElement:rb,removeElement:function(e,t){ib(e.querySelector(t))},removeFromParent:ib,isVisible:ob,loadTemplate:ab,appendHtml:function(e,t){e.lastChild?e.insertAdjacentHTML("afterbegin",t):e.innerHTML=t},getElementAttribute:function(e,t){return e.attributes&&e.attributes[t]?e.attributes[t].value:null},offsetHeight:sb,offsetWidth:lb,ensureDomOrder:ub,setDomChildOrder:cb,insertWithDomOrder:db,prependDC:function(e,t){fg(e.firstChild)?e.insertBefore(t,e.firstChild):e.appendChild(t)},addStylesToElement:hb,isHorizontalScrollShowing:fb,isVerticalScrollShowing:pb,setElementWidth:vb,setFixedWidth:gb,setElementHeight:function(e,t){"flex"===t?(e.style.removeProperty("height"),e.style.removeProperty("minHeight"),e.style.removeProperty("maxHeight"),e.style.flex="1 1 auto"):mb(e,t)},setFixedHeight:mb,formatSize:yb,isNodeOrElement:wb,copyNodeList:bb,iterateNamedNodeMap:Cb,addOrRemoveAttribute:Sb,nodeListForEach:Eb}),xb={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"};function Tb(e,t,n){var r=Rb(e,t,n);if(r){var i=r.className;if("string"===typeof i&&i.indexOf("ag-icon")>-1||"object"===typeof i&&i["ag-icon"])return r}var o=document.createElement("span");return o.appendChild(r),o}function Rb(e,t,n,r){var i,o=null,a=n&&n.getColDef().icons;if(a&&(o=a[e]),t&&!o){var s=t.get("icons");s&&(o=s[e])}if(!o){var l=document.createElement("span"),u=xb[e];return u||(r?u=e:(console.warn("AG Grid: Did not find icon ".concat(e)),u="")),l.setAttribute("class","ag-icon ag-icon-".concat(u)),l.setAttribute("unselectable","on"),Fy(l,"presentation"),l}if("function"===typeof o)i=o();else{if("string"!==typeof o)throw new Error("icon from grid options needs to be a string or a function");i=o}return"string"===typeof i?ab(i):wb(i)?i:void console.warn("AG Grid: iconRenderer should return back a string or a dom object")}var Ab=Object.freeze({__proto__:null,iconNameClassMap:xb,createIcon:Tb,createIconNoSpan:Rb}),_b=A((function e(){T(this,e)}));_b.BACKSPACE="Backspace",_b.TAB="Tab",_b.ENTER="Enter",_b.ESCAPE="Escape",_b.SPACE=" ",_b.LEFT="ArrowLeft",_b.UP="ArrowUp",_b.RIGHT="ArrowRight",_b.DOWN="ArrowDown",_b.DELETE="Delete",_b.F2="F2",_b.PAGE_UP="PageUp",_b.PAGE_DOWN="PageDown",_b.PAGE_HOME="Home",_b.PAGE_END="End",_b.A="KeyA",_b.C="KeyC",_b.D="KeyD",_b.V="KeyV",_b.X="KeyX",_b.Y="KeyY",_b.Z="KeyZ";function Ob(e){return!(e.altKey||e.ctrlKey||e.metaKey)&&1===e.key.length}function Db(e,t,n,r,i){var o=r?r.getColDef().suppressKeyboardEvent:void 0;if(!o)return!1;var a={event:t,editing:i,column:r,api:e.api,node:n,data:n.data,colDef:r.getColDef(),context:e.context,columnApi:e.columnApi};if(o&&o(a))return!0;return!1}function Nb(e,t,n,r){var i=r.getDefinition(),o=i&&i.suppressHeaderKeyboardEvent;return!!fg(o)&&!!o({api:e.api,columnApi:e.columnApi,context:e.context,colDef:i,column:r,headerRowIndex:n,event:t})}function Pb(e){var t;switch(e.keyCode){case 65:t=_b.A;break;case 67:t=_b.C;break;case 86:t=_b.V;break;case 68:t=_b.D;break;case 90:t=_b.Z;break;case 89:t=_b.Y;break;default:t=e.code}return t}function Fb(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e===_b.DELETE||!t&&e===_b.BACKSPACE&&bw()}var Ib=Object.freeze({__proto__:null,isEventFromPrintableCharacter:Ob,isUserSuppressingKeyboardEvent:Db,isUserSuppressingHeaderKeyboardEvent:Nb,normaliseQwertyAzerty:Pb,isDeleteKey:Fb});function Lb(e,t,n){if(0===n)return!1;var r=Math.abs(e.clientX-t.clientX),i=Math.abs(e.clientY-t.clientY);return Math.max(r,i)<=n}var Mb=Object.freeze({__proto__:null,areEventsNear:Lb});var Gb=Object.freeze({__proto__:null,sortRowNodesByOrder:function(e,t){if(!e)return!1;for(var n=function(e,n){var r=t[e.id],i=t[n.id],o=void 0!==r,a=void 0!==i;return o&&a?r-i:!o&&!a?e.__objectId-n.__objectId:o?1:-1},r=!1,i=0;i<e.length-1;i++)if(n(e[i],e[i+1])>0){r=!0;break}return!!r&&(e.sort(n),!0)},traverseNodesWithKey:function(e,t){var n=[];!function e(r){if(!r)return;r.forEach((function(r){if(r.group||r.hasChildren()){n.push(r.key);var i=n.join("|");t(r,i),e(r.childrenAfterGroup),n.pop()}}))}(e)}});function Bb(e){var t=new Set;return e.forEach((function(e){return t.add(e)})),t}var jb,Hb=Object.freeze({__proto__:null,convertToSet:Bb}),Vb=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},vw),Am),Ow),jw),kb),jm),Yg),vy),bg),Ab),Ib),ly),Mb),Fw),Fg),Gb),Hb),ay),Wb=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;T(this,e),this.nextValue=t,this.step=n}return A(e,[{key:"next",value:function(){var e=this.nextValue;return this.nextValue+=this.step,e}},{key:"peek",value:function(){return this.nextValue}},{key:"skip",value:function(e){this.nextValue+=e}}]),e}();!function(e){e[e.IN_PROGRESS=0]="IN_PROGRESS",e[e.RESOLVED=1]="RESOLVED"}(jb||(jb={}));var zb,Ub=function(){function e(t){var n=this;T(this,e),this.status=jb.IN_PROGRESS,this.resolution=null,this.waiters=[],t((function(e){return n.onDone(e)}),(function(e){return n.onReject(e)}))}return A(e,[{key:"then",value:function(t){var n=this;return new e((function(e){n.status===jb.RESOLVED?e(t(n.resolution)):n.waiters.push((function(n){return e(t(n))}))}))}},{key:"resolveNow",value:function(e,t){return this.status===jb.RESOLVED?t(this.resolution):e}},{key:"onDone",value:function(e){this.status=jb.RESOLVED,this.resolution=e,this.waiters.forEach((function(t){return t(e)}))}},{key:"onReject",value:function(e){console.warn("TBI")}}],[{key:"all",value:function(t){return new e((function(e){var n=t.length,r=new Array(n);t.forEach((function(t,i){t.then((function(t){r[i]=t,0===--n&&e(r)}))}))}))}},{key:"resolve",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new e((function(e){return e(t)}))}}]),e}(),Kb=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e[e.NOTHING=0]="NOTHING",e[e.WAITING_TO_SHOW=1]="WAITING_TO_SHOW",e[e.SHOWING=2]="SHOWING"}(zb||(zb={}));var qb=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).DEFAULT_SHOW_TOOLTIP_DELAY=2e3,r.DEFAULT_HIDE_TOOLTIP_DELAY=1e4,r.SHOW_QUICK_TOOLTIP_DIFF=1e3,r.FADE_OUT_TOOLTIP_TIMEOUT=1e3,r.state=zb.NOTHING,r.tooltipInstanceCount=0,r.tooltipMouseTrack=!1,r.parentComp=e,r}return A(n,[{key:"postConstruct",value:function(){this.tooltipShowDelay=this.getTooltipDelay("show")||this.DEFAULT_SHOW_TOOLTIP_DELAY,this.tooltipHideDelay=this.getTooltipDelay("hide")||this.DEFAULT_HIDE_TOOLTIP_DELAY,this.tooltipMouseTrack=this.gridOptionsService.is("tooltipMouseTrack");var e=this.parentComp.getGui();this.addManagedListener(e,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(e,"mouseleave",this.onMouseLeave.bind(this)),this.addManagedListener(e,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(e,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(e,"keydown",this.onKeyDown.bind(this))}},{key:"destroy",value:function(){this.setToDoNothing(),cg(D(n.prototype),"destroy",this).call(this)}},{key:"onMouseEnter",value:function(e){if(!Cw()&&this.state==zb.NOTHING){var t=this.isLastTooltipHiddenRecently()?200:this.tooltipShowDelay;this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.lastMouseEvent=e,this.state=zb.WAITING_TO_SHOW}}},{key:"onMouseLeave",value:function(){this.setToDoNothing()}},{key:"onKeyDown",value:function(){this.setToDoNothing()}},{key:"setToDoNothing",value:function(){this.state===zb.SHOWING&&this.hideTooltip(),this.clearTimeouts(),this.state=zb.NOTHING}},{key:"onMouseMove",value:function(e){this.lastMouseEvent=e,this.tooltipMouseTrack&&this.state===zb.SHOWING&&this.tooltipComp&&this.positionTooltipUnderLastMouseEvent()}},{key:"onMouseDown",value:function(){this.setToDoNothing()}},{key:"getTooltipDelay",value:function(e){var t=this.gridOptionsService.getNum("tooltipShowDelay"),n=this.gridOptionsService.getNum("tooltipHideDelay"),r="show"===e?t:n,i=ny(e);return fg(r)?(r<0&&Lg((function(){return console.warn("AG Grid: tooltip".concat(i,"Delay should not be lower than 0"))}),"tooltip".concat(i,"DelayWarn")),Math.max(200,r)):null}},{key:"hideTooltip",value:function(){this.tooltipComp&&(this.destroyTooltipComp(),n.lastTooltipHideTime=(new Date).getTime()),this.state=zb.NOTHING}},{key:"destroyTooltipComp",value:function(){var e=this;this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");var t=this.tooltipPopupDestroyFunc,n=this.tooltipComp;window.setTimeout((function(){t(),e.getContext().destroyBean(n)}),this.FADE_OUT_TOOLTIP_TIMEOUT),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}},{key:"isLastTooltipHiddenRecently",value:function(){return(new Date).getTime()-n.lastTooltipHideTime<this.SHOW_QUICK_TOOLTIP_DIFF}},{key:"showTooltip",value:function(){var e=Object.assign({},this.parentComp.getTooltipParams());if(fg(e.value)){this.state=zb.SHOWING,this.tooltipInstanceCount++;var t=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(e).newAgStackInstance().then(t)}else this.setToDoNothing()}},{key:"newTooltipComponentCallback",value:function(e,t){if(this.state!==zb.SHOWING||this.tooltipInstanceCount!==e)this.getContext().destroyBean(t);else{var n=t.getGui();this.tooltipComp=t,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom");var r=this.localeService.getLocaleTextFunc(),i=this.popupService.addPopup({eChild:n,ariaLabel:r("ariaLabelTooltip","Tooltip")});i&&(this.tooltipPopupDestroyFunc=i.hideFunc),this.positionTooltipUnderLastMouseEvent(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.tooltipHideDelay)}}},{key:"positionTooltipUnderLastMouseEvent",value:function(){this.popupService.positionPopupUnderMouseEvent({type:"tooltip",mouseEvent:this.lastMouseEvent,ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack})}},{key:"clearTimeouts",value:function(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0),this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}}]),n}(Vm);Kb([nm("popupService")],qb.prototype,"popupService",void 0),Kb([nm("userComponentFactory")],qb.prototype,"userComponentFactory",void 0),Kb([$g],qb.prototype,"postConstruct",null);var Xb=function(){function e(t){T(this,e),this.cssClassStates={},this.getGui=t}return A(e,[{key:"addCssClass",value:function(e){var t=this,n=(e||"").split(" ");if(n.length>1)n.forEach((function(e){return t.addCssClass(e)}));else if(!0!==this.cssClassStates[e]&&e.length){var r=this.getGui();r&&r.classList.add(e),this.cssClassStates[e]=!0}}},{key:"removeCssClass",value:function(e){var t=this,n=(e||"").split(" ");if(n.length>1)n.forEach((function(e){return t.removeCssClass(e)}));else if(!1!==this.cssClassStates[e]&&e.length){var r=this.getGui();r&&r.classList.remove(e),this.cssClassStates[e]=!1}}},{key:"containsCssClass",value:function(e){var t=this.getGui();return!!t&&t.classList.contains(e)}},{key:"addOrRemoveCssClass",value:function(e,t){var n=this;if(e){if(e.indexOf(" ")>=0){var r=(e||"").split(" ");if(r.length>1)return void r.forEach((function(e){return n.addOrRemoveCssClass(e,t)}))}if(this.cssClassStates[e]!==t&&e.length){var i=this.getGui();i&&i.classList.toggle(e,t),this.cssClassStates[e]=t}}}}]),e}(),Yb=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Qb=new Wb,Zb=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).displayed=!0,r.visible=!0,r.compId=Qb.next(),r.cssClassManager=new Xb((function(){return r.eGui})),e&&r.setTemplate(e),r}return A(n,[{key:"preConstructOnComponent",value:function(){this.usingBrowserTooltips=this.gridOptionsService.is("enableBrowserTooltips")}},{key:"getCompId",value:function(){return this.compId}},{key:"getTooltipParams",value:function(){return{value:this.tooltipText,location:"UNKNOWN"}}},{key:"setTooltip",value:function(e){var t=this;this.tooltipText!=e&&(this.tooltipText&&(t.usingBrowserTooltips?t.getGui().removeAttribute("title"):t.tooltipFeature=t.destroyBean(t.tooltipFeature)),null!=e&&(this.tooltipText=e,this.tooltipText&&(t.usingBrowserTooltips?t.getGui().setAttribute("title",t.tooltipText):t.tooltipFeature=t.createBean(new qb(t)))))}},{key:"createChildComponentsFromTags",value:function(e,t){var n=this;bb(e.childNodes).forEach((function(r){if(r instanceof HTMLElement){var i=n.createComponentFromElement(r,(function(e){e.getGui()&&n.copyAttributesFromNode(r,e.getGui())}),t);if(i){if(i.addItems&&r.children.length){n.createChildComponentsFromTags(r,t);var o=Array.prototype.slice.call(r.children);i.addItems(o)}n.swapComponentForNode(i,e,r)}else r.childNodes&&n.createChildComponentsFromTags(r,t)}}))}},{key:"createComponentFromElement",value:function(e,t,r){var i=e.nodeName,o=r?r[e.getAttribute("ref")]:void 0,a=this.agStackComponentsRegistry.getComponentClass(i);if(a){n.elementGettingCreated=e;var s=new a(o);return s.setParentComponent(this),this.createBean(s,null,t),s}return null}},{key:"copyAttributesFromNode",value:function(e,t){Cb(e.attributes,(function(e,n){return t.setAttribute(e,n)}))}},{key:"swapComponentForNode",value:function(e,t,n){var r=e.getGui();t.replaceChild(r,n),t.insertBefore(document.createComment(n.nodeName),r),this.addDestroyFunc(this.destroyBean.bind(this,e)),this.swapInComponentForQuerySelectors(e,n)}},{key:"swapInComponentForQuerySelectors",value:function(e,t){var n=this;this.iterateOverQuerySelectors((function(r){n[r.attributeName]===t&&(n[r.attributeName]=e)}))}},{key:"iterateOverQuerySelectors",value:function(e){for(var t=Object.getPrototypeOf(this);null!=t;){var n=t.__agComponentMetaData,r=Mg(t.constructor);n&&n[r]&&n[r].querySelectors&&n[r].querySelectors.forEach((function(t){return e(t)})),t=Object.getPrototypeOf(t)}}},{key:"activateTabIndex",value:function(e){var t=this.gridOptionsService.getNum("tabIndex")||0;e||(e=[]),e.length||e.push(this.getGui()),e.forEach((function(e){return e.setAttribute("tabindex",t.toString())}))}},{key:"setTemplate",value:function(e,t){var n=ab(e);this.setTemplateFromElement(n,t)}},{key:"setTemplateFromElement",value:function(e,t){this.eGui=e,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),t)}},{key:"createChildComponentsPreConstruct",value:function(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())}},{key:"wireQuerySelectors",value:function(){var e=this;if(this.eGui){var t=this;this.iterateOverQuerySelectors((function(n){var r=function(e){return t[n.attributeName]=e};if(n.refSelector&&e.getAttribute("ref")===n.refSelector)r(e.eGui);else{var i=e.eGui.querySelector(n.querySelector);i&&r(i.__agComponent||i)}}))}}},{key:"getGui",value:function(){return this.eGui}},{key:"getFocusableElement",value:function(){return this.eGui}},{key:"setParentComponent",value:function(e){this.parentComponent=e}},{key:"getParentComponent",value:function(){return this.parentComponent}},{key:"setGui",value:function(e){this.eGui=e}},{key:"queryForHtmlElement",value:function(e){return this.eGui.querySelector(e)}},{key:"queryForHtmlInputElement",value:function(e){return this.eGui.querySelector(e)}},{key:"appendChild",value:function(e,t){if(null!=e)if(t||(t=this.eGui),wb(e))t.appendChild(e);else{var n=e;t.appendChild(n.getGui())}}},{key:"isDisplayed",value:function(){return this.displayed}},{key:"setVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e!==this.visible){this.visible=e;var n=t.skipAriaHidden;Uw(this.eGui,e,{skipAriaHidden:n})}}},{key:"setDisplayed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e!==this.displayed){this.displayed=e;var r=t.skipAriaHidden;zw(this.eGui,e,{skipAriaHidden:r});var i={type:n.EVENT_DISPLAYED_CHANGED,visible:this.displayed};this.dispatchEvent(i)}}},{key:"destroy",value:function(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.parentComponent&&(this.parentComponent=void 0);var e=this.eGui;e&&e.__agComponent&&(e.__agComponent=void 0),cg(D(n.prototype),"destroy",this).call(this)}},{key:"addGuiEventListener",value:function(e,t,n){var r=this;this.eGui.addEventListener(e,t,n),this.addDestroyFunc((function(){return r.eGui.removeEventListener(e,t)}))}},{key:"addCssClass",value:function(e){this.cssClassManager.addCssClass(e)}},{key:"removeCssClass",value:function(e){this.cssClassManager.removeCssClass(e)}},{key:"containsCssClass",value:function(e){return this.cssClassManager.containsCssClass(e)}},{key:"addOrRemoveCssClass",value:function(e,t){this.cssClassManager.addOrRemoveCssClass(e,t)}},{key:"getAttribute",value:function(e){var t=this.eGui;return t?t.getAttribute(e):null}},{key:"getRefElement",value:function(e){return this.queryForHtmlElement('[ref="'.concat(e,'"]'))}}]),n}(Vm);function Jb(e){return $b.bind(this,"[ref=".concat(e,"]"),e)}function $b(e,t,n,r,i){null!==e?"number"!==typeof i?function(e,t,n){var r=function(e,t){e.__agComponentMetaData||(e.__agComponentMetaData={});e.__agComponentMetaData[t]||(e.__agComponentMetaData[t]={});return e.__agComponentMetaData[t]}(e,Mg(e.constructor));r[t]||(r[t]=[]);r[t].push(n)}(n,"querySelectors",{attributeName:r,querySelector:e,refSelector:t}):console.error("AG Grid: QuerySelector should be on an attribute"):console.error("AG Grid: QuerySelector selector should not be null")}Zb.EVENT_DISPLAYED_CHANGED="displayedChanged",Yb([nm("agStackComponentsRegistry")],Zb.prototype,"agStackComponentsRegistry",void 0),Yb([Jg],Zb.prototype,"preConstructOnComponent",null),Yb([Jg],Zb.prototype,"createChildComponentsPreConstruct",null);var eC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},tC=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>')}return A(n,[{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this)}},{key:"init",value:function(e){this.params=e;var t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),n=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel("".concat(t," ").concat(n("ariaFilterInput","Filter Input")))}},{key:"onParentModelChanged",value:function(e){var t=this;e?this.params.parentFilterInstance((function(n){if(n.getModelAsString){var r=n.getModelAsString(e);t.eFloatingFilterText.setValue(r)}})):this.eFloatingFilterText.setValue("")}}]),n}(Zb);eC([Jb("eFloatingFilterText")],tC.prototype,"eFloatingFilterText",void 0),eC([nm("columnModel")],tC.prototype,"columnModel",void 0);var nC=function(){function e(t,n,r,i){var o=this;T(this,e),this.alive=!0,this.context=t,this.eParent=i,n.getDateCompDetails(r).newAgStackInstance().then((function(e){o.alive?(o.dateComp=e,e&&(i.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached(),o.tempValue&&e.setDate(o.tempValue),null!=o.disabled&&o.setDateCompDisabled(o.disabled))):t.destroyBean(e)}))}return A(e,[{key:"destroy",value:function(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}},{key:"getDate",value:function(){return this.dateComp?this.dateComp.getDate():this.tempValue}},{key:"setDate",value:function(e){this.dateComp?this.dateComp.setDate(e):this.tempValue=e}},{key:"setDisabled",value:function(e){this.dateComp?this.setDateCompDisabled(e):this.disabled=e}},{key:"setDisplayed",value:function(e){zw(this.eParent,e)}},{key:"setInputPlaceholder",value:function(e){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(e)}},{key:"setInputAriaLabel",value:function(e){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(e)}},{key:"afterGuiAttached",value:function(e){this.dateComp&&"function"===typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(e)}},{key:"setDateCompDisabled",value:function(e){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(e)}}]),e}(),rC=function(){function e(){T(this,e),this.customFilterOptions={}}return A(e,[{key:"init",value:function(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}},{key:"getFilterOptions",value:function(){return this.filterOptions}},{key:"mapCustomOptions",value:function(){var e=this;this.filterOptions&&this.filterOptions.forEach((function(t){if("string"!==typeof t){[["displayKey"],["displayName"],["predicate","test"]].every((function(e){return!!e.some((function(e){return null!=t[e]}))||(console.warn("AG Grid: ignoring FilterOptionDef as it doesn't contain one of '".concat(e,"'")),!1)}))?e.customFilterOptions[t.displayKey]=t:e.filterOptions=e.filterOptions.filter((function(e){return e===t}))||[]}}))}},{key:"selectDefaultItem",value:function(e){if(e.defaultOption)this.defaultOption=e.defaultOption;else if(this.filterOptions.length>=1){var t=this.filterOptions[0];"string"===typeof t?this.defaultOption=t:t.displayKey?this.defaultOption=t.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")}},{key:"getDefaultOption",value:function(){return this.defaultOption}},{key:"getCustomOption",value:function(e){return this.customFilterOptions[e]}}]),e}(),iC={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose One",equals:"Equals",notEqual:"Not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"In range",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equals",greaterThanOrEqual:"Greater than or equals",contains:"Contains",notContains:"Not contains",startsWith:"Starts with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"},oC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},aC=function(e){O(n,e);var t=F(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return T(this,n),(r=t.call(this)).eFocusableElement=e,r.callbacks=i,r.callbacks=Object.assign({shouldStopEventPropagation:function(){return!1},onTabKeyDown:function(e){if(!e.defaultPrevented){var t=r.focusService.findNextFocusableElement(r.eFocusableElement,!1,e.shiftKey);t&&(t.focus(),e.preventDefault())}}},i),r}return A(n,[{key:"postConstruct",value:function(){this.eFocusableElement.classList.add(n.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)}},{key:"addKeyDownListeners",value:function(e){var t=this;this.addManagedListener(e,"keydown",(function(e){e.defaultPrevented||Pm(e)||(t.callbacks.shouldStopEventPropagation(e)?Nm(e):e.key===_b.TAB?t.callbacks.onTabKeyDown(e):t.callbacks.handleKeyDown&&t.callbacks.handleKeyDown(e))}))}}]),n}(Vm);aC.FOCUS_MANAGED_CLASS="ag-focus-managed",oC([nm("focusService")],aC.prototype,"focusService",void 0),oC([$g],aC.prototype,"postConstruct",null);var sC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},lC="ag-resizer-wrapper",uC='<div class="'.concat(lC,'">\n        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>\n        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>\n        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>\n        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>\n        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>\n        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>\n        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>\n        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>\n    </div>'),cC=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this)).element=e,i.dragStartPosition={x:0,y:0},i.position={x:0,y:0},i.lastSize={width:-1,height:-1},i.positioned=!1,i.resizersAdded=!1,i.resizeListeners=[],i.boundaryEl=null,i.isResizing=!1,i.isMoving=!1,i.resizable={},i.movable=!1,i.currentResizer=null,i.config=Object.assign({},{popup:!1},r),i}return A(n,[{key:"center",value:function(){var e=this.offsetParent,t=e.clientHeight,n=e.clientWidth/2-this.getWidth()/2,r=t/2-this.getHeight()/2;this.offsetElement(n,r)}},{key:"initialisePosition",value:function(){if(!this.positioned){var e=this.config,t=e.centered,n=e.forcePopupParentAsOffsetParent,r=e.minWidth,i=e.width,o=e.minHeight,a=e.height,s=e.x,l=e.y;this.offsetParent||this.setOffsetParent();var u=0,c=0,d=!!this.element.offsetParent;if(d){var h=this.findBoundaryElement(),f=window.getComputedStyle(h);if(null!=f.minWidth){var p=h.offsetWidth-this.element.offsetWidth;c=parseInt(f.minWidth,10)-p}if(null!=f.minHeight){var v=h.offsetHeight-this.element.offsetHeight;u=parseInt(f.minHeight,10)-v}}if(this.minHeight=o||u,this.minWidth=r||c,i&&this.setWidth(i),a&&this.setHeight(a),i&&a||this.refreshSize(),t)this.center();else if(s||l)this.offsetElement(s,l);else if(d&&n){var g=this.boundaryEl,m=!0;if(g||(g=this.findBoundaryElement(),m=!1),g){var y=parseFloat(g.style.top),w=parseFloat(g.style.left);m?this.offsetElement(isNaN(w)?0:w,isNaN(y)?0:y):this.setPosition(w,y)}}this.positioned=!!this.offsetParent}}},{key:"isPositioned",value:function(){return this.positioned}},{key:"getPosition",value:function(){return this.position}},{key:"setMovable",value:function(e,t){if(this.config.popup&&e!==this.movable){this.movable=e;var n=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragService.addDragSource(n),this.moveElementDragListener=n):(this.dragService.removeDragSource(n),this.moveElementDragListener=void 0)}}},{key:"setResizable",value:function(e){var t=this;if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),"boolean"===typeof e){if(!1===e)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach((function(n){var r=!!e[n],i=t.getResizerElement(n),o={dragStartPixels:0,eElement:i,onDragStart:function(e){return t.onResizeStart(e,n)},onDragging:t.onResize.bind(t),onDragStop:function(e){return t.onResizeEnd(e,n)}};(r||!t.isAlive()&&!r)&&(r?(t.dragService.addDragSource(o),t.resizeListeners.push(o),i.style.pointerEvents="all"):i.style.pointerEvents="none",t.resizable[n]=r)}))}},{key:"removeSizeFromEl",value:function(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}},{key:"restoreLastSize",value:function(){this.element.style.flex="0 0 auto";var e=this.lastSize,t=e.height,n=e.width;-1!==n&&(this.element.style.width="".concat(n,"px")),-1!==t&&(this.element.style.height="".concat(t,"px"))}},{key:"getHeight",value:function(){return this.element.offsetHeight}},{key:"setHeight",value:function(e){var t=this.config.popup,n=this.element,r=!1;if("string"===typeof e&&-1!==e.indexOf("%"))mb(n,e),e=Zw(n),r=!0;else if(e=Math.max(this.minHeight,e),this.positioned){var i=this.getAvailableHeight();i&&e>i&&(e=i)}this.getHeight()!==e&&(r?(n.style.maxHeight="unset",n.style.minHeight="unset"):t?mb(n,e):(n.style.height="".concat(e,"px"),n.style.flex="0 0 auto",this.lastSize.height="number"===typeof e?e:parseFloat(e)))}},{key:"getAvailableHeight",value:function(){var e=this.config,t=e.popup,n=e.forcePopupParentAsOffsetParent;this.positioned||this.initialisePosition();var r=this.offsetParent.clientHeight;if(!r)return null;var i=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),a=t?this.position.y:i.top,s=t?0:o.top,l=0;if(n){var u=this.element.parentElement;if(u)l=u.getBoundingClientRect().bottom-i.bottom}return r+s-a-l}},{key:"getWidth",value:function(){return this.element.offsetWidth}},{key:"setWidth",value:function(e){var t=this.element,n=this.config.popup,r=!1;if("string"===typeof e&&-1!==e.indexOf("%"))gb(t,e),e=Jw(t),r=!0;else if(this.positioned){e=Math.max(this.minWidth,e);var i=this.offsetParent.clientWidth,o=n?this.position.x:this.element.getBoundingClientRect().left;i&&e+o>i&&(e=i-o)}this.getWidth()!==e&&(r?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?gb(t,e):(t.style.width="".concat(e,"px"),t.style.flex=" unset",this.lastSize.width="number"===typeof e?e:parseFloat(e)))}},{key:"offsetElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.config.forcePopupParentAsOffsetParent?this.boundaryEl:this.element;n&&(this.popupService.positionPopup({ePopup:n,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:function(){return{x:e,y:t}}}),this.setPosition(parseFloat(n.style.left),parseFloat(n.style.top)))}},{key:"constrainSizeToAvailableHeight",value:function(e){var t=this;if(this.config.forcePopupParentAsOffsetParent){e?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),(function(){var e=t.getAvailableHeight();t.element.style.setProperty("max-height","".concat(e,"px"))})):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}}},{key:"setPosition",value:function(e,t){this.position.x=e,this.position.y=t}},{key:"updateDragStartPosition",value:function(e,t){this.dragStartPosition={x:e,y:t}}},{key:"calculateMouseMovement",value:function(e){var t=e.e,n=e.isLeft,r=e.isTop,i=e.anywhereWithin,o=e.topBuffer,a=t.clientX-this.dragStartPosition.x,s=t.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(t,!!n,!!i,a)?0:a,movementY:this.shouldSkipY(t,!!r,o,s)?0:s}}},{key:"shouldSkipX",value:function(e,t,n,r){var i=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),a=this.boundaryEl.getBoundingClientRect(),s=this.config.popup?this.position.x:i.left,l=s<=0&&o.left>=e.clientX||o.right<=e.clientX&&o.right<=a.right;return!!l||(l=t?r<0&&e.clientX>s+o.left||r>0&&e.clientX<s+o.left:n?r<0&&e.clientX>a.right||r>0&&e.clientX<s+o.left:r<0&&e.clientX>a.right||r>0&&e.clientX<a.right)}},{key:"shouldSkipY",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),a=this.boundaryEl.getBoundingClientRect(),s=this.config.popup?this.position.y:i.top,l=s<=0&&o.top>=e.clientY||o.bottom<=e.clientY&&o.bottom<=a.bottom;return!!l||(l=t?r<0&&e.clientY>s+o.top+n||r>0&&e.clientY<s+o.top:r<0&&e.clientY>a.bottom||r>0&&e.clientY<a.bottom)}},{key:"createResizeMap",value:function(){var e=this.element;this.resizerMap={topLeft:{element:e.querySelector("[ref=eTopLeftResizer]")},top:{element:e.querySelector("[ref=eTopResizer]")},topRight:{element:e.querySelector("[ref=eTopRightResizer]")},right:{element:e.querySelector("[ref=eRightResizer]")},bottomRight:{element:e.querySelector("[ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[ref=eBottomLeftResizer]")},left:{element:e.querySelector("[ref=eLeftResizer]")}}}},{key:"addResizers",value:function(){if(!this.resizersAdded){var e=this.element;if(e){var t=(new DOMParser).parseFromString(uC,"text/html").body;e.appendChild(t.firstChild),this.createResizeMap(),this.resizersAdded=!0}}}},{key:"removeResizers",value:function(){this.resizerMap=void 0;var e=this.element.querySelector(".".concat(lC));e&&this.element.removeChild(e),this.resizersAdded=!1}},{key:"getResizerElement",value:function(e){return this.resizerMap[e].element}},{key:"onResizeStart",value:function(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");var n=this.config,r=n.popup,i=n.forcePopupParentAsOffsetParent;r||i||this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}},{key:"getSiblings",value:function(){var e=this.element.parentElement;return e?Array.prototype.slice.call(e.children).filter((function(e){return!e.classList.contains("ag-hidden")})):null}},{key:"getMinSizeOfSiblings",value:function(){for(var e=this.getSiblings()||[],t=0,n=0,r=0;r<e.length;r++){var i=e[r],o=!!i.style.flex&&"0 0 auto"!==i.style.flex;if(i!==this.element){var a=this.minHeight||0,s=this.minWidth||0;if(o){var l=window.getComputedStyle(i);l.minHeight&&(a=parseInt(l.minHeight,10)),l.minWidth&&(s=parseInt(l.minWidth,10))}else a=i.offsetHeight,s=i.offsetWidth;t+=a,n+=s}}return{height:t,width:n}}},{key:"applySizeToSiblings",value:function(e){var t=null,n=this.getSiblings();if(n){for(var r=0;r<n.length;r++){var i=n[r];i!==t&&(e?i.style.height="".concat(i.offsetHeight,"px"):i.style.width="".concat(i.offsetWidth,"px"),i.style.flex="0 0 auto",i===this.element&&(t=n[r+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}},{key:"isResizable",value:function(){return Object.values(this.resizable).some((function(e){return e}))}},{key:"onResize",value:function(e){if(this.isResizing&&this.currentResizer){var t=this.config,n=t.popup,r=t.forcePopupParentAsOffsetParent,i=this.currentResizer,o=i.isTop,a=i.isRight,s=i.isBottom,l=i.isLeft,u=a||l,c=s||o,d=this.calculateMouseMovement({e:e,isLeft:l,isTop:o}),h=d.movementX,f=d.movementY,p=this.position.x,v=this.position.y,g=0,m=0;if(u&&h){var y=l?-1:1,w=this.getWidth(),b=w+h*y,C=!1;l&&(p+(g=w-b)<=0||b<=this.minWidth)&&(C=!0,g=0),C||this.setWidth(b)}if(c&&f){var S=o?-1:1,E=this.getHeight(),k=E+f*S,x=!1;o?(v+(m=E-k)<=0||k<=this.minHeight)&&(x=!0,m=0):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&E<k&&this.getMinSizeOfSiblings().height+k>this.element.parentElement.offsetHeight&&(x=!0),x||this.setHeight(k)}this.updateDragStartPosition(e.clientX,e.clientY),((n||r)&&g||m)&&this.offsetElement(p+g,v+m)}}},{key:"onResizeEnd",value:function(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;var n={type:"resize",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi};this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchEvent(n)}},{key:"refreshSize",value:function(){var e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}},{key:"onMoveStart",value:function(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}},{key:"onMove",value:function(e){if(this.isMoving){var t,n=this.position,r=n.x,i=n.y;this.config.calculateTopBuffer&&(t=this.config.calculateTopBuffer());var o=this.calculateMouseMovement({e:e,isTop:!0,anywhereWithin:!0,topBuffer:t}),a=o.movementX,s=o.movementY;this.offsetElement(r+a,i+s),this.updateDragStartPosition(e.clientX,e.clientY)}}},{key:"onMoveEnd",value:function(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}},{key:"setOffsetParent",value:function(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent}},{key:"findBoundaryElement",value:function(){for(var e=this.element;e;){if("static"!==window.getComputedStyle(e).position)return e;e=e.parentElement}return this.element}},{key:"clearResizeListeners",value:function(){for(;this.resizeListeners.length;){var e=this.resizeListeners.pop();this.dragService.removeDragSource(e)}}},{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}}]),n}(Vm);sC([nm("popupService")],cC.prototype,"popupService",void 0),sC([nm("resizeObserverService")],cC.prototype,"resizeObserverService",void 0),sC([nm("dragService")],cC.prototype,"dragService",void 0);var dC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},hC=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).filterNameKey=e,r.applyActive=!1,r.hidePopup=null,r.debouncePending=!1,r.appliedModel=null,r}return A(n,[{key:"postConstruct",value:function(){this.resetTemplate(),this.createManagedBean(new aC(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new cC(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}},{key:"handleKeyDown",value:function(e){}},{key:"getFilterTitle",value:function(){return this.translate(this.filterNameKey)}},{key:"isFilterActive",value:function(){return!!this.appliedModel}},{key:"resetTemplate",value:function(e){var t=this.getGui();t&&t.removeEventListener("submit",this.onFormSubmit);var n='\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-'.concat(this.getCssIdentifier(),'-body-wrapper" ref="eFilterBody">\n                    ').concat(this.createBodyTemplate(),"\n                </div>\n            </form>");this.setTemplate(n,e),(t=this.getGui())&&t.addEventListener("submit",this.onFormSubmit)}},{key:"isReadOnly",value:function(){return!!this.providedFilterParams.readOnly}},{key:"init",value:function(e){var t=this;this.setParams(e),this.resetUiToDefaults(!0).then((function(){t.updateUiVisibility(),t.setupOnBtApplyDebounce()}))}},{key:"setParams",value:function(e){this.providedFilterParams=e,this.applyActive=n.isUseApplyButton(e),this.createButtonPanel()}},{key:"createButtonPanel",value:function(){var e=this,t=this.providedFilterParams.buttons;if(!(!t||t.length<1||this.isReadOnly())){var n=document.createElement("div");n.classList.add("ag-filter-apply-panel");Bb(t).forEach((function(t){return function(t){var r,i;switch(t){case"apply":r=e.translate("applyFilter"),i=function(t){return e.onBtApply(!1,!1,t)};break;case"clear":r=e.translate("clearFilter"),i=function(){return e.onBtClear()};break;case"reset":r=e.translate("resetFilter"),i=function(){return e.onBtReset()};break;case"cancel":r=e.translate("cancelFilter"),i=function(t){e.onBtCancel(t)};break;default:return void console.warn("AG Grid: Unknown button type specified")}var o=ab('<button\n                    type="'.concat("apply"===t?"submit":"button",'"\n                    ref="').concat(t,'FilterButton"\n                    class="ag-button ag-standard-button ag-filter-apply-panel-button"\n                >').concat(r,"\n                </button>"));n.appendChild(o),e.addManagedListener(o,"click",i)}(t)})),this.getGui().appendChild(n)}}},{key:"getDefaultDebounceMs",value:function(){return 0}},{key:"setupOnBtApplyDebounce",value:function(){var e=this,t=n.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs()),r=zg(this.checkApplyDebounce.bind(this),t);this.onBtApplyDebounce=function(){e.debouncePending=!0,r()}}},{key:"checkApplyDebounce",value:function(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}},{key:"getModel",value:function(){return this.appliedModel?this.appliedModel:null}},{key:"setModel",value:function(e){var t=this;return(null!=e?this.setModelIntoUi(e):this.resetUiToDefaults()).then((function(){t.updateUiVisibility(),t.applyModel("api")}))}},{key:"onBtCancel",value:function(e){var t=this;this.resetUiToActiveModel(this.getModel(),(function(){t.handleCancelEnd(e)}))}},{key:"handleCancelEnd",value:function(e){this.providedFilterParams.closeOnApply&&this.close(e)}},{key:"resetUiToActiveModel",value:function(e,t){var n=this,r=function(){n.onUiChanged(!1,"prevent"),null===t||void 0===t||t()};null!=e?this.setModelIntoUi(e).then(r):this.resetUiToDefaults().then(r)}},{key:"onBtClear",value:function(){var e=this;this.resetUiToDefaults().then((function(){return e.onUiChanged()}))}},{key:"onBtReset",value:function(){this.onBtClear(),this.onBtApply()}},{key:"applyModel",value:function(){var e=this.getModelFromUi();if(!this.isModelValid(e))return!1;var t=this.appliedModel;return this.appliedModel=e,!this.areModelsEqual(t,e)}},{key:"isModelValid",value:function(e){return!0}},{key:"onFormSubmit",value:function(e){e.preventDefault()}},{key:"onBtApply",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;n&&n.preventDefault(),this.applyModel(t?"rowDataUpdated":"ui")&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter:e,afterDataChange:t}),this.providedFilterParams.closeOnApply&&this.applyActive&&!e&&!t&&this.close(n)}},{key:"onNewRowsLoaded",value:function(){}},{key:"close",value:function(e){if(this.hidePopup){var t,n=e,r=n&&n.key;"Enter"!==r&&"Space"!==r||(t={keyboardEvent:n}),this.hidePopup(t),this.hidePopup=null}}},{key:"onUiChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){var n=this.isModelValid(this.getModelFromUi());Kw(this.getRefElement("applyFilterButton"),!n)}e&&!t||"immediately"===t?this.onBtApply(e):(this.applyActive||t)&&"debounce"!==t||this.onBtApplyDebounce()}},{key:"afterGuiAttached",value:function(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(null===e||void 0===e?void 0:e.container)}},{key:"refreshFilterResizer",value:function(e){if(this.positionableFeature&&"toolPanel"!==e){var t="floatingFilter"===e,n=this.positionableFeature,r=this.gridOptionsService;t?(n.restoreLastSize(),n.setResizable(r.is("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}}},{key:"afterGuiDetached",value:function(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}},{key:"destroy",value:function(){var e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),cg(D(n.prototype),"destroy",this).call(this)}},{key:"translate",value:function(e){var t=this.localeService.getLocaleTextFunc();return t(e,iC[e])}},{key:"getCellValue",value:function(e){var t=this.providedFilterParams,n=t.api,r=t.colDef,i=t.column,o=t.columnApi,a=t.context;return this.providedFilterParams.valueGetter({api:n,colDef:r,column:i,columnApi:o,context:a,data:e.data,getValue:function(t){return e.data[t]},node:e})}},{key:"getPositionableElement",value:function(){return this.eFilterBody}}],[{key:"getDebounceMs",value:function(e,t){return n.isUseApplyButton(e)?(null!=e.debounceMs&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):null!=e.debounceMs?e.debounceMs:t}},{key:"isUseApplyButton",value:function(e){return!!e.buttons&&e.buttons.indexOf("apply")>=0}}]),n}(Zb);dC([nm("rowModel")],hC.prototype,"rowModel",void 0),dC([Jb("eFilterBody")],hC.prototype,"eFilterBody",void 0),dC([$g],hC.prototype,"postConstruct",null);var fC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},pC=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this,r)).labelSeparator="",i.labelAlignment="left",i.disabled=!1,i.label="",i.config=e||{},i}return A(n,[{key:"postConstruct",value:function(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");var e=this.config,t=e.labelSeparator,n=e.label,r=e.labelWidth,i=e.labelAlignment;null!=t&&this.setLabelSeparator(t),null!=n&&this.setLabel(n),null!=r&&this.setLabelWidth(r),this.setLabelAlignment(i||this.labelAlignment),this.refreshLabel()}},{key:"refreshLabel",value:function(){rb(this.eLabel),"string"===typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(zw(this.eLabel,!1),Fy(this.eLabel,"presentation")):(zw(this.eLabel,!0),Fy(this.eLabel,null))}},{key:"setLabelSeparator",value:function(e){return this.labelSeparator===e||(this.labelSeparator=e,null!=this.label&&this.refreshLabel()),this}},{key:"getLabelId",value:function(){return this.eLabel.id=this.eLabel.id||"ag-".concat(this.getCompId(),"-label"),this.eLabel.id}},{key:"getLabel",value:function(){return this.label}},{key:"setLabel",value:function(e){return this.label===e||(this.label=e,this.refreshLabel()),this}},{key:"setLabelAlignment",value:function(e){var t=this.getGui().classList;return t.toggle("ag-label-align-left","left"===e),t.toggle("ag-label-align-right","right"===e),t.toggle("ag-label-align-top","top"===e),this}},{key:"setLabelEllipsis",value:function(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}},{key:"setLabelWidth",value:function(e){return null==this.label||vb(this.eLabel,e),this}},{key:"setDisabled",value:function(e){e=!!e;var t=this.getGui();return Kw(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}},{key:"isDisabled",value:function(){return!!this.disabled}}]),n}(Zb);fC([$g],pC.prototype,"postConstruct",null);var vC=function(e){O(n,e);var t=F(n);function n(e,r,i){var o;return T(this,n),(o=t.call(this,e,r)).className=i,o}return A(n,[{key:"postConstruct",value:function(){cg(D(n.prototype),"postConstruct",this).call(this),this.className&&this.addCssClass(this.className)}},{key:"onValueChange",value:function(e){var t=this;return this.addManagedListener(this,n.EVENT_CHANGED,(function(){return e(t.getValue())})),this}},{key:"getWidth",value:function(){return this.getGui().clientWidth}},{key:"setWidth",value:function(e){return gb(this.getGui(),e),this}},{key:"getPreviousValue",value:function(){return this.previousValue}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e,t){return this.value===e||(this.previousValue=this.value,this.value=e,t||this.dispatchEvent({type:n.EVENT_CHANGED})),this}}]),n}(pC);vC.EVENT_CHANGED="valueChange";var gC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},mC=function(e){O(n,e);var t=F(n);function n(e,r,i,o){var a;return T(this,n),(a=t.call(this,e,'<div class="ag-picker-field" role="presentation">\n                <div ref="eLabel"></div>\n                <div ref="eWrapper"\n                    class="ag-wrapper ag-picker-field-wrapper"\n                    tabIndex="-1"\n                    aria-expanded="false"\n                    '.concat(o?'role="'.concat(o,'"'):"",'\n                >\n                    <div ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>'),r)).pickerIcon=i,a.isPickerDisplayed=!1,a.isDestroyingPicker=!1,a.skipClick=!1,a}return A(n,[{key:"postConstruct",value:function(){var e=this;cg(D(n.prototype),"postConstruct",this).call(this);var t="ag-".concat(this.getCompId(),"-display");this.eDisplayField.setAttribute("id",t),Hy(this.eWrapper,t);var r=function(){e.skipClick?e.skipClick=!1:e.isDisabled()||(e.pickerComponent=e.showPicker())},i=this.getGui();if(this.addManagedListener(i,"mousedown",(function(t){!e.skipClick&&e.pickerComponent&&e.pickerComponent.isAlive()&&ob(e.pickerComponent.getGui())&&i.contains(t.target)&&(e.skipClick=!0)})),this.addManagedListener(i,"keydown",(function(t){switch(t.key){case _b.UP:case _b.DOWN:case _b.ENTER:case _b.SPACE:r();case _b.ESCAPE:e.isPickerDisplayed&&t.preventDefault()}})),this.addManagedListener(this.eWrapper,"click",r),this.addManagedListener(this.eLabel,"click",r),this.pickerIcon){var o=Rb(this.pickerIcon,this.gridOptionsService);o&&this.eIcon.appendChild(o)}}},{key:"refreshLabel",value:function(){fg(this.getLabel())?By(this.eWrapper,this.getLabelId()):this.eWrapper.removeAttribute("aria-labelledby"),cg(D(n.prototype),"refreshLabel",this).call(this)}},{key:"setAriaLabel",value:function(e){return Gy(this.eWrapper,e),this}},{key:"setInputWidth",value:function(e){return vb(this.eWrapper,e),this}},{key:"getFocusableElement",value:function(){return this.eWrapper}}]),n}(vC);gC([Jb("eLabel")],mC.prototype,"eLabel",void 0),gC([Jb("eWrapper")],mC.prototype,"eWrapper",void 0),gC([Jb("eDisplayField")],mC.prototype,"eDisplayField",void 0),gC([Jb("eIcon")],mC.prototype,"eIcon",void 0);var yC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},wC=function(e){O(n,e);var t=F(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return T(this,n),(e=t.call(this,'<div class="ag-list ag-'.concat(r,'-list" role="listbox"></div>'))).cssIdentifier=r,e.options=[],e.itemEls=[],e}return A(n,[{key:"init",value:function(){this.addManagedListener(this.getGui(),"keydown",this.handleKeyDown.bind(this))}},{key:"handleKeyDown",value:function(e){var t=e.key;switch(t){case _b.ENTER:if(this.highlightedEl){var n=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(n)}else this.setValue(this.getValue());break;case _b.DOWN:case _b.UP:var r,i=t===_b.DOWN;if(e.preventDefault(),this.highlightedEl){var o=this.itemEls.indexOf(this.highlightedEl)+(i?1:-1);o=Math.min(Math.max(o,0),this.itemEls.length-1),r=this.itemEls[o]}else r=this.itemEls[i?0:this.itemEls.length-1];this.highlightItem(r)}}},{key:"addOptions",value:function(e){var t=this;return e.forEach((function(e){return t.addOption(e)})),this}},{key:"addOption",value:function(e){var t=e.value,n=ry(e.text||t);return this.options.push({value:t,text:n}),this.renderOption(t,n),this.updateIndices(),this}},{key:"updateIndices",value:function(){var e=this.getGui().querySelectorAll(".ag-list-item");e.forEach((function(t,n){Yy(t,n+1),Xy(t,e.length)}))}},{key:"renderOption",value:function(e,t){var n=this,r=document.createElement("div");Fy(r,"option"),r.classList.add("ag-list-item","ag-".concat(this.cssIdentifier,"-list-item")),r.innerHTML="<span>".concat(t,"</span>"),r.tabIndex=-1,this.itemEls.push(r),this.addManagedListener(r,"mouseover",(function(){return n.highlightItem(r)})),this.addManagedListener(r,"mouseleave",(function(){return n.clearHighlighted()})),this.addManagedListener(r,"click",(function(){return n.setValue(e)})),this.getGui().appendChild(r)}},{key:"setValue",value:function(e,t){if(this.value===e)return this.fireItemSelected(),this;if(null==e)return this.reset(),this;var n=this.options.findIndex((function(t){return t.value===e}));if(-1!==n){var r=this.options[n];this.value=r.value,this.displayValue=null!=r.text?r.text:r.value,this.highlightItem(this.itemEls[n]),t||this.fireChangeEvent()}return this}},{key:"setValueByIndex",value:function(e){return this.setValue(this.options[e].value)}},{key:"getValue",value:function(){return this.value}},{key:"getDisplayValue",value:function(){return this.displayValue}},{key:"refreshHighlighted",value:function(){var e=this;this.clearHighlighted();var t=this.options.findIndex((function(t){return t.value===e.value}));-1!==t&&this.highlightItem(this.itemEls[t])}},{key:"reset",value:function(){this.value=null,this.displayValue=null,this.clearHighlighted(),this.fireChangeEvent()}},{key:"highlightItem",value:function(e){e.offsetParent&&(this.clearHighlighted(),this.highlightedEl=e,this.highlightedEl.classList.add(n.ACTIVE_CLASS),iw(this.highlightedEl,!0),this.highlightedEl.focus())}},{key:"clearHighlighted",value:function(){this.highlightedEl&&this.highlightedEl.offsetParent&&(this.highlightedEl.classList.remove(n.ACTIVE_CLASS),iw(this.highlightedEl,!1),this.highlightedEl=null)}},{key:"fireChangeEvent",value:function(){this.dispatchEvent({type:vC.EVENT_CHANGED}),this.fireItemSelected()}},{key:"fireItemSelected",value:function(){this.dispatchEvent({type:n.EVENT_ITEM_SELECTED})}}]),n}(Zb);wC.EVENT_ITEM_SELECTED="selectedItem",wC.ACTIVE_CLASS="ag-active-item",yC([$g],wC.prototype,"init",null);var bC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},CC=function(e){O(n,e);var t=F(n);function n(e){return T(this,n),t.call(this,e,"ag-select","smallDown","listbox")}return A(n,[{key:"init",value:function(){var e=this;this.listComponent=this.createBean(new wC("select")),this.listComponent.setParentComponent(this),this.eWrapper.tabIndex=0,this.listComponent.addManagedListener(this.listComponent,wC.EVENT_ITEM_SELECTED,(function(){e.hideList&&e.hideList(),e.dispatchEvent({type:n.EVENT_ITEM_SELECTED})})),this.listComponent.addManagedListener(this.listComponent,vC.EVENT_CHANGED,(function(){e.setValue(e.listComponent.getValue(),!1,!0),e.hideList&&e.hideList()}))}},{key:"showPicker",value:function(){var e=this,t=this.listComponent.getGui(),n=this.gridOptionsService.getDocument(),r=this.addManagedListener(n.body,"wheel",(function(n){!t.contains(n.target)&&e.hideList&&e.hideList()})),i=this.addManagedListener(t,"focusout",(function(n){!t.contains(n.relatedTarget)&&e.hideList&&e.hideList()})),o=this.localeService.getLocaleTextFunc(),a=this.popupService.addPopup({modal:!0,eChild:t,closeOnEsc:!0,closedCallback:function(){e.hideList=null,e.isPickerDisplayed=!1,i(),r(),e.isAlive()&&(Ky(e.eWrapper,!1),e.getFocusableElement().focus())},ariaLabel:o("ariaLabelSelectField","Select Field")});return a&&(this.hideList=a.hideFunc),this.isPickerDisplayed=!0,vb(t,Jw(this.eWrapper)),Ky(this.eWrapper,!0),t.style.maxHeight=Yw(this.popupService.getPopupParent())+"px",t.style.position="absolute",this.popupService.positionPopupByComponent({type:"ag-list",eventSource:this.eWrapper,ePopup:t,position:"under",keepWithinBounds:!0}),this.listComponent.refreshHighlighted(),this.listComponent}},{key:"addOptions",value:function(e){var t=this;return e.forEach((function(e){return t.addOption(e)})),this}},{key:"addOption",value:function(e){return this.listComponent.addOption(e),this}},{key:"setValue",value:function(e,t,r){return this.value===e?this:(r||this.listComponent.setValue(e,!0),this.listComponent.getValue()===this.getValue()?this:(this.eDisplayField.innerHTML=this.listComponent.getDisplayValue(),cg(D(n.prototype),"setValue",this).call(this,e,t)))}},{key:"destroy",value:function(){this.hideList&&this.hideList(),this.destroyBean(this.listComponent),cg(D(n.prototype),"destroy",this).call(this)}}]),n}(mC);CC.EVENT_ITEM_SELECTED="selectedItem",bC([nm("popupService")],CC.prototype,"popupService",void 0),bC([$g],CC.prototype,"init",null);var SC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},EC=function(e){O(n,e);var t=F(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"input";return T(this,n),(i=t.call(this,e,'\n            <div role="presentation">\n                <div ref="eLabel" class="ag-input-field-label"></div>\n                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <'.concat(a,' ref="eInput" class="ag-input-field-input"></').concat(a,">\n                </div>\n            </div>"),r)).inputType=o,i.displayFieldTag=a,i}return A(n,[{key:"postConstruct",value:function(){cg(D(n.prototype),"postConstruct",this).call(this),this.setInputType(),this.eLabel.classList.add("".concat(this.className,"-label")),this.eWrapper.classList.add("".concat(this.className,"-input-wrapper")),this.eInput.classList.add("".concat(this.className,"-input")),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||"ag-".concat(this.getCompId(),"-input");var e=this.config,t=e.width,r=e.value;null!=t&&this.setWidth(t),null!=r&&this.setValue(r),this.addInputListeners(),this.activateTabIndex([this.eInput])}},{key:"refreshLabel",value:function(){fg(this.getLabel())?By(this.eInput,this.getLabelId()):this.eInput.removeAttribute("aria-labelledby"),cg(D(n.prototype),"refreshLabel",this).call(this)}},{key:"addInputListeners",value:function(){var e=this;this.addManagedListener(this.eInput,"input",(function(t){return e.setValue(t.target.value)}))}},{key:"setInputType",value:function(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)}},{key:"getInputElement",value:function(){return this.eInput}},{key:"setInputWidth",value:function(e){return vb(this.eWrapper,e),this}},{key:"setInputName",value:function(e){return this.getInputElement().setAttribute("name",e),this}},{key:"getFocusableElement",value:function(){return this.eInput}},{key:"setMaxLength",value:function(e){return this.eInput.maxLength=e,this}},{key:"setInputPlaceholder",value:function(e){return Sb(this.eInput,"placeholder",e),this}},{key:"setInputAriaLabel",value:function(e){return Gy(this.eInput,e),this}},{key:"setDisabled",value:function(e){return Kw(this.eInput,e),cg(D(n.prototype),"setDisabled",this).call(this,e)}}]),n}(vC);SC([Jb("eLabel")],EC.prototype,"eLabel",void 0),SC([Jb("eWrapper")],EC.prototype,"eWrapper",void 0),SC([Jb("eInput")],EC.prototype,"eInput",void 0);var kC=function(e){O(n,e);var t=F(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ag-checkbox",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"checkbox";return T(this,n),(r=t.call(this,e,i,o)).labelAlignment="right",r.selected=!1,r.readOnly=!1,r.passive=!1,r}return A(n,[{key:"addInputListeners",value:function(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))}},{key:"getNextValue",value:function(){return void 0===this.selected||!this.selected}},{key:"setPassive",value:function(e){this.passive=e}},{key:"isReadOnly",value:function(){return this.readOnly}},{key:"setReadOnly",value:function(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}},{key:"setDisabled",value:function(e){return this.eWrapper.classList.toggle("ag-disabled",e),cg(D(n.prototype),"setDisabled",this).call(this,e)}},{key:"toggle",value:function(){if(!this.eInput.disabled){var e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}}},{key:"getValue",value:function(){return this.isSelected()}},{key:"setValue",value:function(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}},{key:"setName",value:function(e){return this.getInputElement().name=e,this}},{key:"isSelected",value:function(){return this.selected}},{key:"setSelected",value:function(e,t){this.isSelected()!==e&&(this.previousValue=this.isSelected(),e=this.selected="boolean"===typeof e?e:void 0,this.eInput.checked=e,this.eInput.indeterminate=void 0===e,t||this.dispatchChange(this.selected,this.previousValue))}},{key:"dispatchChange",value:function(e,t,r){this.dispatchEvent({type:n.EVENT_CHANGED,selected:e,previousValue:t,event:r});var i=this.getInputElement(),o={type:Ym.EVENT_CHECKBOX_CHANGED,id:i.id,name:i.name,selected:e,previousValue:t};this.eventService.dispatchEvent(o)}},{key:"onCheckboxClick",value:function(e){if(!this.passive&&!this.eInput.disabled){var t=this.isSelected(),n=this.selected=e.target.checked;this.refreshSelectedClass(n),this.dispatchChange(n,t,e)}}},{key:"refreshSelectedClass",value:function(e){this.eWrapper.classList.toggle("ag-checked",!0===e),this.eWrapper.classList.toggle("ag-indeterminate",null==e)}}]),n}(EC),xC=function(e){O(n,e);var t=F(n);function n(e){return T(this,n),t.call(this,e,"ag-radio-button","radio")}return A(n,[{key:"isSelected",value:function(){return this.eInput.checked}},{key:"toggle",value:function(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}},{key:"addInputListeners",value:function(){cg(D(n.prototype),"addInputListeners",this).call(this),this.addManagedListener(this.eventService,Ym.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))}},{key:"onChange",value:function(e){e.selected&&e.name&&this.eInput.name&&this.eInput.name===e.name&&e.id&&this.eInput.id!==e.id&&this.setValue(!1,!0)}}]),n}(kC),TC=function(){function e(t,n){T(this,e),this.localeService=t,this.optionsFactory=n}return A(e,[{key:"getModelAsString",value:function(e){var t=this;if(!e)return null;var n=null!=e.operator,r=this.localeService.getLocaleTextFunc();if(n){var i=e,o=i.conditions;if(!o)o=[i.condition1,i.condition2];var a=o.map((function(e){return t.getModelAsString(e)})),s="AND"===i.operator?"andCondition":"orCondition";return a.join(" ".concat(r(s,iC[s])," "))}if(e.type===RC.BLANK||e.type===RC.NOT_BLANK)return r(e.type,e.type);var l=e,u=this.optionsFactory.getCustomOption(l.type),c=u||{},d=c.displayKey,h=c.displayName,f=c.numberOfInputs;return d&&h&&0===f?(r(d,h),h):this.conditionToString(l,u)}}]),e}(),RC=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).eTypes=[],e.eJoinOperatorPanels=[],e.eJoinOperatorsAnd=[],e.eJoinOperatorsOr=[],e.eConditionBodies=[],e.listener=function(){return e.onUiChanged()},e.lastUiCompletePosition=null,e.joinOperatorId=0,e}return A(n,[{key:"getNumberOfInputs",value:function(e){var t=this.optionsFactory.getCustomOption(e);if(t){var r=t.numberOfInputs;return null!=r?r:1}var i=[n.EMPTY,n.NOT_BLANK,n.BLANK];return e&&i.indexOf(e)>=0?0:e===n.IN_RANGE?2:1}},{key:"onFloatingFilterChanged",value:function(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged(!0)}},{key:"setTypeFromFloatingFilter",value:function(e){var t=this;this.eTypes.forEach((function(n,r){0===r?n.setValue(e,!0):n.setValue(t.optionsFactory.getDefaultOption(),!0)}))}},{key:"getModelFromUi",value:function(){var e=this.getUiCompleteConditions();return 0===e.length?null:this.maxNumConditions>1&&e.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:e[0],condition2:e[1],conditions:e}:e[0]}},{key:"getConditionTypes",value:function(){return this.eTypes.map((function(e){return e.getValue()}))}},{key:"getConditionType",value:function(e){return this.eTypes[e].getValue()}},{key:"getJoinOperator",value:function(){return 0===this.eJoinOperatorsOr.length?this.defaultJoinOperator:!0===this.eJoinOperatorsOr[0].getValue()?"OR":"AND"}},{key:"areModelsEqual",value:function(e,t){var n=this;if(!e&&!t)return!0;if(!e&&t||e&&!t)return!1;var r,i=!e.operator,o=!t.operator;if(!i&&o||i&&!o)return!1;if(i){var a=e,s=t;r=this.areSimpleModelsEqual(a,s)}else{var l=e,u=t;r=l.operator===u.operator&&wm(l.conditions,u.conditions,(function(e,t){return n.areSimpleModelsEqual(e,t)}))}return r}},{key:"setModelIntoUi",value:function(e){var t=this;if(e.operator){var n=e;n.conditions||(n.conditions=[n.condition1,n.condition2]);var r=this.validateAndUpdateConditions(n.conditions),i=this.getNumConditions();if(r<i)this.removeConditionsAndOperators(r);else if(r>i)for(var o=i;o<r;o++)this.createJoinOperatorPanel(),this.createOption();var a="OR"===n.operator;this.eJoinOperatorsAnd.forEach((function(e){return e.setValue(!a,!0)})),this.eJoinOperatorsOr.forEach((function(e){return e.setValue(a,!0)})),n.conditions.forEach((function(e,n){t.eTypes[n].setValue(e.type,!0),t.setConditionIntoUi(e,n)}))}else{var s=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(s.type,!0),this.setConditionIntoUi(s,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),Ub.resolve()}},{key:"validateAndUpdateConditions",value:function(e){var t=e.length;return t>this.maxNumConditions&&(e.splice(this.maxNumConditions),Lg((function(){return console.warn('AG Grid: Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.')}),"simpleFilterSetModelMaxNumConditions"),t=this.maxNumConditions),t}},{key:"doesFilterPass",value:function(e){var t,n=this,r=this.getModel();if(null==r)return!0;var i=r.operator,o=[];if(i){var a=r;o.push.apply(o,wt(null!==(t=a.conditions)&&void 0!==t?t:[]))}else o.push(r);return o[i&&"OR"===i?"some":"every"]((function(t){return n.individualConditionPasses(e,t)}))}},{key:"setParams",value:function(e){cg(D(n.prototype),"setParams",this).call(this,e),this.setNumConditions(e),this.defaultJoinOperator=this.getDefaultJoinOperator(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new rC,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators()}},{key:"setNumConditions",value:function(e){var t,n;null!=e.suppressAndOrCondition&&Lg((function(){return console.warn('AG Grid: Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.')}),"simpleFilterSuppressAndOrCondition"),null!=e.alwaysShowBothConditions&&Lg((function(){return console.warn('AG Grid: Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.')}),"simpleFilterAlwaysShowBothConditions"),this.maxNumConditions=null!==(t=e.maxNumConditions)&&void 0!==t?t:e.suppressAndOrCondition?1:2,this.maxNumConditions<1&&(Lg((function(){return console.warn('AG Grid: "filterParams.maxNumConditions" must be greater than or equal to zero.')}),"simpleFilterMaxNumConditions"),this.maxNumConditions=1),this.numAlwaysVisibleConditions=null!==(n=e.numAlwaysVisibleConditions)&&void 0!==n?n:e.alwaysShowBothConditions?2:1,this.numAlwaysVisibleConditions<1&&(Lg((function(){return console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.')}),"simpleFilterNumAlwaysVisibleConditions"),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(Lg((function(){return console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".')}),"simpleFilterNumAlwaysVisibleGreaterThanMaxNumConditions"),this.numAlwaysVisibleConditions=this.maxNumConditions)}},{key:"createOption",value:function(){var e=this,t=this.createManagedBean(new CC);this.eTypes.push(t),t.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(t.getGui());var n=this.createValueElement();this.eConditionBodies.push(n),this.eFilterBody.appendChild(n),this.putOptionsIntoDropdown(t),this.resetType(t);var r=this.getNumConditions()-1;this.forEachPositionInput(r,(function(t){return e.resetInput(t)})),this.addChangedListeners(t,r)}},{key:"createJoinOperatorPanel",value:function(){var e=document.createElement("div");this.eJoinOperatorPanels.push(e),e.classList.add("ag-filter-condition");var t=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),n=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);var r=this.eJoinOperatorPanels.length-1,i=this.joinOperatorId++;this.resetJoinOperatorAnd(t,r,i),this.resetJoinOperatorOr(n,r,i),this.isReadOnly()||(t.onValueChange(this.listener),n.onValueChange(this.listener))}},{key:"createJoinOperator",value:function(e,t,n){var r=this.createManagedBean(new xC);return e.push(r),r.addCssClass("ag-filter-condition-operator"),r.addCssClass("ag-filter-condition-operator-".concat(n)),t.appendChild(r.getGui()),r}},{key:"getDefaultJoinOperator",value:function(e){return"AND"===e||"OR"===e?e:"AND"}},{key:"createFilterListOptions",value:function(){var e=this,t=this.optionsFactory.getFilterOptions();this.filterListOptions=t.map((function(t){return"string"===typeof t?e.createBoilerplateListOption(t):e.createCustomListOption(t)}))}},{key:"putOptionsIntoDropdown",value:function(e){this.filterListOptions.forEach((function(t){e.addOption(t)})),e.setDisabled(this.filterListOptions.length<=1)}},{key:"createBoilerplateListOption",value:function(e){return{value:e,text:this.translate(e)}}},{key:"createCustomListOption",value:function(e){var t=e.displayKey,n=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:n?this.localeService.getLocaleTextFunc()(n.displayKey,n.displayName):this.translate(t)}}},{key:"isAllowTwoConditions",value:function(){return this.maxNumConditions>=2}},{key:"createBodyTemplate",value:function(){return""}},{key:"getCssIdentifier",value:function(){return"simple-filter"}},{key:"updateUiVisibility",value:function(){var e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}},{key:"updateNumConditions",value:function(){for(var e,t=-1,n=!0,r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)?t=r:n=!1;if(this.shouldAddNewConditionAtEnd(n))this.createJoinOperatorPanel(),this.createOption();else{var i=null!==(e=this.lastUiCompletePosition)&&void 0!==e?e:this.getNumConditions()-2;if(t<i){this.removeConditionsAndOperators(i+1);var o=t+1,a=i-o;a>0&&this.removeConditionsAndOperators(o,a),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=t}},{key:"updateConditionStatusesAndValues",value:function(e,t){var n=this;this.eTypes.forEach((function(t,r){var i=n.isConditionDisabled(r,e);t.setDisabled(i||n.filterListOptions.length<=1),1===r&&(Kw(n.eJoinOperatorPanels[0],i),n.eJoinOperatorsAnd[0].setDisabled(i),n.eJoinOperatorsOr[0].setDisabled(i))})),this.eConditionBodies.forEach((function(e,t){zw(e,n.isConditionBodyVisible(t))}));var r="OR"===(null!==t&&void 0!==t?t:this.getJoinOperator());this.eJoinOperatorsAnd.forEach((function(e,t){e.setValue(!r,!0)})),this.eJoinOperatorsOr.forEach((function(e,t){e.setValue(r,!0)})),this.forEachInput((function(t,r,i,o){n.setElementDisplayed(t,r<o),n.setElementDisabled(t,n.isConditionDisabled(i,e))})),this.resetPlaceholder()}},{key:"shouldAddNewConditionAtEnd",value:function(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}},{key:"removeConditionsAndOperators",value:function(e,t){if(!(e>=this.getNumConditions())){this.removeComponents(this.eTypes,e,t),this.removeElements(this.eConditionBodies,e,t),this.removeValueElements(e,t);var n=Math.max(e-1,0);this.removeElements(this.eJoinOperatorPanels,n,t),this.removeComponents(this.eJoinOperatorsAnd,n,t),this.removeComponents(this.eJoinOperatorsOr,n,t)}}},{key:"removeElements",value:function(e,t,n){this.removeItems(e,t,n).forEach((function(e){return ib(e)}))}},{key:"removeComponents",value:function(e,t,n){var r=this;this.removeItems(e,t,n).forEach((function(e){ib(e.getGui()),r.destroyBean(e)}))}},{key:"removeItems",value:function(e,t,n){return null==n?e.splice(t):e.splice(t,n)}},{key:"afterGuiAttached",value:function(e){if(cg(D(n.prototype),"afterGuiAttached",this).call(this,e),this.resetPlaceholder(),!e||!e.suppressFocus&&!this.isReadOnly()){var t=this.getInputs(0)[0];if(!t)return;t instanceof EC&&t.getInputElement().focus()}}},{key:"afterGuiDetached",value:function(){cg(D(n.prototype),"afterGuiDetached",this).call(this);var e=this.getModel();this.areModelsEqual(e,this.getModelFromUi())&&!this.hasInvalidInputs()||this.resetUiToActiveModel(e);for(var t=-1,r=-1,i=!1,o=this.getJoinOperator(),a=this.getNumConditions()-1;a>=0;a--)if(this.isConditionUiComplete(a))-1===t&&(t=a,r=a);else{var s=a<t;(a>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(a-1)||s)&&(this.removeConditionsAndOperators(a,1),i=!0,s&&r--)}var l=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),l=!0),this.shouldAddNewConditionAtEnd(r===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),l=!0),l&&this.updateConditionStatusesAndValues(r,o),i&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=r}},{key:"getPlaceholderText",value:function(e,t){var n=this.translate(e);if(Gg(this.filterPlaceholder)){var r=this.filterPlaceholder,i=this.eTypes[t].getValue();n=r({filterOptionKey:i,filterOption:this.translate(i),placeholder:n})}else"string"===typeof this.filterPlaceholder&&(n=this.filterPlaceholder);return n}},{key:"resetPlaceholder",value:function(){var e=this,t=this.localeService.getLocaleTextFunc();this.forEachInput((function(n,r,i,o){if(n instanceof EC){var a=0===r&&o>1?"inRangeStart":0===r?"filterOoo":"inRangeEnd",s=0===r&&o>1?t("ariaFilterFromValue","Filter from value"):0===r?t("ariaFilterValue","Filter Value"):t("ariaFilterToValue","Filter to Value");n.setInputPlaceholder(e.getPlaceholderText(a,i)),n.setInputAriaLabel(s)}}))}},{key:"setElementValue",value:function(e,t){e instanceof EC&&e.setValue(null!=t?String(t):null,!0)}},{key:"setElementDisplayed",value:function(e,t){e instanceof Zb&&zw(e.getGui(),t)}},{key:"setElementDisabled",value:function(e,t){e instanceof Zb&&Kw(e.getGui(),t)}},{key:"attachElementOnChange",value:function(e,t){e instanceof EC&&e.onValueChange(t)}},{key:"forEachInput",value:function(e){var t=this;this.getConditionTypes().forEach((function(n,r){t.forEachPositionTypeInput(r,n,e)}))}},{key:"forEachPositionInput",value:function(e,t){var n=this.getConditionType(e);this.forEachPositionTypeInput(e,n,t)}},{key:"forEachPositionTypeInput",value:function(e,t,n){for(var r=this.getNumberOfInputs(t),i=this.getInputs(e),o=0;o<i.length;o++){var a=i[o];null!=a&&n(a,o,e,r)}}},{key:"isConditionDisabled",value:function(e,t){return!!this.isReadOnly()||0!==e&&e>t+1}},{key:"isConditionBodyVisible",value:function(e){var t=this.getConditionType(e);return this.getNumberOfInputs(t)>0}},{key:"isConditionUiComplete",value:function(e){return!(e>=this.getNumConditions())&&(this.getConditionType(e)!==n.EMPTY&&!this.getValues(e).some((function(e){return null==e})))}},{key:"getNumConditions",value:function(){return this.eTypes.length}},{key:"getUiCompleteConditions",value:function(){for(var e=[],t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}},{key:"createMissingConditionsAndOperators",value:function(){if(!this.isReadOnly())for(var e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}},{key:"resetUiToDefaults",value:function(e){var t=this;return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach((function(e){return t.resetType(e)})),this.eJoinOperatorsAnd.forEach((function(e,n){return t.resetJoinOperatorAnd(e,n,t.joinOperatorId+n)})),this.eJoinOperatorsOr.forEach((function(e,n){return t.resetJoinOperatorOr(e,n,t.joinOperatorId+n)})),this.joinOperatorId++,this.forEachInput((function(e){return t.resetInput(e)})),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),Ub.resolve()}},{key:"resetType",value:function(e){var t=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(t).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}},{key:"resetJoinOperatorAnd",value:function(e,t,n){this.resetJoinOperator(e,t,this.isDefaultOperator("AND"),this.translate("andCondition"),n)}},{key:"resetJoinOperatorOr",value:function(e,t,n){this.resetJoinOperator(e,t,this.isDefaultOperator("OR"),this.translate("orCondition"),n)}},{key:"resetJoinOperator",value:function(e,t,n,r,i){this.updateJoinOperatorDisabled(e.setValue(n,!0).setName("ag-simple-filter-and-or-".concat(this.getCompId(),"-").concat(i)).setLabel(r),t)}},{key:"updateJoinOperatorsDisabled",value:function(){var e=this;this.eJoinOperatorsAnd.forEach((function(t,n){return e.updateJoinOperatorDisabled(t,n)})),this.eJoinOperatorsOr.forEach((function(t,n){return e.updateJoinOperatorDisabled(t,n)}))}},{key:"updateJoinOperatorDisabled",value:function(e,t){e.setDisabled(this.isReadOnly()||t>0)}},{key:"resetInput",value:function(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}},{key:"setConditionIntoUi",value:function(e,t){var n=this,r=this.mapValuesFromModel(e);this.forEachInput((function(e,i,o,a){o===t&&n.setElementValue(e,null!=r[i]?r[i]:null)}))}},{key:"setValueFromFloatingFilter",value:function(e){var t=this;this.forEachInput((function(n,r,i,o){t.setElementValue(n,0===r&&0===i?e:null)}))}},{key:"isDefaultOperator",value:function(e){return e===this.defaultJoinOperator}},{key:"addChangedListeners",value:function(e,t){var n=this;this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,(function(e){n.attachElementOnChange(e,n.listener)})))}},{key:"individualConditionPasses",value:function(e,t){var n=this.getCellValue(e.node),r=this.mapValuesFromModel(t),i=this.optionsFactory.getCustomOption(t.type),o=this.evaluateCustomFilter(i,r,n);return null!=o?o:null==n?this.evaluateNullValue(t.type):this.evaluateNonNullValue(r,n,t,e)}},{key:"evaluateCustomFilter",value:function(e,t,n){if(null!=e){var r=e.predicate;return null==r||t.some((function(e){return null==e}))?void 0:r(t,n)}}},{key:"isBlank",value:function(e){return null==e||"string"===typeof e&&0===e.trim().length}},{key:"hasInvalidInputs",value:function(){return!1}}]),n}(hC);RC.EMPTY="empty",RC.BLANK="blank",RC.NOT_BLANK="notBlank",RC.EQUALS="equals",RC.NOT_EQUAL="notEqual",RC.LESS_THAN="lessThan",RC.LESS_THAN_OR_EQUAL="lessThanOrEqual",RC.GREATER_THAN="greaterThan",RC.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",RC.IN_RANGE="inRange",RC.CONTAINS="contains",RC.NOT_CONTAINS="notContains",RC.STARTS_WITH="startsWith",RC.ENDS_WITH="endsWith";var AC=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"setParams",value:function(e){cg(D(n.prototype),"setParams",this).call(this,e),this.scalarFilterParams=e}},{key:"evaluateNullValue",value:function(e){switch(e){case n.EQUALS:case n.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case n.GREATER_THAN:case n.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case n.LESS_THAN:case n.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case n.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case n.BLANK:return!0;case n.NOT_BLANK:return!1}return!1}},{key:"evaluateNonNullValue",value:function(e,t,r){var i=this.comparator(),o=null!=e[0]?i(e[0],t):0;switch(r.type){case n.EQUALS:return 0===o;case n.NOT_EQUAL:return 0!==o;case n.GREATER_THAN:return o>0;case n.GREATER_THAN_OR_EQUAL:return o>=0;case n.LESS_THAN:return o<0;case n.LESS_THAN_OR_EQUAL:return o<=0;case n.IN_RANGE:var a=i(e[1],t);return this.scalarFilterParams.inRangeInclusive?o>=0&&a<=0:o>0&&a<0;case n.BLANK:return this.isBlank(t);case n.NOT_BLANK:return!this.isBlank(t);default:return console.warn('AG Grid: Unexpected type of filter "'+r.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}}]),n}(RC),_C=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},OC=1/0,DC=function(e){O(n,e);var t=F(n);function n(e,r,i){var o;return T(this,n),(o=t.call(this,r,i)).dateFilterParams=e,o}return A(n,[{key:"conditionToString",value:function(e,t){var n=e.type,r=(t||{}).numberOfInputs,i=n==RC.IN_RANGE||2===r,o=Gw(e.dateFrom),a=Gw(e.dateTo),s=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(i){var l=null!==o?Mw(o,s):"null",u=null!==a?Mw(a,s):"null";return"".concat(l,"-").concat(u)}return null!=o?Mw(o,s):"".concat(n)}}]),n}(TC),NC=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.call(this,"dateFilter")).eConditionPanelsFrom=[],e.eConditionPanelsTo=[],e.dateConditionFromComps=[],e.dateConditionToComps=[],e.minValidYear=1e3,e.maxValidYear=OC,e}return A(n,[{key:"afterGuiAttached",value:function(e){cg(D(n.prototype),"afterGuiAttached",this).call(this,e),this.dateConditionFromComps[0].afterGuiAttached(e)}},{key:"mapValuesFromModel",value:function(e){var t=e||{},n=t.dateFrom,r=t.dateTo,i=t.type;return[n&&Gw(n)||null,r&&Gw(r)||null].slice(0,this.getNumberOfInputs(i))}},{key:"comparator",value:function(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}},{key:"defaultComparator",value:function(e,t){return null==t||t<e?-1:t>e?1:0}},{key:"setParams",value:function(e){this.dateFilterParams=e,cg(D(n.prototype),"setParams",this).call(this,e);var t=function(t,n){if(null!=e[t]){if(!isNaN(e[t]))return null==e[t]?n:Number(e[t]);console.warn("AG Grid: DateFilter ".concat(t," is not a number"))}return n};this.minValidYear=t("minValidYear",1e3),this.maxValidYear=t("maxValidYear",OC),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),this.filterModelFormatter=new DC(this.dateFilterParams,this.localeService,this.optionsFactory)}},{key:"createDateCompWrapper",value:function(e){var t=this,n=new nC(this.getContext(),this.userComponentFactory,{onDateChanged:function(){return t.onUiChanged()},filterParams:this.dateFilterParams},e);return this.addDestroyFunc((function(){return n.destroy()})),n}},{key:"setElementValue",value:function(e,t){e.setDate(t)}},{key:"setElementDisplayed",value:function(e,t){e.setDisplayed(t)}},{key:"setElementDisabled",value:function(e,t){e.setDisabled(t)}},{key:"getDefaultFilterOptions",value:function(){return n.DEFAULT_FILTER_OPTIONS}},{key:"createValueElement",value:function(){var e=document.createElement("div");return e.classList.add("ag-filter-body"),this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}},{key:"createFromToElement",value:function(e,t,n,r){var i=document.createElement("div");i.classList.add("ag-filter-".concat(r)),i.classList.add("ag-filter-date-".concat(r)),t.push(i),e.appendChild(i),n.push(this.createDateCompWrapper(i))}},{key:"removeValueElements",value:function(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),this.removeItems(this.eConditionPanelsFrom,e,t),this.removeItems(this.eConditionPanelsTo,e,t)}},{key:"removeDateComps",value:function(e,t,n){this.removeItems(e,t,n).forEach((function(e){return e.destroy()}))}},{key:"isConditionUiComplete",value:function(e){var t=this;if(!cg(D(n.prototype),"isConditionUiComplete",this).call(this,e))return!1;var r=!0;return this.forEachInput((function(n,i,o,a){o!==e||!r||i>=a||(r=r&&function(e){return null!=e&&e.getUTCFullYear()>=t.minValidYear&&e.getUTCFullYear()<=t.maxValidYear}(n.getDate()))})),r}},{key:"areSimpleModelsEqual",value:function(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}},{key:"getFilterType",value:function(){return"date"}},{key:"createCondition",value:function(e){var t=this.getConditionType(e),n={},r=this.getValues(e);return r.length>0&&(n.dateFrom=Iw(r[0])),r.length>1&&(n.dateTo=Iw(r[1])),Object.assign({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:t},n)}},{key:"resetPlaceholder",value:function(){var e=this.localeService.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),n=e("ariaFilterValue","Filter Value");this.forEachInput((function(e){e.setInputPlaceholder(t),e.setInputAriaLabel(n)}))}},{key:"getInputs",value:function(e){return e>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[e],this.dateConditionToComps[e]]}},{key:"getValues",value:function(e){var t=[];return this.forEachPositionInput(e,(function(e,n,r,i){n<i&&t.push(e.getDate())})),t}},{key:"getModelAsString",value:function(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""}}]),n}(AC);NC.DEFAULT_FILTER_OPTIONS=[AC.EQUALS,AC.GREATER_THAN,AC.LESS_THAN,AC.NOT_EQUAL,AC.IN_RANGE,AC.BLANK,AC.NOT_BLANK],_C([nm("userComponentFactory")],NC.prototype,"userComponentFactory",void 0);var PC=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"getDefaultDebounceMs",value:function(){return 0}},{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this)}},{key:"isEventFromFloatingFilter",value:function(e){return e&&e.afterFloatingFilter}},{key:"isEventFromDataChange",value:function(e){return null===e||void 0===e?void 0:e.afterDataChange}},{key:"getLastType",value:function(){return this.lastType}},{key:"isReadOnly",value:function(){return this.readOnly}},{key:"setLastTypeFromModel",value:function(e){if(e){var t;if(e.operator)t=e.conditions[0];else t=e;this.lastType=t.type}else this.lastType=this.optionsFactory.getDefaultOption()}},{key:"canWeEditAfterModelFromParentFilter",value:function(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;var t=e;return this.isTypeEditable(t.type)}},{key:"init",value:function(e){this.optionsFactory=new rC,this.optionsFactory.init(e.filterParams,this.getDefaultFilterOptions()),this.lastType=this.optionsFactory.getDefaultOption(),this.readOnly=!!e.filterParams.readOnly;var t=this.isTypeEditable(this.lastType);this.setEditable(t)}},{key:"doesFilterHaveSingleInput",value:function(e){var t=(this.optionsFactory.getCustomOption(e)||{}).numberOfInputs;return null==t||1==t}},{key:"isTypeEditable",value:function(e){var t=[RC.IN_RANGE,RC.EMPTY,RC.BLANK,RC.NOT_BLANK];return!!e&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(e)&&t.indexOf(e)<0}}]),n}(Zb),FC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},IC=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>\n                <div ref="eDateWrapper" style="display: flex;"></div>\n            </div>')}return A(n,[{key:"getDefaultFilterOptions",value:function(){return NC.DEFAULT_FILTER_OPTIONS}},{key:"init",value:function(e){cg(D(n.prototype),"init",this).call(this,e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent();var t=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input")),this.filterModelFormatter=new DC(this.filterParams,this.localeService,this.optionsFactory)}},{key:"setEditable",value:function(e){zw(this.eDateWrapper,e),zw(this.eReadOnlyText.getGui(),!e)}},{key:"onParentModelChanged",value:function(e,t){if(!this.isEventFromFloatingFilter(t)&&!this.isEventFromDataChange(t)){cg(D(n.prototype),"setLastTypeFromModel",this).call(this,e);var r=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(r),r){if(e){var i=e;this.dateComp.setDate(Gw(i.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}}},{key:"onDateChanged",value:function(){var e=this,t=Iw(this.dateComp.getDate());this.params.parentFilterInstance((function(n){if(n){var r=Gw(t);n.onFloatingFilterChanged(e.getLastType()||null,r)}}))}},{key:"createDateComponent",value:function(){var e=this,t=hC.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),n={onDateChanged:zg(this.onDateChanged.bind(this),t),filterParams:this.params.column.getColDef().filterParams};this.dateComp=new nC(this.getContext(),this.userComponentFactory,n,this.eDateWrapper),this.addDestroyFunc((function(){return e.dateComp.destroy()}))}},{key:"getFilterModelFormatter",value:function(){return this.filterModelFormatter}}]),n}(PC);FC([nm("userComponentFactory")],IC.prototype,"userComponentFactory",void 0),FC([Jb("eReadOnlyText")],IC.prototype,"eReadOnlyText",void 0),FC([Jb("eDateWrapper")],IC.prototype,"eDateWrapper",void 0);var LC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},MC=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,'\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>\n            </div>')}return A(n,[{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this)}},{key:"init",value:function(e){var t=this,n=this.gridOptionsService.getDocument(),r=this.eDateInput.getInputElement(),i=this.shouldUseBrowserDatePicker(e);i&&(r.type="date");var o=i&&gw();this.addManagedListener(r,"mousedown",(function(){t.eDateInput.isDisabled()||o||r.focus()})),this.addManagedListener(r,"input",(function(r){r.target===n.activeElement&&(t.eDateInput.isDisabled()||e.onDateChanged())}));var a=e.filterParams||{},s=a.minValidYear,l=a.maxValidYear;s&&(r.min="".concat(s,"-01-01")),l&&(r.max="".concat(l,"-12-31"))}},{key:"getDate",value:function(){return Gw(this.eDateInput.getValue())}},{key:"setDate",value:function(e){this.eDateInput.setValue(Iw(e,!1))}},{key:"setInputPlaceholder",value:function(e){this.eDateInput.setInputPlaceholder(e)}},{key:"setDisabled",value:function(e){this.eDateInput.setDisabled(e)}},{key:"afterGuiAttached",value:function(e){e&&e.suppressFocus||this.eDateInput.getInputElement().focus()}},{key:"shouldUseBrowserDatePicker",value:function(e){return e.filterParams&&null!=e.filterParams.browserDatePicker?e.filterParams.browserDatePicker:yw()||ww()||gw()&&mw()>=14.1}}]),n}(Zb);LC([Jb("eDateInput")],MC.prototype,"eDateInput",void 0);var GC=function(e){O(n,e);var t=F(n);function n(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ag-text-field",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text";return T(this,n),t.call(this,e,r,i)}return A(n,[{key:"postConstruct",value:function(){cg(D(n.prototype),"postConstruct",this).call(this),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}},{key:"setValue",value:function(e,t){var r=cg(D(n.prototype),"setValue",this).call(this,e,t);return this.eInput.value!==e&&(this.eInput.value=fg(e)?e:""),r}},{key:"setStartValue",value:function(e){this.setValue(e,!0)}},{key:"preventDisallowedCharacters",value:function(){var e=new RegExp("[".concat(this.config.allowedCharPattern,"]"));this.addManagedListener(this.eInput,"keydown",(function(t){Ob(t)&&t.key&&!e.test(t.key)&&t.preventDefault()})),this.addManagedListener(this.eInput,"paste",(function(t){var n,r=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text");r&&r.split("").some((function(t){return!e.test(t)}))&&t.preventDefault()}))}}]),n}(EC),BC=function(e){O(n,e);var t=F(n);function n(e){return T(this,n),t.call(this,e,"ag-number-field","number")}return A(n,[{key:"postConstruct",value:function(){var e=this;cg(D(n.prototype),"postConstruct",this).call(this),this.addManagedListener(this.eInput,"blur",(function(){var t=parseFloat(e.eInput.value),n=isNaN(t)?"":e.normalizeValue(t.toString());e.value!==n&&e.setValue(n)})),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this)),this.eInput.step="any"}},{key:"onWheel",value:function(e){document.activeElement===this.eInput&&e.preventDefault()}},{key:"normalizeValue",value:function(e){if(""===e)return"";null!=this.precision&&(e=this.adjustPrecision(e));var t=parseFloat(e);return null!=this.min&&t<this.min?e=this.min.toString():null!=this.max&&t>this.max&&(e=this.max.toString()),e}},{key:"adjustPrecision",value:function(e,t){if(null==this.precision)return e;if(t){var n=parseFloat(e).toFixed(this.precision);return parseFloat(n).toString()}var r=String(e).split(".");if(r.length>1){if(r[1].length<=this.precision)return e;if(this.precision>0)return"".concat(r[0],".").concat(r[1].slice(0,this.precision))}return r[0]}},{key:"setMin",value:function(e){return this.min===e||(this.min=e,Sb(this.eInput,"min",e)),this}},{key:"setMax",value:function(e){return this.max===e||(this.max=e,Sb(this.eInput,"max",e)),this}},{key:"setPrecision",value:function(e){return this.precision=e,this}},{key:"setStep",value:function(e){return this.step===e||(this.step=e,Sb(this.eInput,"step",e)),this}},{key:"setValue",value:function(e,t){var r=this;return this.setValueOrInputValue((function(e){return cg(D(n.prototype),"setValue",r).call(r,e,t)}),(function(){return r}),e)}},{key:"setStartValue",value:function(e){var t=this;return this.setValueOrInputValue((function(e){return cg(D(n.prototype),"setValue",t).call(t,e,!0)}),(function(e){t.eInput.value=e}),e)}},{key:"setValueOrInputValue",value:function(e,t,n){if(fg(n)){var r=this.isScientificNotation(n);if(r&&this.eInput.validity.valid)return e(n);if(!r)r=(n=this.adjustPrecision(n))!=this.normalizeValue(n);if(r)return t(n)}return e(n)}},{key:"getValue",value:function(){if(this.eInput.validity.valid){var e=this.eInput.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):cg(D(n.prototype),"getValue",this).call(this)}}},{key:"isScientificNotation",value:function(e){return"string"===typeof e&&e.includes("e")}}]),n}(GC),jC=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"conditionToString",value:function(e,t){var n=(t||{}).numberOfInputs;return e.type==RC.IN_RANGE||2===n?"".concat(e.filter,"-").concat(e.filterTo):null!=e.filter?"".concat(e.filter):"".concat(e.type)}}]),n}(TC);function HC(e){var t=(null!==e&&void 0!==e?e:{}).allowedCharPattern;return null!==t&&void 0!==t?t:null}var VC=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.call(this,"numberFilter")).eValuesFrom=[],e.eValuesTo=[],e}return A(n,[{key:"mapValuesFromModel",value:function(e){var t=e||{},n=t.filter,r=t.filterTo,i=t.type;return[this.processValue(n),this.processValue(r)].slice(0,this.getNumberOfInputs(i))}},{key:"getDefaultDebounceMs",value:function(){return 500}},{key:"comparator",value:function(){return function(e,t){return e===t?0:e<t?1:-1}}},{key:"setParams",value:function(e){this.numberFilterParams=e,cg(D(n.prototype),"setParams",this).call(this,e),this.filterModelFormatter=new jC(this.localeService,this.optionsFactory)}},{key:"getDefaultFilterOptions",value:function(){return n.DEFAULT_FILTER_OPTIONS}},{key:"createValueElement",value:function(){var e=HC(this.numberFilterParams),t=document.createElement("div");return t.classList.add("ag-filter-body"),Fy(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}},{key:"createFromToElement",value:function(e,t,n,r){var i=this.createManagedBean(r?new GC({allowedCharPattern:r}):new BC);i.addCssClass("ag-filter-".concat(n)),i.addCssClass("ag-filter-filter"),t.push(i),e.appendChild(i.getGui())}},{key:"removeValueElements",value:function(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}},{key:"getValues",value:function(e){var t=this,n=[];return this.forEachPositionInput(e,(function(e,r,i,o){r<o&&n.push(t.processValue(t.stringToFloat(e.getValue())))})),n}},{key:"areSimpleModelsEqual",value:function(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}},{key:"getFilterType",value:function(){return"number"}},{key:"processValue",value:function(e){return null==e||isNaN(e)?null:e}},{key:"stringToFloat",value:function(e){if("number"===typeof e)return e;var t=hg(e);return null!=t&&""===t.trim()&&(t=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(t):null==t||"-"===t.trim()?null:parseFloat(t)}},{key:"createCondition",value:function(e){var t=this.getConditionType(e),n={filterType:this.getFilterType(),type:t},r=this.getValues(e);return r.length>0&&(n.filter=r[0]),r.length>1&&(n.filterTo=r[1]),n}},{key:"getInputs",value:function(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}},{key:"getModelAsString",value:function(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""}},{key:"hasInvalidInputs",value:function(){var e=!1;return this.forEachInput((function(t){t.getInputElement().validity.valid||(e=!0)})),e}}]),n}(AC);VC.DEFAULT_FILTER_OPTIONS=[AC.EQUALS,AC.NOT_EQUAL,AC.LESS_THAN,AC.LESS_THAN_OR_EQUAL,AC.GREATER_THAN,AC.GREATER_THAN_OR_EQUAL,AC.IN_RANGE,AC.BLANK,AC.NOT_BLANK];var WC=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"conditionToString",value:function(e,t){var n=(t||{}).numberOfInputs;return e.type==RC.IN_RANGE||2===n?"".concat(e.filter,"-").concat(e.filterTo):null!=e.filter?"".concat(e.filter):"".concat(e.type)}}]),n}(TC),zC=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.call(this,"textFilter")).eValuesFrom=[],e.eValuesTo=[],e}return A(n,[{key:"getDefaultDebounceMs",value:function(){return 500}},{key:"setParams",value:function(e){this.textFilterParams=e,cg(D(n.prototype),"setParams",this).call(this,e),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?n.DEFAULT_FORMATTER:n.DEFAULT_LOWERCASE_FORMATTER),this.filterModelFormatter=new WC(this.localeService,this.optionsFactory)}},{key:"getTextMatcher",value:function(){var e=this.textFilterParams.textCustomComparator;return e?(Vb.doOnce((function(){return console.warn("AG Grid - textCustomComparator is deprecated, use textMatcher instead.")}),"textCustomComparator.deprecated"),function(t){var n=t.filterOption,r=t.value,i=t.filterText;return e(n,r,i)}):this.textFilterParams.textMatcher||n.DEFAULT_MATCHER}},{key:"createCondition",value:function(e){var t=this.getConditionType(e),n={filterType:this.getFilterType(),type:t},r=this.getValues(e);return r.length>0&&(n.filter=r[0]),r.length>1&&(n.filterTo=r[1]),n}},{key:"getFilterType",value:function(){return"text"}},{key:"areSimpleModelsEqual",value:function(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}},{key:"getInputs",value:function(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}},{key:"getValues",value:function(e){var t=this,r=[];return this.forEachPositionInput(e,(function(e,i,o,a){if(i<a){var s=hg(e.getValue()),l=(t.textFilterParams.trimInput?n.trimInput(s):s)||null;r.push(l),e.setValue(l,!0)}})),r}},{key:"getDefaultFilterOptions",value:function(){return n.DEFAULT_FILTER_OPTIONS}},{key:"createValueElement",value:function(){var e=document.createElement("div");return e.classList.add("ag-filter-body"),Fy(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e}},{key:"createFromToElement",value:function(e,t,n){var r=this.createManagedBean(new GC);r.addCssClass("ag-filter-".concat(n)),r.addCssClass("ag-filter-filter"),t.push(r),e.appendChild(r.getGui())}},{key:"removeValueElements",value:function(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}},{key:"mapValuesFromModel",value:function(e){var t=e||{},n=t.filter,r=t.filterTo,i=t.type;return[n||null,r||null].slice(0,this.getNumberOfInputs(i))}},{key:"evaluateNullValue",value:function(e){var t=[RC.NOT_EQUAL,RC.NOT_CONTAINS,RC.BLANK];return!!e&&t.indexOf(e)>=0}},{key:"evaluateNonNullValue",value:function(e,t,n,r){var i=this,o=e.map((function(e){return i.formatter(e)}))||[],a=this.formatter(t),s=this.textFilterParams,l=s.api,u=s.colDef,c=s.column,d=s.columnApi,h=s.context,f=s.textFormatter;if(n.type===RC.BLANK)return this.isBlank(t);if(n.type===RC.NOT_BLANK)return!this.isBlank(t);var p={api:l,colDef:u,column:c,columnApi:d,context:h,node:r.node,data:r.data,filterOption:n.type,value:a,textFormatter:f};return o.some((function(e){return i.matcher(Object.assign(Object.assign({},p),{filterText:e}))}))}},{key:"getModelAsString",value:function(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""}}],[{key:"trimInput",value:function(e){var t=e&&e.trim();return""===t?e:t}}]),n}(RC);zC.DEFAULT_FILTER_OPTIONS=[RC.CONTAINS,RC.NOT_CONTAINS,RC.EQUALS,RC.NOT_EQUAL,RC.STARTS_WITH,RC.ENDS_WITH,RC.BLANK,RC.NOT_BLANK],zC.DEFAULT_FORMATTER=function(e){return e},zC.DEFAULT_LOWERCASE_FORMATTER=function(e){return null==e?null:e.toString().toLowerCase()},zC.DEFAULT_MATCHER=function(e){var t=e.filterOption,n=e.value,r=e.filterText;if(null==r)return!1;switch(t){case zC.CONTAINS:return n.indexOf(r)>=0;case zC.NOT_CONTAINS:return n.indexOf(r)<0;case zC.EQUALS:return n===r;case zC.NOT_EQUAL:return n!=r;case zC.STARTS_WITH:return 0===n.indexOf(r);case zC.ENDS_WITH:var i=n.lastIndexOf(r);return i>=0&&i===n.length-r.length;default:return!1}};var UC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},KC=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).params=e,r}return A(n,[{key:"setupGui",value:function(e){this.eFloatingFilterTextInput=this.createManagedBean(new GC(this.params.config)),this.eFloatingFilterTextInput.setInputAriaLabel(this.params.ariaLabel),e.appendChild(this.eFloatingFilterTextInput.getGui())}},{key:"setEditable",value:function(e){this.eFloatingFilterTextInput.setDisabled(!e)}},{key:"getValue",value:function(){return this.eFloatingFilterTextInput.getValue()}},{key:"setValue",value:function(e,t){this.eFloatingFilterTextInput.setValue(e,t)}},{key:"addValueChangedListener",value:function(e){var t=this.eFloatingFilterTextInput.getGui();this.addManagedListener(t,"input",e),this.addManagedListener(t,"keydown",e)}}]),n}(Vm),qC=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"postConstruct",value:function(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>\n        ')}},{key:"getDefaultDebounceMs",value:function(){return 500}},{key:"onParentModelChanged",value:function(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(e)))}},{key:"init",value:function(e){this.params=e;var t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),r=this.localeService.getLocaleTextFunc(),i="".concat(t," ").concat(r("ariaFilterInput","Filter Input"));if(this.floatingFilterInputService=this.createFloatingFilterInputService(i),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer),cg(D(n.prototype),"init",this).call(this,e),this.applyActive=hC.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){var o=hC.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),a=zg(this.syncUpWithParentFilter.bind(this),o);this.floatingFilterInputService.addValueChangedListener(a)}}},{key:"syncUpWithParentFilter",value:function(e){var t=this,n=e.key===_b.ENTER;if(!this.applyActive||n){var r=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(r=zC.trimInput(r),this.floatingFilterInputService.setValue(r,!0)),this.params.parentFilterInstance((function(e){e&&e.onFloatingFilterChanged(t.getLastType()||null,r||null)}))}}},{key:"setEditable",value:function(e){this.floatingFilterInputService.setEditable(e)}}]),n}(PC);UC([nm("columnModel")],qC.prototype,"columnModel",void 0),UC([Jb("eFloatingFilterInputContainer")],qC.prototype,"eFloatingFilterInputContainer",void 0),UC([$g],qC.prototype,"postConstruct",null);var XC=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).params=e,r.numberInputActive=!0,r}return A(n,[{key:"setupGui",value:function(e){this.eFloatingFilterNumberInput=this.createManagedBean(new BC),this.eFloatingFilterTextInput=this.createManagedBean(new GC),this.eFloatingFilterTextInput.setDisabled(!0),this.eFloatingFilterNumberInput.setInputAriaLabel(this.params.ariaLabel),this.eFloatingFilterTextInput.setInputAriaLabel(this.params.ariaLabel),e.appendChild(this.eFloatingFilterNumberInput.getGui()),e.appendChild(this.eFloatingFilterTextInput.getGui())}},{key:"setEditable",value:function(e){this.numberInputActive=e,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}},{key:"getValue",value:function(){return this.getActiveInputElement().getValue()}},{key:"setValue",value:function(e,t){this.getActiveInputElement().setValue(e,t)}},{key:"getActiveInputElement",value:function(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}},{key:"addValueChangedListener",value:function(e){this.setupListeners(this.eFloatingFilterNumberInput.getGui(),e),this.setupListeners(this.eFloatingFilterTextInput.getGui(),e)}},{key:"setupListeners",value:function(e,t){this.addManagedListener(e,"input",t),this.addManagedListener(e,"keydown",t)}}]),n}(Vm),YC=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"init",value:function(e){cg(D(n.prototype),"init",this).call(this,e),this.filterModelFormatter=new jC(this.localeService,this.optionsFactory)}},{key:"getDefaultFilterOptions",value:function(){return VC.DEFAULT_FILTER_OPTIONS}},{key:"getFilterModelFormatter",value:function(){return this.filterModelFormatter}},{key:"createFloatingFilterInputService",value:function(e){var t=HC(this.params.filterParams);return t?this.createManagedBean(new KC({config:{allowedCharPattern:t},ariaLabel:e})):this.createManagedBean(new XC({ariaLabel:e}))}}]),n}(qC),QC=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"init",value:function(e){cg(D(n.prototype),"init",this).call(this,e),this.filterModelFormatter=new WC(this.localeService,this.optionsFactory)}},{key:"getDefaultFilterOptions",value:function(){return zC.DEFAULT_FILTER_OPTIONS}},{key:"getFilterModelFormatter",value:function(){return this.filterModelFormatter}},{key:"createFloatingFilterInputService",value:function(e){return this.createManagedBean(new KC({ariaLabel:e}))}}]),n}(qC),ZC=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];T(this,e),this.destroyFuncs=[],this.touching=!1,this.eventService=new um,this.eElement=t,this.preventMouseClick=r;var i=this.onTouchStart.bind(this),o=this.onTouchMove.bind(this),a=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",i,{passive:!0}),this.eElement.addEventListener("touchmove",o,{passive:!0}),this.eElement.addEventListener("touchend",a,{passive:!1}),this.destroyFuncs.push((function(){n.eElement.removeEventListener("touchstart",i,{passive:!0}),n.eElement.removeEventListener("touchmove",o,{passive:!0}),n.eElement.removeEventListener("touchend",a,{passive:!1})}))}return A(e,[{key:"getActiveTouch",value:function(e){for(var t=0;t<e.length;t++){if(e[t].identifier===this.touchStart.identifier)return e[t]}return null}},{key:"addEventListener",value:function(e,t){this.eventService.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){this.eventService.removeEventListener(e,t)}},{key:"onTouchStart",value:function(t){var n=this;if(!this.touching){this.touchStart=t.touches[0],this.touching=!0,this.moved=!1;var r=this.touchStart;window.setTimeout((function(){var i=n.touchStart===r;if(n.touching&&i&&!n.moved){n.moved=!0;var o={type:e.EVENT_LONG_TAP,touchStart:n.touchStart,touchEvent:t};n.eventService.dispatchEvent(o)}}),500)}}},{key:"onTouchMove",value:function(e){if(this.touching){var t=this.getActiveTouch(e.touches);if(t)!Lb(t,this.touchStart,4)&&(this.moved=!0)}}},{key:"onTouchEnd",value:function(t){if(this.touching){if(!this.moved){var n={type:e.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(n),this.checkForDoubleTap()}this.preventMouseClick&&t.cancelable&&t.preventDefault(),this.touching=!1}}},{key:"checkForDoubleTap",value:function(){var t=(new Date).getTime();if(this.lastTapTime&&this.lastTapTime>0)if(t-this.lastTapTime>e.DOUBLE_TAP_MILLIS){var n={type:e.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(n),this.lastTapTime=null}else this.lastTapTime=t;else this.lastTapTime=t}},{key:"destroy",value:function(){this.destroyFuncs.forEach((function(e){return e()}))}}]),e}();ZC.EVENT_TAP="tap",ZC.EVENT_DOUBLE_TAP="doubleTap",ZC.EVENT_LONG_TAP="longTap",ZC.DOUBLE_TAP_MILLIS=500;var JC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},$C=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),r=t.call(this),e||r.setTemplate(n.TEMPLATE),r}return A(n,[{key:"attachCustomElements",value:function(e,t,n,r,i){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=n,this.eSortMixed=r,this.eSortNone=i}},{key:"setupSort",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.column=e,this.suppressOrder=n,this.setupMultiSortIndicator(),!!this.column.getColDef().sortable&&(this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e),this.addManagedListener(this.eventService,Ym.EVENT_SORT_CHANGED,(function(){return t.onSortChanged()})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return t.onSortChanged()})),this.onSortChanged())}},{key:"addInIcon",value:function(e,t,n){if(null!=t){var r=Rb(e,this.gridOptionsService,n);r&&t.appendChild(r)}}},{key:"onSortChanged",value:function(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}},{key:"updateIcons",value:function(){var e=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){var t="asc"===e;zw(this.eSortAsc,t,{skipAriaHidden:!0})}if(this.eSortDesc){var n="desc"===e;zw(this.eSortDesc,n,{skipAriaHidden:!0})}if(this.eSortNone){var r=!this.column.getColDef().unSortIcon&&!this.gridOptionsService.is("unSortIcon"),i=null===e||void 0===e;zw(this.eSortNone,!r&&i,{skipAriaHidden:!0})}}},{key:"setupMultiSortIndicator",value:function(){var e=this;this.addInIcon("sortUnSort",this.eSortMixed,this.column);var t=this.column.getColDef().showRowGroup;this.gridOptionsService.isColumnsSortingCoupledToGroup()&&t&&(this.addManagedListener(this.eventService,Ym.EVENT_SORT_CHANGED,(function(){return e.updateMultiSortIndicator()})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return e.updateMultiSortIndicator()})),this.updateMultiSortIndicator())}},{key:"updateMultiSortIndicator",value:function(){if(this.eSortMixed){var e="mixed"===this.sortController.getDisplaySortForColumn(this.column);zw(this.eSortMixed,e,{skipAriaHidden:!0})}}},{key:"updateSortOrder",value:function(){var e,t=this;if(this.eSortOrder){var n=this.sortController.getColumnsWithSortingOrdered(),r=null!==(e=this.sortController.getDisplaySortIndexForColumn(this.column))&&void 0!==e?e:-1,i=n.some((function(e){var n;return null!==(n=t.sortController.getDisplaySortIndexForColumn(e))&&void 0!==n&&n})),o=r>=0&&i;zw(this.eSortOrder,o,{skipAriaHidden:!0}),r>=0?this.eSortOrder.innerHTML=(r+1).toString():rb(this.eSortOrder)}}}]),n}(Zb);$C.TEMPLATE='<span class="ag-sort-indicator-container">\n            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>\n        </span>',JC([Jb("eSortOrder")],$C.prototype,"eSortOrder",void 0),JC([Jb("eSortAsc")],$C.prototype,"eSortAsc",void 0),JC([Jb("eSortDesc")],$C.prototype,"eSortDesc",void 0),JC([Jb("eSortMixed")],$C.prototype,"eSortMixed",void 0),JC([Jb("eSortNone")],$C.prototype,"eSortNone",void 0),JC([nm("columnModel")],$C.prototype,"columnModel",void 0),JC([nm("sortController")],$C.prototype,"sortController",void 0);var eS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},tS=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).lastMovingChanged=0,e}return A(n,[{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this)}},{key:"refresh",value:function(e){return this.params=e,this.workOutTemplate()==this.currentTemplate&&(this.workOutShowMenu()==this.currentShowMenu&&(this.workOutSort()==this.currentSort&&(this.setDisplayName(e),!0)))}},{key:"workOutTemplate",value:function(){var e=mm(this.params.template,n.TEMPLATE);return e=e&&e.trim?e.trim():e}},{key:"init",value:function(e){this.params=e,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setupIcons(e.column),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setDisplayName(e)}},{key:"setDisplayName",value:function(e){if(this.currentDisplayName!=e.displayName){this.currentDisplayName=e.displayName;var t=ry(this.currentDisplayName);this.eText&&(this.eText.innerHTML=t)}}},{key:"setupIcons",value:function(e){this.addInIcon("menu",this.eMenu,e),this.addInIcon("filter",this.eFilter,e)}},{key:"addInIcon",value:function(e,t,n){if(null!=t){var r=Rb(e,this.gridOptionsService,n);r&&t.appendChild(r)}}},{key:"setupTap",value:function(){var e=this,t=this.gridOptionsService;if(!t.is("suppressTouch")){var n=new ZC(this.getGui(),!0),r=t.is("suppressMenuHide"),i=r&&fg(this.eMenu),o=i?new ZC(this.eMenu,!0):n;if(this.params.enableMenu){var a=i?"EVENT_TAP":"EVENT_LONG_TAP";this.addManagedListener(o,ZC[a],(function(n){t.api.showColumnMenuAfterMouseClick(e.params.column,n.touchStart)}))}if(this.params.enableSorting){this.addManagedListener(n,ZC.EVENT_TAP,(function(t){var n=t.touchStart.target;r&&e.eMenu.contains(n)||e.sortController.progressSort(e.params.column,!1,"uiColumnSorted")}))}this.addDestroyFunc((function(){return n.destroy()})),i&&this.addDestroyFunc((function(){return o.destroy()}))}}},{key:"workOutShowMenu",value:function(){var e=!this.gridOptionsService.is("suppressMenuHide"),t=Cw()&&e;return this.params.enableMenu&&!t}},{key:"setMenu",value:function(){var e=this;if(this.eMenu)if(this.currentShowMenu=this.workOutShowMenu(),this.currentShowMenu){var t=this.gridOptionsService.is("suppressMenuHide");this.addManagedListener(this.eMenu,"click",(function(){return e.showMenu(e.eMenu)})),this.eMenu.classList.toggle("ag-header-menu-always-show",t)}else ib(this.eMenu)}},{key:"showMenu",value:function(e){e||(e=this.eMenu),this.menuFactory.showMenuAfterButtonClick(this.params.column,e,"columnMenu")}},{key:"workOutSort",value:function(){return this.params.enableSorting}},{key:"setupSort",value:function(){var e=this;if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.context.createBean(new $C(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),this.currentSort){var t="ctrl"===this.gridOptionsService.get("multiSortKey");this.addManagedListener(this.params.column,fm.EVENT_MOVING_CHANGED,(function(){e.lastMovingChanged=(new Date).getTime()})),this.eLabel&&this.addManagedListener(this.eLabel,"click",(function(n){var r=e.params.column.isMoving(),i=(new Date).getTime()-e.lastMovingChanged<50;if(!(r||i)){var o=t?n.ctrlKey||n.metaKey:n.shiftKey;e.params.progressSort(o)}}));var n=function(){if(e.addOrRemoveCssClass("ag-header-cell-sorted-asc",e.params.column.isSortAscending()),e.addOrRemoveCssClass("ag-header-cell-sorted-desc",e.params.column.isSortDescending()),e.addOrRemoveCssClass("ag-header-cell-sorted-none",e.params.column.isSortNone()),e.params.column.getColDef().showRowGroup){var t=e.columnModel.getSourceColumnsForGroupColumn(e.params.column),n=!(null===t||void 0===t?void 0:t.every((function(t){return e.params.column.getSort()==t.getSort()})));e.addOrRemoveCssClass("ag-header-cell-sorted-mixed",n)}};this.addManagedListener(this.eventService,Ym.EVENT_SORT_CHANGED,n),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,n)}}},{key:"setupFilterIcon",value:function(){this.eFilter&&(this.addManagedListener(this.params.column,fm.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.onFilterChanged())}},{key:"onFilterChanged",value:function(){var e=this.params.column.isFilterActive();zw(this.eFilter,e,{skipAriaHidden:!0})}}]),n}(Zb);tS.TEMPLATE='<div class="ag-cell-label-container" role="presentation">\n            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n            <div ref="eLabel" class="ag-header-cell-label" role="presentation">\n                <span ref="eText" class="ag-header-cell-text"></span>\n                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>\n            </div>\n        </div>',eS([nm("sortController")],tS.prototype,"sortController",void 0),eS([nm("menuFactory")],tS.prototype,"menuFactory",void 0),eS([nm("columnModel")],tS.prototype,"columnModel",void 0),eS([Jb("eFilter")],tS.prototype,"eFilter",void 0),eS([Jb("eSortIndicator")],tS.prototype,"eSortIndicator",void 0),eS([Jb("eMenu")],tS.prototype,"eMenu",void 0),eS([Jb("eLabel")],tS.prototype,"eLabel",void 0),eS([Jb("eText")],tS.prototype,"eText",void 0),eS([Jb("eSortOrder")],tS.prototype,"eSortOrder",void 0),eS([Jb("eSortAsc")],tS.prototype,"eSortAsc",void 0),eS([Jb("eSortDesc")],tS.prototype,"eSortDesc",void 0),eS([Jb("eSortMixed")],tS.prototype,"eSortMixed",void 0),eS([Jb("eSortNone")],tS.prototype,"eSortNone",void 0);var nS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},rS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,n.TEMPLATE)}return A(n,[{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this)}},{key:"init",value:function(e){this.params=e,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}},{key:"checkWarnings",value:function(){if(this.params.template){Lg((function(){return console.warn("AG Grid: A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}),"HeaderGroupComp.templateNotSupported")}}},{key:"setupExpandIcons",value:function(){var e=this;this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");var t=function(t){if(!Pm(t)){var n=!e.params.columnGroup.isExpanded();e.columnModel.setColumnGroupOpened(e.params.columnGroup.getProvidedColumnGroup(),n,"uiColumnExpanded")}};this.addTouchAndClickListeners(this.eCloseIcon,t),this.addTouchAndClickListeners(this.eOpenIcon,t);var n=function(e){Nm(e)};this.addManagedListener(this.eCloseIcon,"dblclick",n),this.addManagedListener(this.eOpenIcon,"dblclick",n),this.addManagedListener(this.getGui(),"dblclick",t),this.updateIconVisibility();var r=this.params.columnGroup.getProvidedColumnGroup();this.addManagedListener(r,vm.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(r,vm.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))}},{key:"addTouchAndClickListeners",value:function(e,t){var n=new ZC(e,!0);this.addManagedListener(n,ZC.EVENT_TAP,t),this.addDestroyFunc((function(){return n.destroy()})),this.addManagedListener(e,"click",t)}},{key:"updateIconVisibility",value:function(){if(this.params.columnGroup.isExpandable()){var e=this.params.columnGroup.isExpanded();zw(this.eOpenIcon,e),zw(this.eCloseIcon,!e)}else zw(this.eOpenIcon,!1),zw(this.eCloseIcon,!1)}},{key:"addInIcon",value:function(e,t){var n=Rb(e,this.gridOptionsService,null);n&&this.getRefElement(t).appendChild(n)}},{key:"addGroupExpandIcon",value:function(){if(!this.params.columnGroup.isExpandable())return zw(this.eOpenIcon,!1),void zw(this.eCloseIcon,!1)}},{key:"setupLabel",value:function(){var e,t=this.params,n=t.displayName,r=t.columnGroup;if(fg(n)){var i=ry(n);this.getRefElement("agLabel").innerHTML=i}this.addOrRemoveCssClass("ag-sticky-label",!(null===(e=r.getColGroupDef())||void 0===e?void 0:e.suppressStickyLabel))}}]),n}(Zb);rS.TEMPLATE='<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">\n            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>',nS([nm("columnModel")],rS.prototype,"columnModel",void 0),nS([Jb("agOpened")],rS.prototype,"eOpenIcon",void 0),nS([Jb("agClosed")],rS.prototype,"eCloseIcon",void 0);var iS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"isPopup",value:function(){return!0}},{key:"setParentComponent",value:function(e){e.addCssClass("ag-has-popup"),cg(D(n.prototype),"setParentComponent",this).call(this,e)}},{key:"destroy",value:function(){var e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),cg(D(n.prototype),"destroy",this).call(this)}}]),n}(Zb),oS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},aS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,n.TEMPLATE)}return A(n,[{key:"init",value:function(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),fg(e.value,!0)&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}},{key:"onKeyDown",value:function(e){var t=e.key;(t===_b.LEFT||t===_b.UP||t===_b.RIGHT||t===_b.DOWN||e.shiftKey&&t===_b.ENTER)&&e.stopPropagation()}},{key:"afterGuiAttached",value:function(){var e=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}},{key:"getValue",value:function(){var e=this.eTextArea.getValue();return fg(e)||fg(this.params.value)?this.params.parseValue(e):this.params.value}}]),n}(iS);aS.TEMPLATE='<div class="ag-large-text">\n            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',oS([Jb("eTextArea")],aS.prototype,"eTextArea",void 0);var sS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},lS=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.call(this,'<div class="ag-cell-edit-wrapper"><ag-select class="ag-cell-editor" ref="eSelect"></ag-select></div>')).startedByEnter=!1,e}return A(n,[{key:"init",value:function(e){var t=this;if(this.focusAfterAttached=e.cellStartedEdit,pg(e.values))console.warn("AG Grid: no values found for select cellEditor");else{this.startedByEnter=null!=e.eventKey&&e.eventKey===_b.ENTER;var n=!1;e.values.forEach((function(r){var i={value:r},o=t.valueFormatterService.formatValue(e.column,null,r),a=null!==o&&void 0!==o;i.text=a?o:r,t.eSelect.addOption(i),n=n||e.value===r})),n?this.eSelect.setValue(e.value,!0):e.values.length&&this.eSelect.setValue(e.values[0],!0),"fullRow"!==this.gridOptionsService.get("editType")&&this.addManagedListener(this.eSelect,CC.EVENT_ITEM_SELECTED,(function(){return e.stopEditing()}))}}},{key:"afterGuiAttached",value:function(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&this.eSelect.showPicker()}},{key:"focusIn",value:function(){this.eSelect.getFocusableElement().focus()}},{key:"getValue",value:function(){return this.eSelect.getValue()}},{key:"isPopup",value:function(){return!1}}]),n}(iS);sS([nm("valueFormatterService")],lS.prototype,"valueFormatterService",void 0),sS([Jb("eSelect")],lS.prototype,"eSelect",void 0);var uS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},cS=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this,'\n            <div class="ag-cell-edit-wrapper">\n                '.concat(e.getTemplate(),"\n            </div>"))).cellEditorInput=e,r}return A(n,[{key:"init",value:function(e){this.params=e;var t,n=this.eInput;if(this.cellEditorInput.init(n,e),e.cellStartedEdit){this.focusAfterAttached=!0;var r=e.eventKey;r===_b.BACKSPACE||e.eventKey===_b.DELETE?t="":r&&1===r.length?t=r:(t=this.cellEditorInput.getStartValue(),r!==_b.F2&&(this.highlightAllOnFocus=!0))}else this.focusAfterAttached=!1,t=this.cellEditorInput.getStartValue();null!=t&&n.setStartValue(t),this.addManagedListener(n.getGui(),"keydown",(function(e){var t=e.key;t!==_b.PAGE_UP&&t!==_b.PAGE_DOWN||e.preventDefault()}))}},{key:"afterGuiAttached",value:function(){var e,t,n=this.localeService.getLocaleTextFunc(),r=this.eInput;if(r.setInputAriaLabel(n("ariaInputEditor","Input Editor")),this.focusAfterAttached){gw()||r.getFocusableElement().focus();var i=r.getInputElement();this.highlightAllOnFocus?i.select():null===(t=(e=this.cellEditorInput).setCaret)||void 0===t||t.call(e)}}},{key:"focusIn",value:function(){var e=this.eInput,t=e.getFocusableElement(),n=e.getInputElement();t.focus(),n.select()}},{key:"getValue",value:function(){return this.cellEditorInput.getValue()}},{key:"isPopup",value:function(){return!1}}]),n}(iS);uS([Jb("eInput")],cS.prototype,"eInput",void 0);var dS=function(){function e(){T(this,e)}return A(e,[{key:"getTemplate",value:function(){return'<ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>'}},{key:"init",value:function(e,t){this.eInput=e,this.params=t,null!=t.maxLength&&e.setMaxLength(t.maxLength)}},{key:"getValue",value:function(){var e=this.eInput.getValue();return fg(e)||fg(this.params.value)?this.params.parseValue(e):this.params.value}},{key:"getStartValue",value:function(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}},{key:"setCaret",value:function(){var e=this.eInput.getValue(),t=fg(e)&&e.length||0;t&&this.eInput.getInputElement().setSelectionRange(t,t)}}]),e}(),hS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,new dS)}return A(n)}(cS),fS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},pS=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.call(this,n.TEMPLATE)).refreshCount=0,e}return A(n,[{key:"init",value:function(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e)}},{key:"showDelta",value:function(e,t){var n=Math.abs(t),r=e.formatValue(n),i=fg(r)?r:n,o=t>=0;this.eDelta.innerHTML=o?"\u2191"+i:"\u2193"+i,this.eDelta.classList.toggle("ag-value-change-delta-up",o),this.eDelta.classList.toggle("ag-value-change-delta-down",!o)}},{key:"setTimerToRemoveDelta",value:function(){var e=this;this.refreshCount++;var t=this.refreshCount;window.setTimeout((function(){t===e.refreshCount&&e.hideDeltaValue()}),2e3)}},{key:"hideDeltaValue",value:function(){this.eValue.classList.remove("ag-value-change-value-highlight"),rb(this.eDelta)}},{key:"refresh",value:function(e){var t=e.value;if(t===this.lastValue)return!1;if(fg(e.valueFormatted)?this.eValue.innerHTML=e.valueFormatted:fg(e.value)?this.eValue.innerHTML=t:rb(this.eValue),this.filterManager.isSuppressFlashingCellsBecauseFiltering())return!1;if("number"===typeof t&&"number"===typeof this.lastValue){var n=t-this.lastValue;this.showDelta(e,n)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),this.setTimerToRemoveDelta(),this.lastValue=t,!0}}]),n}(Zb);pS.TEMPLATE='<span><span class="ag-value-change-delta"></span><span class="ag-value-change-value"></span></span>',fS([nm("filterManager")],pS.prototype,"filterManager",void 0);var vS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},gS=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.call(this,n.TEMPLATE)).refreshCount=0,e.eCurrent=e.queryForHtmlElement(".ag-value-slide-current"),e}return A(n,[{key:"init",value:function(e){this.refresh(e)}},{key:"addSlideAnimation",value:function(){var e=this;this.refreshCount++;var t=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious),this.ePrevious=ab('<span class="ag-value-slide-previous ag-value-slide-out"></span>'),this.ePrevious.innerHTML=this.eCurrent.innerHTML,this.getGui().insertBefore(this.ePrevious,this.eCurrent),window.setTimeout((function(){t===e.refreshCount&&e.ePrevious.classList.add("ag-value-slide-out-end")}),50),window.setTimeout((function(){t===e.refreshCount&&(e.getGui().removeChild(e.ePrevious),e.ePrevious=null)}),3e3)}},{key:"refresh",value:function(e){var t=e.value;return pg(t)&&(t=""),t!==this.lastValue&&(!this.filterManager.isSuppressFlashingCellsBecauseFiltering()&&(this.addSlideAnimation(),this.lastValue=t,fg(e.valueFormatted)?this.eCurrent.innerHTML=e.valueFormatted:fg(e.value)?this.eCurrent.innerHTML=t:rb(this.eCurrent),!0))}}]),n}(Zb);gS.TEMPLATE='<span>\n            <span class="ag-value-slide-current"></span>\n        </span>',vS([nm("filterManager")],gS.prototype,"filterManager",void 0);var mS=function(){function e(t){T(this,e),this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=e.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=t}return A(e,[{key:"setData",value:function(e){this.setDataCommon(e,!1)}},{key:"updateData",value:function(e){this.setDataCommon(e,!0)}},{key:"setDataCommon",value:function(e,t){var n=this.data;this.data=e,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();var r=this.createDataChangedEvent(e,n,t);this.dispatchLocalEvent(r)}},{key:"updateDataOnDetailNode",value:function(){this.detailNode&&(this.detailNode.data=this.data)}},{key:"createDataChangedEvent",value:function(t,n,r){return{type:e.EVENT_DATA_CHANGED,node:this,oldData:n,newData:t,update:r}}},{key:"createLocalRowEvent",value:function(e){return{type:e,node:this}}},{key:"getRowIndexString",value:function(){return"top"===this.rowPinned?"t-"+this.rowIndex:"bottom"===this.rowPinned?"b-"+this.rowIndex:this.rowIndex.toString()}},{key:"createDaemonNode",value:function(){var t=new e(this.beans);return t.id=this.id,t.data=this.data,t.__daemon=!0,t.selected=this.selected,t.level=this.level,t}},{key:"setDataAndId",value:function(e,t){var n=fg(this.id)?this.createDaemonNode():null,r=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),this.beans.selectionService.syncInRowNode(this,n),this.checkRowSelectable();var i=this.createDataChangedEvent(e,r,!1);this.dispatchLocalEvent(i)}},{key:"checkRowSelectable",value:function(){var e=this.beans.gridOptionsService.get("isRowSelectable");this.setRowSelectable(!e||e(this))}},{key:"setRowSelectable",value:function(t){if(this.selectable!==t&&(this.selectable=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_SELECTABLE_CHANGED)),this.beans.gridOptionsService.is("groupSelectsChildren"))){var n=this.calculateSelectedFromChildren();this.setSelectedParams({newValue:null!==n&&void 0!==n&&n,source:"selectableChanged"})}}},{key:"setId",value:function(t){var n=this.beans.gridOptionsService.getCallback("getRowId");if(n)if(this.data){var r=this.getGroupKeys(!0);this.id=n({data:this.data,parentKeys:r.length>0?r:void 0,level:this.level}),null!==this.id&&"string"===typeof this.id&&this.id.startsWith(e.ID_PREFIX_ROW_GROUP)&&console.error("AG Grid: Row IDs cannot start with ".concat(e.ID_PREFIX_ROW_GROUP,", this is a reserved prefix for AG Grid's row grouping feature.")),null!==this.id&&"string"!==typeof this.id&&(this.id=""+this.id)}else this.id=void 0;else this.id=t}},{key:"getGroupKeys",value:function(){var e=[],t=this;for(arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(t=t.parent);t&&t.level>=0;)e.push(t.key),t=t.parent;return e.reverse(),e}},{key:"isPixelInRange",value:function(e){return!(!fg(this.rowTop)||!fg(this.rowHeight))&&(e>=this.rowTop&&e<this.rowTop+this.rowHeight)}},{key:"setFirstChild",value:function(t){this.firstChild!==t&&(this.firstChild=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_FIRST_CHILD_CHANGED)))}},{key:"setLastChild",value:function(t){this.lastChild!==t&&(this.lastChild=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_LAST_CHILD_CHANGED)))}},{key:"setChildIndex",value:function(t){this.childIndex!==t&&(this.childIndex=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_CHILD_INDEX_CHANGED)))}},{key:"setRowTop",value:function(t){this.oldRowTop=this.rowTop,this.rowTop!==t&&(this.rowTop=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_TOP_CHANGED)),this.setDisplayed(null!==t))}},{key:"clearRowTopAndRowIndex",value:function(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}},{key:"setDisplayed",value:function(t){this.displayed!==t&&(this.displayed=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_DISPLAYED_CHANGED)))}},{key:"setDragging",value:function(t){this.dragging!==t&&(this.dragging=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_DRAGGING_CHANGED)))}},{key:"setHighlighted",value:function(t){t!==this.highlighted&&(this.highlighted=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_HIGHLIGHT_CHANGED)))}},{key:"setHovered",value:function(e){this.hovered!==e&&(this.hovered=e)}},{key:"isHovered",value:function(){return this.hovered}},{key:"setAllChildrenCount",value:function(t){this.allChildrenCount!==t&&(this.allChildrenCount=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_ALL_CHILDREN_COUNT_CHANGED)))}},{key:"setMaster",value:function(t){this.master!==t&&(this.master&&!t&&(this.expanded=!1),this.master=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_MASTER_CHANGED)))}},{key:"setGroup",value:function(t){this.group!==t&&(this.group&&!t&&(this.expanded=!1),this.group=t,this.updateHasChildren(),this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_GROUP_CHANGED)))}},{key:"setRowHeight",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.rowHeight=t,this.rowHeightEstimated=n,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_HEIGHT_CHANGED))}},{key:"setRowAutoHeight",value:function(e,t){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[t.getId()]=e,null!=e&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=zg(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}},{key:"checkAutoHeights",value:function(){var e=this,t=!1,n=!0,r=0,i=this.__autoHeights;if(null!=i&&(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach((function(o){var a=i[o.getId()];if(null==a){if(!e.beans.columnModel.isColSpanActive())return void(t=!0);var s=[];switch(o.getPinned()){case"left":s=e.beans.columnModel.getDisplayedLeftColumnsForRow(e);break;case"right":s=e.beans.columnModel.getDisplayedRightColumnsForRow(e);break;case null:s=e.beans.columnModel.getViewportCenterColumnsForRow(e)}if(s.includes(o))return void(t=!0);a=-1}else n=!1;a>r&&(r=a)})),!t&&((n||r<10)&&(r=this.beans.gridOptionsService.getRowHeightForNode(this).height),r!=this.rowHeight))){this.setRowHeight(r);var o=this.beans.rowModel;o.onRowHeightChangedDebounced&&o.onRowHeightChangedDebounced()}}},{key:"setRowIndex",value:function(t){this.rowIndex!==t&&(this.rowIndex=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_ROW_INDEX_CHANGED)))}},{key:"setUiLevel",value:function(t){this.uiLevel!==t&&(this.uiLevel=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_UI_LEVEL_CHANGED)))}},{key:"setExpanded",value:function(t,n){if(this.expanded!==t){this.expanded=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_EXPANDED_CHANGED));var r=Object.assign({},this.createGlobalRowEvent(Ym.EVENT_ROW_GROUP_OPENED),{expanded:t,event:n||null});this.beans.rowNodeEventThrottle.dispatchExpanded(r),this.beans.gridOptionsService.is("groupIncludeFooter")&&this.beans.rowRenderer.refreshCells({rowNodes:[this]})}}},{key:"createGlobalRowEvent",value:function(e){return{type:e,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned,context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi}}},{key:"dispatchLocalEvent",value:function(e){this.eventService&&this.eventService.dispatchEvent(e)}},{key:"setDataValue",value:function(e,t,n){var r=this,i=function(){var t;return"string"!==typeof e?e:null!==(t=r.beans.columnModel.getGridColumn(e))&&void 0!==t?t:r.beans.columnModel.getPrimaryColumn(e)}(),o=this.getValueFromValueService(i);if(this.beans.gridOptionsService.is("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(i,o,t,n),!1;var a=this.beans.valueService.setValue(this,i,t,n);return this.dispatchCellChangedEvent(i,t,o),this.checkRowSelectable(),a}},{key:"getValueFromValueService",value:function(e){var t=this.leafGroup&&this.beans.columnModel.isPivotMode(),n=this.group&&this.expanded&&!this.footer&&!t,r=this.beans.gridOptionsService.is("groupIncludeFooter"),i=this.beans.gridOptionsService.is("groupSuppressBlankHeader"),o=n&&r&&!i;return this.beans.valueService.getValue(e,this,!1,o)}},{key:"dispatchEventForSaveValueReadOnly",value:function(e,t,n,r){var i={type:Ym.EVENT_CELL_EDIT_REQUEST,event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:e,colDef:e.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,data:this.data,node:this,oldValue:t,newValue:n,value:n,source:r};this.beans.eventService.dispatchEvent(i)}},{key:"setGroupValue",value:function(e,t){var n=this.beans.columnModel.getGridColumn(e);pg(this.groupData)&&(this.groupData={});var r=n.getColId(),i=this.groupData[r];i!==t&&(this.groupData[r]=t,this.dispatchCellChangedEvent(n,t,i))}},{key:"setAggData",value:function(e){var t=this,n=Ag([this.aggData,e]),r=this.aggData;this.aggData=e,this.eventService&&n.forEach((function(e){var n=t.beans.columnModel.getGridColumn(e),i=t.aggData?t.aggData[e]:void 0,o=r?r[e]:void 0;t.dispatchCellChangedEvent(n,i,o)}))}},{key:"updateHasChildren",value:function(){var t=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gridOptionsService.isRowModelType("serverSide")){var n=this.beans.gridOptionsService.isTreeData(),r=this.beans.gridOptionsService.get("isServerSideGroup");t=!this.stub&&!this.footer&&(n?!!r&&r(this.data):!!this.group)}t!==this.__hasChildren&&(this.__hasChildren=!!t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_HAS_CHILDREN_CHANGED)))}},{key:"hasChildren",value:function(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren}},{key:"isEmptyRowGroupNode",value:function(){return this.group&&vg(this.childrenAfterGroup)}},{key:"dispatchCellChangedEvent",value:function(t,n,r){var i={type:e.EVENT_CELL_CHANGED,node:this,column:t,newValue:n,oldValue:r};this.dispatchLocalEvent(i)}},{key:"resetQuickFilterAggregateText",value:function(){this.quickFilterAggregateText=null}},{key:"isExpandable",value:function(){return!!(this.hasChildren()&&!this.footer||this.master)}},{key:"isSelected",value:function(){return this.footer?this.sibling.isSelected():this.selected}},{key:"depthFirstSearch",value:function(e){this.childrenAfterGroup&&this.childrenAfterGroup.forEach((function(t){return t.depthFirstSearch(e)})),e(this)}},{key:"calculateSelectedFromChildren",value:function(){var e,t=!1,n=!1,r=!1;if(!(null===(e=this.childrenAfterGroup)||void 0===e?void 0:e.length))return this.selectable?this.selected:null;for(var i=0;i<this.childrenAfterGroup.length;i++){var o=this.childrenAfterGroup[i],a=o.isSelected();if(!o.selectable){var s=o.calculateSelectedFromChildren();if(null===s)continue;a=s}switch(a){case!0:t=!0;break;case!1:n=!0;break;default:r=!0}}return r||t&&n?void 0:!!t||!n&&(this.selectable?this.selected:null)}},{key:"setSelectedInitialValue",value:function(e){this.selected=e}},{key:"selectThisNode",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api",i=!this.selectable&&t,o=this.selected===t;if(i||o)return!1;this.selected=t,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(e.EVENT_ROW_SELECTED));var a=Object.assign(Object.assign({},this.createGlobalRowEvent(Ym.EVENT_ROW_SELECTED)),{event:n||null,source:r});return this.beans.eventService.dispatchEvent(a),!0}},{key:"setSelected",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";"boolean"!==typeof n?this.setSelectedParams({newValue:e,clearSelection:t,rangeSelect:!1,source:n}):console.warn("AG Grid: since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.")}},{key:"setSelectedParams",value:function(e){return this.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),0):void 0===this.id?(console.warn("AG Grid: cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected(Object.assign(Object.assign({},e),{nodes:[this.footer?this.sibling:this]}))}},{key:"isRowPinned",value:function(){return"top"===this.rowPinned||"bottom"===this.rowPinned}},{key:"isParentOfNode",value:function(e){for(var t=this.parent;t;){if(t===e)return!0;t=t.parent}return!1}},{key:"addEventListener",value:function(e,t){this.eventService||(this.eventService=new um),this.eventService.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){this.eventService&&(this.eventService.removeEventListener(e,t),this.eventService.noRegisteredListenersExist()&&(this.eventService=null))}},{key:"onMouseEnter",value:function(){this.dispatchLocalEvent(this.createLocalRowEvent(e.EVENT_MOUSE_ENTER))}},{key:"onMouseLeave",value:function(){this.dispatchLocalEvent(this.createLocalRowEvent(e.EVENT_MOUSE_LEAVE))}},{key:"getFirstChildOfFirstChild",value:function(e){for(var t=this,n=!0,r=!1,i=null;n&&!r;){var o=t.parent;fg(o)&&t.firstChild?o.rowGroupColumn===e&&(r=!0,i=o):n=!1,t=o}return r?i:null}},{key:"isFullWidthCell",value:function(){var e=this.beans.gridOptionsService.getCallback("isFullWidthRow");return!!e&&e({rowNode:this})}},{key:"getRoute",value:function(){if(null!=this.key){for(var e=[],t=this;null!=t.key;)e.push(t.key),t=t.parent;return e.reverse()}}},{key:"createFooter",value:function(){var t=this;if(!this.sibling){var n=new e(this.beans);Object.keys(this).forEach((function(e){n[e]=t[e]})),n.footer=!0,n.setRowTop(null),n.setRowIndex(null),n.oldRowTop=null,n.id="rowGroupFooter_"+this.id,n.sibling=this,this.sibling=n}}}]),e}();mS.ID_PREFIX_ROW_GROUP="row-group-",mS.ID_PREFIX_TOP_PINNED="t-",mS.ID_PREFIX_BOTTOM_PINNED="b-",mS.OBJECT_ID_SEQUENCE=0,mS.EVENT_ROW_SELECTED="rowSelected",mS.EVENT_DATA_CHANGED="dataChanged",mS.EVENT_CELL_CHANGED="cellChanged",mS.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged",mS.EVENT_MASTER_CHANGED="masterChanged",mS.EVENT_GROUP_CHANGED="groupChanged",mS.EVENT_MOUSE_ENTER="mouseEnter",mS.EVENT_MOUSE_LEAVE="mouseLeave",mS.EVENT_HEIGHT_CHANGED="heightChanged",mS.EVENT_TOP_CHANGED="topChanged",mS.EVENT_DISPLAYED_CHANGED="displayedChanged",mS.EVENT_FIRST_CHILD_CHANGED="firstChildChanged",mS.EVENT_LAST_CHILD_CHANGED="lastChildChanged",mS.EVENT_CHILD_INDEX_CHANGED="childIndexChanged",mS.EVENT_ROW_INDEX_CHANGED="rowIndexChanged",mS.EVENT_EXPANDED_CHANGED="expandedChanged",mS.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged",mS.EVENT_SELECTABLE_CHANGED="selectableChanged",mS.EVENT_UI_LEVEL_CHANGED="uiLevelChanged",mS.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged",mS.EVENT_DRAGGING_CHANGED="draggingChanged";var yS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},wS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,'\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')}return A(n,[{key:"postConstruct",value:function(){this.eCheckbox.setPassive(!0),Vy(this.eCheckbox.getInputElement(),"polite")}},{key:"getCheckboxId",value:function(){return this.eCheckbox.getInputElement().id}},{key:"onDataChanged",value:function(){this.onSelectionChanged()}},{key:"onSelectableChanged",value:function(){this.showOrHideSelect()}},{key:"onSelectionChanged",value:function(){var e=this.localeService.getLocaleTextFunc(),t=this.rowNode.isSelected(),n=aw(e,t),r=e("ariaRowToggleSelection","Press Space to toggle row selection");this.eCheckbox.setValue(t,!0),this.eCheckbox.setInputAriaLabel("".concat(r," (").concat(n,")"))}},{key:"onClicked",value:function(e,t,n){return this.rowNode.setSelectedParams({newValue:e,rangeSelect:n.shiftKey,groupSelectsFiltered:t,event:n,source:"checkboxSelected"})}},{key:"init",value:function(e){var t=this;if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",(function(e){Nm(e)})),this.addManagedListener(this.eCheckbox.getInputElement(),"click",(function(e){Nm(e);var n=t.gridOptionsService.is("groupSelectsFiltered"),r=t.eCheckbox.getValue();t.shouldHandleIndeterminateState(r,n)?0===t.onClicked(!0,n,e||{})&&t.onClicked(!1,n,e):r?t.onClicked(!1,n,e):t.onClicked(!0,n,e||{})})),this.addManagedListener(this.rowNode,mS.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this)),this.gridOptionsService.get("isRowSelectable")||"function"===typeof this.getIsVisible()){var n=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,n),this.addManagedListener(this.rowNode,mS.EVENT_DATA_CHANGED,n),this.addManagedListener(this.rowNode,mS.EVENT_CELL_CHANGED,n),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}},{key:"shouldHandleIndeterminateState",value:function(e,t){return t&&(void 0===this.eCheckbox.getPreviousValue()||void 0===e)&&this.gridOptionsService.isRowModelType("clientSide")}},{key:"showOrHideSelect",value:function(){var e,t,n,r,i=this.rowNode.selectable,o=this.getIsVisible();if(i)if("function"===typeof o){var a=null===(e=this.overrides)||void 0===e?void 0:e.callbackParams,s=null===(t=this.column)||void 0===t?void 0:t.createColumnFunctionCallbackParams(this.rowNode);i=!!s&&o(Object.assign(Object.assign({},a),s))}else i=null!==o&&void 0!==o&&o;if(null===(n=this.column)||void 0===n?void 0:n.getColDef().showDisabledCheckboxes)return this.eCheckbox.setDisabled(!i),this.setVisible(!0),void this.setDisplayed(!0);(null===(r=this.overrides)||void 0===r?void 0:r.removeHidden)?this.setDisplayed(i):this.setVisible(i)}},{key:"getIsVisible",value:function(){var e,t;return this.overrides?this.overrides.isVisible:null===(t=null===(e=this.column)||void 0===e?void 0:e.getColDef())||void 0===t?void 0:t.checkboxSelection}}]),n}(Zb);yS([Jb("eCheckbox")],wS.prototype,"eCheckbox",void 0),yS([$g],wS.prototype,"postConstruct",null);var bS,CS,SS,ES,kS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e[e.ToolPanel=0]="ToolPanel",e[e.HeaderCell=1]="HeaderCell",e[e.RowDrag=2]="RowDrag",e[e.ChartPanel=3]="ChartPanel"}(CS||(CS={})),function(e){e[e.Up=0]="Up",e[e.Down=1]="Down"}(SS||(SS={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(ES||(ES={}));var xS=bS=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).dragSourceAndParamsList=[],e.dropTargets=[],e}return A(n,[{key:"init",value:function(){this.ePinnedIcon=Tb("columnMovePin",this.gridOptionsService,null),this.eHideIcon=Tb("columnMoveHide",this.gridOptionsService,null),this.eMoveIcon=Tb("columnMoveMove",this.gridOptionsService,null),this.eLeftIcon=Tb("columnMoveLeft",this.gridOptionsService,null),this.eRightIcon=Tb("columnMoveRight",this.gridOptionsService,null),this.eGroupIcon=Tb("columnMoveGroup",this.gridOptionsService,null),this.eAggregateIcon=Tb("columnMoveValue",this.gridOptionsService,null),this.ePivotIcon=Tb("columnMovePivot",this.gridOptionsService,null),this.eDropNotAllowedIcon=Tb("dropNotAllowed",this.gridOptionsService,null)}},{key:"addDragSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:n,dragSource:e}),this.dragService.addDragSource(n)}},{key:"removeDragSource",value:function(e){var t=this.dragSourceAndParamsList.find((function(t){return t.dragSource===e}));t&&(this.dragService.removeDragSource(t.params),Cm(this.dragSourceAndParamsList,t))}},{key:"clearDragSourceParamsList",value:function(){var e=this;this.dragSourceAndParamsList.forEach((function(t){return e.dragService.removeDragSource(t.params)})),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0}},{key:"nudge",value:function(){this.dragging&&this.onDragging(this.eventLastTime,!0)}},{key:"onDragStart",value:function(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=this.dragSource.getDragItem(),this.lastDropTarget=this.dragSource.dragSourceDropTarget,this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()}},{key:"onDragStop",value:function(e){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){var t=this.createDropTargetEvent(this.lastDropTarget,e,null,null,!1);this.lastDropTarget.onDragStop(t)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()}},{key:"onDragging",value:function(e,t){var n,r,i,o,a=this,s=this.getHorizontalDirection(e),l=this.getVerticalDirection(e);this.eventLastTime=e,this.positionGhost(e);var u=this.dropTargets.filter((function(t){return a.isMouseOnDropTarget(e,t)})),c=this.findCurrentDropTarget(e,u);if(c!==this.lastDropTarget)this.leaveLastTargetIfExists(e,s,l,t),null!==this.lastDropTarget&&null===c&&(null===(r=(n=this.dragSource).onGridExit)||void 0===r||r.call(n,this.dragItem)),null===this.lastDropTarget&&null!==c&&(null===(o=(i=this.dragSource).onGridEnter)||void 0===o||o.call(i,this.dragItem)),this.enterDragTargetIfExists(c,e,s,l,t),this.lastDropTarget=c;else if(c&&c.onDragging){var d=this.createDropTargetEvent(c,e,s,l,t);c.onDragging(d)}}},{key:"getAllContainersFromDropTarget",value:function(e){var t=e.getSecondaryContainers?e.getSecondaryContainers():null,n=[[e.getContainer()]];return t?n.concat(t):n}},{key:"allContainersIntersect",value:function(e,t){var n,r=dg(t);try{for(r.s();!(n=r.n()).done;){var i=n.value.getBoundingClientRect();if(0===i.width||0===i.height)return!1;var o=e.clientX>=i.left&&e.clientX<i.right,a=e.clientY>=i.top&&e.clientY<i.bottom;if(!o||!a)return!1}}catch(s){r.e(s)}finally{r.f()}return!0}},{key:"isMouseOnDropTarget",value:function(e,t){var n,r=!1,i=dg(this.getAllContainersFromDropTarget(t));try{for(i.s();!(n=i.n()).done;){var o=n.value;if(this.allContainersIntersect(e,o)){r=!0;break}}}catch(a){i.e(a)}finally{i.f()}return!(t.targetContainsSource&&!t.getContainer().contains(this.dragSource.eElement))&&(r&&t.isInterestedIn(this.dragSource.type,this.dragSource.eElement))}},{key:"findCurrentDropTarget",value:function(e,t){var n=t.length;if(0===n)return null;if(1===n)return t[0];var r,i=dg(this.gridOptionsService.getRootNode().elementsFromPoint(e.clientX,e.clientY));try{for(i.s();!(r=i.n()).done;){var o,a=r.value,s=dg(t);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(-1!==Tm(this.getAllContainersFromDropTarget(l)).indexOf(a))return l}}catch(u){s.e(u)}finally{s.f()}}}catch(u){i.e(u)}finally{i.f()}return null}},{key:"enterDragTargetIfExists",value:function(e,t,n,r,i){if(e){if(e.onDragEnter){var o=this.createDropTargetEvent(e,t,n,r,i);e.onDragEnter(o)}this.setGhostIcon(e.getIconName?e.getIconName():null)}}},{key:"leaveLastTargetIfExists",value:function(e,t,n,r){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){var i=this.createDropTargetEvent(this.lastDropTarget,e,t,n,r);this.lastDropTarget.onDragLeave(i)}this.setGhostIcon(null)}}},{key:"addDropTarget",value:function(e){this.dropTargets.push(e)}},{key:"removeDropTarget",value:function(e){this.dropTargets=this.dropTargets.filter((function(t){return t.getContainer()!==e.getContainer()}))}},{key:"hasExternalDropZones",value:function(){return this.dropTargets.some((function(e){return e.external}))}},{key:"findExternalZone",value:function(e){return this.dropTargets.filter((function(e){return e.external})).find((function(t){return t.getContainer()===e.getContainer()}))||null}},{key:"getHorizontalDirection",value:function(e){var t=this.eventLastTime&&this.eventLastTime.clientX,n=e.clientX;return t===n?null:t>n?ES.Left:ES.Right}},{key:"getVerticalDirection",value:function(e){var t=this.eventLastTime&&this.eventLastTime.clientY,n=e.clientY;return t===n?null:t>n?SS.Up:SS.Down}},{key:"createDropTargetEvent",value:function(e,t,n,r,i){var o=e.getContainer(),a=o.getBoundingClientRect(),s=this.gridApi,l=this.columnApi,u=this.dragItem,c=this.dragSource;return{event:t,x:t.clientX-a.left,y:t.clientY-a.top,vDirection:r,hDirection:n,dragSource:c,fromNudge:i,dragItem:u,api:s,columnApi:l,dropZoneTarget:o}}},{key:"positionGhost",value:function(e){var t=this.eGhost;if(t){var n=t.getBoundingClientRect().height,r=xw()-2,i=Tw()-2,o=$w(t.offsetParent),a=e.clientY,s=e.clientX,l=a-o.top-n/2,u=s-o.left-10,c=this.gridOptionsService.getDocument(),d=c.defaultView||window,h=d.pageYOffset||c.documentElement.scrollTop,f=d.pageXOffset||c.documentElement.scrollLeft;r>0&&u+t.clientWidth>r+f&&(u=r+f-t.clientWidth),u<0&&(u=0),i>0&&l+t.clientHeight>i+h&&(l=i+h-t.clientHeight),l<0&&(l=0),t.style.left="".concat(u,"px"),t.style.top="".concat(l,"px")}}},{key:"removeGhost",value:function(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null}},{key:"createGhost",value:function(){this.eGhost=ab(bS.GHOST_TEMPLATE),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);var e=this.environment.getTheme().theme;e&&this.eGhost.classList.add(e),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);var t=this.eGhost.querySelector(".ag-dnd-ghost-label"),n=this.dragSource.dragItemName;Gg(n)&&(n=n()),t.innerHTML=ry(n)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";var r=this.gridOptionsService.getDocument(),i=null;try{i=r.fullscreenElement}catch(s){}finally{if(!i){var o=this.gridOptionsService.getRootNode(),a=o.querySelector("body");i=a||(o instanceof ShadowRoot?o:null===o||void 0===o?void 0:o.documentElement)}}this.eGhostParent=i,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")}},{key:"setGhostIcon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];rb(this.eGhostIcon);var n=null;switch(e||(e=this.dragSource.defaultIconName||bS.ICON_NOT_ALLOWED),e){case bS.ICON_PINNED:n=this.ePinnedIcon;break;case bS.ICON_MOVE:n=this.eMoveIcon;break;case bS.ICON_LEFT:n=this.eLeftIcon;break;case bS.ICON_RIGHT:n=this.eRightIcon;break;case bS.ICON_GROUP:n=this.eGroupIcon;break;case bS.ICON_AGGREGATE:n=this.eAggregateIcon;break;case bS.ICON_PIVOT:n=this.ePivotIcon;break;case bS.ICON_NOT_ALLOWED:n=this.eDropNotAllowedIcon;break;case bS.ICON_HIDE:n=this.eHideIcon}this.eGhostIcon.classList.toggle("ag-shake-left-to-right",t),n===this.eHideIcon&&this.gridOptionsService.is("suppressDragLeaveHidesColumns")||n&&this.eGhostIcon.appendChild(n)}}]),n}(Vm);xS.ICON_PINNED="pinned",xS.ICON_MOVE="move",xS.ICON_LEFT="left",xS.ICON_RIGHT="right",xS.ICON_GROUP="group",xS.ICON_AGGREGATE="aggregate",xS.ICON_PIVOT="pivot",xS.ICON_NOT_ALLOWED="notAllowed",xS.ICON_HIDE="hide",xS.GHOST_TEMPLATE='<div class="ag-dnd-ghost ag-unselectable">\n            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n            <div class="ag-dnd-ghost-label"></div>\n        </div>',kS([nm("dragService")],xS.prototype,"dragService",void 0),kS([nm("mouseEventService")],xS.prototype,"mouseEventService",void 0),kS([nm("columnApi")],xS.prototype,"columnApi",void 0),kS([nm("gridApi")],xS.prototype,"gridApi",void 0),kS([$g],xS.prototype,"init",null),kS([em],xS.prototype,"clearDragSourceParamsList",null),xS=bS=kS([tm("dragAndDropService")],xS);var TS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},RS=function(e){O(n,e);var t=F(n);function n(e,r,i,o,a,s){var l;return T(this,n),(l=t.call(this)).cellValueFn=e,l.rowNode=r,l.column=i,l.customGui=o,l.dragStartPixels=a,l.suppressVisibilityChange=s,l.dragSource=null,l}return A(n,[{key:"isCustomGui",value:function(){return null!=this.customGui}},{key:"postConstruct",value:function(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(Rb("rowDrag",this.gridOptionsService,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){var e=this.gridOptionsService.is("rowDragManaged")?new OS(this,this.beans,this.rowNode,this.column):new _S(this,this.beans,this.rowNode,this.column);this.createManagedBean(e,this.beans.context)}}},{key:"setDragElement",value:function(e,t){this.setTemplateFromElement(e),this.addDragSource(t)}},{key:"getSelectedNodes",value:function(){if(!this.gridOptionsService.is("rowDragMultiRow"))return[this.rowNode];var e=this.beans.selectionService.getSelectedNodes();return-1!==e.indexOf(this.rowNode)?e:[this.rowNode]}},{key:"checkCompatibility",value:function(){var e=this.gridOptionsService.is("rowDragManaged");this.gridOptionsService.isTreeData()&&e&&Lg((function(){return console.warn("AG Grid: If using row drag with tree data, you cannot have rowDragManaged=true")}),"RowDragComp.managedAndTreeData")}},{key:"getDragItem",value:function(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}},{key:"getRowDragText",value:function(e){if(e){var t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gridOptionsService.get("rowDragText")}},{key:"addDragSource",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;this.dragSource&&this.removeDragSource();var n=this.getRowDragText(this.column),r=this.localeService.getLocaleTextFunc();this.dragSource={type:CS.RowDrag,eElement:this.getGui(),dragItemName:function(){var t,i=e.getDragItem(),o=(null===(t=i.rowNodes)||void 0===t?void 0:t.length)||1;return n?n(i,o):1===o?e.cellValueFn():"".concat(o," ").concat(r("rowDragRows","rows"))},getDragItem:function(){return e.getDragItem()},dragStartPixels:t,dragSourceDomDataKey:this.gridOptionsService.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}},{key:"removeDragSource",value:function(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null}}]),n}(Zb);TS([nm("beans")],RS.prototype,"beans",void 0),TS([$g],RS.prototype,"postConstruct",null),TS([em],RS.prototype,"removeDragSource",null);var AS=function(e){O(n,e);var t=F(n);function n(e,r,i){var o;return T(this,n),(o=t.call(this)).parent=e,o.rowNode=r,o.column=i,o}return A(n,[{key:"setDisplayedOrVisible",value:function(e){var t={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,t);else{var n=!0,r=!1;this.column&&(n=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),r=Gg(this.column.getColDef().rowDrag)),r?(this.parent.setDisplayed(!0,t),this.parent.setVisible(n,t)):(this.parent.setDisplayed(n,t),this.parent.setVisible(!0,t))}}}]),n}(Vm),_S=function(e){O(n,e);var t=F(n);function n(e,r,i,o){var a;return T(this,n),(a=t.call(this,e,i,o)).beans=r,a}return A(n,[{key:"postConstruct",value:function(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Ym.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()}},{key:"onSuppressRowDrag",value:function(){this.workOutVisibility()}},{key:"workOutVisibility",value:function(){var e=this.gridOptionsService.is("suppressRowDrag");this.setDisplayedOrVisible(e)}}]),n}(AS);TS([$g],_S.prototype,"postConstruct",null);var OS=function(e){O(n,e);var t=F(n);function n(e,r,i,o){var a;return T(this,n),(a=t.call(this,e,i,o)).beans=r,a}return A(n,[{key:"postConstruct",value:function(){this.addManagedListener(this.beans.eventService,Ym.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Ym.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Ym.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}},{key:"onSuppressRowDrag",value:function(){this.workOutVisibility()}},{key:"workOutVisibility",value:function(){var e=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),t=e&&e.shouldPreventRowMove(),n=this.gridOptionsService.is("suppressRowDrag"),r=this.beans.dragAndDropService.hasExternalDropZones(),i=t&&!r||n;this.setDisplayedOrVisible(i)}}]),n}(AS);TS([$g],OS.prototype,"postConstruct",null);var DS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},NS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"init",value:function(e,t,n,r,i,o,a){this.params=a,this.eGui=t,this.eCheckbox=n,this.eExpanded=r,this.eContracted=i,this.comp=e,this.compClass=o;var s=this.isTopLevelFooter(),l=this.isEmbeddedRowMismatch(),u=null==a.value&&!a.node.master,c=!1;if(this.gridOptionsService.is("groupIncludeFooter")&&this.gridOptionsService.is("groupHideOpenParents")){var d=a.node;if(d.footer)c=(a.colDef&&a.colDef.showRowGroup)!==(d.rowGroupColumn&&d.rowGroupColumn.getColId())}this.cellIsBlank=!s&&(l||u&&!a.node.master||c),this.cellIsBlank||(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),this.addFullWidthRowDraggerIfNeeded(),this.addExpandAndContract(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded())}},{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this),this.expandListener=null}},{key:"refreshAriaExpanded",value:function(){var e=this.params,t=e.node,n=e.eParentOfValue;if(this.expandListener&&(this.expandListener=this.expandListener()),this.isExpandable()){var r=function(){Ky(n,!!t.expanded)};this.expandListener=this.addManagedListener(t,mS.EVENT_EXPANDED_CHANGED,r)||null,r()}else qy(n)}},{key:"isTopLevelFooter",value:function(){if(!this.gridOptionsService.is("groupIncludeTotalFooter"))return!1;if(null!=this.params.value||-1!=this.params.node.level)return!1;var e=this.params.colDef;if(null==e)return!0;if(!0===e.showRowGroup)return!0;var t=this.columnModel.getRowGroupColumns();return!t||0===t.length||t[0].getId()===e.showRowGroup}},{key:"isEmbeddedRowMismatch",value:function(){if(!this.params.fullWidth||!this.gridOptionsService.is("embedFullWidthRows"))return!1;var e="left"===this.params.pinned,t="right"===this.params.pinned,n=!e&&!t;return this.gridOptionsService.is("enableRtl")?this.columnModel.isPinningLeft()?!t:!n:this.columnModel.isPinningLeft()?!e:!n}},{key:"findDisplayedGroupNode",value:function(){var e=this.params.column,t=this.params.node;if(this.showingValueForOpenedParent)for(var n=t.parent;null!=n;){if(n.rowGroupColumn&&e.isRowGroupDisplayed(n.rowGroupColumn.getId())){this.displayedGroupNode=n;break}n=n.parent}pg(this.displayedGroupNode)&&(this.displayedGroupNode=t)}},{key:"setupShowingValueForOpenedParent",value:function(){var e=this.params.node,t=this.params.column;if(this.gridOptionsService.is("groupHideOpenParents"))if(e.groupData){if(null!=e.rowGroupColumn){var n=e.rowGroupColumn.getId();if(t.isRowGroupDisplayed(n))return void(this.showingValueForOpenedParent=!1)}var r=null!=e.groupData[t.getId()];this.showingValueForOpenedParent=r}else this.showingValueForOpenedParent=!1;else this.showingValueForOpenedParent=!1}},{key:"addValueElement",value:function(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())}},{key:"addGroupValue",value:function(){var e=this.adjustParamsWithDetailsFromRelatedColumn(),t=this.getInnerCompDetails(e),n=e.valueFormatted,r=e.value,i=n;null==i&&(i=""===r&&this.params.node.group?this.localeService.getLocaleTextFunc()("blanks","(Blanks)"):null!==r&&void 0!==r?r:null);this.comp.setInnerRenderer(t,i)}},{key:"adjustParamsWithDetailsFromRelatedColumn",value:function(){var e=this.displayedGroupNode.rowGroupColumn,t=this.params.column;if(!e)return this.params;if(null!=t&&!t.isRowGroupDisplayed(e.getId()))return this.params;var n=this.params,r=this.params,i=r.value,o=r.node,a=this.valueFormatterService.formatValue(e,o,i);return Object.assign(Object.assign({},n),{valueFormatted:a})}},{key:"addFooterValue",value:function(){var e=this.params.footerValueGetter,t="";if(e){var n=Eg(this.params);n.value=this.params.value,"function"===typeof e?t=e(n):"string"===typeof e?t=this.expressionService.evaluate(e,n):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else t="Total "+(null!=this.params.value?this.params.value:"");var r=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(r,t)}},{key:"getInnerCompDetails",value:function(e){var t=this;if(e.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gridOptionsService.get("groupRowRendererParams"),e);var n=this.userComponentFactory.getInnerRendererDetails(e,e),r=function(e){return e&&e.componentClass==t.compClass};if(n&&!r(n))return n;var i=this.displayedGroupNode.rowGroupColumn,o=i?i.getColDef():void 0;if(o){var a=this.userComponentFactory.getCellRendererDetails(o,e);if(a&&!r(a))return a;if(r(a)&&o.cellRendererParams&&o.cellRendererParams.innerRenderer)return this.userComponentFactory.getInnerRendererDetails(o.cellRendererParams,e)}}},{key:"addChildCount",value:function(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,mS.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())}},{key:"updateChildCount",value:function(){var e=this.displayedGroupNode.allChildrenCount,t=this.isShowRowGroupForThisRow()&&null!=e&&e>=0?"(".concat(e,")"):"";this.comp.setChildCount(t)}},{key:"isShowRowGroupForThisRow",value:function(){if(this.gridOptionsService.isTreeData())return!0;var e=this.displayedGroupNode.rowGroupColumn;if(!e)return!1;var t=this.params.column;return null==t||t.isRowGroupDisplayed(e.getId())}},{key:"addExpandAndContract",value:function(){var e,t=this.params,n=Rb("groupExpanded",this.gridOptionsService,null),r=Rb("groupContracted",this.gridOptionsService,null);n&&this.eExpanded.appendChild(n),r&&this.eContracted.appendChild(r);var i=t.eGridCell;(null===(e=this.params.column)||void 0===e?void 0:e.isCellEditable(t.node))&&this.gridOptionsService.is("enableGroupEdit")||!this.isExpandable()||t.suppressDoubleClickExpand||this.addManagedListener(i,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(i,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(t.node,mS.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();var o=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,mS.EVENT_ALL_CHILDREN_COUNT_CHANGED,o),this.addManagedListener(this.displayedGroupNode,mS.EVENT_MASTER_CHANGED,o),this.addManagedListener(this.displayedGroupNode,mS.EVENT_GROUP_CHANGED,o),this.addManagedListener(this.displayedGroupNode,mS.EVENT_HAS_CHILDREN_CHANGED,o)}},{key:"onExpandClicked",value:function(e){Pm(e)||(Nm(e),this.onExpandOrContract(e))}},{key:"onExpandOrContract",value:function(e){var t=this.displayedGroupNode,n=!t.expanded;!n&&t.sticky&&this.scrollToStickyNode(t),t.setExpanded(n,e)}},{key:"scrollToStickyNode",value:function(e){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(e.rowTop-e.stickyRowTop)}},{key:"isExpandable",value:function(){if(this.showingValueForOpenedParent)return!0;var e=this.displayedGroupNode,t=this.columnModel.isPivotMode()&&e.leafGroup;if(!(e.isExpandable()&&!e.footer&&!t))return!1;var n=this.params.column;return null==n||"string"!==typeof n.getColDef().showRowGroup||this.isShowRowGroupForThisRow()}},{key:"showExpandAndContractIcons",value:function(){var e=this.params,t=this.displayedGroupNode,n=this.columnModel,r=e.node,i=this.isExpandable();if(i){var o=!!this.showingValueForOpenedParent||r.expanded;this.comp.setExpandedDisplayed(o),this.comp.setContractedDisplayed(!o)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);var a=n.isPivotMode(),s=a&&t.leafGroup,l=i&&!s,u=r.footer&&-1===r.level;this.comp.addOrRemoveCssClass("ag-cell-expandable",l),this.comp.addOrRemoveCssClass("ag-row-group",l),a?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",s):u||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!l)}},{key:"onRowNodeIsExpandableChanged",value:function(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()}},{key:"setupIndent",value:function(){var e=this.params.node;this.params.suppressPadding||(this.addManagedListener(e,mS.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())}},{key:"setIndent",value:function(){if(!this.gridOptionsService.is("groupHideOpenParents")){var e=this.params,t=e.node,n=!!e.colDef,r=this.gridOptionsService.isTreeData(),i=!n||r||!0===e.colDef.showRowGroup?t.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+i,this.comp.addOrRemoveCssClass(this.indentClass,!0)}}},{key:"addFullWidthRowDraggerIfNeeded",value:function(){var e=this;if(this.params.fullWidth&&this.params.rowDrag){var t=new RS((function(){return e.params.value}),this.params.node);this.createManagedBean(t,this.context),this.eGui.insertAdjacentElement("afterbegin",t.getGui())}}},{key:"isUserWantsSelected",value:function(){var e=this.params.checkbox;return"function"===typeof e||!0===e}},{key:"addCheckboxIfNeeded",value:function(){var e=this,t=this.displayedGroupNode,n=this.isUserWantsSelected()&&!t.footer&&!t.rowPinned&&!t.detail;if(n){var r=new wS;this.getContext().createBean(r),r.init({rowNode:t,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(r.getGui()),this.addDestroyFunc((function(){return e.getContext().destroyBean(r)}))}this.comp.setCheckboxVisible(n)}},{key:"onKeyDown",value:function(e){e.key!==_b.ENTER||this.params.suppressEnterExpand||(this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(e))}},{key:"onCellDblClicked",value:function(e){Pm(e)||(Lm(this.eExpanded,e)||Lm(this.eContracted,e)||this.onExpandOrContract(e))}}]),n}(Vm);DS([nm("expressionService")],NS.prototype,"expressionService",void 0),DS([nm("valueFormatterService")],NS.prototype,"valueFormatterService",void 0),DS([nm("columnModel")],NS.prototype,"columnModel",void 0),DS([nm("userComponentFactory")],NS.prototype,"userComponentFactory",void 0),DS([nm("ctrlsService")],NS.prototype,"ctrlsService",void 0);var PS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},FS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,n.TEMPLATE)}return A(n,[{key:"init",value:function(e){var t=this,n={setInnerRenderer:function(e,n){return t.setRenderDetails(e,n)},setChildCount:function(e){return t.eChildCount.innerHTML=e},addOrRemoveCssClass:function(e,n){return t.addOrRemoveCssClass(e,n)},setContractedDisplayed:function(e){return zw(t.eContracted,e)},setExpandedDisplayed:function(e){return zw(t.eExpanded,e)},setCheckboxVisible:function(e){return t.eCheckbox.classList.toggle("ag-invisible",!e)}},r=this.createManagedBean(new NS),i=!e.colDef,o=this.getGui();r.init(n,o,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,e),i&&Fy(o,"gridcell")}},{key:"setRenderDetails",value:function(e,t){var n=this;if(e){var r=e.newAgStackInstance();if(!r)return;r.then((function(e){if(e){var t=function(){return n.context.destroyBean(e)};n.isAlive()?(n.eValue.appendChild(e.getGui()),n.addDestroyFunc(t)):t()}}))}else this.eValue.innerText=t}},{key:"destroy",value:function(){this.getContext().destroyBean(this.innerCellRenderer),cg(D(n.prototype),"destroy",this).call(this)}},{key:"refresh",value:function(){return!1}}]),n}(Zb);FS.TEMPLATE='<span class="ag-cell-wrapper">\n            <span class="ag-group-expanded" ref="eExpanded"></span>\n            <span class="ag-group-contracted" ref="eContracted"></span>\n            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>\n            <span class="ag-group-value" ref="eValue"></span>\n            <span class="ag-group-child-count" ref="eChildCount"></span>\n        </span>',PS([Jb("eExpanded")],FS.prototype,"eExpanded",void 0),PS([Jb("eContracted")],FS.prototype,"eContracted",void 0),PS([Jb("eCheckbox")],FS.prototype,"eCheckbox",void 0),PS([Jb("eValue")],FS.prototype,"eValue",void 0),PS([Jb("eChildCount")],FS.prototype,"eChildCount",void 0);var IS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},LS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,n.TEMPLATE)}return A(n,[{key:"init",value:function(e){e.node.failedLoad?this.setupFailed():this.setupLoading()}},{key:"setupFailed",value:function(){var e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingError","ERR")}},{key:"setupLoading",value:function(){var e=Rb("groupLoading",this.gridOptionsService,null);e&&this.eLoadingIcon.appendChild(e);var t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingOoo","Loading")}},{key:"refresh",value:function(e){return!1}},{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this)}}]),n}(Zb);LS.TEMPLATE='<div class="ag-loading">\n            <span class="ag-loading-icon" ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" ref="eLoadingText"></span>\n        </div>',IS([Jb("eLoadingIcon")],LS.prototype,"eLoadingIcon",void 0),IS([Jb("eLoadingText")],LS.prototype,"eLoadingText",void 0);var MS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this)}return A(n,[{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this)}},{key:"init",value:function(e){var t,r=null!==(t=this.gridOptionsService.get("overlayLoadingTemplate"))&&void 0!==t?t:n.DEFAULT_LOADING_OVERLAY_TEMPLATE,i=this.localeService.getLocaleTextFunc(),o=r.replace("[LOADING...]",i("loadingOoo","Loading..."));this.setTemplate(o)}}]),n}(Zb);MS.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span class="ag-overlay-loading-center">[LOADING...]</span>';var GS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this)}return A(n,[{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this)}},{key:"init",value:function(e){var t,r=null!==(t=this.gridOptionsService.get("overlayNoRowsTemplate"))&&void 0!==t?t:n.DEFAULT_NO_ROWS_TEMPLATE,i=this.localeService.getLocaleTextFunc(),o=r.replace("[NO_ROWS_TO_SHOW]",i("noRowsToShow","No Rows To Show"));this.setTemplate(o)}}]),n}(Zb);GS.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center">[NO_ROWS_TO_SHOW]</span>';var BS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,'<div class="ag-tooltip"></div>')}return A(n,[{key:"init",value:function(e){var t=e.value;this.getGui().innerHTML=ry(t)}}]),n}(iS),jS=function(){function e(){T(this,e)}return A(e,[{key:"getTemplate",value:function(){return'<ag-input-number-field class="ag-cell-editor" ref="eInput"></ag-input-number-field>'}},{key:"init",value:function(e,t){this.eInput=e,this.params=t,null!=t.max&&e.setMax(t.max),null!=t.min&&e.setMin(t.min),null!=t.precision&&e.setPrecision(t.precision),null!=t.step&&e.setStep(t.step),t.showStepperButtons&&e.getInputElement().classList.add("ag-number-field-input-stepper")}},{key:"getValue",value:function(){var e=this.eInput.getValue();if(!fg(e)&&!fg(this.params.value))return this.params.value;var t=this.params.parseValue(e);if(null==t)return t;if("string"===typeof t){if(""===t)return null;t=Number(t)}return isNaN(t)?null:t}},{key:"getStartValue",value:function(){return this.params.value}}]),e}(),HS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,new jS)}return A(n)}(cS),VS=function(){function e(){T(this,e)}return A(e,[{key:"getTemplate",value:function(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}},{key:"init",value:function(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}},{key:"getValue",value:function(){var e=this.eInput.getDate();return fg(e)||fg(this.params.value)?null!==e&&void 0!==e?e:null:this.params.value}},{key:"getStartValue",value:function(){var e=this.params.value;if(e instanceof Date)return Iw(e,!1)}}]),e}(),WS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,new VS)}return A(n)}(cS),zS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},US=function(){function e(t){T(this,e),this.getDataTypeService=t}return A(e,[{key:"getTemplate",value:function(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}},{key:"init",value:function(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}},{key:"getValue",value:function(){var e=this.formatDate(this.eInput.getDate());return fg(e)||fg(this.params.value)?this.params.parseValue(null!==e&&void 0!==e?e:""):this.params.value}},{key:"getStartValue",value:function(){var e,t;return Iw(null!==(t=this.parseDate(null!==(e=this.params.value)&&void 0!==e?e:void 0))&&void 0!==t?t:null,!1)}},{key:"parseDate",value:function(e){return this.getDataTypeService().getDateParserFunction()(e)}},{key:"formatDate",value:function(e){return this.getDataTypeService().getDateFormatterFunction()(e)}}]),e}(),KS=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),e=t.call(this,new US((function(){return e.dataTypeService})))}return A(n)}(cS);zS([nm("dataTypeService")],KS.prototype,"dataTypeService",void 0);var qS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},XS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,n.TEMPLATE)}return A(n,[{key:"init",value:function(e){var t=this;this.params=e,this.updateCheckbox(e),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.addManagedListener(this.eCheckbox.getInputElement(),"click",(function(e){if(Nm(e),!t.eCheckbox.isDisabled()){var n=t.eCheckbox.getValue();t.onCheckboxChanged(n)}})),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",(function(e){Nm(e)}));var n=this.gridOptionsService.getDocument();this.addManagedListener(this.params.eGridCell,"keydown",(function(e){if(e.key===_b.SPACE&&!t.eCheckbox.isDisabled()){t.params.eGridCell===n.activeElement&&t.eCheckbox.toggle();var r=t.eCheckbox.getValue();t.onCheckboxChanged(r),e.preventDefault()}}))}},{key:"refresh",value:function(e){return this.params=e,this.updateCheckbox(e),!0}},{key:"updateCheckbox",value:function(e){var t,n,r,i,o=!0;if(e.node.group&&e.column){var a=e.column.getColId();a.startsWith(Jm)?i=null==e.value||""===e.value?void 0:"true"===e.value:e.node.aggData&&void 0!==e.node.aggData[a]?i=null!==(t=e.value)&&void 0!==t?t:void 0:o=!1}else i=null!==(n=e.value)&&void 0!==n?n:void 0;if(o){this.eCheckbox.setValue(i);var s=null!=e.disabled?e.disabled:!(null===(r=e.column)||void 0===r?void 0:r.isCellEditable(e.node));this.eCheckbox.setDisabled(s);var l=this.localeService.getLocaleTextFunc(),u=aw(l,i),c=s?u:"".concat(l("ariaToggleCellValue","Press SPACE to toggle cell value")," (").concat(u,")");this.eCheckbox.setInputAriaLabel(c)}else this.eCheckbox.setDisplayed(!1)}},{key:"onCheckboxChanged",value:function(e){var t=this.params,n=t.column,r=t.node,i=t.rowIndex,o=t.value,a={type:Ym.EVENT_CELL_EDITING_STARTED,column:n,colDef:null===n||void 0===n?void 0:n.getColDef(),data:r.data,node:r,rowIndex:i,rowPinned:r.rowPinned,value:o};this.eventService.dispatchEvent(a);var s=this.params.node.setDataValue(this.params.column,e,"edit"),l={type:Ym.EVENT_CELL_EDITING_STOPPED,column:n,colDef:null===n||void 0===n?void 0:n.getColDef(),data:r.data,node:r,rowIndex:i,rowPinned:r.rowPinned,value:o,oldValue:o,newValue:e,valueChanged:s};this.eventService.dispatchEvent(l)}}]),n}(Zb);XS.TEMPLATE='\n        <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">\n            <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n        </div>',qS([Jb("eCheckbox")],XS.prototype,"eCheckbox",void 0);var YS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},QS=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,'\n            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')}return A(n,[{key:"init",value:function(e){var t,n=this;this.params=e;var r=null!==(t=e.value)&&void 0!==t?t:void 0;this.eCheckbox.setValue(r),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(r),this.addManagedListener(this.eCheckbox,kC.EVENT_CHANGED,(function(e){return n.setAriaLabel(e.selected)}))}},{key:"getValue",value:function(){return this.eCheckbox.getValue()}},{key:"focusIn",value:function(){this.eCheckbox.getFocusableElement().focus()}},{key:"afterGuiAttached",value:function(){this.params.cellStartedEdit&&this.focusIn()}},{key:"isPopup",value:function(){return!1}},{key:"setAriaLabel",value:function(e){var t=this.localeService.getLocaleTextFunc(),n=aw(t,e),r=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel("".concat(r," (").concat(n,")"))}}]),n}(iS);YS([Jb("eCheckbox")],QS.prototype,"eCheckbox",void 0);var ZS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},JS=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).agGridDefaults={agDateInput:MC,agColumnHeader:tS,agColumnGroupHeader:rS,agSortIndicator:$C,agTextColumnFloatingFilter:QC,agNumberColumnFloatingFilter:YC,agDateColumnFloatingFilter:IC,agReadOnlyFloatingFilter:tC,agAnimateShowChangeCellRenderer:pS,agAnimateSlideCellRenderer:gS,agGroupCellRenderer:FS,agGroupRowRenderer:FS,agLoadingCellRenderer:LS,agCheckboxCellRenderer:XS,agCellEditor:hS,agTextCellEditor:hS,agNumberCellEditor:HS,agDateCellEditor:WS,agDateStringCellEditor:KS,agSelectCellEditor:lS,agLargeTextCellEditor:aS,agCheckboxCellEditor:QS,agTextColumnFilter:zC,agNumberColumnFilter:VC,agDateColumnFilter:NC,agLoadingOverlay:MS,agNoRowsOverlay:GS,agTooltipComponent:BS},e.enterpriseAgDefaultCompsModule={agSetColumnFilter:Xg.SetFilterModule,agSetColumnFloatingFilter:Xg.SetFilterModule,agMultiColumnFilter:Xg.MultiFilterModule,agMultiColumnFloatingFilter:Xg.MultiFilterModule,agGroupColumnFilter:Xg.RowGroupingModule,agGroupColumnFloatingFilter:Xg.RowGroupingModule,agRichSelect:Xg.RichSelectModule,agRichSelectCellEditor:Xg.RichSelectModule,agDetailCellRenderer:Xg.MasterDetailModule,agSparklineCellRenderer:Xg.SparklinesModule},e.jsComps={},e}return A(n,[{key:"init",value:function(){var e=this;null!=this.gridOptions.components&&Sg(this.gridOptions.components,(function(t,n){return e.registerJsComponent(t,n)}))}},{key:"registerDefaultComponent",value:function(e,t){this.agGridDefaults[e]?console.error("Trying to overwrite a default component. You should call registerComponent"):this.agGridDefaults[e]=t}},{key:"registerJsComponent",value:function(e,t){this.jsComps[e]=t}},{key:"retrieve",value:function(e,t){var n=this,r=function(e,t){return{componentFromFramework:t,component:e}},i=this.getFrameworkOverrides().frameworkComponent(t,this.gridOptions.components);if(null!=i)return r(i,!0);var o=this.jsComps[t];if(o)return r(o,this.getFrameworkOverrides().isFrameworkComponent(o));var a=this.agGridDefaults[t];if(a)return r(a,!1);var s=this.enterpriseAgDefaultCompsModule[t];return s?Qg.__assertRegistered(s,"AG Grid '".concat(e,"' component: ").concat(t),this.context.getGridId()):Lg((function(){n.warnAboutMissingComponent(e,t)}),"MissingComp"+t),null}},{key:"warnAboutMissingComponent",value:function(e,t){var n=[].concat(wt(Object.keys(this.agGridDefaults).filter((function(e){return!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(e)}))),wt(Object.keys(this.jsComps))),r=fy(t,n,!0,.8);console.warn("AG Grid: Could not find '".concat(t,"' component. It was configured as \"").concat(e,": '").concat(t,"'\" but it wasn't found in the list of registered components.")),r.length>0&&console.warn("         Did you mean: [".concat(r.slice(0,3),"]?")),console.warn("If using a custom component check it has been registered as described in: https://ag-grid.com/javascript-data-grid/components/")}}]),n}(Vm);ZS([nm("gridOptions")],JS.prototype,"gridOptions",void 0),ZS([$g],JS.prototype,"init",null),JS=ZS([tm("userComponentRegistry")],JS);var $S={propertyName:"dateComponent",cellRenderer:!1},eE={propertyName:"headerComponent",cellRenderer:!1},tE={propertyName:"headerGroupComponent",cellRenderer:!1},nE={propertyName:"cellRenderer",cellRenderer:!0},rE={propertyName:"cellEditor",cellRenderer:!1},iE={propertyName:"innerRenderer",cellRenderer:!0},oE={propertyName:"loadingOverlayComponent",cellRenderer:!1},aE={propertyName:"noRowsOverlayComponent",cellRenderer:!1},sE={propertyName:"tooltipComponent",cellRenderer:!1},lE={propertyName:"filter",cellRenderer:!1},uE={propertyName:"floatingFilterComponent",cellRenderer:!1},cE={propertyName:"toolPanel",cellRenderer:!1},dE={propertyName:"statusPanel",cellRenderer:!1},hE={propertyName:"fullWidthCellRenderer",cellRenderer:!0},fE={propertyName:"loadingCellRenderer",cellRenderer:!0},pE={propertyName:"groupRowRenderer",cellRenderer:!0},vE={propertyName:"detailCellRenderer",cellRenderer:!0},gE=function(){function e(){T(this,e)}return A(e,null,[{key:"getFloatingFilterType",value:function(e){return this.filterToFloatingFilterMapping[e]}}]),e}();gE.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"};var mE,yE=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},wE=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"getHeaderCompDetails",value:function(e,t){return this.getCompDetails(e,eE,"agColumnHeader",t)}},{key:"getHeaderGroupCompDetails",value:function(e){var t=e.columnGroup.getColGroupDef();return this.getCompDetails(t,tE,"agColumnGroupHeader",e)}},{key:"getFullWidthCellRendererDetails",value:function(e){return this.getCompDetails(this.gridOptions,hE,null,e,!0)}},{key:"getFullWidthLoadingCellRendererDetails",value:function(e){return this.getCompDetails(this.gridOptions,fE,"agLoadingCellRenderer",e,!0)}},{key:"getFullWidthGroupCellRendererDetails",value:function(e){return this.getCompDetails(this.gridOptions,pE,"agGroupRowRenderer",e,!0)}},{key:"getFullWidthDetailCellRendererDetails",value:function(e){return this.getCompDetails(this.gridOptions,vE,"agDetailCellRenderer",e,!0)}},{key:"getInnerRendererDetails",value:function(e,t){return this.getCompDetails(e,iE,null,t)}},{key:"getFullWidthGroupRowInnerCellRenderer",value:function(e,t){return this.getCompDetails(e,iE,null,t)}},{key:"getCellRendererDetails",value:function(e,t){return this.getCompDetails(e,nE,null,t)}},{key:"getCellEditorDetails",value:function(e,t){return this.getCompDetails(e,rE,"agCellEditor",t,!0)}},{key:"getFilterDetails",value:function(e,t,n){return this.getCompDetails(e,lE,n,t,!0)}},{key:"getDateCompDetails",value:function(e){return this.getCompDetails(this.gridOptions,$S,"agDateInput",e,!0)}},{key:"getLoadingOverlayCompDetails",value:function(e){return this.getCompDetails(this.gridOptions,oE,"agLoadingOverlay",e,!0)}},{key:"getNoRowsOverlayCompDetails",value:function(e){return this.getCompDetails(this.gridOptions,aE,"agNoRowsOverlay",e,!0)}},{key:"getTooltipCompDetails",value:function(e){return this.getCompDetails(e.colDef,sE,"agTooltipComponent",e,!0)}},{key:"getSetFilterCellRendererDetails",value:function(e,t){return this.getCompDetails(e,nE,null,t)}},{key:"getFloatingFilterCompDetails",value:function(e,t,n){return this.getCompDetails(e,uE,n,t)}},{key:"getToolPanelCompDetails",value:function(e,t){return this.getCompDetails(e,cE,null,t,!0)}},{key:"getStatusPanelCompDetails",value:function(e,t){return this.getCompDetails(e,dE,null,t,!0)}},{key:"getCompDetails",value:function(e,t,n,r){var i=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.propertyName,s=t.cellRenderer,l=this.getCompKeys(e,t,r),u=l.compName,c=l.jsComp,d=l.fwComp,h=l.paramsFromSelector,f=l.popupFromSelector,p=l.popupPositionFromSelector,v=function(e){var t=i.userComponentRegistry.retrieve(a,e);t&&(c=t.componentFromFramework?void 0:t.component,d=t.componentFromFramework?t.component:void 0)};if(null!=u&&v(u),null==c&&null==d&&null!=n&&v(n),c&&s&&!this.agComponentUtils.doesImplementIComponent(c)&&(c=this.agComponentUtils.adaptFunction(a,c)),c||d){var g=this.mergeParamsWithApplicationProvidedParams(e,t,r,h),m=null==c,y=c||d;return{componentFromFramework:m,componentClass:y,params:g,type:t,popupFromSelector:f,popupPositionFromSelector:p,newAgStackInstance:function(){return i.newAgStackInstance(y,m,g,t)}}}o&&console.error("AG Grid: Could not find component ".concat(u,", did you forget to configure this component?"))}},{key:"getCompKeys",value:function(e,t,n){var r,i,o,a,s,l,u=this,c=t.propertyName;if(e){var d=e,h=d[c+"Selector"],f=h?h(n):null,p=function(e){if("string"===typeof e)r=e;else if(null!=e&&!0!==e){u.getFrameworkOverrides().isFrameworkComponent(e)?o=e:i=e}};f?(p(f.component),a=f.params,s=f.popup,l=f.popupPosition):p(d[c])}return{compName:r,jsComp:i,fwComp:o,paramsFromSelector:a,popupFromSelector:s,popupPositionFromSelector:l}}},{key:"newAgStackInstance",value:function(e,t,n,r){var i,o=r.propertyName;if(!t)i=new e;else{var a=this.componentMetadataProvider.retrieve(o);i=this.frameworkComponentWrapper.wrap(e,a.mandatoryMethodList,a.optionalMethodList,r)}var s=this.initComponent(i,n);return null==s?Ub.resolve(i):s.then((function(){return i}))}},{key:"mergeParamsWithApplicationProvidedParams",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i={context:this.gridOptionsService.context,columnApi:this.gridOptionsService.columnApi,api:this.gridOptionsService.api};Og(i,n);var o=e&&e[t.propertyName+"Params"];"function"===typeof o?Og(i,o(n)):"object"===typeof o&&Og(i,o);return Og(i,r),i}},{key:"initComponent",value:function(e,t){if(this.context.createBean(e),null!=e.init)return e.init(t)}},{key:"getDefaultFloatingFilterType",value:function(e,t){if(null==e)return null;var n=null,r=this.getCompKeys(e,lE),i=r.compName,o=r.jsComp,a=r.fwComp;i?n=gE.getFloatingFilterType(i):null==o&&null==a&&!0===e.filter&&(n=t());return n}}]),n}(Vm);yE([nm("gridOptions")],wE.prototype,"gridOptions",void 0),yE([nm("agComponentUtils")],wE.prototype,"agComponentUtils",void 0),yE([nm("componentMetadataProvider")],wE.prototype,"componentMetadataProvider",void 0),yE([nm("userComponentRegistry")],wE.prototype,"userComponentRegistry",void 0),yE([rm("frameworkComponentWrapper")],wE.prototype,"frameworkComponentWrapper",void 0),wE=yE([tm("userComponentFactory")],wE),function(e){e[e.SINGLE_SHEET=0]="SINGLE_SHEET",e[e.MULTI_SHEET=1]="MULTI_SHEET"}(mE||(mE={}));var bE,CE,SE=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},EE=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).dragEndFunctions=[],e.dragSources=[],e}return A(n,[{key:"removeAllListeners",value:function(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0}},{key:"removeListener",value:function(e){var t=e.dragSource.eElement,n=e.mouseDownListener;if(t.removeEventListener("mousedown",n),e.touchEnabled){var r=e.touchStartListener;t.removeEventListener("touchstart",r,{passive:!0})}}},{key:"removeDragSource",value:function(e){var t=this.dragSources.find((function(t){return t.dragSource===e}));t&&(this.removeListener(t),Cm(this.dragSources,t))}},{key:"isDragging",value:function(){return this.dragging}},{key:"addDragSource",value:function(e){var t=this,n=this.onMouseDown.bind(this,e),r=e.eElement,i=e.includeTouch,o=e.stopPropagationForTouch;r.addEventListener("mousedown",n);var a=null,s=this.gridOptionsService.is("suppressTouch");i&&!s&&(a=function(n){Ww(n.target)||(n.cancelable&&(n.preventDefault(),o&&n.stopPropagation()),t.onTouchStart(e,n))},r.addEventListener("touchstart",a,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:n,touchStartListener:a,touchEnabled:!!i})}},{key:"getStartTarget",value:function(){return this.startTarget}},{key:"onTouchStart",value:function(e,t){var n=this;this.currentDragParams=e,this.dragging=!1;var r=t.touches[0];this.touchLastTime=r,this.touchStart=r;var i=function(t){return n.onTouchUp(t,e.eElement)},o=t.target,a=[{target:this.gridOptionsService.getRootNode(),type:"touchmove",listener:function(e){e.cancelable&&e.preventDefault()},options:{passive:!1}},{target:o,type:"touchmove",listener:function(t){return n.onTouchMove(t,e.eElement)},options:{passive:!0}},{target:o,type:"touchend",listener:i,options:{passive:!0}},{target:o,type:"touchcancel",listener:i,options:{passive:!0}}];this.addTemporaryEvents(a),0===e.dragStartPixels&&this.onCommonMove(r,this.touchStart,e.eElement)}},{key:"onMouseDown",value:function(e,t){var n=this,r=t;if((!e.skipMouseEvent||!e.skipMouseEvent(t))&&!r._alreadyProcessedByDragService&&(r._alreadyProcessedByDragService=!0,0===t.button)){this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;var i=this.gridOptionsService.getRootNode(),o=[{target:i,type:"mousemove",listener:function(t){return n.onMouseMove(t,e.eElement)}},{target:i,type:"mouseup",listener:function(t){return n.onMouseUp(t,e.eElement)}},{target:i,type:"contextmenu",listener:function(e){return e.preventDefault()}}];this.addTemporaryEvents(o),0===e.dragStartPixels&&this.onMouseMove(t,e.eElement)}}},{key:"addTemporaryEvents",value:function(e){e.forEach((function(e){var t=e.target,n=e.type,r=e.listener,i=e.options;t.addEventListener(n,r,i)})),this.dragEndFunctions.push((function(){e.forEach((function(e){var t=e.target,n=e.type,r=e.listener,i=e.options;t.removeEventListener(n,r,i)}))}))}},{key:"isEventNearStartEvent",value:function(e,t){var n=this.currentDragParams.dragStartPixels;return Lb(e,t,fg(n)?n:4)}},{key:"getFirstActiveTouch",value:function(e){for(var t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}},{key:"onCommonMove",value:function(e,t,n){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(e,t))return;this.dragging=!0;var r={type:Ym.EVENT_DRAG_STARTED,target:n};this.eventService.dispatchEvent(r),this.currentDragParams.onDragStart(t),this.currentDragParams.onDragging(t)}this.currentDragParams.onDragging(e)}},{key:"onTouchMove",value:function(e,t){var n=this.getFirstActiveTouch(e.touches);n&&this.onCommonMove(n,this.touchStart,t)}},{key:"onMouseMove",value:function(e,t){this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}},{key:"shouldPreventMouseEvent",value:function(e){var t=this.gridOptionsService.is("enableCellTextSelection"),n=gw(),r="mousemove"===e.type;return(t&&r||n)&&e.cancelable&&this.mouseEventService.isEventFromThisGrid(e)&&!this.isOverFormFieldElement(e)}},{key:"isOverFormFieldElement",value:function(e){var t=e.target,n=null===t||void 0===t?void 0:t.tagName.toLocaleLowerCase();return!!(null===n||void 0===n?void 0:n.match("^a$|textarea|input|select|button"))}},{key:"onTouchUp",value:function(e,t){var n=this.getFirstActiveTouch(e.changedTouches);n||(n=this.touchLastTime),this.onUpCommon(n,t)}},{key:"onMouseUp",value:function(e,t){this.onUpCommon(e,t)}},{key:"onUpCommon",value:function(e,t){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(e);var n={type:Ym.EVENT_DRAG_STOPPED,target:t};this.eventService.dispatchEvent(n)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach((function(e){return e()})),this.dragEndFunctions.length=0}}]),n}(Vm);SE([nm("mouseEventService")],EE.prototype,"mouseEventService",void 0),SE([em],EE.prototype,"removeAllListeners",null),EE=SE([tm("dragService")],EE),function(e){e[e.Above=0]="Above",e[e.Below=1]="Below"}(bE||(bE={})),function(e){e.EVERYTHING="group",e.FILTER="filter",e.SORT="sort",e.MAP="map",e.AGGREGATE="aggregate",e.FILTER_AGGREGATES="filter_aggregates",e.PIVOT="pivot",e.NOTHING="nothing"}(CE||(CE={}));var kE=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};function xE(e){var t=e;return null!=t&&null!=t.getFrameworkComponentInstance?t.getFrameworkComponentInstance():e}var TE=function(){function e(){T(this,e),this.detailGridInfoMap={},this.destroyCalled=!1}return A(e,[{key:"registerOverlayWrapperComp",value:function(e){this.overlayWrapperComp=e}},{key:"registerSideBarComp",value:function(e){this.sideBarComp=e}},{key:"init",value:function(){var e=this;switch(this.rowModel.getType()){case"clientSide":this.clientSideRowModel=this.rowModel;break;case"infinite":this.infiniteRowModel=this.rowModel;break;case"serverSide":this.serverSideRowModel=this.rowModel}this.ctrlsService.whenReady((function(){e.gridBodyCtrl=e.ctrlsService.getGridBodyCtrl()}))}},{key:"__getAlignedGridService",value:function(){return this.alignedGridsService}},{key:"__getContext",value:function(){return this.context}},{key:"getSetterMethod",value:function(e){return"set".concat(e.charAt(0).toUpperCase()).concat(e.substring(1))}},{key:"__setProperty",value:function(e,t){this.gridOptionsService.set(e,t);var n=this.getSetterMethod(e);this[n]&&this[n](t)}},{key:"getGridId",value:function(){return this.context.getGridId()}},{key:"addDetailGridInfo",value:function(e,t){this.detailGridInfoMap[e]=t}},{key:"removeDetailGridInfo",value:function(e){this.detailGridInfoMap[e]=void 0}},{key:"getDetailGridInfo",value:function(e){return this.detailGridInfoMap[e]}},{key:"forEachDetailGridInfo",value:function(e){var t=0;Sg(this.detailGridInfoMap,(function(n,r){fg(r)&&(e(r,t),t++)}))}},{key:"getDataAsCsv",value:function(e){if(Qg.__assertRegistered(Xg.CsvExportModule,"api.getDataAsCsv",this.context.getGridId()))return this.csvCreator.getDataAsCsv(e)}},{key:"exportDataAsCsv",value:function(e){Qg.__assertRegistered(Xg.CsvExportModule,"api.exportDataAsCSv",this.context.getGridId())&&this.csvCreator.exportDataAsCsv(e)}},{key:"getExcelExportMode",value:function(e){var t=this.gridOptionsService.get("defaultExcelExportParams");return Object.assign({exportMode:"xlsx"},t,e).exportMode}},{key:"assertNotExcelMultiSheet",value:function(e,t){if(!Qg.__assertRegistered(Xg.ExcelExportModule,"api."+e,this.context.getGridId()))return!1;var n=this.getExcelExportMode(t);return this.excelCreator.getFactoryMode(n)!==mE.MULTI_SHEET||(console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1)}},{key:"getDataAsExcel",value:function(e){if(this.assertNotExcelMultiSheet("getDataAsExcel",e))return this.excelCreator.getDataAsExcel(e)}},{key:"exportDataAsExcel",value:function(e){this.assertNotExcelMultiSheet("exportDataAsExcel",e)&&this.excelCreator.exportDataAsExcel(e)}},{key:"getSheetDataForExcel",value:function(e){if(Qg.__assertRegistered(Xg.ExcelExportModule,"api.getSheetDataForExcel",this.context.getGridId())){var t=this.getExcelExportMode(e);return this.excelCreator.setFactoryMode(mE.MULTI_SHEET,t),this.excelCreator.getSheetDataForExcel(e)}}},{key:"getMultipleSheetsAsExcel",value:function(e){if(Qg.__assertRegistered(Xg.ExcelExportModule,"api.getMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.getMultipleSheetsAsExcel(e)}},{key:"exportMultipleSheetsAsExcel",value:function(e){if(Qg.__assertRegistered(Xg.ExcelExportModule,"api.exportMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.exportMultipleSheetsAsExcel(e)}},{key:"setGridAriaProperty",value:function(e,t){if(e){var n=this.ctrlsService.getGridBodyCtrl().getGui(),r="aria-".concat(e);null===t?n.removeAttribute(r):n.setAttribute(r,t)}}},{key:"logMissingRowModel",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];console.error("AG Grid: api.".concat(e," can only be called when gridOptions.rowModelType is ").concat(n.join(" or ")))}},{key:"setServerSideDatasource",value:function(e){this.serverSideRowModel?this.serverSideRowModel.setDatasource(e):this.logMissingRowModel("setServerSideDatasource","serverSide")}},{key:"setCacheBlockSize",value:function(e){this.serverSideRowModel?(this.gridOptionsService.set("cacheBlockSize",e),this.serverSideRowModel.resetRootStore()):this.logMissingRowModel("setCacheBlockSize","serverSide")}},{key:"setDatasource",value:function(e){this.gridOptionsService.isRowModelType("infinite")?this.rowModel.setDatasource(e):this.logMissingRowModel("setDatasource","infinite")}},{key:"setViewportDatasource",value:function(e){this.gridOptionsService.isRowModelType("viewport")?this.rowModel.setViewportDatasource(e):this.logMissingRowModel("setViewportDatasource","viewport")}},{key:"setRowData",value:function(e){null==this.immutableService?this.logMissingRowModel("setRowData","clientSide"):this.immutableService.isActive()?this.immutableService.setRowData(e):(this.selectionService.reset(),this.clientSideRowModel.setRowData(e))}},{key:"setPinnedTopRowData",value:function(e){this.pinnedRowModel.setPinnedTopRowData(e)}},{key:"setPinnedBottomRowData",value:function(e){this.pinnedRowModel.setPinnedBottomRowData(e)}},{key:"getPinnedTopRowCount",value:function(){return this.pinnedRowModel.getPinnedTopRowCount()}},{key:"getPinnedBottomRowCount",value:function(){return this.pinnedRowModel.getPinnedBottomRowCount()}},{key:"getPinnedTopRow",value:function(e){return this.pinnedRowModel.getPinnedTopRow(e)}},{key:"getPinnedBottomRow",value:function(e){return this.pinnedRowModel.getPinnedBottomRow(e)}},{key:"setColumnDefs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.columnModel.setColumnDefs(e,t),this.gridOptionsService.set("columnDefs",e,!0,{source:t})}},{key:"setAutoGroupColumnDef",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.gridOptionsService.set("autoGroupColumnDef",e,!0,{source:t})}},{key:"setDefaultColDef",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.gridOptionsService.set("defaultColDef",e,!0,{source:t})}},{key:"setColumnTypes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.gridOptionsService.set("columnTypes",e,!0,{source:t})}},{key:"expireValueCache",value:function(){this.valueCache.expire()}},{key:"getVerticalPixelRange",value:function(){return this.gridBodyCtrl.getScrollFeature().getVScrollPosition()}},{key:"getHorizontalPixelRange",value:function(){return this.gridBodyCtrl.getScrollFeature().getHScrollPosition()}},{key:"setAlwaysShowHorizontalScroll",value:function(e){this.gridOptionsService.set("alwaysShowHorizontalScroll",e)}},{key:"setAlwaysShowVerticalScroll",value:function(e){this.gridOptionsService.set("alwaysShowVerticalScroll",e)}},{key:"refreshCells",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.rowRenderer.refreshCells(e)}},{key:"flashCells",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.rowRenderer.flashCells(e)}},{key:"redrawRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e?e.rowNodes:void 0;this.rowRenderer.redrawRows(t)}},{key:"setFunctionsReadOnly",value:function(e){this.gridOptionsService.set("functionsReadOnly",e)}},{key:"refreshHeader",value:function(){this.ctrlsService.getHeaderRowContainerCtrls().forEach((function(e){return e.refresh()}))}},{key:"isAnyFilterPresent",value:function(){return this.filterManager.isAnyFilterPresent()}},{key:"isColumnFilterPresent",value:function(){return this.filterManager.isColumnFilterPresent()||this.filterManager.isAggregateFilterPresent()}},{key:"isQuickFilterPresent",value:function(){return this.filterManager.isQuickFilterPresent()}},{key:"getModel",value:function(){return this.rowModel}},{key:"setRowNodeExpanded",value:function(e,t,n){e&&(n&&e.parent&&-1!==e.parent.level&&this.setRowNodeExpanded(e.parent,t,n),e.setExpanded(t))}},{key:"onGroupExpandedOrCollapsed",value:function(){pg(this.clientSideRowModel)?this.logMissingRowModel("onGroupExpandedOrCollapsed","clientSide"):this.clientSideRowModel.refreshModel({step:CE.MAP})}},{key:"refreshClientSideRowModel",value:function(e){pg(this.clientSideRowModel)?this.logMissingRowModel("refreshClientSideRowModel","clientSide"):this.clientSideRowModel.refreshModel(e)}},{key:"isAnimationFrameQueueEmpty",value:function(){return this.animationFrameService.isQueueEmpty()}},{key:"flushAllAnimationFrames",value:function(){this.animationFrameService.flushAllFrames()}},{key:"getRowNode",value:function(e){return this.rowModel.getRowNode(e)}},{key:"getSizesForCurrentTheme",value:function(){return{rowHeight:this.gridOptionsService.getRowHeightAsNumber(),headerHeight:this.columnModel.getHeaderHeight()}}},{key:"expandAll",value:function(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!0):this.serverSideRowModel?this.serverSideRowModel.expandAll(!0):this.logMissingRowModel("expandAll","clientSide","serverSide")}},{key:"collapseAll",value:function(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!1):this.serverSideRowModel?this.serverSideRowModel.expandAll(!1):this.logMissingRowModel("expandAll","clientSide","serverSide")}},{key:"addRenderedRowListener",value:function(e,t,n){this.rowRenderer.addRenderedRowListener(e,t,n)}},{key:"getQuickFilter",value:function(){return this.gridOptionsService.get("quickFilterText")}},{key:"setQuickFilter",value:function(e){this.gridOptionsService.set("quickFilterText",e)}},{key:"setExcludeHiddenColumnsFromQuickFilter",value:function(e){my("30","setExcludeHiddenColumnsFromQuickFilter",void 0,"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `setIncludeHiddenColumnsInQuickFilter`"),this.setIncludeHiddenColumnsInQuickFilter(!e)}},{key:"setIncludeHiddenColumnsInQuickFilter",value:function(e){this.gridOptionsService.set("includeHiddenColumnsInQuickFilter",e)}},{key:"setNodesSelected",value:function(e){var t=e.nodes.every((function(e){return e.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),!1):void 0!==e.id||(console.warn("AG Grid: cannot select node until id for node is known"),!1)}));if(t){var n=e.nodes,r=e.source,i=e.newValue,o=n;this.selectionService.setNodesSelected({nodes:o,source:null!==r&&void 0!==r?r:"api",newValue:i})}}},{key:"selectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"apiSelectAll";this.selectionService.selectAllRowNodes({source:e})}},{key:"deselectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"apiSelectAll";this.selectionService.deselectAllRowNodes({source:e})}},{key:"selectAllFiltered",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"apiSelectAllFiltered";this.selectionService.selectAllRowNodes({source:e,justFiltered:!0})}},{key:"deselectAllFiltered",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"apiSelectAllFiltered";this.selectionService.deselectAllRowNodes({source:e,justFiltered:!0})}},{key:"getServerSideSelectionState",value:function(){return pg(this.serverSideRowModel)?(this.logMissingRowModel("getServerSideSelectionState","serverSide"),null):this.selectionService.getServerSideSelectionState()}},{key:"setServerSideSelectionState",value:function(e){pg(this.serverSideRowModel)?this.logMissingRowModel("setServerSideSelectionState","serverSide"):this.selectionService.setServerSideSelectionState(e)}},{key:"selectAllOnCurrentPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"apiSelectAllCurrentPage";this.selectionService.selectAllRowNodes({source:e,justCurrentPage:!0})}},{key:"deselectAllOnCurrentPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"apiSelectAllCurrentPage";this.selectionService.deselectAllRowNodes({source:e,justCurrentPage:!0})}},{key:"sizeColumnsToFit",value:function(e){this.gridBodyCtrl.sizeColumnsToFit(e)}},{key:"showLoadingOverlay",value:function(){this.overlayWrapperComp.showLoadingOverlay()}},{key:"showNoRowsOverlay",value:function(){this.overlayWrapperComp.showNoRowsOverlay()}},{key:"hideOverlay",value:function(){this.overlayWrapperComp.hideOverlay()}},{key:"getSelectedNodes",value:function(){return this.selectionService.getSelectedNodes()}},{key:"getSelectedRows",value:function(){return this.selectionService.getSelectedRows()}},{key:"getBestCostNodeSelection",value:function(){if(!pg(this.clientSideRowModel))return this.selectionService.getBestCostNodeSelection();this.logMissingRowModel("getBestCostNodeSelection","clientSide")}},{key:"getRenderedNodes",value:function(){return this.rowRenderer.getRenderedNodes()}},{key:"ensureColumnVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(e,t)}},{key:"ensureIndexVisible",value:function(e,t){this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(e,t)}},{key:"ensureNodeVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(e,t)}},{key:"forEachLeafNode",value:function(e){pg(this.clientSideRowModel)?this.logMissingRowModel("forEachLeafNode","clientSide"):this.clientSideRowModel.forEachLeafNode(e)}},{key:"forEachNode",value:function(e,t){this.rowModel.forEachNode(e,t)}},{key:"forEachNodeAfterFilter",value:function(e){pg(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilter","clientSide"):this.clientSideRowModel.forEachNodeAfterFilter(e)}},{key:"forEachNodeAfterFilterAndSort",value:function(e){pg(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilterAndSort","clientSide"):this.clientSideRowModel.forEachNodeAfterFilterAndSort(e)}},{key:"getFilterInstance",value:function(e,t){var n=this.getFilterInstanceImpl(e,(function(e){if(t){var n=xE(e);t(n)}}));return xE(n)}},{key:"getFilterInstanceImpl",value:function(e,t){var n=this.columnModel.getPrimaryColumn(e);if(n){var r=this.filterManager.getFilterComponent(n,"NO_UI"),i=r&&r.resolveNow(null,(function(e){return e}));return i?setTimeout(t,0,i):r&&r.then((function(e){t(e)})),i}}},{key:"destroyFilter",value:function(e){var t=this.columnModel.getPrimaryColumn(e);if(t)return this.filterManager.destroyFilter(t,"api")}},{key:"getStatusPanel",value:function(e){if(Qg.__assertRegistered(Xg.StatusBarModule,"api.getStatusPanel",this.context.getGridId()))return xE(this.statusBarService.getStatusPanel(e))}},{key:"getColumnDef",value:function(e){var t=this.columnModel.getPrimaryColumn(e);return t?t.getColDef():null}},{key:"getColumnDefs",value:function(){return this.columnModel.getColumnDefs()}},{key:"onFilterChanged",value:function(){this.filterManager.onFilterChanged()}},{key:"onSortChanged",value:function(){this.sortController.onSortChanged("api")}},{key:"setFilterModel",value:function(e){this.filterManager.setFilterModel(e)}},{key:"getFilterModel",value:function(){return this.filterManager.getFilterModel()}},{key:"getFocusedCell",value:function(){return this.focusService.getFocusedCell()}},{key:"clearFocusedCell",value:function(){return this.focusService.clearFocusedCell()}},{key:"setFocusedCell",value:function(e,t,n){this.focusService.setFocusedCell({rowIndex:e,column:t,rowPinned:n,forceBrowserFocus:!0})}},{key:"setSuppressRowDrag",value:function(e){this.gridOptionsService.set("suppressRowDrag",e)}},{key:"setSuppressMoveWhenRowDragging",value:function(e){this.gridOptionsService.set("suppressMoveWhenRowDragging",e)}},{key:"setSuppressRowClickSelection",value:function(e){this.gridOptionsService.set("suppressRowClickSelection",e)}},{key:"addRowDropZone",value:function(e){this.gridBodyCtrl.getRowDragFeature().addRowDropZone(e)}},{key:"removeRowDropZone",value:function(e){var t=this.dragAndDropService.findExternalZone(e);t&&this.dragAndDropService.removeDropTarget(t)}},{key:"getRowDropZoneParams",value:function(e){return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(e)}},{key:"setHeaderHeight",value:function(e){this.gridOptionsService.set("headerHeight",e)}},{key:"setDomLayout",value:function(e){this.gridOptionsService.set("domLayout",e)}},{key:"setEnableCellTextSelection",value:function(e){this.gridBodyCtrl.setCellTextSelection(e)}},{key:"setFillHandleDirection",value:function(e){this.gridOptionsService.set("fillHandleDirection",e)}},{key:"setGroupHeaderHeight",value:function(e){this.gridOptionsService.set("groupHeaderHeight",e)}},{key:"setFloatingFiltersHeight",value:function(e){this.gridOptionsService.set("floatingFiltersHeight",e)}},{key:"setPivotHeaderHeight",value:function(e){this.gridOptionsService.set("pivotHeaderHeight",e)}},{key:"setPivotGroupHeaderHeight",value:function(e){this.gridOptionsService.set("pivotGroupHeaderHeight",e)}},{key:"setPivotMode",value:function(e){this.columnModel.setPivotMode(e)}},{key:"setAnimateRows",value:function(e){this.gridOptionsService.set("animateRows",e)}},{key:"setIsExternalFilterPresent",value:function(e){this.gridOptionsService.set("isExternalFilterPresent",e)}},{key:"setDoesExternalFilterPass",value:function(e){this.gridOptionsService.set("doesExternalFilterPass",e)}},{key:"setNavigateToNextCell",value:function(e){this.gridOptionsService.set("navigateToNextCell",e)}},{key:"setTabToNextCell",value:function(e){this.gridOptionsService.set("tabToNextCell",e)}},{key:"setTabToNextHeader",value:function(e){this.gridOptionsService.set("tabToNextHeader",e)}},{key:"setNavigateToNextHeader",value:function(e){this.gridOptionsService.set("navigateToNextHeader",e)}},{key:"setRowGroupPanelShow",value:function(e){this.gridOptionsService.set("rowGroupPanelShow",e)}},{key:"setGetGroupRowAgg",value:function(e){this.gridOptionsService.set("getGroupRowAgg",e)}},{key:"setGetBusinessKeyForNode",value:function(e){this.gridOptionsService.set("getBusinessKeyForNode",e)}},{key:"setGetChildCount",value:function(e){this.gridOptionsService.set("getChildCount",e)}},{key:"setProcessRowPostCreate",value:function(e){this.gridOptionsService.set("processRowPostCreate",e)}},{key:"setGetRowId",value:function(e){this.gridOptionsService.set("getRowId",e)}},{key:"setGetRowClass",value:function(e){this.gridOptionsService.set("getRowClass",e)}},{key:"setIsFullWidthRow",value:function(e){this.gridOptionsService.set("isFullWidthRow",e)}},{key:"setIsRowSelectable",value:function(e){this.gridOptionsService.set("isRowSelectable",e)}},{key:"setIsRowMaster",value:function(e){this.gridOptionsService.set("isRowMaster",e)}},{key:"setPostSortRows",value:function(e){this.gridOptionsService.set("postSortRows",e)}},{key:"setGetDocument",value:function(e){this.gridOptionsService.set("getDocument",e)}},{key:"setGetContextMenuItems",value:function(e){this.gridOptionsService.set("getContextMenuItems",e)}},{key:"setGetMainMenuItems",value:function(e){this.gridOptionsService.set("getMainMenuItems",e)}},{key:"setProcessCellForClipboard",value:function(e){this.gridOptionsService.set("processCellForClipboard",e)}},{key:"setSendToClipboard",value:function(e){this.gridOptionsService.set("sendToClipboard",e)}},{key:"setProcessCellFromClipboard",value:function(e){this.gridOptionsService.set("processCellFromClipboard",e)}},{key:"setProcessSecondaryColDef",value:function(e){my("28.0","setProcessSecondaryColDef","setProcessPivotResultColDef"),this.setProcessPivotResultColDef(e)}},{key:"setProcessSecondaryColGroupDef",value:function(e){my("28.0","setProcessSecondaryColGroupDef","setProcessPivotResultColGroupDef"),this.setProcessPivotResultColGroupDef(e)}},{key:"setProcessPivotResultColDef",value:function(e){this.gridOptionsService.set("processPivotResultColDef",e)}},{key:"setProcessPivotResultColGroupDef",value:function(e){this.gridOptionsService.set("processPivotResultColGroupDef",e)}},{key:"setPostProcessPopup",value:function(e){this.gridOptionsService.set("postProcessPopup",e)}},{key:"setInitialGroupOrderComparator",value:function(e){this.gridOptionsService.set("initialGroupOrderComparator",e)}},{key:"setGetChartToolbarItems",value:function(e){this.gridOptionsService.set("getChartToolbarItems",e)}},{key:"setPaginationNumberFormatter",value:function(e){this.gridOptionsService.set("paginationNumberFormatter",e)}},{key:"setGetServerSideStoreParams",value:function(e){my("28.0","setGetServerSideStoreParams","setGetServerSideGroupLevelParams"),this.setGetServerSideGroupLevelParams(e)}},{key:"setGetServerSideGroupLevelParams",value:function(e){this.gridOptionsService.set("getServerSideGroupLevelParams",e)}},{key:"setIsServerSideGroupOpenByDefault",value:function(e){this.gridOptionsService.set("isServerSideGroupOpenByDefault",e)}},{key:"setIsApplyServerSideTransaction",value:function(e){this.gridOptionsService.set("isApplyServerSideTransaction",e)}},{key:"setIsServerSideGroup",value:function(e){this.gridOptionsService.set("isServerSideGroup",e)}},{key:"setGetServerSideGroupKey",value:function(e){this.gridOptionsService.set("getServerSideGroupKey",e)}},{key:"setGetRowStyle",value:function(e){this.gridOptionsService.set("getRowStyle",e)}},{key:"setGetRowHeight",value:function(e){this.gridOptionsService.set("getRowHeight",e)}},{key:"assertSideBarLoaded",value:function(e){return Qg.__assertRegistered(Xg.SideBarModule,"api."+e,this.context.getGridId())}},{key:"isSideBarVisible",value:function(){return this.assertSideBarLoaded("isSideBarVisible")&&this.sideBarComp.isDisplayed()}},{key:"setSideBarVisible",value:function(e){this.assertSideBarLoaded("setSideBarVisible")&&this.sideBarComp.setDisplayed(e)}},{key:"setSideBarPosition",value:function(e){this.assertSideBarLoaded("setSideBarPosition")&&this.sideBarComp.setSideBarPosition(e)}},{key:"openToolPanel",value:function(e){this.assertSideBarLoaded("openToolPanel")&&this.sideBarComp.openToolPanel(e,"api")}},{key:"closeToolPanel",value:function(){this.assertSideBarLoaded("closeToolPanel")&&this.sideBarComp.close("api")}},{key:"getOpenedToolPanel",value:function(){return this.assertSideBarLoaded("getOpenedToolPanel")?this.sideBarComp.openedItem():null}},{key:"refreshToolPanel",value:function(){this.assertSideBarLoaded("refreshToolPanel")&&this.sideBarComp.refresh()}},{key:"isToolPanelShowing",value:function(){return this.assertSideBarLoaded("isToolPanelShowing")&&this.sideBarComp.isToolPanelShowing()}},{key:"getToolPanelInstance",value:function(e){if(this.assertSideBarLoaded("getToolPanelInstance"))return xE(this.sideBarComp.getToolPanelInstance(e))}},{key:"getSideBar",value:function(){if(this.assertSideBarLoaded("getSideBar"))return this.sideBarComp.getDef()}},{key:"setSideBar",value:function(e){this.gridOptionsService.set("sideBar",e)}},{key:"setSuppressClipboardPaste",value:function(e){this.gridOptionsService.set("suppressClipboardPaste",e)}},{key:"resetRowHeights",value:function(){if(fg(this.clientSideRowModel)){if(this.columnModel.isAutoRowHeightActive())return void console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");this.clientSideRowModel.resetRowHeights()}}},{key:"setGroupRemoveSingleChildren",value:function(e){this.gridOptionsService.set("groupRemoveSingleChildren",e)}},{key:"setGroupRemoveLowestSingleChildren",value:function(e){this.gridOptionsService.set("groupRemoveLowestSingleChildren",e)}},{key:"setGroupDisplayType",value:function(e){this.gridOptionsService.set("groupDisplayType",e)}},{key:"setRowClass",value:function(e){this.gridOptionsService.set("rowClass",e)}},{key:"setDeltaSort",value:function(e){this.gridOptionsService.set("deltaSort",e)}},{key:"setRowCount",value:function(e,t){if(this.serverSideRowModel)return this.columnModel.isRowGroupEmpty()?void this.serverSideRowModel.setRowCount(e,t):void console.error("AG Grid: setRowCount cannot be used while using row grouping.");this.infiniteRowModel?this.infiniteRowModel.setRowCount(e,t):this.logMissingRowModel("setRowCount","infinite","serverSide")}},{key:"onRowHeightChanged",value:function(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()}},{key:"getValue",value:function(e,t){var n=this.columnModel.getPrimaryColumn(e);return pg(n)&&(n=this.columnModel.getGridColumn(e)),pg(n)?null:this.valueService.getValue(n,t)}},{key:"addEventListener",value:function(e,t){var n=this.gridOptionsService.useAsyncEvents();this.eventService.addEventListener(e,t,n)}},{key:"addGlobalListener",value:function(e){var t=this.gridOptionsService.useAsyncEvents();this.eventService.addGlobalListener(e,t)}},{key:"removeEventListener",value:function(e,t){var n=this.gridOptionsService.useAsyncEvents();this.eventService.removeEventListener(e,t,n)}},{key:"removeGlobalListener",value:function(e){var t=this.gridOptionsService.useAsyncEvents();this.eventService.removeGlobalListener(e,t)}},{key:"dispatchEvent",value:function(e){this.eventService.dispatchEvent(e)}},{key:"destroy",value:function(){if(!this.destroyCalled){this.destroyCalled=!0;var e=this.ctrlsService.getGridCtrl();e&&e.destroyGridUi(),this.context.destroy()}}},{key:"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",value:function(){setTimeout(Ng.bind(window,this,"Grid API"),100)}},{key:"warnIfDestroyed",value:function(e){return this.destroyCalled&&console.warn("AG Grid: Grid API method ".concat(e," was called on a grid that was destroyed.")),this.destroyCalled}},{key:"resetQuickFilter",value:function(){this.warnIfDestroyed("resetQuickFilter")||this.filterManager.resetQuickFilterCache()}},{key:"getCellRanges",value:function(){return this.rangeService?this.rangeService.getCellRanges():(Qg.__assertRegistered(Xg.RangeSelectionModule,"api.getCellRanges",this.context.getGridId()),null)}},{key:"addCellRange",value:function(e){this.rangeService?this.rangeService.addCellRange(e):Qg.__assertRegistered(Xg.RangeSelectionModule,"api.addCellRange",this.context.getGridId())}},{key:"clearRangeSelection",value:function(){this.rangeService&&this.rangeService.removeAllCellRanges(),Qg.__assertRegistered(Xg.RangeSelectionModule,"gridApi.clearRangeSelection",this.context.getGridId())}},{key:"undoCellEditing",value:function(){this.undoRedoService.undo("api")}},{key:"redoCellEditing",value:function(){this.undoRedoService.redo("api")}},{key:"getCurrentUndoSize",value:function(){return this.undoRedoService.getCurrentUndoStackSize()}},{key:"getCurrentRedoSize",value:function(){return this.undoRedoService.getCurrentRedoStackSize()}},{key:"getChartModels",value:function(){if(Qg.__assertRegistered(Xg.GridChartsModule,"api.getChartModels",this.context.getGridId()))return this.chartService.getChartModels()}},{key:"getChartRef",value:function(e){if(Qg.__assertRegistered(Xg.GridChartsModule,"api.getChartRef",this.context.getGridId()))return this.chartService.getChartRef(e)}},{key:"getChartImageDataURL",value:function(e){if(Qg.__assertRegistered(Xg.GridChartsModule,"api.getChartImageDataURL",this.context.getGridId()))return this.chartService.getChartImageDataURL(e)}},{key:"downloadChart",value:function(e){if(Qg.__assertRegistered(Xg.GridChartsModule,"api.downloadChart",this.context.getGridId()))return this.chartService.downloadChart(e)}},{key:"openChartToolPanel",value:function(e){if(Qg.__assertRegistered(Xg.GridChartsModule,"api.openChartToolPanel",this.context.getGridId()))return this.chartService.openChartToolPanel(e)}},{key:"closeChartToolPanel",value:function(e){if(Qg.__assertRegistered(Xg.GridChartsModule,"api.closeChartToolPanel",this.context.getGridId()))return this.chartService.closeChartToolPanel(e.chartId)}},{key:"createRangeChart",value:function(e){if(Qg.__assertRegistered(Xg.GridChartsModule,"api.createRangeChart",this.context.getGridId()))return this.chartService.createRangeChart(e)}},{key:"createPivotChart",value:function(e){if(Qg.__assertRegistered(Xg.GridChartsModule,"api.createPivotChart",this.context.getGridId()))return this.chartService.createPivotChart(e)}},{key:"createCrossFilterChart",value:function(e){if(Qg.__assertRegistered(Xg.GridChartsModule,"api.createCrossFilterChart",this.context.getGridId()))return this.chartService.createCrossFilterChart(e)}},{key:"updateChart",value:function(e){Qg.__assertRegistered(Xg.GridChartsModule,"api.updateChart",this.context.getGridId())&&this.chartService.updateChart(e)}},{key:"restoreChart",value:function(e,t){if(Qg.__assertRegistered(Xg.GridChartsModule,"api.restoreChart",this.context.getGridId()))return this.chartService.restoreChart(e,t)}},{key:"copyToClipboard",value:function(e){Qg.__assertRegistered(Xg.ClipboardModule,"api.copyToClipboard",this.context.getGridId())&&this.clipboardService.copyToClipboard(e)}},{key:"cutToClipboard",value:function(e){Qg.__assertRegistered(Xg.ClipboardModule,"api.cutToClipboard",this.context.getGridId())&&this.clipboardService.cutToClipboard(e,"api")}},{key:"copySelectedRowsToClipboard",value:function(e){Qg.__assertRegistered(Xg.ClipboardModule,"api.copySelectedRowsToClipboard",this.context.getGridId())&&this.clipboardService.copySelectedRowsToClipboard(e)}},{key:"copySelectedRangeToClipboard",value:function(e){Qg.__assertRegistered(Xg.ClipboardModule,"api.copySelectedRangeToClipboard",this.context.getGridId())&&this.clipboardService.copySelectedRangeToClipboard(e)}},{key:"copySelectedRangeDown",value:function(){Qg.__assertRegistered(Xg.ClipboardModule,"api.copySelectedRangeDown",this.context.getGridId())&&this.clipboardService.copyRangeDown()}},{key:"pasteFromClipboard",value:function(){Qg.__assertRegistered(Xg.ClipboardModule,"api.pasteFromClipboard",this.context.getGridId())&&this.clipboardService.pasteFromClipboard()}},{key:"showColumnMenuAfterButtonClick",value:function(e,t){var n=this.columnModel.getGridColumn(e);this.menuFactory.showMenuAfterButtonClick(n,t,"columnMenu")}},{key:"showColumnMenuAfterMouseClick",value:function(e,t){var n=this.columnModel.getGridColumn(e);n||(n=this.columnModel.getPrimaryColumn(e)),n?this.menuFactory.showMenuAfterMouseEvent(n,t):console.error("AG Grid: column '".concat(e,"' not found"))}},{key:"hidePopupMenu",value:function(){this.contextMenuFactory&&this.contextMenuFactory.hideActiveMenu(),this.menuFactory.hideActiveMenu()}},{key:"setPopupParent",value:function(e){this.gridOptionsService.set("popupParent",e)}},{key:"tabToNextCell",value:function(e){return this.navigationService.tabToNextCell(!1,e)}},{key:"tabToPreviousCell",value:function(e){return this.navigationService.tabToNextCell(!0,e)}},{key:"getCellRendererInstances",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.rowRenderer.getCellRendererInstances(e).map(xE)}},{key:"getCellEditorInstances",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.rowRenderer.getCellEditorInstances(e).map(xE)}},{key:"getEditingCells",value:function(){return this.rowRenderer.getEditingCells()}},{key:"stopEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.rowRenderer.stopEditing(e)}},{key:"startEditingCell",value:function(e){var t=this.columnModel.getGridColumn(e.colKey);if(t){var n={rowIndex:e.rowIndex,rowPinned:e.rowPinned||null,column:t};null==e.rowPinned&&this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(e.rowIndex);var r=this.navigationService.getCellByPosition(n);r&&r.startRowOrCellEdit(e.key)}else console.warn("AG Grid: no column found for ".concat(e.colKey))}},{key:"addAggFunc",value:function(e,t){this.aggFuncService&&this.aggFuncService.addAggFunc(e,t)}},{key:"addAggFuncs",value:function(e){this.aggFuncService&&this.aggFuncService.addAggFuncs(e)}},{key:"clearAggFuncs",value:function(){this.aggFuncService&&this.aggFuncService.clear()}},{key:"applyServerSideTransaction",value:function(e){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransaction(e);this.logMissingRowModel("applyServerSideTransaction","serverSide")}},{key:"applyServerSideTransactionAsync",value:function(e,t){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransactionAsync(e,t);this.logMissingRowModel("applyServerSideTransactionAsync","serverSide")}},{key:"retryServerSideLoads",value:function(){this.serverSideRowModel?this.serverSideRowModel.retryLoads():this.logMissingRowModel("retryServerSideLoads","serverSide")}},{key:"flushServerSideAsyncTransactions",value:function(){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.flushAsyncTransactions();this.logMissingRowModel("flushServerSideAsyncTransactions","serverSide")}},{key:"applyTransaction",value:function(e){if(this.clientSideRowModel)return this.clientSideRowModel.updateRowData(e);this.logMissingRowModel("applyTransaction","clientSide")}},{key:"applyTransactionAsync",value:function(e,t){this.clientSideRowModel?this.clientSideRowModel.batchUpdateRowData(e,t):this.logMissingRowModel("applyTransactionAsync","clientSide")}},{key:"flushAsyncTransactions",value:function(){this.clientSideRowModel?this.clientSideRowModel.flushAsyncTransactions():this.logMissingRowModel("flushAsyncTransactions","clientSide")}},{key:"setSuppressModelUpdateAfterUpdateTransaction",value:function(e){this.gridOptionsService.set("suppressModelUpdateAfterUpdateTransaction",e)}},{key:"refreshInfiniteCache",value:function(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():this.logMissingRowModel("refreshInfiniteCache","infinite")}},{key:"purgeInfiniteCache",value:function(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():this.logMissingRowModel("purgeInfiniteCache","infinite")}},{key:"refreshServerSide",value:function(e){this.serverSideRowModel?this.serverSideRowModel.refreshStore(e):this.logMissingRowModel("refreshServerSide","serverSide")}},{key:"refreshServerSideStore",value:function(e){return my("28.0","refreshServerSideStore","refreshServerSide"),this.refreshServerSide(e)}},{key:"getServerSideStoreState",value:function(){return my("28.0","getServerSideStoreState","getServerSideGroupLevelState"),this.getServerSideGroupLevelState()}},{key:"getServerSideGroupLevelState",value:function(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(this.logMissingRowModel("getServerSideGroupLevelState","serverSide"),[])}},{key:"getInfiniteRowCount",value:function(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();this.logMissingRowModel("getInfiniteRowCount","infinite")}},{key:"isLastRowIndexKnown",value:function(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();this.logMissingRowModel("isLastRowIndexKnown","infinite")}},{key:"getCacheBlockState",value:function(){return this.rowNodeBlockLoader.getBlockState()}},{key:"getFirstDisplayedRow",value:function(){return this.rowRenderer.getFirstVirtualRenderedRow()}},{key:"getLastDisplayedRow",value:function(){return this.rowRenderer.getLastVirtualRenderedRow()}},{key:"getDisplayedRowAtIndex",value:function(e){return this.rowModel.getRow(e)}},{key:"getDisplayedRowCount",value:function(){return this.rowModel.getRowCount()}},{key:"setDataTypeDefinitions",value:function(e){this.gridOptionsService.set("dataTypeDefinitions",e)}},{key:"setPagination",value:function(e){this.gridOptionsService.set("pagination",e)}},{key:"paginationIsLastPageFound",value:function(){return this.paginationProxy.isLastPageFound()}},{key:"paginationGetPageSize",value:function(){return this.paginationProxy.getPageSize()}},{key:"paginationSetPageSize",value:function(e){this.gridOptionsService.set("paginationPageSize",e)}},{key:"paginationGetCurrentPage",value:function(){return this.paginationProxy.getCurrentPage()}},{key:"paginationGetTotalPages",value:function(){return this.paginationProxy.getTotalPages()}},{key:"paginationGetRowCount",value:function(){return this.paginationProxy.getMasterRowCount()}},{key:"paginationGoToNextPage",value:function(){this.paginationProxy.goToNextPage()}},{key:"paginationGoToPreviousPage",value:function(){this.paginationProxy.goToPreviousPage()}},{key:"paginationGoToFirstPage",value:function(){this.paginationProxy.goToFirstPage()}},{key:"paginationGoToLastPage",value:function(){this.paginationProxy.goToLastPage()}},{key:"paginationGoToPage",value:function(e){this.paginationProxy.goToPage(e)}}]),e}();kE([rm("immutableService")],TE.prototype,"immutableService",void 0),kE([rm("csvCreator")],TE.prototype,"csvCreator",void 0),kE([rm("excelCreator")],TE.prototype,"excelCreator",void 0),kE([nm("rowRenderer")],TE.prototype,"rowRenderer",void 0),kE([nm("navigationService")],TE.prototype,"navigationService",void 0),kE([nm("filterManager")],TE.prototype,"filterManager",void 0),kE([nm("columnModel")],TE.prototype,"columnModel",void 0),kE([nm("selectionService")],TE.prototype,"selectionService",void 0),kE([nm("gridOptionsService")],TE.prototype,"gridOptionsService",void 0),kE([nm("valueService")],TE.prototype,"valueService",void 0),kE([nm("alignedGridsService")],TE.prototype,"alignedGridsService",void 0),kE([nm("eventService")],TE.prototype,"eventService",void 0),kE([nm("pinnedRowModel")],TE.prototype,"pinnedRowModel",void 0),kE([nm("context")],TE.prototype,"context",void 0),kE([nm("rowModel")],TE.prototype,"rowModel",void 0),kE([nm("sortController")],TE.prototype,"sortController",void 0),kE([nm("paginationProxy")],TE.prototype,"paginationProxy",void 0),kE([nm("focusService")],TE.prototype,"focusService",void 0),kE([nm("dragAndDropService")],TE.prototype,"dragAndDropService",void 0),kE([rm("rangeService")],TE.prototype,"rangeService",void 0),kE([rm("clipboardService")],TE.prototype,"clipboardService",void 0),kE([rm("aggFuncService")],TE.prototype,"aggFuncService",void 0),kE([nm("menuFactory")],TE.prototype,"menuFactory",void 0),kE([rm("contextMenuFactory")],TE.prototype,"contextMenuFactory",void 0),kE([nm("valueCache")],TE.prototype,"valueCache",void 0),kE([nm("animationFrameService")],TE.prototype,"animationFrameService",void 0),kE([rm("statusBarService")],TE.prototype,"statusBarService",void 0),kE([rm("chartService")],TE.prototype,"chartService",void 0),kE([rm("undoRedoService")],TE.prototype,"undoRedoService",void 0),kE([rm("rowNodeBlockLoader")],TE.prototype,"rowNodeBlockLoader",void 0),kE([rm("ssrmTransactionManager")],TE.prototype,"serverSideTransactionManager",void 0),kE([nm("ctrlsService")],TE.prototype,"ctrlsService",void 0),kE([$g],TE.prototype,"init",null),kE([em],TE.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),TE=kE([tm("gridApi")],TE);var RE,AE=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},_E=RE=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).allColumnFilters=new Map,e.allColumnListeners=new Map,e.activeAggregateFilters=[],e.activeColumnFilters=[],e.quickFilter=null,e.quickFilterParts=null,e.processingFilterChange=!1,e}return A(n,[{key:"init",value:function(){var e=this;this.addManagedListener(this.eventService,Ym.EVENT_GRID_COLUMNS_CHANGED,(function(){return e.onColumnsChanged()})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_VALUE_CHANGED,(function(){return e.refreshFiltersForAggregations()})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_PIVOT_CHANGED,(function(){return e.refreshFiltersForAggregations()})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_PIVOT_MODE_CHANGED,(function(){e.refreshFiltersForAggregations(),e.resetQuickFilterCache()})),this.addManagedListener(this.eventService,Ym.EVENT_NEW_COLUMNS_LOADED,(function(){return e.resetQuickFilterCache()})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return e.resetQuickFilterCache()})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_VISIBLE,(function(){e.gridOptionsService.is("includeHiddenColumnsInQuickFilter")||e.resetQuickFilterCache()})),this.addManagedPropertyListener("quickFilterText",(function(t){return e.setQuickFilter(t.currentValue)})),this.addManagedPropertyListener("includeHiddenColumnsInQuickFilter",(function(){return e.onIncludeHiddenColumnsInQuickFilterChanged()})),this.quickFilter=this.parseQuickFilter(this.gridOptionsService.get("quickFilterText")),this.setQuickFilterParts(),this.allowShowChangeAfterFilter=this.gridOptionsService.is("allowShowChangeAfterFilter"),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",(function(){return e.updateAggFiltering()}))}},{key:"isExternalFilterPresentCallback",value:function(){var e=this.gridOptionsService.getCallback("isExternalFilterPresent");return"function"===typeof e&&e({})}},{key:"doesExternalFilterPass",value:function(e){var t=this.gridOptionsService.get("doesExternalFilterPass");return"function"===typeof t&&t(e)}},{key:"setQuickFilterParts",value:function(){this.quickFilterParts=this.quickFilter?this.quickFilter.split(" "):null}},{key:"setFilterModel",value:function(e){var t=this,n=[],r=this.getFilterModel();if(e){var i=Bb(Object.keys(e));this.allColumnFilters.forEach((function(r,o){var a=e[o];n.push(t.setModelOnFilterWrapper(r.filterPromise,a)),i.delete(o)})),i.forEach((function(r){var i=t.columnModel.getPrimaryColumn(r)||t.columnModel.getGridColumn(r);if(i)if(i.isFilterAllowed()){var o=t.getOrCreateFilterWrapper(i,"NO_UI");o?n.push(t.setModelOnFilterWrapper(o.filterPromise,e[r])):console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: "+r)}else console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+r);else console.warn("AG Grid: setFilterModel() - no column found for colId: "+r)}))}else this.allColumnFilters.forEach((function(e){n.push(t.setModelOnFilterWrapper(e.filterPromise,null))}));Ub.all(n).then((function(){var e=t.getFilterModel(),n=[];t.allColumnFilters.forEach((function(t,i){var o=r?r[i]:null,a=e?e[i]:null;Vb.jsonEquals(o,a)||n.push(t.column)})),n.length>0&&t.onFilterChanged({columns:n})}))}},{key:"setModelOnFilterWrapper",value:function(e,t){return new Ub((function(n){e.then((function(e){"function"!==typeof e.setModel&&(console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel"),n()),(e.setModel(t)||Ub.resolve()).then((function(){return n()}))}))}))}},{key:"getFilterModel",value:function(){var e={};return this.allColumnFilters.forEach((function(t,n){var r=t.filterPromise.resolveNow(null,(function(e){return e}));if(null==r)return null;if("function"===typeof r.getModel){var i=r.getModel();fg(i)&&(e[n]=i)}else console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel")})),e}},{key:"isColumnFilterPresent",value:function(){return this.activeColumnFilters.length>0}},{key:"isAggregateFilterPresent",value:function(){return!!this.activeAggregateFilters.length}},{key:"isExternalFilterPresent",value:function(){return this.externalFilterPresent}},{key:"doAggregateFiltersPass",value:function(e,t){return this.doColumnFiltersPass(e,t,!0)}},{key:"updateActiveFilters",value:function(){var e=this;this.activeColumnFilters.length=0,this.activeAggregateFilters.length=0;var t=function(e){return!!e&&(e.isFilterActive?e.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1))},n=!!this.gridOptionsService.getGroupAggFiltering();this.allColumnFilters.forEach((function(r){if(r.filterPromise.resolveNow(!1,t)){var i=r.filterPromise.resolveNow(null,(function(e){return e}));!function(t){if(!t.isPrimary())return!0;var r=!e.columnModel.isPivotActive();return!(!t.isValueActive()||!r)&&(!!e.columnModel.isPivotMode()||n)}(r.column)?e.activeColumnFilters.push(i):e.activeAggregateFilters.push(i)}}))}},{key:"updateFilterFlagInColumns",value:function(e,t){this.allColumnFilters.forEach((function(n){var r=n.filterPromise.resolveNow(!1,(function(e){return e.isFilterActive()}));n.column.setFilterActive(r,e,t)}))}},{key:"isAnyFilterPresent",value:function(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()}},{key:"doColumnFiltersPass",value:function(e,t,n){for(var r=e.data,i=e.aggData,o=n?this.activeAggregateFilters:this.activeColumnFilters,a=n?i:r,s=0;s<o.length;s++){var l=o[s];if(null!=l&&l!==t){if("function"!==typeof l.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!l.doesFilterPass({node:e,data:a}))return!1}}return!0}},{key:"parseQuickFilter",value:function(e){return fg(e)?this.gridOptionsService.isRowModelType("clientSide")?e.toUpperCase():(console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model"),null):null}},{key:"setQuickFilter",value:function(e){if(null==e||"string"===typeof e){var t=this.parseQuickFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setQuickFilterParts(),this.onFilterChanged())}else console.warn("AG Grid - setQuickFilter() only supports string inputs, received: ".concat(typeof e))}},{key:"resetQuickFilterCache",value:function(){this.rowModel.forEachNode((function(e){return e.quickFilterAggregateText=null}))}},{key:"onIncludeHiddenColumnsInQuickFilterChanged",value:function(){this.columnModel.refreshQuickFilterColumns(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.onFilterChanged()}},{key:"refreshFiltersForAggregations",value:function(){this.gridOptionsService.getGroupAggFiltering()&&this.onFilterChanged()}},{key:"callOnFilterChangedOutsideRenderCycle",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=function(){return e.onFilterChanged(t)};this.rowRenderer.isRefreshInProgress()?setTimeout(n,0):n()}},{key:"onFilterChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.filterInstance,n=e.additionalEventAttributes,r=e.columns;this.updateDependantFilters(),this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",n),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.allColumnFilters.forEach((function(e){e.filterPromise&&e.filterPromise.then((function(e){e&&e!==t&&e.onAnyFilterChanged&&e.onAnyFilterChanged()}))}));var i={type:Ym.EVENT_FILTER_CHANGED,columns:r||[]};n&&Og(i,n),this.processingFilterChange=!0,this.eventService.dispatchEvent(i),this.processingFilterChange=!1}},{key:"isSuppressFlashingCellsBecauseFiltering",value:function(){return!this.allowShowChangeAfterFilter&&this.processingFilterChange}},{key:"isQuickFilterPresent",value:function(){return null!==this.quickFilter}},{key:"updateAggFiltering",value:function(){this.aggFiltering=!!this.gridOptionsService.getGroupAggFiltering()}},{key:"isAggregateQuickFilterPresent",value:function(){return this.isQuickFilterPresent()&&(this.aggFiltering||this.columnModel.isPivotMode())}},{key:"isNonAggregateQuickFilterPresent",value:function(){return this.isQuickFilterPresent()&&!(this.aggFiltering||this.columnModel.isPivotMode())}},{key:"doesRowPassOtherFilters",value:function(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}},{key:"doesRowPassQuickFilterNoCache",value:function(e,t){var n=this;return this.columnModel.getAllColumnsForQuickFilter().some((function(r){var i=n.getQuickFilterTextForColumn(r,e);return fg(i)&&i.indexOf(t)>=0}))}},{key:"doesRowPassQuickFilterCache",value:function(e,t){return e.quickFilterAggregateText||this.aggregateRowForQuickFilter(e),e.quickFilterAggregateText.indexOf(t)>=0}},{key:"doesRowPassQuickFilter",value:function(e){var t=this,n=this.gridOptionsService.is("cacheQuickFilter");return this.quickFilterParts.every((function(r){return n?t.doesRowPassQuickFilterCache(e,r):t.doesRowPassQuickFilterNoCache(e,r)}))}},{key:"doesRowPassAggregateFilters",value:function(e){return!(this.isAggregateQuickFilterPresent()&&!this.doesRowPassQuickFilter(e.rowNode))&&!(this.isAggregateFilterPresent()&&!this.doAggregateFiltersPass(e.rowNode,e.filterInstanceToSkip))}},{key:"doesRowPassFilter",value:function(e){return!(this.isNonAggregateQuickFilterPresent()&&!this.doesRowPassQuickFilter(e.rowNode))&&(!(this.isExternalFilterPresent()&&!this.doesExternalFilterPass(e.rowNode))&&!(this.isColumnFilterPresent()&&!this.doColumnFiltersPass(e.rowNode,e.filterInstanceToSkip)))}},{key:"getQuickFilterTextForColumn",value:function(e,t){var n=this.valueService.getValue(e,t,!0),r=e.getColDef();if(r.getQuickFilterText){var i={value:n,node:t,data:t.data,column:e,colDef:r,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};n=r.getQuickFilterText(i)}return fg(n)?n.toString().toUpperCase():null}},{key:"aggregateRowForQuickFilter",value:function(e){var t=this,n=[];this.columnModel.getAllColumnsForQuickFilter().forEach((function(r){var i=t.getQuickFilterTextForColumn(r,e);fg(i)&&n.push(i)})),e.quickFilterAggregateText=n.join(RE.QUICK_FILTER_SEPARATOR)}},{key:"onNewRowsLoaded",value:function(e){this.allColumnFilters.forEach((function(e){e.filterPromise.then((function(e){e.onNewRowsLoaded&&e.onNewRowsLoaded()}))})),this.updateFilterFlagInColumns(e,{afterDataChange:!0}),this.updateActiveFilters()}},{key:"createValueGetter",value:function(e){var t=this;return function(n){var r=n.node;return t.valueService.getValue(e,r,!0)}}},{key:"getFilterComponent",value:function(e,t){var n;if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])return(null===(n=this.getOrCreateFilterWrapper(e,t))||void 0===n?void 0:n.filterPromise)||null;var r=this.cachedFilter(e);return r?r.filterPromise:null}},{key:"isFilterActive",value:function(e){var t=this.cachedFilter(e);return!!t&&t.filterPromise.resolveNow(!1,(function(e){return e.isFilterActive()}))}},{key:"getOrCreateFilterWrapper",value:function(e,t){var n=this;if(!e.isFilterAllowed())return null;var r=this.cachedFilter(e);if(r)"NO_UI"!==t&&this.putIntoGui(r,t);else{r=this.createFilterWrapper(e,t);var i=e.getColId();this.allColumnFilters.set(i,r),this.allColumnListeners.set(i,this.addManagedListener(e,fm.EVENT_COL_DEF_CHANGED,(function(){return n.checkDestroyFilter(i)})))}return r}},{key:"cachedFilter",value:function(e){return this.allColumnFilters.get(e.getColId())}},{key:"getDefaultFilter",value:function(e){var t;if(Qg.__isRegistered(Xg.SetFilterModule,this.context.getGridId()))t="agSetColumnFilter";else{var n=e.getColDef().cellDataType;t="number"===n?"agNumberColumnFilter":"date"===n||"dateString"===n?"agDateColumnFilter":"agTextColumnFilter"}return t}},{key:"getDefaultFloatingFilter",value:function(e){var t;if(Qg.__isRegistered(Xg.SetFilterModule,this.context.getGridId()))t="agSetColumnFloatingFilter";else{var n=e.getColDef().cellDataType;t="number"===n?"agNumberColumnFloatingFilter":"date"===n||"dateString"===n?"agDateColumnFloatingFilter":"agTextColumnFloatingFilter"}return t}},{key:"createFilterInstance",value:function(e){var t,n=this,r=this.getDefaultFilter(e),i=e.getColDef(),o=Object.assign(Object.assign({},this.createFilterParams(e,i)),{filterModifiedCallback:function(){var r={type:Ym.EVENT_FILTER_MODIFIED,column:e,filterInstance:t};n.eventService.dispatchEvent(r)},filterChangedCallback:function(r){var i={filterInstance:t,additionalEventAttributes:r,columns:[e]};n.callOnFilterChangedOutsideRenderCycle(i)},doesRowPassOtherFilter:function(e){return n.doesRowPassOtherFilters(t,e)}}),a=this.userComponentFactory.getFilterDetails(i,o,r);return a?{filterPromise:function(){var e=a.newAgStackInstance();return e&&e.then((function(e){return t=e})),e},compDetails:a}:{filterPromise:null,compDetails:null}}},{key:"createFilterParams",value:function(e,t){return{column:e,colDef:Eg(t),rowModel:this.rowModel,filterChangedCallback:function(){},filterModifiedCallback:function(){},valueGetter:this.createValueGetter(e),doesRowPassOtherFilter:function(){return!0},api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}}},{key:"createFilterWrapper",value:function(e,t){var n,r={column:e,filterPromise:null,compiledElement:null,guiPromise:Ub.resolve(null),compDetails:null},i=this.createFilterInstance(e),o=i.filterPromise,a=i.compDetails;return r.filterPromise=null!==(n=null===o||void 0===o?void 0:o())&&void 0!==n?n:null,r.compDetails=a,o&&this.putIntoGui(r,t),r}},{key:"putIntoGui",value:function(e,t){var n=this,r=document.createElement("div");r.className="ag-filter",e.guiPromise=new Ub((function(i){e.filterPromise.then((function(o){var a=o.getGui();fg(a)||console.warn("AG Grid: getGui method from filter returned ".concat(a,", it should be a DOM element or an HTML template string.")),"string"===typeof a&&(a=ab(a)),r.appendChild(a),i(r);var s={type:Ym.EVENT_FILTER_OPENED,column:e.column,source:t,eGui:r};n.eventService.dispatchEvent(s)}))}))}},{key:"onColumnsChanged",value:function(){var e=this,t=[];this.allColumnFilters.forEach((function(n,r){(n.column.isPrimary()?e.columnModel.getPrimaryColumn(r):e.columnModel.getGridColumn(r))||(t.push(n.column),e.disposeFilterWrapper(n,"columnChanged"),e.disposeColumnListener(r))})),t.length>0?this.onFilterChanged({columns:t}):this.updateDependantFilters()}},{key:"updateDependantFilters",value:function(){var e=this,t=this.columnModel.getGroupAutoColumns();null===t||void 0===t||t.forEach((function(t){"agGroupColumnFilter"===t.getColDef().filter&&e.getOrCreateFilterWrapper(t,"NO_UI")}))}},{key:"isFilterAllowed",value:function(e){var t,n,r=e.isFilterAllowed();if(!r)return!1;var i=this.allColumnFilters.get(e.getColId());return null===(n=null===(t=null===i||void 0===i?void 0:i.filterPromise)||void 0===t?void 0:t.resolveNow(!0,(function(e){var t,n;return"function"!==typeof(null===(t=e)||void 0===t?void 0:t.isFilterAllowed)||(null===(n=e)||void 0===n?void 0:n.isFilterAllowed())})))||void 0===n||n}},{key:"getFloatingFilterCompDetails",value:function(e,t){var n=this,r=e.getColDef(),i=this.createFilterParams(e,r),o=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(r,lE,i),a=this.userComponentFactory.getDefaultFloatingFilterType(r,(function(){return n.getDefaultFloatingFilter(e)}));null==a&&(a="agReadOnlyFloatingFilter");var s={column:e,filterParams:o,currentParentModel:function(){return n.getCurrentFloatingFilterParentModel(e)},parentFilterInstance:function(t){var r=n.getFilterComponent(e,"NO_UI");null!=r&&r.then((function(e){t(xE(e))}))},showParentFilter:t,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(r,s,a)}},{key:"getCurrentFloatingFilterParentModel",value:function(e){var t=this.getFilterComponent(e,"NO_UI",!1);return t?t.resolveNow(null,(function(e){return e&&e.getModel()})):null}},{key:"destroyFilter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api",n=e.getColId(),r=this.allColumnFilters.get(n);this.disposeColumnListener(n),r&&(this.disposeFilterWrapper(r,t),this.onFilterChanged({columns:[e]}))}},{key:"disposeColumnListener",value:function(e){var t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}},{key:"disposeFilterWrapper",value:function(e,t){var n=this;e.filterPromise.then((function(r){(r.setModel(null)||Ub.resolve()).then((function(){n.getContext().destroyBean(r),e.column.setFilterActive(!1,"filterDestroyed"),n.allColumnFilters.delete(e.column.getColId());var i={type:Ym.EVENT_FILTER_DESTROYED,source:t,column:e.column};n.eventService.dispatchEvent(i)}))}))}},{key:"checkDestroyFilter",value:function(e){var t=this.allColumnFilters.get(e);if(t){var n=t.column,r=(n.isFilterAllowed()?this.createFilterInstance(n):{compDetails:null}).compDetails;(function(e,t){if(!t||!e)return!0;var n=e.componentClass,r=t.componentClass;return!(n===r||(null===n||void 0===n?void 0:n.render)&&(null===r||void 0===r?void 0:r.render)&&n.render===r.render)})(t.compDetails,r)&&this.destroyFilter(n,"columnChanged")}}},{key:"destroy",value:function(){var e=this;cg(D(n.prototype),"destroy",this).call(this),this.allColumnFilters.forEach((function(t){return e.disposeFilterWrapper(t,"gridDestroyed")})),this.allColumnListeners.clear()}}]),n}(Vm);_E.QUICK_FILTER_SEPARATOR="\n",AE([nm("valueService")],_E.prototype,"valueService",void 0),AE([nm("columnModel")],_E.prototype,"columnModel",void 0),AE([nm("rowModel")],_E.prototype,"rowModel",void 0),AE([nm("userComponentFactory")],_E.prototype,"userComponentFactory",void 0),AE([nm("rowRenderer")],_E.prototype,"rowRenderer",void 0),AE([$g],_E.prototype,"init",null),_E=RE=AE([tm("filterManager")],_E);var OE=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this,e)).ctrl=r,i}return A(n,[{key:"getCtrl",value:function(){return this.ctrl}}]),n}(Zb),DE=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},NE=function(e){O(n,e);var t=F(n);function n(e){return T(this,n),t.call(this,n.TEMPLATE,e)}return A(n,[{key:"postConstruct",value:function(){var e=this,t=this.getGui(),n={addOrRemoveCssClass:function(t,n){return e.addOrRemoveCssClass(t,n)},addOrRemoveBodyCssClass:function(t,n){return e.eFloatingFilterBody.classList.toggle(t,n)},setButtonWrapperDisplayed:function(t){return zw(e.eButtonWrapper,t)},setCompDetails:function(t){return e.setCompDetails(t)},getFloatingFilterComp:function(){return e.compPromise},setWidth:function(e){return t.style.width=e},setMenuIcon:function(t){return e.eButtonShowMainFilter.appendChild(t)}};this.ctrl.setComp(n,t,this.eButtonShowMainFilter,this.eFloatingFilterBody)}},{key:"setCompDetails",value:function(e){var t=this;if(!e)return this.destroyFloatingFilterComp(),void(this.compPromise=null);this.compPromise=e.newAgStackInstance(),this.compPromise.then((function(e){return t.afterCompCreated(e)}))}},{key:"destroyFloatingFilterComp",value:function(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}},{key:"afterCompCreated",value:function(e){e&&(this.isAlive()?(this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()):this.destroyBean(e))}}]),n}(OE);NE.TEMPLATE='<div class="ag-header-cell ag-floating-filter" role="gridcell" tabindex="-1">\n            <div ref="eFloatingFilterBody" role="presentation"></div>\n            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">\n                <button type="button" class="ag-button ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>\n            </div>\n        </div>',DE([Jb("eFloatingFilterBody")],NE.prototype,"eFloatingFilterBody",void 0),DE([Jb("eButtonWrapper")],NE.prototype,"eButtonWrapper",void 0),DE([Jb("eButtonShowMainFilter")],NE.prototype,"eButtonShowMainFilter",void 0),DE([$g],NE.prototype,"postConstruct",null),DE([em],NE.prototype,"destroyFloatingFilterComp",null);var PE,FE=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e.AUTO_HEIGHT="ag-layout-auto-height",e.NORMAL="ag-layout-normal",e.PRINT="ag-layout-print"}(PE||(PE={}));var IE=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).view=e,r}return A(n,[{key:"postConstruct",value:function(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}},{key:"updateLayoutClasses",value:function(){var e=this.getDomLayout(),t={autoHeight:"autoHeight"===e,normal:"normal"===e,print:"print"===e},n=t.autoHeight?PE.AUTO_HEIGHT:t.print?PE.PRINT:PE.NORMAL;this.view.updateLayoutClasses(n,t)}},{key:"getDomLayout",value:function(){var e,t=null!==(e=this.gridOptionsService.get("domLayout"))&&void 0!==e?e:"normal";return-1===["normal","print","autoHeight"].indexOf(t)?(Lg((function(){return console.warn("AG Grid: ".concat(t," is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'."))}),"warn about dom layout values"),"normal"):t}}]),n}(Vm);FE([$g],IE.prototype,"postConstruct",null);var LE,ME,GE=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal"}(LE||(LE={})),function(e){e[e.Container=0]="Container",e[e.FakeContainer=1]="FakeContainer"}(ME||(ME={}));var BE=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).lastScrollSource=[null,null],r.scrollLeft=-1,r.nextScrollTop=-1,r.scrollTop=-1,r.eBodyViewport=e,r.resetLastHScrollDebounced=zg((function(){return r.lastScrollSource[LE.Horizontal]=null}),500),r.resetLastVScrollDebounced=zg((function(){return r.lastScrollSource[LE.Vertical]=null}),500),r}return A(n,[{key:"postConstruct",value:function(){var e=this;this.enableRtl=this.gridOptionsService.is("enableRtl"),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady((function(t){e.centerRowContainerCtrl=t.centerRowContainerCtrl,e.onDisplayedColumnsWidthChanged(),e.addScrollListener()}))}},{key:"addScrollListener",value:function(){var e=this.ctrlsService.getFakeHScrollComp(),t=this.ctrlsService.getFakeVScrollComp();this.addManagedListener(this.centerRowContainerCtrl.getViewportElement(),"scroll",this.onHScroll.bind(this)),e.onScrollCallback(this.onFakeHScroll.bind(this));var n=this.gridOptionsService.is("debounceVerticalScrollbar"),r=n?zg(this.onVScroll.bind(this),100):this.onVScroll.bind(this),i=n?zg(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",r),t.onScrollCallback(i)}},{key:"onDisplayedColumnsWidthChanged",value:function(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}},{key:"horizontallyScrollHeaderCenterAndFloatingCenter",value:function(e){if(!(null==this.centerRowContainerCtrl)){void 0===e&&(e=this.centerRowContainerCtrl.getCenterViewportScrollLeft());var t=this.enableRtl?e:-e,n=this.ctrlsService.getTopCenterRowContainerCtrl(),r=this.ctrlsService.getStickyTopCenterRowContainerCtrl(),i=this.ctrlsService.getBottomCenterRowContainerCtrl(),o=this.ctrlsService.getFakeHScrollComp();this.ctrlsService.getHeaderRowContainerCtrl().setHorizontalScroll(-t),i.setContainerTranslateX(t),n.setContainerTranslateX(t),r.setContainerTranslateX(t);var a=this.centerRowContainerCtrl.getViewportElement(),s=this.lastScrollSource[LE.Horizontal]===ME.Container;e=Math.abs(e),s?o.setScrollPosition(e):nb(a,e,this.enableRtl)}}},{key:"isControllingScroll",value:function(e,t){return null==this.lastScrollSource[t]?(this.lastScrollSource[t]=e,!0):this.lastScrollSource[t]===e}},{key:"onFakeHScroll",value:function(){this.isControllingScroll(ME.FakeContainer,LE.Horizontal)&&this.onHScrollCommon(ME.FakeContainer)}},{key:"onHScroll",value:function(){this.isControllingScroll(ME.Container,LE.Horizontal)&&this.onHScrollCommon(ME.Container)}},{key:"onHScrollCommon",value:function(e){var t,n=this.centerRowContainerCtrl.getViewportElement(),r=n.scrollLeft;this.shouldBlockScrollUpdate(LE.Horizontal,r,!0)||(t=e===ME.Container?tb(n,this.enableRtl):this.ctrlsService.getFakeHScrollComp().getScrollPosition(),this.doHorizontalScroll(Math.round(t)),this.resetLastHScrollDebounced())}},{key:"onFakeVScroll",value:function(){this.isControllingScroll(ME.FakeContainer,LE.Vertical)&&this.onVScrollCommon(ME.FakeContainer)}},{key:"onVScroll",value:function(){this.isControllingScroll(ME.Container,LE.Vertical)&&this.onVScrollCommon(ME.Container)}},{key:"onVScrollCommon",value:function(e){var t;t=e===ME.Container?this.eBodyViewport.scrollTop:this.ctrlsService.getFakeVScrollComp().getScrollPosition(),this.shouldBlockScrollUpdate(LE.Vertical,t,!0)||(this.animationFrameService.setScrollTop(t),this.nextScrollTop=t,e===ME.Container?this.ctrlsService.getFakeVScrollComp().setScrollPosition(t):this.eBodyViewport.scrollTop=t,this.gridOptionsService.is("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}},{key:"doHorizontalScroll",value:function(e){var t=this.ctrlsService.getFakeHScrollComp().getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(LE.Horizontal),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.onHorizontalViewportChanged())}},{key:"fireScrollEvent",value:function(e){var t=this,n={type:Ym.EVENT_BODY_SCROLL,direction:e===LE.Horizontal?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(n),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout((function(){var e=Object.assign(Object.assign({},n),{type:Ym.EVENT_BODY_SCROLL_END});t.eventService.dispatchEvent(e)}),100)}},{key:"shouldBlockScrollUpdate",value:function(e,t){return!(arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&!Cw())&&(e===LE.Vertical?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t))}},{key:"shouldBlockVerticalScroll",value:function(e){var t=Yw(this.eBodyViewport),n=this.eBodyViewport.scrollHeight;return e<0||e+t>n}},{key:"shouldBlockHorizontalScroll",value:function(e){var t=this.centerRowContainerCtrl.getCenterWidth(),n=this.centerRowContainerCtrl.getViewportElement().scrollWidth;if(this.enableRtl&&eb()){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>n}},{key:"redrawRowsAfterScroll",value:function(){this.fireScrollEvent(LE.Vertical)}},{key:"onHorizontalViewportChanged",value:function(){this.centerRowContainerCtrl.onHorizontalViewportChanged()}},{key:"checkScrollLeft",value:function(){this.scrollLeft!==this.centerRowContainerCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(ME.Container)}},{key:"scrollGridIfNeeded",value:function(){var e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),e}},{key:"setHorizontalScrollPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.centerRowContainerCtrl.getViewportElement().scrollWidth-this.centerRowContainerCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(LE.Horizontal,e)&&(e=this.enableRtl&&eb()?e>0?0:n:Math.min(Math.max(e,0),n)),nb(this.centerRowContainerCtrl.getViewportElement(),Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}},{key:"setVerticalScrollPosition",value:function(e){this.eBodyViewport.scrollTop=e}},{key:"getVScrollPosition",value:function(){return{top:this.eBodyViewport.scrollTop,bottom:this.eBodyViewport.scrollTop+this.eBodyViewport.offsetHeight}}},{key:"getHScrollPosition",value:function(){return this.centerRowContainerCtrl.getHScrollPosition()}},{key:"isHorizontalScrollShowing",value:function(){return this.centerRowContainerCtrl.isHorizontalScrollShowing()}},{key:"scrollHorizontally",value:function(e){var t=this.centerRowContainerCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowContainerCtrl.getViewportElement().scrollLeft-t}},{key:"scrollToTop",value:function(){this.eBodyViewport.scrollTop=0}},{key:"ensureNodeVisible",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.rowModel.getRowCount(),r=-1,i=0;i<n;i++){var o=this.rowModel.getRow(i);if("function"===typeof e){if(o&&e(o)){r=i;break}}else if(e===o||e===o.data){r=i;break}}r>=0&&this.ensureIndexVisible(r,t)}},{key:"ensureIndexVisible",value:function(e,t){if(!this.gridOptionsService.isDomLayout("print")){var n=this.paginationProxy.getRowCount();if("number"!==typeof e||e<0||e>=n)console.warn("AG Grid: Invalid row index for ensureIndexVisible: "+e);else{this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel")||this.paginationProxy.goToPageWithIndex(e);var r,i=this.ctrlsService.getGridBodyCtrl().getStickyTopHeight(),o=this.paginationProxy.getRow(e);do{var a=o.rowTop,s=o.rowHeight,l=this.paginationProxy.getPixelOffset(),u=o.rowTop-l,c=u+o.rowHeight,d=this.getVScrollPosition(),h=this.heightScaler.getDivStretchOffset(),f=d.top+h,p=d.bottom+h,v=p-f,g=this.heightScaler.getScrollPositionForPixel(u),m=this.heightScaler.getScrollPositionForPixel(c-v),y=Math.min((g+m)/2,u),w=null;"top"===t?w=g:"bottom"===t?w=m:"middle"===t?w=y:f+i>u?w=g-i:p<c&&(w=m),null!==w&&(this.setVerticalScrollPosition(w),this.rowRenderer.redraw()),r=a!==o.rowTop||s!==o.rowHeight}while(r);this.animationFrameService.flushAllFrames()}}}},{key:"ensureColumnVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto",n=this.columnModel.getGridColumn(e);if(n&&!n.isPinned()&&this.columnModel.isColumnDisplayed(n)){var r=this.getPositionedHorizontalScroll(n,t);null!==r&&this.centerRowContainerCtrl.setCenterViewportScrollLeft(r),this.centerRowContainerCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()}}},{key:"getPositionedHorizontalScroll",value:function(e,t){var n=this.isColumnOutsideViewport(e),r=n.columnBeforeStart,i=n.columnAfterEnd,o=this.centerRowContainerCtrl.getCenterWidth()<e.getActualWidth(),a=this.centerRowContainerCtrl.getCenterWidth(),s=this.enableRtl,l=(s?r:i)||o,u=s?i:r;"auto"!==t&&(l="start"===t,u="end"===t);var c="middle"===t;if(l||u||c){var d=this.getColumnBounds(e),h=d.colLeft,f=d.colMiddle,p=d.colRight;return c?f-a/2:l?s?p:h:s?h-a:p-a}return null}},{key:"isColumnOutsideViewport",value:function(e){var t=this.getViewportBounds(),n=t.start,r=t.end,i=this.getColumnBounds(e),o=i.colLeft,a=i.colRight,s=this.enableRtl;return{columnBeforeStart:s?n>a:r<a,columnAfterEnd:s?r<o:n>o}}},{key:"getColumnBounds",value:function(e){var t=this.enableRtl,n=this.columnModel.getBodyContainerWidth(),r=e.getActualWidth(),i=e.getLeft(),o=t?-1:1,a=t?n-i:i;return{colLeft:a,colMiddle:a+r/2*o,colRight:a+r*o}}},{key:"getViewportBounds",value:function(){var e=this.centerRowContainerCtrl.getCenterWidth(),t=this.centerRowContainerCtrl.getCenterViewportScrollLeft();return{start:t,end:e+t,width:e}}}]),n}(Vm);GE([nm("ctrlsService")],BE.prototype,"ctrlsService",void 0),GE([nm("animationFrameService")],BE.prototype,"animationFrameService",void 0),GE([nm("paginationProxy")],BE.prototype,"paginationProxy",void 0),GE([nm("rowModel")],BE.prototype,"rowModel",void 0),GE([nm("rowContainerHeightService")],BE.prototype,"heightScaler",void 0),GE([nm("rowRenderer")],BE.prototype,"rowRenderer",void 0),GE([nm("columnModel")],BE.prototype,"columnModel",void 0),GE([$g],BE.prototype,"postConstruct",null);var jE=function(){function e(t){T(this,e),this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=t.scrollContainer,this.scrollHorizontally=-1!==t.scrollAxis.indexOf("x"),this.scrollVertically=-1!==t.scrollAxis.indexOf("y"),this.scrollByTick=null!=t.scrollByTick?t.scrollByTick:20,t.onScrollCallback&&(this.onScrollCallback=t.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=t.getVerticalPosition,this.setVerticalPosition=t.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=t.getHorizontalPosition,this.setHorizontalPosition=t.setHorizontalPosition),this.shouldSkipVerticalScroll=t.shouldSkipVerticalScroll||function(){return!1},this.shouldSkipHorizontalScroll=t.shouldSkipHorizontalScroll||function(){return!1}}return A(e,[{key:"check",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.shouldSkipVerticalScroll();if(!t||!this.shouldSkipHorizontalScroll()){var n=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=e.clientX<n.left+r,this.tickRight=e.clientX>n.right-r,this.tickUp=e.clientY<n.top+r&&!t,this.tickDown=e.clientY>n.bottom-r&&!t,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}}},{key:"ensureTickingStarted",value:function(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}},{key:"doTick",value:function(){var e;if(this.tickCount++,e=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){var t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){var n=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(n-e),this.tickRight&&this.setHorizontalPosition(n+e)}this.onScrollCallback&&this.onScrollCallback()}},{key:"ensureCleared",value:function(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}}]),e}(),HE=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},VE=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).isMultiRowDrag=!1,r.isGridSorted=!1,r.isGridFiltered=!1,r.isRowGroupActive=!1,r.eContainer=e,r}return A(n,[{key:"postConstruct",value:function(){var e=this;this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel);var t=function(){e.onSortChanged(),e.onFilterChanged(),e.onRowGroupChanged()};this.addManagedListener(this.eventService,Ym.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_MODEL_UPDATED,(function(){t()})),t(),this.ctrlsService.whenReady((function(){var t=e.ctrlsService.getGridBodyCtrl();e.autoScrollService=new jE({scrollContainer:t.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:function(){return t.getScrollFeature().getVScrollPosition().top},setVerticalPosition:function(e){return t.getScrollFeature().setVerticalScrollPosition(e)},onScrollCallback:function(){e.onDragging(e.lastDraggingEvent)}})}))}},{key:"onSortChanged",value:function(){this.isGridSorted=this.sortController.isSortActive()}},{key:"onFilterChanged",value:function(){this.isGridFiltered=this.filterManager.isAnyFilterPresent()}},{key:"onRowGroupChanged",value:function(){var e=this.columnModel.getRowGroupColumns();this.isRowGroupActive=!vg(e)}},{key:"getContainer",value:function(){return this.eContainer}},{key:"isInterestedIn",value:function(e){return e===CS.RowDrag}},{key:"getIconName",value:function(){return this.gridOptionsService.is("rowDragManaged")&&this.shouldPreventRowMove()?xS.ICON_NOT_ALLOWED:xS.ICON_MOVE}},{key:"shouldPreventRowMove",value:function(){return this.isGridSorted||this.isGridFiltered||this.isRowGroupActive}},{key:"getRowNodes",value:function(e){var t=this;if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];var n=this.gridOptionsService.is("rowDragMultiRow"),r=wt(this.selectionService.getSelectedNodes()).sort((function(e,n){return null==e.rowIndex||null==n.rowIndex?0:t.getRowIndexNumber(e)-t.getRowIndexNumber(n)})),i=e.dragItem.rowNode;return n&&-1!==r.indexOf(i)?(this.isMultiRowDrag=!0,r):(this.isMultiRowDrag=!1,[i])}},{key:"onDragEnter",value:function(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent(Ym.EVENT_ROW_DRAG_ENTER,e),this.getRowNodes(e).forEach((function(e){e.setDragging(!0)})),this.onEnterOrDragging(e)}},{key:"onDragging",value:function(e){this.onEnterOrDragging(e)}},{key:"isFromThisGrid",value:function(e){return e.dragSource.dragSourceDomDataKey===this.gridOptionsService.getDomDataKey()}},{key:"isDropZoneWithinThisGrid",value:function(e){var t=this.ctrlsService.getGridBodyCtrl().getGui(),n=e.dropZoneTarget;return!t.contains(n)}},{key:"onEnterOrDragging",value:function(e){this.dispatchGridEvent(Ym.EVENT_ROW_DRAG_MOVE,e),this.lastDraggingEvent=e;var t=this.mouseEventService.getNormalisedPosition(e).y;this.gridOptionsService.is("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)}},{key:"doManagedDrag",value:function(e,t){var n=this.isFromThisGrid(e),r=this.gridOptionsService.is("rowDragManaged"),i=e.dragItem.rowNodes;r&&this.shouldPreventRowMove()||(this.gridOptionsService.is("suppressMoveWhenRowDragging")||!n?this.isDropZoneWithinThisGrid(e)||this.clientSideRowModel.highlightRowAtPixel(i[0],t):this.moveRows(i,t))}},{key:"getRowIndexNumber",value:function(e){return parseInt(ym(e.getRowIndexString().split("-")),10)}},{key:"moveRowAndClearHighlight",value:function(e){var t=this,n=this.clientSideRowModel.getLastHighlightedRowNode(),r=n&&n.highlighted===bE.Below,i=this.mouseEventService.getNormalisedPosition(e).y,o=e.dragItem.rowNodes,a=r?1:0;if(this.isFromThisGrid(e))o.forEach((function(e){e.rowTop<i&&(a-=1)})),this.moveRows(o,i,a);else{var s=this.gridOptionsService.getCallback("getRowId"),l=this.clientSideRowModel.getRowIndexAtPixel(i)+1;this.clientSideRowModel.getHighlightPosition(i)===bE.Above&&l--,this.clientSideRowModel.updateRowData({add:o.map((function(e){return e.data})).filter((function(e){return!t.clientSideRowModel.getRowNode(s?s({data:e,level:0}):e.id)})),addIndex:l})}this.clearRowHighlight()}},{key:"clearRowHighlight",value:function(){this.clientSideRowModel.highlightRowAtPixel(null)}},{key:"moveRows",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.clientSideRowModel.ensureRowsAtPixel(e,t,n)&&(this.focusService.clearFocusedCell(),this.rangeService&&this.rangeService.removeAllCellRanges())}},{key:"addRowDropZone",value:function(e){var t=this;if(e.getContainer())if(this.dragAndDropService.findExternalZone(e))console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");else{var n={getContainer:e.getContainer};e.fromGrid?(e.fromGrid=void 0,n=e):(e.onDragEnter&&(n.onDragEnter=function(n){e.onDragEnter(t.draggingToRowDragEvent(Ym.EVENT_ROW_DRAG_ENTER,n))}),e.onDragLeave&&(n.onDragLeave=function(n){e.onDragLeave(t.draggingToRowDragEvent(Ym.EVENT_ROW_DRAG_LEAVE,n))}),e.onDragging&&(n.onDragging=function(n){e.onDragging(t.draggingToRowDragEvent(Ym.EVENT_ROW_DRAG_MOVE,n))}),e.onDragStop&&(n.onDragStop=function(n){e.onDragStop(t.draggingToRowDragEvent(Ym.EVENT_ROW_DRAG_END,n))})),this.dragAndDropService.addDropTarget(Object.assign({isInterestedIn:function(e){return e===CS.RowDrag},getIconName:function(){return xS.ICON_MOVE},external:!0},n))}else Lg((function(){return console.warn("AG Grid: addRowDropZone - A container target needs to be provided")}),"add-drop-zone-empty-target")}},{key:"getRowDropZone",value:function(e){var t=this,n=this.getContainer.bind(this),r=this.onDragEnter.bind(this),i=this.onDragLeave.bind(this),o=this.onDragging.bind(this),a=this.onDragStop.bind(this);return e?{getContainer:n,onDragEnter:e.onDragEnter?function(n){r(n),e.onDragEnter(t.draggingToRowDragEvent(Ym.EVENT_ROW_DRAG_ENTER,n))}:r,onDragLeave:e.onDragLeave?function(n){i(n),e.onDragLeave(t.draggingToRowDragEvent(Ym.EVENT_ROW_DRAG_LEAVE,n))}:i,onDragging:e.onDragging?function(n){o(n),e.onDragging(t.draggingToRowDragEvent(Ym.EVENT_ROW_DRAG_MOVE,n))}:o,onDragStop:e.onDragStop?function(n){a(n),e.onDragStop(t.draggingToRowDragEvent(Ym.EVENT_ROW_DRAG_END,n))}:a,fromGrid:!0}:{getContainer:n,onDragEnter:r,onDragLeave:i,onDragging:o,onDragStop:a,fromGrid:!0}}},{key:"draggingToRowDragEvent",value:function(e,t){var n,r,i=this.mouseEventService.getNormalisedPosition(t).y,o=-1;switch(i>this.paginationProxy.getCurrentPageHeight()||(o=this.rowModel.getRowIndexAtPixel(i),n=this.rowModel.getRow(o)),t.vDirection){case SS.Down:r="down";break;case SS.Up:r="up";break;default:r=null}return{type:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:o,overNode:n,y:i,vDirection:r}}},{key:"dispatchGridEvent",value:function(e,t){var n=this.draggingToRowDragEvent(e,t);this.eventService.dispatchEvent(n)}},{key:"onDragLeave",value:function(e){this.dispatchGridEvent(Ym.EVENT_ROW_DRAG_LEAVE,e),this.stopDragging(e),this.gridOptionsService.is("rowDragManaged")&&this.clearRowHighlight(),this.isFromThisGrid(e)&&(this.isMultiRowDrag=!1)}},{key:"onDragStop",value:function(e){this.dispatchGridEvent(Ym.EVENT_ROW_DRAG_END,e),this.stopDragging(e),!this.gridOptionsService.is("rowDragManaged")||!this.gridOptionsService.is("suppressMoveWhenRowDragging")&&this.isFromThisGrid(e)||this.isDropZoneWithinThisGrid(e)||this.moveRowAndClearHighlight(e)}},{key:"stopDragging",value:function(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach((function(e){e.setDragging(!1)}))}}]),n}(Vm);HE([nm("dragAndDropService")],VE.prototype,"dragAndDropService",void 0),HE([nm("rowModel")],VE.prototype,"rowModel",void 0),HE([nm("paginationProxy")],VE.prototype,"paginationProxy",void 0),HE([nm("columnModel")],VE.prototype,"columnModel",void 0),HE([nm("focusService")],VE.prototype,"focusService",void 0),HE([nm("sortController")],VE.prototype,"sortController",void 0),HE([nm("filterManager")],VE.prototype,"filterManager",void 0),HE([nm("selectionService")],VE.prototype,"selectionService",void 0),HE([nm("mouseEventService")],VE.prototype,"mouseEventService",void 0),HE([nm("ctrlsService")],VE.prototype,"ctrlsService",void 0),HE([rm("rangeService")],VE.prototype,"rangeService",void 0),HE([$g],VE.prototype,"postConstruct",null);var WE,zE=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e.ANIMATION_ON="ag-row-animation",e.ANIMATION_OFF="ag-row-no-animation"}(WE||(WE={}));var UE,KE,qE="ag-force-vertical-scroll",XE=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).stickyTopHeight=0,e}return A(n,[{key:"getScrollFeature",value:function(){return this.bodyScrollFeature}},{key:"getBodyViewportElement",value:function(){return this.eBodyViewport}},{key:"setComp",value:function(e,t,n,r,i,o){this.comp=e,this.eGridBody=t,this.eBodyViewport=n,this.eTop=r,this.eBottom=i,this.eStickyTop=o,this.setCellTextSelection(this.gridOptionsService.is("enableCellTextSelection")),this.createManagedBean(new IE(this.comp)),this.bodyScrollFeature=this.createManagedBean(new BE(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([r,n,i,o]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.ctrlsService.registerGridBodyCtrl(this)}},{key:"getComp",value:function(){return this.comp}},{key:"addEventListeners",value:function(){this.addManagedListener(this.eventService,Ym.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}},{key:"addFocusListeners",value:function(e){var t=this;e.forEach((function(e){t.addManagedListener(e,"focusin",(function(t){var n=qw(t.target,"ag-root",e);e.classList.toggle("ag-has-focus",!n)})),t.addManagedListener(e,"focusout",(function(t){var n=t.target,r=t.relatedTarget,i=e.contains(r),o=qw(r,"ag-root",e);qw(n,"ag-root",e)||i&&!o||e.classList.remove("ag-has-focus")}))}))}},{key:"setColumnMovingCss",value:function(e){this.comp.setColumnMovingCss("ag-column-moving",e)}},{key:"setCellTextSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.comp.setCellSelectableCss("ag-selectable",e)}},{key:"onScrollVisibilityChanged",value:function(){var e=this,t=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(t),this.setStickyTopWidth(t);var n=t&&this.gridOptionsService.getScrollbarWidth()||0,r=_w()?16:0,i="calc(100% + ".concat(n+r,"px)");this.animationFrameService.requestAnimationFrame((function(){return e.comp.setBodyViewportWidth(i)}))}},{key:"onGridColumnsChanged",value:function(){var e=this.columnModel.getAllGridColumns();this.comp.setColumnCount(e?e.length:0)}},{key:"disableBrowserDragging",value:function(){this.addManagedListener(this.eGridBody,"dragstart",(function(e){if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}))}},{key:"addStopEditingWhenGridLosesFocus",value:function(){var e=this;if(this.gridOptionsService.is("stopEditingWhenCellsLoseFocus")){var t=function(t){var r=t.relatedTarget;if(null!==Ew(r)){var i=n.some((function(e){return e.contains(r)}))&&e.mouseEventService.isElementInThisGrid(r);if(!i){var o=e.popupService;i=o.getActivePopups().some((function(e){return e.contains(r)}))||o.isElementWithinCustomPopup(r)}i||e.rowRenderer.stopEditing()}else e.rowRenderer.stopEditing()},n=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop];n.forEach((function(n){return e.addManagedListener(n,"focusout",t)}))}}},{key:"updateRowCount",value:function(){var e=this.headerNavigationService.getHeaderRowCount(),t=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,n=-1===t?-1:e+t;this.comp.setRowCount(n)}},{key:"registerBodyViewportResizeListener",value:function(e){this.comp.registerBodyViewportResizeListener(e)}},{key:"setVerticalScrollPaddingVisible",value:function(e){var t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}},{key:"isVerticalScrollShowing",value:function(){var e=this.gridOptionsService.is("alwaysShowVerticalScroll"),t=e?qE:null,n=this.gridOptionsService.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||n&&pb(this.eBodyViewport)}},{key:"setupRowAnimationCssClass",value:function(){var e=this,t=function(){var t=e.gridOptionsService.isAnimateRows()&&!e.rowContainerHeightService.isStretching(),n=t?WE.ANIMATION_ON:WE.ANIMATION_OFF;e.comp.setRowAnimationCssOnBodyViewport(n,t)};t(),this.addManagedListener(this.eventService,Ym.EVENT_HEIGHT_SCALE_CHANGED,t),this.addManagedPropertyListener("animateRows",t)}},{key:"getGridBodyElement",value:function(){return this.eGridBody}},{key:"addBodyViewportListener",value:function(){var e=this.onBodyViewportContextMenu.bind(this);this.addManagedListener(this.eBodyViewport,"contextmenu",e),this.mockContextMenuForIPad(e),this.addManagedListener(this.eBodyViewport,"wheel",this.onBodyViewportWheel.bind(this)),this.addManagedListener(this.eStickyTop,"wheel",this.onStickyTopWheel.bind(this)),this.addFullWidthContainerWheelListener()}},{key:"addFullWidthContainerWheelListener",value:function(){var e=this,t=this.eBodyViewport.querySelector(".ag-full-width-container"),n=this.eBodyViewport.querySelector(".ag-center-cols-viewport");t&&n&&this.addManagedListener(t,"wheel",(function(t){return e.onFullWidthContainerWheel(t,n)}))}},{key:"onFullWidthContainerWheel",value:function(e,t){!e.deltaX||Math.abs(e.deltaY)>Math.abs(e.deltaX)||!this.mouseEventService.isEventFromThisGrid(e)||(e.preventDefault(),t.scrollBy({left:e.deltaX}))}},{key:"onBodyViewportContextMenu",value:function(e,t,n){if(e||n){if(this.gridOptionsService.is("preventDefaultOnContextMenu"))(e||n).preventDefault();var r=(e||t).target;if(r===this.eBodyViewport||r===this.ctrlsService.getCenterRowContainerCtrl().getViewportElement()){if(!this.contextMenuFactory)return;e?this.contextMenuFactory.onContextMenu(e,null,null,null,null,this.eGridBody):n&&this.contextMenuFactory.onContextMenu(null,n,null,null,null,this.eGridBody)}}}},{key:"mockContextMenuForIPad",value:function(e){if(Cw()){var t=new ZC(this.eBodyViewport);this.addManagedListener(t,ZC.EVENT_LONG_TAP,(function(t){e(void 0,t.touchStart,t.touchEvent)})),this.addDestroyFunc((function(){return t.destroy()}))}}},{key:"onBodyViewportWheel",value:function(e){this.gridOptionsService.is("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()}},{key:"onStickyTopWheel",value:function(e){e.preventDefault(),e.offsetY&&this.scrollVertically(e.deltaY)}},{key:"getGui",value:function(){return this.eGridBody}},{key:"scrollVertically",value:function(e){var t=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}},{key:"addRowDragListener",value:function(){this.rowDragFeature=this.createManagedBean(new VE(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)}},{key:"getRowDragFeature",value:function(){return this.rowDragFeature}},{key:"onPinnedRowDataChanged",value:function(){this.setFloatingHeights()}},{key:"setFloatingHeights",value:function(){var e=this.pinnedRowModel,t=e.getPinnedTopTotalHeight();t&&(t+=1);var n=e.getPinnedBottomTotalHeight();n&&(n+=1),this.comp.setTopHeight(t),this.comp.setBottomHeight(n),this.comp.setTopDisplay(t?"inherit":"none"),this.comp.setBottomDisplay(n?"inherit":"none"),this.setStickyTopOffsetTop()}},{key:"setStickyTopHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.comp.setStickyTopHeight("".concat(e,"px")),this.stickyTopHeight=e}},{key:"getStickyTopHeight",value:function(){return this.stickyTopHeight}},{key:"setStickyTopWidth",value:function(e){if(e){var t=this.gridOptionsService.getScrollbarWidth();this.comp.setStickyTopWidth("calc(100% - ".concat(t,"px)"))}else this.comp.setStickyTopWidth("100%")}},{key:"onHeaderHeightChanged",value:function(){this.setStickyTopOffsetTop()}},{key:"setStickyTopOffsetTop",value:function(){var e=this.ctrlsService.getGridHeaderCtrl().getHeaderHeight(),t=this.pinnedRowModel.getPinnedTopTotalHeight(),n=0;e>0&&(n+=e+1),t>0&&(n+=t+1),this.comp.setStickyTopTop("".concat(n,"px"))}},{key:"sizeColumnsToFit",value:function(e,t){var n=this,r=this.isVerticalScrollShowing()?this.gridOptionsService.getScrollbarWidth():0,i=Qw(this.eGridBody)-r;i>0?this.columnModel.sizeColumnsToFit(i,"sizeColumnsToFit",!1,e):void 0===t?window.setTimeout((function(){n.sizeColumnsToFit(e,100)}),0):100===t?window.setTimeout((function(){n.sizeColumnsToFit(e,500)}),100):500===t?window.setTimeout((function(){n.sizeColumnsToFit(e,-1)}),500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}},{key:"addScrollEventListener",value:function(e){this.eBodyViewport.addEventListener("scroll",e,{passive:!0})}},{key:"removeScrollEventListener",value:function(e){this.eBodyViewport.removeEventListener("scroll",e)}}]),n}(Vm);zE([nm("animationFrameService")],XE.prototype,"animationFrameService",void 0),zE([nm("rowContainerHeightService")],XE.prototype,"rowContainerHeightService",void 0),zE([nm("ctrlsService")],XE.prototype,"ctrlsService",void 0),zE([nm("columnModel")],XE.prototype,"columnModel",void 0),zE([nm("scrollVisibleService")],XE.prototype,"scrollVisibleService",void 0),zE([rm("contextMenuFactory")],XE.prototype,"contextMenuFactory",void 0),zE([nm("headerNavigationService")],XE.prototype,"headerNavigationService",void 0),zE([nm("dragAndDropService")],XE.prototype,"dragAndDropService",void 0),zE([nm("pinnedRowModel")],XE.prototype,"pinnedRowModel",void 0),zE([nm("rowRenderer")],XE.prototype,"rowRenderer",void 0),zE([nm("popupService")],XE.prototype,"popupService",void 0),zE([nm("mouseEventService")],XE.prototype,"mouseEventService",void 0),zE([nm("rowModel")],XE.prototype,"rowModel",void 0),function(e){e[e.FILL=0]="FILL",e[e.RANGE=1]="RANGE"}(UE||(UE={})),function(e){e[e.VALUE=0]="VALUE",e[e.DIMENSION=1]="DIMENSION"}(KE||(KE={}));var YE="ag-cell-range-selected",QE=function(){function e(t,n){T(this,e),this.beans=t,this.cellCtrl=n}return A(e,[{key:"setComp",value:function(e,t){this.cellComp=e,this.eGui=t,this.onRangeSelectionChanged()}},{key:"onRangeSelectionChanged",value:function(){this.cellComp&&(this.rangeCount=this.beans.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(YE,0!==this.rangeCount),this.cellComp.addOrRemoveCssClass("".concat(YE,"-1"),1===this.rangeCount),this.cellComp.addOrRemoveCssClass("".concat(YE,"-2"),2===this.rangeCount),this.cellComp.addOrRemoveCssClass("".concat(YE,"-3"),3===this.rangeCount),this.cellComp.addOrRemoveCssClass("".concat(YE,"-4"),this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),iw(this.eGui,this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}},{key:"updateRangeBorders",value:function(){var e=this.getRangeBorders(),t=this.isSingleCell(),n=!t&&e.top,r=!t&&e.right,i=!t&&e.bottom,o=!t&&e.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",n),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",r),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",i),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",o)}},{key:"isSingleCell",value:function(){var e=this.beans.rangeService;return 1===this.rangeCount&&e&&!e.isMoreThanOneCell()}},{key:"getHasChartRange",value:function(){var e=this.beans.rangeService;if(!this.rangeCount||!e)return!1;var t=e.getCellRanges();return t.length>0&&t.every((function(e){return xm([KE.DIMENSION,KE.VALUE],e.type)}))}},{key:"updateRangeBordersIfRangeCount",value:function(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}},{key:"getRangeBorders",value:function(){var e,t,n=this,r=this.beans.gridOptionsService.is("enableRtl"),i=!1,o=!1,a=!1,s=!1,l=this.cellCtrl.getCellPosition().column,u=this.beans,c=u.rangeService,d=u.columnModel;r?(e=d.getDisplayedColAfter(l),t=d.getDisplayedColBefore(l)):(e=d.getDisplayedColBefore(l),t=d.getDisplayedColAfter(l));var h=c.getCellRanges().filter((function(e){return c.isCellInSpecificRange(n.cellCtrl.getCellPosition(),e)}));e||(s=!0),t||(o=!0);for(var f=0;f<h.length&&!(i&&o&&a&&s);f++){var p=h[f],v=c.getRangeStartRow(p),g=c.getRangeEndRow(p);!i&&this.beans.rowPositionUtils.sameRow(v,this.cellCtrl.getCellPosition())&&(i=!0),!a&&this.beans.rowPositionUtils.sameRow(g,this.cellCtrl.getCellPosition())&&(a=!0),!s&&e&&p.columns.indexOf(e)<0&&(s=!0),!o&&t&&p.columns.indexOf(t)<0&&(o=!0)}return{top:i,right:o,bottom:a,left:s}}},{key:"refreshHandle",value:function(){if(this.beans.rangeService){var e=this.shouldHaveSelectionHandle();this.selectionHandle&&!e&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),e&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}}},{key:"shouldHaveSelectionHandle",value:function(){var e=this.beans,t=e.gridOptionsService,n=e.rangeService,r=n.getCellRanges(),i=r.length;if(this.rangeCount<1||i<1)return!1;var o=ym(r),a=this.cellCtrl.getCellPosition(),s=t.is("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),l=t.is("enableRangeHandle"),u=1===i&&!this.cellCtrl.isEditing()&&(s||l);if(this.hasChartRange){var c=r[0].type===KE.DIMENSION&&n.isCellInSpecificRange(a,r[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",c),u=o.type===KE.VALUE}return u&&null!=o.endRow&&n.isContiguousRange(o)&&n.isBottomRightCell(o,a)}},{key:"addSelectionHandle",value:function(){var e=this.beans,t=e.gridOptionsService,n=ym(e.rangeService.getCellRanges()).type,r=t.is("enableFillHandle")&&pg(n)?UE.FILL:UE.RANGE;this.selectionHandle&&this.selectionHandle.getType()!==r&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.beans.selectionHandleFactory.createSelectionHandle(r)),this.selectionHandle.refresh(this.cellCtrl)}},{key:"destroy",value:function(){this.beans.context.destroyBean(this.selectionHandle)}}]),e}(),ZE=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this)).cellCtrl=e,i.beans=r,i.column=e.getColumn(),i.rowNode=e.getRowNode(),i.setupColSpan(),i.setupRowSpan(),i}return A(n,[{key:"setupRowSpan",value:function(){this.rowSpan=this.column.getRowSpan(this.rowNode)}},{key:"setComp",value:function(e){this.eGui=e,this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}},{key:"onDisplayColumnsChanged",value:function(){var e=this.getColSpanningList();wm(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}},{key:"setupColSpan",value:function(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,Ym.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))}},{key:"onWidthChanged",value:function(){if(this.eGui){var e=this.getCellWidth();this.eGui.style.width="".concat(e,"px")}}},{key:"getCellWidth",value:function(){return this.colsSpanning?this.colsSpanning.reduce((function(e,t){return e+t.getActualWidth()}),0):this.column.getActualWidth()}},{key:"getColSpanningList",value:function(){var e=this.column.getColSpan(this.rowNode),t=[];if(1===e)t.push(this.column);else for(var n=this.column,r=this.column.getPinned(),i=0;n&&i<e&&(t.push(n),(n=this.beans.columnModel.getDisplayedColAfter(n))&&!pg(n))&&r===n.getPinned();i++);return t}},{key:"onLeftChanged",value:function(){if(this.eGui){var e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=e+"px"}}},{key:"getCellLeft",value:function(){return(this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?ym(this.colsSpanning):this.column).getLeft()}},{key:"modifyLeftForPrintLayout",value:function(e){if(!this.cellCtrl.isPrintLayout()||"left"===this.column.getPinned())return e;var t=this.beans.columnModel.getDisplayedColumnsLeftWidth();return"right"===this.column.getPinned()?t+this.beans.columnModel.getBodyContainerWidth()+(e||0):t+(e||0)}},{key:"applyRowSpan",value:function(){if(1!==this.rowSpan){var e=this.beans.gridOptionsService.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height="".concat(e,"px"),this.eGui.style.zIndex="1"}}},{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this)}}]),n}(Vm),JE=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this)).staticClasses=[],i.cellCtrl=e,i.beans=r,i.column=e.getColumn(),i.rowNode=e.getRowNode(),i}return A(n,[{key:"setComp",value:function(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}},{key:"applyCellClassRules",value:function(){var e=this,t=this.column.getColDef(),n={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:t,column:this.column,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.beans.stylingService.processClassRules(t.cellClassRules,n,(function(t){return e.cellComp.addOrRemoveCssClass(t,!0)}),(function(t){return e.cellComp.addOrRemoveCssClass(t,!1)}))}},{key:"applyUserStyles",value:function(){var e=this.column.getColDef();if(e.cellStyle){var t;if("function"===typeof e.cellStyle){var n={column:this.column,value:this.cellCtrl.getValue(),colDef:e,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};t=(0,e.cellStyle)(n)}else t=e.cellStyle;t&&this.cellComp.setUserStyles(t)}}},{key:"applyClassesFromColDef",value:function(){var e=this,t=this.column.getColDef(),n={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:t,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.staticClasses.length&&this.staticClasses.forEach((function(t){return e.cellComp.addOrRemoveCssClass(t,!1)})),this.staticClasses=this.beans.stylingService.getStaticCellClasses(t,n),this.staticClasses.length&&this.staticClasses.forEach((function(t){return e.cellComp.addOrRemoveCssClass(t,!0)}))}},{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this)}}]),n}(Vm),$E=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this)).ctrl=e,i.beans=r,i}return A(n,[{key:"setComp",value:function(e){this.comp=e,this.setupTooltip()}},{key:"setupTooltip",value:function(){this.browserTooltips=this.beans.gridOptionsService.is("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?this.comp.setTitle(null!=this.tooltip?this.tooltip:void 0):this.createTooltipFeatureIfNeeded()}},{key:"updateTooltipText",value:function(){this.tooltip=this.ctrl.getTooltipValue()}},{key:"createTooltipFeatureIfNeeded",value:function(){var e=this;if(null==this.genericTooltipFeature){var t={getTooltipParams:function(){return e.getTooltipParams()},getGui:function(){return e.ctrl.getGui()}};this.genericTooltipFeature=this.createManagedBean(new qb(t),this.beans.context)}}},{key:"refreshToolTip",value:function(){this.updateTooltipText(),this.browserTooltips&&this.comp.setTitle(null!=this.tooltip?this.tooltip:void 0)}},{key:"getTooltipParams",value:function(){var e=this.ctrl,t=e.getColumn?e.getColumn():void 0,n=e.getColDef?e.getColDef():void 0,r=e.getRowNode?e.getRowNode():void 0;return{location:e.getLocation(),colDef:n,column:t,rowIndex:e.getRowIndex?e.getRowIndex():void 0,node:r,data:r?r.data:void 0,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?e.getValueFormatted():void 0}}},{key:"getTooltipText",value:function(){return this.tooltip}},{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this)}}]),n}(Vm),ek=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},tk=function(){function e(){T(this,e)}return A(e,[{key:"postConstruct",value:function(){this.doingMasterDetail=this.gridOptionsService.isMasterDetail(),this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.gridOptionsService.isRowModelType("serverSide")&&(this.serverSideRowModel=this.rowModel)}}]),e}();ek([nm("resizeObserverService")],tk.prototype,"resizeObserverService",void 0),ek([nm("paginationProxy")],tk.prototype,"paginationProxy",void 0),ek([nm("context")],tk.prototype,"context",void 0),ek([nm("columnApi")],tk.prototype,"columnApi",void 0),ek([nm("gridApi")],tk.prototype,"gridApi",void 0),ek([nm("gridOptionsService")],tk.prototype,"gridOptionsService",void 0),ek([nm("expressionService")],tk.prototype,"expressionService",void 0),ek([nm("environment")],tk.prototype,"environment",void 0),ek([nm("rowRenderer")],tk.prototype,"rowRenderer",void 0),ek([nm("templateService")],tk.prototype,"templateService",void 0),ek([nm("valueService")],tk.prototype,"valueService",void 0),ek([nm("eventService")],tk.prototype,"eventService",void 0),ek([nm("columnModel")],tk.prototype,"columnModel",void 0),ek([nm("headerNavigationService")],tk.prototype,"headerNavigationService",void 0),ek([nm("navigationService")],tk.prototype,"navigationService",void 0),ek([nm("columnAnimationService")],tk.prototype,"columnAnimationService",void 0),ek([rm("rangeService")],tk.prototype,"rangeService",void 0),ek([nm("focusService")],tk.prototype,"focusService",void 0),ek([rm("contextMenuFactory")],tk.prototype,"contextMenuFactory",void 0),ek([nm("popupService")],tk.prototype,"popupService",void 0),ek([nm("valueFormatterService")],tk.prototype,"valueFormatterService",void 0),ek([nm("stylingService")],tk.prototype,"stylingService",void 0),ek([nm("columnHoverService")],tk.prototype,"columnHoverService",void 0),ek([nm("userComponentFactory")],tk.prototype,"userComponentFactory",void 0),ek([nm("userComponentRegistry")],tk.prototype,"userComponentRegistry",void 0),ek([nm("animationFrameService")],tk.prototype,"animationFrameService",void 0),ek([nm("dragService")],tk.prototype,"dragService",void 0),ek([nm("dragAndDropService")],tk.prototype,"dragAndDropService",void 0),ek([nm("sortController")],tk.prototype,"sortController",void 0),ek([nm("filterManager")],tk.prototype,"filterManager",void 0),ek([nm("rowContainerHeightService")],tk.prototype,"rowContainerHeightService",void 0),ek([nm("frameworkOverrides")],tk.prototype,"frameworkOverrides",void 0),ek([nm("cellPositionUtils")],tk.prototype,"cellPositionUtils",void 0),ek([nm("rowPositionUtils")],tk.prototype,"rowPositionUtils",void 0),ek([nm("selectionService")],tk.prototype,"selectionService",void 0),ek([rm("selectionHandleFactory")],tk.prototype,"selectionHandleFactory",void 0),ek([nm("rowCssClassCalculator")],tk.prototype,"rowCssClassCalculator",void 0),ek([nm("rowModel")],tk.prototype,"rowModel",void 0),ek([nm("ctrlsService")],tk.prototype,"ctrlsService",void 0),ek([nm("ctrlsFactory")],tk.prototype,"ctrlsFactory",void 0),ek([nm("agStackComponentsRegistry")],tk.prototype,"agStackComponentsRegistry",void 0),ek([nm("valueCache")],tk.prototype,"valueCache",void 0),ek([nm("rowNodeEventThrottle")],tk.prototype,"rowNodeEventThrottle",void 0),ek([nm("localeService")],tk.prototype,"localeService",void 0),ek([nm("valueParserService")],tk.prototype,"valueParserService",void 0),ek([$g],tk.prototype,"postConstruct",null);var nk=function(e){O(n,e);var t=F(n);function n(e,r,i){var o;return T(this,n),(o=t.call(this)).cellCtrl=e,o.beans=r,o.column=i,o}return A(n,[{key:"onMouseEvent",value:function(e,t){if(!Pm(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t)}}},{key:"onCellClicked",value:function(e){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(e),void e.preventDefault();var t=this.beans,n=t.eventService,r=t.rangeService,i=t.gridOptionsService,o=e.ctrlKey||e.metaKey;r&&o&&r.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&r.intersectLastRange(!0);var a=this.cellCtrl.createEvent(e,Ym.EVENT_CELL_CLICKED);n.dispatchEvent(a);var s=this.column.getColDef();s.onCellClicked&&window.setTimeout((function(){return s.onCellClicked(a)}),0),(i.is("singleClickEdit")||s.singleClickEdit)&&!i.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit()}},{key:"isDoubleClickOnIPad",value:function(){if(!Cw()||Fm("dblclick"))return!1;var e=(new Date).getTime(),t=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,t}},{key:"onCellDoubleClicked",value:function(e){var t=this.column.getColDef(),n=this.cellCtrl.createEvent(e,Ym.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(n),"function"===typeof t.onCellDoubleClicked&&window.setTimeout((function(){return t.onCellDoubleClicked(n)}),0),!this.beans.gridOptionsService.is("singleClickEdit")&&!this.beans.gridOptionsService.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit(null,e)}},{key:"onMouseDown",value:function(e){var t=e.ctrlKey,n=e.metaKey,r=e.shiftKey,i=e.target,o=this.beans,a=o.eventService,s=o.rangeService;if(!this.isRightClickInExistingRange(e)){var l=s&&0!=s.getCellRanges().length;if(!r||!l){var u=gw()&&!this.cellCtrl.isEditing()&&!Ww(i);this.cellCtrl.focusCell(u)}if(r&&l&&e.preventDefault(),!this.containsWidget(i)){if(s){var c=this.cellCtrl.getCellPosition();if(r)s.extendLatestRangeToCell(c);else{var d=t||n;s.setRangeToCell(c,d)}}a.dispatchEvent(this.cellCtrl.createEvent(e,Ym.EVENT_CELL_MOUSE_DOWN))}}}},{key:"isRightClickInExistingRange",value:function(e){var t=this.beans.rangeService;if(t&&(t.isCellInAnyRange(this.cellCtrl.getCellPosition())&&2===e.button))return!0;return!1}},{key:"containsWidget",value:function(e){return qw(e,"ag-selection-checkbox",3)}},{key:"onMouseOut",value:function(e){if(!this.mouseStayingInsideCell(e)){var t=this.cellCtrl.createEvent(e,Ym.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.clearMouseOver()}}},{key:"onMouseOver",value:function(e){if(!this.mouseStayingInsideCell(e)){var t=this.cellCtrl.createEvent(e,Ym.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.setMouseOver([this.column])}}},{key:"mouseStayingInsideCell",value:function(e){if(!e.target||!e.relatedTarget)return!1;var t=this.cellCtrl.getGui(),n=t.contains(e.target),r=t.contains(e.relatedTarget);return n&&r}},{key:"destroy",value:function(){}}]),n}(tk=ek([tm("beans")],tk)),rk=function(e){O(n,e);var t=F(n);function n(e,r,i,o,a){var s;return T(this,n),(s=t.call(this)).cellCtrl=e,s.beans=r,s.rowNode=o,s.rowCtrl=a,s}return A(n,[{key:"setComp",value:function(e){this.eGui=e}},{key:"onKeyDown",value:function(e){var t=e.key;switch(t){case _b.ENTER:this.onEnterKeyDown(e);break;case _b.F2:this.onF2KeyDown(e);break;case _b.ESCAPE:this.onEscapeKeyDown(e);break;case _b.TAB:this.onTabKeyDown(e);break;case _b.BACKSPACE:case _b.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case _b.DOWN:case _b.UP:case _b.RIGHT:case _b.LEFT:this.onNavigationKeyDown(e,t)}}},{key:"onNavigationKeyDown",value:function(e,t){this.cellCtrl.isEditing()||(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(e):this.beans.navigationService.navigateToNextCell(e,t,this.cellCtrl.getCellPosition(),!0),e.preventDefault())}},{key:"onShiftRangeSelect",value:function(e){if(this.beans.rangeService){var t=this.beans.rangeService.extendLatestRangeInDirection(e);t&&this.beans.navigationService.ensureCellVisible(t)}}},{key:"onTabKeyDown",value:function(e){this.beans.navigationService.onTabKeyDown(this.cellCtrl,e)}},{key:"onBackspaceOrDeleteKeyDown",value:function(e,t){var n=this.cellCtrl,r=this.beans,i=this.rowNode,o=r.gridOptionsService,a=r.rangeService,s=r.eventService;n.isEditing()||(s.dispatchEvent({type:Ym.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),Fb(e,o.is("enableCellEditingOnBackspace"))?a&&o.isEnableRangeSelection()?a.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"}):n.isCellEditable()&&i.setDataValue(n.getColumn(),null,"cellClear"):n.startRowOrCellEdit(e,t),s.dispatchEvent({type:Ym.EVENT_KEY_SHORTCUT_CHANGED_CELL_END}))}},{key:"onEnterKeyDown",value:function(e){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,e.shiftKey);else if(this.beans.gridOptionsService.is("enterNavigatesVertically")){var t=e.shiftKey?_b.UP:_b.DOWN;this.beans.navigationService.navigateToNextCell(null,t,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(_b.ENTER,e),this.cellCtrl.isEditing()&&e.preventDefault()}},{key:"onF2KeyDown",value:function(e){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(_b.F2,e)}},{key:"onEscapeKeyDown",value:function(e){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}},{key:"processCharacter",value:function(e){if(!(e.target!==this.eGui)&&!this.cellCtrl.isEditing()){var t=e.key;" "===t?this.onSpaceKeyDown(e):(this.cellCtrl.startRowOrCellEdit(t,e),e.preventDefault())}}},{key:"onSpaceKeyDown",value:function(e){var t=this.beans.gridOptionsService;if(!this.cellCtrl.isEditing()&&t.isRowSelection()){var n=this.rowNode.isSelected(),r=!n;if(r||!t.is("suppressRowDeselection")){var i=this.beans.gridOptionsService.is("groupSelectsFiltered"),o=this.rowNode.setSelectedParams({newValue:r,rangeSelect:e.shiftKey,groupSelectsFiltered:i,event:e,source:"spaceKey"});void 0===n&&0===o&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:e.shiftKey,groupSelectsFiltered:i,event:e,source:"spaceKey"})}}e.preventDefault()}},{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this)}}]),n}(Vm),ik=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ok=function(e){O(n,e);var t=F(n);function n(e,r,i){var o;return T(this,n),(o=t.call(this,'<div class="ag-drag-handle ag-row-drag" draggable="true"></div>')).rowNode=e,o.column=r,o.eCell=i,o}return A(n,[{key:"postConstruct",value:function(){this.getGui().appendChild(Rb("rowDrag",this.gridOptionsService,null)),this.addGuiEventListener("mousedown",(function(e){e.stopPropagation()})),this.addDragSource(),this.checkVisibility()}},{key:"addDragSource",value:function(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}},{key:"onDragStart",value:function(e){var t=this,n=this.column.getColDef().dndSourceOnRowDrag;e.dataTransfer.setDragImage(this.eCell,0,0);n?n({rowNode:this.rowNode,dragEvent:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):function(){try{var n=JSON.stringify(t.rowNode.data);e.dataTransfer.setData("application/json",n),e.dataTransfer.setData("text/plain",n)}catch(r){}}()}},{key:"checkVisibility",value:function(){var e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}}]),n}(Zb);ik([$g],ok.prototype,"postConstruct",null);var ak,sk=0,lk=function(e){O(n,e);var t=F(n);function n(e,r,i,o){var a;return T(this,n),(a=t.call(this)).cellRangeFeature=null,a.cellPositionFeature=null,a.cellCustomStyleFeature=null,a.tooltipFeature=null,a.cellMouseListenerFeature=null,a.cellKeyboardListenerFeature=null,a.suppressRefreshCell=!1,a.onCellCompAttachedFuncs=[],a.column=e,a.rowNode=r,a.beans=i,a.rowCtrl=o,a.instanceId=e.getId()+"-"+sk++,a.createCellPosition(),a.addFeatures(),a}return A(n,[{key:"shouldRestoreFocus",value:function(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}},{key:"addFeatures",value:function(){var e=this;this.cellPositionFeature=new ZE(this,this.beans),this.addDestroyFunc((function(){var t;null===(t=e.cellPositionFeature)||void 0===t||t.destroy(),e.cellPositionFeature=null})),this.cellCustomStyleFeature=new JE(this,this.beans),this.addDestroyFunc((function(){var t;null===(t=e.cellCustomStyleFeature)||void 0===t||t.destroy(),e.cellCustomStyleFeature=null})),this.cellMouseListenerFeature=new nk(this,this.beans,this.column),this.addDestroyFunc((function(){var t;null===(t=e.cellMouseListenerFeature)||void 0===t||t.destroy(),e.cellMouseListenerFeature=null})),this.cellKeyboardListenerFeature=new rk(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc((function(){var t;null===(t=e.cellKeyboardListenerFeature)||void 0===t||t.destroy(),e.cellKeyboardListenerFeature=null})),this.beans.rangeService&&this.beans.gridOptionsService.isEnableRangeSelection()&&(this.cellRangeFeature=new QE(this.beans,this),this.addDestroyFunc((function(){var t;null===(t=e.cellRangeFeature)||void 0===t||t.destroy(),e.cellRangeFeature=null}))),this.column.isTooltipEnabled()&&this.addTooltipFeature()}},{key:"addTooltipFeature",value:function(){var e=this,t={getColumn:function(){return e.column},getColDef:function(){return e.column.getColDef()},getRowIndex:function(){return e.cellPosition.rowIndex},getRowNode:function(){return e.rowNode},getGui:function(){return e.getGui()},getLocation:function(){return"cell"},getTooltipValue:function(){var t=e.column.getColDef(),n=e.rowNode.data;if(t.tooltipField&&fg(n))return Dg(n,t.tooltipField,e.column.isTooltipFieldContainsDots());var r=t.tooltipValueGetter;return r?r({location:"cell",api:e.beans.gridOptionsService.api,columnApi:e.beans.gridOptionsService.columnApi,context:e.beans.gridOptionsService.context,colDef:e.column.getColDef(),column:e.column,rowIndex:e.cellPosition.rowIndex,node:e.rowNode,data:e.rowNode.data,value:e.value,valueFormatted:e.valueFormatted}):null},getValueFormatted:function(){return e.valueFormatted}};this.tooltipFeature=new $E(t,this.beans),this.addDestroyFunc((function(){var t;null===(t=e.tooltipFeature)||void 0===t||t.destroy(),e.tooltipFeature=null}))}},{key:"setComp",value:function(e,t,n,r,i){var o,a,s,l;this.cellComp=e,this.eGui=t,this.printLayout=r,this.updateAndFormatValue(!0),this.addDomData(),this.onCellFocused(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),n&&this.setupAutoHeight(n),this.setAriaColIndex(),this.beans.gridOptionsService.is("suppressCellFocus")||this.cellComp.setTabIndex(-1);var u=ry(this.column.getId());this.cellComp.setColId(u),this.cellComp.setRole("gridcell"),null===(o=this.cellPositionFeature)||void 0===o||o.setComp(t),null===(a=this.cellCustomStyleFeature)||void 0===a||a.setComp(e),null===(s=this.tooltipFeature)||void 0===s||s.setComp(e),null===(l=this.cellKeyboardListenerFeature)||void 0===l||l.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(e,t),i&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach((function(e){return e()})),this.onCellCompAttachedFuncs=[])}},{key:"setupAutoHeight",value:function(e){var t=this;if(this.column.isAutoHeight()){var n=e.parentElement,r=this.beans.gridOptionsService.getRowHeightForNode(this.rowNode).height,i=function i(o){if(!t.editing&&t.isAlive()){var a=Xw(n),s=a.paddingTop+a.paddingBottom+a.borderBottomWidth+a.borderTopWidth,l=e.offsetHeight+s;if(o<5){var u=t.beans.gridOptionsService.getDocument();if(!u||!u.contains(e)||0==l)return void t.beans.frameworkOverrides.setTimeout((function(){return i(o+1)}),0)}var c=Math.max(l,r);t.rowNode.setRowAutoHeight(c,t.column)}},o=function(){return i(0)};o();var a=this.beans.resizeObserverService.observeResize(e,o);this.addDestroyFunc((function(){a(),t.rowNode.setRowAutoHeight(void 0,t.column)}))}}},{key:"getInstanceId",value:function(){return this.instanceId}},{key:"showValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=null!=this.valueFormatted?this.valueFormatted:this.value,n=this.createCellRendererParams(),r=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),n);this.cellComp.setRenderDetails(r,t,e),this.refreshHandle()}},{key:"setupControlComps",value:function(){var e=this.column.getColDef();this.includeSelection=this.isIncludeControl(e.checkboxSelection),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}},{key:"isForceWrapper",value:function(){return this.beans.gridOptionsService.is("enableCellTextSelection")||this.column.isAutoHeight()}},{key:"isIncludeControl",value:function(e){return!(null!=this.rowNode.rowPinned)&&("function"===typeof e||!0===e)}},{key:"refreshShouldDestroy",value:function(){var e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(e.checkboxSelection),n=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),r=this.includeDndSource!=this.isIncludeControl(e.dndSource);return t||n||r}},{key:"startEditing",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.isCellEditable()&&!this.editing)if(this.cellComp){var i=this.createCellEditorParams(t,n),o=this.column.getColDef(),a=this.beans.userComponentFactory.getCellEditorDetails(o,i),s=null!=(null===a||void 0===a?void 0:a.popupFromSelector)?a.popupFromSelector:!!o.cellEditorPopup,l=null!=(null===a||void 0===a?void 0:a.popupPositionFromSelector)?a.popupPositionFromSelector:o.cellEditorPopupPosition;this.setEditing(!0),this.cellComp.setEditDetails(a,s,l);var u=this.createEvent(r,Ym.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(u)}else this.onCellCompAttachedFuncs.push((function(){e.startEditing(t,n,r)}))}},{key:"setEditing",value:function(e){this.editing!==e&&(this.editing=e,this.refreshHandle())}},{key:"stopRowOrCellEdit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];"fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.stopRowEditing(e):this.stopEditing(e)}},{key:"onPopupEditorClosed",value:function(){this.isEditing()&&this.stopEditingAndFocus()}},{key:"takeValueFromCellEditor",value:function(e){var t={newValueExists:!1};if(e)return t;var n=this.cellComp.getCellEditor();return n?n.isCancelAfterEnd&&n.isCancelAfterEnd()?t:{newValue:n.getValue(),newValueExists:!0}:t}},{key:"saveNewValue",value:function(e,t){if(t===e)return!1;this.suppressRefreshCell=!0;var n=this.rowNode.setDataValue(this.column,t,"edit");return this.suppressRefreshCell=!1,n}},{key:"stopEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.editing)return!1;var t=this.takeValueFromCellEditor(e),n=t.newValue,r=t.newValueExists,i=this.rowNode.getValueFromValueService(this.column),o=!1;return r&&(o=this.saveNewValue(i,n)),this.setEditing(!1),this.cellComp.setEditDetails(),this.updateAndFormatValue(),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(i,n,!e&&!!o),o}},{key:"dispatchEditingStoppedEvent",value:function(e,t,n){var r=Object.assign(Object.assign({},this.createEvent(null,Ym.EVENT_CELL_EDITING_STOPPED)),{oldValue:e,newValue:t,valueChanged:n});this.beans.eventService.dispatchEvent(r)}},{key:"createCellEditorParams",value:function(e,t){return{value:this.rowNode.getValueFromValueService(this.column),eventKey:e,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,api:this.beans.gridOptionsService.api,cellStartedEdit:t,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)}}},{key:"createCellRendererParams",value:function(){var e=this,t={value:this.value,valueFormatted:this.valueFormatted,getValue:function(){return e.rowNode.getValueFromValueService(e.column)},setValue:function(t){return e.beans.valueService.setValue(e.rowNode,e.column,t)},formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:function(t,n,r,i){return e.registerRowDragger(t,n,i)}};return t}},{key:"parseValue",value:function(e){return this.beans.valueParserService.parseValue(this.column,this.rowNode,e,this.getValue())}},{key:"setFocusOutOnEditor",value:function(){if(this.editing){var e=this.cellComp.getCellEditor();e&&e.focusOut&&e.focusOut()}}},{key:"setFocusInOnEditor",value:function(){if(this.editing){var e=this.cellComp.getCellEditor();e&&e.focusIn?e.focusIn():this.focusCell(!0)}}},{key:"onCellChanged",value:function(e){this.cellComp&&(e.column===this.column&&this.refreshCell({}))}},{key:"refreshCell",value:function(e){var t,n,r;if(!this.suppressRefreshCell&&!this.editing&&this.cellComp){var i=this.column.getColDef(),o=null!=e&&!!e.newData,a=null!=e&&!!e.suppressFlash||!!i.suppressCellFlash,s=null==i.field&&null==i.valueGetter&&null==i.showRowGroup,l=e&&e.forceRefresh||s||o,u=this.updateAndFormatValue();if(l||u){this.showValue(o);var c=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!a&&!c&&(this.beans.gridOptionsService.is("enableCellChangeFlash")||i.enableCellChangeFlash)&&this.flashCell(),null===(t=this.cellCustomStyleFeature)||void 0===t||t.applyUserStyles(),null===(n=this.cellCustomStyleFeature)||void 0===n||n.applyClassesFromColDef()}this.refreshToolTip(),null===(r=this.cellCustomStyleFeature)||void 0===r||r.applyCellClassRules()}}},{key:"stopEditingAndFocus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.stopRowOrCellEdit(),this.focusCell(!0),e||this.navigateAfterEdit(t)}},{key:"navigateAfterEdit",value:function(e){if(this.beans.gridOptionsService.is("enterNavigatesVerticallyAfterEdit")){var t=e?_b.UP:_b.DOWN;this.beans.navigationService.navigateToNextCell(null,t,this.getCellPosition(),!1)}}},{key:"flashCell",value:function(e){var t=e&&e.flashDelay,n=e&&e.fadeDelay;this.animateCell("data-changed",t,n)}},{key:"animateCell",value:function(e,t,n){var r,i,o=this,a="ag-cell-".concat(e),s="ag-cell-".concat(e,"-animation"),l=this.beans.gridOptionsService;t||(t=null!==(r=l.getNum("cellFlashDelay"))&&void 0!==r?r:500),fg(n)||(n=null!==(i=l.getNum("cellFadeDelay"))&&void 0!==i?i:1e3),this.cellComp.addOrRemoveCssClass(a,!0),this.cellComp.addOrRemoveCssClass(s,!1),window.setTimeout((function(){o.isAlive()&&(o.cellComp.addOrRemoveCssClass(a,!1),o.cellComp.addOrRemoveCssClass(s,!0),o.eGui.style.transition="background-color ".concat(n,"ms"),window.setTimeout((function(){o.isAlive()&&(o.cellComp.addOrRemoveCssClass(s,!1),o.eGui.style.transition="")}),n))}),t)}},{key:"onFlashCells",value:function(e){if(this.cellComp){var t=this.beans.cellPositionUtils.createId(this.getCellPosition());e.cells[t]&&this.animateCell("highlight")}}},{key:"isCellEditable",value:function(){return this.column.isCellEditable(this.rowNode)}},{key:"isSuppressFillHandle",value:function(){return this.column.isSuppressFillHandle()}},{key:"formatValue",value:function(e){var t=this.callValueFormatter(e);return null!=t?t:e}},{key:"callValueFormatter",value:function(e){return this.beans.valueFormatterService.formatValue(this.column,this.rowNode,e)}},{key:"updateAndFormatValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.value,n=this.valueFormatted;return this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value),!!e||(!this.valuesAreEqual(t,this.value)||this.valueFormatted!=n)}},{key:"valuesAreEqual",value:function(e,t){var n=this.column.getColDef();return n.equals?n.equals(e,t):e===t}},{key:"getComp",value:function(){return this.cellComp}},{key:"getValue",value:function(){return this.value}},{key:"getValueFormatted",value:function(){return this.valueFormatted}},{key:"addDomData",value:function(){var e=this,t=this.getGui();this.beans.gridOptionsService.setDomData(t,n.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc((function(){return e.beans.gridOptionsService.setDomData(t,n.DOM_DATA_KEY_CELL_CTRL,null)}))}},{key:"createEvent",value:function(e,t){return{type:t,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridApi,columnApi:this.beans.columnApi,rowPinned:this.rowNode.rowPinned,event:e,rowIndex:this.rowNode.rowIndex}}},{key:"processCharacter",value:function(e){var t;null===(t=this.cellKeyboardListenerFeature)||void 0===t||t.processCharacter(e)}},{key:"onKeyDown",value:function(e){var t;null===(t=this.cellKeyboardListenerFeature)||void 0===t||t.onKeyDown(e)}},{key:"onMouseEvent",value:function(e,t){var n;null===(n=this.cellMouseListenerFeature)||void 0===n||n.onMouseEvent(e,t)}},{key:"getGui",value:function(){return this.eGui}},{key:"refreshToolTip",value:function(){var e;null===(e=this.tooltipFeature)||void 0===e||e.refreshToolTip()}},{key:"getColSpanningList",value:function(){return this.cellPositionFeature.getColSpanningList()}},{key:"onLeftChanged",value:function(){var e;this.cellComp&&(null===(e=this.cellPositionFeature)||void 0===e||e.onLeftChanged())}},{key:"onDisplayedColumnsChanged",value:function(){this.eGui&&this.setAriaColIndex()}},{key:"setAriaColIndex",value:function(){var e=this.beans.columnModel.getAriaColumnIndex(this.column);ew(this.getGui(),e)}},{key:"isSuppressNavigable",value:function(){return this.column.isSuppressNavigable(this.rowNode)}},{key:"onWidthChanged",value:function(){var e;return null===(e=this.cellPositionFeature)||void 0===e?void 0:e.onWidthChanged()}},{key:"getColumn",value:function(){return this.column}},{key:"getRowNode",value:function(){return this.rowNode}},{key:"getBeans",value:function(){return this.beans}},{key:"isPrintLayout",value:function(){return this.printLayout}},{key:"appendChild",value:function(e){this.eGui.appendChild(e)}},{key:"refreshHandle",value:function(){this.cellRangeFeature&&this.cellRangeFeature.refreshHandle()}},{key:"getCellPosition",value:function(){return this.cellPosition}},{key:"isEditing",value:function(){return this.editing}},{key:"startRowOrCellEdit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.cellComp&&("fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.startRowEditing(e,this):this.startEditing(e,!0,t))}},{key:"getRowCtrl",value:function(){return this.rowCtrl}},{key:"getRowPosition",value:function(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}},{key:"updateRangeBordersIfRangeCount",value:function(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}},{key:"onRangeSelectionChanged",value:function(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}},{key:"isRangeSelectionEnabled",value:function(){return null!=this.cellRangeFeature}},{key:"focusCell",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:e})}},{key:"onRowIndexChanged",value:function(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}},{key:"onFirstRightPinnedChanged",value:function(){if(this.cellComp){var e=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",e)}}},{key:"onLastLeftPinnedChanged",value:function(){if(this.cellComp){var e=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",e)}}},{key:"onCellFocused",value:function(e){if(this.cellComp&&!this.beans.gridOptionsService.is("suppressCellFocus")){var t=this.beans.focusService.isCellFocused(this.cellPosition);if(this.cellComp.addOrRemoveCssClass("ag-cell-focus",t),t&&e&&e.forceBrowserFocus)this.cellComp.getFocusableElement().focus({preventScroll:!!e.preventScrollOnBrowserFocus});var n="fullRow"===this.beans.gridOptionsService.get("editType");t||n||!this.editing||this.stopRowOrCellEdit()}}},{key:"createCellPosition",value:function(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:hg(this.rowNode.rowPinned),column:this.column}}},{key:"applyStaticCssClasses",value:function(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);var e=1==this.column.isAutoHeight();this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",e),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!e)}},{key:"onColumnHover",value:function(){if(this.cellComp&&this.beans.gridOptionsService.is("columnHoverHighlight")){var e=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",e)}}},{key:"onColDefChanged",value:function(){this.cellComp&&(this.setWrapText(),this.editing||this.refreshCell({forceRefresh:!0,suppressFlash:!0}))}},{key:"setWrapText",value:function(){var e=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",e)}},{key:"dispatchCellContextMenuEvent",value:function(e){var t=this.column.getColDef(),n=this.createEvent(e,Ym.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(n),t.onCellContextMenu&&window.setTimeout((function(){return t.onCellContextMenu(n)}),0)}},{key:"getCellRenderer",value:function(){return this.cellComp?this.cellComp.getCellRenderer():null}},{key:"getCellEditor",value:function(){return this.cellComp?this.cellComp.getCellEditor():null}},{key:"destroy",value:function(){this.onCellCompAttachedFuncs=[],cg(D(n.prototype),"destroy",this).call(this)}},{key:"createSelectionCheckbox",value:function(){var e=new wS;return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}},{key:"createDndSource",value:function(){var e=new ok(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(e),e}},{key:"registerRowDragger",value:function(e,t,n){var r=this;if(this.customRowDragComp)this.customRowDragComp.setDragElement(e,t);else{var i=this.createRowDragComp(e,t,n);i&&(this.customRowDragComp=i,this.addDestroyFunc((function(){r.beans.context.destroyBean(i),r.customRowDragComp=null})))}}},{key:"createRowDragComp",value:function(e,t,n){var r=this,i=this.beans.gridOptionsService.is("pagination"),o=this.beans.gridOptionsService.is("rowDragManaged"),a=this.beans.gridOptionsService.isRowModelType("clientSide");if(o){if(!a)return void Lg((function(){return console.warn("AG Grid: managed row dragging is only allowed in the Client Side Row Model")}),"CellComp.addRowDragging");if(i)return void Lg((function(){return console.warn("AG Grid: managed row dragging is not possible when doing pagination")}),"CellComp.addRowDragging")}var s=new RS((function(){return r.value}),this.rowNode,this.column,e,t,n);return this.beans.context.createBean(s),s}}]),n}(Vm);lk.DOM_DATA_KEY_CELL_CTRL="cellCtrl",function(e){e.Normal="Normal",e.FullWidth="FullWidth",e.FullWidthLoading="FullWidthLoading",e.FullWidthGroup="FullWidthGroup",e.FullWidthDetail="FullWidthDetail"}(ak||(ak={}));var uk=0,ck=function(e){O(n,e);var t=F(n);function n(e,r,i,o,a){var s;return T(this,n),(s=t.call(this)).allRowGuis=[],s.active=!0,s.centerCellCtrls={list:[],map:{}},s.leftCellCtrls={list:[],map:{}},s.rightCellCtrls={list:[],map:{}},s.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},s.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},s.lastMouseDownOnDragger=!1,s.updateColumnListsPending=!1,s.businessKeySanitised=null,s.beans=r,s.gridOptionsService=r.gridOptionsService,s.rowNode=e,s.paginationPage=r.paginationProxy.getCurrentPage(),s.useAnimationFrameForCreate=o,s.printLayout=a,s.instanceId=e.id+"-"+uk++,s.setAnimateFlags(i),s.initRowBusinessKey(),s.rowFocused=r.focusService.isRowFocused(s.rowNode.rowIndex,s.rowNode.rowPinned),s.rowLevel=r.rowCssClassCalculator.calculateRowLevel(s.rowNode),s.setRowType(),s.addListeners(),s}return A(n,[{key:"initRowBusinessKey",value:function(){this.businessKeyForNodeFunc=this.gridOptionsService.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}},{key:"updateRowBusinessKey",value:function(){if("function"===typeof this.businessKeyForNodeFunc){var e=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=ry(e)}}},{key:"isSticky",value:function(){return this.rowNode.sticky}},{key:"getBeans",value:function(){return this.beans}},{key:"getInstanceId",value:function(){return this.instanceId}},{key:"setComp",value:function(e,t,n){var r={rowComp:e,element:t,containerType:n};this.allRowGuis.push(r),n===Tk.LEFT?this.leftGui=r:n===Tk.RIGHT?this.rightGui=r:n===Tk.FULL_WIDTH?this.fullWidthGui=r:this.centerGui=r,this.initialiseRowComp(r),"FullWidthLoading"===this.rowType||this.rowNode.rowPinned||this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}},{key:"unsetComp",value:function(e){this.allRowGuis=this.allRowGuis.filter((function(t){return t.containerType!==e})),e===Tk.LEFT?this.leftGui=void 0:e===Tk.RIGHT?this.rightGui=void 0:e===Tk.FULL_WIDTH&&(this.fullWidthGui=void 0)}},{key:"isCacheable",value:function(){return this.rowType===ak.FullWidthDetail&&this.gridOptionsService.is("keepDetailRows")}},{key:"setCached",value:function(e){var t=e?"none":"";this.allRowGuis.forEach((function(e){return e.element.style.display=t}))}},{key:"initialiseRowComp",value:function(e){var t=this,r=this.gridOptionsService;this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(e),r.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);var i=e.rowComp;i.setRole("row"),this.getInitialRowClasses(e.containerType).forEach((function(e){return i.addOrRemoveCssClass(e,!0)})),this.executeSlideAndFadeAnimations(e),this.rowNode.group&&Ky(e.element,1==this.rowNode.expanded),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),this.isFullWidth()&&!this.gridOptionsService.is("suppressCellFocus")&&i.setTabIndex(-1),r.setDomData(e.element,n.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc((function(){return r.setDomData(e.element,n.DOM_DATA_KEY_ROW_CTRL,null)})),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,e.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(e.element),this.isFullWidth()&&this.setupFullWidth(e),r.is("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask((function(){t.isAlive()&&e.rowComp.addOrRemoveCssClass("ag-after-created",!0)})),this.executeProcessRowPostCreateFunc()}},{key:"setRowCompRowBusinessKey",value:function(e){null!=this.businessKeySanitised&&e.setRowBusinessKey(this.businessKeySanitised)}},{key:"setRowCompRowId",value:function(e){var t=ry(this.rowNode.id);null!=t&&e.setRowId(t)}},{key:"executeSlideAndFadeAnimations",value:function(e){var t=this,n=e.containerType;this.slideInAnimation[n]&&(Vg((function(){t.onTopChanged()})),this.slideInAnimation[n]=!1),this.fadeInAnimation[n]&&(Vg((function(){e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)})),this.fadeInAnimation[n]=!1)}},{key:"addRowDraggerToRow",value:function(e){if(this.gridOptionsService.isEnableRangeSelection())Lg((function(){console.warn("AG Grid: Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`")}),"rowDragAndRangeSelectionEnabled");else{var t=this.beans.localeService.getLocaleTextFunc(),n=new RS((function(){return"1 ".concat(t("rowDragRow","row"))}),this.rowNode,void 0,e.element,void 0,!0);this.createManagedBean(n,this.beans.context)}}},{key:"setupFullWidth",value:function(e){var t=this.getPinnedForContainer(e.containerType),n=this.createFullWidthParams(e.element,t);if(this.rowType!=ak.FullWidthDetail||Qg.__assertRegistered(Xg.MasterDetailModule,"cell renderer 'agDetailCellRenderer' (for master detail)",this.beans.context.getGridId())){var r;switch(this.rowType){case ak.FullWidthDetail:r=this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(n);break;case ak.FullWidthGroup:r=this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(n);break;case ak.FullWidthLoading:r=this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(n);break;default:r=this.beans.userComponentFactory.getFullWidthCellRendererDetails(n)}e.rowComp.showFullWidth(r)}}},{key:"isPrintLayout",value:function(){return this.printLayout}},{key:"getFullWidthCellRenderer",value:function(){var e,t;return null===(t=null===(e=this.fullWidthGui)||void 0===e?void 0:e.rowComp)||void 0===t?void 0:t.getFullWidthCellRenderer()}},{key:"getCellElement",value:function(e){var t=this.getCellCtrl(e);return t?t.getGui():null}},{key:"executeProcessRowPostCreateFunc",value:function(){var e,t=this.gridOptionsService.getCallback("processRowPostCreate");t&&this.areAllContainersReady()&&t({eRow:null===(e=this.centerGui)||void 0===e?void 0:e.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})}},{key:"areAllContainersReady",value:function(){var e=!!this.leftGui||!this.beans.columnModel.isPinningLeft(),t=!!this.centerGui,n=!!this.rightGui||!this.beans.columnModel.isPinningRight();return e&&t&&n}},{key:"setRowType",value:function(){var e=this.rowNode.stub,t=this.rowNode.isFullWidthCell(),n=this.beans.doingMasterDetail&&this.rowNode.detail,r=this.beans.columnModel.isPivotMode(),i=!!this.rowNode.group&&!this.rowNode.footer&&this.gridOptionsService.isGroupUseEntireRow(r);this.rowType=e?ak.FullWidthLoading:n?ak.FullWidthDetail:t?ak.FullWidth:i?ak.FullWidthGroup:ak.Normal}},{key:"updateColumnLists",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isFullWidth()||(t||this.gridOptionsService.is("suppressAnimationFrame")||this.printLayout?this.updateColumnListsImpl(n):this.updateColumnListsPending||(this.beans.animationFrameService.createTask((function(){e.active&&e.updateColumnListsImpl(!0)}),this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0))}},{key:"createCellCtrls",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i={list:[],map:{}},o=function(e,t){i.list.push(t),i.map[e]=t};return t.forEach((function(t){var r=t.getInstanceId(),i=e.map[r];i||(i=new lk(t,n.rowNode,n.beans,n)),o(r,i)})),e.list.forEach((function(e){null!=i.map[e.getColumn().getInstanceId()]||(!n.isCellEligibleToBeRemoved(e,r)?o(e.getColumn().getInstanceId(),e):e.destroy())})),i}},{key:"updateColumnListsImpl",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateColumnListsPending=!1;var n=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,n.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{var r=n.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,r);var i=n.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,i,"left");var o=n.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,o,"right")}this.allRowGuis.forEach((function(n){var r=n.containerType===Tk.LEFT?e.leftCellCtrls:n.containerType===Tk.RIGHT?e.rightCellCtrls:e.centerCellCtrls;n.rowComp.setCellCtrls(r.list,t)}))}},{key:"isCellEligibleToBeRemoved",value:function(e,t){var n=!0;if(e.getColumn().getPinned()!=t)return n;var r=e.isEditing(),i=this.beans.focusService.isCellFocused(e.getCellPosition());if(r||i){var o=e.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(o)>=0)&&n}return n}},{key:"listenOnDomOrder",value:function(e){var t=this,n=function(){var n=t.gridOptionsService.is("ensureDomOrder"),r=t.gridOptionsService.isDomLayout("print");e.rowComp.setDomOrder(n||r)};this.addManagedPropertyListener("domLayout",n),n()}},{key:"setAnimateFlags",value:function(e){if(!this.isSticky()&&e){var t=fg(this.rowNode.oldRowTop),n=this.beans.columnModel.isPinningLeft(),r=this.beans.columnModel.isPinningRight();t?(this.slideInAnimation.center=!0,this.slideInAnimation.left=n,this.slideInAnimation.right=r):(this.fadeInAnimation.center=!0,this.fadeInAnimation.left=n,this.fadeInAnimation.right=r)}}},{key:"isEditing",value:function(){return this.editingRow}},{key:"stopRowEditing",value:function(e){this.stopEditing(e)}},{key:"isFullWidth",value:function(){return this.rowType!==ak.Normal}},{key:"getRowType",value:function(){return this.rowType}},{key:"refreshFullWidth",value:function(){var e=this,t=function(t,n){if(!t)return!0;var r=t.rowComp.getFullWidthCellRenderer();if(!r)return!1;if(!r.refresh)return!1;var i=e.createFullWidthParams(t.element,n);return r.refresh(i)},n=t(this.fullWidthGui,null),r=t(this.centerGui,null),i=t(this.leftGui,"left"),o=t(this.rightGui,"right");return n&&r&&i&&o}},{key:"addListeners",value:function(){var e=this;this.addManagedListener(this.rowNode,mS.EVENT_HEIGHT_CHANGED,(function(){return e.onRowHeightChanged()})),this.addManagedListener(this.rowNode,mS.EVENT_ROW_SELECTED,(function(){return e.onRowSelected()})),this.addManagedListener(this.rowNode,mS.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_CELL_CHANGED,this.onRowNodeCellChanged.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_DRAGGING_CHANGED,this.onRowNodeDraggingChanged.bind(this)),this.addManagedListener(this.rowNode,mS.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));var t=this.beans.eventService;this.addManagedListener(t,Ym.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(t,Ym.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(t,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(t,Ym.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(t,Ym.EVENT_CELL_FOCUSED,this.onCellFocused.bind(this)),this.addManagedListener(t,Ym.EVENT_CELL_FOCUS_CLEARED,this.onCellFocusCleared.bind(this)),this.addManagedListener(t,Ym.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(t,Ym.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedListener(t,Ym.EVENT_COLUMN_MOVED,this.onColumnMoved.bind(this)),this.addListenersForCellComps()}},{key:"onColumnMoved",value:function(){this.updateColumnLists()}},{key:"addListenersForCellComps",value:function(){var e=this;this.addManagedListener(this.rowNode,mS.EVENT_ROW_INDEX_CHANGED,(function(){e.getAllCellCtrls().forEach((function(e){return e.onRowIndexChanged()}))})),this.addManagedListener(this.rowNode,mS.EVENT_CELL_CHANGED,(function(t){e.getAllCellCtrls().forEach((function(e){return e.onCellChanged(t)}))}))}},{key:"onRowNodeDataChanged",value:function(e){var t=this;this.rowNode.detailNode&&this.beans.rowRenderer.refreshFullWidthRow(this.rowNode.detailNode),this.isFullWidth()?this.beans.rowRenderer.refreshFullWidthRow(this.rowNode):(this.getAllCellCtrls().forEach((function(t){return t.refreshCell({suppressFlash:!e.update,newData:!e.update})})),this.allRowGuis.forEach((function(e){t.setRowCompRowId(e.rowComp),t.updateRowBusinessKey(),t.setRowCompRowBusinessKey(e.rowComp)})),this.onRowSelected(),this.postProcessCss())}},{key:"onRowNodeCellChanged",value:function(){this.postProcessCss()}},{key:"postProcessCss",value:function(){this.setStylesFromGridOptions(),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}},{key:"onRowNodeHighlightChanged",value:function(){var e=this.rowNode.highlighted;this.allRowGuis.forEach((function(t){var n=e===bE.Above,r=e===bE.Below;t.rowComp.addOrRemoveCssClass("ag-row-highlight-above",n),t.rowComp.addOrRemoveCssClass("ag-row-highlight-below",r)}))}},{key:"onRowNodeDraggingChanged",value:function(){this.postProcessRowDragging()}},{key:"postProcessRowDragging",value:function(){var e=this.rowNode.dragging;this.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass("ag-row-dragging",e)}))}},{key:"updateExpandedCss",value:function(){var e=this.rowNode.isExpandable(),t=1==this.rowNode.expanded;this.allRowGuis.forEach((function(n){n.rowComp.addOrRemoveCssClass("ag-row-group",e),n.rowComp.addOrRemoveCssClass("ag-row-group-expanded",e&&t),n.rowComp.addOrRemoveCssClass("ag-row-group-contracted",e&&!t),Ky(n.element,e&&t)}))}},{key:"onDisplayedColumnsChanged",value:function(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}},{key:"onVirtualColumnsChanged",value:function(){this.updateColumnLists(!1,!0)}},{key:"getRowPosition",value:function(){return{rowPinned:hg(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}},{key:"onKeyboardNavigate",value:function(e){var t=this.allRowGuis.find((function(t){return t.element.contains(e.target)}));if((t?t.element:null)===e.target){var n=this.rowNode,r=this.beans.focusService.getFocusedCell(),i={rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:r&&r.column};this.beans.navigationService.navigateToNextCell(e,e.key,i,!0),e.preventDefault()}}},{key:"onTabKeyDown",value:function(e){if(!e.defaultPrevented&&!Pm(e)){var t=this.allRowGuis.find((function(t){return t.element.contains(e.target)})),n=t?t.element:null,r=n===e.target,i=null;r||(i=this.beans.focusService.findNextFocusableElement(n,!1,e.shiftKey)),(this.isFullWidth()&&r||!i)&&this.beans.navigationService.onTabKeyDown(this,e)}}},{key:"onFullWidthRowFocused",value:function(e){var t,n=this.rowNode,r=!!e&&(this.isFullWidth()&&e.rowIndex===n.rowIndex&&e.rowPinned==n.rowPinned),i=this.fullWidthGui?this.fullWidthGui.element:null===(t=this.centerGui)||void 0===t?void 0:t.element;i&&(i.classList.toggle("ag-full-width-focus",r),r&&i.focus({preventScroll:!0}))}},{key:"refreshCell",value:function(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),this.updateColumnLists()}},{key:"removeCellCtrl",value:function(e,t){var n={list:[],map:{}};return e.list.forEach((function(e){e!==t&&(n.list.push(e),n.map[e.getInstanceId()]=e)})),n}},{key:"onMouseEvent",value:function(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t)}}},{key:"createRowEvent",value:function(e,t){return{type:e,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,context:this.gridOptionsService.context,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,event:t}}},{key:"createRowEventWithSource",value:function(e,t){var n=this.createRowEvent(e,t);return n.source=this,n}},{key:"onRowDblClick",value:function(e){if(!Pm(e)){var t=this.createRowEventWithSource(Ym.EVENT_ROW_DOUBLE_CLICKED,e);this.beans.eventService.dispatchEvent(t)}}},{key:"onRowMouseDown",value:function(e){if(this.lastMouseDownOnDragger=qw(e.target,"ag-row-drag",3),this.isFullWidth()){var t=this.rowNode,n=this.beans.columnModel;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges(),this.beans.focusService.setFocusedCell({rowIndex:t.rowIndex,column:n.getAllDisplayedColumns()[0],rowPinned:t.rowPinned,forceBrowserFocus:!0})}}},{key:"onRowClick",value:function(e){if(!(Pm(e)||this.lastMouseDownOnDragger)){var t=this.createRowEventWithSource(Ym.EVENT_ROW_CLICKED,e);this.beans.eventService.dispatchEvent(t);var n=e.ctrlKey||e.metaKey,r=e.shiftKey;if(!(this.gridOptionsService.is("groupSelectsChildren")&&this.rowNode.group||!this.rowNode.selectable||this.rowNode.rowPinned||!this.gridOptionsService.isRowSelection()||this.gridOptionsService.is("suppressRowClickSelection"))){var i=this.gridOptionsService.is("rowMultiSelectWithClick"),o=!this.gridOptionsService.is("suppressRowDeselection"),a="rowClicked";if(this.rowNode.isSelected())i?this.rowNode.setSelectedParams({newValue:!1,event:e,source:a}):n?o&&this.rowNode.setSelectedParams({newValue:!1,event:e,source:a}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!r,rangeSelect:r,event:e,source:a});else{var s=!i&&!n;this.rowNode.setSelectedParams({newValue:!0,clearSelection:s,rangeSelect:r,event:e,source:a})}}}}},{key:"setupDetailRowAutoHeight",value:function(e){var t=this;if(this.rowType===ak.FullWidthDetail&&this.gridOptionsService.is("detailRowAutoHeight")){var n=function(){var n=e.clientHeight;if(null!=n&&n>0){t.beans.frameworkOverrides.setTimeout((function(){t.rowNode.setRowHeight(n),t.beans.clientSideRowModel?t.beans.clientSideRowModel.onRowHeightChanged():t.beans.serverSideRowModel&&t.beans.serverSideRowModel.onRowHeightChanged()}),0)}},r=this.beans.resizeObserverService.observeResize(e,n);this.addDestroyFunc(r),n()}}},{key:"createFullWidthParams",value:function(e,t){var n=this,r={fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,rowIndex:this.rowNode.rowIndex,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:function(e,t,r,i){return n.addFullWidthRowDragging(e,t,r,i)}};return r}},{key:"addFullWidthRowDragging",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3?arguments[3]:void 0;if(this.isFullWidth()){var i=new RS((function(){return n}),this.rowNode,void 0,e,t,r);this.createManagedBean(i,this.beans.context)}}},{key:"onUiLevelChanged",value:function(){var e=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=e){var t="ag-row-level-"+e,n="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach((function(e){e.rowComp.addOrRemoveCssClass(t,!0),e.rowComp.addOrRemoveCssClass(n,!1)}))}this.rowLevel=e}},{key:"isFirstRowOnPage",value:function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()}},{key:"isLastRowOnPage",value:function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()}},{key:"onModelUpdated",value:function(){this.refreshFirstAndLastRowStyles()}},{key:"refreshFirstAndLastRowStyles",value:function(){var e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();this.firstRowOnPage!==e&&(this.firstRowOnPage=e,this.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass("ag-row-first",e)}))),this.lastRowOnPage!==t&&(this.lastRowOnPage=t,this.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass("ag-row-last",t)})))}},{key:"stopEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.stoppingRowEdit){var t=this.getAllCellCtrls(),n=this.editingRow;this.stoppingRowEdit=!0;var r,i=!1,o=dg(t);try{for(o.s();!(r=o.n()).done;){var a=r.value.stopEditing(e);n&&!e&&!i&&a&&(i=!0)}}catch(l){o.e(l)}finally{o.f()}if(i){var s=this.createRowEvent(Ym.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(s)}n&&this.setEditingRow(!1),this.stoppingRowEdit=!1}}},{key:"setInlineEditingCss",value:function(e){this.allRowGuis.forEach((function(t){t.rowComp.addOrRemoveCssClass("ag-row-inline-editing",e),t.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!e)}))}},{key:"setEditingRow",value:function(e){this.editingRow=e,this.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass("ag-row-editing",e)}));var t=e?this.createRowEvent(Ym.EVENT_ROW_EDITING_STARTED):this.createRowEvent(Ym.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(t)}},{key:"startRowEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.editingRow||this.getAllCellCtrls().reduce((function(r,i){var o=i===t;return o?i.startEditing(e,o,n):i.startEditing(null,o,n),!!r||i.isEditing()}),!1)&&this.setEditingRow(!0)}},{key:"getAllCellCtrls",value:function(){return 0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length?this.centerCellCtrls.list:[].concat(wt(this.centerCellCtrls.list),wt(this.leftCellCtrls.list),wt(this.rightCellCtrls.list))}},{key:"postProcessClassesFromGridOptions",value:function(){var e=this,t=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);t&&t.length&&t.forEach((function(t){e.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass(t,!0)}))}))}},{key:"postProcessRowClassRules",value:function(){var e=this;this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,(function(t){e.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass(t,!0)}))}),(function(t){e.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass(t,!1)}))}))}},{key:"setStylesFromGridOptions",value:function(e){var t=this.processStylesFromGridOptions();this.forEachGui(e,(function(e){return e.rowComp.setUserStyles(t)}))}},{key:"getPinnedForContainer",value:function(e){return e===Tk.LEFT?"left":e===Tk.RIGHT?"right":null}},{key:"getInitialRowClasses",value:function(e){var t=this.getPinnedForContainer(e),n={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[e],rowIsEven:this.rowNode.rowIndex%2===0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:t};return this.beans.rowCssClassCalculator.getInitialRowClasses(n)}},{key:"processStylesFromGridOptions",value:function(){var e=this.gridOptionsService.get("rowStyle");if(!e||"function"!==typeof e){var t,n=this.gridOptionsService.getCallback("getRowStyle");if(n)t=n({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex});return Object.assign({},e,t)}console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead")}},{key:"onRowSelected",value:function(e){var t=this,n=!!this.rowNode.isSelected();this.forEachGui(e,(function(e){e.rowComp.addOrRemoveCssClass("ag-row-selected",n),iw(e.element,!!n||void 0);var r=t.createAriaLabel();Gy(e.element,null==r?"":r)}))}},{key:"createAriaLabel",value:function(){var e=this.rowNode.isSelected();if(!e||!this.gridOptionsService.is("suppressRowDeselection"))return this.beans.localeService.getLocaleTextFunc()(e?"ariaRowDeselect":"ariaRowSelect","Press SPACE to ".concat(e?"deselect":"select"," this row."))}},{key:"isUseAnimationFrameForCreate",value:function(){return this.useAnimationFrameForCreate}},{key:"addHoverFunctionality",value:function(e){var t=this;this.active&&(this.addManagedListener(e,"mouseenter",(function(){return t.rowNode.onMouseEnter()})),this.addManagedListener(e,"mouseleave",(function(){return t.rowNode.onMouseLeave()})),this.addManagedListener(this.rowNode,mS.EVENT_MOUSE_ENTER,(function(){t.beans.dragService.isDragging()||t.gridOptionsService.is("suppressRowHoverHighlight")||(e.classList.add("ag-row-hover"),t.rowNode.setHovered(!0))})),this.addManagedListener(this.rowNode,mS.EVENT_MOUSE_LEAVE,(function(){e.classList.remove("ag-row-hover"),t.rowNode.setHovered(!1)})))}},{key:"roundRowTopToBounds",value:function(e){var t=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.applyPaginationOffset(t.top,!0)-100,r=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(n,e),r)}},{key:"getFrameworkOverrides",value:function(){return this.beans.frameworkOverrides}},{key:"forEachGui",value:function(e,t){(e?[e]:this.allRowGuis).forEach(t)}},{key:"onRowHeightChanged",value:function(e){if(null!=this.rowNode.rowHeight){var t=this.rowNode.rowHeight,n=this.beans.environment.getDefaultRowHeight(),r=this.gridOptionsService.isGetRowHeightFunction()?this.gridOptionsService.getRowHeightForNode(this.rowNode).height:void 0,i=r?"".concat(Math.min(n,r)-2,"px"):void 0;this.forEachGui(e,(function(e){e.element.style.height="".concat(t,"px"),i&&e.element.style.setProperty("--ag-line-height",i)}))}}},{key:"addEventListener",value:function(e,t){cg(D(n.prototype),"addEventListener",this).call(this,e,t)}},{key:"removeEventListener",value:function(e,t){cg(D(n.prototype),"removeEventListener",this).call(this,e,t)}},{key:"destroyFirstPass",value:function(){this.active=!1,this.gridOptionsService.isAnimateRows()&&this.setupRemoveAnimation(),this.rowNode.setHovered(!1);var e=this.createRowEvent(Ym.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(e),this.beans.eventService.dispatchEvent(e),cg(D(n.prototype),"destroy",this).call(this)}},{key:"setupRemoveAnimation",value:function(){if(!this.isSticky())if(null!=this.rowNode.rowTop){var e=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(e)}else this.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0)}))}},{key:"destroySecondPass",value:function(){this.allRowGuis.length=0;var e=function(e){return e.list.forEach((function(e){return e.destroy()})),{list:[],map:{}}};this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}},{key:"setFocusedClasses",value:function(e){var t=this;this.forEachGui(e,(function(e){e.rowComp.addOrRemoveCssClass("ag-row-focus",t.rowFocused),e.rowComp.addOrRemoveCssClass("ag-row-no-focus",!t.rowFocused)}))}},{key:"onCellFocused",value:function(){this.onCellFocusChanged()}},{key:"onCellFocusCleared",value:function(){this.onCellFocusChanged()}},{key:"onCellFocusChanged",value:function(){var e=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);e!==this.rowFocused&&(this.rowFocused=e,this.setFocusedClasses()),!e&&this.editingRow&&this.stopEditing(!1)}},{key:"onPaginationChanged",value:function(){var e=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}},{key:"onTopChanged",value:function(){this.setRowTop(this.rowNode.rowTop)}},{key:"onPaginationPixelOffsetChanged",value:function(){this.onTopChanged()}},{key:"applyPaginationOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.rowNode.isRowPinned()||this.rowNode.sticky?e:e+this.beans.paginationProxy.getPixelOffset()*(t?1:-1)}},{key:"setRowTop",value:function(e){if(!this.printLayout&&fg(e)){var t=this.applyPaginationOffset(e),n=this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeightService.getRealPixelPosition(t),r="".concat(n,"px");this.setRowTopStyle(r)}}},{key:"getInitialRowTop",value:function(e){return this.gridOptionsService.is("suppressRowTransform")?this.getInitialRowTopShared(e):void 0}},{key:"getInitialTransform",value:function(e){return this.gridOptionsService.is("suppressRowTransform")?void 0:"translateY(".concat(this.getInitialRowTopShared(e),")")}},{key:"getInitialRowTopShared",value:function(e){if(this.printLayout)return"";var t;if(this.isSticky())t=this.rowNode.stickyRowTop;else{var n=this.slideInAnimation[e]?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,r=this.applyPaginationOffset(n);t=this.rowNode.isRowPinned()?r:this.beans.rowContainerHeightService.getRealPixelPosition(r)}return t+"px"}},{key:"setRowTopStyle",value:function(e){var t=this.gridOptionsService.is("suppressRowTransform");this.allRowGuis.forEach((function(n){return t?n.rowComp.setTop(e):n.rowComp.setTransform("translateY(".concat(e,")"))}))}},{key:"getRowNode",value:function(){return this.rowNode}},{key:"getCellCtrl",value:function(e){var t=null;return this.getAllCellCtrls().forEach((function(n){n.getColumn()==e&&(t=n)})),null!=t||this.getAllCellCtrls().forEach((function(n){n.getColSpanningList().indexOf(e)>=0&&(t=n)})),t}},{key:"onRowIndexChanged",value:function(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}},{key:"updateRowIndexes",value:function(e){var t=this.rowNode.getRowIndexString(),n=this.beans.headerNavigationService.getHeaderRowCount(),r=this.rowNode.rowIndex%2===0,i=n+this.rowNode.rowIndex+1;this.forEachGui(e,(function(e){e.rowComp.setRowIndex(t),e.rowComp.addOrRemoveCssClass("ag-row-even",r),e.rowComp.addOrRemoveCssClass("ag-row-odd",!r),Jy(e.element,i)}))}},{key:"getPinnedLeftRowElement",value:function(){return this.leftGui?this.leftGui.element:void 0}},{key:"getPinnedRightRowElement",value:function(){return this.rightGui?this.rightGui.element:void 0}},{key:"getBodyRowElement",value:function(){return this.centerGui?this.centerGui.element:void 0}},{key:"getFullWidthRowElement",value:function(){return this.fullWidthGui?this.fullWidthGui.element:void 0}}]),n}(Vm);ck.DOM_DATA_KEY_ROW_CTRL="renderedRow";var dk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},hk=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).element=e,r}return A(n,[{key:"postConstruct",value:function(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}},{key:"addKeyboardListeners",value:function(){var e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedListener(this.element,e,t)}},{key:"addMouseListeners",value:function(){var e=this;["dblclick","contextmenu","mouseover","mouseout","click",Fm("touchstart")?"touchstart":"mousedown"].forEach((function(t){var n=e.processMouseEvent.bind(e,t);e.addManagedListener(e.element,t,n)}))}},{key:"processMouseEvent",value:function(e,t){if(this.mouseEventService.isEventFromThisGrid(t)&&!Pm(t)){var n=this.getRowForEvent(t),r=this.mouseEventService.getRenderedCellForEvent(t);"contextmenu"===e?this.handleContextMenuMouseEvent(t,null,n,r):(r&&r.onMouseEvent(e,t),n&&n.onMouseEvent(e,t))}}},{key:"mockContextMenuForIPad",value:function(){var e=this;if(Cw()){var t=new ZC(this.element);this.addManagedListener(t,ZC.EVENT_LONG_TAP,(function(t){var n=e.getRowForEvent(t.touchEvent),r=e.mouseEventService.getRenderedCellForEvent(t.touchEvent);e.handleContextMenuMouseEvent(null,t.touchEvent,n,r)})),this.addDestroyFunc((function(){return t.destroy()}))}}},{key:"getRowForEvent",value:function(e){for(var t=e.target;t;){var n=this.gridOptionsService.getDomData(t,ck.DOM_DATA_KEY_ROW_CTRL);if(n)return n;t=t.parentElement}return null}},{key:"handleContextMenuMouseEvent",value:function(e,t,n,r){var i=n?n.getRowNode():null,o=r?r.getColumn():null,a=null;if(o){var s=e||t;r.dispatchCellContextMenuEvent(s),a=this.valueService.getValue(o,i)}var l=this.ctrlsService.getGridBodyCtrl(),u=r?r.getGui():l.getGridBodyElement();this.contextMenuFactory&&this.contextMenuFactory.onContextMenu(e,t,i,o,a,u)}},{key:"getControlsForEventTarget",value:function(e){return{cellCtrl:Im(this.gridOptionsService,e,lk.DOM_DATA_KEY_CELL_CTRL),rowCtrl:Im(this.gridOptionsService,e,ck.DOM_DATA_KEY_ROW_CTRL)}}},{key:"processKeyboardEvent",value:function(e,t){var n=this.getControlsForEventTarget(t.target),r=n.cellCtrl,i=n.rowCtrl;t.defaultPrevented||(r?this.processCellKeyboardEvent(r,e,t):i&&i.isFullWidth()&&this.processFullWidthRowKeyboardEvent(i,e,t))}},{key:"processCellKeyboardEvent",value:function(e,t,n){var r=e.getRowNode(),i=e.getColumn(),o=e.isEditing();Db(this.gridOptionsService,n,r,i,o)||"keydown"===t&&(!o&&this.navigationService.handlePageScrollingKey(n)||e.onKeyDown(n),this.doGridOperations(n,e.isEditing()),Ob(n)&&e.processCharacter(n));if("keydown"===t){var a=e.createEvent(n,Ym.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(a)}}},{key:"processFullWidthRowKeyboardEvent",value:function(e,t,n){var r=e.getRowNode(),i=this.focusService.getFocusedCell(),o=i&&i.column;if(!Db(this.gridOptionsService,n,r,o,!1)){var a=n.key;if("keydown"===t)switch(a){case _b.PAGE_HOME:case _b.PAGE_END:case _b.PAGE_UP:case _b.PAGE_DOWN:this.navigationService.handlePageScrollingKey(n,!0);break;case _b.UP:case _b.DOWN:e.onKeyboardNavigate(n);break;case _b.TAB:e.onTabKeyDown(n)}}if("keydown"===t){var s=e.createRowEvent(Ym.EVENT_CELL_KEY_DOWN,n);this.eventService.dispatchEvent(s)}}},{key:"doGridOperations",value:function(e,t){if((e.ctrlKey||e.metaKey)&&!t&&this.mouseEventService.isEventFromThisGrid(e)){var n=Pb(e);return n===_b.A?this.onCtrlAndA(e):n===_b.C?this.onCtrlAndC(e):n===_b.D?this.onCtrlAndD(e):n===_b.V?this.onCtrlAndV(e):n===_b.X?this.onCtrlAndX(e):n===_b.Y?this.onCtrlAndY():n===_b.Z?this.onCtrlAndZ(e):void 0}}},{key:"onCtrlAndA",value:function(e){var t=this.pinnedRowModel,n=this.paginationProxy,r=this.rangeService;if(r&&n.isRowsToRender()){var i,o,a=[t.isEmpty("top"),t.isEmpty("bottom")],s=a[0]?null:"top";a[1]?(i=null,o=this.paginationProxy.getRowCount()-1):(i="bottom",o=t.getPinnedBottomRowData().length-1);var l=this.columnModel.getAllDisplayedColumns();if(vg(l))return;r.setCellRange({rowStartIndex:0,rowStartPinned:s,rowEndIndex:o,rowEndPinned:i,columnStart:l[0],columnEnd:ym(l)})}e.preventDefault()}},{key:"onCtrlAndC",value:function(e){if(this.clipboardService&&!this.gridOptionsService.is("enableCellTextSelection")){var t=this.getControlsForEventTarget(e.target),n=t.cellCtrl,r=t.rowCtrl;(null===n||void 0===n?void 0:n.isEditing())||(null===r||void 0===r?void 0:r.isEditing())||(e.preventDefault(),this.clipboardService.copyToClipboard())}}},{key:"onCtrlAndX",value:function(e){if(this.clipboardService&&!this.gridOptionsService.is("enableCellTextSelection")&&!this.gridOptionsService.is("suppressCutToClipboard")){var t=this.getControlsForEventTarget(e.target),n=t.cellCtrl,r=t.rowCtrl;(null===n||void 0===n?void 0:n.isEditing())||(null===r||void 0===r?void 0:r.isEditing())||(e.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}}},{key:"onCtrlAndV",value:function(e){var t=this.getControlsForEventTarget(e.target),n=t.cellCtrl,r=t.rowCtrl;(null===n||void 0===n?void 0:n.isEditing())||(null===r||void 0===r?void 0:r.isEditing())||this.clipboardService&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}},{key:"onCtrlAndD",value:function(e){this.clipboardService&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),e.preventDefault()}},{key:"onCtrlAndZ",value:function(e){this.gridOptionsService.is("undoRedoCellEditing")&&(e.preventDefault(),e.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}},{key:"onCtrlAndY",value:function(){this.undoRedoService.redo("ui")}}]),n}(Vm);dk([nm("mouseEventService")],hk.prototype,"mouseEventService",void 0),dk([nm("valueService")],hk.prototype,"valueService",void 0),dk([rm("contextMenuFactory")],hk.prototype,"contextMenuFactory",void 0),dk([nm("ctrlsService")],hk.prototype,"ctrlsService",void 0),dk([nm("navigationService")],hk.prototype,"navigationService",void 0),dk([nm("focusService")],hk.prototype,"focusService",void 0),dk([nm("undoRedoService")],hk.prototype,"undoRedoService",void 0),dk([nm("columnModel")],hk.prototype,"columnModel",void 0),dk([nm("paginationProxy")],hk.prototype,"paginationProxy",void 0),dk([nm("pinnedRowModel")],hk.prototype,"pinnedRowModel",void 0),dk([rm("rangeService")],hk.prototype,"rangeService",void 0),dk([rm("clipboardService")],hk.prototype,"clipboardService",void 0),dk([$g],hk.prototype,"postConstruct",null);var fk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},pk=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).centerContainerCtrl=e,r}return A(n,[{key:"postConstruct",value:function(){var e=this;this.ctrlsService.whenReady((function(){e.gridBodyCtrl=e.ctrlsService.getGridBodyCtrl(),e.listenForResize()})),this.addManagedListener(this.eventService,Ym.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this))}},{key:"listenForResize",value:function(){var e=this,t=function(){return e.onCenterViewportResized()};this.centerContainerCtrl.registerViewportResizeListener(t),this.gridBodyCtrl.registerBodyViewportResizeListener(t)}},{key:"onScrollbarWidthChanged",value:function(){this.checkViewportAndScrolls()}},{key:"onCenterViewportResized",value:function(){if(this.centerContainerCtrl.isViewportVisible()){this.checkViewportAndScrolls();var e=this.centerContainerCtrl.getCenterWidth();e!==this.centerWidth&&(this.centerWidth=e,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}},{key:"checkViewportAndScrolls",value:function(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}},{key:"getBodyHeight",value:function(){return this.bodyHeight}},{key:"checkBodyHeight",value:function(){var e=Yw(this.gridBodyCtrl.getBodyViewportElement());if(this.bodyHeight!==e){this.bodyHeight=e;var t={type:Ym.EVENT_BODY_HEIGHT_CHANGED};this.eventService.dispatchEvent(t)}}},{key:"updateScrollVisibleService",value:function(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}},{key:"updateScrollVisibleServiceImpl",value:function(){var e={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(e)}},{key:"isHorizontalScrollShowing",value:function(){return this.centerContainerCtrl.isHorizontalScrollShowing()}},{key:"onHorizontalViewportChanged",value:function(){var e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.columnModel.setViewportPosition(e,t)}}]),n}(Vm);fk([nm("ctrlsService")],pk.prototype,"ctrlsService",void 0),fk([nm("columnModel")],pk.prototype,"columnModel",void 0),fk([nm("scrollVisibleService")],pk.prototype,"scrollVisibleService",void 0),fk([$g],pk.prototype,"postConstruct",null);var vk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},gk=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).element=e,r}return A(n,[{key:"postConstruct",value:function(){this.addManagedListener(this.eventService,Ym.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))}},{key:"onPinnedLeftWidthChanged",value:function(){var e=this.pinnedWidthService.getPinnedLeftWidth(),t=e>0;zw(this.element,t),gb(this.element,e)}},{key:"getWidth",value:function(){return this.pinnedWidthService.getPinnedLeftWidth()}}]),n}(Vm);vk([nm("pinnedWidthService")],gk.prototype,"pinnedWidthService",void 0),vk([$g],gk.prototype,"postConstruct",null);var mk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},yk=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).element=e,r}return A(n,[{key:"postConstruct",value:function(){this.addManagedListener(this.eventService,Ym.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))}},{key:"onPinnedRightWidthChanged",value:function(){var e=this.pinnedWidthService.getPinnedRightWidth(),t=e>0;zw(this.element,t),gb(this.element,e)}},{key:"getWidth",value:function(){return this.pinnedWidthService.getPinnedRightWidth()}}]),n}(Vm);mk([nm("pinnedWidthService")],yk.prototype,"pinnedWidthService",void 0),mk([$g],yk.prototype,"postConstruct",null);var wk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},bk=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this)).eContainer=e,i.eWrapper=r,i}return A(n,[{key:"postConstruct",value:function(){this.addManagedListener(this.eventService,Ym.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))}},{key:"onHeightChanged",value:function(){var e=this.maxDivHeightScaler.getUiContainerHeight(),t=null!=e?"".concat(e,"px"):"";this.eContainer.style.height=t,this.eWrapper&&(this.eWrapper.style.height=t)}}]),n}(Vm);wk([nm("rowContainerHeightService")],bk.prototype,"maxDivHeightScaler",void 0),wk([$g],bk.prototype,"postConstruct",null);var Ck=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Sk=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).eContainer=e,r}return A(n,[{key:"postConstruct",value:function(){var e=this;if(this.gridOptionsService.isEnableRangeSelection()&&!pg(this.rangeService)){var t={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)};this.dragService.addDragSource(t),this.addDestroyFunc((function(){return e.dragService.removeDragSource(t)}))}}}]),n}(Vm);Ck([rm("rangeService")],Sk.prototype,"rangeService",void 0),Ck([nm("dragService")],Sk.prototype,"dragService",void 0),Ck([$g],Sk.prototype,"postConstruct",null);var Ek=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},kk=function(e){O(n,e);var t=F(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return T(this,n),(r=t.call(this)).callback=e,r.addSpacer=i,r}return A(n,[{key:"postConstruct",value:function(){var e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,Ym.EVENT_LEFT_PINNED_WIDTH_CHANGED,e),this.addSpacer&&(this.addManagedListener(this.eventService,Ym.EVENT_RIGHT_PINNED_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,Ym.EVENT_SCROLL_VISIBILITY_CHANGED,e),this.addManagedListener(this.eventService,Ym.EVENT_SCROLLBAR_WIDTH_CHANGED,e)),this.setWidth()}},{key:"setWidth",value:function(){var e,t=this.columnModel,n=this.gridOptionsService.isDomLayout("print"),r=t.getBodyContainerWidth(),i=t.getDisplayedColumnsLeftWidth(),o=t.getDisplayedColumnsRightWidth();n?e=r+i+o:(e=r,this.addSpacer&&0===(this.gridOptionsService.is("enableRtl")?i:o)&&this.scrollVisibleService.isVerticalScrollShowing()&&(e+=this.gridOptionsService.getScrollbarWidth()));this.callback(e)}}]),n}(Vm);Ek([nm("columnModel")],kk.prototype,"columnModel",void 0),Ek([nm("scrollVisibleService")],kk.prototype,"scrollVisibleService",void 0),Ek([$g],kk.prototype,"postConstruct",null);var xk,Tk,Rk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};function Ak(e){switch(e){case xk.CENTER:case xk.TOP_CENTER:case xk.STICKY_TOP_CENTER:case xk.BOTTOM_CENTER:return Tk.CENTER;case xk.LEFT:case xk.TOP_LEFT:case xk.STICKY_TOP_LEFT:case xk.BOTTOM_LEFT:return Tk.LEFT;case xk.RIGHT:case xk.TOP_RIGHT:case xk.STICKY_TOP_RIGHT:case xk.BOTTOM_RIGHT:return Tk.RIGHT;case xk.FULL_WIDTH:case xk.TOP_FULL_WIDTH:case xk.STICKY_TOP_FULL_WIDTH:case xk.BOTTOM_FULL_WIDTH:return Tk.FULL_WIDTH;default:throw Error("Invalid Row Container Type")}}!function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.FULL_WIDTH="fullWidth",e.TOP_LEFT="topLeft",e.TOP_RIGHT="topRight",e.TOP_CENTER="topCenter",e.TOP_FULL_WIDTH="topFullWidth",e.STICKY_TOP_LEFT="stickyTopLeft",e.STICKY_TOP_RIGHT="stickyTopRight",e.STICKY_TOP_CENTER="stickyTopCenter",e.STICKY_TOP_FULL_WIDTH="stickyTopFullWidth",e.BOTTOM_LEFT="bottomLeft",e.BOTTOM_RIGHT="bottomRight",e.BOTTOM_CENTER="bottomCenter",e.BOTTOM_FULL_WIDTH="bottomFullWidth"}(xk||(xk={})),function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.FULL_WIDTH="fullWidth"}(Tk||(Tk={}));var _k=sy([[xk.CENTER,"ag-center-cols-container"],[xk.LEFT,"ag-pinned-left-cols-container"],[xk.RIGHT,"ag-pinned-right-cols-container"],[xk.FULL_WIDTH,"ag-full-width-container"],[xk.TOP_CENTER,"ag-floating-top-container"],[xk.TOP_LEFT,"ag-pinned-left-floating-top"],[xk.TOP_RIGHT,"ag-pinned-right-floating-top"],[xk.TOP_FULL_WIDTH,"ag-floating-top-full-width-container"],[xk.STICKY_TOP_CENTER,"ag-sticky-top-container"],[xk.STICKY_TOP_LEFT,"ag-pinned-left-sticky-top"],[xk.STICKY_TOP_RIGHT,"ag-pinned-right-sticky-top"],[xk.STICKY_TOP_FULL_WIDTH,"ag-sticky-top-full-width-container"],[xk.BOTTOM_CENTER,"ag-floating-bottom-container"],[xk.BOTTOM_LEFT,"ag-pinned-left-floating-bottom"],[xk.BOTTOM_RIGHT,"ag-pinned-right-floating-bottom"],[xk.BOTTOM_FULL_WIDTH,"ag-floating-bottom-full-width-container"]]),Ok=sy([[xk.CENTER,"ag-center-cols-viewport"],[xk.TOP_CENTER,"ag-floating-top-viewport"],[xk.STICKY_TOP_CENTER,"ag-sticky-top-viewport"],[xk.BOTTOM_CENTER,"ag-floating-bottom-viewport"]]),Dk=sy([[xk.CENTER,"ag-center-cols-clipper"]]),Nk=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).visible=!0,r.EMPTY_CTRLS=[],r.name=e,r.isFullWithContainer=r.name===xk.TOP_FULL_WIDTH||r.name===xk.STICKY_TOP_FULL_WIDTH||r.name===xk.BOTTOM_FULL_WIDTH||r.name===xk.FULL_WIDTH,r}return A(n,[{key:"postConstruct",value:function(){var e=this;this.enableRtl=this.gridOptionsService.is("enableRtl"),this.embedFullWidthRows=this.gridOptionsService.is("embedFullWidthRows"),this.forContainers([xk.CENTER],(function(){return e.viewportSizeFeature=e.createManagedBean(new pk(e))}))}},{key:"registerWithCtrlsService",value:function(){switch(this.name){case xk.CENTER:this.ctrlsService.registerCenterRowContainerCtrl(this);break;case xk.LEFT:this.ctrlsService.registerLeftRowContainerCtrl(this);break;case xk.RIGHT:this.ctrlsService.registerRightRowContainerCtrl(this);break;case xk.TOP_CENTER:this.ctrlsService.registerTopCenterRowContainerCtrl(this);break;case xk.TOP_LEFT:this.ctrlsService.registerTopLeftRowContainerCon(this);break;case xk.TOP_RIGHT:this.ctrlsService.registerTopRightRowContainerCtrl(this);break;case xk.STICKY_TOP_CENTER:this.ctrlsService.registerStickyTopCenterRowContainerCtrl(this);break;case xk.STICKY_TOP_LEFT:this.ctrlsService.registerStickyTopLeftRowContainerCon(this);break;case xk.STICKY_TOP_RIGHT:this.ctrlsService.registerStickyTopRightRowContainerCtrl(this);break;case xk.BOTTOM_CENTER:this.ctrlsService.registerBottomCenterRowContainerCtrl(this);break;case xk.BOTTOM_LEFT:this.ctrlsService.registerBottomLeftRowContainerCtrl(this);break;case xk.BOTTOM_RIGHT:this.ctrlsService.registerBottomRightRowContainerCtrl(this)}}},{key:"forContainers",value:function(e,t){e.indexOf(this.name)>=0&&t()}},{key:"getContainerElement",value:function(){return this.eContainer}},{key:"getViewportSizeFeature",value:function(){return this.viewportSizeFeature}},{key:"setComp",value:function(e,t,n,r){var i=this;this.comp=e,this.eContainer=t,this.eViewport=n,this.eWrapper=r,this.createManagedBean(new hk(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();var o=[xk.TOP_CENTER,xk.TOP_LEFT,xk.TOP_RIGHT],a=[xk.STICKY_TOP_CENTER,xk.STICKY_TOP_LEFT,xk.STICKY_TOP_RIGHT],s=[xk.BOTTOM_CENTER,xk.BOTTOM_LEFT,xk.BOTTOM_RIGHT],l=[xk.CENTER,xk.LEFT,xk.RIGHT],u=[].concat(o,s,l,a),c=[xk.CENTER,xk.LEFT,xk.RIGHT,xk.FULL_WIDTH],d=[xk.CENTER,xk.TOP_CENTER,xk.STICKY_TOP_CENTER,xk.BOTTOM_CENTER],h=[xk.LEFT,xk.BOTTOM_LEFT,xk.TOP_LEFT,xk.STICKY_TOP_LEFT],f=[xk.RIGHT,xk.BOTTOM_RIGHT,xk.TOP_RIGHT,xk.STICKY_TOP_RIGHT];this.forContainers(h,(function(){i.pinnedWidthFeature=i.createManagedBean(new gk(i.eContainer)),i.addManagedListener(i.eventService,Ym.EVENT_LEFT_PINNED_WIDTH_CHANGED,(function(){return i.onPinnedWidthChanged()}))})),this.forContainers(f,(function(){i.pinnedWidthFeature=i.createManagedBean(new yk(i.eContainer)),i.addManagedListener(i.eventService,Ym.EVENT_RIGHT_PINNED_WIDTH_CHANGED,(function(){return i.onPinnedWidthChanged()}))})),this.forContainers(c,(function(){return i.createManagedBean(new bk(i.eContainer,i.eWrapper))})),this.forContainers(u,(function(){return i.createManagedBean(new Sk(i.eContainer))})),this.forContainers(d,(function(){return i.createManagedBean(new kk((function(e){return i.comp.setContainerWidth("".concat(e,"px"))})))})),_w()&&(this.forContainers([xk.CENTER],(function(){var e=i.enableRtl?Ym.EVENT_LEFT_PINNED_WIDTH_CHANGED:Ym.EVENT_RIGHT_PINNED_WIDTH_CHANGED;i.addManagedListener(i.eventService,e,(function(){return i.refreshPaddingForFakeScrollbar()}))})),this.refreshPaddingForFakeScrollbar()),this.addListeners(),this.registerWithCtrlsService()}},{key:"refreshPaddingForFakeScrollbar",value:function(){var e=this.enableRtl,t=this.columnModel,n=this.name,r=this.eWrapper,i=this.eContainer,o=e?xk.LEFT:xk.RIGHT;this.forContainers([xk.CENTER,o],(function(){var a=t.getContainerWidth(o),s=e?"marginLeft":"marginRight";n===xk.CENTER?r.style[s]=a?"0px":"16px":i.style[s]=a?"16px":"0px"}))}},{key:"addListeners",value:function(){var e=this;this.addManagedListener(this.eventService,Ym.EVENT_SCROLL_VISIBILITY_CHANGED,(function(){return e.onScrollVisibilityChanged()})),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,(function(){return e.onDisplayedColumnsChanged()})),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,(function(){return e.onDisplayedColumnsWidthChanged()})),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_ROWS_CHANGED,(function(t){return e.onDisplayedRowsChanged(t.afterScroll)})),this.onScrollVisibilityChanged(),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}},{key:"listenOnDomOrder",value:function(){var e=this;if([xk.STICKY_TOP_CENTER,xk.STICKY_TOP_LEFT,xk.STICKY_TOP_RIGHT,xk.STICKY_TOP_FULL_WIDTH].indexOf(this.name)>=0)this.comp.setDomOrder(!0);else{var t=function(){var t=e.gridOptionsService.is("ensureDomOrder"),n=e.gridOptionsService.isDomLayout("print");e.comp.setDomOrder(t||n)};this.addManagedPropertyListener("domLayout",t),t()}}},{key:"stopHScrollOnPinnedRows",value:function(){var e=this;this.forContainers([xk.TOP_CENTER,xk.STICKY_TOP_CENTER,xk.BOTTOM_CENTER],(function(){e.addManagedListener(e.eViewport,"scroll",(function(){return e.eViewport.scrollLeft=0}))}))}},{key:"onDisplayedColumnsChanged",value:function(){var e=this;this.forContainers([xk.CENTER],(function(){return e.onHorizontalViewportChanged()}))}},{key:"onDisplayedColumnsWidthChanged",value:function(){var e=this;this.forContainers([xk.CENTER],(function(){return e.onHorizontalViewportChanged()}))}},{key:"onScrollVisibilityChanged",value:function(){var e=this,t=this.gridOptionsService.getScrollbarWidth()||0;if(this.name===xk.CENTER){var n=this.scrollVisibleService.isHorizontalScrollShowing()?t:0,r=0==n?"100%":"calc(100% + ".concat(n,"px)");this.animationFrameService.requestAnimationFrame((function(){return e.comp.setViewportHeight(r)}))}if(this.name===xk.FULL_WIDTH){var i=_w()?16:0,o="calc(100% - ".concat(i,"px)");this.eContainer.style.setProperty("width",o)}}},{key:"addPreventScrollWhileDragging",value:function(){var e=this,t=function(t){e.dragService.isDragging()&&t.cancelable&&t.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc((function(){return e.eContainer.removeEventListener("touchmove",t)}))}},{key:"onHorizontalViewportChanged",value:function(){var e=this.getCenterWidth(),t=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(e,t)}},{key:"getCenterWidth",value:function(){return Qw(this.eViewport)}},{key:"getCenterViewportScrollLeft",value:function(){return tb(this.eViewport,this.enableRtl)}},{key:"registerViewportResizeListener",value:function(e){var t=this.resizeObserverService.observeResize(this.eViewport,e);this.addDestroyFunc((function(){return t()}))}},{key:"isViewportVisible",value:function(){return ob(this.eViewport)}},{key:"getViewportScrollLeft",value:function(){return tb(this.eViewport,this.enableRtl)}},{key:"isHorizontalScrollShowing",value:function(){return this.gridOptionsService.is("alwaysShowHorizontalScroll")||fb(this.eViewport)}},{key:"getViewportElement",value:function(){return this.eViewport}},{key:"setContainerTranslateX",value:function(e){this.eContainer.style.transform="translateX(".concat(e,"px)")}},{key:"getHScrollPosition",value:function(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}},{key:"setCenterViewportScrollLeft",value:function(e){nb(this.eViewport,e,this.enableRtl)}},{key:"isContainerVisible",value:function(){return!n.getPinned(this.name)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}},{key:"onPinnedWidthChanged",value:function(){var e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged()),_w()&&this.refreshPaddingForFakeScrollbar()}},{key:"onDisplayedRowsChanged",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.visible){var n=this.gridOptionsService.isDomLayout("print"),r=this.getRowCtrls().filter((function(t){var r=t.isFullWidth(),i=e.embedFullWidthRows||n;return e.isFullWithContainer?!i&&r:i||!r}));this.comp.setRowCtrls(r,t)}else this.comp.setRowCtrls(this.EMPTY_CTRLS,!1)}},{key:"getRowCtrls",value:function(){switch(this.name){case xk.TOP_CENTER:case xk.TOP_LEFT:case xk.TOP_RIGHT:case xk.TOP_FULL_WIDTH:return this.rowRenderer.getTopRowCtrls();case xk.STICKY_TOP_CENTER:case xk.STICKY_TOP_LEFT:case xk.STICKY_TOP_RIGHT:case xk.STICKY_TOP_FULL_WIDTH:return this.rowRenderer.getStickyTopRowCtrls();case xk.BOTTOM_CENTER:case xk.BOTTOM_LEFT:case xk.BOTTOM_RIGHT:case xk.BOTTOM_FULL_WIDTH:return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getRowCtrls()}}}],[{key:"getRowContainerCssClasses",value:function(e){return{container:_k.get(e),viewport:Ok.get(e),wrapper:Dk.get(e)}}},{key:"getPinned",value:function(e){switch(e){case xk.BOTTOM_LEFT:case xk.TOP_LEFT:case xk.STICKY_TOP_LEFT:case xk.LEFT:return"left";case xk.BOTTOM_RIGHT:case xk.TOP_RIGHT:case xk.STICKY_TOP_RIGHT:case xk.RIGHT:return"right";default:return null}}}]),n}(Vm);Rk([nm("scrollVisibleService")],Nk.prototype,"scrollVisibleService",void 0),Rk([nm("dragService")],Nk.prototype,"dragService",void 0),Rk([nm("ctrlsService")],Nk.prototype,"ctrlsService",void 0),Rk([nm("columnModel")],Nk.prototype,"columnModel",void 0),Rk([nm("resizeObserverService")],Nk.prototype,"resizeObserverService",void 0),Rk([nm("animationFrameService")],Nk.prototype,"animationFrameService",void 0),Rk([nm("rowRenderer")],Nk.prototype,"rowRenderer",void 0),Rk([$g],Nk.prototype,"postConstruct",null);var Pk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Fk='<div class="ag-root ag-unselectable" role="treegrid">\n        <ag-header-root ref="gridHeader"></ag-header-root>\n        <div class="ag-floating-top" ref="eTop" role="presentation">\n            <ag-row-container ref="topLeftContainer" name="'.concat(xk.TOP_LEFT,'"></ag-row-container>\n            <ag-row-container ref="topCenterContainer" name="').concat(xk.TOP_CENTER,'"></ag-row-container>\n            <ag-row-container ref="topRightContainer" name="').concat(xk.TOP_RIGHT,'"></ag-row-container>\n            <ag-row-container ref="topFullWidthContainer" name="').concat(xk.TOP_FULL_WIDTH,'"></ag-row-container>\n        </div>\n        <div class="ag-body" ref="eBody" role="presentation">\n            <div class="ag-body-clipper" ref="eBodyClipper" role="presentation">\n                <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">\n                    <ag-row-container ref="leftContainer" name="').concat(xk.LEFT,'"></ag-row-container>\n                    <ag-row-container ref="centerContainer" name="').concat(xk.CENTER,'"></ag-row-container>\n                    <ag-row-container ref="rightContainer" name="').concat(xk.RIGHT,'"></ag-row-container>\n                    <ag-row-container ref="fullWidthContainer" name="').concat(xk.FULL_WIDTH,'"></ag-row-container>\n                </div>\n            </div>\n            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>\n        </div>\n        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">\n            <ag-row-container ref="stickyTopLeftContainer" name="').concat(xk.STICKY_TOP_LEFT,'"></ag-row-container>\n            <ag-row-container ref="stickyTopCenterContainer" name="').concat(xk.STICKY_TOP_CENTER,'"></ag-row-container>\n            <ag-row-container ref="stickyTopRightContainer" name="').concat(xk.STICKY_TOP_RIGHT,'"></ag-row-container>\n            <ag-row-container ref="stickyTopFullWidthContainer" name="').concat(xk.STICKY_TOP_FULL_WIDTH,'"></ag-row-container>\n        </div>\n        <div class="ag-floating-bottom" ref="eBottom" role="presentation">\n            <ag-row-container ref="bottomLeftContainer" name="').concat(xk.BOTTOM_LEFT,'"></ag-row-container>\n            <ag-row-container ref="bottomCenterContainer" name="').concat(xk.BOTTOM_CENTER,'"></ag-row-container>\n            <ag-row-container ref="bottomRightContainer" name="').concat(xk.BOTTOM_RIGHT,'"></ag-row-container>\n            <ag-row-container ref="bottomFullWidthContainer" name="').concat(xk.BOTTOM_FULL_WIDTH,'"></ag-row-container>\n        </div>\n        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>\n        <ag-overlay-wrapper></ag-overlay-wrapper>\n    </div>'),Ik=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,Fk)}return A(n,[{key:"init",value:function(){var e=this,t=function(e,t){var n="".concat(e,"px");t.style.minHeight=n,t.style.height=n},n={setRowAnimationCssOnBodyViewport:function(t,n){return e.setRowAnimationCssOnBodyViewport(t,n)},setColumnCount:function(t){return $y(e.getGui(),t)},setRowCount:function(t){return Zy(e.getGui(),t)},setTopHeight:function(n){return t(n,e.eTop)},setBottomHeight:function(n){return t(n,e.eBottom)},setTopDisplay:function(t){return e.eTop.style.display=t},setBottomDisplay:function(t){return e.eBottom.style.display=t},setStickyTopHeight:function(t){return e.eStickyTop.style.height=t},setStickyTopTop:function(t){return e.eStickyTop.style.top=t},setStickyTopWidth:function(t){return e.eStickyTop.style.width=t},setColumnMovingCss:function(t,n){return e.addOrRemoveCssClass(t,n)},updateLayoutClasses:function(t,n){[e.eBodyViewport.classList,e.eBodyClipper.classList,e.eBody.classList].forEach((function(e){e.toggle(PE.AUTO_HEIGHT,n.autoHeight),e.toggle(PE.NORMAL,n.normal),e.toggle(PE.PRINT,n.print)})),e.addOrRemoveCssClass(PE.AUTO_HEIGHT,n.autoHeight),e.addOrRemoveCssClass(PE.NORMAL,n.normal),e.addOrRemoveCssClass(PE.PRINT,n.print)},setAlwaysVerticalScrollClass:function(t,n){return e.eBodyViewport.classList.toggle(qE,n)},registerBodyViewportResizeListener:function(t){var n=e.resizeObserverService.observeResize(e.eBodyViewport,t);e.addDestroyFunc((function(){return n()}))},setPinnedTopBottomOverflowY:function(t){return e.eTop.style.overflowY=e.eBottom.style.overflowY=t},setCellSelectableCss:function(t,n){[e.eTop,e.eBodyViewport,e.eBottom].forEach((function(e){return e.classList.toggle(t,n)}))},setBodyViewportWidth:function(t){return e.eBodyViewport.style.width=t}};this.ctrl=this.createManagedBean(new XE),this.ctrl.setComp(n,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop),(this.rangeService||"multiple"===this.gridOptionsService.get("rowSelection"))&&Qy(this.getGui(),!0)}},{key:"setRowAnimationCssOnBodyViewport",value:function(e,t){var n=this.eBodyViewport.classList;n.toggle(WE.ANIMATION_ON,t),n.toggle(WE.ANIMATION_OFF,!t)}},{key:"getFloatingTopBottom",value:function(){return[this.eTop,this.eBottom]}}]),n}(Zb);Pk([nm("resizeObserverService")],Ik.prototype,"resizeObserverService",void 0),Pk([rm("rangeService")],Ik.prototype,"rangeService",void 0),Pk([Jb("eBodyViewport")],Ik.prototype,"eBodyViewport",void 0),Pk([Jb("eStickyTop")],Ik.prototype,"eStickyTop",void 0),Pk([Jb("eTop")],Ik.prototype,"eTop",void 0),Pk([Jb("eBottom")],Ik.prototype,"eBottom",void 0),Pk([Jb("gridHeader")],Ik.prototype,"headerRootComp",void 0),Pk([Jb("eBodyClipper")],Ik.prototype,"eBodyClipper",void 0),Pk([Jb("eBody")],Ik.prototype,"eBody",void 0),Pk([$g],Ik.prototype,"init",null);var Lk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Mk=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"postConstruct",value:function(){this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))}},{key:"onDisplayedColumnsChanged",value:function(){this.update()}},{key:"onDisplayedColumnsWidthChanged",value:function(){this.update()}},{key:"update",value:function(){this.updateImpl(),setTimeout(this.updateImpl.bind(this),500)}},{key:"updateImpl",value:function(){var e=this.ctrlsService.getCenterRowContainerCtrl();if(e){var t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(t)}}},{key:"setScrollsVisible",value:function(e){if(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing){this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing;var t={type:Ym.EVENT_SCROLL_VISIBILITY_CHANGED};this.eventService.dispatchEvent(t)}}},{key:"isHorizontalScrollShowing",value:function(){return this.horizontalScrollShowing}},{key:"isVerticalScrollShowing",value:function(){return this.verticalScrollShowing}}]),n}(Vm);Lk([nm("ctrlsService")],Mk.prototype,"ctrlsService",void 0),Lk([$g],Mk.prototype,"postConstruct",null),Mk=Lk([tm("scrollVisibleService")],Mk);var Gk,Bk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},jk=Gk=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).gridInstanceId=Gk.gridInstanceSequence.next(),e}return A(n,[{key:"stampTopLevelGridCompWithGridInstance",value:function(e){e[Gk.GRID_DOM_KEY]=this.gridInstanceId}},{key:"getRenderedCellForEvent",value:function(e){return Im(this.gridOptionsService,e.target,lk.DOM_DATA_KEY_CELL_CTRL)}},{key:"isEventFromThisGrid",value:function(e){return this.isElementInThisGrid(e.target)}},{key:"isElementInThisGrid",value:function(e){for(var t=e;t;){var n=t[Gk.GRID_DOM_KEY];if(fg(n))return n===this.gridInstanceId;t=t.parentElement}return!1}},{key:"getCellPositionForEvent",value:function(e){var t=this.getRenderedCellForEvent(e);return t?t.getCellPosition():null}},{key:"getNormalisedPosition",value:function(e){var t,n,r=this.gridOptionsService.isDomLayout("normal"),i=e;if(null!=i.clientX||null!=i.clientY?(t=i.clientX,n=i.clientY):(t=i.x,n=i.y),r){var o=this.ctrlsService.getGridBodyCtrl(),a=o.getScrollFeature().getVScrollPosition();t+=o.getScrollFeature().getHScrollPosition().left,n+=a.top}return{x:t,y:n}}}]),n}(Vm);jk.gridInstanceSequence=new Wb,jk.GRID_DOM_KEY="__ag_grid_instance",Bk([nm("ctrlsService")],jk.prototype,"ctrlsService",void 0),jk=Gk=Bk([tm("mouseEventService")],jk);var Hk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Vk=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.call(this)).onPageDown=Ug(e.onPageDown,100),e.onPageUp=Ug(e.onPageUp,100),e}return A(n,[{key:"postConstruct",value:function(){var e=this;this.ctrlsService.whenReady((function(t){e.gridBodyCon=t.gridBodyCtrl}))}},{key:"handlePageScrollingKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.key,r=e.altKey,i=e.ctrlKey||e.metaKey,o=!!this.rangeService&&e.shiftKey,a=this.mouseEventService.getCellPositionForEvent(e),s=!1;switch(n){case _b.PAGE_HOME:case _b.PAGE_END:i||r||(this.onHomeOrEndKey(n),s=!0);break;case _b.LEFT:case _b.RIGHT:case _b.UP:case _b.DOWN:if(!a)return!1;!i||r||o||(this.onCtrlUpDownLeftRight(n,a),s=!0);break;case _b.PAGE_DOWN:case _b.PAGE_UP:i||r||(s=this.handlePageUpDown(n,a,t))}return s&&e.preventDefault(),s}},{key:"handlePageUpDown",value:function(e,t,n){return n&&(t=this.focusService.getFocusedCell()),!!t&&(e===_b.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0)}},{key:"navigateTo",value:function(e){var t=e.scrollIndex,n=e.scrollType,r=e.scrollColumn,i=e.focusIndex,o=e.focusColumn;if(fg(r)&&!r.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(r),fg(t)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(t,n),e.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(i),this.focusService.setFocusedCell({rowIndex:i,column:o,rowPinned:null,forceBrowserFocus:!0}),this.rangeService){var a={rowIndex:i,rowPinned:null,column:o};this.rangeService.setRangeToCell(a)}}},{key:"onPageDown",value:function(e){var t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.getViewportHeight(),r=this.paginationProxy.getPixelOffset(),i=t.top+n,o=this.paginationProxy.getRowIndexAtPixel(i+r);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,o):this.navigateToNextPage(e,o)}},{key:"onPageUp",value:function(e){var t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.paginationProxy.getPixelOffset(),r=t.top,i=this.paginationProxy.getRowIndexAtPixel(r+n);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,i,!0):this.navigateToNextPage(e,i,!0)}},{key:"navigateToNextPage",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getViewportHeight(),o=this.paginationProxy.getPageFirstRow(),a=this.paginationProxy.getPageLastRow(),s=this.paginationProxy.getPixelOffset(),l=this.paginationProxy.getRow(e.rowIndex),u=r?(null===l||void 0===l?void 0:l.rowHeight)-i-s:i-s,c=(null===l||void 0===l?void 0:l.rowTop)+u,d=this.paginationProxy.getRowIndexAtPixel(c+s);if(d===e.rowIndex){var h=r?-1:1;t=d=e.rowIndex+h}r?(n="bottom",d<o&&(d=o),t<o&&(t=o)):(n="top",d>a&&(d=a),t>a&&(t=a)),this.isRowTallerThanView(d)&&(t=d,n="top"),this.navigateTo({scrollIndex:t,scrollType:n,scrollColumn:null,focusIndex:d,focusColumn:e.column})}},{key:"navigateToNextPageWithAutoHeight",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout((function(){var i=n.getNextFocusIndexForAutoHeight(e,r);n.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:i,focusColumn:e.column,isAsync:!0})}),50)}},{key:"getNextFocusIndexForAutoHeight",value:function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?-1:1,r=this.getViewportHeight(),i=this.paginationProxy.getPageLastRow(),o=0,a=e.rowIndex;a>=0&&a<=i;){var s=this.paginationProxy.getRow(a);if(s){var l=null!==(t=s.rowHeight)&&void 0!==t?t:0;if(o+l>r)break;o+=l}a+=n}return Math.max(0,Math.min(a,i))}},{key:"getViewportHeight",value:function(){var e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),t=this.gridOptionsService.getScrollbarWidth(),n=e.bottom-e.top;return this.ctrlsService.getCenterRowContainerCtrl().isHorizontalScrollShowing()&&(n-=t),n}},{key:"isRowTallerThanView",value:function(e){var t=this.paginationProxy.getRow(e);if(!t)return!1;var n=t.rowHeight;return"number"===typeof n&&n>this.getViewportHeight()}},{key:"onCtrlUpDownLeftRight",value:function(e,t){var n=this.cellNavigationService.getNextCellToFocus(e,t,!0),r=n.rowIndex,i=n.column;this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:i,focusIndex:r,focusColumn:i})}},{key:"onHomeOrEndKey",value:function(e){var t=e===_b.PAGE_HOME,n=this.columnModel.getAllDisplayedColumns(),r=t?n[0]:ym(n),i=t?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex:i,scrollType:null,scrollColumn:r,focusIndex:i,focusColumn:r})}},{key:"onTabKeyDown",value:function(e,t){var n=t.shiftKey;if(this.tabToNextCellCommon(e,n,t))t.preventDefault();else if(n){var r=e.getRowPosition(),i=r.rowIndex;(r.rowPinned?0===i:i===this.paginationProxy.getPageFirstRow())&&(0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusNextGridCoreContainer(!0,!0):(t.preventDefault(),this.focusService.focusLastHeader(t)))}else e instanceof lk&&e.focusCell(!0),this.focusService.focusNextGridCoreContainer(n)&&t.preventDefault()}},{key:"tabToNextCell",value:function(e,t){var n=this.focusService.getFocusedCell();if(!n)return!1;var r=this.getCellByPosition(n);return!!(r||(r=this.rowRenderer.getRowByPosition(n))&&r.isFullWidth())&&this.tabToNextCellCommon(r,e,t)}},{key:"tabToNextCellCommon",value:function(e,t,n){var r=e.isEditing();if(!r&&e instanceof lk){var i=e.getRowCtrl();i&&(r=i.isEditing())}return(r?"fullRow"===this.gridOptionsService.get("editType")?this.moveToNextEditingRow(e,t,n):this.moveToNextEditingCell(e,t,n):this.moveToNextCellNotEditing(e,t))||!!this.focusService.getFocusedHeader()}},{key:"moveToNextEditingCell",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.getCellPosition();e.getGui().focus(),e.stopEditing();var i=this.findNextCellToFocusOn(r,t,!0);return null!=i&&(i.startEditing(null,!0,n),i.focusCell(!1),!0)}},{key:"moveToNextEditingRow",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.getCellPosition(),i=this.findNextCellToFocusOn(r,t,!0);if(null==i)return!1;var o=i.getCellPosition(),a=this.isCellEditable(r),s=this.isCellEditable(o),l=o&&r.rowIndex===o.rowIndex&&r.rowPinned===o.rowPinned;(a&&e.setFocusOutOnEditor(),l)||(e.getRowCtrl().stopEditing(),i.getRowCtrl().startRowEditing(void 0,void 0,n));return s?(i.setFocusInOnEditor(),i.focusCell()):i.focusCell(!0),!0}},{key:"moveToNextCellNotEditing",value:function(e,t){var n,r=this.columnModel.getAllDisplayedColumns();n=e instanceof ck?Object.assign(Object.assign({},e.getRowPosition()),{column:t?r[0]:ym(r)}):e.getCellPosition();var i=this.findNextCellToFocusOn(n,t,!1);if(i instanceof lk)i.focusCell(!0);else if(i)return this.tryToFocusFullWidthRow(i.getRowPosition(),t);return fg(i)}},{key:"findNextCellToFocusOn",value:function(e,t,n){for(var r=e;;){e!==r&&(e=r),t||(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextTabbedCell(r,t);var i=this.gridOptionsService.getCallback("tabToNextCell");if(fg(i)){var o=i({backwards:t,editing:n,previousCellPosition:e,nextCellPosition:r||null});fg(o)?(o.floating&&(Lg((function(){console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")}),"no floating in userCell"),o.rowPinned=o.floating),r={rowIndex:o.rowIndex,column:o.column,rowPinned:o.rowPinned}):r=null}if(!r)return null;if(r.rowIndex<0){var a=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a+r.rowIndex,column:r.column}}),null}var s="fullRow"===this.gridOptionsService.get("editType");if(n&&!s)if(!this.isCellEditable(r))continue;this.ensureCellVisible(r);var l=this.getCellByPosition(r);if(!l){var u=this.rowRenderer.getRowByPosition(r);if(!u||!u.isFullWidth()||n)continue;return u}if(!l.isSuppressNavigable())return this.rangeService&&this.rangeService.setRangeToCell(r),l}}},{key:"isCellEditable",value:function(e){var t=this.lookupRowNodeForCell(e);return!!t&&e.column.isCellEditable(t)}},{key:"getCellByPosition",value:function(e){var t=this.rowRenderer.getRowByPosition(e);return t?t.getCellCtrl(e.column):null}},{key:"lookupRowNodeForCell",value:function(e){return"top"===e.rowPinned?this.pinnedRowModel.getPinnedTopRow(e.rowIndex):"bottom"===e.rowPinned?this.pinnedRowModel.getPinnedBottomRow(e.rowIndex):this.paginationProxy.getRow(e.rowIndex)}},{key:"navigateToNextCell",value:function(e,t,n,r){for(var i=n,o=!1;i&&(i===n||!this.isValidNavigateCell(i));)this.gridOptionsService.is("enableRtl")?t===_b.LEFT&&(i=this.getLastCellOfColSpan(i)):t===_b.RIGHT&&(i=this.getLastCellOfColSpan(i)),o=pg(i=this.cellNavigationService.getNextCellToFocus(t,i));if(o&&e&&e.key===_b.UP&&(i={rowIndex:-1,rowPinned:null,column:n.column}),r){var a=this.gridOptionsService.getCallback("navigateToNextCell");if(fg(a)){var s=a({key:t,previousCellPosition:n,nextCellPosition:i||null,event:e});fg(s)?(s.floating&&(Lg((function(){console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")}),"no floating in userCell"),s.rowPinned=s.floating),i={rowPinned:s.rowPinned,rowIndex:s.rowIndex,column:s.column}):i=null}}if(i)if(i.rowIndex<0){var l=this.headerNavigationService.getHeaderRowCount();this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:l+i.rowIndex,column:n.column},event:e||void 0})}else{var u=this.getNormalisedPosition(i);u?this.focusPosition(u):this.tryToFocusFullWidthRow(i)}}},{key:"getNormalisedPosition",value:function(e){this.ensureCellVisible(e);var t=this.getCellByPosition(e);return t?(e=t.getCellPosition(),this.ensureCellVisible(e),e):null}},{key:"tryToFocusFullWidthRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.columnModel.getAllDisplayedColumns(),r=this.rowRenderer.getRowByPosition(e);if(!r||!r.isFullWidth())return!1;var i=this.focusService.getFocusedCell(),o={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?ym(n):n[0])};this.focusPosition(o);var a=null!=i&&this.rowPositionUtils.before(o,i),s={type:Ym.EVENT_FULL_WIDTH_ROW_FOCUSED,rowIndex:o.rowIndex,rowPinned:o.rowPinned,column:o.column,isFullWidthCell:!0,floating:o.rowPinned,fromBelow:a};return this.eventService.dispatchEvent(s),!0}},{key:"focusPosition",value:function(e){this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),this.rangeService&&this.rangeService.setRangeToCell(e)}},{key:"isValidNavigateCell",value:function(e){return!!this.rowPositionUtils.getRowNode(e)}},{key:"getLastCellOfColSpan",value:function(e){var t=this.getCellByPosition(e);if(!t)return e;var n=t.getColSpanningList();return 1===n.length?e:{rowIndex:e.rowIndex,column:ym(n),rowPinned:e.rowPinned}}},{key:"ensureCellVisible",value:function(e){var t=this.gridOptionsService.isGroupRowsSticky(),n=this.rowModel.getRow(e.rowIndex);!(t&&(null===n||void 0===n?void 0:n.sticky))&&pg(e.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(e.column)}}]),n}(Vm);Hk([nm("mouseEventService")],Vk.prototype,"mouseEventService",void 0),Hk([nm("paginationProxy")],Vk.prototype,"paginationProxy",void 0),Hk([nm("focusService")],Vk.prototype,"focusService",void 0),Hk([rm("rangeService")],Vk.prototype,"rangeService",void 0),Hk([nm("columnModel")],Vk.prototype,"columnModel",void 0),Hk([nm("rowModel")],Vk.prototype,"rowModel",void 0),Hk([nm("ctrlsService")],Vk.prototype,"ctrlsService",void 0),Hk([nm("rowRenderer")],Vk.prototype,"rowRenderer",void 0),Hk([nm("headerNavigationService")],Vk.prototype,"headerNavigationService",void 0),Hk([nm("rowPositionUtils")],Vk.prototype,"rowPositionUtils",void 0),Hk([nm("cellNavigationService")],Vk.prototype,"cellNavigationService",void 0),Hk([nm("pinnedRowModel")],Vk.prototype,"pinnedRowModel",void 0),Hk([$g],Vk.prototype,"postConstruct",null),Vk=Hk([tm("navigationService")],Vk);var Wk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},zk=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this,'<div class="ag-popup-editor" tabindex="-1"/>')).params=e,r}return A(n,[{key:"postConstruct",value:function(){this.gridOptionsService.setDomData(this.getGui(),n.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()}},{key:"addKeyDownListener",value:function(){var e=this,t=this.getGui(),n=this.params;this.addManagedListener(t,"keydown",(function(t){Db(e.gridOptionsService,t,n.node,n.column,!0)||n.onKeyDown(t)}))}}]),n}(iS);zk.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper",Wk([$g],zk.prototype,"postConstruct",null);var Uk=function(e){O(n,e);var t=F(n);function n(e,r,i,o,a){var s;T(this,n),(s=t.call(this)).rendererVersion=0,s.editorVersion=0,s.beans=e,s.column=r.getColumn(),s.rowNode=r.getRowNode(),s.rowCtrl=r.getRowCtrl(),s.eRow=o,s.setTemplate('<div comp-id="'.concat(s.getCompId(),'"/>'));var l=s.getGui();s.forceWrapper=r.isForceWrapper(),s.refreshWrapper(!1);var u=function(e,t,n){var r=n||l;null!=t&&""!=t?r.setAttribute(e,t):r.removeAttribute(e)},c={addOrRemoveCssClass:function(e,t){return s.addOrRemoveCssClass(e,t)},setUserStyles:function(e){return hb(l,e)},getFocusableElement:function(){return s.getFocusableElement()},setTabIndex:function(e){return u("tabindex",e.toString())},setRole:function(e){return Fy(l,e)},setColId:function(e){return u("col-id",e)},setTitle:function(e){return u("title",e)},setIncludeSelection:function(e){return s.includeSelection=e},setIncludeRowDrag:function(e){return s.includeRowDrag=e},setIncludeDndSource:function(e){return s.includeDndSource=e},setRenderDetails:function(e,t,n){return s.setRenderDetails(e,t,n)},setEditDetails:function(e,t,n){return s.setEditDetails(e,t,n)},getCellEditor:function(){return s.cellEditor||null},getCellRenderer:function(){return s.cellRenderer||null},getParentOfValue:function(){return s.getParentOfValue()}};return s.cellCtrl=r,r.setComp(c,s.getGui(),s.eCellWrapper,i,a),s}return A(n,[{key:"getParentOfValue",value:function(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()}},{key:"setRenderDetails",value:function(e,t,n){if(!(this.cellEditor&&!this.cellEditorPopupWrapper)){this.firstRender=null==this.firstRender;var r=this.refreshWrapper(!1);if(this.refreshEditStyles(!1),e)!(n||r)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e));else this.destroyRenderer(),this.insertValueWithoutCellRenderer(t)}}},{key:"setEditDetails",value:function(e,t,n){e?this.createCellEditorInstance(e,t,n):this.destroyEditor()}},{key:"removeControls",value:function(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)}},{key:"refreshWrapper",value:function(e){var t=this.includeRowDrag||this.includeDndSource||this.includeSelection,n=t||this.forceWrapper,r=n&&null==this.eCellWrapper;r&&(this.eCellWrapper=ab('<div class="ag-cell-wrapper" role="presentation"></div>'),this.getGui().appendChild(this.eCellWrapper));var i=!n&&null!=this.eCellWrapper;i&&(ib(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!n);var o=!e&&n,a=o&&null==this.eCellValue;a&&(this.eCellValue=ab('<span class="ag-cell-value" role="presentation"></span>'),this.eCellWrapper.appendChild(this.eCellValue));var s=!o&&null!=this.eCellValue;s&&(ib(this.eCellValue),this.eCellValue=void 0);var l=r||i||a||s;return l&&this.removeControls(),e||t&&this.addControls(),l}},{key:"addControls",value:function(){this.includeRowDrag&&null==this.rowDraggingComp&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&null==this.dndSourceComp&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&null==this.checkboxSelectionComp&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))}},{key:"createCellEditorInstance",value:function(e,t,n){var r=this,i=this.editorVersion,o=e.newAgStackInstance();if(o){var a=e.params;o.then((function(e){return r.afterCellEditorCreated(i,e,a,t,n)})),pg(this.cellEditor)&&a.cellStartedEdit&&this.cellCtrl.focusCell(!0)}}},{key:"insertValueWithoutCellRenderer",value:function(e){var t=this.getParentOfValue();rb(t);var n=null!=e?ry(e):null;null!=n&&(t.innerHTML=n)}},{key:"destroyEditorAndRenderer",value:function(){this.destroyRenderer(),this.destroyEditor()}},{key:"destroyRenderer",value:function(){var e=this.beans.context;this.cellRenderer=e.destroyBean(this.cellRenderer),ib(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}},{key:"destroyEditor",value:function(){var e=this.beans.context;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),ib(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++}},{key:"refreshCellRenderer",value:function(e){if(null==this.cellRenderer||null==this.cellRenderer.refresh)return!1;if(this.cellRendererClass!==e.componentClass)return!1;var t=this.cellRenderer.refresh(e.params);return!0===t||void 0===t}},{key:"createCellRendererInstance",value:function(e){var t=this,n=!this.beans.gridOptionsService.is("suppressAnimationFrame"),r=this.rendererVersion,i=e.componentClass,o=function(){if(!(t.rendererVersion!==r||!t.isAlive())){var n=e.newAgStackInstance(),o=t.afterCellRendererCreated.bind(t,r,i);n&&n.then(o)}};n&&this.firstRender?this.beans.animationFrameService.createTask(o,this.rowNode.rowIndex,"createTasksP2"):o()}},{key:"getCtrl",value:function(){return this.cellCtrl}},{key:"getRowCtrl",value:function(){return this.rowCtrl}},{key:"getCellRenderer",value:function(){return this.cellRenderer}},{key:"getCellEditor",value:function(){return this.cellEditor}},{key:"afterCellRendererCreated",value:function(e,t,n){if(!this.isAlive()||e!==this.rendererVersion)this.beans.context.destroyBean(n);else if(this.cellRenderer=n,this.cellRendererClass=t,this.cellRendererGui=this.cellRenderer.getGui(),null!=this.cellRendererGui){var r=this.getParentOfValue();rb(r),r.appendChild(this.cellRendererGui)}}},{key:"afterCellEditorCreated",value:function(e,t,n,r,i){if(e!==this.editorVersion)this.beans.context.destroyBean(t);else{if(t.isCancelBeforeStart&&t.isCancelBeforeStart())return this.beans.context.destroyBean(t),void this.cellCtrl.stopEditing(!0);if(!t.getGui)return console.warn("AG Grid: cellEditor for column ".concat(this.column.getId()," is missing getGui() method")),void this.beans.context.destroyBean(t);this.cellEditor=t,this.cellEditorGui=t.getGui();var o=r||void 0!==t.isPopup&&t.isPopup();o?this.addPopupCellEditor(n,i):this.addInCellEditor(),this.refreshEditStyles(!0,o),t.afterGuiAttached&&t.afterGuiAttached()}}},{key:"refreshEditStyles",value:function(e,t){var n;this.addOrRemoveCssClass("ag-cell-inline-editing",e&&!t),this.addOrRemoveCssClass("ag-cell-popup-editing",e&&!!t),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!e||!!t),null===(n=this.rowCtrl)||void 0===n||n.setInlineEditingCss(e)}},{key:"addInCellEditor",value:function(){var e=this.getGui(),t=this.beans.gridOptionsService.getDocument();(e.contains(t.activeElement)&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui)&&this.getParentOfValue().appendChild(this.cellEditorGui)}},{key:"addPopupCellEditor",value:function(e,t){var n=this;"fullRow"===this.beans.gridOptionsService.get("editType")&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");var r=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new zk(e));var i=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&i.appendChild(this.cellEditorGui);var o=this.beans.popupService,a=this.beans.gridOptionsService.is("stopEditingWhenCellsLoseFocus"),s=null!=t?t:r.getPopupPosition?r.getPopupPosition():"over",l=this.beans.gridOptionsService.is("enableRtl"),u={ePopup:i,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:s,alignSide:l?"right":"left",keepWithinBounds:!0},c=o.positionPopupByComponent.bind(o,u),d=this.beans.localeService.getLocaleTextFunc(),h=o.addPopup({modal:a,eChild:i,closeOnEsc:!0,closedCallback:function(){n.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:c,ariaLabel:d("ariaLabelCellEditor","Cell Editor")});h&&(this.hideEditorPopup=h.hideFunc)}},{key:"detach",value:function(){this.eRow.removeChild(this.getGui())}},{key:"destroy",value:function(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),cg(D(n.prototype),"destroy",this).call(this)}},{key:"clearParentOfValue",value:function(){var e=this.getGui(),t=this.beans.gridOptionsService.getDocument();e.contains(t.activeElement)&&Sw()&&e.focus({preventScroll:!0}),rb(this.getParentOfValue())}}]),n}(Zb),Kk=function(e){O(n,e);var t=F(n);function n(e,r,i){var o;T(this,n),(o=t.call(this)).cellComps={},o.beans=r,o.rowCtrl=e,o.setTemplate('<div comp-id="'.concat(o.getCompId(),'" style="').concat(o.getInitialStyle(i),'"/>'));var a=o.getGui(),s=a.style,l={setDomOrder:function(e){return o.domOrder=e},setCellCtrls:function(e){return o.setCellCtrls(e)},showFullWidth:function(e){return o.showFullWidth(e)},getFullWidthCellRenderer:function(){return o.getFullWidthCellRenderer()},addOrRemoveCssClass:function(e,t){return o.addOrRemoveCssClass(e,t)},setUserStyles:function(e){return hb(a,e)},setTop:function(e){return s.top=e},setTransform:function(e){return s.transform=e},setRowIndex:function(e){return a.setAttribute("row-index",e)},setRole:function(e){return Fy(a,e)},setRowId:function(e){return a.setAttribute("row-id",e)},setRowBusinessKey:function(e){return a.setAttribute("row-business-key",e)},setTabIndex:function(e){return a.setAttribute("tabindex",e.toString())}};return e.setComp(l,o.getGui(),i),o.addDestroyFunc((function(){e.unsetComp(i)})),o}return A(n,[{key:"getInitialStyle",value:function(e){var t=this.rowCtrl.getInitialTransform(e),n=this.rowCtrl.getInitialRowTop(e);return t?"transform: ".concat(t):"top: ".concat(n)}},{key:"showFullWidth",value:function(e){var t=this,n=e.newAgStackInstance();n&&n.then((function(e){if(t.isAlive()){var n=e.getGui();t.getGui().appendChild(n),t.rowCtrl.setupDetailRowAutoHeight(n),t.setFullWidthRowComp(e)}else t.beans.context.destroyBean(e)}))}},{key:"setCellCtrls",value:function(e){var t=this,n=Object.assign({},this.cellComps);e.forEach((function(e){var r=e.getInstanceId();null==t.cellComps[r]?t.newCellComp(e):n[r]=null}));var r=_g(n).filter((function(e){return null!=e}));this.destroyCells(r),this.ensureDomOrder(e)}},{key:"ensureDomOrder",value:function(e){var t=this;if(this.domOrder){var n=[];e.forEach((function(e){var r=t.cellComps[e.getInstanceId()];r&&n.push(r.getGui())})),cb(this.getGui(),n)}}},{key:"newCellComp",value:function(e){var t=new Uk(this.beans,e,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[e.getInstanceId()]=t,this.getGui().appendChild(t.getGui())}},{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this),this.destroyAllCells()}},{key:"destroyAllCells",value:function(){var e=_g(this.cellComps).filter((function(e){return null!=e}));this.destroyCells(e)}},{key:"setFullWidthRowComp",value:function(e){var t=this;this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=e,this.addDestroyFunc((function(){t.fullWidthCellRenderer=t.beans.context.destroyBean(t.fullWidthCellRenderer)}))}},{key:"getFullWidthCellRenderer",value:function(){return this.fullWidthCellRenderer}},{key:"destroyCells",value:function(e){var t=this;e.forEach((function(e){if(e){var n=e.getCtrl().getInstanceId();t.cellComps[n]===e&&(e.detach(),e.destroy(),t.cellComps[n]=null)}}))}}]),n}(Zb),qk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};var Xk=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.call(this,function(){var e=Zb.elementGettingCreated.getAttribute("name"),t=Nk.getRowContainerCssClasses(e),n=e===xk.CENTER,r=e===xk.TOP_CENTER||e===xk.STICKY_TOP_CENTER||e===xk.BOTTOM_CENTER;return n?'<div class="'.concat(t.wrapper,'" ref="eWrapper" role="presentation">\n                <div class="').concat(t.viewport,'" ref="eViewport" role="presentation">\n                    <div class="').concat(t.container,'" ref="eContainer"></div>\n                </div>\n            </div>'):r?'<div class="'.concat(t.viewport,'" ref="eViewport" role="presentation">\n                <div class="').concat(t.container,'" ref="eContainer"></div>\n            </div>'):'<div class="'.concat(t.container,'" ref="eContainer"></div>')}())).rowComps={},e.name=Zb.elementGettingCreated.getAttribute("name"),e.type=Ak(e.name),e}return A(n,[{key:"postConstruct",value:function(){var e=this,t={setViewportHeight:function(t){return e.eViewport.style.height=t},setRowCtrls:function(t){return e.setRowCtrls(t)},setDomOrder:function(t){e.domOrder=t},setContainerWidth:function(t){return e.eContainer.style.width=t}};this.createManagedBean(new Nk(this.name)).setComp(t,this.eContainer,this.eViewport,this.eWrapper)}},{key:"preDestroy",value:function(){this.setRowCtrls([])}},{key:"setRowCtrls",value:function(e){var t=this,n=Object.assign({},this.rowComps);this.rowComps={},this.lastPlacedElement=null;e.forEach((function(e){var r=e.getInstanceId(),i=n[r];if(i)t.rowComps[r]=i,delete n[r],t.ensureDomOrder(i.getGui());else{if(!e.getRowNode().displayed)return;var o=new Kk(e,t.beans,t.type);t.rowComps[r]=o,t.appendRow(o.getGui())}})),_g(n).forEach((function(e){t.eContainer.removeChild(e.getGui()),e.destroy()})),Fy(this.eContainer,e.length?"rowgroup":"presentation")}},{key:"appendRow",value:function(e){this.domOrder?db(this.eContainer,e,this.lastPlacedElement):this.eContainer.appendChild(e),this.lastPlacedElement=e}},{key:"ensureDomOrder",value:function(e){this.domOrder&&(ub(this.eContainer,e,this.lastPlacedElement),this.lastPlacedElement=e)}}]),n}(Zb);qk([nm("beans")],Xk.prototype,"beans",void 0),qk([Jb("eViewport")],Xk.prototype,"eViewport",void 0),qk([Jb("eContainer")],Xk.prototype,"eContainer",void 0),qk([Jb("eWrapper")],Xk.prototype,"eWrapper",void 0),qk([$g],Xk.prototype,"postConstruct",null),qk([em],Xk.prototype,"preDestroy",null);var Yk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Qk=function(){function e(t){T(this,e),this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=t}return A(e,[{key:"onDragEnter",value:function(e){var t=this;if(this.clearColumnsList(),!this.gridOptionsService.is("functionsReadOnly")){var n=e.dragItem.columns;n&&n.forEach((function(e){e.isPrimary()&&(e.isAnyFunctionActive()||(e.isAllowValue()?t.columnsToAggregate.push(e):e.isAllowRowGroup()?t.columnsToGroup.push(e):e.isAllowPivot()&&t.columnsToPivot.push(e)))}))}}},{key:"getIconName",value:function(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?xS.ICON_PINNED:xS.ICON_MOVE:null}},{key:"onDragLeave",value:function(e){this.clearColumnsList()}},{key:"clearColumnsList",value:function(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}},{key:"onDragging",value:function(e){}},{key:"onDragStop",value:function(e){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}}]),e}();Yk([nm("columnModel")],Qk.prototype,"columnModel",void 0),Yk([nm("gridOptionsService")],Qk.prototype,"gridOptionsService",void 0);var Zk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Jk=function(){function e(t,n){T(this,e),this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=t,this.eContainer=n,this.centerContainer=!fg(t)}return A(e,[{key:"init",value:function(){var e=this;this.ctrlsService.whenReady((function(){e.gridBodyCon=e.ctrlsService.getGridBodyCtrl()}))}},{key:"getIconName",value:function(){return this.pinned?xS.ICON_PINNED:xS.ICON_MOVE}},{key:"onDragEnter",value:function(e){var t=e.dragItem.columns;if(e.dragSource.type===CS.ToolPanel)this.setColumnsVisible(t,!0,"uiColumnDragged");else{var n=e.dragItem.visibleState,r=(t||[]).filter((function(e){return n[e.getId()]}));this.setColumnsVisible(r,!0,"uiColumnDragged")}this.setColumnsPinned(t,this.pinned,"uiColumnDragged"),this.onDragging(e,!0,!0)}},{key:"onDragLeave",value:function(){this.ensureIntervalCleared(),this.lastMovedInfo=null}},{key:"setColumnsVisible",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";if(e){var r=e.filter((function(e){return!e.getColDef().lockVisible}));this.columnModel.setColumnsVisible(r,t,n)}}},{key:"setColumnsPinned",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";if(e){var r=e.filter((function(e){return!e.getColDef().lockPinned}));this.columnModel.setColumnsPinned(r,t,n)}}},{key:"onDragStop",value:function(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}},{key:"normaliseX",value:function(e){this.gridOptionsService.is("enableRtl")&&(e=this.eContainer.clientWidth-e);return this.centerContainer&&(e+=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft()),e}},{key:"checkCenterForScrolling",value:function(e){if(this.centerContainer){var t=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft(),n=t+this.ctrlsService.getCenterRowContainerCtrl().getCenterWidth();this.gridOptionsService.is("enableRtl")?(this.needToMoveRight=e<t+50,this.needToMoveLeft=e>n-50):(this.needToMoveLeft=e<t+50,this.needToMoveRight=e>n-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}}},{key:"onDragging",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lastDraggingEvent,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]){if(this.lastMovedInfo){var o=this.lastMovedInfo,a=o.columns,s=o.toIndex;this.moveColumns(a,s,"uiColumnMoved",!0)}}else if(this.lastDraggingEvent=n,!pg(n.hDirection)){var l=this.normaliseX(n.x);r||this.checkCenterForScrolling(l);var u=this.normaliseDirection(n.hDirection),c=n.dragSource.type,d=(null===(e=n.dragSource.getDragItem().columns)||void 0===e?void 0:e.filter((function(e){return!e.getColDef().lockPinned||e.getPinned()==t.pinned})))||[];this.attemptMoveColumns({dragSourceType:c,allMovingColumns:d,hDirection:u,mouseX:l,fromEnter:r,fakeEvent:i})}}},{key:"normaliseDirection",value:function(e){if(!this.gridOptionsService.is("enableRtl"))return e;switch(e){case ES.Left:return ES.Right;case ES.Right:return ES.Left;default:console.error("AG Grid: Unknown direction ".concat(e))}}},{key:"attemptMoveColumns",value:function(e){var t=e.dragSourceType,n=e.hDirection,r=e.mouseX,i=e.fromEnter,o=e.fakeEvent,a=n===ES.Left,s=n===ES.Right,l=e.allMovingColumns;if(t===CS.HeaderCell){var u=[];l.forEach((function(e){for(var t=null,n=e.getParent();null!=n&&1===n.getDisplayedLeafColumns().length;)t=n,n=n.getParent();null!=t?t.getProvidedColumnGroup().getLeafColumns().forEach((function(e){u.includes(e)||u.push(e)})):u.includes(e)||u.push(e)})),l=u}var c=l.slice();this.columnModel.sortColumnsLikeGridColumns(c);var d=this.calculateValidMoves(c,s,r),h=this.calculateOldIndex(c);if(0!==d.length){var f=d[0],p=null!==h&&!i;if(t==CS.HeaderCell&&(p=null!==h),p&&!o){if(a&&f>=h)return;if(s&&f<=h)return}for(var v=this.columnModel.getAllDisplayedColumns(),g=[],m=null,y=0;y<d.length;y++){var w=d[y],b=this.columnModel.getProposedColumnOrder(c,w);if(this.columnModel.doesOrderPassRules(b)){var C=b.filter((function(e){return v.includes(e)}));if(null===m)m=C;else if(!Vb.areEqual(C,m))break;var S=this.groupFragCount(b);g.push({move:w,fragCount:S})}}0!==g.length&&(g.sort((function(e,t){return e.fragCount-t.fragCount})),this.moveColumns(l,g[0].move,"uiColumnMoved",!1))}}},{key:"calculateOldIndex",value:function(e){var t=this.columnModel.getAllGridColumns(),n=bm(e.map((function(e){return t.indexOf(e)}))),r=n[0];return ym(n)-r!==n.length-1?null:r}},{key:"moveColumns",value:function(e,t,n,r){this.columnModel.moveColumns(e,t,n,r),this.lastMovedInfo=r?null:{columns:e,toIndex:t}}},{key:"groupFragCount",value:function(e){function t(e){for(var t=[],n=e.getOriginalParent();null!=n;)t.push(n),n=n.getOriginalParent();return t}for(var n=0,r=function(){var r=t(e[i]),o=t(e[i+1]),a=Y(r.length>o.length?[r,o]:[o,r],2);r=a[0],o=a[1],r.forEach((function(e){-1===o.indexOf(e)&&n++}))},i=0;i<e.length-1;i++)r();return n}},{key:"calculateValidMoves",value:function(e,t,n){var r=this.gridOptionsService.is("suppressMovableColumns")||e.some((function(e){return e.getColDef().suppressMovable}));if(r)return[];var i,o=this.columnModel.getDisplayedColumns(this.pinned),a=this.columnModel.getAllGridColumns(),s=o.filter((function(t){return xm(e,t)})),l=o.filter((function(t){return!xm(e,t)})),u=a.filter((function(t){return!xm(e,t)})),c=0,d=n;if(t){var h=0;s.forEach((function(e){return h+=e.getActualWidth()})),d-=h}if(d>0){for(var f=0;f<l.length;f++){if((d-=l[f].getActualWidth())<0)break;c++}t&&c++}if(c>0){var p=l[c-1];i=u.indexOf(p)+1}else-1===(i=u.indexOf(l[0]))&&(i=0);var v=[i],g=function(e,t){return e-t};if(t){for(var m=i+1,y=a.length-1;m<=y;)v.push(m),m++;v.sort(g)}else{for(var w=i,b=a.length-1,C=a[w];w<=b&&this.isColumnHidden(o,C);)w++,v.push(w),C=a[w];w=i-1;for(;w>=0;)v.push(w),w--;v.sort(g).reverse()}return v}},{key:"isColumnHidden",value:function(e,t){return e.indexOf(t)<0}},{key:"ensureIntervalStarted",value:function(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(xS.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(xS.ICON_RIGHT,!0))}},{key:"ensureIntervalCleared",value:function(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(xS.ICON_MOVE))}},{key:"moveInterval",value:function(){var e;this.intervalCount++,(e=10+5*this.intervalCount)>100&&(e=100);var t=null,n=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?t=n.scrollHorizontally(-e):this.needToMoveRight&&(t=n.scrollHorizontally(e)),0!==t)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;var r=this.lastDraggingEvent.dragItem.columns.filter((function(e){return!e.getColDef().lockPinned}));if(r.length>0&&(this.dragAndDropService.setGhostIcon(xS.ICON_PINNED),this.failedMoveAttempts>7)){var i=this.needToMoveLeft?"left":"right";this.setColumnsPinned(r,i,"uiColumnDragged"),this.dragAndDropService.nudge()}}}}]),e}();Zk([nm("columnModel")],Jk.prototype,"columnModel",void 0),Zk([nm("dragAndDropService")],Jk.prototype,"dragAndDropService",void 0),Zk([nm("gridOptionsService")],Jk.prototype,"gridOptionsService",void 0),Zk([nm("ctrlsService")],Jk.prototype,"ctrlsService",void 0),Zk([$g],Jk.prototype,"init",null);var $k=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ex=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this)).pinned=e,i.eContainer=r,i}return A(n,[{key:"postConstruct",value:function(){var e=this;this.ctrlsService.whenReady((function(t){switch(e.pinned){case"left":e.eSecondaryContainers=[[t.gridBodyCtrl.getBodyViewportElement(),t.leftRowContainerCtrl.getContainerElement()],[t.bottomLeftRowContainerCtrl.getContainerElement()],[t.topLeftRowContainerCtrl.getContainerElement()]];break;case"right":e.eSecondaryContainers=[[t.gridBodyCtrl.getBodyViewportElement(),t.rightRowContainerCtrl.getContainerElement()],[t.bottomRightRowContainerCtrl.getContainerElement()],[t.topRightRowContainerCtrl.getContainerElement()]];break;default:e.eSecondaryContainers=[[t.gridBodyCtrl.getBodyViewportElement(),t.centerRowContainerCtrl.getViewportElement()],[t.bottomCenterRowContainerCtrl.getViewportElement()],[t.topCenterRowContainerCtrl.getViewportElement()]]}}))}},{key:"isInterestedIn",value:function(e){return e===CS.HeaderCell||e===CS.ToolPanel&&this.gridOptionsService.is("allowDragFromColumnsToolPanel")}},{key:"getSecondaryContainers",value:function(){return this.eSecondaryContainers}},{key:"getContainer",value:function(){return this.eContainer}},{key:"init",value:function(){this.moveColumnFeature=this.createManagedBean(new Jk(this.pinned,this.eContainer)),this.bodyDropPivotTarget=this.createManagedBean(new Qk(this.pinned)),this.dragAndDropService.addDropTarget(this)}},{key:"getIconName",value:function(){return this.currentDropListener.getIconName()}},{key:"isDropColumnInPivotMode",value:function(e){return this.columnModel.isPivotMode()&&e.dragSource.type===CS.ToolPanel}},{key:"onDragEnter",value:function(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}},{key:"onDragLeave",value:function(e){this.currentDropListener.onDragLeave(e)}},{key:"onDragging",value:function(e){this.currentDropListener.onDragging(e)}},{key:"onDragStop",value:function(e){this.currentDropListener.onDragStop(e)}}]),n}(Vm);$k([nm("dragAndDropService")],ex.prototype,"dragAndDropService",void 0),$k([nm("columnModel")],ex.prototype,"columnModel",void 0),$k([nm("ctrlsService")],ex.prototype,"ctrlsService",void 0),$k([$g],ex.prototype,"postConstruct",null),$k([$g],ex.prototype,"init",null);var tx=function(){function e(){T(this,e)}return A(e,null,[{key:"getHeaderClassesFromColDef",value:function(e,t,n,r){return pg(e)?[]:this.getColumnClassesFromCollDef(e.headerClass,e,t,n,r)}},{key:"getToolPanelClassesFromColDef",value:function(e,t,n,r){return pg(e)?[]:this.getColumnClassesFromCollDef(e.toolPanelClass,e,t,n,r)}},{key:"getClassParams",value:function(e,t,n,r){return{colDef:e,column:n,columnGroup:r,api:t.api,columnApi:t.columnApi,context:t.context}}},{key:"getColumnClassesFromCollDef",value:function(e,t,n,r,i){if(pg(e))return[];var o;"function"===typeof e?o=e(this.getClassParams(t,n,r,i)):o=e;return"string"===typeof o?[o]:Array.isArray(o)?wt(o):[]}}]),e}(),nx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},rx=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this,n.TEMPLATE,e)).headerCompVersion=0,r.column=e.getColumnGroupChild(),r.pinned=e.getPinned(),r}return A(n,[{key:"postConstruct",value:function(){var e=this,t=this.getGui(),n=function(e,n,r){var i=r||t;null!=n&&""!=n?i.setAttribute(e,n):i.removeAttribute(e)},r={setWidth:function(e){return t.style.width=e},addOrRemoveCssClass:function(t,n){return e.addOrRemoveCssClass(t,n)},setColId:function(e){return n("col-id",e)},setTitle:function(e){return n("title",e)},setAriaDescription:function(e){return jy(t,e)},setAriaSort:function(e){return e?nw(t,e):rw(t)},setUserCompDetails:function(t){return e.setUserCompDetails(t)},getUserCompInstance:function(){return e.headerComp}};this.ctrl.setComp(r,this.getGui(),this.eResize,this.eHeaderCompWrapper);var i=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",i)}},{key:"destroyHeaderComp",value:function(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}},{key:"setUserCompDetails",value:function(e){var t=this;this.headerCompVersion++;var n=this.headerCompVersion;e.newAgStackInstance().then((function(e){return t.afterCompCreated(n,e)}))}},{key:"afterCompCreated",value:function(e,t){e==this.headerCompVersion&&this.isAlive()?(this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())):this.destroyBean(t)}}]),n}(OE);rx.TEMPLATE='<div class="ag-header-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>\n        </div>',nx([Jb("eResize")],rx.prototype,"eResize",void 0),nx([Jb("eHeaderCompWrapper")],rx.prototype,"eHeaderCompWrapper",void 0),nx([$g],rx.prototype,"postConstruct",null),nx([em],rx.prototype,"destroyHeaderComp",null);var ix=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ox=function(e){O(n,e);var t=F(n);function n(e){return T(this,n),t.call(this,n.TEMPLATE,e)}return A(n,[{key:"postConstruct",value:function(){var e=this,t=this.getGui(),n=function(e,n){return void 0!=n?t.setAttribute(e,n):t.removeAttribute(e)},r={addOrRemoveCssClass:function(t,n){return e.addOrRemoveCssClass(t,n)},setResizableDisplayed:function(t){return zw(e.eResize,t)},setWidth:function(e){return t.style.width=e},setColId:function(e){return t.setAttribute("col-id",e)},setAriaExpanded:function(e){return n("aria-expanded",e)},setTitle:function(e){return n("title",e)},setUserCompDetails:function(t){return e.setUserCompDetails(t)}};this.ctrl.setComp(r,t,this.eResize)}},{key:"setUserCompDetails",value:function(e){var t=this;e.newAgStackInstance().then((function(e){return t.afterHeaderCompCreated(e)}))}},{key:"afterHeaderCompCreated",value:function(e){var t=this,n=function(){return t.destroyBean(e)};if(this.isAlive()){var r=this.getGui(),i=e.getGui();r.appendChild(i),this.addDestroyFunc(n),this.ctrl.setDragSource(r)}else n()}}]),n}(OE);ox.TEMPLATE='<div class="ag-header-group-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n        </div>',ix([nm("userComponentFactory")],ox.prototype,"userComponentFactory",void 0),ix([Jb("eResize")],ox.prototype,"eResize",void 0),ix([$g],ox.prototype,"postConstruct",null);var ax,sx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e.COLUMN_GROUP="group",e.COLUMN="column",e.FLOATING_FILTER="filter"}(ax||(ax={}));var lx=function(e){O(n,e);var t=F(n);function n(e){var r;T(this,n),(r=t.call(this)).headerComps={};var i=e.getType()==ax.COLUMN_GROUP?"ag-header-row-column-group":e.getType()==ax.FLOATING_FILTER?"ag-header-row-column-filter":"ag-header-row-column";return r.setTemplate('<div class="ag-header-row '.concat(i,'" role="row"></div>')),r.ctrl=e,r}return A(n,[{key:"init",value:function(){var e=this,t={setTransform:function(t){return e.getGui().style.transform=t},setHeight:function(t){return e.getGui().style.height=t},setTop:function(t){return e.getGui().style.top=t},setHeaderCtrls:function(t){return e.setHeaderCtrls(t)},setWidth:function(t){return e.getGui().style.width=t},setAriaRowIndex:function(t){return Jy(e.getGui(),t)}};this.ctrl.setComp(t)}},{key:"destroyHeaderCtrls",value:function(){this.setHeaderCtrls([])}},{key:"setHeaderCtrls",value:function(e){var t=this;if(this.isAlive()){var n=this.headerComps;this.headerComps={},e.forEach((function(e){var r=e.getInstanceId(),i=n[r];delete n[r],null==i&&(i=t.createHeaderComp(e),t.getGui().appendChild(i.getGui())),t.headerComps[r]=i})),Sg(n,(function(e,n){t.getGui().removeChild(n.getGui()),t.destroyBean(n)}));var r=this.gridOptionsService.is("ensureDomOrder"),i=this.gridOptionsService.isDomLayout("print");if(r||i){var o=_g(this.headerComps);o.sort((function(e,t){return e.getCtrl().getColumnGroupChild().getLeft()-t.getCtrl().getColumnGroupChild().getLeft()}));var a=o.map((function(e){return e.getGui()}));cb(this.getGui(),a)}}}},{key:"createHeaderComp",value:function(e){var t;switch(this.ctrl.getType()){case ax.COLUMN_GROUP:t=new ox(e);break;case ax.FLOATING_FILTER:t=new NE(e);break;default:t=new rx(e)}return this.createBean(t),t.setParentComponent(this),t}}]),n}(Zb);sx([$g],lx.prototype,"init",null),sx([em],lx.prototype,"destroyHeaderCtrls",null);var ux=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},cx=0,dx=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this)).lastFocusEvent=null,i.columnGroupChild=e,i.parentRowCtrl=r,i.instanceId=e.getUniqueId()+"-"+cx++,i}return A(n,[{key:"shouldStopEventPropagation",value:function(e){var t=this.focusService.getFocusedHeader(),n=t.headerRowIndex,r=t.column;return Nb(this.gridOptionsService,e,n,r)}},{key:"getWrapperHasFocus",value:function(){return this.gridOptionsService.getDocument().activeElement===this.eGui}},{key:"setGui",value:function(e){this.eGui=e,this.addDomData()}},{key:"handleKeyDown",value:function(e){var t=this.getWrapperHasFocus();switch(e.key){case _b.PAGE_DOWN:case _b.PAGE_UP:case _b.PAGE_HOME:case _b.PAGE_END:t&&e.preventDefault()}}},{key:"addDomData",value:function(){var e=this,t=n.DOM_DATA_KEY_HEADER_CTRL;this.gridOptionsService.setDomData(this.eGui,t,this),this.addDestroyFunc((function(){return e.gridOptionsService.setDomData(e.eGui,t,null)}))}},{key:"getGui",value:function(){return this.eGui}},{key:"focus",value:function(e){return!!this.eGui&&(this.lastFocusEvent=e||null,this.eGui.focus(),!0)}},{key:"getRowIndex",value:function(){return this.parentRowCtrl.getRowIndex()}},{key:"getParentRowCtrl",value:function(){return this.parentRowCtrl}},{key:"getPinned",value:function(){return this.parentRowCtrl.getPinned()}},{key:"getInstanceId",value:function(){return this.instanceId}},{key:"getColumnGroupChild",value:function(){return this.columnGroupChild}}]),n}(Vm);dx.DOM_DATA_KEY_HEADER_CTRL="headerCtrl",ux([nm("focusService")],dx.prototype,"focusService",void 0),ux([nm("beans")],dx.prototype,"beans",void 0),ux([nm("userComponentFactory")],dx.prototype,"userComponentFactory",void 0);var hx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},fx=function(e){O(n,e);var t=F(n);function n(e,r,i,o){var a;return T(this,n),(a=t.call(this)).columnOrGroup=e,a.eCell=r,a.ariaEl=a.eCell.querySelector("[role=columnheader]")||a.eCell,a.colsSpanning=o,a.beans=i,a}return A(n,[{key:"setColsSpanning",value:function(e){this.colsSpanning=e,this.onLeftChanged()}},{key:"getColumnOrGroup",value:function(){return this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?ym(this.colsSpanning):this.columnOrGroup}},{key:"postConstruct",value:function(){this.addManagedListener(this.columnOrGroup,fm.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onLeftChanged.bind(this))}},{key:"setLeftFirstTime",value:function(){var e=this.beans.gridOptionsService.is("suppressColumnMoveAnimation"),t=fg(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&t&&!e?this.animateInLeft():this.onLeftChanged()}},{key:"animateInLeft",value:function(){var e=this,t=this.getColumnOrGroup(),n=t.getLeft(),r=t.getOldLeft(),i=this.modifyLeftForPrintLayout(t,r),o=this.modifyLeftForPrintLayout(t,n);this.setLeft(i),this.actualLeft=o,this.beans.columnAnimationService.executeNextVMTurn((function(){e.actualLeft===o&&e.setLeft(o)}))}},{key:"onLeftChanged",value:function(){var e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}},{key:"modifyLeftForPrintLayout",value:function(e,t){if(!this.beans.gridOptionsService.isDomLayout("print"))return t;if("left"===e.getPinned())return t;var n=this.beans.columnModel.getDisplayedColumnsLeftWidth();return"right"===e.getPinned()?n+this.beans.columnModel.getBodyContainerWidth()+t:n+t}},{key:"setLeft",value:function(e){var t;if(fg(e)&&(this.eCell.style.left="".concat(e,"px")),this.columnOrGroup instanceof fm)t=this.columnOrGroup;else{var n=this.columnOrGroup.getLeafColumns();if(!n.length)return;n.length>1&&tw(this.ariaEl,n.length),t=n[0]}var r=this.beans.columnModel.getAriaColumnIndex(t);ew(this.ariaEl,r)}}]),n}(Vm);hx([$g],fx.prototype,"postConstruct",null);var px=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},vx=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this)).columns=e,i.element=r,i}return A(n,[{key:"postConstruct",value:function(){this.gridOptionsService.is("columnHoverHighlight")&&this.addMouseHoverListeners()}},{key:"addMouseHoverListeners",value:function(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))}},{key:"onMouseOut",value:function(){this.columnHoverService.clearMouseOver()}},{key:"onMouseOver",value:function(){this.columnHoverService.setMouseOver(this.columns)}}]),n}(Vm);px([nm("columnHoverService")],vx.prototype,"columnHoverService",void 0),px([$g],vx.prototype,"postConstruct",null);var gx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},mx=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this,e,r)).iconCreated=!1,i.column=e,i}return A(n,[{key:"setComp",value:function(e,t,r,i){cg(D(n.prototype),"setGui",this).call(this,t),this.comp=e,this.eButtonShowMainFilter=r,this.eFloatingFilterBody=i,this.setupActive(),this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this)),this.setupFilterChangedListener(),this.addManagedListener(this.column,fm.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this))}},{key:"setupActive",value:function(){var e=this.column.getColDef(),t=!!e.filter,n=!!e.floatingFilter;this.active=t&&n}},{key:"setupUi",value:function(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),this.active&&!this.iconCreated){var e=Rb("filter",this.gridOptionsService,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}}},{key:"setupFocus",value:function(){this.createManagedBean(new aC(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}},{key:"setupAria",value:function(){var e=this.localeService.getLocaleTextFunc();Gy(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}},{key:"onTabKeyDown",value:function(e){if(!(this.gridOptionsService.getDocument().activeElement===this.eGui)){var t=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(t)return this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),void t.focus();var n=this.findNextColumnWithFloatingFilter(e.shiftKey);n&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:n},event:e})&&e.preventDefault()}}},{key:"findNextColumnWithFloatingFilter",value:function(e){var t=this.beans.columnModel,n=this.column;do{if(!(n=e?t.getDisplayedColBefore(n):t.getDisplayedColAfter(n)))break}while(!n.getColDef().filter||!n.getColDef().floatingFilter);return n}},{key:"handleKeyDown",value:function(e){cg(D(n.prototype),"handleKeyDown",this).call(this,e);var t=this.getWrapperHasFocus();switch(e.key){case _b.UP:case _b.DOWN:t||e.preventDefault();case _b.LEFT:case _b.RIGHT:if(t)return;e.stopPropagation();case _b.ENTER:t&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case _b.ESCAPE:t||this.eGui.focus()}}},{key:"onFocusIn",value:function(e){if(!this.eGui.contains(e.relatedTarget)){var t=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),n=!!e.relatedTarget&&qw(e.relatedTarget,"ag-floating-filter");if(t&&n&&e.target===this.eGui){var r=this.lastFocusEvent,i=!(!r||r.key!==_b.TAB);if(r&&i){var o=r.shiftKey;this.focusService.focusInto(this.eGui,o)}}var a=this.getRowIndex();this.beans.focusService.setFocusedHeader(a,this.column)}}},{key:"setupHover",value:function(){var e=this;this.createManagedBean(new vx([this.column],this.eGui));var t=function(){if(e.gridOptionsService.is("columnHoverHighlight")){var t=e.columnHoverService.isHovered(e.column);e.comp.addOrRemoveCssClass("ag-column-hover",t)}};this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_HOVER_CHANGED,t),t()}},{key:"setupLeft",value:function(){var e=new fx(this.column,this.eGui,this.beans);this.createManagedBean(e)}},{key:"setupFilterButton",value:function(){var e=this.column.getColDef();this.suppressFilterButton=!!e.floatingFilterComponentParams&&!!e.floatingFilterComponentParams.suppressFilterButton}},{key:"setupUserComp",value:function(){var e=this;if(this.active){var t=this.filterManager.getFloatingFilterCompDetails(this.column,(function(){return e.showParentFilter()}));t&&this.setCompDetails(t)}}},{key:"setCompDetails",value:function(e){this.userCompDetails=e,this.comp.setCompDetails(e)}},{key:"showParentFilter",value:function(){var e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuFactory.showMenuAfterButtonClick(this.column,e,"floatingFilter","filterMenuTab",["filterMenuTab"])}},{key:"setupSyncWithFilter",value:function(){var e=this;if(this.active){var t=function(t){var n=e.comp.getFloatingFilterComp();n&&n.then((function(n){if(n){var r=e.filterManager.getCurrentFloatingFilterParentModel(e.column);n.onParentModelChanged(r,t)}}))};this.destroySyncListener=this.addManagedListener(this.column,fm.EVENT_FILTER_CHANGED,t),this.filterManager.isFilterActive(this.column)&&t(null)}}},{key:"setupWidth",value:function(){var e=this,t=function(){var t="".concat(e.column.getActualWidth(),"px");e.comp.setWidth(t)};this.addManagedListener(this.column,fm.EVENT_WIDTH_CHANGED,t),t()}},{key:"setupFilterChangedListener",value:function(){this.active&&(this.destroyFilterChangedListener=this.addManagedListener(this.column,fm.EVENT_FILTER_CHANGED,this.updateFilterButton.bind(this)))}},{key:"updateFilterButton",value:function(){!this.suppressFilterButton&&this.comp&&this.comp.setButtonWrapperDisplayed(this.filterManager.isFilterAllowed(this.column))}},{key:"onColDefChanged",value:function(){var e,t,n=this,r=this.active;this.setupActive();var i=!r&&this.active;r&&!this.active&&(null===(e=this.destroySyncListener)||void 0===e||e.call(this),null===(t=this.destroyFilterChangedListener)||void 0===t||t.call(this));var o=this.active?this.filterManager.getFloatingFilterCompDetails(this.column,(function(){return n.showParentFilter()})):null,a=this.comp.getFloatingFilterComp();a&&o?a.then((function(e){var t;e&&(null===(t=n.userCompDetails)||void 0===t?void 0:t.componentClass)===o.componentClass||n.updateCompDetails(o,i)})):this.updateCompDetails(o,i)}},{key:"updateCompDetails",value:function(e,t){this.setCompDetails(e),this.setupFilterButton(),this.setupUi(),t&&(this.setupSyncWithFilter(),this.setupFilterChangedListener())}}]),n}(dx);gx([nm("filterManager")],mx.prototype,"filterManager",void 0),gx([nm("columnHoverService")],mx.prototype,"columnHoverService",void 0),gx([nm("menuFactory")],mx.prototype,"menuFactory",void 0);var yx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},wx=function(e){O(n,e);var t=F(n);function n(e,r,i,o,a){var s;return T(this,n),(s=t.call(this)).pinned=e,s.column=r,s.eResize=i,s.comp=o,s.ctrl=a,s}return A(n,[{key:"postConstruct",value:function(){var e,t,n=this,r=this.column.getColDef(),i=[],o=function(){i.forEach((function(e){return e()})),i.length=0},a=function(){var a=n.column.isResizable(),s=!n.gridOptionsService.is("suppressAutoSize")&&!r.suppressAutoSize;(a!==e||s!==t)&&(e=a,t=s,o(),function(){if(zw(n.eResize,e),e){var r=n.horizontalResizeService.addResizeBar({eResizeBar:n.eResize,onResizeStart:n.onResizeStart.bind(n),onResizing:n.onResizing.bind(n,!1),onResizeEnd:n.onResizing.bind(n,!0)});if(i.push(r),t){var o=n.gridOptionsService.is("skipHeaderOnAutoSize"),a=function(){n.columnModel.autoSizeColumn(n.column,o,"uiColumnResized")};n.eResize.addEventListener("dblclick",a);var s=new ZC(n.eResize);s.addEventListener(ZC.EVENT_DOUBLE_TAP,a),n.addDestroyFunc((function(){n.eResize.removeEventListener("dblclick",a),s.removeEventListener(ZC.EVENT_DOUBLE_TAP,a),s.destroy()}))}}}())};a(),this.addDestroyFunc(o),this.ctrl.addRefreshFunction(a)}},{key:"onResizing",value:function(e,t){var n=this.normaliseResizeAmount(t),r=[{key:this.column,newWidth:this.resizeStartWidth+n}];this.columnModel.setColumnWidths(r,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)}},{key:"onResizeStart",value:function(e){this.resizeStartWidth=this.column.getActualWidth(),this.resizeWithShiftKey=e,this.comp.addOrRemoveCssClass("ag-column-resizing",!0)}},{key:"normaliseResizeAmount",value:function(e){var t=e,n="left"!==this.pinned,r="right"===this.pinned;return this.gridOptionsService.is("enableRtl")?n&&(t*=-1):r&&(t*=-1),t}}]),n}(Vm);yx([nm("horizontalResizeService")],wx.prototype,"horizontalResizeService",void 0),yx([nm("columnModel")],wx.prototype,"columnModel",void 0),yx([$g],wx.prototype,"postConstruct",null);var bx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Cx=function(e){O(n,e);var t=F(n);function n(e){var r;T(this,n),(r=t.call(this)).cbSelectAllVisible=!1,r.processingEventFromCheckbox=!1,r.column=e;var i=e.getColDef();return r.filteredOnly=!!(null===i||void 0===i?void 0:i.headerCheckboxSelectionFilteredOnly),r.currentPageOnly=!!(null===i||void 0===i?void 0:i.headerCheckboxSelectionCurrentPageOnly),r}return A(n,[{key:"onSpaceKeyDown",value:function(e){var t=this.cbSelectAll,n=this.gridOptionsService.getDocument();t.isDisplayed()&&!t.getGui().contains(n.activeElement)&&(e.preventDefault(),t.setValue(!t.getValue()))}},{key:"getCheckboxGui",value:function(){return this.cbSelectAll.getGui()}},{key:"setComp",value:function(e){this.headerCellCtrl=e,this.cbSelectAll=this.createManagedBean(new kC),this.cbSelectAll.addCssClass("ag-header-select-all"),Fy(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,Ym.EVENT_NEW_COLUMNS_LOADED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_PAGINATION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,kC.EVENT_CHANGED,this.onCbSelectAll.bind(this)),Uy(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}},{key:"showOrHideSelectAll",value:function(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}},{key:"onModelChanged",value:function(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}},{key:"onSelectionChanged",value:function(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}},{key:"updateStateOfCheckbox",value:function(){if(!this.processingEventFromCheckbox){this.processingEventFromCheckbox=!0;var e=this.selectionService.getSelectAllState(this.filteredOnly,this.currentPageOnly);this.cbSelectAll.setValue(e),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}}},{key:"refreshSelectAllLabel",value:function(){var e=this.localeService.getLocaleTextFunc(),t=this.cbSelectAll.getValue()?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),n=e("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll","".concat(n," (").concat(t,")")):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel("".concat(n," (").concat(t,")")),this.headerCellCtrl.refreshAriaDescription()}},{key:"checkRightRowModelType",value:function(e){var t=this.rowModel.getType();return!("clientSide"!==t&&"serverSide"!==t)||(console.warn("AG Grid: ".concat(e," is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ").concat(t,".")),!1)}},{key:"onCbSelectAll",value:function(){if(!this.processingEventFromCheckbox&&this.cbSelectAllVisible){var e=this.cbSelectAll.getValue(),t="uiSelectAll";this.currentPageOnly?t="uiSelectAllCurrentPage":this.filteredOnly&&(t="uiSelectAllFiltered");var n={source:t,justFiltered:this.filteredOnly,justCurrentPage:this.currentPageOnly};e?this.selectionService.selectAllRowNodes(n):this.selectionService.deselectAllRowNodes(n)}}},{key:"isCheckboxSelection",value:function(){var e=this.column.getColDef().headerCheckboxSelection;"function"===typeof e&&(e=e({column:this.column,colDef:this.column.getColDef(),columnApi:this.columnApi,api:this.gridApi,context:this.gridOptionsService.context}));return!!e&&this.checkRightRowModelType("headerCheckboxSelection")}}]),n}(Vm);bx([nm("gridApi")],Cx.prototype,"gridApi",void 0),bx([nm("columnApi")],Cx.prototype,"columnApi",void 0),bx([nm("rowModel")],Cx.prototype,"rowModel",void 0),bx([nm("selectionService")],Cx.prototype,"selectionService",void 0);var Sx,Ex=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e.TAB_GUARD="ag-tab-guard",e.TAB_GUARD_TOP="ag-tab-guard-top",e.TAB_GUARD_BOTTOM="ag-tab-guard-bottom"}(Sx||(Sx={}));var kx=function(e){O(n,e);var t=F(n);function n(e){var r;T(this,n),(r=t.call(this)).skipTabGuardFocus=!1;var i=e.comp,o=e.eTopGuard,a=e.eBottomGuard,s=e.focusInnerElement,l=e.onFocusIn,u=e.onFocusOut,c=e.shouldStopEventPropagation,d=e.onTabKeyDown,h=e.handleKeyDown,f=e.eFocusableElement;return r.comp=i,r.eTopGuard=o,r.eBottomGuard=a,r.providedFocusInnerElement=s,r.eFocusableElement=f,r.providedFocusIn=l,r.providedFocusOut=u,r.providedShouldStopEventPropagation=c,r.providedOnTabKeyDown=d,r.providedHandleKeyDown=h,r}return A(n,[{key:"postConstruct",value:function(){var e=this;this.createManagedBean(new aC(this.eFocusableElement,{shouldStopEventPropagation:function(){return e.shouldStopEventPropagation()},onTabKeyDown:function(t){return e.onTabKeyDown(t)},handleKeyDown:function(t){return e.handleKeyDown(t)},onFocusIn:function(t){return e.onFocusIn(t)},onFocusOut:function(t){return e.onFocusOut(t)}})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach((function(t){return e.addManagedListener(t,"focus",e.onFocus.bind(e))}))}},{key:"handleKeyDown",value:function(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}},{key:"tabGuardsAreActive",value:function(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}},{key:"shouldStopEventPropagation",value:function(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()}},{key:"activateTabGuards",value:function(){var e=this.gridOptionsService.getNum("tabIndex")||0;this.comp.setTabIndex(e.toString())}},{key:"deactivateTabGuards",value:function(){this.comp.setTabIndex()}},{key:"onFocus",value:function(e){if(this.skipTabGuardFocus)this.skipTabGuardFocus=!1;else{var t=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t)}}},{key:"onFocusIn",value:function(e){this.providedFocusIn&&this.providedFocusIn(e)||this.deactivateTabGuards()}},{key:"onFocusOut",value:function(e){this.providedFocusOut&&this.providedFocusOut(e)||this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards()}},{key:"onTabKeyDown",value:function(e){var t=this;if(this.providedOnTabKeyDown)this.providedOnTabKeyDown(e);else if(!e.defaultPrevented){var n=this.tabGuardsAreActive();n&&this.deactivateTabGuards();var r=this.getNextFocusableElement(e.shiftKey);n&&setTimeout((function(){return t.activateTabGuards()}),0),r&&(r.focus(),e.preventDefault())}}},{key:"focusInnerElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length&&t[e?t.length-1:0].focus({preventScroll:!0})}},{key:"getNextFocusableElement",value:function(e){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e)}},{key:"forceFocusOutOfContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,e.focus()}}]),n}(Vm);Ex([nm("focusService")],kx.prototype,"focusService",void 0),Ex([$g],kx.prototype,"postConstruct",null);var xx,Tx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Rx=xx=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"init",value:function(){var e=this,t=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_PIVOT_MODE_CHANGED,t),this.addManagedListener(this.eventService,Ym.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_GROUP_OPENED,t),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,t),this.ctrlsService.whenReady((function(t){e.gridCtrl=t.gridCtrl;var n=e.gridOptionsService.getDocument();xx.addKeyboardModeEvents(n,e.gridCtrl),e.addDestroyFunc((function(){return e.unregisterGridCompController(e.gridCtrl)}))}))}},{key:"unregisterGridCompController",value:function(e){var t=this.gridOptionsService.getDocument();xx.removeKeyboardModeEvents(t,e)}},{key:"onColumnEverythingChanged",value:function(){if(this.focusedCellPosition){var e=this.focusedCellPosition.column,t=this.columnModel.getGridColumn(e.getId());e!==t&&this.clearFocusedCell()}}},{key:"isKeyboardMode",value:function(){return xx.keyboardModeActive}},{key:"getFocusCellToUseAfterRefresh",value:function(){var e=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(e.activeElement,ck.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}},{key:"getFocusHeaderToUseAfterRefresh",value:function(){var e=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(e.activeElement,dx.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}},{key:"isDomDataMissingInHierarchy",value:function(e,t){for(var n=e;n;){if(this.gridOptionsService.getDomData(n,t))return!1;n=n.parentNode}return!0}},{key:"getFocusedCell",value:function(){return this.focusedCellPosition}},{key:"shouldRestoreFocus",value:function(e){var t=this;return!!this.isCellRestoreFocused(e)&&(setTimeout((function(){t.restoredFocusedCellPosition=null}),0),!0)}},{key:"isCellRestoreFocused",value:function(e){return null!=this.restoredFocusedCellPosition&&this.cellPositionUtils.equals(e,this.restoredFocusedCellPosition)}},{key:"setRestoreFocusedCell",value:function(e){"react"===this.getFrameworkOverrides().renderingEngine&&(this.restoredFocusedCellPosition=e)}},{key:"getFocusEventParams",value:function(){var e=this.focusedCellPosition,t=e.rowIndex,n=e.rowPinned,r={rowIndex:t,rowPinned:n,column:e.column,isFullWidthCell:!1},i=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:n});return i&&(r.isFullWidthCell=i.isFullWidth()),r}},{key:"clearFocusedCell",value:function(){if(this.restoredFocusedCellPosition=null,null!=this.focusedCellPosition){var e=Object.assign({type:Ym.EVENT_CELL_FOCUS_CLEARED},this.getFocusEventParams());this.focusedCellPosition=null,this.eventService.dispatchEvent(e)}}},{key:"setFocusedCell",value:function(e){var t=e.column,n=e.rowIndex,r=e.rowPinned,i=e.forceBrowserFocus,o=void 0!==i&&i,a=e.preventScrollOnBrowserFocus,s=void 0!==a&&a,l=this.columnModel.getGridColumn(t);if(l){this.focusedCellPosition=l?{rowIndex:n,rowPinned:hg(r),column:l}:null;var u=Object.assign(Object.assign({type:Ym.EVENT_CELL_FOCUSED},this.getFocusEventParams()),{forceBrowserFocus:o,preventScrollOnBrowserFocus:s,floating:null});this.eventService.dispatchEvent(u)}else this.focusedCellPosition=null}},{key:"isCellFocused",value:function(e){return null!=this.focusedCellPosition&&this.cellPositionUtils.equals(e,this.focusedCellPosition)}},{key:"isRowNodeFocused",value:function(e){return this.isRowFocused(e.rowIndex,e.rowPinned)}},{key:"isHeaderWrapperFocused",value:function(e){if(null==this.focusedHeaderPosition)return!1;var t=e.getColumnGroupChild(),n=e.getRowIndex(),r=e.getPinned(),i=this.focusedHeaderPosition,o=i.column,a=i.headerRowIndex;return t===o&&n===a&&r==o.getPinned()}},{key:"clearFocusedHeader",value:function(){this.focusedHeaderPosition=null}},{key:"getFocusedHeader",value:function(){return this.focusedHeaderPosition}},{key:"setFocusedHeader",value:function(e,t){this.focusedHeaderPosition={headerRowIndex:e,column:t}}},{key:"focusHeaderPosition",value:function(e){var t=e.direction,n=e.fromTab,r=e.allowUserOverride,i=e.event,o=e.headerPosition;if(r){var a=this.getFocusedHeader(),s=this.headerNavigationService.getHeaderRowCount();if(n){var l=this.gridOptionsService.getCallback("tabToNextHeader");if(l)o=l({backwards:"Before"===t,previousHeaderPosition:a,nextHeaderPosition:o,headerRowCount:s})}else{var u=this.gridOptionsService.getCallback("navigateToNextHeader");if(u&&i)o=u({key:i.key,previousHeaderPosition:a,nextHeaderPosition:o,headerRowCount:s,event:i})}}return!!o&&(-1===o.headerRowIndex?this.focusGridView(o.column):(this.headerNavigationService.scrollToColumn(o.column,t),this.ctrlsService.getHeaderRowContainerCtrl(o.column.getPinned()).focusHeader(o.headerRowIndex,o.column,i)))}},{key:"focusFirstHeader",value:function(){var e=this.columnModel.getAllDisplayedColumns()[0];return!!e&&(e.getParent()&&(e=this.columnModel.getColumnGroupAtLevel(e,0)),this.focusHeaderPosition({headerPosition:{headerRowIndex:0,column:e}}))}},{key:"focusLastHeader",value:function(e){var t=this.headerNavigationService.getHeaderRowCount()-1,n=ym(this.columnModel.getAllDisplayedColumns());return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:n},event:e})}},{key:"isAnyCellFocused",value:function(){return!!this.focusedCellPosition}},{key:"isRowFocused",value:function(e,t){return null!=this.focusedCellPosition&&(this.focusedCellPosition.rowIndex===e&&this.focusedCellPosition.rowPinned===hg(t))}},{key:"findFocusableElements",value:function(e,t){var n=Hw,r=Vw;t&&(r+=", "+t),arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(r+=', [tabindex="-1"]');var i=Array.prototype.slice.apply(e.querySelectorAll(n)),o=Array.prototype.slice.apply(e.querySelectorAll(r));if(!o.length)return i;return function(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))}(i,o)}},{key:"focusInto",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.findFocusableElements(e,null,n),i=t?ym(r):r[0];return!!i&&(i.focus({preventScroll:!0}),!0)}},{key:"findFocusableElementBeforeTabGuard",value:function(e,t){if(!t)return null;var n=this.findFocusableElements(e),r=n.indexOf(t);if(-1===r)return null;for(var i=-1,o=r-1;o>=0;o--)if(n[o].classList.contains(Sx.TAB_GUARD_TOP)){i=o;break}return i<=0?null:n[i-1]}},{key:"findNextFocusableElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eGridDiv,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=this.findFocusableElements(e,t?':not([tabindex="-1"])':null),i=this.gridOptionsService.getDocument().activeElement,o=(t?r.findIndex((function(e){return e.contains(i)})):r.indexOf(i))+(n?-1:1);return o<0||o>=r.length?null:r[o]}},{key:"isTargetUnderManagedComponent",value:function(e,t){if(!t)return!1;var n=e.querySelectorAll(".".concat(aC.FOCUS_MANAGED_CLASS));if(!n.length)return!1;for(var r=0;r<n.length;r++)if(n[r].contains(t))return!0;return!1}},{key:"findTabbableParent",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=0;e&&null===Ew(e)&&++n<=t;)e=e.parentElement;return null===Ew(e)?null:e}},{key:"focusGridView",value:function(e,t){if(this.gridOptionsService.is("suppressCellFocus"))return t?this.focusLastHeader():this.focusNextGridCoreContainer(!1);var n=t?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!n)return!1;var r=n.rowIndex,i=n.rowPinned,o=this.getFocusedHeader();if(!e&&o&&(e=o.column),null==r||!e)return!1;if(this.navigationService.ensureCellVisible({rowIndex:r,column:e,rowPinned:i}),this.setFocusedCell({rowIndex:r,column:e,rowPinned:hg(i),forceBrowserFocus:!0}),this.rangeService){var a={rowIndex:r,rowPinned:i,column:e};this.rangeService.setRangeToCell(a)}return!0}},{key:"focusNextGridCoreContainer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!(t||!this.gridCtrl.focusNextInnerContainer(e))||((t||!e&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(e),!1)}}],[{key:"addKeyboardModeEvents",value:function(e,t){var n=xx.instancesMonitored.get(e);n&&n.length>0?-1===n.indexOf(t)&&n.push(t):(xx.instancesMonitored.set(e,[t]),e.addEventListener("keydown",xx.toggleKeyboardMode),e.addEventListener("mousedown",xx.toggleKeyboardMode))}},{key:"removeKeyboardModeEvents",value:function(e,t){var n=xx.instancesMonitored.get(e),r=[];n&&n.length&&(r=wt(n).filter((function(e){return e!==t})),xx.instancesMonitored.set(e,r)),0===r.length&&(e.removeEventListener("keydown",xx.toggleKeyboardMode),e.removeEventListener("mousedown",xx.toggleKeyboardMode))}},{key:"toggleKeyboardMode",value:function(e){var t=xx.keyboardModeActive,n="keydown"===e.type;if((!n||!(e.ctrlKey||e.metaKey||e.altKey))&&!(t&&n||!t&&!n)){xx.keyboardModeActive=n;var r=e.target.ownerDocument;if(r){var i=xx.instancesMonitored.get(r);i&&i.forEach((function(e){e.dispatchEvent({type:n?Ym.EVENT_KEYBOARD_FOCUS:Ym.EVENT_MOUSE_FOCUS})}))}}}}]),n}(Vm);Rx.AG_KEYBOARD_FOCUS="ag-keyboard-focus",Rx.keyboardModeActive=!1,Rx.instancesMonitored=new Map,Tx([nm("eGridDiv")],Rx.prototype,"eGridDiv",void 0),Tx([nm("columnModel")],Rx.prototype,"columnModel",void 0),Tx([nm("headerNavigationService")],Rx.prototype,"headerNavigationService",void 0),Tx([nm("rowRenderer")],Rx.prototype,"rowRenderer",void 0),Tx([nm("rowPositionUtils")],Rx.prototype,"rowPositionUtils",void 0),Tx([nm("cellPositionUtils")],Rx.prototype,"cellPositionUtils",void 0),Tx([rm("rangeService")],Rx.prototype,"rangeService",void 0),Tx([nm("navigationService")],Rx.prototype,"navigationService",void 0),Tx([nm("ctrlsService")],Rx.prototype,"ctrlsService",void 0),Tx([$g],Rx.prototype,"init",null),Rx=xx=Tx([tm("focusService")],Rx);var Ax=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},_x=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this,e,r)).refreshFunctions=[],i.userHeaderClasses=new Set,i.ariaDescriptionProperties=new Map,i.column=e,i}return A(n,[{key:"setComp",value:function(e,t,r,i){var o=this;cg(D(n.prototype),"setGui",this).call(this,t),this.comp=e,this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(i),this.addColumnHoverListener(),this.setupFilterCss(),this.setupColId(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.createManagedBean(new wx(this.getPinned(),this.column,r,e,this)),this.createManagedBean(new vx([this.column],t)),this.createManagedBean(new fx(this.column,t,this.beans)),this.createManagedBean(new aC(t,{shouldStopEventPropagation:function(e){return o.shouldStopEventPropagation(e)},onTabKeyDown:function(){return null},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addMouseDownListenerIfNeeded(t),this.addManagedListener(this.column,fm.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}},{key:"addMouseDownListenerIfNeeded",value:function(e){var t=this;if(gw()){var n=this.gridOptionsService.getDocument();["mousedown","touchstart"].forEach((function(r){t.addManagedListener(e,r,(function(t){var r=n.activeElement;r===e||e.contains(r)||(e.focus(),Rx.toggleKeyboardMode(t))}))}))}}},{key:"setupUserComp",value:function(){var e=this.lookupUserCompDetails();this.setCompDetails(e)}},{key:"setCompDetails",value:function(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}},{key:"lookupUserCompDetails",value:function(){var e=this.createParams(),t=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(t,e)}},{key:"createParams",value:function(){var e=this,t=this.column.getColDef(),n={column:this.column,displayName:this.displayName,enableSorting:t.sortable,enableMenu:this.menuEnabled,showColumnMenu:function(t){e.gridApi.showColumnMenuAfterButtonClick(e.column,t)},progressSort:function(t){e.sortController.progressSort(e.column,!!t,"uiColumnSorted")},setSort:function(t,n){e.sortController.setSortForColumn(e.column,t,!!n,"uiColumnSorted")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context,eGridHeader:this.getGui()};return n}},{key:"setupSelectAll",value:function(){this.selectAllFeature=this.createManagedBean(new Cx(this.column)),this.selectAllFeature.setComp(this)}},{key:"getSelectAllGui",value:function(){return this.selectAllFeature.getCheckboxGui()}},{key:"handleKeyDown",value:function(e){cg(D(n.prototype),"handleKeyDown",this).call(this,e),e.key===_b.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===_b.ENTER&&this.onEnterKeyDown(e)}},{key:"onEnterKeyDown",value:function(e){var t=this.comp.getUserCompInstance();if(t)if(e.ctrlKey||e.metaKey)this.menuEnabled&&t.showMenu&&(e.preventDefault(),t.showMenu());else if(this.sortable){var n=e.shiftKey;this.sortController.progressSort(this.column,n,"uiColumnSorted")}}},{key:"isMenuEnabled",value:function(){return this.menuEnabled}},{key:"onFocusIn",value:function(e){if(!this.getGui().contains(e.relatedTarget)){var t=this.getRowIndex();this.focusService.setFocusedHeader(t,this.column)}this.setActiveHeader(!0)}},{key:"onFocusOut",value:function(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)}},{key:"setupTooltip",value:function(){var e=this,t={getColumn:function(){return e.column},getColDef:function(){return e.column.getColDef()},getGui:function(){return e.eGui},getLocation:function(){return"header"},getTooltipValue:function(){return e.column.getColDef().headerTooltip}},n=this.createManagedBean(new $E(t,this.beans));n.setComp(this.comp),this.refreshFunctions.push((function(){return n.refreshToolTip()}))}},{key:"setupClassesFromColDef",value:function(){var e=this,t=function(){var t=e.column.getColDef(),n=tx.getHeaderClassesFromColDef(t,e.gridOptionsService,e.column,null),r=e.userHeaderClasses;e.userHeaderClasses=new Set(n),n.forEach((function(t){r.has(t)?r.delete(t):e.comp.addOrRemoveCssClass(t,!0)})),r.forEach((function(t){return e.comp.addOrRemoveCssClass(t,!1)}))};this.refreshFunctions.push(t),t()}},{key:"setDragSource",value:function(e){var t=this;if(this.dragSourceElement=e,this.removeDragSource(),e&&this.draggable){var n=!this.gridOptionsService.is("suppressDragLeaveHidesColumns");this.moveDragSource={type:CS.HeaderCell,eElement:e,defaultIconName:n?xS.ICON_HIDE:xS.ICON_NOT_ALLOWED,getDragItem:function(){return t.createDragItem()},dragItemName:this.displayName,onDragStarted:function(){return t.column.setMoving(!0,"uiColumnMoved")},onDragStopped:function(){return t.column.setMoving(!1,"uiColumnMoved")},onGridEnter:function(e){var r;if(n){var i=(null===(r=null===e||void 0===e?void 0:e.columns)||void 0===r?void 0:r.filter((function(e){return!e.getColDef().lockVisible})))||[];t.columnModel.setColumnsVisible(i,!0,"uiColumnMoved")}},onGridExit:function(e){var r;if(n){var i=(null===(r=null===e||void 0===e?void 0:e.columns)||void 0===r?void 0:r.filter((function(e){return!e.getColDef().lockVisible})))||[];t.columnModel.setColumnsVisible(i,!1,"uiColumnMoved")}}},this.dragAndDropService.addDragSource(this.moveDragSource,!0)}}},{key:"createDragItem",value:function(){var e={};return e[this.column.getId()]=this.column.isVisible(),{columns:[this.column],visibleState:e}}},{key:"removeDragSource",value:function(){this.moveDragSource&&(this.dragAndDropService.removeDragSource(this.moveDragSource),this.moveDragSource=void 0)}},{key:"onColDefChanged",value:function(){this.refresh()}},{key:"updateState",value:function(){var e=this.column.getColDef();this.menuEnabled=this.menuFactory.isMenuEnabled(this.column)&&!e.suppressMenu,this.sortable=e.sortable,this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}},{key:"addRefreshFunction",value:function(e){this.refreshFunctions.push(e)}},{key:"refresh",value:function(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach((function(e){return e()}))}},{key:"refreshHeaderComp",value:function(){var e=this.lookupUserCompDetails();!!(null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==e.componentClass)&&this.attemptHeaderCompRefresh(e.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}},{key:"attemptHeaderCompRefresh",value:function(e){var t=this.comp.getUserCompInstance();return!!t&&(!!t.refresh&&t.refresh(e))}},{key:"calculateDisplayName",value:function(){return this.columnModel.getDisplayNameForColumn(this.column,"header",!0)}},{key:"checkDisplayName",value:function(){this.displayName!==this.calculateDisplayName()&&this.refresh()}},{key:"workOutDraggable",value:function(){var e=this.column.getColDef();return!!(!this.gridOptionsService.is("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}},{key:"onColumnRowGroupChanged",value:function(){this.checkDisplayName()}},{key:"onColumnPivotChanged",value:function(){this.checkDisplayName()}},{key:"onColumnValueChanged",value:function(){this.checkDisplayName()}},{key:"setupWidth",value:function(){var e=this,t=function(){var t=e.column.getActualWidth();e.comp.setWidth("".concat(t,"px"))};this.addManagedListener(this.column,fm.EVENT_WIDTH_CHANGED,t),t()}},{key:"setupMovingCss",value:function(){var e=this,t=function(){e.comp.addOrRemoveCssClass("ag-header-cell-moving",e.column.isMoving())};this.addManagedListener(this.column,fm.EVENT_MOVING_CHANGED,t),t()}},{key:"setupMenuClass",value:function(){var e=this,t=function(){e.comp.addOrRemoveCssClass("ag-column-menu-visible",e.column.isMenuVisible())};this.addManagedListener(this.column,fm.EVENT_MENU_VISIBLE_CHANGED,t),t()}},{key:"setupSortableClass",value:function(){var e=this,t=function(){e.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!e.sortable)};t(),this.addRefreshFunction(t),this.addManagedListener(this.eventService,fm.EVENT_SORT_CHANGED,this.refreshAriaSort.bind(this))}},{key:"setupWrapTextClass",value:function(){var e=this,t=function(){var t=!!e.column.getColDef().wrapHeaderText;e.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",t)};t(),this.addRefreshFunction(t)}},{key:"onHeaderHeightChanged",value:function(){this.refreshSpanHeaderHeight()}},{key:"refreshSpanHeaderHeight",value:function(){var e=this.eGui,t=this.column,n=this.comp,r=this.columnModel,i=this.gridOptionsService;if(t.isSpanHeaderHeight()){var o=this.getColumnGroupPaddingInfo(),a=o.numberOfParents,s=o.isSpanningTotal;if(n.addOrRemoveCssClass("ag-header-span-height",a>0),0!==a){n.addOrRemoveCssClass("ag-header-span-total",s);var l=i.is("pivotMode")?r.getPivotGroupHeaderHeight():r.getGroupHeaderHeight(),u=r.getColumnHeaderRowHeight(),c=a*l;e.style.setProperty("top","".concat(-c,"px")),e.style.setProperty("height","".concat(u+c,"px"))}}}},{key:"getColumnGroupPaddingInfo",value:function(){var e=this.column.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};for(var t=e.getPaddingLevel()+1,n=!0;e;){if(!e.isPadding()){n=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:n}}},{key:"setupAutoHeight",value:function(e){var t,n=this,r=function t(r){if(n.isAlive()){var i=Xw(n.getGui()),o=i.paddingTop+i.paddingBottom+i.borderBottomWidth+i.borderTopWidth,a=e.offsetHeight+o;if(r<5){var s=n.beans.gridOptionsService.getDocument();if(!s||!s.contains(e)||0==a)return void n.beans.frameworkOverrides.setTimeout((function(){return t(r+1)}),0)}n.columnModel.setColumnHeaderHeight(n.column,a)}},i=!1,o=function(){var e=n.column.isAutoHeaderHeight();e&&!i&&a(),!e&&i&&s()},a=function(){i=!0,r(0),n.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),t=n.resizeObserverService.observeResize(e,(function(){return r(0)}))},s=function(){i=!1,t&&t(),n.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),t=void 0};o(),this.addDestroyFunc((function(){return s()})),this.addManagedListener(this.column,fm.EVENT_WIDTH_CHANGED,(function(){return i&&r(0)})),this.addManagedListener(this.eventService,fm.EVENT_SORT_CHANGED,(function(){i&&n.beans.frameworkOverrides.setTimeout((function(){return r(0)}))})),this.addRefreshFunction(o)}},{key:"refreshAriaSort",value:function(){if(this.sortable){var e=this.localeService.getLocaleTextFunc(),t=this.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(Iy(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort."))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}},{key:"refreshAriaMenu",value:function(){if(this.menuEnabled){var e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press CTRL ENTER to open column menu."))}else this.setAriaDescriptionProperty("menu",null)}},{key:"setAriaDescriptionProperty",value:function(e,t){null!=t?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}},{key:"refreshAriaDescription",value:function(){var e=Array.from(this.ariaDescriptionProperties.values());this.comp.setAriaDescription(e.length?e.join(" "):void 0)}},{key:"refreshAria",value:function(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaDescription()}},{key:"addColumnHoverListener",value:function(){var e=this,t=function(){if(e.gridOptionsService.is("columnHoverHighlight")){var t=e.columnHoverService.isHovered(e.column);e.comp.addOrRemoveCssClass("ag-column-hover",t)}};this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_HOVER_CHANGED,t),t()}},{key:"setupFilterCss",value:function(){var e=this,t=function(){e.comp.addOrRemoveCssClass("ag-header-cell-filtered",e.column.isFilterActive())};this.addManagedListener(this.column,fm.EVENT_FILTER_ACTIVE_CHANGED,t),t()}},{key:"setupColId",value:function(){this.comp.setColId(this.column.getColId())}},{key:"addActiveHeaderMouseListeners",value:function(){var e=this,t=function(t){return e.setActiveHeader("mouseenter"===t.type)};this.addManagedListener(this.getGui(),"mouseenter",t),this.addManagedListener(this.getGui(),"mouseleave",t)}},{key:"setActiveHeader",value:function(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}}]),n}(dx);Ax([nm("columnModel")],_x.prototype,"columnModel",void 0),Ax([nm("columnHoverService")],_x.prototype,"columnHoverService",void 0),Ax([nm("sortController")],_x.prototype,"sortController",void 0),Ax([nm("menuFactory")],_x.prototype,"menuFactory",void 0),Ax([nm("dragAndDropService")],_x.prototype,"dragAndDropService",void 0),Ax([nm("resizeObserverService")],_x.prototype,"resizeObserverService",void 0),Ax([nm("gridApi")],_x.prototype,"gridApi",void 0),Ax([nm("columnApi")],_x.prototype,"columnApi",void 0),Ax([em],_x.prototype,"removeDragSource",null);var Ox=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Dx=function(e){O(n,e);var t=F(n);function n(e,r,i,o){var a;return T(this,n),(a=t.call(this)).eResize=r,a.comp=e,a.pinned=i,a.columnGroup=o,a}return A(n,[{key:"postConstruct",value:function(){var e=this;if(this.columnGroup.isResizable()){var t=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(t),!this.gridOptionsService.is("suppressAutoSize")){var n=this.gridOptionsService.is("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",(function(){var t=[];e.columnGroup.getDisplayedLeafColumns().forEach((function(e){e.getColDef().suppressAutoSize||t.push(e.getColId())})),t.length>0&&e.columnModel.autoSizeColumns({columns:t,skipHeader:n,stopAtGroup:e.columnGroup,source:"uiColumnResized"}),e.resizeLeafColumnsToFit("uiColumnResized")}))}}else this.comp.setResizableDisplayed(!1)}},{key:"onResizeStart",value:function(e){var t=this;this.calculateInitialValues();var n=null;if(e&&(n=this.columnModel.getDisplayedGroupAfter(this.columnGroup)),n){var r=n.getDisplayedLeafColumns();this.resizeTakeFromCols=r.filter((function(e){return e.isResizable()})),this.resizeTakeFromStartWidth=0,this.resizeTakeFromCols.forEach((function(e){return t.resizeTakeFromStartWidth+=e.getActualWidth()})),this.resizeTakeFromRatios=[],this.resizeTakeFromCols.forEach((function(e){return t.resizeTakeFromRatios.push(e.getActualWidth()/t.resizeTakeFromStartWidth)}))}else this.resizeTakeFromCols=null,this.resizeTakeFromStartWidth=null,this.resizeTakeFromRatios=null;this.comp.addOrRemoveCssClass("ag-column-resizing",!0)}},{key:"onResizing",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"uiColumnResized",r=this.normaliseDragChange(t),i=this.resizeStartWidth+r;this.resizeColumns(i,n,e)}},{key:"resizeLeafColumnsToFit",value:function(e){var t=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup);this.calculateInitialValues(),t>this.resizeStartWidth&&this.resizeColumns(t,e,!0)}},{key:"resizeColumns",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(r.push({columns:this.resizeCols,ratios:this.resizeRatios,width:e}),this.resizeTakeFromCols){var i=e-this.resizeStartWidth;r.push({columns:this.resizeTakeFromCols,ratios:this.resizeTakeFromRatios,width:this.resizeTakeFromStartWidth-i})}this.columnModel.resizeColumnSets({resizeSets:r,finished:n,source:t}),n&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)}},{key:"calculateInitialValues",value:function(){var e=this,t=this.columnGroup.getDisplayedLeafColumns();this.resizeCols=t.filter((function(e){return e.isResizable()})),this.resizeStartWidth=0,this.resizeCols.forEach((function(t){return e.resizeStartWidth+=t.getActualWidth()})),this.resizeRatios=[],this.resizeCols.forEach((function(t){return e.resizeRatios.push(t.getActualWidth()/e.resizeStartWidth)}))}},{key:"normaliseDragChange",value:function(e){var t=e;return this.gridOptionsService.is("enableRtl")?"left"!==this.pinned&&(t*=-1):"right"===this.pinned&&(t*=-1),t}}]),n}(Vm);Ox([nm("horizontalResizeService")],Dx.prototype,"horizontalResizeService",void 0),Ox([nm("autoWidthCalculator")],Dx.prototype,"autoWidthCalculator",void 0),Ox([nm("columnModel")],Dx.prototype,"columnModel",void 0),Ox([$g],Dx.prototype,"postConstruct",null);var Nx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Px=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this)).removeChildListenersFuncs=[],i.columnGroup=r,i.comp=e,i}return A(n,[{key:"postConstruct",value:function(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,Xm.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}},{key:"addListenersToChildrenColumns",value:function(){var e=this;this.removeListenersOnChildrenColumns();var t=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach((function(n){n.addEventListener("widthChanged",t),n.addEventListener("visibleChanged",t),e.removeChildListenersFuncs.push((function(){n.removeEventListener("widthChanged",t),n.removeEventListener("visibleChanged",t)}))}))}},{key:"removeListenersOnChildrenColumns",value:function(){this.removeChildListenersFuncs.forEach((function(e){return e()})),this.removeChildListenersFuncs=[]}},{key:"onDisplayedChildrenChanged",value:function(){this.addListenersToChildrenColumns(),this.onWidthChanged()}},{key:"onWidthChanged",value:function(){var e=this.columnGroup.getActualWidth();this.comp.setWidth("".concat(e,"px")),this.comp.addOrRemoveCssClass("ag-hidden",0===e)}}]),n}(Vm);Nx([$g],Px.prototype,"postConstruct",null);var Fx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ix=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this,e,r)).columnGroup=e,i}return A(n,[{key:"setComp",value:function(e,t,r){cg(D(n.prototype),"setGui",this).call(this,t),this.comp=e,this.displayName=this.columnModel.getDisplayNameForColumnGroup(this.columnGroup,"header"),this.addClasses(),this.addAttributes(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.setupUserComp();var i=this.getParentRowCtrl().getPinned(),o=this.columnGroup.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new vx(o,t)),this.createManagedBean(new fx(this.columnGroup,t,this.beans)),this.createManagedBean(new Px(e,this.columnGroup)),this.groupResizeFeature=this.createManagedBean(new Dx(e,r,i,this.columnGroup)),this.createManagedBean(new aC(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:function(){},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}},{key:"resizeLeafColumnsToFit",value:function(e){this.groupResizeFeature&&this.groupResizeFeature.resizeLeafColumnsToFit(e)}},{key:"setupUserComp",value:function(){var e=this,t=this.displayName,n={displayName:this.displayName,columnGroup:this.columnGroup,setExpanded:function(t){e.columnModel.setColumnGroupOpened(e.columnGroup.getProvidedColumnGroup(),t,"gridInitializing")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context};if(!t){for(var r=this.columnGroup,i=r.getLeafColumns();r.getParent()&&r.getParent().getLeafColumns().length===i.length;)r=r.getParent();var o=r.getColGroupDef();o&&(t=o.headerName),t||(t=i?this.columnModel.getDisplayNameForColumn(i[0],"header",!0):"")}var a=this.userComponentFactory.getHeaderGroupCompDetails(n);this.comp.setUserCompDetails(a)}},{key:"setupTooltip",value:function(){var e=this,t=this.columnGroup.getColGroupDef(),n={getColumn:function(){return e.columnGroup},getGui:function(){return e.eGui},getLocation:function(){return"headerGroup"},getTooltipValue:function(){return t&&t.headerTooltip}};t&&(n.getColDef=function(){return t}),this.createManagedBean(new $E(n,this.beans)).setComp(this.comp)}},{key:"setupExpandable",value:function(){var e=this.columnGroup.getProvidedColumnGroup();this.refreshExpanded(),this.addManagedListener(e,vm.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(e,vm.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))}},{key:"refreshExpanded",value:function(){var e=this.columnGroup;this.expandable=e.isExpandable();var t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0)}},{key:"addAttributes",value:function(){this.comp.setColId(this.columnGroup.getUniqueId())}},{key:"addClasses",value:function(){var e=this,t=this.columnGroup.getColGroupDef(),n=tx.getHeaderClassesFromColDef(t,this.gridOptionsService,null,this.columnGroup);this.columnGroup.isPadding()?(n.push("ag-header-group-cell-no-group"),this.columnGroup.getLeafColumns().every((function(e){return e.isSpanHeaderHeight()}))&&n.push("ag-header-span-height")):n.push("ag-header-group-cell-with-group");n.forEach((function(t){return e.comp.addOrRemoveCssClass(t,!0)}))}},{key:"setupMovingCss",value:function(){var e=this,t=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),n=function(){return e.comp.addOrRemoveCssClass("ag-header-cell-moving",e.columnGroup.isMoving())};t.forEach((function(t){e.addManagedListener(t,fm.EVENT_MOVING_CHANGED,n)})),n()}},{key:"onFocusIn",value:function(e){if(!this.eGui.contains(e.relatedTarget)){var t=this.getRowIndex();this.beans.focusService.setFocusedHeader(t,this.columnGroup)}}},{key:"handleKeyDown",value:function(e){cg(D(n.prototype),"handleKeyDown",this).call(this,e);var t=this.getWrapperHasFocus();if(this.expandable&&t&&e.key===_b.ENTER){var r=this.columnGroup,i=!r.isExpanded();this.columnModel.setColumnGroupOpened(r.getProvidedColumnGroup(),i,"uiColumnExpanded")}}},{key:"setDragSource",value:function(e){var t=this;if(!this.isSuppressMoving()){var n=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),r=!this.gridOptionsService.is("suppressDragLeaveHidesColumns"),i={type:CS.HeaderCell,eElement:e,defaultIconName:r?xS.ICON_HIDE:xS.ICON_NOT_ALLOWED,dragItemName:this.displayName,getDragItem:this.getDragItemForGroup.bind(this),onDragStarted:function(){return n.forEach((function(e){return e.setMoving(!0,"uiColumnDragged")}))},onDragStopped:function(){return n.forEach((function(e){return e.setMoving(!1,"uiColumnDragged")}))},onGridEnter:function(e){var n;if(r){var i=(null===(n=null===e||void 0===e?void 0:e.columns)||void 0===n?void 0:n.filter((function(e){return!e.getColDef().lockVisible})))||[];t.columnModel.setColumnsVisible(i,!0,"uiColumnMoved")}},onGridExit:function(e){var n;if(r){var i=(null===(n=null===e||void 0===e?void 0:e.columns)||void 0===n?void 0:n.filter((function(e){return!e.getColDef().lockVisible})))||[];t.columnModel.setColumnsVisible(i,!1,"uiColumnMoved")}}};this.dragAndDropService.addDragSource(i,!0),this.addDestroyFunc((function(){return t.dragAndDropService.removeDragSource(i)}))}}},{key:"getDragItemForGroup",value:function(){var e=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),t={};e.forEach((function(e){return t[e.getId()]=e.isVisible()}));var n=[];return this.columnModel.getAllDisplayedColumns().forEach((function(t){e.indexOf(t)>=0&&(n.push(t),Cm(e,t))})),e.forEach((function(e){return n.push(e)})),{columns:n,visibleState:t}}},{key:"isSuppressMoving",value:function(){var e=!1;return this.columnGroup.getLeafColumns().forEach((function(t){(t.getColDef().suppressMovable||t.getColDef().lockPosition)&&(e=!0)})),e||this.gridOptionsService.is("suppressMovableColumns")}}]),n}(dx);Fx([nm("columnModel")],Ix.prototype,"columnModel",void 0),Fx([nm("dragAndDropService")],Ix.prototype,"dragAndDropService",void 0),Fx([nm("gridApi")],Ix.prototype,"gridApi",void 0),Fx([nm("columnApi")],Ix.prototype,"columnApi",void 0);var Lx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Mx=0,Gx=function(e){O(n,e);var t=F(n);function n(e,r,i){var o;return T(this,n),(o=t.call(this)).instanceId=Mx++,o.headerCellCtrls={},o.rowIndex=e,o.pinned=r,o.type=i,o}return A(n,[{key:"getInstanceId",value:function(){return this.instanceId}},{key:"setComp",value:function(e){this.comp=e,this.onRowHeightChanged(),this.onVirtualColumnsChanged(),this.setWidth(),this.addEventListeners(),gw()&&this.comp.setTransform("translateZ(0)"),e.setAriaRowIndex(this.rowIndex+1)}},{key:"addEventListeners",value:function(){this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_GRID_STYLES_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("headerHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("groupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotGroupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("floatingFiltersHeight",this.onRowHeightChanged.bind(this))}},{key:"getHeaderCellCtrl",value:function(e){return wg(this.headerCellCtrls).find((function(t){return t.getColumnGroupChild()===e}))}},{key:"onDisplayedColumnsChanged",value:function(){this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}},{key:"getType",value:function(){return this.type}},{key:"onColumnResized",value:function(){this.setWidth()}},{key:"setWidth",value:function(){var e=this.getWidthForRow();this.comp.setWidth("".concat(e,"px"))}},{key:"getWidthForRow",value:function(){return this.gridOptionsService.isDomLayout("print")?null!=this.pinned?0:this.columnModel.getContainerWidth("right")+this.columnModel.getContainerWidth("left")+this.columnModel.getContainerWidth(null):this.columnModel.getContainerWidth(this.pinned)}},{key:"onRowHeightChanged",value:function(){var e=this.columnModel.getHeaderRowCount(),t=[],n=0;this.columnModel.hasFloatingFilters()&&(e++,n=1);for(var r=this.columnModel.getColumnGroupHeaderRowHeight(),i=this.columnModel.getColumnHeaderRowHeight(),o=e-(1+n),a=0;a<o;a++)t.push(r);t.push(i);for(var s=0;s<n;s++)t.push(this.columnModel.getFloatingFiltersHeight());for(var l=0,u=0;u<this.rowIndex;u++)l+=t[u];var c=t[this.rowIndex]+"px";this.comp.setTop(l+"px"),this.comp.setHeight(c)}},{key:"getPinned",value:function(){return this.pinned}},{key:"getRowIndex",value:function(){return this.rowIndex}},{key:"onVirtualColumnsChanged",value:function(){var e=this,t=this.headerCellCtrls;this.headerCellCtrls={},this.getColumnsInViewport().forEach((function(n){if(!n.isEmptyGroup()){var r=n.getUniqueId(),i=t[r];if(delete t[r],i&&i.getColumnGroupChild()!=n&&(e.destroyBean(i),i=void 0),null==i)switch(e.type){case ax.FLOATING_FILTER:i=e.createBean(new mx(n,e));break;case ax.COLUMN_GROUP:i=e.createBean(new Ix(n,e));break;default:i=e.createBean(new _x(n,e))}e.headerCellCtrls[r]=i}}));Sg(t,(function(t,n){var r;(r=n,!!e.focusService.isHeaderWrapperFocused(r)&&e.columnModel.isDisplayed(r.getColumnGroupChild()))?e.headerCellCtrls[t]=n:e.destroyBean(n)}));var n=_g(this.headerCellCtrls);this.comp.setHeaderCtrls(n)}},{key:"getColumnsInViewport",value:function(){return this.gridOptionsService.isDomLayout("print")?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}},{key:"getColumnsInViewportPrintLayout",value:function(){var e=this;if(null!=this.pinned)return[];var t=[],n=this.getActualDepth();return["left",null,"right"].forEach((function(r){var i=e.columnModel.getVirtualHeaderGroupRow(r,n);t=t.concat(i)})),t}},{key:"getActualDepth",value:function(){return this.type==ax.FLOATING_FILTER?this.rowIndex-1:this.rowIndex}},{key:"getColumnsInViewportNormalLayout",value:function(){return this.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())}},{key:"focusHeader",value:function(e,t){var n=_g(this.headerCellCtrls).find((function(t){return t.getColumnGroupChild()==e}));return!!n&&(n.focus(t),!0)}},{key:"destroy",value:function(){var e=this;Sg(this.headerCellCtrls,(function(t,n){e.destroyBean(n)})),this.headerCellCtrls={},cg(D(n.prototype),"destroy",this).call(this)}}]),n}(Vm);Lx([nm("columnModel")],Gx.prototype,"columnModel",void 0),Lx([nm("focusService")],Gx.prototype,"focusService",void 0);var Bx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},jx=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).hidden=!1,r.includeFloatingFilter=!1,r.groupsRowCtrls=[],r.pinned=e,r}return A(n,[{key:"setComp",value:function(e,t){this.comp=e,this.eViewport=t,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport),this.addManagedListener(this.eventService,Ym.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()}},{key:"setupDragAndDrop",value:function(e){var t=new ex(this.pinned,e);this.createManagedBean(t)}},{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=new Wb,r=this.focusService.getFocusHeaderToUseAfterRefresh();!function(){var t=e.columnModel.getHeaderRowCount()-1;e.groupsRowCtrls=e.destroyBeans(e.groupsRowCtrls);for(var r=0;r<t;r++){var i=e.createBean(new Gx(n.next(),e.pinned,ax.COLUMN_GROUP));e.groupsRowCtrls.push(i)}}(),function(){var r=n.next(),i=!e.hidden&&(null==e.columnsRowCtrl||!t||e.columnsRowCtrl.getRowIndex()!==r);(i||e.hidden)&&(e.columnsRowCtrl=e.destroyBean(e.columnsRowCtrl)),i&&(e.columnsRowCtrl=e.createBean(new Gx(r,e.pinned,ax.COLUMN)))}(),function(){e.includeFloatingFilter=e.columnModel.hasFloatingFilters()&&!e.hidden;var r=function(){e.filtersRowCtrl=e.destroyBean(e.filtersRowCtrl)};if(e.includeFloatingFilter){var i=n.next();if(e.filtersRowCtrl){var o=e.filtersRowCtrl.getRowIndex()!==i;t&&!o||r()}e.filtersRowCtrl||(e.filtersRowCtrl=e.createBean(new Gx(i,e.pinned,ax.FLOATING_FILTER)))}else r()}();var i=this.getAllCtrls();this.comp.setCtrls(i),this.restoreFocusOnHeader(r)}},{key:"restoreFocusOnHeader",value:function(e){null!=e&&e.column.getPinned()==this.pinned&&this.focusService.focusHeaderPosition({headerPosition:e})}},{key:"getAllCtrls",value:function(){var e=wt(this.groupsRowCtrls);return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}},{key:"onGridColumnsChanged",value:function(){this.refresh(!0)}},{key:"onDisplayedColumnsChanged",value:function(){var e=this.columnModel.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==e&&this.refresh(!0)}},{key:"setupCenterWidth",value:function(){var e=this;null==this.pinned&&this.createManagedBean(new kk((function(t){return e.comp.setCenterWidth("".concat(t,"px"))}),!0))}},{key:"setHorizontalScroll",value:function(e){this.comp.setViewportScrollLeft(e)}},{key:"setupPinnedWidth",value:function(){var e=this;if(null!=this.pinned){var t="left"===this.pinned,n="right"===this.pinned;this.hidden=!0;var r=function(){var r=t?e.pinnedWidthService.getPinnedLeftWidth():e.pinnedWidthService.getPinnedRightWidth();if(null!=r){var i=0==r,o=e.hidden!==i,a=e.gridOptionsService.is("enableRtl"),s=e.gridOptionsService.getScrollbarWidth(),l=e.scrollVisibleService.isVerticalScrollShowing()&&(a&&t||!a&&n)?r+s:r;e.comp.setPinnedContainerWidth("".concat(l,"px")),e.comp.setDisplayed(!i),o&&(e.hidden=i,e.refresh())}};this.addManagedListener(this.eventService,Ym.EVENT_LEFT_PINNED_WIDTH_CHANGED,r),this.addManagedListener(this.eventService,Ym.EVENT_RIGHT_PINNED_WIDTH_CHANGED,r),this.addManagedListener(this.eventService,Ym.EVENT_SCROLL_VISIBILITY_CHANGED,r),this.addManagedListener(this.eventService,Ym.EVENT_SCROLLBAR_WIDTH_CHANGED,r)}}},{key:"getHeaderCtrlForColumn",value:function(e){if(e instanceof fm){if(!this.columnsRowCtrl)return;return this.columnsRowCtrl.getHeaderCellCtrl(e)}if(0!==this.groupsRowCtrls.length)for(var t=0;t<this.groupsRowCtrls.length;t++){var n=this.groupsRowCtrls[t].getHeaderCellCtrl(e);if(n)return n}}},{key:"getHtmlElementForColumnHeader",value:function(e){var t=this.getHeaderCtrlForColumn(e);return t?t.getGui():null}},{key:"getRowType",value:function(e){var t=this.getAllCtrls()[e];return t?t.getType():void 0}},{key:"focusHeader",value:function(e,t,n){var r=this.getAllCtrls()[e];return!!r&&r.focusHeader(t,n)}},{key:"getRowCount",value:function(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}},{key:"destroy",value:function(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),cg(D(n.prototype),"destroy",this).call(this)}}]),n}(Vm);Bx([nm("ctrlsService")],jx.prototype,"ctrlsService",void 0),Bx([nm("scrollVisibleService")],jx.prototype,"scrollVisibleService",void 0),Bx([nm("pinnedWidthService")],jx.prototype,"pinnedWidthService",void 0),Bx([nm("columnModel")],jx.prototype,"columnModel",void 0),Bx([nm("focusService")],jx.prototype,"focusService",void 0);var Hx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Vx=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).headerRowComps={},r.rowCompsList=[],r.pinned=e,r}return A(n,[{key:"init",value:function(){var e=this;this.selectAndSetTemplate();var t={setDisplayed:function(t){return e.setDisplayed(t)},setCtrls:function(t){return e.setCtrls(t)},setCenterWidth:function(t){return e.eCenterContainer.style.width=t},setViewportScrollLeft:function(t){return e.getGui().scrollLeft=t},setPinnedContainerWidth:function(t){var n=e.getGui();n.style.width=t,n.style.maxWidth=t,n.style.minWidth=t}};this.createManagedBean(new jx(this.pinned)).setComp(t,this.getGui())}},{key:"selectAndSetTemplate",value:function(){var e="left"==this.pinned,t="right"==this.pinned,r=e?n.PINNED_LEFT_TEMPLATE:t?n.PINNED_RIGHT_TEMPLATE:n.CENTER_TEMPLATE;this.setTemplate(r),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()}},{key:"destroyRowComps",value:function(){this.setCtrls([])}},{key:"destroyRowComp",value:function(e){this.destroyBean(e),this.eRowContainer.removeChild(e.getGui())}},{key:"setCtrls",value:function(e){var t,n=this,r=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];e.forEach((function(e){var i=e.getInstanceId(),o=r[i];delete r[i];var a=o||n.createBean(new lx(e));n.headerRowComps[i]=a,n.rowCompsList.push(a),function(e){var r=e.getGui();r.parentElement!=n.eRowContainer&&n.eRowContainer.appendChild(r),t&&ub(n.eRowContainer,r,t),t=r}(a)})),_g(r).forEach((function(e){return n.destroyRowComp(e)}))}}]),n}(Zb);Vx.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="presentation"></div>',Vx.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="presentation"></div>',Vx.CENTER_TEMPLATE='<div class="ag-header-viewport" role="presentation">\n            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>\n        </div>',Hx([Jb("eCenterContainer")],Vx.prototype,"eCenterContainer",void 0),Hx([$g],Vx.prototype,"init",null),Hx([em],Vx.prototype,"destroyRowComps",null);var Wx,zx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(Wx||(Wx={}));var Ux=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"postConstruct",value:function(){var e=this;this.ctrlsService.whenReady((function(t){e.gridBodyCon=t.gridBodyCtrl}))}},{key:"getHeaderRowCount",value:function(){var e=this.ctrlsService.getHeaderRowContainerCtrl();return e?e.getRowCount():0}},{key:"navigateVertically",value:function(e,t,n){if(t||(t=this.focusService.getFocusedHeader()),!t)return!1;var r=t,i=r.headerRowIndex,o=r.column,a=this.getHeaderRowCount(),s=e===Wx.UP?this.headerPositionUtils.getColumnVisibleParent(o,i):this.headerPositionUtils.getColumnVisibleChild(o,i),l=s.nextRow,u=s.nextFocusColumn,c=!1;return l<0&&(l=0,u=o,c=!0),l>=a&&(l=-1),!(!c&&!u)&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:l,column:u},allowUserOverride:!0,event:n})}},{key:"navigateHorizontally",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,o=this.focusService.getFocusedHeader();return e===Wx.LEFT!==this.gridOptionsService.is("enableRtl")?(n="Before",t=this.headerPositionUtils.findHeader(o,n)):(n="After",t=this.headerPositionUtils.findHeader(o,n)),t||!r?this.focusService.focusHeaderPosition({headerPosition:t,direction:n,fromTab:r,allowUserOverride:!0,event:i}):this.focusNextHeaderRow(o,n,i)}},{key:"focusNextHeaderRow",value:function(e,t,n){var r,i=e.headerRowIndex,o=null;return"Before"===t?i>0&&(r=i-1,o=this.headerPositionUtils.findColAtEdgeForHeaderRow(r,"end")):(r=i+1,o=this.headerPositionUtils.findColAtEdgeForHeaderRow(r,"start")),this.focusService.focusHeaderPosition({headerPosition:o,direction:t,fromTab:!0,allowUserOverride:!0,event:n})}},{key:"scrollToColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"After";if(!e.getPinned()){var n;if(e instanceof Xm){var r=e.getDisplayedLeafColumns();n="Before"===t?ym(r):r[0]}else n=e;this.gridBodyCon.getScrollFeature().ensureColumnVisible(n)}}}]),n}(Vm);zx([nm("focusService")],Ux.prototype,"focusService",void 0),zx([nm("headerPositionUtils")],Ux.prototype,"headerPositionUtils",void 0),zx([nm("ctrlsService")],Ux.prototype,"ctrlsService",void 0),zx([$g],Ux.prototype,"postConstruct",null),Ux=zx([tm("headerNavigationService")],Ux);var Kx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},qx=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"setComp",value:function(e,t,n){this.comp=e,this.eGui=t,this.createManagedBean(new aC(n,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight(),this.ctrlsService.registerGridHeaderCtrl(this)}},{key:"setupHeaderHeight",value:function(){var e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListener("headerHeight",e),this.addManagedPropertyListener("pivotHeaderHeight",e),this.addManagedPropertyListener("groupHeaderHeight",e),this.addManagedPropertyListener("pivotGroupHeaderHeight",e),this.addManagedPropertyListener("floatingFiltersHeight",e),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,e),this.addManagedListener(this.eventService,Ym.EVENT_GRID_STYLES_CHANGED,e)}},{key:"getHeaderHeight",value:function(){return this.headerHeight}},{key:"setHeaderHeight",value:function(){var e,t=this.columnModel,n=0,r=t.getHeaderRowCount();t.hasFloatingFilters()&&(r++,n=1);var i=this.columnModel.getColumnGroupHeaderRowHeight(),o=this.columnModel.getColumnHeaderRowHeight(),a=r-(1+n);if(e=n*t.getFloatingFiltersHeight(),e+=a*i,e+=o,this.headerHeight!==e){this.headerHeight=e;var s="".concat(e+1,"px");this.comp.setHeightAndMinHeight(s),this.eventService.dispatchEvent({type:Ym.EVENT_HEADER_HEIGHT_CHANGED})}}},{key:"onPivotModeChanged",value:function(){var e=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",e),this.comp.addOrRemoveCssClass("ag-pivot-off",!e)}},{key:"onDisplayedColumnsChanged",value:function(){var e=this.columnModel.getAllDisplayedColumns().some((function(e){return e.isSpanHeaderHeight()}));this.comp.addOrRemoveCssClass("ag-header-allow-overflow",e)}},{key:"onTabKeyDown",value:function(e){var t=this.gridOptionsService.is("enableRtl"),n=e.shiftKey!==t?Wx.LEFT:Wx.RIGHT;(this.headerNavigationService.navigateHorizontally(n,!0,e)||this.focusService.focusNextGridCoreContainer(e.shiftKey))&&e.preventDefault()}},{key:"handleKeyDown",value:function(e){var t=null;switch(e.key){case _b.LEFT:t=Wx.LEFT;case _b.RIGHT:fg(t)||(t=Wx.RIGHT),this.headerNavigationService.navigateHorizontally(t,!1,e);break;case _b.UP:t=Wx.UP;case _b.DOWN:fg(t)||(t=Wx.DOWN),this.headerNavigationService.navigateVertically(t,null,e)&&e.preventDefault();break;default:return}}},{key:"onFocusOut",value:function(e){var t=this.gridOptionsService.getDocument(),n=e.relatedTarget;!n&&this.eGui.contains(t.activeElement)||this.eGui.contains(n)||this.focusService.clearFocusedHeader()}}]),n}(Vm);Kx([nm("headerNavigationService")],qx.prototype,"headerNavigationService",void 0),Kx([nm("focusService")],qx.prototype,"focusService",void 0),Kx([nm("columnModel")],qx.prototype,"columnModel",void 0),Kx([nm("ctrlsService")],qx.prototype,"ctrlsService",void 0);var Xx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Yx=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,n.TEMPLATE)}return A(n,[{key:"postConstruct",value:function(){var e=this,t={addOrRemoveCssClass:function(t,n){return e.addOrRemoveCssClass(t,n)},setHeightAndMinHeight:function(t){e.getGui().style.height=t,e.getGui().style.minHeight=t}};this.createManagedBean(new qx).setComp(t,this.getGui(),this.getFocusableElement());var n=function(t){e.createManagedBean(t),e.appendChild(t)};n(new Vx("left")),n(new Vx(null)),n(new Vx("right"))}}]),n}(Zb);Yx.TEMPLATE='<div class="ag-header" role="presentation"/>',Xx([$g],Yx.prototype,"postConstruct",null);var Qx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Zx=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"addResizeBar",value:function(e){var t=this,n={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0};this.dragService.addDragSource(n);return function(){return t.dragService.removeDragSource(n)}}},{key:"onDragStart",value:function(e,t){this.dragStartX=t.clientX,this.setResizeIcons();var n=t instanceof MouseEvent&&!0===t.shiftKey;e.onResizeStart(n)}},{key:"setResizeIcons",value:function(){var e=this.ctrlsService.getGridCtrl();e.setResizeCursor(!0),e.disableUserSelect(!0)}},{key:"onDragStop",value:function(e,t){e.onResizeEnd(this.resizeAmount),this.resetIcons()}},{key:"resetIcons",value:function(){var e=this.ctrlsService.getGridCtrl();e.setResizeCursor(!1),e.disableUserSelect(!1)}},{key:"onDragging",value:function(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}}]),n}(Vm);Qx([nm("dragService")],Zx.prototype,"dragService",void 0),Qx([nm("ctrlsService")],Zx.prototype,"ctrlsService",void 0),Zx=Qx([tm("horizontalResizeService")],Zx);var Jx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},$x=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"hideActiveMenu",value:function(){this.hidePopup&&this.hidePopup()}},{key:"showMenuAfterMouseEvent",value:function(e,t){var n=this;this.showPopup(e,(function(r){n.popupService.positionPopupUnderMouseEvent({column:e,type:"columnMenu",mouseEvent:t,ePopup:r})}),"columnMenu",t.target)}},{key:"showMenuAfterButtonClick",value:function(e,t,n){var r=this;this.showPopup(e,(function(i){r.popupService.positionPopupByComponent({type:n,eventSource:t,ePopup:i,keepWithinBounds:!0,position:"under",column:e})}),n,t)}},{key:"showPopup",value:function(e,t,n,r){var i=this,o=this.filterManager.getOrCreateFilterWrapper(e,"COLUMN_MENU");if(!o)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");var a,s=document.createElement("div");Fy(s,"presentation"),s.classList.add("ag-menu"),this.tabListener=this.addManagedListener(s,"keydown",(function(e){return i.trapFocusWithin(e,s)})),o.guiPromise.then((function(e){return s.appendChild(e)}));var l=r||this.ctrlsService.getGridBodyCtrl().getGui(),u=this.localeService.getLocaleTextFunc(),c=this.popupService.addPopup({modal:!0,eChild:s,closeOnEsc:!0,closedCallback:function(t){e.setMenuVisible(!1,"contextMenu");var n=t instanceof KeyboardEvent;if(i.tabListener&&(i.tabListener=i.tabListener()),n&&r&&ob(r)){var a=i.focusService.findTabbableParent(r);a&&a.focus()}!function(){var e;null===(e=o.filterPromise)||void 0===e||e.then((function(e){var t;return null===(t=null===e||void 0===e?void 0:e.afterGuiDetached)||void 0===t?void 0:t.call(e)}))}()},positionCallback:function(){return t(s)},anchorToElement:l,ariaLabel:u("ariaLabelColumnMenu","Column Menu")});c&&(this.hidePopup=a=c.hideFunc),o.filterPromise.then((function(e){t(s),e.afterGuiAttached&&e.afterGuiAttached({container:n,hidePopup:a})})),e.setMenuVisible(!0,"contextMenu")}},{key:"trapFocusWithin",value:function(e,t){e.key!==_b.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(t,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(t,e.shiftKey))}},{key:"isMenuEnabled",value:function(e){return e.isFilterAllowed()&&e.getMenuTabs(["filterMenuTab"]).includes("filterMenuTab")}}]),n}(Vm);Jx([nm("filterManager")],$x.prototype,"filterManager",void 0),Jx([nm("popupService")],$x.prototype,"popupService",void 0),Jx([nm("focusService")],$x.prototype,"focusService",void 0),Jx([nm("ctrlsService")],$x.prototype,"ctrlsService",void 0),$x=Jx([tm("menuFactory")],$x);var eT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},tT=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this,n.getTemplate(e.cssClass))).items=[],r.tabbedItemScrollMap=new Map,r.params=e,e.items&&e.items.forEach((function(e){return r.addItem(e)})),r}return A(n,[{key:"postConstruct",value:function(){var e=this;this.createManagedBean(new aC(this.getFocusableElement(),{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this)})),this.addDestroyFunc((function(){var t,n,r;return null===(r=null===(n=null===(t=e.activeItem)||void 0===t?void 0:t.tabbedItem)||void 0===n?void 0:n.afterDetachedCallback)||void 0===r?void 0:r.call(n)}))}},{key:"handleKeyDown",value:function(e){var t=this.gridOptionsService.getDocument();switch(e.key){case _b.RIGHT:case _b.LEFT:if(!this.eHeader.contains(t.activeElement))return;var n=e.key===_b.RIGHT,r=this.gridOptionsService.is("enableRtl"),i=this.items.indexOf(this.activeItem),o=n!==r?Math.min(i+1,this.items.length-1):Math.max(i-1,0);if(i===o)return;e.preventDefault();var a=this.items[o];this.showItemWrapper(a),a.eHeaderButton.focus();break;case _b.UP:case _b.DOWN:e.stopPropagation()}}},{key:"onTabKeyDown",value:function(e){if(!e.defaultPrevented){var t=this.focusService,n=this.eHeader,r=this.eBody,i=this.activeItem,o=this.gridOptionsService.getDocument().activeElement,a=e.target;if(e.preventDefault(),n.contains(o))t.focusInto(r,e.shiftKey);else{var s=null;t.isTargetUnderManagedComponent(r,a)&&(e.shiftKey&&(s=this.focusService.findFocusableElementBeforeTabGuard(r,a)),s||(s=i.eHeaderButton)),!s&&r.contains(o)&&((s=t.findNextFocusableElement(r,!1,e.shiftKey))||(s=i.eHeaderButton)),s&&s.focus()}}}},{key:"setAfterAttachedParams",value:function(e){this.afterAttachedParams=e}},{key:"showFirstItem",value:function(){this.items.length>0&&this.showItemWrapper(this.items[0])}},{key:"addItem",value:function(e){var t=document.createElement("span");Fy(t,"tab"),t.setAttribute("tabindex","-1"),t.appendChild(e.title),t.classList.add("ag-tab"),this.eHeader.appendChild(t),Gy(t,e.titleLabel);var n={tabbedItem:e,eHeaderButton:t};this.items.push(n),t.addEventListener("click",this.showItemWrapper.bind(this,n))}},{key:"showItem",value:function(e){var t=this.items.find((function(t){return t.tabbedItem===e}));t&&this.showItemWrapper(t)}},{key:"showItemWrapper",value:function(e){var t,n,r=this,i=e.tabbedItem,o=e.eHeaderButton;this.params.onItemClicked&&this.params.onItemClicked({item:i}),this.activeItem!==e?(this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),rb(this.eBody),i.bodyPromise.then((function(e){r.eBody.appendChild(e);var t=!r.focusService.isKeyboardMode();if(r.focusService.focusInto(r.eBody,!1,t),i.afterAttachedCallback&&i.afterAttachedCallback(r.afterAttachedParams),r.params.keepScrollPosition){var n=i.getScrollableContainer&&i.getScrollableContainer()||e;r.lastScrollListener=r.addManagedListener(n,"scroll",(function(){r.tabbedItemScrollMap.set(i.name,n.scrollTop)}));var o=r.tabbedItemScrollMap.get(i.name);void 0!==o&&setTimeout((function(){n.scrollTop=o}),0)}})),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),null===(n=(t=this.activeItem.tabbedItem).afterDetachedCallback)||void 0===n||n.call(t)),o.classList.add("ag-tab-selected"),this.activeItem=e):qg(this.params.onActiveItemClicked)}}],[{key:"getTemplate",value:function(e){return'<div class="ag-tabs '.concat(e,'">\n            <div ref="eHeader" role="tablist" class="ag-tabs-header ').concat(e?"".concat(e,"-header"):"",'"></div>\n            <div ref="eBody" role="presentation" class="ag-tabs-body ').concat(e?"".concat(e,"-body"):"",'"></div>\n        </div>')}}]),n}(Zb);eT([nm("focusService")],tT.prototype,"focusService",void 0),eT([Jb("eHeader")],tT.prototype,"eHeader",void 0),eT([Jb("eBody")],tT.prototype,"eBody",void 0),eT([$g],tT.prototype,"postConstruct",null);var nT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},rT=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).polyfillFunctions=[],e}return A(n,[{key:"observeResize",value:function(e,t){var n=this,r=this.gridOptionsService.getWindow(),i=this.gridOptionsService.is("suppressBrowserResizeObserver");return!!r.ResizeObserver&&!i?function(){var n=new r.ResizeObserver(t);return n.observe(e),function(){return n.disconnect()}}():function(){var r=lb(e),i=sb(e),o=!0;return function a(){if(o){var s=lb(e),l=sb(e);(s!==r||l!==i)&&(r=s,i=l,t()),n.doNextPolyfillTurn(a)}}(),function(){return o=!1}}()}},{key:"doNextPolyfillTurn",value:function(e){this.polyfillFunctions.push(e),this.schedulePolyfill()}},{key:"schedulePolyfill",value:function(){var e=this;if(!this.polyfillScheduled){this.polyfillScheduled=!0,this.getFrameworkOverrides().setTimeout((function(){var t=e.polyfillFunctions;e.polyfillScheduled=!1,e.polyfillFunctions=[],t.forEach((function(e){return e()}))}),50)}}}]),n}(Vm);rT=nT([tm("resizeObserverService")],rT);var iT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},oT=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).createTasksP1={list:[],sorted:!1},e.createTasksP2={list:[],sorted:!1},e.destroyTasks=[],e.ticking=!1,e.scrollGoingDown=!0,e.lastPage=0,e.lastScrollTop=0,e.taskCount=0,e.cancelledTasks=new Set,e}return A(n,[{key:"setScrollTop",value:function(e){var t=this.gridOptionsService.is("pagination");if(this.scrollGoingDown=e>=this.lastScrollTop,t&&0===e){var n=this.paginationProxy.getCurrentPage();n!==this.lastPage&&(this.lastPage=n,this.scrollGoingDown=!0)}this.lastScrollTop=e}},{key:"init",value:function(){this.useAnimationFrame=!this.gridOptionsService.is("suppressAnimationFrame")}},{key:"isOn",value:function(){return this.useAnimationFrame}},{key:"verifyAnimationFrameOn",value:function(e){!1===this.useAnimationFrame&&console.warn("AG Grid: AnimationFrameService.".concat(e," called but animation frames are off"))}},{key:"createTask",value:function(e,t,n){this.verifyAnimationFrameOn(n);var r={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[n],r),this.schedule()}},{key:"cancelTask",value:function(e){this.cancelledTasks.add(e)}},{key:"addTaskToList",value:function(e,t){e.list.push(t),e.sorted=!1}},{key:"sortTaskList",value:function(e){if(!e.sorted){var t=this.scrollGoingDown?1:-1;e.list.sort((function(e,n){return e.index!==n.index?t*(n.index-e.index):n.createOrder-e.createOrder})),e.sorted=!0}}},{key:"addDestroyTask",value:function(e){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(e),this.schedule()}},{key:"executeFrame",value:function(e){this.verifyAnimationFrameOn("executeFrame");for(var t=this.createTasksP1,n=t.list,r=this.createTasksP2,i=r.list,o=this.destroyTasks,a=(new Date).getTime(),s=(new Date).getTime()-a,l=e<=0,u=this.ctrlsService.getGridBodyCtrl();l||s<e;){if(!u.getScrollFeature().scrollGridIfNeeded()){var c=void 0;if(n.length)this.sortTaskList(t),c=n.pop().task;else if(i.length)this.sortTaskList(r),c=i.pop().task;else{if(!o.length){this.cancelledTasks.clear();break}c=o.pop()}this.cancelledTasks.has(c)||c()}s=(new Date).getTime()-a}n.length||i.length||o.length?this.requestFrame():this.stopTicking()}},{key:"stopTicking",value:function(){this.ticking=!1}},{key:"flushAllFrames",value:function(){this.useAnimationFrame&&this.executeFrame(-1)}},{key:"schedule",value:function(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}},{key:"requestFrame",value:function(){var e=this.executeFrame.bind(this,60);this.requestAnimationFrame(e)}},{key:"requestAnimationFrame",value:function(e){var t=this.gridOptionsService.getWindow();t.requestAnimationFrame?t.requestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.setTimeout(e,0)}},{key:"isQueueEmpty",value:function(){return!this.ticking}},{key:"debounce",value:function(e){var t=this,n=!1;return function(){t.isOn()?n||(n=!0,t.addDestroyTask((function(){n=!1,e()}))):t.getFrameworkOverrides().setTimeout(e,0)}}}]),n}(Vm);iT([nm("ctrlsService")],oT.prototype,"ctrlsService",void 0),iT([nm("paginationProxy")],oT.prototype,"paginationProxy",void 0),iT([$g],oT.prototype,"init",null),oT=iT([tm("animationFrameService")],oT);var aT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},sT=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"postConstruct",value:function(){var e=this;this.ctrlsService.whenReady((function(t){e.centerRowContainerCtrl=t.centerRowContainerCtrl}))}},{key:"getPreferredWidthForColumn",value:function(e,t){var n=this.getHeaderCellForColumn(e);if(!n)return-1;var r=this.rowRenderer.getAllCellsForColumn(e);return t||r.push(n),this.addElementsToContainerAndGetWidth(r)}},{key:"getPreferredWidthForColumnGroup",value:function(e){var t=this.getHeaderCellForColumn(e);return t?this.addElementsToContainerAndGetWidth([t]):-1}},{key:"addElementsToContainerAndGetWidth",value:function(e){var t=this,n=document.createElement("form");n.style.position="fixed";var r=this.centerRowContainerCtrl.getContainerElement();e.forEach((function(e){return t.cloneItemIntoDummy(e,n)})),r.appendChild(n);var i=n.offsetWidth;return r.removeChild(n),i+this.getAutoSizePadding()}},{key:"getAutoSizePadding",value:function(){var e=this.gridOptionsService.getNum("autoSizePadding");return null!=e&&e>=0?e:20}},{key:"getHeaderCellForColumn",value:function(e){var t=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach((function(n){var r=n.getHtmlElementForColumnHeader(e);null!=r&&(t=r)})),t}},{key:"cloneItemIntoDummy",value:function(e,t){var n=e.cloneNode(!0);n.style.width="",n.style.position="static",n.style.left="";var r=document.createElement("div"),i=r.classList;["ag-header-cell","ag-header-group-cell"].some((function(e){return n.classList.contains(e)}))?(i.add("ag-header","ag-header-row"),r.style.position="static"):i.add("ag-row");for(var o=e.parentElement;o;){if(["ag-header-row","ag-row"].some((function(e){return o.classList.contains(e)}))){for(var a=0;a<o.classList.length;a++){var s=o.classList[a];"ag-row-position-absolute"!=s&&i.add(s)}break}o=o.parentElement}r.appendChild(n),t.appendChild(r)}}]),n}(Vm);aT([nm("rowRenderer")],sT.prototype,"rowRenderer",void 0),aT([nm("ctrlsService")],sT.prototype,"ctrlsService",void 0),aT([nm("rowCssClassCalculator")],sT.prototype,"rowCssClassCalculator",void 0),aT([$g],sT.prototype,"postConstruct",null),sT=aT([tm("autoWidthCalculator")],sT);var lT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},uT=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this)).createRowCon=e,i.destroyRowCtrls=r,i.stickyRowCtrls=[],i.containerHeight=0,i}return A(n,[{key:"postConstruct",value:function(){var e=this;this.isClientSide="clientSide"===this.rowModel.getType(),this.ctrlsService.whenReady((function(t){e.gridBodyCtrl=t.gridBodyCtrl}))}},{key:"getStickyRowCtrls",value:function(){return this.stickyRowCtrls}},{key:"checkStickyRows",value:function(){var e=this,t=0;if(this.gridOptionsService.isGroupRowsSticky()){for(var n=[],r=this.rowRenderer.getFirstVisibleVerticalPixel(),i=function(i){var o,a,s,l;if(n.push(i),e.isClientSide){for(var u=i;u.expanded;)if(u.master)u=u.detailNode;else if(u.childrenAfterSort){if(0===u.childrenAfterSort.length)break;u=ym(u.childrenAfterSort)}l=u.rowTop+u.rowHeight}else if(i.master)l=i.detailNode.rowTop+i.detailNode.rowHeight;else{var c=null===(o=i.childStore)||void 0===o?void 0:o.getStoreBounds();l=(null!==(a=null===c||void 0===c?void 0:c.heightPx)&&void 0!==a?a:0)+(null!==(s=null===c||void 0===c?void 0:c.topPx)&&void 0!==s?s:0)}var d=r+t+i.rowHeight;i.stickyRowTop=l<d?t+(l-d):t,t=0,n.forEach((function(e){var n=e.stickyRowTop+e.rowHeight;t<n&&(t=n)}))};;){var o=r+t,a=this.rowModel.getRowIndexAtPixel(o),s=this.rowModel.getRow(a);if(null==s)break;if(s.level<0)break;for(var l=[],u=s.parent;u.level>=0;)l.push(u),u=u.parent;var c=l.reverse().find((function(e){return n.indexOf(e)<0&&e.displayed}));if(c)i(c);else{if(!(s.isExpandable()&&s.expanded&&s.rowTop<o))break;i(s)}}this.refreshNodesAndContainerHeight(n,t)}else this.refreshNodesAndContainerHeight([],t)}},{key:"refreshStickyNode",value:function(e){for(var t=[],n=0;n<this.stickyRowCtrls.length;n++){var r=this.stickyRowCtrls[n].getRowNode();r!==e&&t.push(r)}this.refreshNodesAndContainerHeight(t,this.containerHeight),this.checkStickyRows()}},{key:"refreshNodesAndContainerHeight",value:function(e,t){var n,r=this,i=this.stickyRowCtrls.filter((function(t){return-1===e.indexOf(t.getRowNode())})),o=e.filter((function(e){return-1===r.stickyRowCtrls.findIndex((function(t){return t.getRowNode()===e}))})),a={};i.forEach((function(e){a[e.getRowNode().id]=e,r.stickyRowCtrls=r.stickyRowCtrls.filter((function(t){return t!==e}))}));for(var s=0,l=Object.values(a);s<l.length;s++){l[s].getRowNode().sticky=!1}this.destroyRowCtrls(a,!1);var u=o.map((function(e){return e.sticky=!0,r.createRowCon(e,!1,!1)}));(n=this.stickyRowCtrls).push.apply(n,wt(u)),this.stickyRowCtrls.forEach((function(e){return e.setRowTop(e.getRowNode().stickyRowTop)})),this.stickyRowCtrls.sort((function(e,t){return t.getRowNode().rowIndex-e.getRowNode().rowIndex})),this.containerHeight!==t&&(this.containerHeight=t,this.gridBodyCtrl.setStickyTopHeight(t))}}]),n}(Vm);lT([nm("rowModel")],uT.prototype,"rowModel",void 0),lT([nm("rowRenderer")],uT.prototype,"rowRenderer",void 0),lT([nm("ctrlsService")],uT.prototype,"ctrlsService",void 0),lT([$g],uT.prototype,"postConstruct",null);var cT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},dT=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).destroyFuncsForColumnListeners=[],e.rowCtrlsByRowIndex={},e.zombieRowCtrls={},e.allRowCtrls=[],e.topRowCtrls=[],e.bottomRowCtrls=[],e.refreshInProgress=!1,e.dataFirstRenderedFired=!1,e}return A(n,[{key:"postConstruct",value:function(){var e=this;this.ctrlsService.whenReady((function(){e.gridBodyCtrl=e.ctrlsService.getGridBodyCtrl(),e.initialise()}))}},{key:"initialise",value:function(){if(this.addManagedListener(this.eventService,Ym.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_BODY_SCROLL,this.onBodyScroll.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_BODY_HEIGHT_CHANGED,this.redraw.bind(this)),this.addManagedPropertyListener("domLayout",this.onDomLayoutChanged.bind(this)),this.addManagedPropertyListener("rowClass",this.redrawRows.bind(this)),this.gridOptionsService.isGroupRowsSticky()){var e=this.rowModel.getType();"clientSide"!==e&&"serverSide"!==e||(this.stickyRowFeature=this.createManagedBean(new uT(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this))))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gridOptionsService.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gridOptionsService.is("embedFullWidthRows"),this.redrawAfterModelUpdate()}},{key:"initialiseCache",value:function(){if(this.gridOptionsService.is("keepDetailRows")){var e=this.getKeepDetailRowsCount(),t=null!=e?e:3;this.cachedRowCtrls=new hT(t)}}},{key:"getKeepDetailRowsCount",value:function(){var e=this.gridOptionsService.getNum("keepDetailRowsCount");return fg(e)&&e>0?e:10}},{key:"getRowCtrls",value:function(){return this.allRowCtrls}},{key:"getStickyTopRowCtrls",value:function(){return this.stickyRowFeature?this.stickyRowFeature.getStickyRowCtrls():[]}},{key:"updateAllRowCtrls",value:function(){var e=_g(this.rowCtrlsByRowIndex),t=this.gridOptionsService.is("ensureDomOrder"),n=this.gridOptionsService.isDomLayout("print");(t||n)&&e.sort((function(e,t){return e.getRowNode().rowIndex-t.getRowNode.rowIndex}));var r=_g(this.zombieRowCtrls),i=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];this.allRowCtrls=[].concat(wt(e),wt(r),wt(i))}},{key:"onCellFocusChanged",value:function(e){this.getAllCellCtrls().forEach((function(t){return t.onCellFocused(e)})),this.getFullWidthRowCtrls().forEach((function(t){return t.onFullWidthRowFocused(e)}))}},{key:"registerCellEventListeners",value:function(){var e=this;this.addManagedListener(this.eventService,Ym.EVENT_CELL_FOCUSED,(function(t){e.onCellFocusChanged(t)})),this.addManagedListener(this.eventService,Ym.EVENT_CELL_FOCUS_CLEARED,(function(){e.onCellFocusChanged()})),this.addManagedListener(this.eventService,Ym.EVENT_FLASH_CELLS,(function(t){e.getAllCellCtrls().forEach((function(e){return e.onFlashCells(t)}))})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_HOVER_CHANGED,(function(){e.getAllCellCtrls().forEach((function(e){return e.onColumnHover()}))})),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,(function(){e.getAllCellCtrls().forEach((function(e){return e.onDisplayedColumnsChanged()}))})),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,(function(){e.printLayout&&e.getAllCellCtrls().forEach((function(e){return e.onLeftChanged()}))})),this.gridOptionsService.isEnableRangeSelection()&&(this.addManagedListener(this.eventService,Ym.EVENT_RANGE_SELECTION_CHANGED,(function(){e.getAllCellCtrls().forEach((function(e){return e.onRangeSelectionChanged()}))})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_MOVED,(function(){e.getAllCellCtrls().forEach((function(e){return e.updateRangeBordersIfRangeCount()}))})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_PINNED,(function(){e.getAllCellCtrls().forEach((function(e){return e.updateRangeBordersIfRangeCount()}))})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_VISIBLE,(function(){e.getAllCellCtrls().forEach((function(e){return e.updateRangeBordersIfRangeCount()}))}))),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,Ym.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}},{key:"removeGridColumnListeners",value:function(){this.destroyFuncsForColumnListeners.forEach((function(e){return e()})),this.destroyFuncsForColumnListeners.length=0}},{key:"refreshListenersToColumnsForCellComps",value:function(){var e=this;this.removeGridColumnListeners();var t=this.columnModel.getAllGridColumns();t&&t.forEach((function(t){var n=function(n){e.getAllCellCtrls().forEach((function(e){e.getColumn()===t&&n(e)}))},r=function(){n((function(e){return e.onLeftChanged()}))},i=function(){n((function(e){return e.onWidthChanged()}))},o=function(){n((function(e){return e.onFirstRightPinnedChanged()}))},a=function(){n((function(e){return e.onLastLeftPinnedChanged()}))},s=function(){n((function(e){return e.onColDefChanged()}))};t.addEventListener("leftChanged",r),t.addEventListener("widthChanged",i),t.addEventListener("firstRightPinnedChanged",o),t.addEventListener("lastLeftPinnedChanged",a),t.addEventListener("colDefChanged",s),e.destroyFuncsForColumnListeners.push((function(){t.removeEventListener("leftChanged",r),t.removeEventListener("widthChanged",i),t.removeEventListener("firstRightPinnedChanged",o),t.removeEventListener("lastLeftPinnedChanged",a),t.removeEventListener("colDefChanged",s)}))}))}},{key:"onDomLayoutChanged",value:function(){var e=this.gridOptionsService.isDomLayout("print"),t=e||this.gridOptionsService.is("embedFullWidthRows"),n=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,n&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}},{key:"datasourceChanged",value:function(){this.firstRenderedRow=0,this.lastRenderedRow=-1;var e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}},{key:"onPageLoaded",value:function(e){var t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}},{key:"getAllCellsForColumn",value:function(e){var t=[];return this.getAllRowCtrls().forEach((function(n){var r=n.getCellElement(e);r&&t.push(r)})),t}},{key:"refreshFloatingRowComps",value:function(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())}},{key:"getTopRowCtrls",value:function(){return this.topRowCtrls}},{key:"getBottomRowCtrls",value:function(){return this.bottomRowCtrls}},{key:"refreshFloatingRows",value:function(e,t){var n=this;e.forEach((function(e){e.destroyFirstPass(),e.destroySecondPass()})),e.length=0,t&&t.forEach((function(t){var r=new ck(t,n.beans,!1,!1,n.printLayout);e.push(r)}))}},{key:"onPinnedRowDataChanged",value:function(){this.redrawAfterModelUpdate({recycleRows:!0})}},{key:"getRenderedIndexesForRowNodes",value:function(e){var t=[];return pg(e)||Sg(this.rowCtrlsByRowIndex,(function(n,r){var i=r.getRowNode();e.indexOf(i)>=0&&t.push(n)})),t}},{key:"redrawRows",value:function(e){var t=null!=e&&e.length>0;if(t){var n=this.getRenderedIndexesForRowNodes(e);this.removeRowCtrls(n)}this.redrawAfterModelUpdate({recycleRows:t})}},{key:"getCellToRestoreFocusToAfterRefresh",value:function(e){var t=(null===e||void 0===e?void 0:e.suppressKeepFocus)?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==t)return null;var n=this.gridOptionsService.getDocument().activeElement,r=this.gridOptionsService.getDomData(n,lk.DOM_DATA_KEY_CELL_CTRL),i=this.gridOptionsService.getDomData(n,ck.DOM_DATA_KEY_ROW_CTRL);return r||i?t:null}},{key:"redrawAfterModelUpdate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.getLockOnRefresh();var t=this.getCellToRestoreFocusToAfterRefresh(e);this.updateContainerHeights(),this.scrollToTopIfNewData(e);var n=!e.domLayoutChanged&&!!e.recycleRows,r=e.animate&&this.gridOptionsService.isAnimateRows(),i=n?this.getRowsToRecycle():null;n||this.removeAllRowComps(),this.recycleRows(i,r),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=t&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}},{key:"scrollToTopIfNewData",value:function(e){var t=e.newData||e.newPage,n=this.gridOptionsService.is("suppressScrollOnNewData");t&&!n&&this.gridBodyCtrl.getScrollFeature().scrollToTop()}},{key:"updateContainerHeights",value:function(){if(this.printLayout)this.rowContainerHeightService.setModelHeight(null);else{var e=this.paginationProxy.getCurrentPageHeight();0===e&&(e=1),this.rowContainerHeightService.setModelHeight(e)}}},{key:"getLockOnRefresh",value:function(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0}},{key:"releaseLockOnRefresh",value:function(){this.refreshInProgress=!1}},{key:"isRefreshInProgress",value:function(){return this.refreshInProgress}},{key:"restoreFocusedCell",value:function(e){e&&(this.focusService.setRestoreFocusedCell(e),this.onCellFocusChanged({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,api:this.beans.gridApi,columnApi:this.beans.columnApi,context:this.beans.gridOptionsService.context,type:"mock"}))}},{key:"stopEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.getAllRowCtrls().forEach((function(t){t.stopEditing(e)}))}},{key:"getAllCellCtrls",value:function(){for(var e=[],t=this.getAllRowCtrls(),n=t.length,r=0;r<n;r++)for(var i=t[r].getAllCellCtrls(),o=i.length,a=0;a<o;a++)e.push(i[a]);return e}},{key:"getAllRowCtrls",value:function(){for(var e=this.stickyRowFeature&&this.stickyRowFeature.getStickyRowCtrls()||[],t=[].concat(wt(this.topRowCtrls),wt(this.bottomRowCtrls),wt(e)),n=0,r=Object.keys(this.rowCtrlsByRowIndex);n<r.length;n++){var i=r[n];t.push(this.rowCtrlsByRowIndex[i])}return t}},{key:"addRenderedRowListener",value:function(e,t,n){var r=this.rowCtrlsByRowIndex[t];r&&r.addEventListener(e,n)}},{key:"flashCells",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.flashDelay,n=e.fadeDelay;this.getCellCtrls(e.rowNodes,e.columns).forEach((function(e){return e.flashCell({flashDelay:t,fadeDelay:n})}))}},{key:"refreshCells",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};this.getCellCtrls(e.rowNodes,e.columns).forEach((function(e){if(e.refreshShouldDestroy()){var n=e.getRowCtrl();n&&n.refreshCell(e)}else e.refreshCell(t)})),this.refreshFullWidthRows(e.rowNodes)}},{key:"getCellRendererInstances",value:function(e){var t,n=this,r=this.getCellCtrls(e.rowNodes,e.columns).map((function(e){return e.getCellRenderer()})).filter((function(e){return null!=e}));if(null===(t=e.columns)||void 0===t?void 0:t.length)return r;var i=[],o=this.mapRowNodes(e.rowNodes);return this.getAllRowCtrls().forEach((function(e){if((!o||n.isRowInMap(e.getRowNode(),o))&&e.isFullWidth()){var t=e.getFullWidthCellRenderer();t&&i.push(t)}})),[].concat(i,wt(r))}},{key:"getCellEditorInstances",value:function(e){var t=[];return this.getCellCtrls(e.rowNodes,e.columns).forEach((function(e){var n=e.getCellEditor();n&&t.push(n)})),t}},{key:"getEditingCells",value:function(){var e=[];return this.getAllCellCtrls().forEach((function(t){if(t.isEditing()){var n=t.getCellPosition();e.push(n)}})),e}},{key:"mapRowNodes",value:function(e){if(e){var t={top:{},bottom:{},normal:{}};return e.forEach((function(e){var n=e.id;"top"===e.rowPinned?t.top[n]=e:"bottom"===e.rowPinned?t.bottom[n]=e:t.normal[n]=e})),t}}},{key:"isRowInMap",value:function(e,t){var n=e.id,r=e.rowPinned;return"bottom"===r?null!=t.bottom[n]:"top"===r?null!=t.top[n]:null!=t.normal[n]}},{key:"getCellCtrls",value:function(e,t){var n,r=this,i=this.mapRowNodes(e),o=[];fg(t)&&(n={},t.forEach((function(e){var t=r.columnModel.getGridColumn(e);fg(t)&&(n[t.getId()]=!0)})));return this.getAllRowCtrls().forEach((function(e){return function(e){var t=e.getRowNode();(null==i||r.isRowInMap(t,i))&&e.getAllCellCtrls().forEach((function(e){var t=e.getColumn().getId();n&&!n[t]||o.push(e)}))}(e)})),o}},{key:"destroy",value:function(){this.removeAllRowComps(),cg(D(n.prototype),"destroy",this).call(this)}},{key:"removeAllRowComps",value:function(){var e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}},{key:"getRowsToRecycle",value:function(){var e=[];Sg(this.rowCtrlsByRowIndex,(function(t,n){null==n.getRowNode().id&&e.push(t)})),this.removeRowCtrls(e);var t={};return Sg(this.rowCtrlsByRowIndex,(function(e,n){var r=n.getRowNode();t[r.id]=n})),this.rowCtrlsByRowIndex={},t}},{key:"removeRowCtrls",value:function(e){var t=this;e.forEach((function(e){var n=t.rowCtrlsByRowIndex[e];n&&(n.destroyFirstPass(),n.destroySecondPass()),delete t.rowCtrlsByRowIndex[e]}))}},{key:"onBodyScroll",value:function(e){"vertical"===e.direction&&this.redraw()}},{key:"redraw",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.stickyRowFeature&&Sw()&&(e=this.getCellToRestoreFocusToAfterRefresh()||void 0),this.getLockOnRefresh(),this.recycleRows(null,!1,t),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(t),null!=e){var n=this.getCellToRestoreFocusToAfterRefresh();null!=e&&null==n&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(e))}}},{key:"removeRowCompsNotToDraw",value:function(e){var t={};e.forEach((function(e){return t[e]=!0}));var n=Object.keys(this.rowCtrlsByRowIndex).filter((function(e){return!t[e]}));this.removeRowCtrls(n)}},{key:"calculateIndexesToDraw",value:function(e){var t=this,n=Nw(this.firstRenderedRow,this.lastRenderedRow),r=function(e,r){var i=r.getRowNode().rowIndex;null!=i&&(i<t.firstRenderedRow||i>t.lastRenderedRow)&&t.doNotUnVirtualiseRow(r)&&n.push(i)};return Sg(this.rowCtrlsByRowIndex,r),Sg(e,r),n.sort((function(e,t){return e-t})),n=n.filter((function(e){var n=t.paginationProxy.getRow(e);return n&&!n.sticky}))}},{key:"recycleRows",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.rowContainerHeightService.updateOffset(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature&&this.stickyRowFeature.checkStickyRows();var i=this.calculateIndexesToDraw(e);(this.removeRowCompsNotToDraw(i),this.printLayout&&(n=!1),i.forEach((function(i){t.createOrUpdateRowCtrl(i,e,n,r)})),e)&&(r&&!this.gridOptionsService.is("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask((function(){t.destroyRowCtrls(e,n),t.updateAllRowCtrls(),t.dispatchDisplayedRowsChanged()})):this.destroyRowCtrls(e,n));this.updateAllRowCtrls()}},{key:"dispatchDisplayedRowsChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={type:Ym.EVENT_DISPLAYED_ROWS_CHANGED,afterScroll:e};this.eventService.dispatchEvent(t)}},{key:"onDisplayedColumnsChanged",value:function(){var e=this.columnModel.isPinningLeft(),t=this.columnModel.isPinningRight();(this.pinningLeft!==e||t!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=t,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}},{key:"redrawFullWidthEmbeddedRows",value:function(){var e=[];this.getFullWidthRowCtrls().forEach((function(t){var n=t.getRowNode().rowIndex;e.push(n.toString())})),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw()}},{key:"getFullWidthRowCtrls",value:function(e){var t=this,n=this.mapRowNodes(e);return this.getAllRowCtrls().filter((function(e){if(!e.isFullWidth())return!1;var r=e.getRowNode();return!(null!=n&&!t.isRowInMap(r,n))}))}},{key:"refreshFullWidthRow",value:function(e){this.refreshFullWidthRows([e])}},{key:"refreshFullWidthRows",value:function(e){var t=this,n=this.getFullWidthRowCtrls(e),r=!1,i=[];n.forEach((function(e){if(!e.refreshFullWidth()){var n=e.getRowNode();n.sticky?t.stickyRowFeature.refreshStickyNode(n):i.push(n.rowIndex),r=!0}})),i.length>0&&this.removeRowCtrls(i),r&&this.redraw(!1)}},{key:"createOrUpdateRowCtrl",value:function(e,t,n,r){var i,o=this.rowCtrlsByRowIndex[e];if(o||fg(i=this.paginationProxy.getRow(e))&&fg(t)&&t[i.id]&&i.alreadyRendered&&(o=t[i.id],t[i.id]=null),!o){if(i||(i=this.paginationProxy.getRow(e)),!fg(i))return;o=this.createRowCon(i,n,r)}return i&&(i.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=o,o}},{key:"destroyRowCtrls",value:function(e,t){var n=this,r=[];Sg(e,(function(e,i){i&&(n.cachedRowCtrls&&i.isCacheable()?n.cachedRowCtrls.addRow(i):(i.destroyFirstPass(),t?(n.zombieRowCtrls[i.getInstanceId()]=i,r.push((function(){i.destroySecondPass(),delete n.zombieRowCtrls[i.getInstanceId()]}))):i.destroySecondPass()))})),t&&(r.push((function(){n.updateAllRowCtrls(),n.dispatchDisplayedRowsChanged()})),Bg(r))}},{key:"getRowBuffer",value:function(){var e=this.gridOptionsService.getNum("rowBuffer");return"number"===typeof e?e<0&&(Lg((function(){return console.warn("AG Grid: rowBuffer should not be negative")}),"warn rowBuffer negative"),e=0,this.gridOptionsService.set("rowBuffer",0)):e=10,e}},{key:"getRowBufferInPixels",value:function(){return this.getRowBuffer()*this.gridOptionsService.getRowHeightAsNumber()}},{key:"workOutFirstAndLastRowsToRender",value:function(){var e,t;if(this.paginationProxy.isRowsToRender())if(this.printLayout)e=this.paginationProxy.getPageFirstRow(),t=this.paginationProxy.getPageLastRow();else{var n,r,i=this.getRowBufferInPixels(),o=this.ctrlsService.getGridBodyCtrl(),a=this.gridOptionsService.is("suppressRowVirtualisation"),s=!1;do{var l=this.paginationProxy.getPixelOffset(),u=this.paginationProxy.getCurrentPagePixelRange(),c=u.pageFirstPixel,d=u.pageLastPixel,h=this.rowContainerHeightService.getDivStretchOffset(),f=o.getScrollFeature().getVScrollPosition(),p=f.top,v=f.bottom;a?(n=c+h,r=d+h):(n=Math.max(p+l-i,c)+h,r=Math.min(v+l+i,d)+h),this.firstVisibleVPixel=Math.max(p+l,c)+h,s=this.ensureAllRowsInRangeHaveHeightsCalculated(n,r)}while(s);var g=this.paginationProxy.getRowIndexAtPixel(n),m=this.paginationProxy.getRowIndexAtPixel(r),y=this.paginationProxy.getPageFirstRow(),w=this.paginationProxy.getPageLastRow();g<y&&(g=y),m>w&&(m=w),e=g,t=m}else e=0,t=-1;var b=this.gridOptionsService.isDomLayout("normal"),C=this.gridOptionsService.is("suppressMaxRenderedRowRestriction"),S=Math.max(this.getRowBuffer(),500);b&&!C&&t-e>S&&(t=e+S);var E=e!==this.firstRenderedRow,k=t!==this.lastRenderedRow;if(E||k){this.firstRenderedRow=e,this.lastRenderedRow=t;var x={type:Ym.EVENT_VIEWPORT_CHANGED,firstRow:e,lastRow:t};this.eventService.dispatchEvent(x)}}},{key:"dispatchFirstDataRenderedEvent",value:function(){var e=this;if(!this.dataFirstRenderedFired){this.dataFirstRenderedFired=!0;var t={type:Ym.EVENT_FIRST_DATA_RENDERED,firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame((function(){e.beans.eventService.dispatchEvent(t)}))}}},{key:"ensureAllRowsInRangeHaveHeightsCalculated",value:function(e,t){var n=this.paginationProxy.ensureRowHeightsValid(e,t,-1,-1);return n&&this.updateContainerHeights(),n}},{key:"getFirstVisibleVerticalPixel",value:function(){return this.firstVisibleVPixel}},{key:"getFirstVirtualRenderedRow",value:function(){return this.firstRenderedRow}},{key:"getLastVirtualRenderedRow",value:function(){return this.lastRenderedRow}},{key:"doNotUnVirtualiseRow",value:function(e){var t=e.getRowNode(),n=this.focusService.isRowNodeFocused(t),r=e.isEditing(),i=t.detail;return!!(n||r||i)&&!!this.paginationProxy.isRowPresent(t)}},{key:"createRowCon",value:function(e,t,n){var r=this.cachedRowCtrls?this.cachedRowCtrls.getRow(e):null;if(r)return r;var i=this.gridOptionsService.is("suppressAnimationFrame"),o=n&&!i&&!this.printLayout;return new ck(e,this.beans,t,o,this.printLayout)}},{key:"getRenderedNodes",value:function(){var e=this.rowCtrlsByRowIndex;return Object.keys(e).map((function(t){return e[t].getRowNode()}))}},{key:"getRowByPosition",value:function(e){var t,n=e.rowIndex;switch(e.rowPinned){case"top":t=this.topRowCtrls[n];break;case"bottom":t=this.bottomRowCtrls[n];break;default:(t=this.rowCtrlsByRowIndex[n])||(t=this.getStickyTopRowCtrls().find((function(e){return e.getRowNode().rowIndex===n}))||null)}return t}},{key:"getRowNode",value:function(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}}},{key:"isRangeInRenderedViewport",value:function(e,t){if(null==e||null==t)return!1;var n=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!n}}]),n}(Vm);cT([nm("animationFrameService")],dT.prototype,"animationFrameService",void 0),cT([nm("paginationProxy")],dT.prototype,"paginationProxy",void 0),cT([nm("columnModel")],dT.prototype,"columnModel",void 0),cT([nm("pinnedRowModel")],dT.prototype,"pinnedRowModel",void 0),cT([nm("rowModel")],dT.prototype,"rowModel",void 0),cT([nm("focusService")],dT.prototype,"focusService",void 0),cT([nm("beans")],dT.prototype,"beans",void 0),cT([nm("rowContainerHeightService")],dT.prototype,"rowContainerHeightService",void 0),cT([nm("ctrlsService")],dT.prototype,"ctrlsService",void 0),cT([$g],dT.prototype,"postConstruct",null),dT=cT([tm("rowRenderer")],dT);var hT=function(){function e(t){T(this,e),this.entriesMap={},this.entriesList=[],this.maxCount=t}return A(e,[{key:"addRow",value:function(e){if(this.entriesMap[e.getRowNode().id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){var t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}},{key:"getRow",value:function(e){if(null==e||null==e.id)return null;var t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.getRowNode()!=e?null:t):null}},{key:"removeFromCache",value:function(e){var t=e.getRowNode().id;delete this.entriesMap[t],Cm(this.entriesList,e)}},{key:"getEntries",value:function(){return this.entriesList}}]),e}(),fT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},pT=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"formatValue",value:function(e,t,n,r){var i,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=null,s=e.getColDef();if(r?i=r:o&&(i=s.valueFormatter),i){var l={value:n,node:t,data:t?t.data:null,colDef:s,column:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};a="function"===typeof i?i(l):this.expressionService.evaluate(i,l)}else if(s.refData)return s.refData[n]||"";return null==a&&Array.isArray(n)&&(a=n.join(", ")),a}}]),n}(Vm);fT([nm("expressionService")],pT.prototype,"expressionService",void 0),pT=fT([tm("valueFormatterService")],pT);var vT,gT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},mT=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"init",value:function(){this.setPinnedTopRowData(this.gridOptionsService.get("pinnedTopRowData")),this.setPinnedBottomRowData(this.gridOptionsService.get("pinnedBottomRowData"))}},{key:"isEmpty",value:function(e){return vg("top"===e?this.pinnedTopRows:this.pinnedBottomRows)}},{key:"isRowsToRender",value:function(e){return!this.isEmpty(e)}},{key:"getRowAtPixel",value:function(e,t){var n="top"===t?this.pinnedTopRows:this.pinnedBottomRows;if(vg(n))return 0;for(var r=0;r<n.length;r++){var i=n[r];if(i.rowTop+i.rowHeight-1>=e)return r}return n.length-1}},{key:"setPinnedTopRowData",value:function(e){this.pinnedTopRows=this.createNodesFromData(e,!0);var t={type:Ym.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(t)}},{key:"setPinnedBottomRowData",value:function(e){this.pinnedBottomRows=this.createNodesFromData(e,!1);var t={type:Ym.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(t)}},{key:"createNodesFromData",value:function(e,t){var n=this,r=[];if(e){var i=0;e.forEach((function(e,o){var a=new mS(n.beans);a.data=e;var s=t?mS.ID_PREFIX_TOP_PINNED:mS.ID_PREFIX_BOTTOM_PINNED;a.id=s+o,a.rowPinned=t?"top":"bottom",a.setRowTop(i),a.setRowHeight(n.gridOptionsService.getRowHeightForNode(a).height),a.setRowIndex(o),i+=a.rowHeight,r.push(a)}))}return r}},{key:"getPinnedTopRowData",value:function(){return this.pinnedTopRows}},{key:"getPinnedBottomRowData",value:function(){return this.pinnedBottomRows}},{key:"getPinnedTopTotalHeight",value:function(){return this.getTotalHeight(this.pinnedTopRows)}},{key:"getPinnedTopRowCount",value:function(){return this.pinnedTopRows?this.pinnedTopRows.length:0}},{key:"getPinnedBottomRowCount",value:function(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0}},{key:"getPinnedTopRow",value:function(e){return this.pinnedTopRows[e]}},{key:"getPinnedBottomRow",value:function(e){return this.pinnedBottomRows[e]}},{key:"forEachPinnedTopRow",value:function(e){vg(this.pinnedTopRows)||this.pinnedTopRows.forEach(e)}},{key:"forEachPinnedBottomRow",value:function(e){vg(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(e)}},{key:"getPinnedBottomTotalHeight",value:function(){return this.getTotalHeight(this.pinnedBottomRows)}},{key:"getTotalHeight",value:function(e){if(!e||0===e.length)return 0;var t=ym(e);return t.rowTop+t.rowHeight}}]),n}(Vm);gT([nm("beans")],mT.prototype,"beans",void 0),gT([$g],mT.prototype,"init",null),mT=gT([tm("pinnedRowModel")],mT),function(e){e.Applied="Applied",e.StoreNotFound="StoreNotFound",e.StoreLoading="StoreLoading",e.StoreWaitingToLoad="StoreWaitingToLoad",e.StoreLoadingFailed="StoreLoadingFailed",e.StoreWrongType="StoreWrongType",e.Cancelled="Cancelled"}(vT||(vT={}));var yT=function(){function e(t,n){T(this,e),this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=t,this.pathRoot={rowNode:n,children:null},this.mapToItems[n.id]=this.pathRoot}return A(e,[{key:"setInactive",value:function(){this.active=!1}},{key:"isActive",value:function(){return this.active}},{key:"depthFirstSearchChangedPath",value:function(e,t){if(e.children)for(var n=0;n<e.children.length;n++)this.depthFirstSearchChangedPath(e.children[n],t);t(e.rowNode)}},{key:"depthFirstSearchEverything",value:function(e,t,n){if(e.childrenAfterGroup)for(var r=0;r<e.childrenAfterGroup.length;r++){var i=e.childrenAfterGroup[r];i.childrenAfterGroup?this.depthFirstSearchEverything(e.childrenAfterGroup[r],t,n):n&&t(i)}t(e)}},{key:"forEachChangedNodeDepthFirst",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.active&&!n?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}},{key:"executeFromRootNode",value:function(e){e(this.pathRoot.rowNode)}},{key:"createPathItems",value:function(e){for(var t=e,n=0;!this.mapToItems[t.id];){var r={rowNode:t,children:null};this.mapToItems[t.id]=r,n++,t=t.parent}return n}},{key:"populateColumnsMap",value:function(e,t){var n=this;if(this.keepingColumns&&t)for(var r=e;r;)this.nodeIdsToColumns[r.id]||(this.nodeIdsToColumns[r.id]={}),t.forEach((function(e){return n.nodeIdsToColumns[r.id][e.getId()]=!0})),r=r.parent}},{key:"linkPathItems",value:function(e,t){for(var n=e,r=0;r<t;r++){var i=this.mapToItems[n.id],o=this.mapToItems[n.parent.id];o.children||(o.children=[]),o.children.push(i),n=n.parent}}},{key:"addParentNode",value:function(e,t){if(e&&!e.isRowPinned()){var n=this.createPathItems(e);this.linkPathItems(e,n),this.populateColumnsMap(e,t)}}},{key:"canSkip",value:function(e){return this.active&&!this.mapToItems[e.id]}},{key:"getValueColumnsForNode",value:function(e,t){if(!this.keepingColumns)return t;var n=this.nodeIdsToColumns[e.id];return t.filter((function(e){return n[e.getId()]}))}},{key:"getNotValueColumnsForNode",value:function(e,t){if(!this.keepingColumns)return null;var n=this.nodeIdsToColumns[e.id];return t.filter((function(e){return!n[e.getId()]}))}}]),e}(),wT=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).state=n.STATE_WAITING_TO_LOAD,r.version=0,r.id=e,r}return A(n,[{key:"getId",value:function(){return this.id}},{key:"load",value:function(){this.state=n.STATE_LOADING,this.loadFromDatasource()}},{key:"getVersion",value:function(){return this.version}},{key:"setStateWaitingToLoad",value:function(){this.version++,this.state=n.STATE_WAITING_TO_LOAD}},{key:"getState",value:function(){return this.state}},{key:"pageLoadFailed",value:function(e){this.isRequestMostRecentAndLive(e)&&(this.state=n.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)}},{key:"success",value:function(e,t){this.successCommon(e,t)}},{key:"pageLoaded",value:function(e,t,n){this.successCommon(e,{rowData:t,rowCount:n})}},{key:"isRequestMostRecentAndLive",value:function(e){var t=e===this.version,n=this.isAlive();return t&&n}},{key:"successCommon",value:function(e,t){this.dispatchLoadCompleted(),this.isRequestMostRecentAndLive(e)&&(this.state=n.STATE_LOADED,this.processServerResult(t))}},{key:"dispatchLoadCompleted",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={type:n.EVENT_LOAD_COMPLETE,success:e,block:this};this.dispatchEvent(t)}}]),n}(Vm);wT.EVENT_LOAD_COMPLETE="loadComplete",wT.STATE_WAITING_TO_LOAD="needsLoading",wT.STATE_LOADING="loading",wT.STATE_LOADED="loaded",wT.STATE_FAILED="failed";var bT,CT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ST=bT=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).activeBlockLoadsCount=0,e.blocks=[],e.active=!0,e}return A(n,[{key:"postConstruct",value:function(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();var e=this.gridOptionsService.getNum("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=Vb.debounce(this.performCheckBlocksToLoad.bind(this),e))}},{key:"setBeans",value:function(e){this.logger=e.create("RowNodeBlockLoader")}},{key:"getMaxConcurrentDatasourceRequests",value:function(){var e=this.gridOptionsService.getNum("maxConcurrentDatasourceRequests");return null==e?2:e<=0?void 0:e}},{key:"addBlock",value:function(e){this.blocks.push(e),e.addEventListener(wT.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()}},{key:"removeBlock",value:function(e){Vb.removeFromArray(this.blocks,e)}},{key:"destroy",value:function(){cg(D(n.prototype),"destroy",this).call(this),this.active=!1}},{key:"loadComplete",value:function(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchEvent({type:bT.BLOCK_LOADED_EVENT}),0==this.activeBlockLoadsCount&&this.dispatchEvent({type:bT.BLOCK_LOADER_FINISHED_EVENT})}},{key:"checkBlockToLoad",value:function(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}},{key:"performCheckBlocksToLoad",value:function(){if(this.active)if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)this.logger.log("checkBlockToLoad: max loads exceeded");else{var e=this.getAvailableLoadingCount(),t=this.blocks.filter((function(e){return e.getState()===wT.STATE_WAITING_TO_LOAD})).slice(0,e);this.registerLoads(t.length),t.forEach((function(e){return e.load()})),this.printCacheStatus()}}},{key:"getBlockState",value:function(){if(this.gridOptionsService.isRowModelType("serverSide"))return this.rowModel.getBlockStates();var e={};return this.blocks.forEach((function(t){var n=t.getBlockStateJson(),r=n.id,i=n.state;e[r]=i})),e}},{key:"printCacheStatus",value:function(){this.logger.isLogging()&&this.logger.log("printCacheStatus: activePageLoadsCount = ".concat(this.activeBlockLoadsCount,",")+" blocks = ".concat(JSON.stringify(this.getBlockState())))}},{key:"isLoading",value:function(){return this.activeBlockLoadsCount>0}},{key:"registerLoads",value:function(e){this.activeBlockLoadsCount+=e}},{key:"getAvailableLoadingCount",value:function(){return void 0!==this.maxConcurrentRequests?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}}]),n}(Vm);ST.BLOCK_LOADED_EVENT="blockLoaded",ST.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished",CT([nm("rowModel")],ST.prototype,"rowModel",void 0),CT([$g],ST.prototype,"postConstruct",null),CT([function(e,t){return function(n,r){t(n,r,e)}}(0,om("loggerFactory"))],ST.prototype,"setBeans",null),ST=bT=CT([tm("rowNodeBlockLoader")],ST);var ET=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},kT=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).currentPage=0,e.topDisplayedRowIndex=0,e.bottomDisplayedRowIndex=0,e.pixelOffset=0,e.masterRowCount=0,e}return A(n,[{key:"postConstruct",value:function(){this.active=this.gridOptionsService.is("pagination"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedListener(this.eventService,Ym.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedPropertyListener("pagination",this.onPaginationPageSizeChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPaginationPageSizeChanged.bind(this)),this.onModelUpdated()}},{key:"ensureRowHeightsValid",value:function(e,t,n,r){var i=this.rowModel.ensureRowHeightsValid(e,t,this.getPageFirstRow(),this.getPageLastRow());return i&&this.calculatePages(),i}},{key:"isPaginateChildRows",value:function(){return!(!this.gridOptionsService.is("groupRemoveSingleChildren")&&!this.gridOptionsService.is("groupRemoveLowestSingleChildren"))||this.gridOptionsService.is("paginateChildRows")}},{key:"onModelUpdated",value:function(e){this.calculatePages();var t={type:Ym.EVENT_PAGINATION_CHANGED,animate:!!e&&e.animate,newData:!!e&&e.newData,newPage:!!e&&e.newPage,keepRenderedRows:!!e&&e.keepRenderedRows};this.eventService.dispatchEvent(t)}},{key:"onPaginationPageSizeChanged",value:function(){this.active=this.gridOptionsService.is("pagination"),this.calculatePages();var e={type:Ym.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,keepRenderedRows:!0};this.eventService.dispatchEvent(e)}},{key:"goToPage",value:function(e){if(this.active&&this.currentPage!==e&&"number"===typeof this.currentPage){this.currentPage=e;var t={type:Ym.EVENT_MODEL_UPDATED,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!0};this.onModelUpdated(t)}}},{key:"getPixelOffset",value:function(){return this.pixelOffset}},{key:"getRow",value:function(e){return this.rowModel.getRow(e)}},{key:"getRowNode",value:function(e){return this.rowModel.getRowNode(e)}},{key:"getRowIndexAtPixel",value:function(e){return this.rowModel.getRowIndexAtPixel(e)}},{key:"getCurrentPageHeight",value:function(){return pg(this.topRowBounds)||pg(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}},{key:"getCurrentPagePixelRange",value:function(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}}},{key:"isRowPresent",value:function(e){return!!this.rowModel.isRowPresent(e)&&(e.rowIndex>=this.topDisplayedRowIndex&&e.rowIndex<=this.bottomDisplayedRowIndex)}},{key:"isEmpty",value:function(){return this.rowModel.isEmpty()}},{key:"isRowsToRender",value:function(){return this.rowModel.isRowsToRender()}},{key:"forEachNode",value:function(e){return this.rowModel.forEachNode(e)}},{key:"forEachNodeOnPage",value:function(e){for(var t=this.getPageFirstRow(),n=this.getPageLastRow(),r=t;r<=n;r++){var i=this.getRow(r);i&&e(i)}}},{key:"getType",value:function(){return this.rowModel.getType()}},{key:"getRowBounds",value:function(e){var t=this.rowModel.getRowBounds(e);return t.rowIndex=e,t}},{key:"getPageFirstRow",value:function(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}},{key:"getPageLastRow",value:function(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}},{key:"getRowCount",value:function(){return this.rowModel.getRowCount()}},{key:"getPageForIndex",value:function(e){return Math.floor(e/this.pageSize)}},{key:"goToPageWithIndex",value:function(e){if(this.active){var t=this.getPageForIndex(e);this.goToPage(t)}}},{key:"isRowInPage",value:function(e){return!this.active||this.getPageForIndex(e.rowIndex)===this.currentPage}},{key:"isLastPageFound",value:function(){return this.rowModel.isLastRowIndexKnown()}},{key:"getCurrentPage",value:function(){return this.currentPage}},{key:"goToNextPage",value:function(){this.goToPage(this.currentPage+1)}},{key:"goToPreviousPage",value:function(){this.goToPage(this.currentPage-1)}},{key:"goToFirstPage",value:function(){this.goToPage(0)}},{key:"goToLastPage",value:function(){var e=this.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}},{key:"getPageSize",value:function(){return this.pageSize}},{key:"getTotalPages",value:function(){return this.totalPages}},{key:"setPageSize",value:function(){this.pageSize=this.gridOptionsService.getNum("paginationPageSize"),(null==this.pageSize||this.pageSize<1)&&(this.pageSize=100)}},{key:"calculatePages",value:function(){this.active?(this.setPageSize(),this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly()):this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(fg(this.topRowBounds)?this.topRowBounds.rowTop:0)}},{key:"setPixelOffset",value:function(e){this.pixelOffset!==e&&(this.pixelOffset=e,this.eventService.dispatchEvent({type:Ym.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))}},{key:"setZeroRows",value:function(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}},{key:"adjustCurrentPageIfInvalid",value:function(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}},{key:"calculatePagesMasterRowsOnly",value:function(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)this.setZeroRows();else{var e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid();var t=this.pageSize*this.currentPage,n=this.pageSize*(this.currentPage+1)-1;if(n>e&&(n=e),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(t),n===e)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{var r=this.rowModel.getTopLevelRowDisplayedIndex(n+1);this.bottomDisplayedRowIndex=r-1}}}},{key:"getMasterRowCount",value:function(){return this.masterRowCount}},{key:"calculatePagesAllRows",value:function(){if(this.masterRowCount=this.rowModel.getRowCount(),0!==this.masterRowCount){var e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>e&&(this.bottomDisplayedRowIndex=e)}else this.setZeroRows()}},{key:"calculatedPagesNotActive",value:function(){this.pageSize=this.rowModel.getRowCount(),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}}]),n}(Vm);ET([nm("rowModel")],kT.prototype,"rowModel",void 0),ET([$g],kT.prototype,"postConstruct",null),kT=ET([tm("paginationProxy")],kT);var xT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},TT=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"processAllCellClasses",value:function(e,t,n,r){this.processClassRules(e.cellClassRules,t,n,r),this.processStaticCellClasses(e,t,n)}},{key:"processClassRules",value:function(e,t,n,r){var i=this;if(null!=e){for(var o=Object.keys(e),a={},s={},l=function(){var n,r=o[u],l=e[r];"string"===typeof l?n=i.expressionService.evaluate(l,t):"function"===typeof l&&(n=l(t)),r.split(" ").forEach((function(e){null!=e&&""!=e.trim()&&(n?a[e]=!0:s[e]=!0)}))},u=0;u<o.length;u++)l();r&&Object.keys(s).forEach(r),Object.keys(a).forEach(n)}}},{key:"getStaticCellClasses",value:function(e,t){var n,r=e.cellClass;if(!r)return[];"function"===typeof r?n=r(t):n=r;return"string"===typeof n&&(n=[n]),n||[]}},{key:"processStaticCellClasses",value:function(e,t,n){this.getStaticCellClasses(e,t).forEach((function(e){n(e)}))}}]),n}(Vm);xT([nm("expressionService")],TT.prototype,"expressionService",void 0),TT=xT([tm("stylingService")],TT);var RT=function(e){O(n,e);var t=F(n);function n(e){return T(this,n),t.call(this,e,"ag-toggle-button")}return A(n,[{key:"setValue",value:function(e,t){return cg(D(n.prototype),"setValue",this).call(this,e,t),this.addOrRemoveCssClass("ag-selected",this.getValue()),this}}]),n}(kC),AT=function(e){O(n,e);var t=F(n);function n(e){return T(this,n),t.call(this,e,"ag-text-area",null,"textarea")}return A(n,[{key:"setValue",value:function(e,t){var r=cg(D(n.prototype),"setValue",this).call(this,e,t);return this.eInput.value=e,r}},{key:"setCols",value:function(e){return this.eInput.cols=e,this}},{key:"setRows",value:function(e){return this.eInput.rows=e,this}}]),n}(EC),_T=function(e){O(n,e);var t=F(n);function n(e){return T(this,n),t.call(this,e,"ag-date-field","date")}return A(n,[{key:"postConstruct",value:function(){var e=this;cg(D(n.prototype),"postConstruct",this).call(this),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this));var t=gw();this.addManagedListener(this.eInput,"mousedown",(function(){e.isDisabled()||t||e.eInput.focus()})),this.eInput.step="any"}},{key:"onWheel",value:function(e){document.activeElement===this.eInput&&e.preventDefault()}},{key:"setMin",value:function(e){var t,n=e instanceof Date?null!==(t=Iw(null!==e&&void 0!==e?e:null,!1))&&void 0!==t?t:void 0:e;return this.min===n||(this.min=n,Sb(this.eInput,"min",n)),this}},{key:"setMax",value:function(e){var t,n=e instanceof Date?null!==(t=Iw(null!==e&&void 0!==e?e:null,!1))&&void 0!==t?t:void 0:e;return this.max===n||(this.max=n,Sb(this.eInput,"max",n)),this}},{key:"setStep",value:function(e){return this.step===e||(this.step=e,Sb(this.eInput,"step",e)),this}},{key:"getDate",value:function(){var e;if(this.eInput.validity.valid)return null!==(e=Gw(this.getValue()))&&void 0!==e?e:void 0}},{key:"setDate",value:function(e,t){this.setValue(Iw(null!==e&&void 0!==e?e:null,!1),t)}}]),n}(GC),OT=function(e){O(n,e);var t=F(n);function n(e){return T(this,n),t.call(this,e,"ag-range-field","range")}return A(n,[{key:"postConstruct",value:function(){cg(D(n.prototype),"postConstruct",this).call(this);var e=this.config,t=e.min,r=e.max,i=e.step;null!=t&&this.setMinValue(t),null!=r&&this.setMaxValue(r),this.setStep(i||1)}},{key:"addInputListeners",value:function(){var e=this;this.addManagedListener(this.eInput,"input",(function(t){var n=t.target.value;e.setValue(n)}))}},{key:"setMinValue",value:function(e){return this.min=e,this.eInput.setAttribute("min",e.toString()),this}},{key:"setMaxValue",value:function(e){return this.max=e,this.eInput.setAttribute("max",e.toString()),this}},{key:"setStep",value:function(e){return this.eInput.setAttribute("step",e.toString()),this}},{key:"setValue",value:function(e,t){null!=this.min&&(e=Math.max(parseFloat(e),this.min).toString()),null!=this.max&&(e=Math.min(parseFloat(e),this.max).toString());var r=cg(D(n.prototype),"setValue",this).call(this,e,t);return this.eInput.value=e,r}}]),n}(EC),DT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},NT=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this,e,n.TEMPLATE)).labelAlignment="top",r}return A(n,[{key:"init",value:function(){this.eSlider.addCssClass("ag-slider-field")}},{key:"onValueChange",value:function(e){var t=this,n=vC.EVENT_CHANGED;return this.addManagedListener(this.eText,n,(function(){var n=parseFloat(t.eText.getValue());t.eSlider.setValue(n.toString(),!0),e(n||0)})),this.addManagedListener(this.eSlider,n,(function(){var n=t.eSlider.getValue();t.eText.setValue(n,!0),e(parseFloat(n))})),this}},{key:"setSliderWidth",value:function(e){return this.eSlider.setWidth(e),this}},{key:"setTextFieldWidth",value:function(e){return this.eText.setWidth(e),this}},{key:"setMinValue",value:function(e){return this.eSlider.setMinValue(e),this.eText.setMin(e),this}},{key:"setMaxValue",value:function(e){return this.eSlider.setMaxValue(e),this.eText.setMax(e),this}},{key:"getValue",value:function(){return this.eText.getValue()}},{key:"setValue",value:function(e){return this.getValue()===e||(this.eText.setValue(e,!0),this.eSlider.setValue(e,!0),this.dispatchEvent({type:vC.EVENT_CHANGED})),this}},{key:"setStep",value:function(e){return this.eSlider.setStep(e),this.eText.setStep(e),this}}]),n}(pC);NT.TEMPLATE='<div class="ag-slider">\n            <label ref="eLabel"></label>\n            <div class="ag-wrapper ag-slider-wrapper">\n                <ag-input-range ref="eSlider"></ag-input-range>\n                <ag-input-number-field ref="eText"></ag-input-number-field>\n            </div>\n        </div>',DT([Jb("eLabel")],NT.prototype,"eLabel",void 0),DT([Jb("eSlider")],NT.prototype,"eSlider",void 0),DT([Jb("eText")],NT.prototype,"eText",void 0),DT([$g],NT.prototype,"init",null);var PT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},FT=function(e){O(n,e);var t=F(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};T(this,n),(e=t.call(this,n.getTemplate(r))).suppressEnabledCheckbox=!0,e.suppressOpenCloseIcons=!1;var i=r.title,o=r.enabled,a=r.items,s=r.suppressEnabledCheckbox,l=r.suppressOpenCloseIcons;return e.title=i,e.cssIdentifier=r.cssIdentifier||"default",e.enabled=null==o||o,e.items=a||[],e.alignItems=r.alignItems||"center",null!=s&&(e.suppressEnabledCheckbox=s),null!=l&&(e.suppressOpenCloseIcons=l),e}return A(n,[{key:"postConstruct",value:function(){if(this.items.length){var e=this.items;this.items=[],this.addItems(e)}var t=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(t("enabled","Enabled")),this.title&&this.setTitle(this.title),this.enabled&&this.setEnabled(this.enabled),this.setAlignItems(this.alignItems),this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract(),this.refreshAriaStatus(),this.refreshChildDisplay()}},{key:"setupExpandContract",value:function(){var e=this;this.eGroupClosedIcon.appendChild(Tb("columnSelectClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(Tb("columnSelectOpen",this.gridOptionsService,null)),this.addManagedListener(this.eTitleBar,"click",(function(){return e.toggleGroupExpand()})),this.addManagedListener(this.eTitleBar,"keydown",(function(t){switch(t.key){case _b.ENTER:case _b.SPACE:t.preventDefault(),e.toggleGroupExpand();break;case _b.RIGHT:case _b.LEFT:t.preventDefault(),e.toggleGroupExpand(t.key===_b.RIGHT)}}))}},{key:"refreshAriaStatus",value:function(){this.suppressOpenCloseIcons||Ky(this.eTitleBar,this.expanded)}},{key:"refreshChildDisplay",value:function(){var e=!this.suppressOpenCloseIcons;zw(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),zw(this.eGroupOpenedIcon,e&&this.expanded),zw(this.eGroupClosedIcon,e&&!this.expanded)}},{key:"isExpanded",value:function(){return this.expanded}},{key:"setAlignItems",value:function(e){this.alignItems!==e&&this.removeCssClass("ag-group-item-alignment-".concat(this.alignItems)),this.alignItems=e;var t="ag-group-item-alignment-".concat(this.alignItems);return this.addCssClass(t),this}},{key:"toggleGroupExpand",value:function(e){return this.suppressOpenCloseIcons?(this.expanded=!0,this.refreshChildDisplay(),zw(this.eContainer,!0),this):(e=null!=e?e:!this.expanded,this.expanded===e||(this.expanded=e,this.refreshAriaStatus(),this.refreshChildDisplay(),zw(this.eContainer,e),this.dispatchEvent({type:this.expanded?n.EVENT_EXPANDED:n.EVENT_COLLAPSED})),this)}},{key:"addItems",value:function(e){var t=this;e.forEach((function(e){return t.addItem(e)}))}},{key:"addItem",value:function(e){var t=this.eContainer,n=e instanceof Zb?e.getGui():e;n.classList.add("ag-group-item","ag-".concat(this.cssIdentifier,"-group-item")),t.appendChild(n),this.items.push(n)}},{key:"hideItem",value:function(e,t){zw(this.items[t],!e)}},{key:"setTitle",value:function(e){return this.eTitle.innerText=e,this}},{key:"addCssClassToTitleBar",value:function(e){this.eTitleBar.classList.add(e)}},{key:"setEnabled",value:function(e,t){return this.enabled=e,this.refreshDisabledStyles(),this.toggleGroupExpand(e),t||this.cbGroupEnabled.setValue(e),this}},{key:"isEnabled",value:function(){return this.enabled}},{key:"onEnableChange",value:function(e){var t=this;return this.cbGroupEnabled.onValueChange((function(n){t.setEnabled(n,!0),e(n)})),this}},{key:"hideEnabledCheckbox",value:function(e){return this.suppressEnabledCheckbox=e,this.refreshChildDisplay(),this.refreshDisabledStyles(),this}},{key:"hideOpenCloseIcons",value:function(e){return this.suppressOpenCloseIcons=e,e&&this.toggleGroupExpand(!0),this}},{key:"refreshDisabledStyles",value:function(){this.addOrRemoveCssClass("ag-disabled",!this.enabled),this.suppressEnabledCheckbox&&!this.enabled?(this.eTitleBar.classList.add("ag-disabled-group-title-bar"),this.eTitleBar.removeAttribute("tabindex")):(this.eTitleBar.classList.remove("ag-disabled-group-title-bar"),this.eTitleBar.setAttribute("tabindex","0")),this.eContainer.classList.toggle("ag-disabled-group-container",!this.enabled)}}],[{key:"getTemplate",value:function(e){var t=e.cssIdentifier||"default",n=e.direction||"vertical";return'<div class="ag-group ag-'.concat(t,'-group" role="presentation">\n            <div class="ag-group-title-bar ag-').concat(t,'-group-title-bar ag-unselectable" ref="eTitleBar" role="button">\n                <span class="ag-group-title-bar-icon ag-').concat(t,'-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>\n                <span class="ag-group-title-bar-icon ag-').concat(t,'-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>\n                <span ref="eTitle" class="ag-group-title ag-').concat(t,'-group-title"></span>\n            </div>\n            <div ref="eToolbar" class="ag-group-toolbar ag-').concat(t,'-group-toolbar">\n                <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>\n            </div>\n            <div ref="eContainer" class="ag-group-container ag-group-container-').concat(n," ag-").concat(t,'-group-container"></div>\n        </div>')}}]),n}(Zb);FT.EVENT_EXPANDED="expanded",FT.EVENT_COLLAPSED="collapsed",PT([Jb("eTitleBar")],FT.prototype,"eTitleBar",void 0),PT([Jb("eGroupOpenedIcon")],FT.prototype,"eGroupOpenedIcon",void 0),PT([Jb("eGroupClosedIcon")],FT.prototype,"eGroupClosedIcon",void 0),PT([Jb("eToolbar")],FT.prototype,"eToolbar",void 0),PT([Jb("cbGroupEnabled")],FT.prototype,"cbGroupEnabled",void 0),PT([Jb("eTitle")],FT.prototype,"eTitle",void 0),PT([Jb("eContainer")],FT.prototype,"eContainer",void 0),PT([$g],FT.prototype,"postConstruct",null);var IT=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"initialiseTabGuard",value:function(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();var t=[this.eTopGuard,this.eBottomGuard],n={setTabIndex:function(e){t.forEach((function(t){return null!=e?t.setAttribute("tabindex",e):t.removeAttribute("tabindex")}))}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new kx({comp:n,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:e.onFocusIn,onFocusOut:e.onFocusOut,focusInnerElement:e.focusInnerElement,handleKeyDown:e.handleKeyDown,onTabKeyDown:e.onTabKeyDown,shouldStopEventPropagation:e.shouldStopEventPropagation}))}},{key:"createTabGuard",value:function(e){var t=document.createElement("div"),n="top"===e?Sx.TAB_GUARD_TOP:Sx.TAB_GUARD_BOTTOM;return t.classList.add(Sx.TAB_GUARD,n),Fy(t,"presentation"),t}},{key:"addTabGuards",value:function(e,t){this.eFocusableElement.insertAdjacentElement("afterbegin",e),this.eFocusableElement.insertAdjacentElement("beforeend",t)}},{key:"removeAllChildrenExceptTabGuards",value:function(){var e=[this.eTopGuard,this.eBottomGuard];rb(this.getFocusableElement()),this.addTabGuards.apply(this,e)}},{key:"forceFocusOutOfContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tabGuardCtrl.forceFocusOutOfContainer(e)}},{key:"appendChild",value:function(e,t){wb(e)||(e=e.getGui());var r=this.eBottomGuard;r?r.insertAdjacentElement("beforebegin",e):cg(D(n.prototype),"appendChild",this).call(this,e,t)}}]),n}(Zb),LT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},MT=function(e){O(n,e);var t=F(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return T(this,n),(e=t.call(this,'<div class="ag-menu-list" role="tree"></div>')).level=r,e.menuItems=[],e}return A(n,[{key:"postConstruct",value:function(){var e=this;this.initialiseTabGuard({onTabKeyDown:function(t){return e.onTabKeyDown(t)},handleKeyDown:function(t){return e.handleKeyDown(t)}})}},{key:"onTabKeyDown",value:function(e){var t=this.getParentComponent(),n=t&&t.getGui();n&&n.classList.contains("ag-focus-managed")||e.preventDefault(),e.shiftKey&&this.closeIfIsChild(e)}},{key:"handleKeyDown",value:function(e){switch(e.key){case _b.UP:case _b.RIGHT:case _b.DOWN:case _b.LEFT:e.preventDefault(),this.handleNavKey(e.key);break;case _b.ESCAPE:var t=this.findTopMenu();t&&this.focusService.focusInto(t.getGui())}}},{key:"clearActiveItem",value:function(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)}},{key:"addMenuItems",value:function(e){var t=this;null!=e&&e.forEach((function(e){"separator"===e?t.addSeparator():"string"===typeof e?console.warn("AG Grid: unrecognised menu item ".concat(e)):t.addItem(e)}))}},{key:"addItem",value:function(e){var t=this,n=this.createManagedBean(new HT(Object.assign(Object.assign({},e),{isAnotherSubMenuOpen:function(){return t.menuItems.some((function(e){return e.isSubMenuOpen()}))}})));n.setParentComponent(this),Wy(n.getGui(),this.level),this.menuItems.push(n),this.appendChild(n.getGui()),this.addManagedListener(n,HT.EVENT_MENU_ITEM_SELECTED,(function(e){t.dispatchEvent(e)})),this.addManagedListener(n,HT.EVENT_MENU_ITEM_ACTIVATED,(function(e){t.activeMenuItem&&t.activeMenuItem!==e.menuItem&&t.activeMenuItem.deactivate(),t.activeMenuItem=e.menuItem}))}},{key:"activateFirstItem",value:function(){var e=this.menuItems.filter((function(e){return!e.isDisabled()}))[0];e&&e.activate()}},{key:"addSeparator",value:function(){this.appendChild(ab('\n            <div class="ag-menu-separator" aria-hidden="true">\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n            </div>'))}},{key:"findTopMenu",value:function(){var e=this.getParentComponent();if(!e&&this instanceof n)return this;for(;;){var t=e&&e.getParentComponent&&e.getParentComponent();if(!t||!(t instanceof n||t instanceof HT))break;e=t}return e instanceof n?e:void 0}},{key:"handleNavKey",value:function(e){switch(e){case _b.UP:case _b.DOWN:var t=this.findNextItem(e===_b.UP);return void(t&&t!==this.activeMenuItem&&t.activate())}e===(this.gridOptionsService.is("enableRtl")?_b.RIGHT:_b.LEFT)?this.closeIfIsChild():this.openChild()}},{key:"closeIfIsChild",value:function(e){var t=this.getParentComponent();t&&t instanceof HT&&(e&&e.preventDefault(),t.closeSubMenu(),t.getGui().focus())}},{key:"openChild",value:function(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)}},{key:"findNextItem",value:function(e){var t=this.menuItems.filter((function(e){return!e.isDisabled()}));if(t.length){if(!this.activeMenuItem)return e?ym(t):t[0];var n;e&&t.reverse();for(var r=!1,i=0;i<t.length;i++){var o=t[i];if(r){n=o;break}o===this.activeMenuItem&&(r=!0)}return n||this.activeMenuItem}}},{key:"destroy",value:function(){this.clearActiveItem(),cg(D(n.prototype),"destroy",this).call(this)}}]),n}(IT);LT([nm("focusService")],MT.prototype,"focusService",void 0),LT([$g],MT.prototype,"postConstruct",null);var GT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},BT=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).wrappedComponent=e,r.setTemplateFromElement(e.getGui()),r}return A(n,[{key:"postConstruct",value:function(){var e=this;this.initialiseTabGuard({onTabKeyDown:function(t){return e.onTabKeyDown(t)},handleKeyDown:function(t){return e.handleKeyDown(t)}})}},{key:"handleKeyDown",value:function(e){e.key===_b.ESCAPE&&this.closePanel()}},{key:"onTabKeyDown",value:function(e){e.defaultPrevented||(this.closePanel(),e.preventDefault())}},{key:"closePanel",value:function(){var e=this.parentComponent;e.closeSubMenu(),setTimeout((function(){return e.getGui().focus()}),0)}}]),n}(IT);GT([$g],BT.prototype,"postConstruct",null);var jT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},HT=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).params=e,r.isActive=!1,r.subMenuIsOpen=!1,r.setTemplate('<div class="'.concat(r.getClassName(),'" tabindex="-1" role="treeitem"></div>')),r}return A(n,[{key:"init",value:function(){var e=this;this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu(),this.addTooltip();var t=this.getGui();this.params.disabled?(this.addCssClass(this.getClassName("disabled")),zy(t,!0)):(this.addGuiEventListener("click",(function(t){return e.onItemSelected(t)})),this.addGuiEventListener("keydown",(function(t){t.key!==_b.ENTER&&t.key!==_b.SPACE||(t.preventDefault(),e.onItemSelected(t))})),this.addGuiEventListener("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),this.addGuiEventListener("mouseenter",(function(){return e.onMouseEnter()})),this.addGuiEventListener("mouseleave",(function(){return e.onMouseLeave()}))),this.params.cssClasses&&this.params.cssClasses.forEach((function(t){return e.addCssClass(t)}))}},{key:"isDisabled",value:function(){return!!this.params.disabled}},{key:"openSubMenu",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.closeSubMenu(),this.params.subMenu){var r,i=ab('<div class="ag-menu" role="presentation"></div>');if(this.params.subMenu instanceof Array){var o=Ly(this.getGui()),a=isNaN(o)?1:o+1,s=this.createBean(new MT(a));s.setParentComponent(this),s.addMenuItems(this.params.subMenu),i.appendChild(s.getGui()),this.addManagedListener(s,n.EVENT_MENU_ITEM_SELECTED,(function(t){return e.dispatchEvent(t)})),s.addGuiEventListener("mouseenter",(function(){return e.cancelDeactivate()})),r=function(){return e.destroyBean(s)},t&&setTimeout((function(){return s.activateFirstItem()}),0)}else{var l=this.params.subMenu,u=this.createBean(new BT(l));u.setParentComponent(this);var c=u.getGui(),d="mouseenter",h=function(){return e.cancelDeactivate()};c.addEventListener(d,h),r=function(){return c.removeEventListener(d,h)},i.appendChild(c),l.afterGuiAttached&&setTimeout((function(){return l.afterGuiAttached()}),0)}var f=this.getGui(),p=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:f,ePopup:i}),v=this.localeService.getLocaleTextFunc(),g=this.popupService.addPopup({modal:!0,eChild:i,positionCallback:p,anchorToElement:f,ariaLabel:v("ariaLabelSubMenu","SubMenu")});this.subMenuIsOpen=!0,Ky(f,!0),this.hideSubMenu=function(){g&&g.hideFunc(),e.subMenuIsOpen=!1,Ky(f,!1),r()}}}},{key:"closeSubMenu",value:function(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,Ky(this.getGui(),!1))}},{key:"isSubMenuOpen",value:function(){return this.subMenuIsOpen}},{key:"activate",value:function(e){var t=this;this.cancelActivate(),this.params.disabled||(this.isActive=!0,this.addCssClass(this.getClassName("active")),this.getGui().focus(),e&&this.params.subMenu&&window.setTimeout((function(){t.isAlive()&&t.isActive&&t.openSubMenu()}),300),this.onItemActivated())}},{key:"deactivate",value:function(){this.cancelDeactivate(),this.removeCssClass(this.getClassName("active")),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()}},{key:"addIcon",value:function(){if(this.params.checked||this.params.icon||!this.params.isCompact){var e=ab('<span ref="eIcon" class="'.concat(this.getClassName("part")," ").concat(this.getClassName("icon"),'" role="presentation"></span>'));this.params.checked?e.appendChild(Rb("check",this.gridOptionsService)):this.params.icon&&(wb(this.params.icon)?e.appendChild(this.params.icon):"string"===typeof this.params.icon?e.innerHTML=this.params.icon:console.warn("AG Grid: menu item icon must be DOM node or string")),this.getGui().appendChild(e)}}},{key:"addName",value:function(){if(this.params.name||!this.params.isCompact){var e=ab('<span ref="eName" class="'.concat(this.getClassName("part")," ").concat(this.getClassName("text"),'">').concat(this.params.name||"","</span>"));this.getGui().appendChild(e)}}},{key:"addTooltip",value:function(){this.params.tooltip&&(this.tooltip=this.params.tooltip,this.gridOptionsService.is("enableBrowserTooltips")?this.getGui().setAttribute("title",this.tooltip):this.createManagedBean(new qb(this)))}},{key:"getTooltipParams",value:function(){return{location:"menu",value:this.tooltip}}},{key:"addShortcut",value:function(){if(this.params.shortcut||!this.params.isCompact){var e=ab('<span ref="eShortcut" class="'.concat(this.getClassName("part")," ").concat(this.getClassName("shortcut"),'">').concat(this.params.shortcut||"","</span>"));this.getGui().appendChild(e)}}},{key:"addSubMenu",value:function(){if(this.params.subMenu||!this.params.isCompact){var e=ab('<span ref="ePopupPointer" class="'.concat(this.getClassName("part")," ").concat(this.getClassName("popup-pointer"),'"></span>')),t=this.getGui();if(this.params.subMenu){var n=this.gridOptionsService.is("enableRtl")?"smallLeft":"smallRight";Ky(t,!1),e.appendChild(Rb(n,this.gridOptionsService))}t.appendChild(e)}}},{key:"onItemSelected",value:function(e){if(this.params.action?this.params.action():this.openSubMenu(e&&"keydown"===e.type),!this.params.subMenu||this.params.action){var t={type:n.EVENT_MENU_ITEM_SELECTED,action:this.params.action,checked:this.params.checked,cssClasses:this.params.cssClasses,disabled:this.params.disabled,icon:this.params.icon,name:this.params.name,shortcut:this.params.shortcut,subMenu:this.params.subMenu,tooltip:this.params.tooltip,event:e};this.dispatchEvent(t)}}},{key:"onItemActivated",value:function(){var e={type:n.EVENT_MENU_ITEM_ACTIVATED,menuItem:this};this.dispatchEvent(e)}},{key:"cancelActivate",value:function(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)}},{key:"cancelDeactivate",value:function(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)}},{key:"onMouseEnter",value:function(){var e=this;this.cancelDeactivate(),this.params.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout((function(){return e.activate(!0)}),n.ACTIVATION_DELAY):this.activate(!0)}},{key:"onMouseLeave",value:function(){var e=this;this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout((function(){return e.deactivate()}),n.ACTIVATION_DELAY):this.deactivate()}},{key:"getClassName",value:function(e){var t=this.params.isCompact?"ag-compact-menu-option":"ag-menu-option";return e?"".concat(t,"-").concat(e):t}}]),n}(Zb);HT.EVENT_MENU_ITEM_SELECTED="menuItemSelected",HT.EVENT_MENU_ITEM_ACTIVATED="menuItemActivated",HT.ACTIVATION_DELAY=80,jT([nm("popupService")],HT.prototype,"popupService",void 0),jT([$g],HT.prototype,"init",null);var VT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},WT=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this,n.getTemplate(e))).closable=!0,r.config=e,r}return A(n,[{key:"postConstruct",value:function(){var e=this,t=this.config,n=t.component,r=t.closable,i=t.hideTitleBar,o=t.title,a=t.minWidth,s=void 0===a?250:a,l=t.width,u=t.minHeight,c=void 0===u?250:u,d=t.height,h=t.centered,f=t.popup,p=t.x,v=t.y;this.positionableFeature=new cC(this.getGui(),{minWidth:s,width:l,minHeight:c,height:d,centered:h,x:p,y:v,popup:f,calculateTopBuffer:function(){return e.positionableFeature.getHeight()-e.getBodyHeight()}}),this.createManagedBean(this.positionableFeature);var g=this.getGui();n&&this.setBodyComponent(n),i?zw(this.eTitleBar,!1):(o&&this.setTitle(o),this.setClosable(null!=r?r:this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",(function(t){var n=e.gridOptionsService.getDocument();if(g.contains(t.relatedTarget)||g.contains(n.activeElement)||e.eTitleBarButtons.contains(t.target))t.preventDefault();else{var r=e.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");r&&r.focus()}})),f&&this.positionableFeature.isPositioned()||(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")}},{key:"renderComponent",value:function(){var e=this,t=this.getGui();t.focus(),this.close=function(){t.parentElement.removeChild(t),e.destroy()}}},{key:"getHeight",value:function(){return this.positionableFeature.getHeight()}},{key:"setHeight",value:function(e){this.positionableFeature.setHeight(e)}},{key:"getWidth",value:function(){return this.positionableFeature.getWidth()}},{key:"setWidth",value:function(e){this.positionableFeature.setWidth(e)}},{key:"setClosable",value:function(e){if(e!==this.closable&&(this.closable=e),e){var t=this.closeButtonComp=new Zb(n.CLOSE_BTN_TEMPLATE);this.getContext().createBean(t);var r=t.getGui(),i=Rb("close",this.gridOptionsService);i.classList.add("ag-panel-title-bar-button-icon"),r.appendChild(i),this.addTitleBarButton(t),t.addManagedListener(r,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){var o=this.closeButtonComp.getGui();o.parentElement.removeChild(o),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}}},{key:"setBodyComponent",value:function(e){e.setParentComponent(this),this.eContentWrapper.appendChild(e.getGui())}},{key:"addTitleBarButton",value:function(e,t){var n=this.eTitleBarButtons,r=n.children,i=r.length;null==t&&(t=i),t=Math.max(0,Math.min(t,i)),e.addCssClass("ag-panel-title-bar-button");var o=e.getGui();0===t?n.insertAdjacentElement("afterbegin",o):t===i?n.insertAdjacentElement("beforeend",o):r[t-1].insertAdjacentElement("afterend",o),e.setParentComponent(this)}},{key:"getBodyHeight",value:function(){return Yw(this.eContentWrapper)}},{key:"getBodyWidth",value:function(){return Qw(this.eContentWrapper)}},{key:"setTitle",value:function(e){this.eTitle.innerText=e}},{key:"onBtClose",value:function(){this.close()}},{key:"destroy",value:function(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));var e=this.getGui();e&&e.offsetParent&&this.close(),cg(D(n.prototype),"destroy",this).call(this)}}],[{key:"getTemplate",value:function(e){var t=e&&e.cssIdentifier||"default";return'<div class="ag-panel ag-'.concat(t,'-panel" tabindex="-1">\n            <div ref="eTitleBar" class="ag-panel-title-bar ag-').concat(t,'-panel-title-bar ag-unselectable">\n                <span ref="eTitle" class="ag-panel-title-bar-title ag-').concat(t,'-panel-title-bar-title"></span>\n                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-').concat(t,'-panel-title-bar-buttons"></div>\n            </div>\n            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-').concat(t,'-panel-content-wrapper"></div>\n        </div>')}}]),n}(Zb);WT.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>',VT([Jb("eContentWrapper")],WT.prototype,"eContentWrapper",void 0),VT([Jb("eTitleBar")],WT.prototype,"eTitleBar",void 0),VT([Jb("eTitleBarButtons")],WT.prototype,"eTitleBarButtons",void 0),VT([Jb("eTitle")],WT.prototype,"eTitle",void 0),VT([$g],WT.prototype,"postConstruct",null);var zT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},UT=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this,Object.assign(Object.assign({},e),{popup:!0}))).isMaximizable=!1,r.isMaximized=!1,r.maximizeListeners=[],r.resizeListenerDestroy=null,r.lastPosition={x:0,y:0,width:0,height:0},r}return A(n,[{key:"postConstruct",value:function(){var e=this,t=this.getGui(),r=this.config,i=r.movable,o=r.resizable,a=r.maximizable;this.addCssClass("ag-dialog"),cg(D(n.prototype),"postConstruct",this).call(this),this.addManagedListener(t,"focusin",(function(n){t.contains(n.relatedTarget)||e.popupService.bringPopupToFront(t)})),i&&this.setMovable(i),a&&this.setMaximizable(a),o&&this.setResizable(o)}},{key:"renderComponent",value:function(){var e=this.getGui(),t=this.config,n=t.alwaysOnTop,r=t.modal,i=t.title,o=this.localeService.getLocaleTextFunc(),a=this.popupService.addPopup({modal:r,eChild:e,closeOnEsc:!0,closedCallback:this.destroy.bind(this),alwaysOnTop:n,ariaLabel:i||o("ariaLabelDialog","Dialog")});a&&(this.close=a.hideFunc)}},{key:"toggleMaximize",value:function(){var e=this.positionableFeature.getPosition();if(this.isMaximized){var t=this.lastPosition,n=t.x,r=t.y,i=t.width,o=t.height;this.setWidth(i),this.setHeight(o),this.positionableFeature.offsetElement(n,r)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=e.x,this.lastPosition.y=e.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()}},{key:"refreshMaximizeIcon",value:function(){zw(this.maximizeIcon,!this.isMaximized),zw(this.minimizeIcon,this.isMaximized)}},{key:"clearMaximizebleListeners",value:function(){this.maximizeListeners.length&&(this.maximizeListeners.forEach((function(e){return e()})),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)}},{key:"destroy",value:function(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),cg(D(n.prototype),"destroy",this).call(this)}},{key:"setResizable",value:function(e){this.positionableFeature.setResizable(e)}},{key:"setMovable",value:function(e){this.positionableFeature.setMovable(e,this.eTitleBar)}},{key:"setMaximizable",value:function(e){var t=this;if(!e)return this.clearMaximizebleListeners(),void(this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0));var n=this.eTitleBar;if(n&&e!==this.isMaximizable){var r=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),r.addManagedListener(r.getGui(),"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(r,0),this.maximizeListeners.push(this.addManagedListener(n,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",(function(){t.isMaximized=!1,t.refreshMaximizeIcon()}))}}},{key:"buildMaximizeAndMinimizeElements",value:function(){var e=this.maximizeButtonComp=this.createBean(new Zb('<div class="ag-dialog-button"></span>')),t=e.getGui();return this.maximizeIcon=Rb("maximize",this.gridOptionsService),t.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=Rb("minimize",this.gridOptionsService),t.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),e}}]),n}(WT);zT([nm("popupService")],UT.prototype,"popupService",void 0);var KT,qT,XT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal"}(qT||(qT={}));var YT=0,QT=KT=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).popupList=[],e}return A(n,[{key:"postConstruct",value:function(){var e=this;this.ctrlsService.whenReady((function(t){e.gridCtrl=t.gridCtrl,e.addManagedListener(e.gridCtrl,Ym.EVENT_KEYBOARD_FOCUS,(function(){e.popupList.forEach((function(e){return e.element.classList.add(Rx.AG_KEYBOARD_FOCUS)}))})),e.addManagedListener(e.gridCtrl,Ym.EVENT_MOUSE_FOCUS,(function(){e.popupList.forEach((function(e){return e.element.classList.remove(Rx.AG_KEYBOARD_FOCUS)}))}))}))}},{key:"getPopupParent",value:function(){var e=this.gridOptionsService.get("popupParent");return e||this.gridCtrl.getGui()}},{key:"positionPopupForMenu",value:function(e){var t=e.eventSource.getBoundingClientRect(),n=this.getParentRect(),r=this.keepXYWithinBounds(e.ePopup,t.top-n.top,qT.vertical),i=e.ePopup.clientWidth>0?e.ePopup.clientWidth:200;e.ePopup.style.minWidth="".concat(i,"px");var o,a=n.right-n.left-i;function s(){return t.right-n.left-2}function l(){return t.left-n.left-i}this.gridOptionsService.is("enableRtl")?((o=l())<0&&(o=s()),o>a&&(o=0)):((o=s())>a&&(o=l()),o<0&&(o=0)),e.ePopup.style.left="".concat(o,"px"),e.ePopup.style.top="".concat(r,"px")}},{key:"positionPopupUnderMouseEvent",value:function(e){var t=this,n=e.ePopup,r=e.nudgeX,i=e.nudgeY,o=e.skipObserver;this.positionPopup({ePopup:n,nudgeX:r,nudgeY:i,keepWithinBounds:!0,skipObserver:o,updatePosition:function(){return t.calculatePointerAlign(e.mouseEvent)},postProcessCallback:function(){return t.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)}})}},{key:"calculatePointerAlign",value:function(e){var t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}},{key:"positionPopupByComponent",value:function(e){var t=this,n=e.eventSource.getBoundingClientRect(),r=e.alignSide||"left",i=e.position||"over",o=this.getParentRect();this.positionPopup({ePopup:e.ePopup,nudgeX:e.nudgeX,nudgeY:e.nudgeY,keepWithinBounds:e.keepWithinBounds,updatePosition:function(){var t=n.left-o.left;return"right"===r&&(t-=e.ePopup.offsetWidth-n.width),{x:t,y:"over"===i?n.top-o.top:n.top-o.top+n.height}},postProcessCallback:function(){return t.callPostProcessPopup(e.type,e.ePopup,e.eventSource,null,e.column,e.rowNode)}})}},{key:"callPostProcessPopup",value:function(e,t,n,r,i,o){var a=this.gridOptionsService.getCallback("postProcessPopup");a&&a({column:i,rowNode:o,ePopup:t,type:e,eventSource:n,mouseEvent:r})}},{key:"positionPopup",value:function(e){var t=this,n=e.ePopup,r=e.keepWithinBounds,i=e.nudgeX,o=e.nudgeY,a=e.skipObserver,s=e.updatePosition,l={width:0,height:0},u=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],u=s(),c=u.x,d=u.y;a&&n.clientWidth===l.width&&n.clientHeight===l.height||(l.width=n.clientWidth,l.height=n.clientHeight,i&&(c+=i),o&&(d+=o),r&&(c=t.keepXYWithinBounds(n,c,qT.horizontal),d=t.keepXYWithinBounds(n,d,qT.vertical)),n.style.left="".concat(c,"px"),n.style.top="".concat(d,"px"),e.postProcessCallback&&e.postProcessCallback())};if(u(),!a){var c=this.resizeObserverService.observeResize(n,(function(){return u(!0)}));setTimeout((function(){return c()}),KT.WAIT_FOR_POPUP_CONTENT_RESIZE)}}},{key:"getActivePopups",value:function(){return this.popupList.map((function(e){return e.element}))}},{key:"getPopupList",value:function(){return this.popupList}},{key:"getParentRect",value:function(){var e=this.gridOptionsService.getDocument(),t=this.getPopupParent();return t===e.body?t=e.documentElement:"static"===getComputedStyle(t).position&&(t=t.offsetParent),$w(t)}},{key:"keepXYWithinBounds",value:function(e,t,n){var r=n===qT.vertical,i=r?"clientHeight":"clientWidth",o=r?"top":"left",a=r?"offsetHeight":"offsetWidth",s=r?"scrollTop":"scrollLeft",l=this.gridOptionsService.getDocument(),u=l.documentElement,c=this.getPopupParent(),d=c.getBoundingClientRect(),h=l.documentElement.getBoundingClientRect(),f=c===l.body,p=e[a],v=f?(r?Zw:Jw)(u)+u[s]:c[i];f&&(v-=Math.abs(h[o]-d[o]));var g=v-p;return Math.min(Math.max(t,0),Math.abs(g))}},{key:"addPopup",value:function(e){var t=this.gridOptionsService.getDocument(),n=e.eChild,r=e.ariaLabel,i=e.alwaysOnTop,o=e.positionCallback,a=e.anchorToElement;if(!t)return console.warn("AG Grid: could not find the document, document is empty"),{hideFunc:function(){}};var s=this.popupList.findIndex((function(e){return e.element===n}));if(-1!==s)return{hideFunc:this.popupList[s].hideFunc};this.initialisePopupPosition(n);var l=this.createPopupWrapper(n,r,!!i),u=this.addEventListenersToPopup(Object.assign(Object.assign({},e),{wrapperEl:l}));return o&&o(),this.addPopupToPopupList(n,l,u,a),{hideFunc:u}}},{key:"initialisePopupPosition",value:function(e){var t=this.getPopupParent().getBoundingClientRect();fg(e.style.top)||(e.style.top="".concat(-1*t.top,"px")),fg(e.style.left)||(e.style.left="".concat(-1*t.left,"px"))}},{key:"createPopupWrapper",value:function(e,t,n){var r,i=this.getPopupParent(),o=document.createElement("div"),a=this.environment.getTheme().allThemes;a.length&&(r=o.classList).add.apply(r,wt(a));return o.classList.add("ag-popup"),e.classList.add(this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||Fy(e,"dialog"),Gy(e,t),this.focusService.isKeyboardMode()&&e.classList.add(Rx.AG_KEYBOARD_FOCUS),o.appendChild(e),i.appendChild(o),n?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),o}},{key:"addEventListenersToPopup",value:function(e){var t=this,n=this.gridOptionsService.getDocument(),r=this.getPopupParent(),i=e.wrapperEl,o=e.eChild,a=e.click,s=e.closedCallback,l=e.afterGuiAttached,u=e.closeOnEsc,c=e.modal,d=!1,h=function(e){i.contains(n.activeElement)&&(e.key===_b.ESCAPE&&v({keyboardEvent:e}))},f=function(e){return v({mouseEvent:e})},p=function(e){return v({touchEvent:e})},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=e.mouseEvent,u=e.touchEvent,c=e.keyboardEvent;t.isEventFromCurrentPopup({mouseEvent:l,touchEvent:u},o)||t.isEventSameChainAsOriginalEvent({originalMouseEvent:a,mouseEvent:l,touchEvent:u})||d||(d=!0,r.removeChild(i),n.removeEventListener("keydown",h),n.removeEventListener("mousedown",f),n.removeEventListener("touchstart",p),n.removeEventListener("contextmenu",f),t.eventService.removeEventListener(Ym.EVENT_DRAG_STARTED,f),s&&s(l||u||c),t.removePopupFromPopupList(o))};return l&&l({hidePopup:v}),window.setTimeout((function(){u&&n.addEventListener("keydown",h),c&&(n.addEventListener("mousedown",f),t.eventService.addEventListener(Ym.EVENT_DRAG_STARTED,f),n.addEventListener("touchstart",p),n.addEventListener("contextmenu",f))}),0),v}},{key:"addPopupToPopupList",value:function(e,t,n,r){this.popupList.push({element:e,wrapper:t,hideFunc:n,instanceId:YT++,isAnchored:!!r}),r&&this.setPopupPositionRelatedToElement(e,r)}},{key:"setPopupPositionRelatedToElement",value:function(e,t){var n=this.popupList.find((function(t){return t.element===e}));if(n&&(n.stopAnchoringPromise&&n.stopAnchoringPromise.then((function(e){return e&&e()})),n.stopAnchoringPromise=void 0,n.isAnchored=!1,t)){var r=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:n.hideFunc});return n.stopAnchoringPromise=r,n.isAnchored=!0,r}}},{key:"removePopupFromPopupList",value:function(e){this.setPopupPositionRelatedToElement(e,null),this.popupList=this.popupList.filter((function(t){return t.element!==e}))}},{key:"keepPopupPositionedRelativeTo",value:function(e){var t=this,n=this.getPopupParent(),r=n.getBoundingClientRect(),i=e.element,o=e.ePopup,a=i.getBoundingClientRect(),s=r.top-a.top,l=r.left-a.left,u=s,c=l,d=o.style.top,h=parseInt(d.substring(0,d.length-1),10),f=o.style.left,p=parseInt(f.substring(0,f.length-1),10);return new Ub((function(r){t.getFrameworkOverrides().setInterval((function(){var r=n.getBoundingClientRect(),a=i.getBoundingClientRect();if(0==a.top&&0==a.left&&0==a.height&&0==a.width)e.hidePopup();else{var d=r.top-a.top;if(d!=u){var f=t.keepXYWithinBounds(o,h+s-d,qT.vertical);o.style.top="".concat(f,"px")}u=d;var v=r.left-a.left;if(v!=c){var g=t.keepXYWithinBounds(o,p+l-v,qT.horizontal);o.style.left="".concat(g,"px")}c=v}}),200).then((function(e){r((function(){null!=e&&window.clearInterval(e)}))}))}))}},{key:"hasAnchoredPopup",value:function(){return this.popupList.some((function(e){return e.isAnchored}))}},{key:"isEventFromCurrentPopup",value:function(e,t){var n=e.mouseEvent,r=e.touchEvent,i=n||r;if(!i)return!1;var o=this.popupList.findIndex((function(e){return e.element===t}));if(-1===o)return!1;for(var a=o;a<this.popupList.length;a++){if(Lm(this.popupList[a].element,i))return!0}return this.isElementWithinCustomPopup(i.target)}},{key:"isElementWithinCustomPopup",value:function(e){for(var t=this.gridOptionsService.getDocument();e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||null===e.parentElement)return!0;e=e.parentElement}return!1}},{key:"isEventSameChainAsOriginalEvent",value:function(e){var t=e.originalMouseEvent,n=e.mouseEvent,r=e.touchEvent,i=null;if(n?i=n:r&&(i=r.touches[0]),i&&t){var o=n?n.screenX:0,a=n?n.screenY:0,s=Math.abs(t.screenX-o)<5,l=Math.abs(t.screenY-a)<5;if(s&&l)return!0}return!1}},{key:"getWrapper",value:function(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}},{key:"setAlwaysOnTop",value:function(e,t){var n=this.getWrapper(e);n&&(n.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(n))}},{key:"bringPopupToFront",value:function(e){var t=this.getPopupParent(),n=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),r=n.length,i=Array.prototype.slice.call(t.querySelectorAll(".ag-popup.ag-always-on-top")),o=i.length,a=this.getWrapper(e);if(a&&!(r<=1)&&t.contains(e)){var s=n.indexOf(a),l=a.querySelectorAll("div"),u=[];if(l.forEach((function(e){0!==e.scrollTop&&u.push([e,e.scrollTop])})),o)a.classList.contains("ag-always-on-top")?s!==r-1&&ym(i).insertAdjacentElement("afterend",a):s!==r-o-1&&i[0].insertAdjacentElement("beforebegin",a);else s!==r-1&&ym(n).insertAdjacentElement("afterend",a);for(;u.length;){var c=u.pop();c[0].scrollTop=c[1]}var d={type:"popupToFront",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,eWrapper:a};this.eventService.dispatchEvent(d)}}}]),n}(Vm);QT.WAIT_FOR_POPUP_CONTENT_RESIZE=200,XT([nm("focusService")],QT.prototype,"focusService",void 0),XT([nm("ctrlsService")],QT.prototype,"ctrlsService",void 0),XT([nm("resizeObserverService")],QT.prototype,"resizeObserverService",void 0),XT([$g],QT.prototype,"postConstruct",null),QT=KT=XT([tm("popupService")],QT);var ZT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},JT=function(e){O(n,e);var t=F(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"listbox",o=arguments.length>2?arguments[2]:void 0;return T(this,n),(e=t.call(this,n.getTemplate(r))).cssIdentifier=r,e.ariaRole=i,e.listName=o,e.renderedRows=new Map,e.rowHeight=20,e}return A(n,[{key:"postConstruct",value:function(){var e=this;this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:function(t){return e.onFocusIn(t)},onFocusOut:function(t){return e.onFocusOut(t)},focusInnerElement:function(t){return e.focusInnerElement(t)},onTabKeyDown:function(t){return e.onTabKeyDown(t)},handleKeyDown:function(t){return e.handleKeyDown(t)}}),this.setAriaProperties(),this.addManagedListener(this.eventService,Ym.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanged.bind(this))}},{key:"onGridStylesChanged",value:function(){this.rowHeight=this.getItemHeight(),this.refresh()}},{key:"setAriaProperties",value:function(){var e=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),t=this.eContainer;Fy(t,this.ariaRole),Gy(t,e)}},{key:"addResizeObserver",value:function(){var e=this,t=this.resizeObserverService.observeResize(this.getGui(),(function(){return e.drawVirtualRows()}));this.addDestroyFunc(t)}},{key:"focusInnerElement",value:function(e){this.focusRow(e?this.model.getRowCount()-1:0)}},{key:"onFocusIn",value:function(e){var t=e.target;return t.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=My(t)-1),!1}},{key:"onFocusOut",value:function(e){return this.getFocusableElement().contains(e.relatedTarget)||(this.lastFocusedRowIndex=null),!1}},{key:"handleKeyDown",value:function(e){switch(e.key){case _b.UP:case _b.DOWN:this.navigate(e.key===_b.UP)&&e.preventDefault()}}},{key:"onTabKeyDown",value:function(e){this.navigate(e.shiftKey)?e.preventDefault():(Nm(e),this.forceFocusOutOfContainer(e.shiftKey))}},{key:"navigate",value:function(e){if(null==this.lastFocusedRowIndex)return!1;var t=this.lastFocusedRowIndex+(e?-1:1);return!(t<0||t>=this.model.getRowCount())&&(this.focusRow(t),!0)}},{key:"getLastFocusedRow",value:function(){return this.lastFocusedRowIndex}},{key:"focusRow",value:function(e){var t=this;this.ensureIndexVisible(e),window.setTimeout((function(){if(t.isAlive()){var n=t.renderedRows.get(e);n&&n.eDiv.focus()}}),10)}},{key:"getComponentAt",value:function(e){var t=this.renderedRows.get(e);return t&&t.rowComponent}},{key:"forEachRenderedRow",value:function(e){this.renderedRows.forEach((function(t,n){return e(t.rowComponent,n)}))}},{key:"getItemHeight",value:function(){return this.environment.getListItemHeight()}},{key:"ensureIndexVisible",value:function(e){var t=this.model.getRowCount();if("number"!==typeof e||e<0||e>=t)console.warn("AG Grid: invalid row index for ensureIndexVisible: "+e);else{var n=e*this.rowHeight,r=n+this.rowHeight,i=this.getGui(),o=i.scrollTop,a=i.offsetHeight,s=o+a<r;if(o>n)i.scrollTop=n;else if(s){var l=r-a;i.scrollTop=l}}}},{key:"setComponentCreator",value:function(e){this.componentCreator=e}},{key:"setComponentUpdater",value:function(e){this.componentUpdater=e}},{key:"getRowHeight",value:function(){return this.rowHeight}},{key:"getScrollTop",value:function(){return this.getGui().scrollTop}},{key:"setRowHeight",value:function(e){this.rowHeight=e,this.refresh()}},{key:"refresh",value:function(e){var t=this;if(null!=this.model&&this.isAlive()){var n=this.model.getRowCount();this.eContainer.style.height="".concat(n*this.rowHeight,"px"),Kg((function(){return t.eContainer.clientHeight>=n*t.rowHeight}),(function(){t.isAlive()&&(t.canSoftRefresh(e)?t.drawVirtualRows(!0):(t.clearVirtualRows(),t.drawVirtualRows()))}))}}},{key:"canSoftRefresh",value:function(e){return!!(e&&this.renderedRows.size&&"function"===typeof this.model.areRowsEqual&&this.componentUpdater)}},{key:"clearVirtualRows",value:function(){var e=this;this.renderedRows.forEach((function(t,n){return e.removeRow(n)}))}},{key:"drawVirtualRows",value:function(e){if(this.isAlive()){var t=this.getGui(),n=t.scrollTop,r=n+t.offsetHeight,i=Math.floor(n/this.rowHeight),o=Math.floor(r/this.rowHeight);this.ensureRowsRendered(i,o,e)}}},{key:"ensureRowsRendered",value:function(e,t,n){var r=this;this.renderedRows.forEach((function(n,i){(i<e||i>t)&&i!==r.lastFocusedRowIndex&&r.removeRow(i)})),n&&this.refreshRows();for(var i=e;i<=t;i++)this.renderedRows.has(i)||i<this.model.getRowCount()&&this.insertRow(i)}},{key:"insertRow",value:function(e){var t=this,n=this.model.getRow(e),r=document.createElement("div");if(r.classList.add("ag-virtual-list-item","ag-".concat(this.cssIdentifier,"-virtual-list-item")),Fy(r,"tree"===this.ariaRole?"treeitem":"option"),Xy(r,this.model.getRowCount()),Yy(r,e+1),r.setAttribute("tabindex","-1"),"function"===typeof this.model.isRowSelected){var i=this.model.isRowSelected(e);iw(r,!!i),ow(r,i)}r.style.height="".concat(this.rowHeight,"px"),r.style.top="".concat(this.rowHeight*e,"px");var o=this.componentCreator(n,r);o.addGuiEventListener("focusin",(function(){return t.lastFocusedRowIndex=e})),r.appendChild(o.getGui()),this.renderedRows.has(e-1)?this.renderedRows.get(e-1).eDiv.insertAdjacentElement("afterend",r):this.renderedRows.has(e+1)?this.renderedRows.get(e+1).eDiv.insertAdjacentElement("beforebegin",r):this.eContainer.appendChild(r),this.renderedRows.set(e,{rowComponent:o,eDiv:r,value:n})}},{key:"removeRow",value:function(e){var t=this.renderedRows.get(e);this.eContainer.removeChild(t.eDiv),this.destroyBean(t.rowComponent),this.renderedRows.delete(e)}},{key:"refreshRows",value:function(){var e=this,t=this.model.getRowCount();this.renderedRows.forEach((function(n,r){var i,o;if(r>=t)e.removeRow(r);else{var a=e.model.getRow(r);(null===(o=(i=e.model).areRowsEqual)||void 0===o?void 0:o.call(i,n.value,a))?e.componentUpdater(a,n.rowComponent):e.removeRow(r)}}))}},{key:"addScrollListener",value:function(){var e=this;this.addGuiEventListener("scroll",(function(){return e.drawVirtualRows()}),{passive:!0})}},{key:"setModel",value:function(e){this.model=e}},{key:"destroy",value:function(){this.isAlive()&&(this.clearVirtualRows(),cg(D(n.prototype),"destroy",this).call(this))}}],[{key:"getTemplate",value:function(e){return'\n            <div class="ag-virtual-list-viewport ag-'.concat(e,'-virtual-list-viewport" role="presentation">\n                <div class="ag-virtual-list-container ag-').concat(e,'-virtual-list-container" ref="eContainer"></div>\n            </div>')}}]),n}(IT);ZT([nm("resizeObserverService")],JT.prototype,"resizeObserverService",void 0),ZT([Jb("eContainer")],JT.prototype,"eContainer",void 0),ZT([$g],JT.prototype,"postConstruct",null);var $T=["mouseover","mouseout","mouseenter","mouseleave","mousemove"],eR=["touchstart","touchend","touchmove","touchcancel"],tR=function(){function e(){T(this,e),this.renderingEngine="vanilla",this.isOutsideAngular=function(e){return xm($T,e)}}return A(e,[{key:"setTimeout",value:function(e,t){window.setTimeout(e,t)}},{key:"setInterval",value:function(e,t){return new Ub((function(n){n(window.setInterval(e,t))}))}},{key:"addEventListener",value:function(e,t,n,r){var i=xm(eR,t);e.addEventListener(t,n,{capture:!!r,passive:i})}},{key:"dispatchEvent",value:function(e,t){t()}},{key:"frameworkComponent",value:function(e){return null}},{key:"isFrameworkComponent",value:function(e){return!1}}]),e}(),nR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},rR=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"getNextCellToFocus",value:function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}},{key:"getNextCellToFocusWithCtrlPressed",value:function(e,t){var n,r,i=e===_b.UP,o=e===_b.DOWN,a=e===_b.LEFT;if(i||o)r=i?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow(),n=t.column;else{var s=this.columnModel.getAllDisplayedColumns(),l=this.gridOptionsService.is("enableRtl");r=t.rowIndex,n=a!==l?s[0]:ym(s)}return{rowIndex:r,rowPinned:null,column:n}}},{key:"getNextCellToFocusWithoutCtrlPressed",value:function(e,t){for(var n=t,r=!1;!r;){switch(e){case _b.UP:n=this.getCellAbove(n);break;case _b.DOWN:n=this.getCellBelow(n);break;case _b.RIGHT:n=this.gridOptionsService.is("enableRtl")?this.getCellToLeft(n):this.getCellToRight(n);break;case _b.LEFT:n=this.gridOptionsService.is("enableRtl")?this.getCellToRight(n):this.getCellToLeft(n);break;default:n=null,console.warn("AG Grid: unknown key for navigation "+e)}r=!n||this.isCellGoodToFocusOn(n)}return n}},{key:"isCellGoodToFocusOn",value:function(e){var t,n=e.column;switch(e.rowPinned){case"top":t=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case"bottom":t=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:t=this.rowModel.getRow(e.rowIndex)}return!!t&&!n.isSuppressNavigable(t)}},{key:"getCellToLeft",value:function(e){if(!e)return null;var t=this.columnModel.getDisplayedColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}},{key:"getCellToRight",value:function(e){if(!e)return null;var t=this.columnModel.getDisplayedColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}},{key:"getRowBelow",value:function(e){var t=e.rowIndex,n=e.rowPinned;if(this.isLastRowInContainer(e))switch(n){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}var r=this.rowModel.getRow(e.rowIndex),i=this.getNextStickyPosition(r);return i||{rowIndex:t+1,rowPinned:n}}},{key:"getNextStickyPosition",value:function(e,t){if(this.gridOptionsService.isGroupRowsSticky()&&e&&e.sticky){var n=wt(this.rowRenderer.getStickyTopRowCtrls()).sort((function(e,t){return e.getRowNode().rowIndex-t.getRowNode().rowIndex})),r=t?-1:1,i=n.findIndex((function(t){return t.getRowNode().rowIndex===e.rowIndex})),o=n[i+r];return o?{rowIndex:o.getRowNode().rowIndex,rowPinned:null}:void 0}}},{key:"getCellBelow",value:function(e){if(!e)return null;var t=this.getRowBelow(e);return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}},{key:"isLastRowInContainer",value:function(e){var t=e.rowPinned,n=e.rowIndex;return"top"===t?this.pinnedRowModel.getPinnedTopRowData().length-1<=n:"bottom"===t?this.pinnedRowModel.getPinnedBottomRowData().length-1<=n:this.paginationProxy.getPageLastRow()<=n}},{key:"getRowAbove",value:function(e){var t=e.rowIndex,n=e.rowPinned;if(n?0===t:t===this.paginationProxy.getPageFirstRow())return"top"===n?null:n&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;var r=this.rowModel.getRow(e.rowIndex),i=this.getNextStickyPosition(r,!0);return i||{rowIndex:t-1,rowPinned:n}}},{key:"getCellAbove",value:function(e){if(!e)return null;var t=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}},{key:"getLastBodyCell",value:function(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}}},{key:"getLastFloatingTopRow",value:function(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:"top"}}},{key:"getNextTabbedCell",value:function(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}},{key:"getNextTabbedCellForwards",value:function(e){var t=this.columnModel.getAllDisplayedColumns(),n=e.rowIndex,r=e.rowPinned,i=this.columnModel.getDisplayedColAfter(e.column);if(!i){i=t[0];var o=this.getRowBelow(e);if(pg(o))return null;if(!o.rowPinned&&!this.paginationProxy.isRowInPage(o))return null;n=o?o.rowIndex:null,r=o?o.rowPinned:null}return{rowIndex:n,column:i,rowPinned:r}}},{key:"getNextTabbedCellBackwards",value:function(e){var t=this.columnModel.getAllDisplayedColumns(),n=e.rowIndex,r=e.rowPinned,i=this.columnModel.getDisplayedColBefore(e.column);if(!i){i=ym(t);var o=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(pg(o))return null;if(!o.rowPinned&&!this.paginationProxy.isRowInPage(o))return null;n=o?o.rowIndex:null,r=o?o.rowPinned:null}return{rowIndex:n,column:i,rowPinned:r}}}]),n}(Vm);nR([nm("columnModel")],rR.prototype,"columnModel",void 0),nR([nm("rowModel")],rR.prototype,"rowModel",void 0),nR([nm("rowRenderer")],rR.prototype,"rowRenderer",void 0),nR([nm("pinnedRowModel")],rR.prototype,"pinnedRowModel",void 0),nR([nm("paginationProxy")],rR.prototype,"paginationProxy",void 0),rR=nR([tm("cellNavigationService")],rR);var iR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},oR=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).consuming=!1,e}return A(n,[{key:"setBeans",value:function(e){this.logger=e.create("AlignedGridsService")}},{key:"init",value:function(){this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))}},{key:"fireEvent",value:function(e){if(!this.consuming){var t=this.gridOptionsService.get("alignedGrids");t&&t.forEach((function(t){if(t.api){var n=t.api.__getAlignedGridService();e(n)}}))}}},{key:"onEvent",value:function(e){this.consuming=!0,e(),this.consuming=!1}},{key:"fireColumnEvent",value:function(e){this.fireEvent((function(t){t.onColumnEvent(e)}))}},{key:"fireScrollEvent",value:function(e){"horizontal"===e.direction&&this.fireEvent((function(t){t.onScrollEvent(e)}))}},{key:"onScrollEvent",value:function(e){var t=this;this.onEvent((function(){t.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(e.left,!0)}))}},{key:"getMasterColumns",value:function(e){var t=[];return e.columns?e.columns.forEach((function(e){t.push(e)})):e.column&&t.push(e.column),t}},{key:"getColumnIds",value:function(e){var t=[];return e.columns?e.columns.forEach((function(e){t.push(e.getColId())})):e.column&&t.push(e.column.getColId()),t}},{key:"onColumnEvent",value:function(e){var t=this;this.onEvent((function(){switch(e.type){case Ym.EVENT_COLUMN_MOVED:case Ym.EVENT_COLUMN_VISIBLE:case Ym.EVENT_COLUMN_PINNED:case Ym.EVENT_COLUMN_RESIZED:var n=e;t.processColumnEvent(n);break;case Ym.EVENT_COLUMN_GROUP_OPENED:var r=e;t.processGroupOpenedEvent(r);break;case Ym.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}}))}},{key:"processGroupOpenedEvent",value:function(e){var t=e.columnGroup,n=null;if(t){var r=t.getGroupId();n=this.columnModel.getProvidedColumnGroup(r)}t&&!n||(this.logger.log("onColumnEvent-> processing "+e+" expanded = "+t.isExpanded()),this.columnModel.setColumnGroupOpened(n,t.isExpanded(),"alignedGridChanged"))}},{key:"processColumnEvent",value:function(e){var t,n=this,r=e.column,i=null;if(r&&(i=this.columnModel.getPrimaryColumn(r.getColId())),!r||i){var o=this.getMasterColumns(e);switch(e.type){case Ym.EVENT_COLUMN_MOVED:var a=e,s=e.columnApi.getColumnState().map((function(e){return{colId:e.colId}}));this.columnModel.applyColumnState({state:s,applyOrder:!0},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing ".concat(e.type," toIndex = ").concat(a.toIndex));break;case Ym.EVENT_COLUMN_VISIBLE:var l=e,u=e.columnApi.getColumnState().map((function(e){return{colId:e.colId,hide:e.hide}}));this.columnModel.applyColumnState({state:u},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing ".concat(e.type," visible = ").concat(l.visible));break;case Ym.EVENT_COLUMN_PINNED:var c=e,d=e.columnApi.getColumnState().map((function(e){return{colId:e.colId,pinned:e.pinned}}));this.columnModel.applyColumnState({state:d},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing ".concat(e.type," pinned = ").concat(c.pinned));break;case Ym.EVENT_COLUMN_RESIZED:var h=e,f={};o.forEach((function(t){n.logger.log("onColumnEvent-> processing ".concat(e.type," actualWidth = ").concat(t.getActualWidth())),f[t.getId()]={key:t.getColId(),newWidth:t.getActualWidth()}})),null===(t=h.flexColumns)||void 0===t||t.forEach((function(e){f[e.getId()]&&delete f[e.getId()]})),this.columnModel.setColumnWidths(Object.values(f),!1,h.finished,"alignedGridChanged")}var p=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing(),v=this.gridOptionsService.get("alignedGrids");v&&v.forEach((function(e){e.api&&e.api.setAlwaysShowVerticalScroll(p)}))}}}]),n}(Vm);iR([nm("columnModel")],oR.prototype,"columnModel",void 0),iR([nm("ctrlsService")],oR.prototype,"ctrlsService",void 0),iR([function(e,t){return function(n,r){t(n,r,e)}}(0,om("loggerFactory"))],oR.prototype,"setBeans",null),iR([$g],oR.prototype,"init",null),oR=iR([tm("alignedGridsService")],oR);var aR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},sR=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"setBeans",value:function(e){this.logger=e.create("selectionService"),this.reset()}},{key:"init",value:function(){var e=this;this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.addManagedPropertyListener("groupSelectsChildren",(function(t){return e.groupSelectsChildren=t.currentValue})),this.rowSelection=this.gridOptionsService.get("rowSelection"),this.addManagedPropertyListener("rowSelection",(function(t){return e.rowSelection=t.currentValue})),this.addManagedListener(this.eventService,Ym.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))}},{key:"isMultiselect",value:function(){return"multiple"===this.rowSelection}},{key:"setNodesSelected",value:function(e){var t;if(0===e.nodes.length)return 0;var n=e.newValue,r=e.clearSelection,i=e.suppressFinishActions,o=e.rangeSelect,a=(e.event,e.source),s=void 0===a?"api":a;if(e.nodes.length>1&&!this.isMultiselect())return console.warn("AG Grid: cannot multi select while rowSelection='single'"),0;var l=this.groupSelectsChildren&&!0===e.groupSelectsFiltered,u=e.nodes.map((function(e){return e.footer?e.sibling:e}));if(o){if(e.nodes.length>1)return console.warn("AG Grid: cannot range select while selecting multiple rows"),0;var c=this.getLastSelectedNode();if(c){var d=u[0];if(c!==d&&this.isMultiselect()){var h=this.selectRange(d,c,e.newValue,s);return this.setLastSelectedNode(d),h}}}for(var f=0,p=0;p<u.length;p++){var v=u[p];if(!(l&&v.group))v.selectThisNode(n,e.event,s)&&f++;this.groupSelectsChildren&&(null===(t=v.childrenAfterGroup)||void 0===t?void 0:t.length)&&(f+=this.selectChildren(v,n,l,s))}if(!i){if(n&&(r||!this.isMultiselect())&&(f+=this.clearOtherNodes(u[0],s)),f>0){this.updateGroupsFromChildrenSelections(s);var g={type:Ym.EVENT_SELECTION_CHANGED,source:s};this.eventService.dispatchEvent(g)}n&&this.setLastSelectedNode(u[u.length-1])}return f}},{key:"selectRange",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,o=this.rowModel.getNodesInRangeForSelection(e,t),a=0;o.forEach((function(t){t.group&&n.groupSelectsChildren||!1===r&&e===t||t.selectThisNode(r,void 0,i)&&a++})),this.updateGroupsFromChildrenSelections(i);var s={type:Ym.EVENT_SELECTION_CHANGED,source:i};return this.eventService.dispatchEvent(s),a}},{key:"selectChildren",value:function(e,t,n,r){var i=n?e.childrenAfterAggFilter:e.childrenAfterGroup;return Vb.missing(i)?0:this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:n,source:r,nodes:i})}},{key:"setLastSelectedNode",value:function(e){this.lastSelectedNode=e}},{key:"getLastSelectedNode",value:function(){return this.lastSelectedNode}},{key:"getSelectedNodes",value:function(){var e=[];return Sg(this.selectedNodes,(function(t,n){n&&e.push(n)})),e}},{key:"getSelectedRows",value:function(){var e=[];return Sg(this.selectedNodes,(function(t,n){n&&n.data&&e.push(n.data)})),e}},{key:"getSelectionCount",value:function(){return Object.values(this.selectedNodes).length}},{key:"filterFromSelection",value:function(e){var t={};Object.entries(this.selectedNodes).forEach((function(n){var r=Y(n,2),i=r[0],o=r[1];o&&e(o)&&(t[i]=o)})),this.selectedNodes=t}},{key:"updateGroupsFromChildrenSelections",value:function(e,t){if(!this.groupSelectsChildren)return!1;if("clientSide"!==this.rowModel.getType())return!1;var n=this.rowModel.getRootNode();t||(t=new yT(!0,n)).setInactive();var r=!1;return t.forEachChangedNodeDepthFirst((function(t){if(t!==n){var i=t.calculateSelectedFromChildren();r=t.selectThisNode(null!==i&&i,void 0,e)||r}})),r}},{key:"clearOtherNodes",value:function(e,t){var n=this,r={},i=0;return Sg(this.selectedNodes,(function(o,a){if(a&&a.id!==e.id){var s=n.selectedNodes[a.id];i+=s.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:t}),n.groupSelectsChildren&&a.parent&&(r[a.parent.id]=a.parent)}})),Sg(r,(function(e,n){var r=n.calculateSelectedFromChildren();n.selectThisNode(null!==r&&r,void 0,t)})),i}},{key:"onRowSelected",value:function(e){var t=e.node;this.groupSelectsChildren&&t.group||(t.isSelected()?this.selectedNodes[t.id]=t:delete this.selectedNodes[t.id])}},{key:"syncInRowNode",value:function(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}},{key:"syncInOldRowNode",value:function(e,t){if(fg(t)&&e.id!==t.id&&t){var n=t.id;this.selectedNodes[n]==e&&(this.selectedNodes[t.id]=t)}}},{key:"syncInNewRowNode",value:function(e){fg(this.selectedNodes[e.id])?(e.setSelectedInitialValue(!0),this.selectedNodes[e.id]=e):e.setSelectedInitialValue(!1)}},{key:"reset",value:function(){this.logger.log("reset"),this.selectedNodes={},this.lastSelectedNode=null}},{key:"getBestCostNodeSelection",value:function(){if("clientSide"===this.rowModel.getType()){var e=this.rowModel.getTopLevelNodes();if(null!==e){var t=[];return function e(n){for(var r=0,i=n.length;r<i;r++){var o=n[r];if(o.isSelected())t.push(o);else{var a=o;a.group&&a.children&&e(a.children)}}}(e),t}}}},{key:"isEmpty",value:function(){var e=0;return Sg(this.selectedNodes,(function(t,n){n&&e++})),0===e}},{key:"deselectAllRowNodes",value:function(e){var t=function(e){return e.selectThisNode(!1,void 0,r)},n="clientSide"===this.rowModel.getType(),r=e.source,i=e.justFiltered,o=e.justCurrentPage;if(o||i){if(!n)return void console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");this.getNodesToSelect(i,o).forEach(t)}else Sg(this.selectedNodes,(function(e,n){n&&t(n)})),this.reset();n&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(r);var a={type:Ym.EVENT_SELECTION_CHANGED,source:r};this.eventService.dispatchEvent(a)}},{key:"getSelectAllState",value:function(e,t){var n=this,r=0,i=0;return this.getNodesToSelect(e,t).forEach((function(e){n.groupSelectsChildren&&e.group||(e.isSelected()?r++:e.selectable&&i++)})),(0!==r||0!==i)&&(r>0&&i>0?null:r>0)}},{key:"getNodesToSelect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not ".concat(this.rowModel.getType()));var r=[];if(n)return this.paginationProxy.forEachNodeOnPage((function(t){if(t.group)if(t.expanded)e.groupSelectsChildren||r.push(t);else{(function e(t){var n;r.push(t),(null===(n=t.childrenAfterFilter)||void 0===n?void 0:n.length)&&t.childrenAfterFilter.forEach(e)})(t)}else r.push(t)})),r;var i=this.rowModel;return t?(i.forEachNodeAfterFilter((function(e){r.push(e)})),r):(i.forEachNode((function(e){r.push(e)})),r)}},{key:"selectAllRowNodes",value:function(e){if("clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not ".concat(this.rowModel.getType()));var t=e.source,n=e.justFiltered,r=e.justCurrentPage;this.getNodesToSelect(n,r).forEach((function(e){return e.selectThisNode(!0,void 0,t)})),"clientSide"===this.rowModel.getType()&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(t);var i={type:Ym.EVENT_SELECTION_CHANGED,source:t};this.eventService.dispatchEvent(i)}},{key:"getServerSideSelectionState",value:function(){return null}},{key:"setServerSideSelectionState",value:function(e){}}]),n}(Vm);aR([nm("rowModel")],sR.prototype,"rowModel",void 0),aR([nm("paginationProxy")],sR.prototype,"paginationProxy",void 0),aR([function(e,t){return function(n,r){t(n,r,e)}}(0,om("loggerFactory"))],sR.prototype,"setBeans",null),aR([$g],sR.prototype,"init",null),sR=aR([tm("selectionService")],sR);var lR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},uR=function(){function e(){T(this,e)}return A(e,[{key:"sizeColumnsToFit",value:function(e){"undefined"===typeof e&&console.error("AG Grid: missing parameter to columnApi.sizeColumnsToFit(gridWidth)"),this.columnModel.sizeColumnsToFit(e,"api")}},{key:"setColumnGroupOpened",value:function(e,t){this.columnModel.setColumnGroupOpened(e,t,"api")}},{key:"getColumnGroup",value:function(e,t){return this.columnModel.getColumnGroup(e,t)}},{key:"getProvidedColumnGroup",value:function(e){return this.columnModel.getProvidedColumnGroup(e)}},{key:"getDisplayNameForColumn",value:function(e,t){return this.columnModel.getDisplayNameForColumn(e,t)||""}},{key:"getDisplayNameForColumnGroup",value:function(e,t){return this.columnModel.getDisplayNameForColumnGroup(e,t)||""}},{key:"getColumn",value:function(e){return this.columnModel.getPrimaryColumn(e)}},{key:"getColumns",value:function(){return this.columnModel.getAllPrimaryColumns()}},{key:"applyColumnState",value:function(e){return this.columnModel.applyColumnState(e,"api")}},{key:"getColumnState",value:function(){return this.columnModel.getColumnState()}},{key:"resetColumnState",value:function(){this.columnModel.resetColumnState("api")}},{key:"getColumnGroupState",value:function(){return this.columnModel.getColumnGroupState()}},{key:"setColumnGroupState",value:function(e){this.columnModel.setColumnGroupState(e,"api")}},{key:"resetColumnGroupState",value:function(){this.columnModel.resetColumnGroupState("api")}},{key:"isPinning",value:function(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()}},{key:"isPinningLeft",value:function(){return this.columnModel.isPinningLeft()}},{key:"isPinningRight",value:function(){return this.columnModel.isPinningRight()}},{key:"getDisplayedColAfter",value:function(e){return this.columnModel.getDisplayedColAfter(e)}},{key:"getDisplayedColBefore",value:function(e){return this.columnModel.getDisplayedColBefore(e)}},{key:"setColumnVisible",value:function(e,t){this.columnModel.setColumnVisible(e,t,"api")}},{key:"setColumnsVisible",value:function(e,t){this.columnModel.setColumnsVisible(e,t,"api")}},{key:"setColumnPinned",value:function(e,t){this.columnModel.setColumnPinned(e,t,"api")}},{key:"setColumnsPinned",value:function(e,t){this.columnModel.setColumnsPinned(e,t,"api")}},{key:"getAllGridColumns",value:function(){return this.columnModel.getAllGridColumns()}},{key:"getDisplayedLeftColumns",value:function(){return this.columnModel.getDisplayedLeftColumns()}},{key:"getDisplayedCenterColumns",value:function(){return this.columnModel.getDisplayedCenterColumns()}},{key:"getDisplayedRightColumns",value:function(){return this.columnModel.getDisplayedRightColumns()}},{key:"getAllDisplayedColumns",value:function(){return this.columnModel.getAllDisplayedColumns()}},{key:"getAllDisplayedVirtualColumns",value:function(){return this.columnModel.getViewportColumns()}},{key:"moveColumn",value:function(e,t){this.columnModel.moveColumn(e,t,"api")}},{key:"moveColumnByIndex",value:function(e,t){this.columnModel.moveColumnByIndex(e,t,"api")}},{key:"moveColumns",value:function(e,t){this.columnModel.moveColumns(e,t,"api")}},{key:"moveRowGroupColumn",value:function(e,t){this.columnModel.moveRowGroupColumn(e,t)}},{key:"setColumnAggFunc",value:function(e,t){this.columnModel.setColumnAggFunc(e,t)}},{key:"setColumnWidth",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;this.columnModel.setColumnWidths([{key:e,newWidth:t}],!1,n,r)}},{key:"setColumnWidths",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;this.columnModel.setColumnWidths(e,!1,t,n)}},{key:"setPivotMode",value:function(e){this.columnModel.setPivotMode(e)}},{key:"isPivotMode",value:function(){return this.columnModel.isPivotMode()}},{key:"getPivotResultColumn",value:function(e,t){return this.columnModel.getSecondaryPivotColumn(e,t)}},{key:"setValueColumns",value:function(e){this.columnModel.setValueColumns(e,"api")}},{key:"getValueColumns",value:function(){return this.columnModel.getValueColumns()}},{key:"removeValueColumn",value:function(e){this.columnModel.removeValueColumn(e,"api")}},{key:"removeValueColumns",value:function(e){this.columnModel.removeValueColumns(e,"api")}},{key:"addValueColumn",value:function(e){this.columnModel.addValueColumn(e,"api")}},{key:"addValueColumns",value:function(e){this.columnModel.addValueColumns(e,"api")}},{key:"setRowGroupColumns",value:function(e){this.columnModel.setRowGroupColumns(e,"api")}},{key:"removeRowGroupColumn",value:function(e){this.columnModel.removeRowGroupColumn(e,"api")}},{key:"removeRowGroupColumns",value:function(e){this.columnModel.removeRowGroupColumns(e,"api")}},{key:"addRowGroupColumn",value:function(e){this.columnModel.addRowGroupColumn(e,"api")}},{key:"addRowGroupColumns",value:function(e){this.columnModel.addRowGroupColumns(e,"api")}},{key:"getRowGroupColumns",value:function(){return this.columnModel.getRowGroupColumns()}},{key:"setPivotColumns",value:function(e){this.columnModel.setPivotColumns(e,"api")}},{key:"removePivotColumn",value:function(e){this.columnModel.removePivotColumn(e,"api")}},{key:"removePivotColumns",value:function(e){this.columnModel.removePivotColumns(e,"api")}},{key:"addPivotColumn",value:function(e){this.columnModel.addPivotColumn(e,"api")}},{key:"addPivotColumns",value:function(e){this.columnModel.addPivotColumns(e,"api")}},{key:"getPivotColumns",value:function(){return this.columnModel.getPivotColumns()}},{key:"getLeftDisplayedColumnGroups",value:function(){return this.columnModel.getDisplayedTreeLeft()}},{key:"getCenterDisplayedColumnGroups",value:function(){return this.columnModel.getDisplayedTreeCentre()}},{key:"getRightDisplayedColumnGroups",value:function(){return this.columnModel.getDisplayedTreeRight()}},{key:"getAllDisplayedColumnGroups",value:function(){return this.columnModel.getAllDisplayedTrees()}},{key:"autoSizeColumn",value:function(e,t){return this.columnModel.autoSizeColumn(e,t,"api")}},{key:"autoSizeColumns",value:function(e,t){this.columnModel.autoSizeColumns({columns:e,skipHeader:t})}},{key:"autoSizeAllColumns",value:function(e){this.columnModel.autoSizeAllColumns(e,"api")}},{key:"setPivotResultColumns",value:function(e){this.columnModel.setSecondaryColumns(e,"api")}},{key:"getPivotResultColumns",value:function(){return this.columnModel.getSecondaryColumns()}},{key:"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",value:function(){setTimeout(Vb.removeAllReferences.bind(window,this,"Column API"),100)}},{key:"getAllColumns",value:function(){return my("28.0","getAllColumns","getColumns"),this.getColumns()}},{key:"getPrimaryColumns",value:function(){return my("28.0","getPrimaryColumns","getColumns"),this.getColumns()}},{key:"getSecondaryColumns",value:function(){return my("28.0","getSecondaryColumns","getPivotResultColumns"),this.getPivotResultColumns()}},{key:"setSecondaryColumns",value:function(e){my("28.0","setSecondaryColumns","setPivotResultColumns"),this.setPivotResultColumns(e)}},{key:"getSecondaryPivotColumn",value:function(e,t){return my("28.0","getSecondaryPivotColumn","getPivotResultColumn"),this.getPivotResultColumn(e,t)}}]),e}();lR([nm("columnModel")],uR.prototype,"columnModel",void 0),lR([em],uR.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),uR=lR([tm("columnApi")],uR);var cR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},dR=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).initialised=!1,e.isSsrm=!1,e}return A(n,[{key:"init",value:function(){var e=this;this.isSsrm=this.gridOptionsService.isRowModelType("serverSide"),this.cellExpressions=this.gridOptionsService.is("enableCellExpressions"),this.isTreeData=this.gridOptionsService.is("treeData"),this.initialised=!0,this.eventService.addEventListener(Ym.EVENT_CELL_VALUE_CHANGED,(function(t){return e.callColumnCellValueChangedHandler(t)}),this.gridOptionsService.useAsyncEvents()),this.addManagedPropertyListener("treeData",(function(t){return e.isTreeData=t.currentValue}))}},{key:"getValue",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.initialised||this.init(),t){var i,o=e.getColDef(),a=o.field,s=e.getColId(),l=t.data,u=t.groupData&&void 0!==t.groupData[s],c=!r&&t.aggData&&void 0!==t.aggData[s],d=this.isSsrm&&r&&!!e.getColDef().aggFunc,h=this.isSsrm&&t.footer&&t.field&&(!0===e.getColDef().showRowGroup||e.getColDef().showRowGroup===t.field);if(n&&o.filterValueGetter?i=this.executeFilterValueGetter(o.filterValueGetter,l,e,t):this.isTreeData&&c?i=t.aggData[s]:this.isTreeData&&o.valueGetter?i=this.executeValueGetter(o.valueGetter,l,e,t):this.isTreeData&&a&&l?i=Dg(l,a,e.isFieldContainsDots()):u?i=t.groupData[s]:c?i=t.aggData[s]:o.valueGetter?i=this.executeValueGetter(o.valueGetter,l,e,t):h?i=Dg(l,t.field,e.isFieldContainsDots()):a&&l&&!d&&(i=Dg(l,a,e.isFieldContainsDots())),this.cellExpressions&&"string"===typeof i&&0===i.indexOf("=")){var f=i.substring(1);i=this.executeValueGetter(f,l,e,t)}if(null==i){var p=this.getOpenedGroup(t,e);if(null!=p)return p}return i}}},{key:"getOpenedGroup",value:function(e,t){if(this.gridOptionsService.is("showOpenedGroup")&&t.getColDef().showRowGroup)for(var n=t.getColDef().showRowGroup,r=e.parent;null!=r;){if(r.rowGroupColumn&&(!0===n||n===r.rowGroupColumn.getColId()))return r.key;r=r.parent}}},{key:"setValue",value:function(e,t,n,r){var i=this.columnModel.getPrimaryColumn(t);if(!e||!i)return!1;pg(e.data)&&(e.data={});var o=i.getColDef(),a=o.field,s=o.valueSetter;if(pg(a)&&pg(s))return console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work"),!1;if(!this.dataTypeService.checkType(i,n))return console.warn("AG Grid: Data type of the new value does not match the cell data type of the column"),!1;var l,u={node:e,data:e.data,oldValue:this.getValue(i,e),newValue:n,colDef:i.getColDef(),column:i,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};if(u.newValue=n,void 0===(l=fg(s)?"function"===typeof s?s(u):this.expressionService.evaluate(s,u):this.setValueUsingField(e.data,a,n,i.isFieldContainsDots()))&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),u.newValue=this.getValue(i,e);var c={type:Ym.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:u.column,api:u.api,columnApi:u.columnApi,colDef:u.colDef,context:u.context,data:e.data,node:e,oldValue:u.oldValue,newValue:u.newValue,value:u.newValue,source:r};return this.eventService.dispatchEvent(c),!0}},{key:"callColumnCellValueChangedHandler",value:function(e){var t=e.colDef.onCellValueChanged;"function"===typeof t&&t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,columnApi:e.columnApi,context:e.context})}},{key:"setValueUsingField",value:function(e,t,n,r){if(!t)return!1;var i=!1;if(r)for(var o=t.split("."),a=e;o.length>0&&a;){var s=o.shift();0===o.length?(i=a[s]==n)||(a[s]=n):a=a[s]}else(i=e[t]==n)||(e[t]=n);return!i}},{key:"executeFilterValueGetter",value:function(e,t,n,r){var i={data:t,node:r,column:n,colDef:n.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,r)};return"function"===typeof e?e(i):this.expressionService.evaluate(e,i)}},{key:"executeValueGetter",value:function(e,t,n,r){var i=n.getColId(),o=this.valueCache.getValue(r,i);if(void 0!==o)return o;var a,s={data:t,node:r,column:n,colDef:n.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,r)};return a="function"===typeof e?e(s):this.expressionService.evaluate(e,s),this.valueCache.setValue(r,i,a),a}},{key:"getValueCallback",value:function(e,t){var n=this.columnModel.getPrimaryColumn(t);return n?this.getValue(n,e):null}},{key:"getKeyForNode",value:function(e,t){var n=this.getValue(e,t),r=e.getColDef().keyCreator,i=n;r&&(i=r({value:n,colDef:e.getColDef(),column:e,node:t,data:t.data,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}));return"string"===typeof i||null==i||"[object Object]"===(i=String(i))&&Lg((function(){console.warn("AG Grid: a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")}),"getKeyForNode - warn about [object,object]"),i}}]),n}(Vm);cR([nm("expressionService")],dR.prototype,"expressionService",void 0),cR([nm("columnModel")],dR.prototype,"columnModel",void 0),cR([nm("valueCache")],dR.prototype,"valueCache",void 0),cR([nm("dataTypeService")],dR.prototype,"dataTypeService",void 0),cR([$g],dR.prototype,"init",null),dR=cR([tm("valueService")],dR);var hR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},fR=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).expressionToFunctionCache={},e}return A(n,[{key:"setBeans",value:function(e){this.logger=e.create("ExpressionService")}},{key:"evaluate",value:function(e,t){if("string"===typeof e)return this.evaluateExpression(e,t);console.error("AG Grid: value should be either a string or a function",e)}},{key:"evaluateExpression",value:function(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.columnApi,t.getValue,t.column,t.columnGroup)}catch(n){return console.log("Processing of the expression failed"),console.log("Expression = "+e),console.log("Params =",t),console.log("Exception = "+n),null}}},{key:"createExpressionFunction",value:function(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];var t=this.createFunctionBody(e),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",t);return this.expressionToFunctionCache[e]=n,n}},{key:"createFunctionBody",value:function(e){return e.indexOf("return")>=0?e:"return "+e+";"}}]),n}(Vm);hR([function(e,t){return function(n,r){t(n,r,e)}}(0,om("loggerFactory"))],fR.prototype,"setBeans",null),fR=hR([tm("expressionService")],fR);var pR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},vR=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).templateCache={},e.waitingCallbacks={},e}return A(n,[{key:"getTemplate",value:function(e,t){var n=this.templateCache[e];if(n)return n;var r=this.waitingCallbacks[e],i=this;if(!r){r=[],this.waitingCallbacks[e]=r;var o=new XMLHttpRequest;o.onload=function(){i.handleHttpResult(this,e)},o.open("GET",e),o.send()}return t&&r.push(t),null}},{key:"handleHttpResult",value:function(e,t){if(200===e.status&&null!==e.response){this.templateCache[t]=e.response||e.responseText;for(var n=this.waitingCallbacks[t],r=0;r<n.length;r++){(0,n[r])()}}else console.warn("AG Grid: Unable to get template error ".concat(e.status," - ").concat(t))}}]),n}(Vm);vR=pR([tm("templateService")],vR);var gR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},mR=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"setBeans",value:function(e){this.logging=e.is("debug")}},{key:"create",value:function(e){return new yR(e,this.isLogging.bind(this))}},{key:"isLogging",value:function(){return this.logging}}]),n}(Vm);gR([function(e,t){return function(n,r){t(n,r,e)}}(0,om("gridOptionsService"))],mR.prototype,"setBeans",null),mR=gR([tm("loggerFactory")],mR);var yR=function(){function e(t,n){T(this,e),this.name=t,this.isLoggingFunc=n}return A(e,[{key:"isLogging",value:function(){return this.isLoggingFunc()}},{key:"log",value:function(e){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+e)}}]),e}(),wR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},bR=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"setComp",value:function(e,t,n){var r=this;this.view=e,this.eGridHostDiv=t,this.eGui=n,this.eGui.setAttribute("grid-id",this.context.getGridId()),this.dragAndDropService.addDropTarget({getContainer:function(){return r.eGui},isInterestedIn:function(e){return e===CS.HeaderCell||e===CS.ToolPanel},getIconName:function(){return xS.ICON_NOT_ALLOWED}}),this.mouseEventService.stampTopLevelGridCompWithGridInstance(t),this.createManagedBean(new IE(this.view)),this.addRtlSupport(),this.addManagedListener(this,Ym.EVENT_KEYBOARD_FOCUS,(function(){r.view.addOrRemoveKeyboardFocusClass(!0)})),this.addManagedListener(this,Ym.EVENT_MOUSE_FOCUS,(function(){r.view.addOrRemoveKeyboardFocusClass(!1)}));var i=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc((function(){return i()})),this.ctrlsService.registerGridCtrl(this)}},{key:"isDetailGrid",value:function(){var e,t=this.focusService.findTabbableParent(this.getGui());return(null===(e=null===t||void 0===t?void 0:t.getAttribute("row-id"))||void 0===e?void 0:e.startsWith("detail"))||!1}},{key:"showDropZones",value:function(){return Qg.__isRegistered(Xg.RowGroupingModule,this.context.getGridId())}},{key:"showSideBar",value:function(){return Qg.__isRegistered(Xg.SideBarModule,this.context.getGridId())}},{key:"showStatusBar",value:function(){return Qg.__isRegistered(Xg.StatusBarModule,this.context.getGridId())}},{key:"showWatermark",value:function(){return Qg.__isRegistered(Xg.EnterpriseCoreModule,this.context.getGridId())}},{key:"onGridSizeChanged",value:function(){var e={type:Ym.EVENT_GRID_SIZE_CHANGED,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(e)}},{key:"addRtlSupport",value:function(){var e=this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(e)}},{key:"destroyGridUi",value:function(){this.view.destroyGridUi()}},{key:"getGui",value:function(){return this.eGui}},{key:"setResizeCursor",value:function(e){this.view.setCursor(e?"ew-resize":null)}},{key:"disableUserSelect",value:function(e){this.view.setUserSelect(e?"none":null)}},{key:"focusNextInnerContainer",value:function(e){var t=this.gridOptionsService.getDocument(),n=this.view.getFocusableContainers(),r=n.findIndex((function(e){return e.contains(t.activeElement)}))+(e?-1:1);return!(r<=0||r>=n.length)&&this.focusService.focusInto(n[r])}},{key:"focusInnerElement",value:function(e){var t=this.view.getFocusableContainers(),n=this.columnModel.getAllDisplayedColumns();if(e){if(t.length>1)return this.focusService.focusInto(ym(t),!0);var r=ym(n);if(this.focusService.focusGridView(r,!0))return!0}return 0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusGridView(n[0]):this.focusService.focusFirstHeader()}},{key:"forceFocusOutOfContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.view.forceFocusOutOfContainer(e)}}]),n}(Vm);wR([nm("focusService")],bR.prototype,"focusService",void 0),wR([nm("resizeObserverService")],bR.prototype,"resizeObserverService",void 0),wR([nm("columnModel")],bR.prototype,"columnModel",void 0),wR([nm("ctrlsService")],bR.prototype,"ctrlsService",void 0),wR([nm("mouseEventService")],bR.prototype,"mouseEventService",void 0),wR([nm("dragAndDropService")],bR.prototype,"dragAndDropService",void 0);var CR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},SR=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).eGridDiv=e,r}return A(n,[{key:"postConstruct",value:function(){var e=this;this.logger=this.loggerFactory.create("GridComp");var t={destroyGridUi:function(){return e.destroyBean(e)},setRtlClass:function(t){return e.addCssClass(t)},addOrRemoveKeyboardFocusClass:function(t){return e.addOrRemoveCssClass(Rx.AG_KEYBOARD_FOCUS,t)},forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:function(t){e.getGui().style.userSelect=null!=t?t:"",e.getGui().style.webkitUserSelect=null!=t?t:""},setCursor:function(t){e.getGui().style.cursor=null!=t?t:""}};this.ctrl=this.createManagedBean(new bR);var n=this.createTemplate();this.setTemplate(n),this.ctrl.setComp(t,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:function(){},focusInnerElement:function(t){return e.ctrl.focusInnerElement(t)}})}},{key:"insertGridIntoDom",value:function(){var e=this,t=this.getGui();this.eGridDiv.appendChild(t),this.addDestroyFunc((function(){e.eGridDiv.removeChild(t),e.logger.log("Grid removed from DOM")}))}},{key:"updateLayoutClasses",value:function(e,t){var n=this.eRootWrapperBody.classList;n.toggle(PE.AUTO_HEIGHT,t.autoHeight),n.toggle(PE.NORMAL,t.normal),n.toggle(PE.PRINT,t.print),this.addOrRemoveCssClass(PE.AUTO_HEIGHT,t.autoHeight),this.addOrRemoveCssClass(PE.NORMAL,t.normal),this.addOrRemoveCssClass(PE.PRINT,t.print)}},{key:"createTemplate",value:function(){var e=this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":"",t=this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':"",n=this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':"",r=this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":"";return'<div class="ag-root-wrapper" role="presentation">\n                '.concat(e,'\n                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">\n                    <ag-grid-body ref="gridBody"></ag-grid-body>\n                    ').concat(t,"\n                </div>\n                ").concat(n,"\n                <ag-pagination></ag-pagination>\n                ").concat(r,"\n            </div>")}},{key:"getFocusableElement",value:function(){return this.eRootWrapperBody}},{key:"getFocusableContainers",value:function(){var e=[this.gridBodyComp.getGui()];return this.sideBarComp&&e.push(this.sideBarComp.getGui()),e.filter((function(e){return ob(e)}))}}]),n}(IT);CR([nm("loggerFactory")],SR.prototype,"loggerFactory",void 0),CR([Jb("gridBody")],SR.prototype,"gridBodyComp",void 0),CR([Jb("sideBar")],SR.prototype,"sideBarComp",void 0),CR([Jb("rootWrapperBody")],SR.prototype,"eRootWrapperBody",void 0),CR([$g],SR.prototype,"postConstruct",null);var ER,kR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},xR=ER=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"progressSort",value:function(e,t,n){var r=this.getNextSortDirection(e);this.setSortForColumn(e,r,t,n)}},{key:"setSortForColumn",value:function(e,t,n,r){"asc"!==t&&"desc"!==t&&(t=null);var i=[e];if(this.gridOptionsService.isColumnsSortingCoupledToGroup()&&e.getColDef().showRowGroup){var o=this.columnModel.getSourceColumnsForGroupColumn(e),a=null===o||void 0===o?void 0:o.filter((function(e){return e.getColDef().sortable}));a&&(i=[e].concat(wt(a)))}i.forEach((function(e){return e.setSort(t,r)})),(n||this.gridOptionsService.is("alwaysMultiSort"))&&!this.gridOptionsService.is("suppressMultiSort")||this.clearSortBarTheseColumns(i,r),this.updateSortIndex(e),this.dispatchSortChangedEvents(r)}},{key:"updateSortIndex",value:function(e){var t=this.gridOptionsService.isColumnsSortingCoupledToGroup(),n=this.columnModel.getGroupDisplayColumnForGroup(e.getId()),r=t&&n||e,i=this.getColumnsWithSortingOrdered();this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach((function(e){return e.setSortIndex(null)}));var o=i.filter((function(e){return e!==r}));(r.getSort()?[].concat(wt(o),[r]):o).forEach((function(e,t){return e.setSortIndex(t)}))}},{key:"onSortChanged",value:function(e){this.dispatchSortChangedEvents(e)}},{key:"isSortActive",value:function(){var e=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter((function(e){return!!e.getSort()}));return e&&e.length>0}},{key:"dispatchSortChangedEvents",value:function(e){var t={type:Ym.EVENT_SORT_CHANGED,source:e};this.eventService.dispatchEvent(t)}},{key:"clearSortBarTheseColumns",value:function(e,t){this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach((function(n){e.includes(n)||n.setSort(void 0,t)}))}},{key:"getNextSortDirection",value:function(e){var t;if(t=e.getColDef().sortingOrder?e.getColDef().sortingOrder:this.gridOptionsService.get("sortingOrder")?this.gridOptionsService.get("sortingOrder"):ER.DEFAULT_SORTING_ORDER,!Array.isArray(t)||t.length<=0)return console.warn("AG Grid: sortingOrder must be an array with at least one element, currently it's ".concat(t)),null;var n,r=t.indexOf(e.getSort()),i=r<0,o=r==t.length-1;return n=i||o?t[0]:t[r+1],ER.DEFAULT_SORTING_ORDER.indexOf(n)<0?(console.warn("AG Grid: invalid sort type "+n),null):n}},{key:"getIndexedSortMap",value:function(){var e=this,t=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter((function(e){return!!e.getSort()}));if(this.columnModel.isPivotMode()){var n=this.gridOptionsService.isColumnsSortingCoupledToGroup();t=t.filter((function(t){var r=!!t.getAggFunc(),i=!t.isPrimary(),o=n?e.columnModel.getGroupDisplayColumnForGroup(t.getId()):t.getColDef().showRowGroup;return r||i||o}))}var r=this.columnModel.getRowGroupColumns().filter((function(e){return!!e.getSort()})),i=this.gridOptionsService.isColumnsSortingCoupledToGroup()&&!!r.length;i&&(t=wt(new Set(t.map((function(t){var n;return null!==(n=e.columnModel.getGroupDisplayColumnForGroup(t.getId()))&&void 0!==n?n:t})))));var o={};t.forEach((function(e,t){return o[e.getId()]=t})),t.sort((function(e,t){var n=e.getSortIndex(),r=t.getSortIndex();return null!=n&&null!=r?n-r:null==n&&null==r?o[e.getId()]>o[t.getId()]?1:-1:null==r?-1:1}));var a=new Map;return t.forEach((function(e,t){return a.set(e,t)})),i&&r.forEach((function(t){var n=e.columnModel.getGroupDisplayColumnForGroup(t.getId());a.set(t,a.get(n))})),a}},{key:"getColumnsWithSortingOrdered",value:function(){return wt(this.getIndexedSortMap().entries()).sort((function(e,t){var n=Y(e,2),r=(n[0],n[1]),i=Y(t,2);i[0];return r-i[1]})).map((function(e){return Y(e,1)[0]}))}},{key:"getSortModel",value:function(){return this.getColumnsWithSortingOrdered().map((function(e){return{sort:e.getSort(),colId:e.getId()}}))}},{key:"getSortOptions",value:function(){return this.getColumnsWithSortingOrdered().map((function(e){return{sort:e.getSort(),column:e}}))}},{key:"canColumnDisplayMixedSort",value:function(e){var t=this.gridOptionsService.isColumnsSortingCoupledToGroup(),n=!!e.getColDef().showRowGroup;return t&&n}},{key:"getDisplaySortForColumn",value:function(e){var t=this.columnModel.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!(null===t||void 0===t?void 0:t.length))return e.getSort();var n=!!e.getColDef().field?[e].concat(wt(t)):t,r=n[0].getSort();return n.every((function(e){return e.getSort()==r}))?r:"mixed"}},{key:"getDisplaySortIndexForColumn",value:function(e){return this.getIndexedSortMap().get(e)}}]),n}(Vm);xR.DEFAULT_SORTING_ORDER=["asc","desc",null],kR([nm("columnModel")],xR.prototype,"columnModel",void 0),xR=ER=kR([tm("sortController")],xR);var TR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},RR=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"setMouseOver",value:function(e){this.selectedColumns=e;var t={type:Ym.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(t)}},{key:"clearMouseOver",value:function(){this.selectedColumns=null;var e={type:Ym.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(e)}},{key:"isHovered",value:function(e){return!!this.selectedColumns&&this.selectedColumns.indexOf(e)>=0}}]),n}(Vm);RR=TR([tm("columnHoverService")],RR);var AR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},_R=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).executeNextFuncs=[],e.executeLaterFuncs=[],e.active=!1,e.animationThreadCount=0,e}return A(n,[{key:"postConstruct",value:function(){var e=this;this.ctrlsService.whenReady((function(t){return e.gridBodyCtrl=t.gridBodyCtrl}))}},{key:"isActive",value:function(){return this.active}},{key:"start",value:function(){this.active||this.gridOptionsService.is("suppressColumnMoveAnimation")||this.gridOptionsService.is("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)}},{key:"finish",value:function(){this.active&&(this.flush(),this.active=!1)}},{key:"executeNextVMTurn",value:function(e){this.active?this.executeNextFuncs.push(e):e()}},{key:"executeLaterVMTurn",value:function(e){this.active?this.executeLaterFuncs.push(e):e()}},{key:"ensureAnimationCssClassPresent",value:function(){var e=this;this.animationThreadCount++;var t=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push((function(){e.animationThreadCount===t&&e.gridBodyCtrl.setColumnMovingCss(!1)}))}},{key:"flush",value:function(){var e=this.executeNextFuncs;this.executeNextFuncs=[];var t=this.executeLaterFuncs;this.executeLaterFuncs=[],0===e.length&&0===t.length||(window.setTimeout((function(){return e.forEach((function(e){return e()}))}),0),window.setTimeout((function(){return t.forEach((function(e){return e()}))}),300))}}]),n}(Vm);AR([nm("ctrlsService")],_R.prototype,"ctrlsService",void 0),AR([$g],_R.prototype,"postConstruct",null),_R=AR([tm("columnAnimationService")],_R);var OR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},DR=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"postConstruct",value:function(){var e=this;this.ctrlsService.whenReady((function(t){e.centerRowContainerCon=t.centerRowContainerCtrl,e.addManagedListener(e.eventService,Ym.EVENT_BODY_HEIGHT_CHANGED,e.checkPageSize.bind(e)),e.addManagedListener(e.eventService,Ym.EVENT_SCROLL_VISIBILITY_CHANGED,e.checkPageSize.bind(e)),e.checkPageSize()}))}},{key:"notActive",value:function(){return!this.gridOptionsService.is("paginationAutoPageSize")||null==this.centerRowContainerCon}},{key:"checkPageSize",value:function(){var e=this;if(!this.notActive()){var t=this.centerRowContainerCon.getViewportSizeFeature().getBodyHeight();if(t>0){var n=function(){var n=e.gridOptionsService.getRowHeightAsNumber(),r=Math.floor(t/n);e.gridOptionsService.set("paginationPageSize",r)};this.isBodyRendered?zg((function(){return n()}),50)():(n(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}}}]),n}(Vm);OR([nm("ctrlsService")],DR.prototype,"ctrlsService",void 0),OR([$g],DR.prototype,"postConstruct",null),DR=OR([tm("paginationAutoPageSizeService")],DR);var NR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},PR=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).cacheVersion=0,e}return A(n,[{key:"init",value:function(){this.active=this.gridOptionsService.is("valueCache"),this.neverExpires=this.gridOptionsService.is("valueCacheNeverExpires")}},{key:"onDataChanged",value:function(){this.neverExpires||this.expire()}},{key:"expire",value:function(){this.cacheVersion++}},{key:"setValue",value:function(e,t,n){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[t]=n)}},{key:"getValue",value:function(e,t){if(this.active&&e.__cacheVersion===this.cacheVersion)return e.__cacheData[t]}}]),n}(Vm);NR([$g],PR.prototype,"init",null),PR=NR([tm("valueCache")],PR);var FR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},IR=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"init",value:function(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,Ym.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))}},{key:"onCellValueChanged",value:function(e){"paste"!==e.source&&this.doChangeDetection(e.node,e.column)}},{key:"doChangeDetection",value:function(e,t){if(!this.gridOptionsService.is("suppressChangeDetection")){var n=[e];if(this.clientSideRowModel&&!e.isRowPinned()){var r=this.gridOptionsService.is("aggregateOnlyChangedColumns"),i=new yT(r,this.clientSideRowModel.getRootNode());i.addParentNode(e.parent,[t]),this.clientSideRowModel.doAggregate(i),i.forEachChangedNodeDepthFirst((function(e){n.push(e)}))}this.rowRenderer.refreshCells({rowNodes:n})}}}]),n}(Vm);FR([nm("rowModel")],IR.prototype,"rowModel",void 0),FR([nm("rowRenderer")],IR.prototype,"rowRenderer",void 0),FR([$g],IR.prototype,"init",null),IR=FR([tm("changeDetectionService")],IR);var LR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},MR=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"adaptFunction",value:function(e,t){var n=this.componentMetadataProvider.retrieve(e);return n&&n.functionAdapter?n.functionAdapter(t):null}},{key:"adaptCellRendererFunction",value:function(e){var t=function(){function t(){T(this,t)}return A(t,[{key:"refresh",value:function(e){return!1}},{key:"getGui",value:function(){return this.eGui}},{key:"init",value:function(t){var n=e(t),r=typeof n;this.eGui="string"!==r&&"number"!==r&&"boolean"!==r?null!=n?n:ab("<span></span>"):ab("<span>"+n+"</span>")}}]),t}();return t}},{key:"doesImplementIComponent",value:function(e){return!!e&&(e.prototype&&"getGui"in e.prototype)}}]),n}(Vm);LR([nm("componentMetadataProvider")],MR.prototype,"componentMetadataProvider",void 0),MR=LR([tm("agComponentUtils")],MR);var GR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},BR=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"postConstruct",value:function(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[]},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached"]},floatingFilterWrapperComponent:{mandatoryMethodList:[],optionalMethodList:[]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},filterComponent:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]}}}},{key:"retrieve",value:function(e){return this.componentMetaData[e]}}]),n}(Vm);GR([nm("agComponentUtils")],BR.prototype,"agComponentUtils",void 0),GR([$g],BR.prototype,"postConstruct",null),BR=GR([tm("componentMetadataProvider")],BR);var jR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},HR={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:20,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:56,headerCellMinWidth:48,listItemHeight:32,rowHeight:48,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:32,headerCellMinWidth:24,listItemHeight:24,rowHeight:28,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:48,headerCellMinWidth:36,listItemHeight:24,rowHeight:42,chartMenuPanelWidth:240}},VR={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]},WR=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).calculatedSizes={},e}return A(n,[{key:"postConstruct",value:function(){var e,t=this,n=null!==(e=this.getTheme().el)&&void 0!==e?e:this.eGridDiv;this.mutationObserver=new MutationObserver((function(){t.calculatedSizes={},t.fireGridStylesChangedEvent()})),this.mutationObserver.observe(n||this.eGridDiv,{attributes:!0,attributeFilter:["class"]})}},{key:"fireGridStylesChangedEvent",value:function(){var e={type:Ym.EVENT_GRID_STYLES_CHANGED};this.eventService.dispatchEvent(e)}},{key:"getSassVariable",value:function(e){var t=this.getTheme(),n=t.themeFamily,r=t.el;if(n&&0===n.indexOf("ag-theme")){this.calculatedSizes||(this.calculatedSizes={}),this.calculatedSizes[n]||(this.calculatedSizes[n]={});var i=this.calculatedSizes[n][e];return null!=i?i:(this.calculatedSizes[n][e]=this.calculateValueForSassProperty(e,n,r),this.calculatedSizes[n][e])}}},{key:"calculateValueForSassProperty",value:function(e,t,n){var r,i="ag-theme-"+(t.match("material")?"material":t.match("balham")?"balham":t.match("alpine")?"alpine":"custom"),o=HR[i][e],a=this.gridOptionsService.getDocument();if(n||(n=this.eGridDiv),!VR[e])return o;var s=VR[e],l=a.createElement("div"),u=Array.from(n.classList);(r=l.classList).add.apply(r,[t].concat(u)),l.style.position="absolute";var c=s.reduce((function(e,t){var n=a.createElement("div");return n.style.position="static",n.classList.add(t),e.appendChild(n),n}),l),d=0;if(a.body){a.body.appendChild(l);var h=-1!==e.toLowerCase().indexOf("height")?"height":"width";d=parseInt(window.getComputedStyle(c)[h],10),a.body.removeChild(l)}return d||o}},{key:"isThemeDark",value:function(){var e=this.getTheme().theme;return!!e&&e.indexOf("dark")>=0}},{key:"chartMenuPanelWidth",value:function(){return this.getSassVariable("chartMenuPanelWidth")}},{key:"getTheme",value:function(){for(var e=/\bag-(material|(?:theme-([\w\-]*)))\b/g,t=this.eGridDiv,n=null,r=[];t;){if(n=e.exec(t.className)){var i=t.className.match(e);i&&(r=i);break}t=t.parentElement||void 0}if(!n)return{allThemes:r};var o=n[0];return{theme:o,el:t,themeFamily:o.replace(/-dark$/,""),allThemes:r}}},{key:"getFromTheme",value:function(e,t){var n;return null!==(n=this.getSassVariable(t))&&void 0!==n?n:e}},{key:"getDefaultRowHeight",value:function(){return this.getFromTheme(25,"rowHeight")}},{key:"getListItemHeight",value:function(){return this.getFromTheme(20,"listItemHeight")}},{key:"setRowHeightVariable",value:function(e){var t=this.eGridDiv.style.getPropertyValue("--ag-line-height").trim(),n="".concat(e,"px");t!=n&&this.eGridDiv.style.setProperty("--ag-line-height",n)}},{key:"getMinColWidth",value:function(){var e=this.getFromTheme(null,"headerCellMinWidth");return fg(e)?Math.max(e,10):10}},{key:"destroy",value:function(){this.calculatedSizes=null,this.mutationObserver&&this.mutationObserver.disconnect(),cg(D(n.prototype),"destroy",this).call(this)}}]),n}(Vm);jR([nm("eGridDiv")],WR.prototype,"eGridDiv",void 0),jR([$g],WR.prototype,"postConstruct",null),WR=jR([tm("environment")],WR);var zR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},UR=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).scrollY=0,e.uiBodyHeight=0,e}return A(n,[{key:"agWire",value:function(e){this.logger=e.create("RowContainerHeightService")}},{key:"postConstruct",value:function(){this.addManagedListener(this.eventService,Ym.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=kw(),this.logger.log("maxDivHeight = "+this.maxDivHeight)}},{key:"isStretching",value:function(){return this.stretching}},{key:"getDivStretchOffset",value:function(){return this.divStretchOffset}},{key:"updateOffset",value:function(){if(this.stretching){var e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}}},{key:"calculateOffset",value:function(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;var e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;this.logger.log("Div Stretch Offset = ".concat(t," (").concat(this.pixelsToShave," * ").concat(e,")")),this.setDivStretchOffset(t)}},{key:"setUiContainerHeight",value:function(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventService.dispatchEvent({type:Ym.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))}},{key:"clearOffset",value:function(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}},{key:"setDivStretchOffset",value:function(e){var t="number"===typeof e?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventService.dispatchEvent({type:Ym.EVENT_HEIGHT_SCALE_CHANGED}))}},{key:"setModelHeight",value:function(e){this.modelHeight=e,this.stretching=null!=e&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}},{key:"getUiContainerHeight",value:function(){return this.uiContainerHeight}},{key:"getRealPixelPosition",value:function(e){return e-this.divStretchOffset}},{key:"getUiBodyHeight",value:function(){var e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return e.bottom-e.top}},{key:"getScrollPositionForPixel",value:function(e){if(this.pixelsToShave<=0)return e;var t=e/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*t}}]),n}(Vm);zR([nm("ctrlsService")],UR.prototype,"ctrlsService",void 0),zR([function(e,t){return function(n,r){t(n,r,e)}}(0,om("loggerFactory"))],UR.prototype,"agWire",null),zR([$g],UR.prototype,"postConstruct",null),UR=zR([tm("rowContainerHeightService")],UR);var KR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},qR=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"init",value:function(){this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.isRowSelectableFunc=this.gridOptionsService.get("isRowSelectable")}},{key:"updateSelectableAfterGrouping",value:function(e){if(this.isRowSelectableFunc){this.recurseDown(e.childrenAfterGroup,(function(e){return e.childrenAfterGroup}))}}},{key:"recurseDown",value:function(e,t){var n=this;e&&e.forEach((function(e){if(e.group){var r;if(e.hasChildren()&&n.recurseDown(t(e),t),n.groupSelectsChildren)r=fg((t(e)||[]).find((function(e){return!0===e.selectable})));else r=!!n.isRowSelectableFunc&&n.isRowSelectableFunc(e);e.setRowSelectable(r)}}))}}]),n}(Vm);KR([$g],qR.prototype,"init",null),qR=KR([tm("selectableService")],qR);var XR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},YR=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.call(this)).previousAndFirstButtonsDisabled=!1,e.nextButtonDisabled=!1,e.lastButtonDisabled=!1,e.areListenersSetup=!1,e}return A(n,[{key:"postConstruct",value:function(){var e=this.gridOptionsService.is("enableRtl");this.setTemplate(this.getTemplate());var t=this.btFirst,n=this.btPrevious,r=this.btNext,i=this.btLast;this.activateTabIndex([t,n,r,i]),t.insertAdjacentElement("afterbegin",Rb(e?"last":"first",this.gridOptionsService)),n.insertAdjacentElement("afterbegin",Rb(e?"next":"previous",this.gridOptionsService)),r.insertAdjacentElement("afterbegin",Rb(e?"previous":"next",this.gridOptionsService)),i.insertAdjacentElement("afterbegin",Rb(e?"first":"last",this.gridOptionsService)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.onPaginationChanged()}},{key:"onPaginationChanged",value:function(){var e=this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel");this.setDisplayed(e),e&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels())}},{key:"setupListeners",value:function(){var e=this;this.areListenersSetup||(this.addManagedListener(this.eventService,Ym.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach((function(t){var n=t.el,r=t.fn;e.addManagedListener(n,"click",r),e.addManagedListener(n,"keydown",(function(e){e.key!==_b.ENTER&&e.key!==_b.SPACE||(e.preventDefault(),r())}))})),this.areListenersSetup=!0)}},{key:"onBtFirst",value:function(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()}},{key:"setCurrentPageLabel",value:function(){var e=this.paginationProxy.getTotalPages()>0,t=this.paginationProxy.getCurrentPage(),n=e?t+1:0;this.lbCurrent.innerHTML=this.formatNumber(n)}},{key:"formatNumber",value:function(e){var t=this.gridOptionsService.getCallback("paginationNumberFormatter");if(t)return t({value:e});var n=this.localeService.getLocaleTextFunc();return Pw(e,n("thousandSeparator",","),n("decimalSeparator","."))}},{key:"getTemplate",value:function(){var e=this.localeService.getLocaleTextFunc(),t=e("page","Page"),n=e("to","to"),r=e("of","of"),i=e("firstPage","First Page"),o=e("previousPage","Previous Page"),a=e("nextPage","Next Page"),s=e("lastPage","Last Page"),l=this.getCompId();return'<div class="ag-paging-panel ag-unselectable" id="ag-'.concat(l,'">\n                <span class="ag-paging-row-summary-panel" role="status">\n                    <span id="ag-').concat(l,'-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-').concat(l,'-to">').concat(n,'</span>\n                    <span id="ag-').concat(l,'-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-').concat(l,'-of">').concat(r,'</span>\n                    <span id="ag-').concat(l,'-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="').concat(i,'"></div>\n                    <div ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="').concat(o,'"></div>\n                    <span class="ag-paging-description" role="status">\n                        <span id="ag-').concat(l,'-start-page">').concat(t,'</span>\n                        <span id="ag-').concat(l,'-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-').concat(l,'-of-page">').concat(r,'</span>\n                        <span id="ag-').concat(l,'-of-page-number" ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="').concat(a,'"></div>\n                    <div ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="').concat(s,'"></div>\n                </span>\n            </div>')}},{key:"onBtNext",value:function(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()}},{key:"onBtPrevious",value:function(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()}},{key:"onBtLast",value:function(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()}},{key:"enableOrDisableButtons",value:function(){var e=this.paginationProxy.getCurrentPage(),t=this.paginationProxy.isLastPageFound(),n=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=0===e,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);var r=this.isZeroPagesToDisplay(),i=t&&e===n-1;this.nextButtonDisabled=i||r,this.lastButtonDisabled=!t||r||e===n-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}},{key:"toggleButtonDisabled",value:function(e,t){zy(e,t),e.classList.toggle("ag-disabled",t)}},{key:"updateRowLabels",value:function(){var e,t,n=this.paginationProxy.getCurrentPage(),r=this.paginationProxy.getPageSize(),i=this.paginationProxy.isLastPageFound(),o=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;if(this.isZeroPagesToDisplay()?e=t=0:(t=(e=r*n+1)+r-1,i&&t>o&&(t=o)),this.lbFirstRowOnPage.innerHTML=this.formatNumber(e),this.rowNodeBlockLoader.isLoading()){var a=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=a("pageLastRowUnknown","?")}else this.lbLastRowOnPage.innerHTML=this.formatNumber(t)}},{key:"isZeroPagesToDisplay",value:function(){var e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages();return e&&0===t}},{key:"setTotalLabels",value:function(){var e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages(),n=e?this.paginationProxy.getMasterRowCount():null;if(1===n){var r=this.paginationProxy.getRow(0);if(r&&r.group&&!(r.groupData||r.aggData))return void this.setTotalLabelsToZero()}if(e)this.lbTotal.innerHTML=this.formatNumber(t),this.lbRecordCount.innerHTML=this.formatNumber(n);else{var i=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=i,this.lbRecordCount.innerHTML=i}}},{key:"setTotalLabelsToZero",value:function(){this.lbFirstRowOnPage.innerHTML=this.formatNumber(0),this.lbCurrent.innerHTML=this.formatNumber(0),this.lbLastRowOnPage.innerHTML=this.formatNumber(0),this.lbTotal.innerHTML=this.formatNumber(0),this.lbRecordCount.innerHTML=this.formatNumber(0)}}]),n}(Zb);XR([nm("paginationProxy")],YR.prototype,"paginationProxy",void 0),XR([nm("rowNodeBlockLoader")],YR.prototype,"rowNodeBlockLoader",void 0),XR([Jb("btFirst")],YR.prototype,"btFirst",void 0),XR([Jb("btPrevious")],YR.prototype,"btPrevious",void 0),XR([Jb("btNext")],YR.prototype,"btNext",void 0),XR([Jb("btLast")],YR.prototype,"btLast",void 0),XR([Jb("lbRecordCount")],YR.prototype,"lbRecordCount",void 0),XR([Jb("lbFirstRowOnPage")],YR.prototype,"lbFirstRowOnPage",void 0),XR([Jb("lbLastRowOnPage")],YR.prototype,"lbLastRowOnPage",void 0),XR([Jb("lbCurrent")],YR.prototype,"lbCurrent",void 0),XR([Jb("lbTotal")],YR.prototype,"lbTotal",void 0),XR([$g],YR.prototype,"postConstruct",null);var QR,ZR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e[e.Loading=0]="Loading",e[e.NoRows=1]="NoRows"}(QR||(QR={}));var JR=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.call(this,n.TEMPLATE)).inProgress=!1,e.destroyRequested=!1,e.manuallyDisplayed=!1,e}return A(n,[{key:"updateLayoutClasses",value:function(e,t){var n=this.eOverlayWrapper.classList;n.toggle(PE.AUTO_HEIGHT,t.autoHeight),n.toggle(PE.NORMAL,t.normal),n.toggle(PE.PRINT,t.print)}},{key:"postConstruct",value:function(){this.createManagedBean(new IE(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.addManagedListener(this.eventService,Ym.EVENT_ROW_DATA_UPDATED,this.onRowDataUpdated.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.gridOptionsService.isRowModelType("clientSide")&&!this.gridOptionsService.get("rowData")&&this.showLoadingOverlay(),this.gridApi.registerOverlayWrapperComp(this)}},{key:"setWrapperTypeClass",value:function(e){var t=this.eOverlayWrapper.classList;t.toggle("ag-overlay-loading-wrapper",e===QR.Loading),t.toggle("ag-overlay-no-rows-wrapper",e===QR.NoRows)}},{key:"showLoadingOverlay",value:function(){if(!this.gridOptionsService.is("suppressLoadingOverlay")){var e=this.userComponentFactory.getLoadingOverlayCompDetails({}).newAgStackInstance();this.showOverlay(e,QR.Loading)}}},{key:"showNoRowsOverlay",value:function(){if(!this.gridOptionsService.is("suppressNoRowsOverlay")){var e=this.userComponentFactory.getNoRowsOverlayCompDetails({}).newAgStackInstance();this.showOverlay(e,QR.NoRows)}}},{key:"showOverlay",value:function(e,t){var n=this;this.inProgress||(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.inProgress=!0,e&&e.then((function(e){n.inProgress=!1,n.eOverlayWrapper.appendChild(e.getGui()),n.activeOverlay=e,n.destroyRequested&&(n.destroyRequested=!1,n.destroyActiveOverlay())})),this.manuallyDisplayed=this.columnModel.isReady()&&!this.paginationProxy.isEmpty(),this.setDisplayed(!0,{skipAriaHidden:!0}))}},{key:"destroyActiveOverlay",value:function(){this.inProgress?this.destroyRequested=!0:this.activeOverlay&&(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),rb(this.eOverlayWrapper))}},{key:"hideOverlay",value:function(){this.manuallyDisplayed=!1,this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}},{key:"destroy",value:function(){this.destroyActiveOverlay(),cg(D(n.prototype),"destroy",this).call(this)}},{key:"showOrHideOverlay",value:function(){var e=this.paginationProxy.isEmpty(),t=this.gridOptionsService.is("suppressNoRowsOverlay");e&&!t?this.showNoRowsOverlay():this.hideOverlay()}},{key:"onRowDataUpdated",value:function(){this.showOrHideOverlay()}},{key:"onNewColumnsLoaded",value:function(){!this.columnModel.isReady()||this.paginationProxy.isEmpty()||this.manuallyDisplayed||this.hideOverlay()}}]),n}(Zb);JR.TEMPLATE='\n        <div class="ag-overlay" aria-hidden="true">\n            <div class="ag-overlay-panel">\n                <div class="ag-overlay-wrapper" ref="eOverlayWrapper"></div>\n            </div>\n        </div>',ZR([nm("userComponentFactory")],JR.prototype,"userComponentFactory",void 0),ZR([nm("paginationProxy")],JR.prototype,"paginationProxy",void 0),ZR([nm("gridApi")],JR.prototype,"gridApi",void 0),ZR([nm("columnModel")],JR.prototype,"columnModel",void 0),ZR([Jb("eOverlayWrapper")],JR.prototype,"eOverlayWrapper",void 0),ZR([$g],JR.prototype,"postConstruct",null);var $R=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},eA=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"getFirstRow",value:function(){var e,t=0;return this.pinnedRowModel.getPinnedTopRowCount()?e="top":this.rowModel.getRowCount()?(e=null,t=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(e="bottom"),void 0===e?null:{rowIndex:t,rowPinned:e}}},{key:"getLastRow",value:function(){var e,t=null,n=this.pinnedRowModel.getPinnedBottomRowCount(),r=this.pinnedRowModel.getPinnedTopRowCount();return n?(t="bottom",e=n-1):this.rowModel.getRowCount()?(t=null,e=this.paginationProxy.getPageLastRow()):r&&(t="top",e=r-1),void 0===e?null:{rowIndex:e,rowPinned:t}}},{key:"getRowNode",value:function(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}}},{key:"sameRow",value:function(e,t){return!e&&!t||!(e&&!t||!e&&t)&&(e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned)}},{key:"before",value:function(e,t){switch(e.rowPinned){case"top":if("top"!==t.rowPinned)return!0;break;case"bottom":if("bottom"!==t.rowPinned)return!1;break;default:if(fg(t.rowPinned))return"top"!==t.rowPinned}return e.rowIndex<t.rowIndex}},{key:"rowMax",value:function(e){var t,n=this;return e.forEach((function(e){(void 0===t||n.before(t,e))&&(t=e)})),t}},{key:"rowMin",value:function(e){var t,n=this;return e.forEach((function(e){(void 0===t||n.before(e,t))&&(t=e)})),t}}]),n}(Vm);$R([nm("rowModel")],eA.prototype,"rowModel",void 0),$R([nm("pinnedRowModel")],eA.prototype,"pinnedRowModel",void 0),$R([nm("paginationProxy")],eA.prototype,"paginationProxy",void 0),eA=$R([tm("rowPositionUtils")],eA);var tA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},nA=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"createId",value:function(e){var t=e.rowIndex,n=e.rowPinned,r=e.column;return this.createIdFromValues({rowIndex:t,column:r,rowPinned:n})}},{key:"createIdFromValues",value:function(e){var t=e.rowIndex,n=e.rowPinned,r=e.column;return"".concat(t,".").concat(null==n?"null":n,".").concat(r.getId())}},{key:"equals",value:function(e,t){var n=e.column===t.column,r=e.rowPinned===t.rowPinned,i=e.rowIndex===t.rowIndex;return n&&r&&i}}]),n}(Vm);nA=tA([tm("cellPositionUtils")],nA);var rA=A((function e(t){T(this,e),this.cellValueChanges=t})),iA=function(e){O(n,e);var t=F(n);function n(e,r,i,o){var a;return T(this,n),(a=t.call(this,e)).initialRange=r,a.finalRange=i,a.ranges=o,a}return A(n)}(rA),oA=function(){function e(t){T(this,e),this.actionStack=[],this.maxStackSize=t||e.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}return A(e,[{key:"pop",value:function(){return this.actionStack.pop()}},{key:"push",value:function(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}},{key:"clear",value:function(){this.actionStack=[]}},{key:"getCurrentStackSize",value:function(){return this.actionStack.length}}]),e}();oA.DEFAULT_STACK_SIZE=10;var aA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},sA=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).cellValueChanges=[],e.activeCellEdit=null,e.activeRowEdit=null,e.isPasting=!1,e.isRangeInAction=!1,e.onCellValueChanged=function(t){var n={column:t.column,rowIndex:t.rowIndex,rowPinned:t.rowPinned},r=null!==e.activeCellEdit&&e.cellPositionUtils.equals(e.activeCellEdit,n),i=null!==e.activeRowEdit&&e.rowPositionUtils.sameRow(e.activeRowEdit,n);if(r||i||e.isPasting||e.isRangeInAction){var o=t.rowPinned,a=t.rowIndex,s=t.column,l=t.oldValue,u=t.value,c={rowPinned:o,rowIndex:a,columnId:s.getColId(),newValue:u,oldValue:l};e.cellValueChanges.push(c)}},e.clearStacks=function(){e.undoStack.clear(),e.redoStack.clear()},e}return A(n,[{key:"init",value:function(){var e=this;if(this.gridOptionsService.is("undoRedoCellEditing")){var t=this.gridOptionsService.getNum("undoRedoCellEditingLimit");t<=0||(this.undoStack=new oA(t),this.redoStack=new oA(t),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addCellKeyListeners(),this.addManagedListener(this.eventService,Ym.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,Ym.EVENT_MODEL_UPDATED,(function(t){t.keepUndoRedoStack||e.clearStacks()})),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,Ym.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,Ym.EVENT_ROW_DRAG_END,this.clearStacks),this.ctrlsService.whenReady((function(){e.gridBodyCtrl=e.ctrlsService.getGridBodyCtrl()})))}}},{key:"getCurrentUndoStackSize",value:function(){return this.undoStack?this.undoStack.getCurrentStackSize():0}},{key:"getCurrentRedoStackSize",value:function(){return this.redoStack?this.redoStack.getCurrentStackSize():0}},{key:"undo",value:function(e){var t={type:Ym.EVENT_UNDO_STARTED,source:e};this.eventService.dispatchEvent(t);var n=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),r={type:Ym.EVENT_UNDO_ENDED,source:e,operationPerformed:n};this.eventService.dispatchEvent(r)}},{key:"redo",value:function(e){var t={type:Ym.EVENT_REDO_STARTED,source:e};this.eventService.dispatchEvent(t);var n=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),r={type:Ym.EVENT_REDO_ENDED,source:e,operationPerformed:n};this.eventService.dispatchEvent(r)}},{key:"undoRedo",value:function(e,t,n,r,i){if(!e)return!1;var o=e.pop();return!(!o||!o.cellValueChanges)&&(this.processAction(o,(function(e){return e[r]}),i),o instanceof iA?this.processRange(o.ranges||[o[n]]):this.processCell(o.cellValueChanges),t.push(o),!0)}},{key:"processAction",value:function(e,t,n){var r=this;e.cellValueChanges.forEach((function(e){var i=e.rowIndex,o=e.rowPinned,a=e.columnId,s={rowIndex:i,rowPinned:o},l=r.getRowNode(s);l.displayed&&l.setDataValue(a,t(e),n)}))}},{key:"processRange",value:function(e){var t,n=this;this.rangeService.removeAllCellRanges(!0),e.forEach((function(r,i){if(r){var o=r.startRow,a=r.endRow;i===e.length-1&&(t={rowPinned:o.rowPinned,rowIndex:o.rowIndex,columnId:r.startColumn.getColId()},n.setLastFocusedCell(t));var s={rowStartIndex:o.rowIndex,rowStartPinned:o.rowPinned,rowEndIndex:a.rowIndex,rowEndPinned:a.rowPinned,columnStart:r.startColumn,columns:r.columns};n.rangeService.addCellRange(s)}}))}},{key:"processCell",value:function(e){var t=e[0],n={rowIndex:t.rowIndex,rowPinned:t.rowPinned},r=this.getRowNode(n),i={rowPinned:t.rowPinned,rowIndex:r.rowIndex,columnId:t.columnId};this.setLastFocusedCell(i,!!this.rangeService)}},{key:"setLastFocusedCell",value:function(e,t){var n=e.rowIndex,r=e.columnId,i=e.rowPinned,o=this.gridBodyCtrl.getScrollFeature(),a=this.columnModel.getGridColumn(r);if(a){o.ensureIndexVisible(n),o.ensureColumnVisible(a);var s={rowIndex:n,column:a,rowPinned:i};this.focusService.setFocusedCell(Object.assign(Object.assign({},s),{forceBrowserFocus:!0})),t&&this.rangeService.setRangeToCell(s)}}},{key:"addRowEditingListeners",value:function(){var e=this;this.addManagedListener(this.eventService,Ym.EVENT_ROW_EDITING_STARTED,(function(t){e.activeRowEdit={rowIndex:t.rowIndex,rowPinned:t.rowPinned}})),this.addManagedListener(this.eventService,Ym.EVENT_ROW_EDITING_STOPPED,(function(){var t=new rA(e.cellValueChanges);e.pushActionsToUndoStack(t),e.activeRowEdit=null}))}},{key:"addCellEditingListeners",value:function(){var e=this;this.addManagedListener(this.eventService,Ym.EVENT_CELL_EDITING_STARTED,(function(t){e.activeCellEdit={column:t.column,rowIndex:t.rowIndex,rowPinned:t.rowPinned}})),this.addManagedListener(this.eventService,Ym.EVENT_CELL_EDITING_STOPPED,(function(t){if(e.activeCellEdit=null,t.valueChanged&&!e.activeRowEdit&&!e.isPasting&&!e.isRangeInAction){var n=new rA(e.cellValueChanges);e.pushActionsToUndoStack(n)}}))}},{key:"addPasteListeners",value:function(){var e=this;this.addManagedListener(this.eventService,Ym.EVENT_PASTE_START,(function(){e.isPasting=!0})),this.addManagedListener(this.eventService,Ym.EVENT_PASTE_END,(function(){var t=new rA(e.cellValueChanges);e.pushActionsToUndoStack(t),e.isPasting=!1}))}},{key:"addFillListeners",value:function(){var e=this;this.addManagedListener(this.eventService,Ym.EVENT_FILL_START,(function(){e.isRangeInAction=!0})),this.addManagedListener(this.eventService,Ym.EVENT_FILL_END,(function(t){var n=new iA(e.cellValueChanges,t.initialRange,t.finalRange);e.pushActionsToUndoStack(n),e.isRangeInAction=!1}))}},{key:"addCellKeyListeners",value:function(){var e=this;this.addManagedListener(this.eventService,Ym.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,(function(){e.isRangeInAction=!0})),this.addManagedListener(this.eventService,Ym.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,(function(){var t;t=e.rangeService&&e.gridOptionsService.isEnableRangeSelection()?new iA(e.cellValueChanges,void 0,void 0,wt(e.rangeService.getCellRanges())):new rA(e.cellValueChanges),e.pushActionsToUndoStack(t),e.isRangeInAction=!1}))}},{key:"pushActionsToUndoStack",value:function(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}},{key:"getRowNode",value:function(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}}}]),n}(Vm);aA([nm("focusService")],sA.prototype,"focusService",void 0),aA([nm("ctrlsService")],sA.prototype,"ctrlsService",void 0),aA([nm("rowModel")],sA.prototype,"rowModel",void 0),aA([nm("pinnedRowModel")],sA.prototype,"pinnedRowModel",void 0),aA([nm("cellPositionUtils")],sA.prototype,"cellPositionUtils",void 0),aA([nm("rowPositionUtils")],sA.prototype,"rowPositionUtils",void 0),aA([nm("columnModel")],sA.prototype,"columnModel",void 0),aA([rm("rangeService")],sA.prototype,"rangeService",void 0),aA([$g],sA.prototype,"init",null),sA=aA([tm("undoRedoService")],sA);var lA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},uA=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"findHeader",value:function(e,t){var n,r,i;if(e.column instanceof Xm?(r="getDisplayedGroup".concat(t),n=this.columnModel[r](e.column)):(i="getDisplayedCol".concat(t),n=this.columnModel[i](e.column)),n){var o=e.headerRowIndex;if(this.getHeaderRowType(o)===ax.COLUMN_GROUP){var a=n;if(a.isPadding()&&this.isAnyChildSpanningHeaderHeight(a)){var s=this.getColumnVisibleChild(a,o,t),l=s.nextFocusColumn,u=s.nextRow;l&&(n=l,o=u)}}return{column:n,headerRowIndex:o}}}},{key:"isAnyChildSpanningHeaderHeight",value:function(e){return!!e&&e.getLeafColumns().some((function(e){return e.isSpanHeaderHeight()}))}},{key:"getColumnVisibleParent",value:function(e,t){var n=this.getHeaderRowType(t),r=n===ax.FLOATING_FILTER,i=n===ax.COLUMN,o=r?e:e.getParent(),a=t-1;if(i&&this.isAnyChildSpanningHeaderHeight(e.getParent())){for(;o&&o.isPadding();)o=o.getParent(),a--;a<0&&(o=e,a=t)}return{nextFocusColumn:o,nextRow:a}}},{key:"getColumnVisibleChild",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"After",r=e,i=t+1;if(this.getHeaderRowType(t)===ax.COLUMN_GROUP){var o=e.getLeafColumns(),a="After"===n?o[0]:ym(o);if(this.isAnyChildSpanningHeaderHeight(a.getParent())){r=a;for(var s=a.getParent();s&&s!==e;)s=s.getParent(),i++}else r=e.getDisplayedChildren()[0]}return{nextFocusColumn:r,nextRow:i}}},{key:"getHeaderRowType",value:function(e){var t=this.ctrlsService.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}},{key:"findColAtEdgeForHeaderRow",value:function(e,t){var n=this.columnModel.getAllDisplayedColumns(),r=n["start"===t?0:n.length-1];if(r){var i=this.ctrlsService.getHeaderRowContainerCtrl(r.getPinned()).getRowType(e);return i==ax.COLUMN_GROUP?{headerRowIndex:e,column:this.columnModel.getColumnGroupAtLevel(r,e)}:{headerRowIndex:null==i?-1:e,column:r}}}}]),n}(Vm);lA([nm("columnModel")],uA.prototype,"columnModel",void 0),lA([nm("ctrlsService")],uA.prototype,"ctrlsService",void 0),uA=lA([tm("headerPositionUtils")],uA);var cA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},dA=function(){function e(){T(this,e)}return A(e,[{key:"buildColumnDefs",value:function(e,t,n){var r=this,i=[],o={};return e.forEach((function(e){for(var a=!0,s=r.createDefFromColumn(e,t,n),l=e.getOriginalParent(),u=null;l;){var c=null;if(l.isPadding())l=l.getOriginalParent();else{var d=o[l.getGroupId()];if(d){d.children.push(s),a=!1;break}if((c=r.createDefFromGroup(l))&&(c.children=[s],o[c.groupId]=c,s=c,l=l.getOriginalParent()),null!=l&&u===l){a=!1;break}u=l}}a&&i.push(s)})),i}},{key:"createDefFromGroup",value:function(e){var t=kg(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}},{key:"createDefFromColumn",value:function(e,t,n){var r=kg(e.getColDef());return r.colId=e.getColId(),r.width=e.getActualWidth(),r.rowGroup=e.isRowGroupActive(),r.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,r.pivot=e.isPivotActive(),r.pivotIndex=e.isPivotActive()?n.indexOf(e):null,r.aggFunc=e.isValueActive()?e.getAggFunc():null,r.hide=!e.isVisible()||void 0,r.pinned=e.isPinned()?e.getPinned():null,r.sort=e.getSort()?e.getSort():null,r.sortIndex=null!=e.getSortIndex()?e.getSortIndex():null,r}}]),e}();dA=cA([tm("columnDefFactory")],dA);var hA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},fA=function(){function e(){T(this,e)}return A(e,[{key:"getInitialRowClasses",value:function(e){var t=[];return fg(e.extraCssClass)&&t.push(e.extraCssClass),t.push("ag-row"),t.push(e.rowFocused?"ag-row-focus":"ag-row-no-focus"),e.fadeRowIn&&t.push("ag-opacity-zero"),t.push(e.rowIsEven?"ag-row-even":"ag-row-odd"),e.rowNode.isRowPinned()&&t.push("ag-row-pinned"),e.rowNode.isSelected()&&t.push("ag-row-selected"),e.rowNode.footer&&t.push("ag-row-footer"),t.push("ag-row-level-"+e.rowLevel),e.rowNode.stub&&t.push("ag-row-loading"),e.fullWidthRow&&t.push("ag-full-width-row"),e.expandable&&(t.push("ag-row-group"),t.push(e.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),e.rowNode.dragging&&t.push("ag-row-dragging"),Rm(t,this.processClassesFromGridOptions(e.rowNode)),Rm(t,this.preProcessRowClassRules(e.rowNode)),t.push(e.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),e.firstRowOnPage&&t.push("ag-row-first"),e.lastRowOnPage&&t.push("ag-row-last"),e.fullWidthRow&&("left"===e.pinned&&t.push("ag-cell-last-left-pinned"),"right"===e.pinned&&t.push("ag-cell-first-right-pinned")),t}},{key:"processClassesFromGridOptions",value:function(e){var t=[],n=function(e){"string"===typeof e?t.push(e):Array.isArray(e)&&e.forEach((function(e){return t.push(e)}))},r=this.gridOptionsService.get("rowClass");if(r){if("function"===typeof r)return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];n(r)}var i=this.gridOptionsService.getCallback("getRowClass");i&&n(i({data:e.data,node:e,rowIndex:e.rowIndex}));return t}},{key:"preProcessRowClassRules",value:function(e){var t=[];return this.processRowClassRules(e,(function(e){t.push(e)}),(function(e){})),t}},{key:"processRowClassRules",value:function(e,t,n){var r={data:e.data,node:e,rowIndex:e.rowIndex,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};this.stylingService.processClassRules(this.gridOptionsService.get("rowClassRules"),r,t,n)}},{key:"calculateRowLevel",value:function(e){return e.group?e.level:e.parent?e.parent.level+1:0}}]),e}();hA([nm("stylingService")],fA.prototype,"stylingService",void 0),hA([nm("gridOptionsService")],fA.prototype,"gridOptionsService",void 0),fA=hA([tm("rowCssClassCalculator")],fA);var pA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},vA=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"init",value:function(){var e=this;this.isAccentedSort=this.gridOptionsService.is("accentedSort"),this.primaryColumnsSortGroups=this.gridOptionsService.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",(function(t){return e.isAccentedSort=t.currentValue})),this.addManagedPropertyListener("autoGroupColumnDef",(function(){return e.primaryColumnsSortGroups=e.gridOptionsService.isColumnsSortingCoupledToGroup()}))}},{key:"doFullSort",value:function(e,t){var n=e.map((function(e,t){return{currentPos:t,rowNode:e}}));return n.sort(this.compareRowNodes.bind(this,t)),n.map((function(e){return e.rowNode}))}},{key:"compareRowNodes",value:function(e,t,n){for(var r=t.rowNode,i=n.rowNode,o=0,a=e.length;o<a;o++){var s=e[o],l="desc"===s.sort,u=this.getValue(r,s.column),c=this.getValue(i,s.column),d=void 0,h=this.getComparator(s,r);if(d=h?h(u,c,r,i,l):Vb.defaultComparator(u,c,this.isAccentedSort),!isNaN(d)&&0!==d)return"asc"===s.sort?d:-1*d}return t.currentPos-n.currentPos}},{key:"getComparator",value:function(e,t){var n=e.column,r=n.getColDef().comparator;if(null!=r)return r;if(n.getColDef().showRowGroup){var i=!t.group&&n.getColDef().field;if(i){var o=this.columnModel.getPrimaryColumn(i);if(o)return o.getColDef().comparator}}}},{key:"getValue",value:function(e,t){var n,r;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(t,e,!1,!1);if(e.rowGroupColumn===t){if(this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotActive())){if(t.getColDef().keyCreator)return e.key;var i=null===(n=e.allLeafChildren)||void 0===n?void 0:n[0];return i?this.valueService.getValue(t,i,!1,!1):void 0}var o=this.columnModel.getGroupDisplayColumnForGroup(t.getId());if(!o)return;return null===(r=e.groupData)||void 0===r?void 0:r[o.getId()]}return e.group&&t.getColDef().showRowGroup?void 0:this.valueService.getValue(t,e,!1,!1)}}]),n}(Vm);pA([nm("valueService")],vA.prototype,"valueService",void 0),pA([nm("columnModel")],vA.prototype,"columnModel",void 0),pA([$g],vA.prototype,"init",null),vA=pA([tm("rowNodeSorter")],vA);var gA,mA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},yA=gA=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).ready=!1,e.readyCallbacks=[],e}return A(n,[{key:"checkReady",value:function(){if(this.ready=null!=this.gridCtrl&&null!=this.gridBodyCtrl&&null!=this.centerRowContainerCtrl&&null!=this.leftRowContainerCtrl&&null!=this.rightRowContainerCtrl&&null!=this.bottomCenterRowContainerCtrl&&null!=this.bottomLeftRowContainerCtrl&&null!=this.bottomRightRowContainerCtrl&&null!=this.topCenterRowContainerCtrl&&null!=this.topLeftRowContainerCtrl&&null!=this.topRightRowContainerCtrl&&null!=this.stickyTopCenterRowContainerCtrl&&null!=this.stickyTopLeftRowContainerCtrl&&null!=this.stickyTopRightRowContainerCtrl&&null!=this.centerHeaderRowContainerCtrl&&null!=this.leftHeaderRowContainerCtrl&&null!=this.rightHeaderRowContainerCtrl&&null!=this.fakeHScrollComp&&null!=this.fakeVScrollComp&&null!=this.gridHeaderCtrl,this.ready){var e=this.createReadyParams();this.readyCallbacks.forEach((function(t){return t(e)})),this.readyCallbacks.length=0}}},{key:"whenReady",value:function(e){this.ready?e(this.createReadyParams()):this.readyCallbacks.push(e)}},{key:"createReadyParams",value:function(){return{centerRowContainerCtrl:this.centerRowContainerCtrl,leftRowContainerCtrl:this.leftRowContainerCtrl,rightRowContainerCtrl:this.rightRowContainerCtrl,bottomCenterRowContainerCtrl:this.bottomCenterRowContainerCtrl,bottomLeftRowContainerCtrl:this.bottomLeftRowContainerCtrl,bottomRightRowContainerCtrl:this.bottomRightRowContainerCtrl,topCenterRowContainerCtrl:this.topCenterRowContainerCtrl,topLeftRowContainerCtrl:this.topLeftRowContainerCtrl,topRightRowContainerCtrl:this.topRightRowContainerCtrl,stickyTopCenterRowContainerCtrl:this.stickyTopCenterRowContainerCtrl,stickyTopLeftRowContainerCtrl:this.stickyTopLeftRowContainerCtrl,stickyTopRightRowContainerCtrl:this.stickyTopRightRowContainerCtrl,centerHeaderRowContainerCtrl:this.centerHeaderRowContainerCtrl,leftHeaderRowContainerCtrl:this.leftHeaderRowContainerCtrl,rightHeaderRowContainerCtrl:this.rightHeaderRowContainerCtrl,fakeHScrollComp:this.fakeHScrollComp,fakeVScrollComp:this.fakeVScrollComp,gridBodyCtrl:this.gridBodyCtrl,gridCtrl:this.gridCtrl,gridHeaderCtrl:this.gridHeaderCtrl}}},{key:"registerFakeHScrollComp",value:function(e){this.fakeHScrollComp=e,this.checkReady()}},{key:"registerFakeVScrollComp",value:function(e){this.fakeVScrollComp=e,this.checkReady()}},{key:"registerGridHeaderCtrl",value:function(e){this.gridHeaderCtrl=e,this.checkReady()}},{key:"registerCenterRowContainerCtrl",value:function(e){this.centerRowContainerCtrl=e,this.checkReady()}},{key:"registerLeftRowContainerCtrl",value:function(e){this.leftRowContainerCtrl=e,this.checkReady()}},{key:"registerRightRowContainerCtrl",value:function(e){this.rightRowContainerCtrl=e,this.checkReady()}},{key:"registerTopCenterRowContainerCtrl",value:function(e){this.topCenterRowContainerCtrl=e,this.checkReady()}},{key:"registerTopLeftRowContainerCon",value:function(e){this.topLeftRowContainerCtrl=e,this.checkReady()}},{key:"registerTopRightRowContainerCtrl",value:function(e){this.topRightRowContainerCtrl=e,this.checkReady()}},{key:"registerStickyTopCenterRowContainerCtrl",value:function(e){this.stickyTopCenterRowContainerCtrl=e,this.checkReady()}},{key:"registerStickyTopLeftRowContainerCon",value:function(e){this.stickyTopLeftRowContainerCtrl=e,this.checkReady()}},{key:"registerStickyTopRightRowContainerCtrl",value:function(e){this.stickyTopRightRowContainerCtrl=e,this.checkReady()}},{key:"registerBottomCenterRowContainerCtrl",value:function(e){this.bottomCenterRowContainerCtrl=e,this.checkReady()}},{key:"registerBottomLeftRowContainerCtrl",value:function(e){this.bottomLeftRowContainerCtrl=e,this.checkReady()}},{key:"registerBottomRightRowContainerCtrl",value:function(e){this.bottomRightRowContainerCtrl=e,this.checkReady()}},{key:"registerHeaderContainer",value:function(e,t){switch(t){case"left":this.leftHeaderRowContainerCtrl=e;break;case"right":this.rightHeaderRowContainerCtrl=e;break;default:this.centerHeaderRowContainerCtrl=e}this.checkReady()}},{key:"registerGridBodyCtrl",value:function(e){this.gridBodyCtrl=e,this.checkReady()}},{key:"registerGridCtrl",value:function(e){this.gridCtrl=e,this.checkReady()}},{key:"getFakeHScrollComp",value:function(){return this.fakeHScrollComp}},{key:"getFakeVScrollComp",value:function(){return this.fakeVScrollComp}},{key:"getGridHeaderCtrl",value:function(){return this.gridHeaderCtrl}},{key:"getGridCtrl",value:function(){return this.gridCtrl}},{key:"getCenterRowContainerCtrl",value:function(){return this.centerRowContainerCtrl}},{key:"getTopCenterRowContainerCtrl",value:function(){return this.topCenterRowContainerCtrl}},{key:"getBottomCenterRowContainerCtrl",value:function(){return this.bottomCenterRowContainerCtrl}},{key:"getStickyTopCenterRowContainerCtrl",value:function(){return this.stickyTopCenterRowContainerCtrl}},{key:"getGridBodyCtrl",value:function(){return this.gridBodyCtrl}},{key:"getHeaderRowContainerCtrls",value:function(){return[this.leftHeaderRowContainerCtrl,this.rightHeaderRowContainerCtrl,this.centerHeaderRowContainerCtrl]}},{key:"getHeaderRowContainerCtrl",value:function(e){switch(e){case"left":return this.leftHeaderRowContainerCtrl;case"right":return this.rightHeaderRowContainerCtrl;default:return this.centerHeaderRowContainerCtrl}}}]),n}(Vm);yA.NAME="ctrlsService",yA=gA=mA([tm(gA.NAME)],yA);var wA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},bA=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).registry={},e}return A(n,[{key:"register",value:function(e){this.registry[e.controllerName]=e.controllerClass}},{key:"getInstance",value:function(e){var t=this.registry[e];if(null!=t)return new t}}]),n}(Vm);bA=wA([tm("ctrlsFactory")],bA);var CA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},SA=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this,e)).direction=r,i.hideTimeout=null,i}return A(n,[{key:"postConstruct",value:function(){this.addManagedListener(this.eventService,Ym.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",bw()||Cw())}},{key:"initialiseInvisibleScrollbar",value:function(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=_w(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}},{key:"addActiveListenerToggles",value:function(){var e=this,t=this.getGui();["mouseenter","mousedown","touchstart"].forEach((function(n){return e.addManagedListener(t,n,(function(){return e.addOrRemoveCssClass("ag-scrollbar-active",!0)}))})),["mouseleave","touchend"].forEach((function(n){return e.addManagedListener(t,n,(function(){return e.addOrRemoveCssClass("ag-scrollbar-active",!1)}))}))}},{key:"onScrollVisibilityChanged",value:function(){var e=this;void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame((function(){return e.setScrollVisible()}))}},{key:"hideAndShowInvisibleScrollAsNeeded",value:function(){var e=this;this.addManagedListener(this.eventService,Ym.EVENT_BODY_SCROLL,(function(t){t.direction===e.direction&&(null!==e.hideTimeout&&(window.clearTimeout(e.hideTimeout),e.hideTimeout=null),e.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))})),this.addManagedListener(this.eventService,Ym.EVENT_BODY_SCROLL_END,(function(){e.hideTimeout=window.setTimeout((function(){e.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),e.hideTimeout=null}),400)}))}},{key:"attemptSettingScrollPosition",value:function(e){var t=this,n=this.getViewport();Kg((function(){return ob(n)}),(function(){return t.setScrollPosition(e)}),100)}},{key:"getViewport",value:function(){return this.eViewport}},{key:"getContainer",value:function(){return this.eContainer}},{key:"onScrollCallback",value:function(e){this.addManagedListener(this.getViewport(),"scroll",e)}}]),n}(Zb);CA([Jb("eViewport")],SA.prototype,"eViewport",void 0),CA([Jb("eContainer")],SA.prototype,"eContainer",void 0),CA([nm("scrollVisibleService")],SA.prototype,"scrollVisibleService",void 0),CA([nm("ctrlsService")],SA.prototype,"ctrlsService",void 0),CA([nm("animationFrameService")],SA.prototype,"animationFrameService",void 0);var EA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},kA=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,n.TEMPLATE,"horizontal")}return A(n,[{key:"postConstruct",value:function(){var e=this;cg(D(n.prototype),"postConstruct",this).call(this);var t=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,t),this.addManagedListener(this.eventService,Ym.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedPropertyListener("domLayout",t),this.ctrlsService.registerFakeHScrollComp(this),this.createManagedBean(new kk((function(t){return e.eContainer.style.width="".concat(t,"px")})))}},{key:"initialiseInvisibleScrollbar",value:function(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gridOptionsService.is("enableRtl"),cg(D(n.prototype),"initialiseInvisibleScrollbar",this).call(this),this.invisibleScrollbar&&this.refreshCompBottom())}},{key:"onPinnedRowDataChanged",value:function(){this.refreshCompBottom()}},{key:"refreshCompBottom",value:function(){if(this.invisibleScrollbar){var e=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom="".concat(e,"px")}}},{key:"onScrollVisibilityChanged",value:function(){cg(D(n.prototype),"onScrollVisibilityChanged",this).call(this),this.setFakeHScrollSpacerWidths()}},{key:"setFakeHScrollSpacerWidths",value:function(){var e=this.scrollVisibleService.isVerticalScrollShowing(),t=this.columnModel.getDisplayedColumnsRightWidth(),n=!this.enableRtl&&e,r=this.gridOptionsService.getScrollbarWidth();n&&(t+=r),gb(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=r);var i=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&e&&(i+=r),gb(this.eLeftSpacer,i),this.eLeftSpacer.classList.toggle("ag-scroller-corner",i<=r)}},{key:"setScrollVisible",value:function(){var e=this.scrollVisibleService.isHorizontalScrollShowing(),t=this.invisibleScrollbar,n=this.gridOptionsService.is("suppressHorizontalScroll"),r=e&&this.gridOptionsService.getScrollbarWidth()||0,i=n?0:0===r&&t?16:r;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),mb(this.getGui(),i),mb(this.eViewport,i),mb(this.eContainer,i),this.setDisplayed(e,{skipAriaHidden:!0})}},{key:"getScrollPosition",value:function(){return tb(this.getViewport(),this.enableRtl)}},{key:"setScrollPosition",value:function(e){ob(this.getViewport())||this.attemptSettingScrollPosition(e),nb(this.getViewport(),e,this.enableRtl)}}]),n}(SA);kA.TEMPLATE='<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>\n        </div>',EA([Jb("eLeftSpacer")],kA.prototype,"eLeftSpacer",void 0),EA([Jb("eRightSpacer")],kA.prototype,"eRightSpacer",void 0),EA([nm("columnModel")],kA.prototype,"columnModel",void 0),EA([nm("pinnedRowModel")],kA.prototype,"pinnedRowModel",void 0),EA([$g],kA.prototype,"postConstruct",null);var xA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},TA=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"postConstruct",value:function(){var e=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,Ym.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedPropertyListener("domLayout",e)}},{key:"checkContainerWidths",value:function(){var e=this.gridOptionsService.isDomLayout("print"),t=e?0:this.columnModel.getDisplayedColumnsLeftWidth(),n=e?0:this.columnModel.getDisplayedColumnsRightWidth();t!=this.leftWidth&&(this.leftWidth=t,this.eventService.dispatchEvent({type:Ym.EVENT_LEFT_PINNED_WIDTH_CHANGED})),n!=this.rightWidth&&(this.rightWidth=n,this.eventService.dispatchEvent({type:Ym.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))}},{key:"getPinnedRightWidth",value:function(){return this.rightWidth}},{key:"getPinnedLeftWidth",value:function(){return this.leftWidth}}]),n}(Vm);xA([nm("columnModel")],TA.prototype,"columnModel",void 0),xA([$g],TA.prototype,"postConstruct",null),TA=xA([tm("pinnedWidthService")],TA);var RA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},AA=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).events=[],e}return A(n,[{key:"postConstruct",value:function(){"clientSide"==this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)}},{key:"dispatchExpanded",value:function(e){var t=this;if(null!=this.clientSideRowModel){this.events.push(e);null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce((function(){t.clientSideRowModel&&t.clientSideRowModel.onRowGroupOpened(),t.events.forEach((function(e){return t.eventService.dispatchEvent(e)})),t.events=[]}))),this.dispatchExpandedDebounced()}else this.eventService.dispatchEvent(e)}}]),n}(Vm);RA([nm("animationFrameService")],AA.prototype,"animationFrameService",void 0),RA([nm("rowModel")],AA.prototype,"rowModel",void 0),RA([$g],AA.prototype,"postConstruct",null),AA=RA([tm("rowNodeEventThrottle")],AA);var _A=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},OA=function(e,t){return function(n,r){t(n,r,e)}};function DA(e){return!0===e||"true"===e}var NA=function(){function e(){T(this,e),this.destroyed=!1,this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new um}return A(e,[{key:"context",get:function(){return this.gridOptions.context}},{key:"agWire",value:function(e,t){this.gridOptions.api=e,this.gridOptions.columnApi=t,this.api=e,this.columnApi=t}},{key:"init",value:function(){this.gridOptionLookup=new Set([].concat(wt(dy.ALL_PROPERTIES),wt(dy.EVENT_CALLBACKS)));var e=!this.is("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandler.bind(this),e),this.getScrollbarWidth()}},{key:"destroy",value:function(){this.gridOptions.api=null,this.gridOptions.columnApi=null,this.destroyed=!0}},{key:"is",value:function(e){return DA(this.gridOptions[e])}},{key:"get",value:function(e){return this.gridOptions[e]}},{key:"getNum",value:function(e){return function(e){return"number"==typeof e?e:"string"==typeof e?parseInt(e,10):void 0}(this.gridOptions[e])}},{key:"getCallback",value:function(e){return this.mergeGridCommonParams(this.gridOptions[e])}},{key:"exists",value:function(e){return fg(this.gridOptions[e])}},{key:"mergeGridCommonParams",value:function(e){var t=this;if(e){return function(n){var r=n;return r.api=t.api,r.columnApi=t.columnApi,r.context=t.context,e(r)}}return e}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(this.gridOptionLookup.has(e)){var i=this.gridOptions[e];if(n||i!==t){this.gridOptions[e]=t;var o=Object.assign({type:e,currentValue:t,previousValue:i},r);this.propertyEventService.dispatchEvent(o)}}}},{key:"addEventListener",value:function(e,t){this.propertyEventService.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){this.propertyEventService.removeEventListener(e,t)}},{key:"globalEventHandler",value:function(e,t){if(!this.destroyed){var n=dy.getCallbackForEvent(e);"function"===typeof this.gridOptions[n]&&this.gridOptions[n](t)}}},{key:"getGridId",value:function(){return this.api.getGridId()}},{key:"getScrollbarWidth",value:function(){if(null==this.scrollbarWidth){var e="number"===typeof this.gridOptions.scrollbarWidth&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:Rw();null!=e&&(this.scrollbarWidth=e,this.eventService.dispatchEvent({type:Ym.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth}},{key:"isRowModelType",value:function(e){return this.gridOptions.rowModelType===e||"clientSide"===e&&pg(this.gridOptions.rowModelType)}},{key:"isDomLayout",value:function(e){var t;return(null!==(t=this.gridOptions.domLayout)&&void 0!==t?t:"normal")===e}},{key:"isRowSelection",value:function(){return"single"===this.gridOptions.rowSelection||"multiple"===this.gridOptions.rowSelection}},{key:"useAsyncEvents",value:function(){return!this.is("suppressAsyncEvents")}},{key:"isGetRowHeightFunction",value:function(){return"function"===typeof this.gridOptions.getRowHeight}},{key:"getRowHeightForNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;if(null==n&&(n=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(t)return{height:n,estimated:!0};var r={node:e,data:e.data},i=this.getCallback("getRowHeight")(r);if(this.isNumeric(i))return 0===i&&Lg((function(){return console.warn("AG Grid: The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.")}),"invalidRowHeight"),{height:Math.max(1,i),estimated:!1}}return e.detail&&this.is("masterDetail")?this.getMasterDetailRowHeight():{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:n,estimated:!1}}},{key:"getMasterDetailRowHeight",value:function(){return this.is("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}}},{key:"getRowHeightAsNumber",value:function(){if(!this.gridOptions.rowHeight||pg(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();var e=this.gridOptions.rowHeight;return e&&this.isNumeric(e)?(this.environment.setRowHeightVariable(e),e):(console.warn("AG Grid row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())}},{key:"isNumeric",value:function(e){return!isNaN(e)&&"number"===typeof e&&isFinite(e)}},{key:"getDomDataKey",value:function(){return this.domDataKey}},{key:"getDomData",value:function(e,t){var n=e[this.getDomDataKey()];return n?n[t]:void 0}},{key:"setDomData",value:function(e,t,n){var r=this.getDomDataKey(),i=e[r];pg(i)&&(i={},e[r]=i),i[t]=n}},{key:"getDocument",value:function(){var e=null;return this.gridOptions.getDocument&&fg(this.gridOptions.getDocument)?e=this.gridOptions.getDocument():this.eGridDiv&&(e=this.eGridDiv.ownerDocument),e&&fg(e)?e:document}},{key:"getWindow",value:function(){return this.getDocument().defaultView||window}},{key:"getRootNode",value:function(){return this.eGridDiv.getRootNode()}},{key:"getAsyncTransactionWaitMillis",value:function(){return fg(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50}},{key:"isAnimateRows",value:function(){return!this.is("ensureDomOrder")&&this.is("animateRows")}},{key:"isGroupRowsSticky",value:function(){return!(this.is("suppressGroupRowsSticky")||this.is("paginateChildRows")||this.is("groupHideOpenParents"))}},{key:"isTreeData",value:function(){return this.is("treeData")&&Qg.__assertRegistered(Xg.RowGroupingModule,"Tree Data",this.api.getGridId())}},{key:"isMasterDetail",value:function(){return this.is("masterDetail")&&Qg.__assertRegistered(Xg.MasterDetailModule,"masterDetail",this.api.getGridId())}},{key:"isEnableRangeSelection",value:function(){return this.is("enableRangeSelection")&&Qg.__isRegistered(Xg.RangeSelectionModule,this.api.getGridId())}},{key:"isColumnsSortingCoupledToGroup",value:function(){var e=this.gridOptions.autoGroupColumnDef;return this.isRowModelType("clientSide")&&!(null===e||void 0===e?void 0:e.comparator)&&!this.isTreeData()}},{key:"getGroupAggFiltering",value:function(){var e=this.gridOptions.groupAggFiltering;return"function"===typeof e?this.getCallback("groupAggFiltering"):DA(e)?function(){return!0}:void 0}},{key:"isGroupMultiAutoColumn",value:function(){return this.gridOptions.groupDisplayType?by("multipleColumns",this.gridOptions.groupDisplayType):this.is("groupHideOpenParents")}},{key:"isGroupUseEntireRow",value:function(e){return!e&&(!!this.gridOptions.groupDisplayType&&by("groupRows",this.gridOptions.groupDisplayType))}}]),e}();_A([nm("gridOptions")],NA.prototype,"gridOptions",void 0),_A([nm("eventService")],NA.prototype,"eventService",void 0),_A([nm("environment")],NA.prototype,"environment",void 0),_A([nm("eGridDiv")],NA.prototype,"eGridDiv",void 0),_A([OA(0,om("gridApi")),OA(1,om("columnApi"))],NA.prototype,"agWire",null),_A([$g],NA.prototype,"init",null),_A([em],NA.prototype,"destroy",null),NA=_A([tm("gridOptionsService")],NA);var PA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},FA=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"getLocaleTextFunc",value:function(){var e=this.gridOptionsService.getCallback("getLocaleText");if(e)return function(t,n,r){return e({key:t,defaultValue:n,variableValues:r})};var t=this.gridOptionsService.get("localeText");return function(e,n,r){var i=t&&t[e];if(i&&r&&r.length)for(var o=0;!(o>=r.length);){if(-1===i.indexOf("${variable}"))break;i=i.replace("${variable}",r[o++])}return null!==i&&void 0!==i?i:n}}}]),n}(Vm);FA=PA([tm("localeService")],FA);var IA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},LA=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.call(this,n.TEMPLATE,"vertical")}return A(n,[{key:"postConstruct",value:function(){cg(D(n.prototype),"postConstruct",this).call(this),this.createManagedBean(new bk(this.eContainer)),this.ctrlsService.registerFakeVScrollComp(this),this.addManagedListener(this.eventService,Ym.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onRowContainerHeightChanged.bind(this))}},{key:"setScrollVisible",value:function(){var e=this.scrollVisibleService.isVerticalScrollShowing(),t=this.invisibleScrollbar,n=e&&this.gridOptionsService.getScrollbarWidth()||0,r=0===n&&t?16:n;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),gb(this.getGui(),r),gb(this.eViewport,r),gb(this.eContainer,r),this.setDisplayed(e,{skipAriaHidden:!0})}},{key:"onRowContainerHeightChanged",value:function(){var e=this.ctrlsService.getGridBodyCtrl().getBodyViewportElement();this.eViewport.scrollTop!=e.scrollTop&&(this.eViewport.scrollTop=e.scrollTop)}},{key:"getScrollPosition",value:function(){return this.getViewport().scrollTop}},{key:"setScrollPosition",value:function(e){ob(this.getViewport())||this.attemptSettingScrollPosition(e),this.getViewport().scrollTop=e}}]),n}(SA);LA.TEMPLATE='<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>\n            </div>\n        </div>',IA([$g],LA.prototype,"postConstruct",null);var MA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},GA={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},BA=["january","february","march","april","may","june","july","august","september","october","november","december"],jA=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).dataTypeDefinitions={},e.isWaitingForRowData=!1,e.isColumnTypeOverrideInDataTypeDefinitions=!1,e.columnStateUpdatesPendingInference={},e.columnStateUpdateListenerDestroyFuncs=[],e}return A(n,[{key:"init",value:function(){var e=this;this.groupHideOpenParents=this.gridOptionsService.is("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",(function(){e.groupHideOpenParents=e.gridOptionsService.is("groupHideOpenParents")})),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",(function(){e.processDataTypeDefinitions(),e.columnModel.recreateColumnDefs("gridOptionsChanged")}))}},{key:"processDataTypeDefinitions",value:function(){var e,t=this,n=this.getDefaultDataTypes();this.dataTypeDefinitions={},Object.entries(n).forEach((function(e){var n=Y(e,2),r=n[0],i=n[1];t.dataTypeDefinitions[r]=Object.assign(Object.assign({},i),{groupSafeValueFormatter:t.createGroupSafeValueFormatter(i)})}));var r=null!==(e=this.gridOptionsService.get("dataTypeDefinitions"))&&void 0!==e?e:{};this.dataTypeMatchers={},Object.entries(r).forEach((function(e){var i=Y(e,2),o=i[0],a=i[1],s=t.processDataTypeDefinition(a,r,[o],n);s&&(t.dataTypeDefinitions[o]=s,a.dataTypeMatcher&&(t.dataTypeMatchers[o]=a.dataTypeMatcher))})),this.checkObjectValueHandlers(n),["dateString","text","number","boolean","date"].forEach((function(e){var r=t.dataTypeMatchers[e];r&&delete t.dataTypeMatchers[e],t.dataTypeMatchers[e]=null!==r&&void 0!==r?r:n[e].dataTypeMatcher}))}},{key:"mergeDataTypeDefinitions",value:function(e,t){var n=Object.assign(Object.assign({},e),t);return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(n.columnTypes=[].concat(wt(this.convertColumnTypes(e.columnTypes)),wt(this.convertColumnTypes(t.columnTypes)))),n}},{key:"processDataTypeDefinition",value:function(e,t,n,r){var i,o=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){var a=r[o];if(!this.validateDataTypeDefinition(e,a,o))return;i=this.mergeDataTypeDefinitions(a,e)}else{if(n.includes(o))return void Lg((function(){return console.warn('AG Grid: Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.')}),"dataTypeExtendsCircularRef");var s=t[o];if(!this.validateDataTypeDefinition(e,s,o))return;var l=this.processDataTypeDefinition(s,t,[].concat(wt(n),[o]),r);if(!l)return;i=this.mergeDataTypeDefinitions(l,e)}return Object.assign(Object.assign({},i),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(i)})}},{key:"validateDataTypeDefinition",value:function(e,t,n){return t?t.baseDataType===e.baseDataType||(Lg((function(){return console.warn('AG Grid: The "baseDataType" property of a data type definition must match that of its parent.')}),"dataTypeBaseTypesMatch"),!1):(Lg((function(){return console.warn("AG Grid: The data type definition ".concat(n," does not exist."))}),"dataTypeDefMissing"+n),!1)}},{key:"createGroupSafeValueFormatter",value:function(e){var t=this;if(e.valueFormatter)return function(n){var r,i;if(!(null===(r=n.node)||void 0===r?void 0:r.group))return t.groupHideOpenParents&&n.column.isRowGroupActive()?"string"!==typeof n.value||(null===(i=e.dataTypeMatcher)||void 0===i?void 0:i.call(e,n.value))?e.valueFormatter(n):void 0:e.valueFormatter(n);var o=n.column.getAggFunc();if(o){if("first"===o||"last"===o)return e.valueFormatter(n);if("number"===e.baseDataType&&"count"!==o){if("number"===typeof n.value)return e.valueFormatter(n);if("object"===typeof n.value){if(!n.value)return;if("toNumber"in n.value)return e.valueFormatter(Object.assign(Object.assign({},n),{value:n.value.toNumber()}));if("value"in n.value)return e.valueFormatter(Object.assign(Object.assign({},n),{value:n.value.value}))}}}}}},{key:"updateColDefAndGetDataTypeDefinitionColumnType",value:function(e,t,n){var r=t.cellDataType,i=t.field;if(void 0===r&&(r=e.cellDataType),null!=r&&!0!==r||(r=!!this.canInferCellDataType(e,t)&&this.inferCellDataType(i,n)),r){var o=this.dataTypeDefinitions[r];if(o)return e.cellDataType=r,o.groupSafeValueFormatter&&(e.valueFormatter=o.groupSafeValueFormatter),o.valueParser&&(e.valueParser=o.valueParser),o.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,o,n),o.columnTypes;Lg((function(){return console.warn('AG Grid: Missing data type definition - "'.concat(r,'"'))}),"dataTypeMissing"+r)}else e.cellDataType=!1}},{key:"updateColDefAndGetColumnType",value:function(e,t,n){var r,i,o=this.updateColDefAndGetDataTypeDefinitionColumnType(e,t,n),a=null!==(i=null!==(r=t.type)&&void 0!==r?r:o)&&void 0!==i?i:e.type;return e.type=a,a?this.convertColumnTypes(a):void 0}},{key:"addColumnListeners",value:function(e){if(this.isWaitingForRowData){var t=this.columnStateUpdatesPendingInference[e.getColId()];if(t){var n=function(e){t.add(e.key)};e.addEventListener(fm.EVENT_STATE_UPDATED,n),this.columnStateUpdateListenerDestroyFuncs.push((function(){return e.removeEventListener(fm.EVENT_STATE_UPDATED,n)}))}}}},{key:"canInferCellDataType",value:function(e,t){var n,r=this;if("clientSide"!==this.rowModel.getType())return!1;var i={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(t,i))return!1;var o=null===t.type?e.type:t.type;if(o){var a=null!==(n=this.gridOptionsService.get("columnTypes"))&&void 0!==n?n:{};if(this.convertColumnTypes(o).some((function(e){var t=a[e.trim()];return t&&r.doColDefPropsPreventInference(t,i)})))return!1}return!this.doColDefPropsPreventInference(e,i)}},{key:"doColDefPropsPreventInference",value:function(e,t){var n=this;return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some((function(r){var i=Y(r,2),o=i[0],a=i[1];return n.doesColDefPropPreventInference(e,t,o,a)}))}},{key:"doesColDefPropPreventInference",value:function(e,t,n,r){if(!t[n])return!1;var i=e[n];return null===i?(t[n]=!1,!1):void 0===r?!!i:i===r}},{key:"inferCellDataType",value:function(e,t){var n;if(e){var r,i=this.getInitialData();if(i){var o=e.indexOf(".")>=0&&!this.gridOptionsService.is("suppressFieldDotNotation");r=Dg(i,e,o)}else this.initWaitForRowData(t);if(null!=r){var a=null!==(n=Object.entries(this.dataTypeMatchers).find((function(e){var t=Y(e,2);t[0];return(0,t[1])(r)})))&&void 0!==n?n:["object"];return Y(a,1)[0]}}}},{key:"getInitialData",value:function(){var e=this.gridOptionsService.get("rowData");if(null===e||void 0===e?void 0:e.length)return e[0];if(this.initialData)return this.initialData;var t=this.rowModel.getRootNode().allLeafChildren;return(null===t||void 0===t?void 0:t.length)?t[0].data:null}},{key:"initWaitForRowData",value:function(e){var t=this;if(this.columnStateUpdatesPendingInference[e]=new Set,!this.isWaitingForRowData){this.isWaitingForRowData=!0;var n=this.isColumnTypeOverrideInDataTypeDefinitions;n&&this.columnModel.queueResizeOperations();var r=this.addManagedListener(this.eventService,Ym.EVENT_ROW_DATA_UPDATE_STARTED,(function(e){var i=e.firstRowData;i&&(null===r||void 0===r||r(),t.isWaitingForRowData=!1,t.processColumnsPendingInference(i,n),t.columnStateUpdatesPendingInference={},n&&t.columnModel.processResizeOperations())}))}}},{key:"processColumnsPendingInference",value:function(e,t){var n=this;this.initialData=e;var r=[];this.columnStateUpdateListenerDestroyFuncs.forEach((function(e){return e()})),this.columnStateUpdateListenerDestroyFuncs=[];var i={},o={};Object.entries(this.columnStateUpdatesPendingInference).forEach((function(e){var a=Y(e,2),s=a[0],l=a[1],u=n.columnModel.getGridColumn(s);if(u){var c=u.getColDef();if(n.columnModel.resetColumnDefIntoColumn(u)){var d=u.getColDef();if(t&&d.type&&d.type!==c.type){var h=n.getUpdatedColumnState(u,l);h.rowGroup&&null==h.rowGroupIndex&&(i[s]=h),h.pivot&&null==h.pivotIndex&&(o[s]=h),r.push(h)}}}})),t&&r.push.apply(r,wt(this.columnModel.generateColumnStateForRowGroupAndPivotIndexes(i,o))),r.length&&this.columnModel.applyColumnState({state:r},"cellDataTypeInferred"),this.initialData=null}},{key:"getUpdatedColumnState",value:function(e,t){var n=this.columnModel.getColumnStateFromColDef(e);return t.forEach((function(e){delete n[e],"rowGroup"===e?delete n.rowGroupIndex:"pivot"===e&&delete n.pivotIndex})),n}},{key:"checkObjectValueHandlers",value:function(e){var t=this.dataTypeDefinitions.object,n=e.object;this.hasObjectValueParser=t.valueParser!==n.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==n.valueFormatter}},{key:"convertColumnTypes",value:function(e){var t=[];e instanceof Array?e.some((function(e){return"string"!==typeof e}))?console.warn("AG Grid: if colDef.type is supplied an array it should be of type 'string[]'"):t=e:"string"===typeof e?t=e.split(","):console.warn("AG Grid: colDef.type should be of type 'string' | 'string[]'");return t}},{key:"getDateStringTypeDefinition",value:function(){return this.dataTypeDefinitions.dateString}},{key:"getDateParserFunction",value:function(){return this.getDateStringTypeDefinition().dateParser}},{key:"getDateFormatterFunction",value:function(){return this.getDateStringTypeDefinition().dateFormatter}},{key:"checkType",value:function(e,t){var n,r=e.getColDef();if(!r.cellDataType||null==t)return!0;var i=null===(n=this.dataTypeDefinitions[r.cellDataType])||void 0===n?void 0:n.dataTypeMatcher;return!i||i(t)}},{key:"validateColDef",value:function(e){"object"===e.cellDataType&&(e.valueFormatter!==this.dataTypeDefinitions.object.groupSafeValueFormatter||this.hasObjectValueFormatter||Lg((function(){return console.warn('AG Grid: Cell data type is "object" but no value formatter has been provided. Please either provide an object data type definition with a value formatter, or set "colDef.valueFormatter"')}),"dataTypeObjectValueFormatter"),e.editable&&e.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&Lg((function(){return console.warn('AG Grid: Cell data type is "object" but no value parser has been provided. Please either provide an object data type definition with a value parser, or set "colDef.valueParser"')}),"dataTypeObjectValueParser"))}},{key:"setColDefPropertiesForBaseDataType",value:function(e,t,n){var r=this,i=function(e,n,i){var o=e.getColDef().valueFormatter;return o===t.groupSafeValueFormatter&&(o=t.valueFormatter),r.valueFormatterService.formatValue(e,n,i,o)},o=Qg.__isRegistered(Xg.SetFilterModule,this.context.getGridId()),a=this.localeService.getLocaleTextFunc(),s=function(t){var n=e.filterParams;e.filterParams="object"===typeof n?Object.assign(Object.assign({},n),t):t};switch(e.useValueFormatterForExport=!0,e.useValueParserForImport=!0,t.baseDataType){case"number":e.cellEditor="agNumberCellEditor",o&&s({comparator:function(e,t){var n=null==e?0:parseInt(e),r=null==t?0:parseInt(t);return n===r?0:n>r?1:-1}});break;case"boolean":e.cellEditor="agCheckboxCellEditor",e.cellRenderer="agCheckboxCellRenderer",e.suppressKeyboardEvent=function(e){return!!e.colDef.editable&&e.event.key===_b.SPACE},s(o?{valueFormatter:function(e){return fg(e.value)?a(String(e.value),e.value?"True":"False"):a("blanks","(Blanks)")}}:{maxNumConditions:1,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:function(e,t){return t},numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:function(e,t){return!1===t},numberOfInputs:0}]});break;case"date":e.cellEditor="agDateCellEditor",e.keyCreator=function(e){return i(e.column,e.node,e.value)},o&&s({valueFormatter:function(e){var t=i(e.column,e.node,e.value);return fg(t)?t:a("blanks","(Blanks)")},treeList:!0,treeListFormatter:function(e,t){if(1===t&&null!=e){var n=BA[Number(e)-1];return a(n,GA[n])}return null!==e&&void 0!==e?e:a("blanks","(Blanks)")}});break;case"dateString":e.cellEditor="agDateStringCellEditor",e.keyCreator=function(e){return i(e.column,e.node,e.value)};var l=this.getDateParserFunction();s(o?{valueFormatter:function(e){var t=i(e.column,e.node,e.value);return fg(t)?t:a("blanks","(Blanks)")},treeList:!0,treeListPathGetter:function(e){var t=l(null!==e&&void 0!==e?e:void 0);return t?[String(t.getFullYear()),String(t.getMonth()+1),String(t.getDate())]:null},treeListFormatter:function(e,t){if(1===t&&null!=e){var n=BA[Number(e)-1];return a(n,GA[n])}return null!==e&&void 0!==e?e:a("blanks","(Blanks)")}}:{comparator:function(e,t){var n=l(t);return null==t||n<e?-1:n>e?1:0}});break;case"object":e.cellEditorParams={useFormatter:!0},e.comparator=function(e,t){var o=r.columnModel.getPrimaryColumn(n),a=null===o||void 0===o?void 0:o.getColDef();if(!o||!a)return 0;var s=null==e?"":i(o,null,e),l=null==t?"":i(o,null,t);return s===l?0:s>l?1:-1},e.keyCreator=function(e){return i(e.column,e.node,e.value)},o?s({valueFormatter:function(e){var t=i(e.column,e.node,e.value);return fg(t)?t:a("blanks","(Blanks)")}}):e.filterValueGetter=function(e){return i(e.column,e.node,r.valueService.getValue(e.column,e.node))}}}},{key:"getDefaultDataTypes",value:function(){var e=function(e){return!!e.match("^\\d{4}-\\d{2}-\\d{2}$")},t=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:function(e){return""===e.newValue?null:Number(e.newValue)},valueFormatter:function(e){return null==e.value?"":"number"!==typeof e.value||isNaN(e.value)?t("invalidNumber","Invalid Number"):String(e.value)},dataTypeMatcher:function(e){return"number"===typeof e}},text:{baseDataType:"text",valueParser:function(e){return""===e.newValue?null:gg(e.newValue)},dataTypeMatcher:function(e){return"string"===typeof e}},boolean:{baseDataType:"boolean",valueParser:function(e){return""===e.newValue?null:"true"===String(e.newValue).toLowerCase()},valueFormatter:function(e){return null==e.value?"":String(e.value)},dataTypeMatcher:function(e){return"boolean"===typeof e}},date:{baseDataType:"date",valueParser:function(e){return Gw(null==e.newValue?null:String(e.newValue))},valueFormatter:function(e){var n;return null==e.value?"":e.value instanceof Date&&!isNaN(e.value.getTime())?null!==(n=Iw(e.value,!1))&&void 0!==n?n:"":t("invalidDate","Invalid Date")},dataTypeMatcher:function(e){return e instanceof Date}},dateString:{baseDataType:"dateString",dateParser:function(e){var t;return null!==(t=Gw(e))&&void 0!==t?t:void 0},dateFormatter:function(e){var t;return null!==(t=Iw(null!==e&&void 0!==e?e:null,!1))&&void 0!==t?t:void 0},valueParser:function(t){return e(String(t.newValue))?t.newValue:null},valueFormatter:function(t){return e(String(t.value))?t.value:""},dataTypeMatcher:function(t){return"string"===typeof t&&e(t)}},object:{baseDataType:"object",valueParser:function(){return null},valueFormatter:function(e){var t;return null!==(t=gg(e.value))&&void 0!==t?t:""}}}}}]),n}(Vm);MA([nm("rowModel")],jA.prototype,"rowModel",void 0),MA([nm("columnModel")],jA.prototype,"columnModel",void 0),MA([nm("columnUtils")],jA.prototype,"columnUtils",void 0),MA([nm("valueService")],jA.prototype,"valueService",void 0),MA([nm("valueFormatterService")],jA.prototype,"valueFormatterService",void 0),MA([$g],jA.prototype,"init",null),jA=MA([tm("dataTypeService")],jA);var HA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},VA=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"parseValue",value:function(e,t,n,r){var i=e.getColDef(),o={node:t,data:null===t||void 0===t?void 0:t.data,oldValue:r,newValue:n,colDef:i,column:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context},a=i.valueParser;return fg(a)?"function"===typeof a?a(o):this.expressionService.evaluate(a,o):n}}]),n}(Vm);HA([nm("expressionService")],VA.prototype,"expressionService",void 0),VA=HA([tm("valueParserService")],VA);var WA,zA=function(){function e(t,n,r){T(this,e),n?(this.gridOptions=n,(new KA).create(t,n,(function(e){var n=new SR(t);e.createBean(n)}),void 0,r)):console.error("AG Grid: no gridOptions provided to the grid")}return A(e,[{key:"destroy",value:function(){this.gridOptions&&this.gridOptions.api&&this.gridOptions.api.destroy()}}]),e}(),UA=1,KA=function(){function e(){T(this,e)}return A(e,[{key:"create",value:function(e,t,n,r,i){var o,a=this,s=!!t.debug,l=null!==(o=t.gridId)&&void 0!==o?o:String(UA++),u=this.getRegisteredModules(i,l),c=this.createBeansList(t.rowModelType,u,l),d=this.createProvidedBeans(e,t,i);if(c){var h={providedBeanInstances:d,beanClasses:c,debug:s,gridId:l},f=new yR("AG Grid",(function(){return t.debug})),p=new yR("Context",(function(){return h.debug})),v=new Zg(h,p),g=v.getBean("beans");this.registerModuleUserComponents(g,u),this.registerStackComponents(g,u),this.registerControllers(g,u),n(v),g.ctrlsService.whenReady((function(){a.setColumnsAndData(g),a.dispatchGridReadyEvent(g);var e=Qg.__isRegistered(Xg.EnterpriseCoreModule,l);f.log("initialised successfully, enterprise = ".concat(e))})),r&&r(v)}}},{key:"registerControllers",value:function(e,t){t.forEach((function(t){t.controllers&&t.controllers.forEach((function(t){return e.ctrlsFactory.register(t)}))}))}},{key:"registerStackComponents",value:function(e,t){var n=this.createAgStackComponentsList(t);e.agStackComponentsRegistry.setupComponents(n)}},{key:"getRegisteredModules",value:function(e,t){var n=e?e.modules:null,r=Qg.__getRegisteredModules(t),i=[],o={},a=function e(t,n,r){var a;o[(a=n).moduleName]||(o[a.moduleName]=!0,i.push(a),Qg.__register(a,t,r)),n.dependantModules&&n.dependantModules.forEach((function(n){return e(t,n,r)}))};return n&&n.forEach((function(e){return a(!0,e,t)})),r&&r.forEach((function(e){return a(!Qg.__isPackageBased(),e,void 0)})),i}},{key:"registerModuleUserComponents",value:function(e,t){this.extractModuleEntity(t,(function(e){return e.userComponents?e.userComponents:[]})).forEach((function(t){e.userComponentRegistry.registerDefaultComponent(t.componentName,t.componentClass)}))}},{key:"createProvidedBeans",value:function(e,t,n){var r=n?n.frameworkOverrides:null;pg(r)&&(r=new tR);var i={gridOptions:t,eGridDiv:e,globalEventListener:n?n.globalEventListener:null,frameworkOverrides:r};return n&&n.providedBeanInstances&&Object.assign(i,n.providedBeanInstances),i}},{key:"createAgStackComponentsList",value:function(e){var t=[{componentName:"AgCheckbox",componentClass:kC},{componentName:"AgRadioButton",componentClass:xC},{componentName:"AgToggleButton",componentClass:RT},{componentName:"AgInputTextField",componentClass:GC},{componentName:"AgInputTextArea",componentClass:AT},{componentName:"AgInputNumberField",componentClass:BC},{componentName:"AgInputDateField",componentClass:_T},{componentName:"AgInputRange",componentClass:OT},{componentName:"AgSelect",componentClass:CC},{componentName:"AgSlider",componentClass:NT},{componentName:"AgGridBody",componentClass:Ik},{componentName:"AgHeaderRoot",componentClass:Yx},{componentName:"AgSortIndicator",componentClass:$C},{componentName:"AgPagination",componentClass:YR},{componentName:"AgOverlayWrapper",componentClass:JR},{componentName:"AgGroupComponent",componentClass:FT},{componentName:"AgPanel",componentClass:WT},{componentName:"AgDialog",componentClass:UT},{componentName:"AgRowContainer",componentClass:Xk},{componentName:"AgFakeHorizontalScroll",componentClass:kA},{componentName:"AgFakeVerticalScroll",componentClass:LA}],n=this.extractModuleEntity(e,(function(e){return e.agStackComponents?e.agStackComponents:[]}));return t=t.concat(n)}},{key:"createBeansList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"clientSide",t=arguments.length>2?arguments[2]:void 0,n=(arguments.length>1?arguments[1]:void 0).filter((function(t){return!t.rowModel||t.rowModel===e})),r={clientSide:Xg.ClientSideRowModelModule,infinite:Xg.InfiniteRowModelModule,serverSide:Xg.ServerSideRowModelModule,viewport:Xg.ViewportRowModelModule};if(r[e]){if(Qg.__assertRegistered(r[e],"rowModelType = '".concat(e,"'"),t)){var i=[tk,eA,nA,uA,DR,TE,JS,MR,BR,rT,wE,UR,Zx,FA,wy,mT,EE,Ry,um,NA,QT,sR,_E,Ey,Ux,kT,dT,fR,Km,vR,oR,Vk,PR,dR,mR,xy,sT,$x,xS,uR,Rx,jk,WR,rR,pT,TT,Mk,xR,RR,_R,qR,$m,IR,oT,sA,_y,dA,fA,ST,vA,yA,TA,AA,bA,jA,VA],o=this.extractModuleEntity(n,(function(e){return e.beans?e.beans:[]}));i.push.apply(i,wt(o));var a=[];return i.forEach((function(e){a.indexOf(e)<0&&a.push(e)})),a}}else console.error("AG Grid: could not find row model for rowModelType = "+e)}},{key:"extractModuleEntity",value:function(e,t){var n;return(n=[]).concat.apply(n,wt(e.map(t)))}},{key:"setColumnsAndData",value:function(e){var t=e.gridOptionsService.get("columnDefs");e.columnModel.setColumnDefs(t||[],"gridInitializing"),e.rowModel.start()}},{key:"dispatchGridReadyEvent",value:function(e){var t={type:Ym.EVENT_GRID_READY};e.eventService.dispatchEvent(t)}}]),e}(),qA=function(){function e(){T(this,e)}return A(e,[{key:"wrap",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,o=this.createWrapper(e,i);return t.forEach((function(e){n.createMethod(o,e,!0)})),r.forEach((function(e){n.createMethod(o,e,!1)})),o}},{key:"unwrap",value:function(e){return e}},{key:"createMethod",value:function(e,t,n){e.addMethod(t,this.createMethodProxy(e,t,n))}},{key:"createMethodProxy",value:function(e,t,n){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(n&&console.warn("AG Grid: Framework component is missing the method "+t+"()"),null)}}}]),e}();!function(e){e.InsideBase="insideBase",e.InsideEnd="insideEnd",e.Center="center",e.OutsideEnd="outsideEnd"}(WA||(WA={}));var XA="undefined"===typeof global?{}:global;XA.HTMLElement="undefined"===typeof HTMLElement?{}:HTMLElement,XA.HTMLButtonElement="undefined"===typeof HTMLButtonElement?{}:HTMLButtonElement,XA.HTMLSelectElement="undefined"===typeof HTMLSelectElement?{}:HTMLSelectElement,XA.HTMLInputElement="undefined"===typeof HTMLInputElement?{}:HTMLInputElement,XA.Node="undefined"===typeof Node?{}:Node,XA.MouseEvent="undefined"===typeof MouseEvent?{}:MouseEvent;var YA=function(){function e(t,n,r,i,o,a){T(this,e),this.nextId=0,this.allNodesMap={},this.rootNode=t,this.gridOptionsService=n,this.eventService=r,this.columnModel=i,this.beans=a,this.selectionService=o,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=e.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[],this.postConstruct()}return A(e,[{key:"postConstruct",value:function(){this.suppressParentsInRowNodes=this.gridOptionsService.is("suppressParentsInRowNodes"),this.isRowMasterFunc=this.gridOptionsService.get("isRowMaster"),this.doingTreeData=this.gridOptionsService.isTreeData(),this.doingMasterDetail=this.gridOptionsService.isMasterDetail()}},{key:"getCopyOfNodesMap",value:function(){return Vb.cloneObject(this.allNodesMap)}},{key:"getRowNode",value:function(e){return this.allNodesMap[e]}},{key:"setRowData",value:function(t){var n=this;if("string"!==typeof t){this.dispatchRowDataUpdateStartedEvent(t);var r=this.rootNode,i=this.rootNode.sibling;r.childrenAfterFilter=null,r.childrenAfterGroup=null,r.childrenAfterAggFilter=null,r.childrenAfterSort=null,r.childrenMapped=null,r.updateHasChildren(),this.nextId=0,this.allNodesMap={},t?r.allLeafChildren=t.map((function(t){return n.createNode(t,n.rootNode,e.TOP_LEVEL)})):(r.allLeafChildren=[],r.childrenAfterGroup=[]),i&&(i.childrenAfterFilter=r.childrenAfterFilter,i.childrenAfterGroup=r.childrenAfterGroup,i.childrenAfterAggFilter=r.childrenAfterAggFilter,i.childrenAfterSort=r.childrenAfterSort,i.childrenMapped=r.childrenMapped,i.allLeafChildren=r.allLeafChildren)}else console.warn("AG Grid: rowData must be an array, however you passed in a string. If you are loading JSON, make sure you convert the JSON string to JavaScript objects first")}},{key:"updateRowData",value:function(e,t){this.dispatchRowDataUpdateStartedEvent(e.add);var n={remove:[],update:[],add:[]},r=[];return this.executeRemove(e,n,r),this.executeUpdate(e,n,r),this.executeAdd(e,n),this.updateSelection(r,"rowDataChanged"),t&&Vb.sortRowNodesByOrder(this.rootNode.allLeafChildren,t),n}},{key:"dispatchRowDataUpdateStartedEvent",value:function(e){var t={type:Ym.EVENT_ROW_DATA_UPDATE_STARTED,firstRowData:(null===e||void 0===e?void 0:e.length)?e[0]:null};this.eventService.dispatchEvent(t)}},{key:"updateSelection",value:function(e,t){var n=e.length>0;if(n&&this.selectionService.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),this.selectionService.updateGroupsFromChildrenSelections(t),n){var r={type:Ym.EVENT_SELECTION_CHANGED,source:t};this.eventService.dispatchEvent(r)}}},{key:"executeAdd",value:function(t,n){var r,i=this,o=t.add,a=t.addIndex;if(!Vb.missingOrEmpty(o)){var s=o.map((function(t){return i.createNode(t,i.rootNode,e.TOP_LEVEL)}));if("number"===typeof a&&a>=0){var l=this.rootNode.allLeafChildren,u=l.length,c=a;if(this.doingTreeData&&a>0&&u>0)for(var d=0;d<u;d++)if((null===(r=l[d])||void 0===r?void 0:r.rowIndex)==a-1){c=d+1;break}var h=l.slice(0,c),f=l.slice(c,l.length);this.rootNode.allLeafChildren=[].concat(wt(h),wt(s),wt(f))}else this.rootNode.allLeafChildren=[].concat(wt(this.rootNode.allLeafChildren),wt(s));this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),n.add=s}}},{key:"executeRemove",value:function(e,t,n){var r=this,i=e.remove;if(!Vb.missingOrEmpty(i)){var o={};i.forEach((function(e){var i=r.lookupRowNode(e);i&&(i.isSelected()&&n.push(i),i.clearRowTopAndRowIndex(),o[i.id]=!0,delete r.allNodesMap[i.id],t.remove.push(i))})),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter((function(e){return!o[e.id]})),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}}},{key:"executeUpdate",value:function(t,n,r){var i=this,o=t.update;Vb.missingOrEmpty(o)||o.forEach((function(t){var o=i.lookupRowNode(t);o&&(o.updateData(t),!o.selectable&&o.isSelected()&&r.push(o),i.setMasterForRow(o,t,e.TOP_LEVEL,!1),n.update.push(o))}))}},{key:"lookupRowNode",value:function(e){var t,n=this.gridOptionsService.getCallback("getRowId");if(n){var r=n({data:e,level:0});if(!(t=this.allNodesMap[r]))return console.error("AG Grid: could not find row id=".concat(r,", data item was not found for this id")),null}else if(t=this.rootNode.allLeafChildren.find((function(t){return t.data===e})),!t)return console.error("AG Grid: could not find data item as object was not found",e),console.error("Consider using getRowId to help the Grid find matching row data"),null;return t||null}},{key:"createNode",value:function(e,t,n){var r=new mS(this.beans);return r.group=!1,this.setMasterForRow(r,e,n,!0),t&&!this.suppressParentsInRowNodes&&(r.parent=t),r.level=n,r.setDataAndId(e,this.nextId.toString()),this.allNodesMap[r.id]&&console.warn("AG Grid: duplicate node id '".concat(r.id,"' detected from getRowId callback, this could cause issues in your grid.")),this.allNodesMap[r.id]=r,this.nextId++,r}},{key:"setMasterForRow",value:function(e,t,n,r){if(this.doingTreeData)e.setMaster(!1),r&&(e.expanded=!1);else if(this.doingMasterDetail?this.isRowMasterFunc?e.setMaster(this.isRowMasterFunc(t)):e.setMaster(!0):e.setMaster(!1),r){var i=this.columnModel.getRowGroupColumns(),o=n+(i?i.length:0);e.expanded=!!e.master&&this.isExpanded(o)}}},{key:"isExpanded",value:function(e){var t=this.gridOptionsService.getNum("groupDefaultExpanded");return-1===t||e<t}}]),e}();YA.TOP_LEVEL=0,YA.ROOT_NODE_ID="ROOT_NODE_ID";var QA,ZA=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e[e.Normal=0]="Normal",e[e.AfterFilter=1]="AfterFilter",e[e.AfterFilterAndSort=2]="AfterFilterAndSort",e[e.PivotNodes=3]="PivotNodes"}(QA||(QA={}));var JA=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).onRowHeightChanged_debounced=Vb.debounce(e.onRowHeightChanged.bind(P(e)),100),e.rowsToDisplay=[],e}return A(n,[{key:"init",value:function(){var e=this.refreshModel.bind(this,{step:CE.EVERYTHING}),t=!this.gridOptionsService.is("suppressAnimationFrame"),n=this.refreshModel.bind(this,{step:CE.EVERYTHING,afterColumnsChanged:!0,keepRenderedRows:!0,animate:t});this.addManagedListener(this.eventService,Ym.EVENT_NEW_COLUMNS_LOADED,n),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:CE.PIVOT})),this.addManagedListener(this.eventService,Ym.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,Ym.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanges.bind(this));var r=this.refreshModel.bind(this,{step:CE.MAP,keepRenderedRows:!0,animate:t});this.addManagedPropertyListener("groupRemoveSingleChildren",r),this.addManagedPropertyListener("groupRemoveLowestSingleChildren",r),this.rootNode=new mS(this.beans),this.nodeManager=new YA(this.rootNode,this.gridOptionsService,this.eventService,this.columnModel,this.selectionService,this.beans)}},{key:"start",value:function(){var e=this.gridOptionsService.get("rowData");e&&this.setRowData(e)}},{key:"ensureRowHeightsValid",value:function(e,t,n,r){var i,o=!1;do{i=!1;for(var a=this.getRowIndexAtPixel(e),s=this.getRowIndexAtPixel(t),l=Math.max(a,n),u=Math.min(s,r),c=l;c<=u;c++){var d=this.getRow(c);if(d.rowHeightEstimated){var h=this.gridOptionsService.getRowHeightForNode(d);d.setRowHeight(h.height),i=!0,o=!0}}i&&this.setRowTopAndRowIndex()}while(i);return o}},{key:"setRowTopAndRowIndex",value:function(){for(var e=this.environment.getDefaultRowHeight(),t=0,n=new Set,r=this.gridOptionsService.isDomLayout("normal"),i=0;i<this.rowsToDisplay.length;i++){var o=this.rowsToDisplay[i];if(null!=o.id&&n.add(o.id),null==o.rowHeight){var a=this.gridOptionsService.getRowHeightForNode(o,r,e);o.setRowHeight(a.height,a.estimated)}o.setRowTop(t),o.setRowIndex(i),t+=o.rowHeight}return n}},{key:"clearRowTopAndRowIndex",value:function(e,t){var n=e.isActive(),r=function(e){e&&null!=e.id&&!t.has(e.id)&&e.clearRowTopAndRowIndex()};!function e(t){if(r(t),r(t.detailNode),r(t.sibling),t.hasChildren()&&t.childrenAfterGroup){var i=-1==t.level;n&&!i&&!t.expanded||t.childrenAfterGroup.forEach(e)}}(this.rootNode)}},{key:"ensureRowsAtPixel",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getRowIndexAtPixel(t),o=this.getRow(i),a=!this.gridOptionsService.is("suppressAnimationFrame");return o!==e[0]&&(e.forEach((function(e){Vb.removeFromArray(n.rootNode.allLeafChildren,e)})),e.forEach((function(e,t){Vb.insertIntoArray(n.rootNode.allLeafChildren,e,Math.max(i+r,0)+t)})),this.refreshModel({step:CE.EVERYTHING,keepRenderedRows:!0,keepEditingRows:!0,animate:a}),!0)}},{key:"highlightRowAtPixel",value:function(e,t){var n=null!=t?this.getRowIndexAtPixel(t):null,r=null!=n?this.getRow(n):null;if(r&&e&&r!==e&&null!=t){var i=this.getHighlightPosition(t,r);this.lastHighlightedRow&&this.lastHighlightedRow!==r&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),r.setHighlighted(i),this.lastHighlightedRow=r}else this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null)}},{key:"getHighlightPosition",value:function(e,t){if(!t){var n=this.getRowIndexAtPixel(e);if(!(t=this.getRow(n||0)))return bE.Below}var r=t;return e-r.rowTop<r.rowHeight/2?bE.Above:bE.Below}},{key:"getLastHighlightedRowNode",value:function(){return this.lastHighlightedRow}},{key:"isLastRowIndexKnown",value:function(){return!0}},{key:"getRowCount",value:function(){return this.rowsToDisplay?this.rowsToDisplay.length:0}},{key:"getTopLevelRowCount",value:function(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;var e=this.rootNode.childrenAfterAggFilter;return e?e.length:0}},{key:"getTopLevelRowDisplayedIndex",value:function(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;var t=this.rootNode.childrenAfterSort[e];if(this.gridOptionsService.is("groupHideOpenParents"))for(;t.expanded&&t.childrenAfterSort&&t.childrenAfterSort.length>0;)t=t.childrenAfterSort[0];return t.rowIndex}},{key:"getRowBounds",value:function(e){if(Vb.missing(this.rowsToDisplay))return null;var t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}},{key:"onRowGroupOpened",value:function(){var e=this.gridOptionsService.isAnimateRows();this.refreshModel({step:CE.MAP,keepRenderedRows:!0,animate:e})}},{key:"onFilterChanged",value:function(e){if(!e.afterDataChange){var t=this.gridOptionsService.isAnimateRows(),n=0===e.columns.length||e.columns.some((function(e){return e.isPrimary()}))?CE.FILTER:CE.FILTER_AGGREGATES;this.refreshModel({step:n,keepRenderedRows:!0,animate:t})}}},{key:"onSortChanged",value:function(){var e=this.gridOptionsService.isAnimateRows();this.refreshModel({step:CE.SORT,keepRenderedRows:!0,animate:e,keepEditingRows:!0})}},{key:"getType",value:function(){return"clientSide"}},{key:"onValueChanged",value:function(){this.columnModel.isPivotActive()?this.refreshModel({step:CE.PIVOT}):this.refreshModel({step:CE.AGGREGATE})}},{key:"createChangePath",value:function(e){var t=Vb.missingOrEmpty(e),n=new yT(!1,this.rootNode);return(t||this.gridOptionsService.isTreeData())&&n.setInactive(),n}},{key:"isSuppressModelUpdateAfterUpdateTransaction",value:function(e){if(!this.gridOptionsService.is("suppressModelUpdateAfterUpdateTransaction"))return!1;if(null==e.rowNodeTransactions)return!1;var t=e.rowNodeTransactions.filter((function(e){return null!=e.add&&e.add.length>0||null!=e.remove&&e.remove.length>0}));return null==t||0==t.length}},{key:"buildRefreshModelParams",value:function(e){var t=CE.EVERYTHING,n={everything:CE.EVERYTHING,group:CE.EVERYTHING,filter:CE.FILTER,map:CE.MAP,aggregate:CE.AGGREGATE,sort:CE.SORT,pivot:CE.PIVOT};if(Vb.exists(e)&&(t=n[e]),!Vb.missing(t))return{step:t,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gridOptionsService.is("suppressAnimationFrame")};console.error("AG Grid: invalid step ".concat(e,", available steps are ").concat(Object.keys(n).join(", ")))}},{key:"refreshModel",value:function(e){var t="object"===typeof e&&"step"in e?e:this.buildRefreshModelParams(e);if(t&&!this.isSuppressModelUpdateAfterUpdateTransaction(t)){var n=this.createChangePath(t.rowNodeTransactions);switch(t.step){case CE.EVERYTHING:this.doRowGrouping(t.groupState,t.rowNodeTransactions,t.rowNodeOrder,n,!!t.afterColumnsChanged);case CE.FILTER:this.doFilter(n);case CE.PIVOT:this.doPivot(n);case CE.AGGREGATE:this.doAggregate(n);case CE.FILTER_AGGREGATES:this.doFilterAggregates(n);case CE.SORT:this.doSort(t.rowNodeTransactions,n);case CE.MAP:this.doRowsToDisplay()}var r=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(n,r);var i={type:Ym.EVENT_MODEL_UPDATED,animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack};this.eventService.dispatchEvent(i)}}},{key:"isEmpty",value:function(){var e=Vb.missing(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return Vb.missing(this.rootNode)||e||!this.columnModel.isReady()}},{key:"isRowsToRender",value:function(){return Vb.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0}},{key:"getNodesInRangeForSelection",value:function(e,t){var n=!t,r=!1,i=[],o=this.gridOptionsService.is("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort((function(a){if(!r)if(n&&(a===t||a===e)&&(r=!0,a.group&&o))i.push.apply(i,wt(a.allLeafChildren));else{if(!n){if(a!==t&&a!==e)return;n=!0}(!a.group||!o)&&i.push(a)}})),i}},{key:"setDatasource",value:function(e){console.error("AG Grid: should never call setDatasource on clientSideRowController")}},{key:"getTopLevelNodes",value:function(){return this.rootNode?this.rootNode.childrenAfterGroup:null}},{key:"getRootNode",value:function(){return this.rootNode}},{key:"getRow",value:function(e){return this.rowsToDisplay[e]}},{key:"isRowPresent",value:function(e){return this.rowsToDisplay.indexOf(e)>=0}},{key:"getRowIndexAtPixel",value:function(e){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;var t=0,n=this.rowsToDisplay.length-1;if(e<=0)return 0;if(Vb.last(this.rowsToDisplay).rowTop<=e)return this.rowsToDisplay.length-1;for(var r=-1,i=-1;;){var o=Math.floor((t+n)/2),a=this.rowsToDisplay[o];if(this.isRowInPixel(a,e))return o;if(a.rowTop<e?t=o+1:a.rowTop>e&&(n=o-1),r===t&&i===n)return o;r=t,i=n}}},{key:"isRowInPixel",value:function(e,t){var n=e.rowTop,r=e.rowTop+e.rowHeight;return n<=t&&r>t}},{key:"forEachLeafNode",value:function(e){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((function(t,n){return e(t,n)}))}},{key:"forEachNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:wt(this.rootNode.childrenAfterGroup||[]),callback:e,recursionType:QA.Normal,index:0,includeFooterNodes:t})}},{key:"forEachNodeAfterFilter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:wt(this.rootNode.childrenAfterAggFilter||[]),callback:e,recursionType:QA.AfterFilter,index:0,includeFooterNodes:t})}},{key:"forEachNodeAfterFilterAndSort",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:wt(this.rootNode.childrenAfterSort||[]),callback:e,recursionType:QA.AfterFilterAndSort,index:0,includeFooterNodes:t})}},{key:"forEachPivotNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:QA.PivotNodes,index:0,includeFooterNodes:t})}},{key:"recursivelyWalkNodesAndCallback",value:function(e){var t,n=e.nodes,r=e.callback,i=e.recursionType,o=e.includeFooterNodes,a=e.index,s=n[0];o&&(null===(t=null===s||void 0===s?void 0:s.parent)||void 0===t?void 0:t.sibling)&&n.push(s.parent.sibling);for(var l=0;l<n.length;l++){var u=n[l];if(r(u,a++),u.hasChildren()&&!u.footer){var c=null;switch(i){case QA.Normal:c=u.childrenAfterGroup;break;case QA.AfterFilter:c=u.childrenAfterAggFilter;break;case QA.AfterFilterAndSort:c=u.childrenAfterSort;break;case QA.PivotNodes:c=u.leafGroup?null:u.childrenAfterSort}c&&(a=this.recursivelyWalkNodesAndCallback({nodes:wt(c),callback:r,recursionType:i,index:a,includeFooterNodes:o}))}}return a}},{key:"doAggregate",value:function(e){this.aggregationStage&&this.aggregationStage.execute({rowNode:this.rootNode,changedPath:e})}},{key:"doFilterAggregates",value:function(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}},{key:"expandOrCollapseAll",value:function(e){var t=this.gridOptionsService.isTreeData(),n=this.columnModel.isPivotActive();this.rootNode&&function r(i){i&&i.forEach((function(i){var o=function(){i.expanded=e,r(i.childrenAfterGroup)};t?Vb.exists(i.childrenAfterGroup)&&o():n?!i.leafGroup&&o():i.group&&o()}))}(this.rootNode.childrenAfterGroup),this.refreshModel({step:CE.MAP});var r=e?"expandAll":"collapseAll",i={type:Ym.EVENT_EXPAND_COLLAPSE_ALL,source:r};this.eventService.dispatchEvent(i)}},{key:"doSort",value:function(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})}},{key:"doRowGrouping",value:function(e,t,n,r,i){if(this.groupStage){if(t?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:t,rowNodeOrder:n,changedPath:r}):(this.groupStage.execute({rowNode:this.rootNode,changedPath:r,afterColumnsChanged:i}),this.restoreGroupState(e)),this.gridOptionsService.is("groupSelectsChildren")&&this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",r)){var o={type:Ym.EVENT_SELECTION_CHANGED,source:"rowGroupChanged"};this.eventService.dispatchEvent(o)}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren()}},{key:"restoreGroupState",value:function(e){e&&Vb.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(function(t,n){"boolean"===typeof e[n]&&(t.expanded=e[n])}))}},{key:"doFilter",value:function(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})}},{key:"doPivot",value:function(e){this.pivotStage&&this.pivotStage.execute({rowNode:this.rootNode,changedPath:e})}},{key:"getGroupState",value:function(){if(!this.rootNode.childrenAfterGroup||!this.gridOptionsService.is("rememberGroupStateWhenNewData"))return null;var e={};return Vb.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(function(t,n){return e[n]=t.expanded})),e}},{key:"getCopyOfNodesMap",value:function(){return this.nodeManager.getCopyOfNodesMap()}},{key:"getRowNode",value:function(e){if("string"==typeof e&&0==e.indexOf(mS.ID_PREFIX_ROW_GROUP)){var t=void 0;return this.forEachNode((function(n){n.id===e&&(t=n)})),t}return this.nodeManager.getRowNode(e)}},{key:"setRowData",value:function(e){var t=this.getGroupState();this.nodeManager.setRowData(e),this.selectionService.reset(),this.filterManager.onNewRowsLoaded("rowDataUpdated");var n={type:Ym.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(n),this.refreshModel({step:CE.EVERYTHING,groupState:t,newData:!0})}},{key:"batchUpdateRowData",value:function(e,t){var n=this;if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];var r=this.gridOptionsService.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout((function(){n.executeBatchUpdateRowData()}),r)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}},{key:"flushAsyncTransactions",value:function(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}},{key:"executeBatchUpdateRowData",value:function(){var e=this;this.valueCache.onDataChanged();var t=[],n=[],r=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach((function(i){var o=e.nodeManager.updateRowData(i.rowDataTransaction,void 0);n.push(o),i.callback&&t.push(i.callback.bind(null,o)),"number"===typeof i.rowDataTransaction.addIndex&&(r=!0)})),this.commonUpdateRowData(n,void 0,r),t.length>0&&window.setTimeout((function(){t.forEach((function(e){return e()}))}),0),n.length>0){var i={type:Ym.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:n};this.eventService.dispatchEvent(i)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}},{key:"updateRowData",value:function(e,t){this.valueCache.onDataChanged();var n=this.nodeManager.updateRowData(e,t),r="number"===typeof e.addIndex;return this.commonUpdateRowData([n],t,r),n}},{key:"createRowNodeOrder",value:function(){if(!this.gridOptionsService.is("suppressMaintainUnsortedOrder")){var e={};if(this.rootNode&&this.rootNode.allLeafChildren)for(var t=0;t<this.rootNode.allLeafChildren.length;t++){e[this.rootNode.allLeafChildren[t].id]=t}return e}}},{key:"commonUpdateRowData",value:function(e,t,n){var r=!this.gridOptionsService.is("suppressAnimationFrame");n&&(t=this.createRowNodeOrder()),this.refreshModel({step:CE.EVERYTHING,rowNodeTransactions:e,rowNodeOrder:t,keepRenderedRows:!0,keepEditingRows:!0,animate:r}),this.filterManager.onNewRowsLoaded("rowDataUpdated");var i={type:Ym.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(i)}},{key:"doRowsToDisplay",value:function(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}},{key:"onRowHeightChanged",value:function(){this.refreshModel({step:CE.MAP,keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}},{key:"onRowHeightChangedDebounced",value:function(){this.onRowHeightChanged_debounced()}},{key:"resetRowHeights",value:function(){var e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),e&&this.onRowHeightChanged()}},{key:"resetRowHeightsForAllRowNodes",value:function(){var e=!1;return this.forEachNode((function(t){t.setRowHeight(t.rowHeight,!0);var n=t.detailNode;n&&n.setRowHeight(n.rowHeight,!0),e=!0})),e}},{key:"onGridStylesChanges",value:function(){this.columnModel.isAutoRowHeightActive()||this.resetRowHeights()}}]),n}(Vm);ZA([nm("columnModel")],JA.prototype,"columnModel",void 0),ZA([nm("selectionService")],JA.prototype,"selectionService",void 0),ZA([nm("filterManager")],JA.prototype,"filterManager",void 0),ZA([nm("valueCache")],JA.prototype,"valueCache",void 0),ZA([nm("beans")],JA.prototype,"beans",void 0),ZA([nm("filterStage")],JA.prototype,"filterStage",void 0),ZA([nm("sortStage")],JA.prototype,"sortStage",void 0),ZA([nm("flattenStage")],JA.prototype,"flattenStage",void 0),ZA([rm("groupStage")],JA.prototype,"groupStage",void 0),ZA([rm("aggregationStage")],JA.prototype,"aggregationStage",void 0),ZA([rm("pivotStage")],JA.prototype,"pivotStage",void 0),ZA([rm("filterAggregatesStage")],JA.prototype,"filterAggregatesStage",void 0),ZA([$g],JA.prototype,"init",null),JA=ZA([tm("rowModel")],JA);var $A=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},e_=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"execute",value:function(e){var t=e.changedPath;this.filterService.filter(t)}}]),n}(Vm);$A([nm("filterService")],e_.prototype,"filterService",void 0),e_=$A([tm("filterStage")],e_);var t_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},n_=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"execute",value:function(e){var t=this,n=this.sortController.getSortOptions(),r=Vb.exists(n)&&n.length>0,i=r&&Vb.exists(e.rowNodeTransactions)&&this.gridOptionsService.is("deltaSort"),o=n.some((function(e){return!!t.columnModel.getGroupDisplayColumnForGroup(e.column.getId())}));this.sortService.sort(n,r,i,e.rowNodeTransactions,e.changedPath,o)}}]),n}(Vm);t_([nm("sortService")],n_.prototype,"sortService",void 0),t_([nm("sortController")],n_.prototype,"sortController",void 0),t_([nm("columnModel")],n_.prototype,"columnModel",void 0),n_=t_([tm("sortStage")],n_);var r_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i_=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"execute",value:function(e){var t=e.rowNode,n=[],r={value:0},i=this.columnModel.isPivotMode(),o=i&&t.leafGroup,a=o?[t]:t.childrenAfterSort;return this.recursivelyAddToRowsToDisplay(a,n,r,i,0),!o&&n.length>0&&this.gridOptionsService.is("groupIncludeTotalFooter")&&(t.createFooter(),this.addRowNodeToRowsToDisplay(t.sibling,n,r,0)),n}},{key:"recursivelyAddToRowsToDisplay",value:function(e,t,n,r,i){if(!Vb.missingOrEmpty(e))for(var o=this.gridOptionsService.is("groupHideOpenParents"),a=this.gridOptionsService.is("groupRemoveSingleChildren"),s=!a&&this.gridOptionsService.is("groupRemoveLowestSingleChildren"),l=0;l<e.length;l++){var u=e[l],c=u.hasChildren(),d=r&&!c,h=a&&c&&1===u.childrenAfterGroup.length,f=s&&c&&u.leafGroup&&1===u.childrenAfterGroup.length,p=r&&u.leafGroup,v=o&&u.expanded&&!u.master&&!p;if(!d&&!v&&!h&&!f&&this.addRowNodeToRowsToDisplay(u,t,n,i),!r||!u.leafGroup)if(c){var g=h||f;if(u.expanded||g){var m=g?i:i+1;this.recursivelyAddToRowsToDisplay(u.childrenAfterSort,t,n,r,m),this.gridOptionsService.is("groupIncludeFooter")&&this.addRowNodeToRowsToDisplay(u.sibling,t,n,m)}}else if(u.master&&u.expanded){var y=this.createDetailNode(u);this.addRowNodeToRowsToDisplay(y,t,n,i)}}}},{key:"addRowNodeToRowsToDisplay",value:function(e,t,n,r){var i=this.gridOptionsService.isGroupMultiAutoColumn();t.push(e),e.setUiLevel(i?0:r)}},{key:"createDetailNode",value:function(e){if(Vb.exists(e.detailNode))return e.detailNode;var t=new mS(this.beans);return t.detail=!0,t.selectable=!1,t.parent=e,Vb.exists(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t}}]),n}(Vm);r_([nm("columnModel")],i_.prototype,"columnModel",void 0),r_([nm("beans")],i_.prototype,"beans",void 0),i_=r_([tm("flattenStage")],i_);var o_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},a_=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"init",value:function(){this.postSortFunc=this.gridOptionsService.getCallback("postSortRows")}},{key:"sort",value:function(e,t,n,r,i,o){var a=this,s=this.gridOptionsService.is("groupMaintainOrder"),l=this.columnModel.getAllGridColumns().some((function(e){return e.isRowGroupActive()})),u={};n&&r&&(u=this.calculateDirtyNodes(r));var c=this.columnModel.isPivotMode();i&&i.forEachChangedNodeDepthFirst((function(r){a.pullDownGroupDataForHideOpenParents(r.childrenAfterAggFilter,!0);var d=c&&r.leafGroup;if(s&&l&&!r.leafGroup&&!o){var h=r.childrenAfterAggFilter.slice(0);if(r.childrenAfterSort){var f={};r.childrenAfterSort.forEach((function(e,t){f[e.id]=t})),h.sort((function(e,t){var n,r;return(null!==(n=f[e.id])&&void 0!==n?n:0)-(null!==(r=f[t.id])&&void 0!==r?r:0)}))}r.childrenAfterSort=h}else r.childrenAfterSort=!t||d?r.childrenAfterAggFilter.slice(0):n?a.doDeltaSort(r,u,i,e):a.rowNodeSorter.doFullSort(r.childrenAfterAggFilter,e);if(r.sibling&&(r.sibling.childrenAfterSort=r.childrenAfterSort),a.updateChildIndexes(r),a.postSortFunc){var p={nodes:r.childrenAfterSort};a.postSortFunc(p)}})),this.updateGroupDataForHideOpenParents(i)}},{key:"calculateDirtyNodes",value:function(e){var t={},n=function(e){e&&e.forEach((function(e){return t[e.id]=!0}))};return e&&e.forEach((function(e){n(e.add),n(e.update),n(e.remove)})),t}},{key:"doDeltaSort",value:function(e,t,n,r){var i=this,o=e.childrenAfterAggFilter,a=e.childrenAfterSort;if(!a)return this.rowNodeSorter.doFullSort(o,r);var s={},l=[];o.forEach((function(e){t[e.id]||!n.canSkip(e)?l.push(e):s[e.id]=!0}));var u=a.filter((function(e){return s[e.id]})),c=function(e,t){return{currentPos:t,rowNode:e}},d=l.map(c).sort((function(e,t){return i.rowNodeSorter.compareRowNodes(r,e,t)}));return this.mergeSortedArrays(r,d,u.map(c)).map((function(e){return e.rowNode}))}},{key:"mergeSortedArrays",value:function(e,t,n){for(var r=[],i=0,o=0;i<t.length&&o<n.length;){this.rowNodeSorter.compareRowNodes(e,t[i],n[o])<0?r.push(t[i++]):r.push(n[o++])}for(;i<t.length;)r.push(t[i++]);for(;o<n.length;)r.push(n[o++]);return r}},{key:"updateChildIndexes",value:function(e){if(!Vb.missing(e.childrenAfterSort))for(var t=e.childrenAfterSort,n=0;n<t.length;n++){var r=t[n],i=0===n,o=n===e.childrenAfterSort.length-1;r.setFirstChild(i),r.setLastChild(o),r.setChildIndex(n)}}},{key:"updateGroupDataForHideOpenParents",value:function(e){var t=this;if(this.gridOptionsService.is("groupHideOpenParents")){if(this.gridOptionsService.isTreeData()){return Vb.doOnce((function(){return console.warn("AG Grid: The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them (as opposed to Row Grouping, which only has Aggregated Values at the group level).")}),"sortService.hideOpenParentsWithTreeData"),!1}var n=function e(n){t.pullDownGroupDataForHideOpenParents(n.childrenAfterSort,!1),n.childrenAfterSort.forEach((function(t){t.hasChildren()&&e(t)}))};e&&e.executeFromRootNode((function(e){return n(e)}))}}},{key:"pullDownGroupDataForHideOpenParents",value:function(e,t){var n=this;this.gridOptionsService.is("groupHideOpenParents")&&!Vb.missing(e)&&e.forEach((function(e){n.columnModel.getGroupDisplayColumns().forEach((function(r){var i=r.getColDef().showRowGroup;if("string"===typeof i){var o=i,a=n.columnModel.getPrimaryColumn(o);if(!(a===e.rowGroupColumn))if(t)e.setGroupValue(r.getId(),void 0);else{var s=e.getFirstChildOfFirstChild(a);s&&e.setGroupValue(r.getId(),s.key)}}else console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup")}))}))}}]),n}(Vm);o_([nm("columnModel")],a_.prototype,"columnModel",void 0),o_([nm("rowNodeSorter")],a_.prototype,"rowNodeSorter",void 0),o_([$g],a_.prototype,"init",null),a_=o_([tm("sortService")],a_);var s_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},l_=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"filter",value:function(e){var t=this.filterManager.isColumnFilterPresent()||this.filterManager.isQuickFilterPresent()||this.filterManager.isExternalFilterPresent();this.filterNodes(t,e)}},{key:"filterNodes",value:function(e,t){var n=this,r=function(t,r){t.hasChildren()?t.childrenAfterFilter=e&&!r?t.childrenAfterGroup.filter((function(e){var t=e.childrenAfterFilter&&e.childrenAfterFilter.length>0,r=e.data&&n.filterManager.doesRowPassFilter({rowNode:e});return t||r})):t.childrenAfterGroup:t.childrenAfterFilter=t.childrenAfterGroup,t.sibling&&(t.sibling.childrenAfterFilter=t.childrenAfterFilter)};if(this.doingTreeDataFiltering()){var i=function e(t,i){if(t.childrenAfterGroup)for(var o=0;o<t.childrenAfterGroup.length;o++){var a=t.childrenAfterGroup[o],s=i||n.filterManager.doesRowPassFilter({rowNode:a});a.childrenAfterGroup?e(t.childrenAfterGroup[o],s):r(a,s)}r(t,i)};t.executeFromRootNode((function(e){return i(e,!1)}))}else{t.forEachChangedNodeDepthFirst((function(e){return r(e,!1)}),!0)}}},{key:"doingTreeDataFiltering",value:function(){return this.gridOptionsService.isTreeData()&&!this.gridOptionsService.is("excludeChildrenWhenTreeDataFiltering")}}]),n}(Vm);s_([nm("filterManager")],l_.prototype,"filterManager",void 0),l_=s_([tm("filterService")],l_);var u_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},c_=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"postConstruct",value:function(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)}},{key:"isActive",value:function(){var e=this.gridOptionsService.exists("getRowId");return!this.gridOptionsService.is("resetRowDataOnUpdate")&&e}},{key:"setRowData",value:function(e){var t=this.createTransactionForRowData(e);if(t){var n=Y(t,2),r=n[0],i=n[1];this.clientSideRowModel.updateRowData(r,i)}}},{key:"createTransactionForRowData",value:function(e){if(Vb.missing(this.clientSideRowModel))console.error("AG Grid: ImmutableService only works with ClientSideRowModel");else{var t=this.gridOptionsService.getCallback("getRowId");if(null!=t){var n={remove:[],update:[],add:[]},r=this.clientSideRowModel.getCopyOfNodesMap(),i=this.gridOptionsService.is("suppressMaintainUnsortedOrder")?void 0:{};return Vb.exists(e)&&e.forEach((function(e,o){var a=t({data:e,level:0}),s=r[a];(i&&(i[a]=o),s)?(s.data!==e&&n.update.push(e),r[a]=void 0):n.add.push(e)})),Vb.iterateObject(r,(function(e,t){t&&n.remove.push(t.data)})),[n,i]}console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!")}}}]),n}(Vm);u_([nm("rowModel")],c_.prototype,"rowModel",void 0),u_([nm("rowRenderer")],c_.prototype,"rowRenderer",void 0),u_([$g],c_.prototype,"postConstruct",null),c_=u_([tm("immutableService")],c_);var d_={version:"30.0.5",moduleName:Xg.ClientSideRowModelModule,rowModel:"clientSide",beans:[JA,e_,n_,i_,a_,l_,c_]},h_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},f_=function(e){O(n,e);var t=F(n);function n(e,r,i){var o;return T(this,n),(o=t.call(this,e)).parentCache=r,o.params=i,o.startRow=e*i.blockSize,o.endRow=o.startRow+i.blockSize,o}return A(n,[{key:"postConstruct",value:function(){this.createRowNodes()}},{key:"getBlockStateJson",value:function(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}},{key:"setDataAndId",value:function(e,t,n){Vb.exists(t)?e.setDataAndId(t,n.toString()):e.setDataAndId(void 0,void 0)}},{key:"loadFromDatasource",value:function(){var e=this,t=this.createLoadParams();Vb.missing(this.params.datasource.getRows)?console.warn("AG Grid: datasource is missing getRows method"):window.setTimeout((function(){e.params.datasource.getRows(t)}),0)}},{key:"processServerFail",value:function(){}},{key:"createLoadParams",value:function(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gridOptionsService.context}}},{key:"forEachNode",value:function(e,t,n){var r=this;this.rowNodes.forEach((function(i,o){r.startRow+o<n&&e(i,t.next())}))}},{key:"getLastAccessed",value:function(){return this.lastAccessed}},{key:"getRow",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(this.lastAccessed=this.params.lastAccessedSequence.next());var t=e-this.startRow;return this.rowNodes[t]}},{key:"getStartRow",value:function(){return this.startRow}},{key:"getEndRow",value:function(){return this.endRow}},{key:"createRowNodes",value:function(){this.rowNodes=[];for(var e=0;e<this.params.blockSize;e++){var t=this.startRow+e,n=new mS(this.beans);n.setRowHeight(this.params.rowHeight),n.uiLevel=0,n.setRowIndex(t),n.setRowTop(this.params.rowHeight*t),this.rowNodes.push(n)}}},{key:"processServerResult",value:function(e){var t=this;this.rowNodes.forEach((function(n,r){var i=e.rowData?e.rowData[r]:void 0;!n.id&&n.alreadyRendered&&i&&(t.rowNodes[r]=new mS(t.beans),t.rowNodes[r].setRowIndex(n.rowIndex),t.rowNodes[r].setRowTop(n.rowTop),n.clearRowTopAndRowIndex()),t.setDataAndId(t.rowNodes[r],i,t.startRow+r)}));var n=null!=e.rowCount&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,n)}},{key:"destroyRowNodes",value:function(){this.rowNodes.forEach((function(e){e.clearRowTopAndRowIndex()}))}}]),n}(wT);h_([nm("beans")],f_.prototype,"beans",void 0),h_([$g],f_.prototype,"postConstruct",null),h_([em],f_.prototype,"destroyRowNodes",null);var p_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},v_=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).lastRowIndexKnown=!1,r.blocks={},r.blockCount=0,r.rowCount=e.initialRowCount,r.params=e,r}return A(n,[{key:"setBeans",value:function(e){this.logger=e.create("InfiniteCache")}},{key:"getRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Math.floor(e/this.params.blockSize),r=this.blocks[n];if(!r){if(t)return;r=this.createBlock(n)}return r.getRow(e)}},{key:"createBlock",value:function(e){var t=this.createBean(new f_(e,this,this.params));return this.blocks[t.getId()]=t,this.blockCount++,this.purgeBlocksIfNeeded(t),this.params.rowNodeBlockLoader.addBlock(t),t}},{key:"refreshCache",value:function(){0==this.blockCount?this.purgeCache():(this.getBlocksInOrder().forEach((function(e){return e.setStateWaitingToLoad()})),this.params.rowNodeBlockLoader.checkBlockToLoad())}},{key:"destroyAllBlocks",value:function(){var e=this;this.getBlocksInOrder().forEach((function(t){return e.destroyBlock(t)}))}},{key:"getRowCount",value:function(){return this.rowCount}},{key:"isLastRowIndexKnown",value:function(){return this.lastRowIndexKnown}},{key:"pageLoaded",value:function(e,t){this.isAlive()&&(this.logger.log("onPageLoaded: page = ".concat(e.getId(),", lastRow = ").concat(t)),this.checkRowCount(e,t),this.onCacheUpdated())}},{key:"purgeBlocksIfNeeded",value:function(e){var t=this,r=this.getBlocksInOrder().filter((function(t){return t!=e}));r.sort((function(e,t){return t.getLastAccessed()-e.getLastAccessed()}));var i=this.params.maxBlocksInCache>0,o=i?this.params.maxBlocksInCache-1:null,a=n.MAX_EMPTY_BLOCKS_TO_KEEP-1;r.forEach((function(e,n){if(e.getState()===f_.STATE_WAITING_TO_LOAD&&n>=a||!!i&&n>=o){if(t.isBlockCurrentlyDisplayed(e))return;if(t.isBlockFocused(e))return;t.removeBlockFromCache(e)}}))}},{key:"isBlockFocused",value:function(e){var t=this.focusService.getFocusCellToUseAfterRefresh();if(!t)return!1;if(null!=t.rowPinned)return!1;var n=e.getStartRow(),r=e.getEndRow();return t.rowIndex>=n&&t.rowIndex<r}},{key:"isBlockCurrentlyDisplayed",value:function(e){var t=e.getStartRow(),n=e.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(t,n)}},{key:"removeBlockFromCache",value:function(e){e&&this.destroyBlock(e)}},{key:"checkRowCount",value:function(e,t){if("number"===typeof t&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){var n=(e.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<n&&(this.rowCount=n)}}},{key:"setRowCount",value:function(e,t){this.rowCount=e,Vb.exists(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}},{key:"forEachNodeDeep",value:function(e){var t=this,n=new Wb;this.getBlocksInOrder().forEach((function(r){return r.forEachNode(e,n,t.rowCount)}))}},{key:"getBlocksInOrder",value:function(){var e=Vb.getAllValuesInObject(this.blocks).sort((function(e,t){return e.getId()-t.getId()}));return e}},{key:"destroyBlock",value:function(e){delete this.blocks[e.getId()],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}},{key:"onCacheUpdated",value:function(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();var e={type:Ym.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(e)}}},{key:"destroyAllBlocksPastVirtualRowCount",value:function(){var e=this,t=[];this.getBlocksInOrder().forEach((function(n){n.getId()*e.params.blockSize>=e.rowCount&&t.push(n)})),t.length>0&&t.forEach((function(t){return e.destroyBlock(t)}))}},{key:"purgeCache",value:function(){var e=this;this.getBlocksInOrder().forEach((function(t){return e.removeBlockFromCache(t)})),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}},{key:"getRowNodesInRange",value:function(e,t){var n=this,r=[],i=-1,o=!1,a=new Wb;Vb.missing(e)&&(o=!0);var s=!1;return this.getBlocksInOrder().forEach((function(l){s||(o&&i+1!==l.getId()?s=!0:(i=l.getId(),l.forEachNode((function(n){var i=n===e||n===t;(o||i)&&r.push(n),i&&(o=!o)}),a,n.rowCount)))})),s||o?[]:r}}]),n}(Vm);v_.MAX_EMPTY_BLOCKS_TO_KEEP=2,p_([nm("rowRenderer")],v_.prototype,"rowRenderer",void 0),p_([nm("focusService")],v_.prototype,"focusService",void 0),p_([function(e,t){return function(n,r){t(n,r,e)}}(0,om("loggerFactory"))],v_.prototype,"setBeans",null),p_([em],v_.prototype,"destroyAllBlocks",null);var g_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},m_=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"getRowBounds",value:function(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}},{key:"ensureRowHeightsValid",value:function(e,t,n,r){return!1}},{key:"init",value:function(){var e=this;this.gridOptionsService.isRowModelType("infinite")&&(this.rowHeight=this.gridOptionsService.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc((function(){return e.destroyCache()})),this.verifyProps())}},{key:"verifyProps",value:function(){if(this.gridOptionsService.exists("initialGroupOrderComparator")){Vb.doOnce((function(){return console.warn("AG Grid: initialGroupOrderComparator cannot be used with Infinite Row Model. If using Infinite Row Model, then sorting is done on the server side, nothing to do with the client.")}),"IRM.InitialGroupOrderComparator")}}},{key:"start",value:function(){this.setDatasource(this.gridOptionsService.get("datasource"))}},{key:"destroyDatasource",value:function(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}},{key:"addEventListeners",value:function(){this.addManagedListener(this.eventService,Ym.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,Ym.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this))}},{key:"onFilterChanged",value:function(){this.reset()}},{key:"onSortChanged",value:function(){this.reset()}},{key:"onColumnEverything",value:function(){(!this.cacheParams||this.isSortModelDifferent())&&this.reset()}},{key:"isSortModelDifferent",value:function(){return!Vb.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())}},{key:"getType",value:function(){return"infinite"}},{key:"setDatasource",value:function(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}},{key:"isEmpty",value:function(){return!this.infiniteCache}},{key:"isRowsToRender",value:function(){return!!this.infiniteCache}},{key:"getNodesInRangeForSelection",value:function(e,t){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(e,t):[]}},{key:"reset",value:function(){if(this.datasource){null!=this.gridOptionsService.getCallback("getRowId")||this.selectionService.reset(),this.resetCache();var e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}}},{key:"createModelUpdatedEvent",value:function(){return{type:Ym.EVENT_MODEL_UPDATED,newPage:!1,newData:!1,keepRenderedRows:!0,animate:!1}}},{key:"resetCache",value:function(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.defaultIfInvalid(this.gridOptionsService.getNum("infiniteInitialRowCount"),1),maxBlocksInCache:this.gridOptionsService.getNum("maxBlocksInCache"),rowHeight:this.gridOptionsService.getRowHeightAsNumber(),overflowSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheOverflowSize"),1),blockSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheBlockSize"),100),lastAccessedSequence:new Wb},this.infiniteCache=this.createBean(new v_(this.cacheParams))}},{key:"defaultIfInvalid",value:function(e,t){return e>0?e:t}},{key:"destroyCache",value:function(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}},{key:"onCacheUpdated",value:function(){var e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}},{key:"getRow",value:function(e){if(this.infiniteCache&&!(e>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(e)}},{key:"getRowNode",value:function(e){var t;return this.forEachNode((function(n){n.id===e&&(t=n)})),t}},{key:"forEachNode",value:function(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e)}},{key:"getTopLevelRowCount",value:function(){return this.getRowCount()}},{key:"getTopLevelRowDisplayedIndex",value:function(e){return e}},{key:"getRowIndexAtPixel",value:function(e){if(0!==this.rowHeight){var t=Math.floor(e/this.rowHeight),n=this.getRowCount()-1;return t>n?n:t}return 0}},{key:"getRowCount",value:function(){return this.infiniteCache?this.infiniteCache.getRowCount():0}},{key:"isRowPresent",value:function(e){return!!this.getRowNode(e.id)}},{key:"refreshCache",value:function(){this.infiniteCache&&this.infiniteCache.refreshCache()}},{key:"purgeCache",value:function(){this.infiniteCache&&this.infiniteCache.purgeCache()}},{key:"isLastRowIndexKnown",value:function(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()}},{key:"setRowCount",value:function(e,t){this.infiniteCache&&this.infiniteCache.setRowCount(e,t)}}]),n}(Vm);g_([nm("filterManager")],m_.prototype,"filterManager",void 0),g_([nm("sortController")],m_.prototype,"sortController",void 0),g_([nm("selectionService")],m_.prototype,"selectionService",void 0),g_([nm("rowRenderer")],m_.prototype,"rowRenderer",void 0),g_([nm("rowNodeBlockLoader")],m_.prototype,"rowNodeBlockLoader",void 0),g_([$g],m_.prototype,"init",null),g_([em],m_.prototype,"destroyDatasource",null),m_=g_([tm("rowModel")],m_);var y_={version:"30.0.5",moduleName:Xg.InfiniteRowModelModule,rowModel:"infinite",beans:[m_]},w_=function(){function e(){T(this,e)}return A(e,[{key:"setBeans",value:function(e){this.beans=e}},{key:"getFileName",value:function(e){var t=this.getDefaultFileExtension();return null!=e&&e.length||(e=this.getDefaultFileName()),-1===e.indexOf(".")?"".concat(e,".").concat(t):e}},{key:"getData",value:function(e){var t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}}]),e}(),b_=function(){function e(t){T(this,e),this.groupColumns=[];var n=t.columnModel,r=t.valueService,i=t.gridOptionsService,o=t.valueFormatterService,a=t.valueParserService,s=t.processCellCallback,l=t.processHeaderCallback,u=t.processGroupHeaderCallback,c=t.processRowGroupCallback;this.columnModel=n,this.valueService=r,this.gridOptionsService=i,this.valueFormatterService=o,this.valueParserService=a,this.processCellCallback=s,this.processHeaderCallback=l,this.processGroupHeaderCallback=u,this.processRowGroupCallback=c}return A(e,[{key:"prepare",value:function(e){this.groupColumns=e.filter((function(e){return!!e.getColDef().showRowGroup}))}},{key:"extractHeaderValue",value:function(e){var t=this.getHeaderName(this.processHeaderCallback,e);return null!=t?t:""}},{key:"extractRowCellValue",value:function(e,t,n,r,i){var o=this.gridOptionsService.is("groupHideOpenParents")&&!i.footer||!this.shouldRenderGroupSummaryCell(i,e,t)?this.valueService.getValue(e,i):this.createValueForGroupNode(i);return this.processCell({accumulatedRowIndex:n,rowNode:i,column:e,value:o,processCellCallback:this.processCellCallback,type:r})}},{key:"shouldRenderGroupSummaryCell",value:function(e,t,n){var r;if(!(e&&e.group))return!1;if(-1!==this.groupColumns.indexOf(t)){if(null!=(null===(r=e.groupData)||void 0===r?void 0:r[t.getId()]))return!0;if(e.footer&&-1===e.level){var i=t.getColDef();return null==i||!0===i.showRowGroup||i.showRowGroup===this.columnModel.getRowGroupColumns()[0].getId()}}var o=this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotMode());return 0===n&&o}},{key:"getHeaderName",value:function(e,t){return e?e({column:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):this.columnModel.getDisplayNameForColumn(t,"csv",!0)}},{key:"createValueForGroupNode",value:function(e){if(this.processRowGroupCallback)return this.processRowGroupCallback({node:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context});var t=e.footer,n=[e.key];if(!this.gridOptionsService.isGroupMultiAutoColumn())for(;e.parent;)e=e.parent,n.push(e.key);var r=n.reverse().join(" -> ");return t?"Total ".concat(r):r}},{key:"processCell",value:function(e){var t,n=this,r=e.accumulatedRowIndex,i=e.rowNode,o=e.column,a=e.value,s=e.processCellCallback,l=e.type;return s?{value:null!==(t=s({accumulatedRowIndex:r,column:o,node:i,value:a,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,type:l,parseValue:function(e){return n.valueParserService.parseValue(o,i,e,n.valueService.getValue(o,i))},formatValue:function(e){var t;return null!==(t=n.valueFormatterService.formatValue(o,i,e))&&void 0!==t?t:e}}))&&void 0!==t?t:""}:o.getColDef().useValueFormatterForExport?{value:null!==a&&void 0!==a?a:"",valueFormatted:this.valueFormatterService.formatValue(o,i,a)}:{value:null!==a&&void 0!==a?a:""}}}]),e}(),C_=function(){function e(){T(this,e)}return A(e,null,[{key:"download",value:function(e,t){var n=document.defaultView||window;if(n){var r=document.createElement("a"),i=n.URL.createObjectURL(t);r.setAttribute("href",i),r.setAttribute("download",e),r.style.display="none",document.body.appendChild(r),r.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:n})),document.body.removeChild(r),n.setTimeout((function(){n.URL.revokeObjectURL(i)}),0)}else console.warn("AG Grid: There is no `window` associated with the current `document`")}}]),e}(),S_=function(e){O(n,e);var t=F(n);function n(e){var r;T(this,n),(r=t.call(this,e)).isFirstLine=!0,r.result="";var i=e.suppressQuotes,o=e.columnSeparator;return r.suppressQuotes=i,r.columnSeparator=o,r}return A(n,[{key:"addCustomContent",value:function(e){var t=this;e&&("string"===typeof e?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,"\r\n"),this.result+=e):e.forEach((function(e){t.beginNewLine(),e.forEach((function(e,n){0!==n&&(t.result+=t.columnSeparator),t.result+=t.putInQuotes(e.data.value||""),e.mergeAcross&&t.appendEmptyCells(e.mergeAcross)}))})))}},{key:"onNewHeaderGroupingRow",value:function(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}},{key:"onNewHeaderGroupingRowColumn",value:function(e,t,n,r){0!=n&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(r)}},{key:"appendEmptyCells",value:function(e){for(var t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}},{key:"onNewHeaderRow",value:function(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}},{key:"onNewHeaderRowColumn",value:function(e,t){0!=t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}},{key:"onNewBodyRow",value:function(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}},{key:"onNewBodyRowColumn",value:function(e,t,n){var r;0!=t&&(this.result+=this.columnSeparator);var i=this.extractRowCellValue(e,t,t,"csv",n);this.result+=this.putInQuotes(null!==(r=i.valueFormatted)&&void 0!==r?r:i.value)}},{key:"putInQuotes",value:function(e){return this.suppressQuotes?e:null===e||void 0===e?'""':("string"===typeof e?t=e:"function"===typeof e.toString?t=e.toString():(console.warn("AG Grid: unknown value type during csv conversion"),t=""),'"'+t.replace(/"/g,'""')+'"');var t}},{key:"parse",value:function(){return this.result}},{key:"beginNewLine",value:function(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1}}]),n}(b_),E_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},k_=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"postConstruct",value:function(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsService:this.gridOptionsService})}},{key:"getMergedParams",value:function(e){var t=this.gridOptionsService.get("defaultCsvExportParams");return Object.assign({},t,e)}},{key:"export",value:function(e){if(this.isExportSuppressed())return console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration."),"";var t=this.getMergedParams(e),n=this.getData(t),r=new Blob(["\ufeff",n],{type:"text/plain"});return C_.download(this.getFileName(t.fileName),r),n}},{key:"exportDataAsCsv",value:function(e){return this.export(e)}},{key:"getDataAsCsv",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?Object.assign({},e):this.getMergedParams(e);return this.getData(t)}},{key:"getDefaultFileName",value:function(){return"export.csv"}},{key:"getDefaultFileExtension",value:function(){return"csv"}},{key:"createSerializingSession",value:function(e){var t=this.columnModel,n=this.valueService,r=this.gridOptionsService,i=this.valueFormatterService,o=this.valueParserService,a=e.processCellCallback,s=e.processHeaderCallback,l=e.processGroupHeaderCallback,u=e.processRowGroupCallback,c=e.suppressQuotes,d=e.columnSeparator;return new S_({columnModel:t,valueService:n,gridOptionsService:r,valueFormatterService:i,valueParserService:o,processCellCallback:a||void 0,processHeaderCallback:s||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:u||void 0,suppressQuotes:c||!1,columnSeparator:d||","})}},{key:"isExportSuppressed",value:function(){return this.gridOptionsService.is("suppressCsvExport")}}]),n}(w_);E_([nm("columnModel")],k_.prototype,"columnModel",void 0),E_([nm("valueService")],k_.prototype,"valueService",void 0),E_([nm("gridSerializer")],k_.prototype,"gridSerializer",void 0),E_([nm("gridOptionsService")],k_.prototype,"gridOptionsService",void 0),E_([nm("valueFormatterService")],k_.prototype,"valueFormatterService",void 0),E_([nm("valueParserService")],k_.prototype,"valueParserService",void 0),E_([$g],k_.prototype,"postConstruct",null),k_=E_([tm("csvCreator")],k_);var x_,T_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e[e.HEADER_GROUPING=0]="HEADER_GROUPING",e[e.HEADER=1]="HEADER",e[e.BODY=2]="BODY"}(x_||(x_={}));var R_=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"serialize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getColumnsToExport(t.allColumns,t.columnKeys);return Vb.compose(this.prepareSession(n),this.prependContent(t),this.exportColumnGroups(t,n),this.exportHeaders(t,n),this.processPinnedTopRows(t,n),this.processRows(t,n),this.processPinnedBottomRows(t,n),this.appendContent(t))(e).parse()}},{key:"processRow",value:function(e,t,n,r){var i=t.shouldRowBeSkipped||function(){return!1},o=this.gridOptionsService.context,a=this.gridOptionsService.api,s=this.gridOptionsService.columnApi,l=this.gridOptionsService.is("groupRemoveSingleChildren"),u=this.gridOptionsService.is("groupRemoveLowestSingleChildren"),c=null!=t.rowPositions||!!t.onlySelected,d=this.gridOptionsService.is("groupHideOpenParents")&&!c,h=this.columnModel.isPivotMode()?r.leafGroup:!r.group,f=!!r.footer,p=t.skipGroups||t.skipRowGroups,v=u&&r.leafGroup,g=1===r.allChildrenCount&&(l||v);if((p&&t.skipGroups&&Vb.doOnce((function(){return console.warn("AG Grid: Since v25.2 `skipGroups` has been renamed to `skipRowGroups`.")}),"gridSerializer-skipGroups"),!(!h&&!f&&(t.skipRowGroups||g||d)||t.onlySelected&&!r.isSelected()||t.skipPinnedTop&&"top"===r.rowPinned||t.skipPinnedBottom&&"bottom"===r.rowPinned))&&((!(-1===r.level)||h||f)&&!i({node:r,api:a,columnApi:s,context:o}))){var m=e.onNewBodyRow(r);if(n.forEach((function(e,t){m.onColumn(e,t,r)})),t.getCustomContentBelowRow){var y=t.getCustomContentBelowRow({node:r,api:a,columnApi:s,context:o});y&&e.addCustomContent(y)}}}},{key:"appendContent",value:function(e){return function(t){var n=e.customFooter||e.appendContent;return n&&(e.customFooter&&Vb.doOnce((function(){return console.warn("AG Grid: Since version 25.2.0 the `customFooter` param has been deprecated. Use `appendContent` instead.")}),"gridSerializer-customFooter"),t.addCustomContent(n)),t}}},{key:"prependContent",value:function(e){return function(t){var n=e.customHeader||e.prependContent;return n&&(e.customHeader&&Vb.doOnce((function(){return console.warn("AG Grid: Since version 25.2.0 the `customHeader` param has been deprecated. Use `prependContent` instead.")}),"gridSerializer-customHeader"),t.addCustomContent(n)),t}}},{key:"prepareSession",value:function(e){return function(t){return t.prepare(e),t}}},{key:"exportColumnGroups",value:function(e,t){var n=this;return function(r){if(e.skipColumnGroupHeaders)e.columnGroups&&Vb.doOnce((function(){return console.warn("AG Grid: Since v25.2 the `columnGroups` param has deprecated, and groups are exported by default.")}),"gridSerializer-columnGroups");else{var i=new Qm,o=n.displayedGroupCreator.createDisplayedGroups(t,n.columnModel.getGridBalancedTree(),i,null);n.recursivelyAddHeaderGroups(o,r,e.processGroupHeaderCallback)}return r}}},{key:"exportHeaders",value:function(e,t){return function(n){if(e.skipHeader||e.skipColumnHeaders)e.skipHeader&&Vb.doOnce((function(){return console.warn("AG Grid: Since v25.2 the `skipHeader` param has been renamed to `skipColumnHeaders`.")}),"gridSerializer-skipHeader");else{var r=n.onNewHeaderRow();t.forEach((function(e,t){r.onColumn(e,t,void 0)}))}return n}}},{key:"processPinnedTopRows",value:function(e,t){var n=this;return function(r){var i=n.processRow.bind(n,r,e,t);return e.rowPositions?e.rowPositions.filter((function(e){return"top"===e.rowPinned})).sort((function(e,t){return e.rowIndex-t.rowIndex})).map((function(e){return n.pinnedRowModel.getPinnedTopRow(e.rowIndex)})).forEach(i):n.pinnedRowModel.forEachPinnedTopRow(i),r}}},{key:"processRows",value:function(e,t){var n=this;return function(r){var i=n.rowModel,o=i.getType(),a="clientSide"===o,s="serverSide"===o,l=!a&&e.onlySelected,u=n.processRow.bind(n,r,e,t),c=e.exportedRows,d=void 0===c?"filteredAndSorted":c;if(e.rowPositions)e.rowPositions.filter((function(e){return null==e.rowPinned})).sort((function(e,t){return e.rowIndex-t.rowIndex})).map((function(e){return i.getRow(e.rowIndex)})).forEach(u);else if(n.columnModel.isPivotMode())a?i.forEachPivotNode(u,!0):i.forEachNode(u);else if(e.onlySelectedAllPages||l){var h=n.selectionService.getSelectedNodes();n.replicateSortedOrder(h),h.forEach(u)}else"all"===d?i.forEachNode(u):a?i.forEachNodeAfterFilterAndSort(u,!0):s?i.forEachNodeAfterFilterAndSort(u):i.forEachNode(u);return r}}},{key:"replicateSortedOrder",value:function(e){var t=this,n=this.sortController.getSortOptions();e.sort((function e(r,i){var o,a,s,l;return null!=r.rowIndex&&null!=i.rowIndex?r.rowIndex-i.rowIndex:r.level===i.level?(null===(o=r.parent)||void 0===o?void 0:o.id)===(null===(a=i.parent)||void 0===a?void 0:a.id)?t.rowNodeSorter.compareRowNodes(n,{rowNode:r,currentPos:null!==(s=r.rowIndex)&&void 0!==s?s:-1},{rowNode:i,currentPos:null!==(l=i.rowIndex)&&void 0!==l?l:-1}):e(r.parent,i.parent):r.level>i.level?e(r.parent,i):e(r,i.parent)}))}},{key:"processPinnedBottomRows",value:function(e,t){var n=this;return function(r){var i=n.processRow.bind(n,r,e,t);return e.rowPositions?e.rowPositions.filter((function(e){return"bottom"===e.rowPinned})).sort((function(e,t){return e.rowIndex-t.rowIndex})).map((function(e){return n.pinnedRowModel.getPinnedBottomRow(e.rowIndex)})).forEach(i):n.pinnedRowModel.forEachPinnedBottomRow(i),r}}},{key:"getColumnsToExport",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=this.columnModel.isPivotMode();return t&&t.length?this.columnModel.getGridColumns(t):e&&!n?(this.gridOptionsService.isTreeData()?this.columnModel.getGridColumns([Jm]):[]).concat(this.columnModel.getAllGridColumns()||[]):this.columnModel.getAllDisplayedColumns()}},{key:"recursivelyAddHeaderGroups",value:function(e,t,n){var r=[];e.forEach((function(e){var t=e;t.getChildren&&t.getChildren().forEach((function(e){return r.push(e)}))})),e.length>0&&e[0]instanceof Xm&&this.doAddHeaderHeader(t,e,n),r&&r.length>0&&this.recursivelyAddHeaderGroups(r,t,n)}},{key:"doAddHeaderHeader",value:function(e,t,n){var r=this,i=e.onNewHeaderGroupingRow(),o=0;t.forEach((function(e){var t,a=e;t=n?n({columnGroup:a,api:r.gridOptionsService.api,columnApi:r.gridOptionsService.columnApi,context:r.gridOptionsService.context}):r.columnModel.getDisplayNameForColumnGroup(a,"header");var s=a.getLeafColumns().reduce((function(e,t,n,r){var i=Vb.last(e);return"open"===t.getColumnGroupShow()?i&&null==i[1]||(i=[n],e.push(i)):i&&null==i[1]&&(i[1]=n-1),n===r.length-1&&i&&null==i[1]&&(i[1]=n),e}),[]);i.onColumn(a,t||"",o++,a.getLeafColumns().length-1,s)}))}}]),n}(Vm);T_([nm("displayedGroupCreator")],R_.prototype,"displayedGroupCreator",void 0),T_([nm("columnModel")],R_.prototype,"columnModel",void 0),T_([nm("rowModel")],R_.prototype,"rowModel",void 0),T_([nm("pinnedRowModel")],R_.prototype,"pinnedRowModel",void 0),T_([nm("selectionService")],R_.prototype,"selectionService",void 0),T_([nm("rowNodeSorter")],R_.prototype,"rowNodeSorter",void 0),T_([nm("sortController")],R_.prototype,"sortController",void 0),R_=T_([tm("gridSerializer")],R_);var A_={version:"30.0.5",moduleName:Xg.CsvExportModule,beans:[k_,R_]},__=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),O_=function(){function e(){T(this,e)}return A(e,null,[{key:"addFolders",value:function(e){e.forEach(this.addFolder.bind(this))}},{key:"addFolder",value:function(e){this.folders.push({path:e,created:new Date,isBase64:!1})}},{key:"addFile",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.files.push({path:e,created:new Date,content:t,isBase64:n})}},{key:"getContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"application/zip",t=this.buildFileStream(),n=this.buildUint8Array(t);return this.clearStream(),new Blob([n],{type:e})}},{key:"clearStream",value:function(){this.folders=[],this.files=[]}},{key:"buildFileStream",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=this.folders.concat(this.files),r=n.length,i="",o=0,a=0,s=dg(n);try{for(s.s();!(e=s.n()).done;){var l=e.value,u=this.getHeader(l,o),c=u.fileHeader,d=u.folderHeader,h=u.content;o+=c.length+h.length,a+=d.length,t+=c+h,i+=d}}catch(f){s.e(f)}finally{s.f()}return t+i+this.buildFolderEnd(r,a,o)}},{key:"getHeader",value:function(e,t){var n=e.content,r=e.path,i=e.created,o=e.isBase64,a=Vb.utf8_encode,s=Vb.decToHex,l=a(r),u=l!==r,c=this.convertTime(i),d=this.convertDate(i),h="";if(u){var f=s(1,1)+s(this.getFromCrc32Table(l),4)+l;h="up"+s(f.length,2)+f}var p=n?this.getConvertedContent(n,o):{size:0,content:""},v=p.size,g=p.content,m="\n\0"+(u?"\0\b":"\0\0")+"\0\0"+s(c,2)+s(d,2)+s(v?this.getFromCrc32Table(g):0,4)+s(v,4)+s(v,4)+s(l.length,2)+s(h.length,2);return{fileHeader:"PK\x03\x04"+m+l+h,folderHeader:"PK\x01\x02\x14\0"+m+"\0\0\0\0\0\0"+(n?"\0\0\0\0":"\x10\0\0\0")+s(t,4)+l+h,content:g||""}}},{key:"getConvertedContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t&&(e=e.split(";base64,")[1]),{size:(e=t?atob(e):e).length,content:e}}},{key:"buildFolderEnd",value:function(e,t,n){var r=Vb.decToHex;return"PK\x05\x06\0\0\0\0"+r(e,2)+r(e,2)+r(t,4)+r(n,4)+"\0\0"}},{key:"buildUint8Array",value:function(e){for(var t=new Uint8Array(e.length),n=0;n<t.length;n++)t[n]=e.charCodeAt(n);return t}},{key:"getFromCrc32Table",value:function(e){if(!e.length)return 0;for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);for(var i=-1,o=0,a=0;a<t;a++)o=n[a],i=i>>>8^__[255&(i^o)];return-1^i}},{key:"convertTime",value:function(e){var t=e.getHours();return t<<=6,t|=e.getMinutes(),t<<=5,t|=e.getSeconds()/2}},{key:"convertDate",value:function(e){var t=e.getFullYear()-1980;return t<<=4,t|=e.getMonth()+1,t<<=5,t|=e.getDate()}}]),e}();O_.folders=[],O_.files=[];var D_=[d_,y_,A_];Qg.registerModules(D_);var N_=n(4164),P_=function(e){O(n,e);var t=F(n);function n(e,r,i){var o;return T(this,n),(o=t.call(this)).portal=null,o.reactComponent=e,o.portalManager=r,o.componentType=i,o.statelessComponent=o.isStateless(o.reactComponent),o}return A(n,[{key:"getGui",value:function(){return this.eParentElement}},{key:"destroy",value:function(){return this.componentInstance&&"function"==typeof this.componentInstance.destroy&&this.componentInstance.destroy(),this.portalManager.destroyPortal(this.portal)}},{key:"createParentElement",value:function(e){var t=this.portalManager.getComponentWrappingElement(),n=document.createElement(t||"div");return n.classList.add("ag-react-container"),e.reactContainer=n,n}},{key:"addParentContainerStyleAndClasses",value:function(){var e=this;this.componentInstance&&(this.componentInstance.getReactContainerStyle&&this.componentInstance.getReactContainerStyle()&&Object.assign(this.eParentElement.style,this.componentInstance.getReactContainerStyle()),this.componentInstance.getReactContainerClasses&&this.componentInstance.getReactContainerClasses()&&this.componentInstance.getReactContainerClasses().forEach((function(t){return e.eParentElement.classList.add(t)})))}},{key:"statelessComponentRendered",value:function(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}},{key:"getFrameworkComponentInstance",value:function(){return this.componentInstance}},{key:"isStatelessComponent",value:function(){return this.statelessComponent}},{key:"getReactComponentName",value:function(){return this.reactComponent.name}},{key:"getMemoType",value:function(){return this.hasSymbol()?Symbol.for("react.memo"):60115}},{key:"hasSymbol",value:function(){return"function"===typeof Symbol&&Symbol.for}},{key:"isStateless",value:function(e){return"function"===typeof e&&!(e.prototype&&e.prototype.isReactComponent)||"object"===typeof e&&e.$$typeof===this.getMemoType()}},{key:"hasMethod",value:function(e){var t=this.getFrameworkComponentInstance();return!!t&&null!==t[e]||this.fallbackMethodAvailable(e)}},{key:"callMethod",value:function(e,t){var n=this,r=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,t&&t[0]?t[0]:{});if(r){var i=r[e];return i?i.apply(r,t):this.fallbackMethodAvailable(e)?this.fallbackMethod(e,t&&t[0]?t[0]:{}):void 0}setTimeout((function(){return n.callMethod(e,t)}))}},{key:"addMethod",value:function(e,t){this[e]=t}}]),n}(A((function e(){T(this,e)}))),F_=n(8340),I_=0;function L_(){return"agPortalKey_".concat(++I_)}var M_=function(t){O(r,t);var n=F(r);function r(e,t,i,o){var a;return T(this,r),(a=n.call(this,e,i,o)).staticMarkup=null,a.staticRenderTime=0,a.parentComponent=t,a}return A(r,[{key:"init",value:function(e){var t=this;return this.eParentElement=this.createParentElement(e),this.renderStaticMarkup(e),new Ub((function(n){return t.createReactComponent(e,n)}))}},{key:"createReactComponent",value:function(t,n){var r=this;this.isStatelessComponent()||(t.ref=function(e){r.componentInstance=e,r.addParentContainerStyleAndClasses(),r.removeStaticMarkup()});var i=(0,e.createElement)(this.reactComponent,t),o=(0,N_.createPortal)(i,this.eParentElement,L_());this.portal=o,this.portalManager.mountReactPortal(o,this,(function(e){n(e),r.isStatelessComponent()&&(r.isSlowRenderer()&&r.removeStaticMarkup(),setTimeout((function(){r.removeStaticMarkup()})))}))}},{key:"fallbackMethodAvailable",value:function(e){return!1}},{key:"fallbackMethod",value:function(e,t){}},{key:"isSlowRenderer",value:function(){return this.staticRenderTime>=r.SLOW_RENDERING_THRESHOLD}},{key:"isNullValue",value:function(){return""===this.staticMarkup}},{key:"renderStaticMarkup",value:function(t){if(!this.parentComponent.isDisableStaticMarkup()&&this.componentType.cellRenderer){var n=console.error,r=(0,e.createElement)(this.reactComponent,t);try{console.error=function(){};var i=Date.now(),o=(0,F_.uS)(r);this.staticRenderTime=Date.now()-i,console.error=n,""===o?this.staticMarkup=o:o&&(this.staticMarkup=document.createElement("span"),this.staticMarkup.innerHTML=o,this.eParentElement.appendChild(this.staticMarkup))}catch(a){}finally{console.error=n}}}},{key:"removeStaticMarkup",value:function(){!this.parentComponent.isDisableStaticMarkup()&&this.componentType.cellRenderer&&this.staticMarkup&&(this.staticMarkup.remove?(this.staticMarkup.remove(),this.staticMarkup=null):this.eParentElement.removeChild&&(this.eParentElement.removeChild(this.staticMarkup),this.staticMarkup=null))}},{key:"rendered",value:function(){return this.isNullValue()||!!this.staticMarkup||this.isStatelessComponent()&&this.statelessComponentRendered()||!(this.isStatelessComponent()||!this.getFrameworkComponentInstance())}}]),r}(P_);M_.SLOW_RENDERING_THRESHOLD=3;var G_=function(t){O(r,t);var n=F(r);function r(e,t,i){var o;return T(this,r),(o=n.call(this,e,t,i)).oldPortal=null,o.key=L_(),o.portalKey=L_(),o}return A(r,[{key:"init",value:function(e){var t=this;return this.eParentElement=this.createParentElement(e),this.params=e,this.createOrUpdatePortal(e),new Ub((function(e){return t.createReactComponent(e)}))}},{key:"createOrUpdatePortal",value:function(t){var n=this;this.isStatelessComponent()||(t.ref=function(e){n.componentInstance=e,n.addParentContainerStyleAndClasses()}),this.reactElement=(0,e.createElement)(this.reactComponent,Object.assign(Object.assign({},t),{key:this.key})),this.portal=(0,N_.createPortal)(this.reactElement,this.eParentElement,this.portalKey)}},{key:"createReactComponent",value:function(e){this.portalManager.mountReactPortal(this.portal,this,(function(t){e(t)}))}},{key:"isNullValue",value:function(){return this.valueRenderedIsNull(this.params)}},{key:"rendered",value:function(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!(this.isStatelessComponent()||!this.getFrameworkComponentInstance())}},{key:"valueRenderedIsNull",value:function(t){if(!this.componentType.cellRenderer)return!1;var n=console.error;try{return console.error=function(){},""===(0,F_.uS)((0,e.createElement)(this.reactComponent,t))}catch(r){}finally{console.error=n}return!1}},{key:"refreshComponent",value:function(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}},{key:"fallbackMethod",value:function(e,t){var n=this["".concat(e,"Component")];if(n)return n.bind(this)(t)}},{key:"fallbackMethodAvailable",value:function(e){return!!this["".concat(e,"Component")]}}]),r}(P_),B_=function(){function e(t,n,r){T(this,e),this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=n||"div",this.parent=t,this.maxComponentCreationTimeMs=r||e.MAX_COMPONENT_CREATION_TIME_IN_MS}return A(e,[{key:"getPortals",value:function(){return this.portals}},{key:"destroy",value:function(){this.destroyed=!0}},{key:"destroyPortal",value:function(e){this.portals=this.portals.filter((function(t){return t!==e})),this.batchUpdate()}},{key:"getComponentWrappingElement",value:function(){return this.wrappingElement}},{key:"mountReactPortal",value:function(e,t,n){this.portals=[].concat(wt(this.portals),[e]),this.waitForInstance(t,n),this.batchUpdate()}},{key:"updateReactPortal",value:function(e,t){this.portals[this.portals.indexOf(e)]=t,this.batchUpdate()}},{key:"batchUpdate",value:function(){var e=this;this.hasPendingPortalUpdate||(setTimeout((function(){e.destroyed||e.parent.forceUpdate((function(){e.hasPendingPortalUpdate=!1}))})),this.hasPendingPortalUpdate=!0)}},{key:"waitForInstance",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();if(this.destroyed)t(null);else if(e.rendered())t(e);else{if(Date.now()-r>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate)return e.isNullValue()?void t(e):void console.error("AG Grid: React Component '".concat(e.getReactComponentName(),"' not created within ").concat(this.maxComponentCreationTimeMs,"ms"));window.setTimeout((function(){n.waitForInstance(e,t,r)}))}}}]),e}();B_.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3;var j_=function(){function e(t,n,r){T(this,e),this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=n||"div",this.refresher=t,this.maxComponentCreationTimeMs=r||e.MAX_COMPONENT_CREATION_TIME_IN_MS}return A(e,[{key:"getPortals",value:function(){return this.portals}},{key:"destroy",value:function(){this.destroyed=!0}},{key:"destroyPortal",value:function(e){this.portals=this.portals.filter((function(t){return t!==e})),this.batchUpdate()}},{key:"getComponentWrappingElement",value:function(){return this.wrappingElement}},{key:"mountReactPortal",value:function(e,t,n){this.portals=[].concat(wt(this.portals),[e]),this.waitForInstance(t,n),this.batchUpdate()}},{key:"updateReactPortal",value:function(e,t){this.portals[this.portals.indexOf(e)]=t,this.batchUpdate()}},{key:"batchUpdate",value:function(){var e=this;this.hasPendingPortalUpdate||(setTimeout((function(){e.destroyed||(e.refresher(),e.hasPendingPortalUpdate=!1)})),this.hasPendingPortalUpdate=!0)}},{key:"waitForInstance",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();if(this.destroyed)t(null);else if(e.rendered())t(e);else{if(Date.now()-r>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate)return e.isNullValue()?void t(e):void console.error("AG Grid: React Component '".concat(e.getReactComponentName(),"' not created within ").concat(this.maxComponentCreationTimeMs,"ms"));window.setTimeout((function(){n.waitForInstance(e,t,r)}))}}}]),e}();j_.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3;var H_,V_=e.createContext({}),W_=function(e,t,n,r){if(!(!e||e.componentFromFramework||t.isDestroyed())){var i=e.newAgStackInstance();if(i){var o,a,s=!1;return i.then((function(e){s?t.destroyBean(e):(a=(o=e).getGui(),n.appendChild(a),z_(r,o))})),function(){s=!0,o&&(a&&a.parentElement&&a.parentElement.removeChild(a),t.destroyBean(o),r&&z_(r,void 0))}}}},z_=function(e,t){e&&(e instanceof Function?e(t):e.current=t)},U_=function(t){var n=(0,e.useRef)(t),r=(0,e.useRef)(),i=(0,e.useRef)(!1),o=(0,e.useRef)(!1),a=Y((0,e.useState)(0),2)[1];i.current&&(o.current=!0),(0,e.useLayoutEffect)((function(){return i.current||(r.current=n.current(),i.current=!0),a((function(e){return e+1})),function(){o.current&&r.current&&r.current()}}),[])},K_=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return null!=e&&""!==e})).join(" ")},q_=function(){function e(){var t=this;T(this,e),this.classesMap={};for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach((function(e){t.classesMap[e]=!0}))}return A(e,[{key:"setClass",value:function(t,n){if(!!this.classesMap[t]==n)return this;var r=new e;return r.classesMap=Object.assign({},this.classesMap),r.classesMap[t]=n,r}},{key:"toString",value:function(){var e=this;return Object.keys(this.classesMap).filter((function(t){return e.classesMap[t]})).join(" ")}}]),e}(),X_=function(e){return"function"===typeof e&&!(e.prototype&&e.prototype.isReactComponent)||"object"===typeof e&&e.$$typeof===("function"===typeof Symbol&&Symbol.for?Symbol.for("react.memo"):60115)},Y_=null!=N_.createRoot&&null!=N_.flushSync,Q_=function(e,t){Y_&&e?N_.flushSync(t):t()},Z_=(0,e.forwardRef)((function(t,n){var r=(0,e.useContext)(V_).context,i=(0,e.useRef)(null),o=(0,e.useRef)(null),a=(0,e.useRef)(null),s=(0,e.useRef)(null),l=(0,e.useRef)(null),u=Y((0,e.useState)(),2),c=u[0],d=u[1],h=Y((0,e.useState)(),2),f=h[0],p=h[1],v=Y((0,e.useState)(),2),g=v[0],m=v[1],y=Y((0,e.useState)(new q_),2),w=y[0],b=y[1],C=Y((0,e.useState)(new q_("ag-hidden")),2),S=C[0],E=C[1],k=Y((0,e.useState)(new q_("ag-hidden")),2),x=k[0],T=k[1],R=Y((0,e.useState)(new q_("ag-invisible")),2),A=R[0],_=R[1];(0,e.useImperativeHandle)(n,(function(){return{refresh:function(){return!1}}})),(0,e.useLayoutEffect)((function(){return W_(c,r,o.current)}),[c]),U_((function(){var e={setInnerRenderer:function(e,t){d(e),m(t)},setChildCount:function(e){return p(e)},addOrRemoveCssClass:function(e,t){return b((function(n){return n.setClass(e,t)}))},setContractedDisplayed:function(e){return T((function(t){return t.setClass("ag-hidden",!e)}))},setExpandedDisplayed:function(e){return E((function(t){return t.setClass("ag-hidden",!e)}))},setCheckboxVisible:function(e){return _((function(t){return t.setClass("ag-invisible",!e)}))}},n=r.createBean(new NS);return n.init(e,i.current,a.current,s.current,l.current,Z_,t),function(){r.destroyBean(n)}}));var O=(0,e.useMemo)((function(){return"ag-cell-wrapper ".concat(w.toString())}),[w]),D=(0,e.useMemo)((function(){return"ag-group-expanded ".concat(S.toString())}),[S]),N=(0,e.useMemo)((function(){return"ag-group-contracted ".concat(x.toString())}),[x]),P=(0,e.useMemo)((function(){return"ag-group-checkbox ".concat(A.toString())}),[A]),F=c&&c.componentFromFramework,I=F?c.componentClass:void 0,L=null==c&&null!=g,M=Vb.escapeString(g,!0);return e.createElement("span",Object.assign({className:O,ref:i},t.colDef?{}:{role:"gridcell"}),e.createElement("span",{className:D,ref:s}),e.createElement("span",{className:N,ref:l}),e.createElement("span",{className:P,ref:a}),e.createElement("span",{className:"ag-group-value",ref:o},L&&e.createElement(e.Fragment,null,M),F&&e.createElement(I,Object.assign({},c.params))),e.createElement("span",{className:"ag-group-child-count"},f))})),J_=Z_,$_=(0,e.memo)((function(t){var n=(0,e.useContext)(V_).context,r=Y((0,e.useState)(),2),i=r[0],o=r[1],a=Y((0,e.useState)(),2),s=a[0],l=a[1],u=Y((0,e.useState)(),2),c=u[0],d=u[1],h=Y((0,e.useState)(),2),f=h[0],p=h[1],v=Y((0,e.useState)(),2),g=v[0],m=v[1],y=(0,e.useRef)(null),w=(0,e.useRef)(null),b=(0,e.useRef)(null),C=(0,e.useRef)(),S=t.ctrl,E=(0,e.useMemo)((function(){return new Xb((function(){return y.current}))}),[]);U_((function(){var e,t={setWidth:function(e){y.current&&(y.current.style.width=e)},addOrRemoveCssClass:function(e,t){return E.addOrRemoveCssClass(e,t)},setColId:function(e){return l(e)},setTitle:function(e){return o(e)},setAriaDescription:function(e){return p(e)},setAriaSort:function(e){return d(e)},setUserCompDetails:function(e){return m(e)},getUserCompInstance:function(){return C.current||void 0}};S.setComp(t,y.current,w.current,b.current);var n=S.getSelectAllGui();null===(e=w.current)||void 0===e||e.insertAdjacentElement("afterend",n)})),(0,e.useLayoutEffect)((function(){return W_(g,n,b.current,C)}),[g]),(0,e.useEffect)((function(){S.setDragSource(y.current)}),[g]);var k=(0,e.useMemo)((function(){return!!((null===g||void 0===g?void 0:g.componentFromFramework)&&X_(g.componentClass))}),[g]),x=g&&g.componentFromFramework,T=g&&g.componentClass;return e.createElement("div",{ref:y,className:"ag-header-cell",title:i,"col-id":s,"aria-sort":c,role:"columnheader",tabIndex:-1,"aria-description":f},e.createElement("div",{ref:w,className:"ag-header-cell-resize",role:"presentation"}),e.createElement("div",{ref:b,className:"ag-header-cell-comp-wrapper",role:"presentation"},x&&k&&e.createElement(T,Object.assign({},g.params)),x&&!k&&e.createElement(T,Object.assign({},g.params,{ref:C}))))})),eO=(0,e.memo)((function(t){var n=(0,e.useContext)(V_).context,r=Y((0,e.useState)(new q_),2),i=r[0],o=r[1],a=Y((0,e.useState)(new q_),2),s=a[0],l=a[1],u=Y((0,e.useState)("false"),2),c=u[0],d=u[1],h=Y((0,e.useState)(),2),f=h[0],p=h[1],v=Y((0,e.useState)(),2),g=v[0],m=v[1],y=Y((0,e.useState)(),2),w=y[0],b=y[1],C=Y((0,e.useState)(),2),S=C[0],E=C[1],k=(0,e.useRef)(null),x=(0,e.useRef)(null),T=t.ctrl;U_((function(){var e={setWidth:function(e){k.current&&(k.current.style.width=e)},addOrRemoveCssClass:function(e,t){return o((function(n){return n.setClass(e,t)}))},setColId:function(e){return m(e)},setTitle:function(e){return p(e)},setUserCompDetails:function(e){return E(e)},setResizableDisplayed:function(e){l((function(t){return t.setClass("ag-hidden",!e)})),d(e?"false":"true")},setAriaExpanded:function(e){return b(e)}};T.setComp(e,k.current,x.current)})),(0,e.useLayoutEffect)((function(){return W_(S,n,k.current)}),[S]),(0,e.useEffect)((function(){k.current&&T.setDragSource(k.current)}),[S]);var R=(0,e.useMemo)((function(){return"ag-header-group-cell "+i.toString()}),[i]),A=(0,e.useMemo)((function(){return"ag-header-cell-resize "+s.toString()}),[s]),_=S&&S.componentFromFramework,O=S&&S.componentClass;return e.createElement("div",{ref:k,className:R,title:f,"col-id":g,role:"columnheader",tabIndex:-1,"aria-expanded":w},_&&e.createElement(O,Object.assign({},S.params)),e.createElement("div",{ref:x,"aria-hidden":c,className:A}))})),tO=(0,e.memo)((function(t){var n=(0,e.useContext)(V_).context,r=Y((0,e.useState)(new q_("ag-header-cell","ag-floating-filter")),2),i=r[0],o=r[1],a=Y((0,e.useState)(new q_),2),s=a[0],l=a[1],u=Y((0,e.useState)(new q_("ag-floating-filter-button","ag-hidden")),2),c=u[0],d=u[1],h=Y((0,e.useState)("false"),2),f=h[0],p=h[1],v=Y((0,e.useState)(),2),g=v[0],m=v[1],y=(0,e.useRef)(null),w=(0,e.useRef)(null),b=(0,e.useRef)(null),C=(0,e.useRef)(null),S=(0,e.useRef)(),E=(0,e.useRef)(),k=function(e){null!=e&&S.current&&S.current(e)},x=t.ctrl;U_((function(){E.current=new Ub((function(e){S.current=e}));var e={addOrRemoveCssClass:function(e,t){return o((function(n){return n.setClass(e,t)}))},addOrRemoveBodyCssClass:function(e,t){return l((function(n){return n.setClass(e,t)}))},setButtonWrapperDisplayed:function(e){d((function(t){return t.setClass("ag-hidden",!e)})),p(e?"false":"true")},setWidth:function(e){y.current&&(y.current.style.width=e)},setCompDetails:function(e){return m(e)},getFloatingFilterComp:function(){return E.current?E.current:null},setMenuIcon:function(e){var t;return null===(t=C.current)||void 0===t?void 0:t.appendChild(e)}};x.setComp(e,y.current,C.current,w.current)})),(0,e.useLayoutEffect)((function(){return W_(g,n,w.current,k)}),[g]);var T=(0,e.useMemo)((function(){return i.toString()}),[i]),R=(0,e.useMemo)((function(){return s.toString()}),[s]),A=(0,e.useMemo)((function(){return c.toString()}),[c]),_=(0,e.useMemo)((function(){return!!(g&&g.componentFromFramework&&X_(g.componentClass))}),[g]),O=g&&g.componentFromFramework,D=g&&g.componentClass;return e.createElement("div",{ref:y,className:T,role:"gridcell",tabIndex:-1},e.createElement("div",{ref:w,className:R,role:"presentation"},O&&_&&e.createElement(D,Object.assign({},g.params)),O&&!_&&e.createElement(D,Object.assign({},g.params,{ref:k}))),e.createElement("div",{ref:b,"aria-hidden":f,className:A,role:"presentation"},e.createElement("button",{ref:C,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))})),nO=(0,e.memo)((function(t){var n=(0,e.useContext)(V_).gridOptionsService,r=Y((0,e.useState)(),2),i=r[0],o=r[1],a=Y((0,e.useState)(),2),s=a[0],l=a[1],u=Y((0,e.useState)(),2),c=u[0],d=u[1],h=Y((0,e.useState)(),2),f=h[0],p=h[1],v=Y((0,e.useState)([]),2),g=v[0],m=v[1],y=(0,e.useRef)(null),w=t.ctrl,b=w.getType()===ax.COLUMN,C=w.getType()===ax.COLUMN_GROUP,S=w.getType()===ax.FLOATING_FILTER,E=(0,e.useCallback)((function(e,t){var r=n.is("ensureDomOrder"),i=n.isDomLayout("print");if(r||i)return t;var o=Vb.mapById(e,(function(e){return e.getInstanceId()})),a=Vb.mapById(t,(function(e){return e.getInstanceId()})),s=e.filter((function(e){return a.has(e.getInstanceId())})),l=t.filter((function(e){return!o.has(e.getInstanceId())}));return[].concat(wt(s),wt(l))}),[]);U_((function(){var e={setTransform:function(e){return o(e)},setHeight:function(e){return l(e)},setTop:function(e){return d(e)},setHeaderCtrls:function(e){return m((function(t){return E(t,e)}))},setWidth:function(e){y.current&&(y.current.style.width=e)},setAriaRowIndex:function(e){return p(e)}};w.setComp(e)}));var k=(0,e.useMemo)((function(){return{transform:i,height:s,top:c}}),[i,s,c]),x=(0,e.useMemo)((function(){var e=["ag-header-row"];return b&&e.push("ag-header-row-column"),C&&e.push("ag-header-row-column-group"),S&&e.push("ag-header-row-column-filter"),e.join(" ")}),[]),T=(0,e.useCallback)((function(t){switch(w.getType()){case ax.COLUMN_GROUP:return e.createElement(eO,{ctrl:t,key:t.getInstanceId()});case ax.FLOATING_FILTER:return e.createElement(tO,{ctrl:t,key:t.getInstanceId()});default:return e.createElement($_,{ctrl:t,key:t.getInstanceId()})}}),[]);return e.createElement("div",{ref:y,className:x,role:"row",style:k,"aria-rowindex":f},g.map(T))})),rO=(0,e.memo)((function(t){var n=Y((0,e.useState)(new q_),2),r=n[0],i=n[1],o=Y((0,e.useState)(!1),2),a=o[0],s=o[1],l=Y((0,e.useState)([]),2),u=l[0],c=l[1],d=(0,e.useContext)(V_).context,h=(0,e.useRef)(null),f=(0,e.useRef)(null),p="left"===t.pinned,v="right"===t.pinned,g=!p&&!v;U_((function(){var e={setDisplayed:function(e){i((function(t){return t.setClass("ag-hidden",!e)})),s(!e)},setCtrls:function(e){return c(e)},setCenterWidth:function(e){f.current&&(f.current.style.width=e)},setViewportScrollLeft:function(e){h.current&&(h.current.scrollLeft=e)},setPinnedContainerWidth:function(e){h.current&&(h.current.style.width=e,h.current.style.minWidth=e,h.current.style.maxWidth=e)}},n=d.createBean(new jx(t.pinned));return n.setComp(e,h.current),function(){d.destroyBean(n)}}));var m=(0,e.useMemo)((function(){return r.toString()}),[r]),y=function(){return u.map((function(t){return e.createElement(nO,{ctrl:t,key:t.getInstanceId()})}))};return e.createElement(e.Fragment,null,p&&e.createElement("div",{ref:h,className:"ag-pinned-left-header "+m,"aria-hidden":a,role:"presentation"},y()),v&&e.createElement("div",{ref:h,className:"ag-pinned-right-header "+m,"aria-hidden":a,role:"presentation"},y()),g&&e.createElement("div",{ref:h,className:"ag-header-viewport "+m,role:"presentation"},e.createElement("div",{ref:f,className:"ag-header-container",role:"rowgroup"},y())))})),iO=(0,e.memo)((function(){var t=Y((0,e.useState)(new q_),2),n=t[0],r=t[1],i=Y((0,e.useState)(),2),o=i[0],a=i[1],s=(0,e.useContext)(V_).context,l=(0,e.useRef)(null);U_((function(){var e={addOrRemoveCssClass:function(e,t){return r((function(n){return n.setClass(e,t)}))},setHeightAndMinHeight:function(e){return a(e)}},t=s.createBean(new qx);return t.setComp(e,l.current,l.current),function(){s.destroyBean(t)}}));var u=(0,e.useMemo)((function(){return"ag-header "+n.toString()}),[n]),c=(0,e.useMemo)((function(){return{height:o,minHeight:o}}),[o]);return e.createElement("div",{ref:l,className:u,style:c,role:"presentation"},e.createElement(rO,{pinned:"left"}),e.createElement(rO,{pinned:null}),e.createElement(rO,{pinned:"right"}))})),oO=function(t,n){(0,e.useEffect)((function(){var e=n.current;if(e){var r=e.parentElement;if(r){var i=document.createComment(t);return r.insertBefore(i,e),function(){r.removeChild(i)}}}}),[t])},aO=(0,e.memo)((function(t){var n=Y((0,e.useState)(),2),r=n[0],i=n[1],o=(0,e.useContext)(V_),a=o.context,s=o.popupService,l=o.localeService,u=o.gridOptionsService;return U_((function(){var e=t.editDetails,n=t.cellCtrl,r=t.eParentCell,o=e.compDetails,c=u.is("stopEditingWhenCellsLoseFocus"),d=a.createBean(new zk(o.params)),h=d.getGui();if(t.jsChildComp){var f=t.jsChildComp.getGui();f&&h.appendChild(f)}var p={column:n.getColumn(),rowNode:n.getRowNode(),type:"popupCellEditor",eventSource:r,ePopup:h,position:e.popupPosition,keepWithinBounds:!0},v=s.positionPopupByComponent.bind(s,p),g=l.getLocaleTextFunc(),m=s.addPopup({modal:c,eChild:h,closeOnEsc:!0,closedCallback:function(){n.onPopupEditorClosed()},anchorToElement:r,positionCallback:v,ariaLabel:g("ariaLabelCellEditor","Cell Editor")}),y=m?m.hideFunc:void 0;return i(d),t.jsChildComp&&t.jsChildComp.afterGuiAttached&&t.jsChildComp.afterGuiAttached(),function(){null!=y&&y(),a.destroyBean(d)}})),e.createElement(e.Fragment,null,r&&t.wrappedContent&&(0,N_.createPortal)(t.wrappedContent,r.getGui()))})),sO=function(t,n,r,i,o,a){var s=(0,e.useContext)(V_),l=s.context,u=(s.userComponentFactory,(0,e.useCallback)((function(){var e=o.current;if(e){var t=e.getGui();t&&t.parentElement&&t.parentElement.removeChild(t),l.destroyBean(e),o.current=void 0}}),[]));(0,e.useEffect)((function(){var e=null!=t,i=t&&t.compDetails&&!t.compDetails.componentFromFramework;if(e&&i&&!(n&&null==r)){var s=t.compDetails;if(o.current){var l=o.current,c=!!(null!=l.refresh&&0==t.force)&&l.refresh(s.params);if(!0===c||void 0===c)return;u()}var d=s.newAgStackInstance();if(d){var h=d.resolveNow(null,(function(e){return e}));if(h){var f=h.getGui();if(f)(n?r:a.current).appendChild(f),o.current=h}}}else u()}),[t,n,i]),function(t){var n=(0,e.useRef)(t),r=(0,e.useRef)(),i=(0,e.useRef)(!1),o=(0,e.useRef)(!1),a=Y((0,e.useState)(0),2)[1];i.current&&(o.current=!0),(0,e.useEffect)((function(){return i.current||(r.current=n.current(),i.current=!0),a((function(e){return e+1})),function(){o.current&&r.current&&r.current()}}),[])}((function(){return u}))};!function(e){e[e.ShowValue=0]="ShowValue",e[e.EditValue=1]="EditValue"}(H_||(H_={}));var lO=(0,e.memo)((function(t){var n=(0,e.useContext)(V_).context,r=t.cellCtrl,i=t.printLayout,o=t.editingRow,a=Y((0,e.useState)(),2),s=a[0],l=a[1],u=Y((0,e.useState)(),2),c=u[0],d=u[1],h=Y((0,e.useState)(1),2),f=h[0],p=h[1],v=Y((0,e.useState)(),2),g=v[0],m=v[1],y=Y((0,e.useState)(),2),w=y[0],b=y[1],C=Y((0,e.useState)(),2),S=C[0],E=C[1],k=Y((0,e.useState)(),2),x=k[0],T=k[1],R=Y((0,e.useState)(),2),A=R[0],_=R[1],O=Y((0,e.useState)(!1),2),D=O[0],N=O[1],P=Y((0,e.useState)(!1),2),F=P[0],I=P[1],L=Y((0,e.useState)(!1),2),M=L[0],G=L[1],B=Y((0,e.useState)(),2),j=B[0],H=B[1],V=(0,e.useMemo)((function(){return r.isForceWrapper()}),[]),W=(0,e.useRef)(null),z=(0,e.useRef)(null),U=(0,e.useRef)(),K=(0,e.useRef)(),q=(0,e.useRef)(),X=Y((0,e.useState)(0),2),Q=X[0],Z=X[1],J=(0,e.useCallback)((function(e){q.current=e,Z((function(e){return e+1}))}),[]),$=(0,e.useRef)(),ee=Y((0,e.useState)(0),2),te=ee[0],ne=ee[1],re=(0,e.useCallback)((function(e){$.current=e,ne((function(e){return e+1}))}),[]),ie=V||null!=s&&(D||M||F),oe=(0,e.useCallback)((function(e,t){(K.current=t,t)&&(!function(e,t,n){var r=n.getColumn();if(!e&&t.isPopup&&t.isPopup()){var i="AG Grid: Found an issue in column ".concat(r.getColId(),". If using React, specify an editor is a popup using colDef.cellEditorPopup=true. AG Grid React cannot depend on the editor component specifying if it's in a popup (via the isPopup() method on the editor), as React needs to know this information BEFORE the component is created.");Vb.doOnce((function(){return console.warn(i)}),"jsEditorComp-isPopup-"+n.getColumn().getColId())}if(e&&t.getPopupPosition&&null!=t.getPopupPosition()){var o="AG Grid: Found an issue in column ".concat(r.getColId(),". If using React, specify an editor popup position using colDef.cellEditorPopupPosition=true. AG Grid React cannot depend on the editor component specifying it's position (via the getPopupPosition() method on the editor), as React needs to know this information BEFORE the component is created.");Vb.doOnce((function(){return console.warn(o)}),"jsEditorComp-getPopupPosition-"+n.getColumn().getColId())}}(e,t,r),t.isCancelBeforeStart&&t.isCancelBeforeStart()&&setTimeout((function(){r.stopEditing(!0),r.focusCell(!0)})))}),[]),ae=(0,e.useCallback)((function(e){return oe(!0,e)}),[]),se=(0,e.useCallback)((function(e){return oe(!1,e)}),[]),le=(0,e.useMemo)((function(){return new Xb((function(){return W.current}))}),[]);sO(s,ie,$.current,te,U,W);var ue=(0,e.useRef)();(0,e.useLayoutEffect)((function(){var e=ue.current,t=s;if(ue.current=s,null!=e&&null!=e.compDetails&&null!=t&&null!=t.compDetails){var n=e.compDetails,r=t.compDetails;if(n.componentClass==r.componentClass)if(null!=z.current&&null!=z.current.refresh)1!=z.current.refresh(r.params)&&p((function(e){return e+1}))}}),[s]),(0,e.useLayoutEffect)((function(){if(c&&!c.compDetails.componentFromFramework){var e=c.compDetails,t=!0===c.popup,r=function(e){var t=e.newAgStackInstance();if(t)return t.resolveNow(null,(function(e){return e}))}(e);if(r){var i=r.getGui();if(oe(t,r),!t){var o=(V?q:W).current;null===o||void 0===o||o.appendChild(i),r.afterGuiAttached&&r.afterGuiAttached()}return H(r),function(){n.destroyBean(r),oe(t,void 0),H(void 0),i&&i.parentElement&&i.parentElement.removeChild(i)}}}}),[c]),(0,e.useLayoutEffect)((function(){if(r&&n&&q.current&&ie){var e=[],t=function(t){var r;if(t){var i=t.getGui();null===(r=q.current)||void 0===r||r.insertAdjacentElement("afterbegin",i),e.push((function(){n.destroyBean(t),Vb.removeFromParent(i)}))}return t};if(D)t(r.createSelectionCheckbox());return M&&t(r.createDndSource()),F&&t(r.createRowDragComp()),function(){return e.forEach((function(e){return e()}))}}}),[ie,M,F,D,Q]),U_((function(){if(r){var e={addOrRemoveCssClass:function(e,t){return le.addOrRemoveCssClass(e,t)},setUserStyles:function(e){return m(e)},getFocusableElement:function(){return W.current},setTabIndex:function(e){return b(e)},setRole:function(e){return E(e)},setColId:function(e){return T(e)},setTitle:function(e){return _(e)},setIncludeSelection:function(e){return N(e)},setIncludeRowDrag:function(e){return I(e)},setIncludeDndSource:function(e){return G(e)},getCellEditor:function(){return K.current||null},getCellRenderer:function(){return z.current?z.current:U.current},getParentOfValue:function(){return $.current?$.current:q.current?q.current:W.current},setRenderDetails:function(e,t,n){l({value:t,compDetails:e,force:n})},setEditDetails:function(e,t,n){e?(d({compDetails:e,popup:t,popupPosition:n}),t||l(void 0)):d(void 0)}},t=q.current||void 0;r.setComp(e,W.current,t,i,o)}}));var ce=(0,e.useMemo)((function(){return!!(s&&s.compDetails&&s.compDetails.componentFromFramework&&X_(s.compDetails.componentClass))}),[s]);(0,e.useEffect)((function(){var e;W.current&&(le.addOrRemoveCssClass("ag-cell-value",!ie),le.addOrRemoveCssClass("ag-cell-inline-editing",!!c&&!c.popup),le.addOrRemoveCssClass("ag-cell-popup-editing",!!c&&!!c.popup),le.addOrRemoveCssClass("ag-cell-not-inline-editing",!c||!!c.popup),null===(e=r.getRowCtrl())||void 0===e||e.setInlineEditingCss(!!c),r.shouldRestoreFocus()&&!r.isEditing()&&W.current.focus({preventScroll:!0}))}));var de=(0,e.useMemo)((function(){return r.getInstanceId()}),[]),he=function(){return e.createElement(e.Fragment,null,null!=s&&function(t,n,r,i,o,a,s){var l=t.compDetails,u=t.value,c=!l,d=l&&l.componentFromFramework,h=l&&l.componentClass,f=(null===u||void 0===u?void 0:u.toString)?u.toString():u,p=function(){return e.createElement(e.Fragment,null,c&&e.createElement(e.Fragment,null,f),d&&!a&&e.createElement(h,Object.assign({},l.params,{key:n,ref:i})),d&&a&&e.createElement(h,Object.assign({},l.params,{key:n})))};return e.createElement(e.Fragment,null,o?e.createElement("span",{role:"presentation",id:"cell-".concat(r),className:"ag-cell-value",ref:s},p()):p())}(s,f,de,z,ie,ce,re),null!=c&&function(t,n,r,i,o,a){var s=t.compDetails,l=s.componentClass,u=s.componentFromFramework&&!t.popup,c=s.componentFromFramework&&t.popup,d=!s.componentFromFramework&&t.popup;return e.createElement(e.Fragment,null,u&&e.createElement(l,Object.assign({},t.compDetails.params,{ref:n})),c&&e.createElement(aO,{editDetails:t,cellCtrl:o,eParentCell:i,wrappedContent:e.createElement(l,Object.assign({},t.compDetails.params,{ref:r}))}),d&&a&&e.createElement(aO,{editDetails:t,cellCtrl:o,eParentCell:i,jsChildComp:a}))}(c,se,ae,W.current,r,j))};return e.createElement("div",{ref:W,style:g,tabIndex:w,role:S,"col-id":x,title:A},ie?e.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:J},he()):he())})),uO=(0,e.memo)((function(t){var n=(0,e.useContext)(V_).context,r=t.rowCtrl,i=t.containerType,o=Y((0,e.useState)(),2),a=o[0],s=o[1],l=Y((0,e.useState)(),2),u=l[0],c=l[1],d=Y((0,e.useState)(),2),h=d[0],f=d[1],p=Y((0,e.useState)(),2),v=p[0],g=p[1],m=Y((0,e.useState)(),2),y=m[0],w=m[1],b=Y((0,e.useState)(),2),C=b[0],S=b[1],E=Y((0,e.useState)({list:[],instanceIdMap:new Map}),2),k=E[0],x=E[1],T=Y((0,e.useState)(),2),R=T[0],A=T[1],_=Y((0,e.useState)(!1),2),O=_[0],D=_[1],N=Y((0,e.useState)(r.getInitialRowTop(i)),2),P=N[0],F=N[1],I=Y((0,e.useState)(r.getInitialTransform(i)),2),L=I[0],M=I[1],G=(0,e.useRef)(null),B=(0,e.useRef)(),j=(0,e.useRef)(!1),H=Y((0,e.useState)(0),2),V=H[0],W=H[1];(0,e.useEffect)((function(){var e;if(!j.current&&R&&!(V>10)){var t=null===(e=G.current)||void 0===e?void 0:e.firstChild;t?(r.setupDetailRowAutoHeight(t),j.current=!0):W((function(e){return e+1}))}}),[R,V]);var z=(0,e.useMemo)((function(){return new Xb((function(){return G.current}))}),[]);U_((function(){if(r.isAlive()){var e={setTop:function(e){return F(e)},setTransform:function(e){return M(e)},addOrRemoveCssClass:function(e,t){return z.addOrRemoveCssClass(e,t)},setDomOrder:function(e){return D(e)},setRowIndex:function(e){return s(e)},setRowId:function(e){return c(e)},setRowBusinessKey:function(e){return g(e)},setTabIndex:function(e){return w(e)},setUserStyles:function(e){return S(e)},setRole:function(e){return f(e)},setCellCtrls:function(e,t){Q_(t,(function(){x((function(t){return function(e,t,n){if(n){var r={list:t,instanceIdMap:new Map};return t.forEach((function(e){return r.instanceIdMap.set(e.getInstanceId(),e)})),r}var i=[],o=[],a=new Map,s=new Map;return t.forEach((function(e){return s.set(e.getInstanceId(),e)})),e.list.forEach((function(e){var t=e.getInstanceId();s.has(t)&&(i.push(e),a.set(t,e))})),t.forEach((function(t){var n=t.getInstanceId();e.instanceIdMap.has(n)||(o.push(t),a.set(n,t))})),{list:[].concat(i,o),instanceIdMap:a}}(t,e,O)}))}))},showFullWidth:function(e){return A(e)},getFullWidthCellRenderer:function(){return B.current}};return r.setComp(e,G.current,i),function(){r.unsetComp(i)}}})),(0,e.useLayoutEffect)((function(){return W_(R,n,G.current,B)}),[R]);var U=(0,e.useMemo)((function(){var e={top:P,transform:L};return Object.assign(e,C),e}),[P,L,C]),K=R&&R.componentFromFramework,q=null!=k,X=(0,e.useMemo)((function(){return!!((null===R||void 0===R?void 0:R.componentFromFramework)&&X_(R.componentClass))}),[R]);return e.createElement("div",{ref:G,role:h,style:U,"row-index":a,"row-id":u,"row-business-key":v,tabIndex:y},q&&k.list.map((function(t){return e.createElement(lO,{cellCtrl:t,editingRow:r.isEditing(),printLayout:r.isPrintLayout(),key:t.getInstanceId()})})),K&&function(){var t=R.componentClass;return e.createElement(e.Fragment,null,X&&e.createElement(t,Object.assign({},R.params)),!X&&e.createElement(t,Object.assign({},R.params,{ref:B})))}())})),cO=(0,e.memo)((function(t){var n=(0,e.useContext)(V_).context,r=Y((0,e.useState)([]),2),i=r[0],o=r[1],a=t.name,s=(0,e.useMemo)((function(){return Ak(a)}),[a]),l=(0,e.useRef)(null),u=(0,e.useRef)(null),c=(0,e.useRef)(null),d=(0,e.useRef)([]),h=(0,e.useRef)(!1),f=(0,e.useMemo)((function(){return Nk.getRowContainerCssClasses(a)}),[a]),p=(0,e.useMemo)((function(){return K_(f.wrapper)}),[]),v=(0,e.useMemo)((function(){return K_(f.viewport)}),[]),g=(0,e.useMemo)((function(){return K_(f.container)}),[]),m=a===xk.CENTER,y=a===xk.TOP_CENTER||a===xk.BOTTOM_CENTER||a===xk.STICKY_TOP_CENTER,w=!m&&!y;function b(e){Q_(e,(function(){o((function(e){var t=d.current;if(h.current)return t;var n=e.filter((function(e){return t.indexOf(e)>=0})),r=t.filter((function(e){return n.indexOf(e)<0}));return[].concat(wt(n),wt(r))}))}))}oO(" AG Row Container "+a+" ",m?l:y?u:c),U_((function(){var e=[],t={setViewportHeight:function(e){u.current&&(u.current.style.height=e)},setRowCtrls:function(e,t){if(d.current!==e){var n=t&&d.current.length>0&&e.length>0;d.current=e,b(n)}},setDomOrder:function(e){h.current!=e&&(h.current=e,b(!1))},setContainerWidth:function(e){c.current&&(c.current.style.width=e)}},r=n.createBean(new Nk(a));return e.push(r),r.setComp(t,c.current,u.current,l.current),function(){n.destroyBeans(e)}}));var C=function(){return e.createElement("div",{className:g,ref:c,role:i.length?"rowgroup":"presentation"},i.map((function(t){return e.createElement(uO,{rowCtrl:t,containerType:s,key:t.getInstanceId()})})))};return e.createElement(e.Fragment,null,m&&e.createElement("div",{className:p,ref:l,role:"presentation"},e.createElement("div",{className:v,ref:u,role:"presentation"},C())),y&&e.createElement("div",{className:v,ref:u,role:"presentation"},C()),w&&C())})),dO=(0,e.memo)((function(){var t=(0,e.useContext)(V_),n=t.context,r=t.agStackComponentsRegistry,i=t.resizeObserverService,o=Y((0,e.useState)(""),2),a=o[0],s=o[1],l=Y((0,e.useState)(0),2),u=l[0],c=l[1],d=Y((0,e.useState)(0),2),h=d[0],f=d[1],p=Y((0,e.useState)("0px"),2),v=p[0],g=p[1],m=Y((0,e.useState)("0px"),2),y=m[0],w=m[1],b=Y((0,e.useState)("100%"),2),C=b[0],S=b[1],E=Y((0,e.useState)(""),2),k=E[0],x=E[1],T=Y((0,e.useState)(""),2),R=T[0],A=T[1],_=Y((0,e.useState)(null),2),O=_[0],D=_[1],N=Y((0,e.useState)(""),2),P=N[0],F=N[1],I=Y((0,e.useState)(null),2),L=I[0],M=I[1],G=Y((0,e.useState)("ag-layout-normal"),2),B=G[0],j=G[1],H=(0,e.useMemo)((function(){return new Xb((function(){return V.current}))}),[]),V=(0,e.useRef)(null),W=(0,e.useRef)(null),z=(0,e.useRef)(null),U=(0,e.useRef)(null),K=(0,e.useRef)(null),q=(0,e.useRef)(null);oO(" AG Grid Body ",V),oO(" AG Pinned Top ",W),oO(" AG Sticky Top ",z),oO(" AG Middle ",K),oO(" AG Pinned Bottom ",q),U_((function(){var e=[],t=[];if(n){var o=function(t){var i=r.getComponentClass(t),o=n.createBean(new i);return e.push(o),o};V.current&&(V.current.appendChild(document.createComment(" AG Fake Horizontal Scroll ")),V.current.appendChild(o("AG-FAKE-HORIZONTAL-SCROLL").getGui()),V.current.appendChild(document.createComment(" AG Overlay Wrapper ")),V.current.appendChild(o("AG-OVERLAY-WRAPPER").getGui())),U.current&&(U.current.appendChild(document.createComment(" AG Fake Vertical Scroll ")),U.current.appendChild(o("AG-FAKE-VERTICAL-SCROLL").getGui()));var a={setRowAnimationCssOnBodyViewport:s,setColumnCount:function(e){return Vb.setAriaColCount(V.current,e)},setRowCount:function(e){return Vb.setAriaRowCount(V.current,e)},setTopHeight:c,setBottomHeight:f,setStickyTopHeight:g,setStickyTopTop:w,setStickyTopWidth:S,setTopDisplay:x,setBottomDisplay:A,setColumnMovingCss:function(e,t){return H.addOrRemoveCssClass(e,t)},updateLayoutClasses:j,setAlwaysVerticalScrollClass:D,setPinnedTopBottomOverflowY:F,setCellSelectableCss:function(e,t){return M(t?e:null)},setBodyViewportWidth:function(e){K.current&&(K.current.style.width=e)},registerBodyViewportResizeListener:function(e){var n=i.observeResize(K.current,e);t.push((function(){return n()}))}},l=n.createBean(new XE);return e.push(l),l.setComp(a,V.current,K.current,W.current,q.current,z.current),function(){n.destroyBeans(e),t.forEach((function(e){return e()}))}}}));var X=(0,e.useMemo)((function(){return K_("ag-root","ag-unselectable",B)}),[B]),Q=(0,e.useMemo)((function(){return K_("ag-body-viewport",a,B,O,L)}),[a,B,O,L]),Z=(0,e.useMemo)((function(){return K_("ag-body",B)}),[B]),J=(0,e.useMemo)((function(){return K_("ag-body-clipper",B)}),[B]),$=(0,e.useMemo)((function(){return K_("ag-floating-top",L)}),[L]),ee=(0,e.useMemo)((function(){return K_("ag-sticky-top",L)}),[L]),te=(0,e.useMemo)((function(){return K_("ag-floating-bottom",L)}),[L]),ne=(0,e.useMemo)((function(){return{height:u,minHeight:u,display:k,overflowY:P}}),[u,k,P]),re=(0,e.useMemo)((function(){return{height:v,top:y,width:C}}),[v,y,C]),ie=(0,e.useMemo)((function(){return{height:h,minHeight:h,display:R,overflowY:P}}),[h,R,P]),oe=function(t){return e.createElement(cO,{name:t,key:"".concat(t,"-container")})},ae=function(t){var n=t.section,r=t.children,i=t.className,o=t.style;return e.createElement("div",{ref:n,className:i,role:"presentation",style:o},r.map(oe))};return e.createElement("div",{ref:V,className:X,role:"treegrid"},e.createElement(iO,null),ae({section:W,className:$,style:ne,children:[xk.TOP_LEFT,xk.TOP_CENTER,xk.TOP_RIGHT,xk.TOP_FULL_WIDTH]}),e.createElement("div",{className:Z,ref:U,role:"presentation"},e.createElement("div",{className:J,role:"presentation"},ae({section:K,className:Q,children:[xk.LEFT,xk.CENTER,xk.RIGHT,xk.FULL_WIDTH]}))),ae({section:z,className:ee,style:re,children:[xk.STICKY_TOP_LEFT,xk.STICKY_TOP_CENTER,xk.STICKY_TOP_RIGHT,xk.STICKY_TOP_FULL_WIDTH]}),ae({section:q,className:te,style:ie,children:[xk.BOTTOM_LEFT,xk.BOTTOM_CENTER,xk.BOTTOM_RIGHT,xk.BOTTOM_FULL_WIDTH]}))})),hO=(0,e.forwardRef)((function(t,n){var r=t.children,i=t.eFocusableElement,o=t.onTabKeyDown,a=t.gridCtrl,s=(0,e.useContext)(V_).context,l=(0,e.useRef)(null),u=(0,e.useRef)(null),c=(0,e.useRef)(),d=function(e){var t=null==e?void 0:parseInt(e,10).toString();[l,u].forEach((function(e){var n,r;void 0===t?null===(n=e.current)||void 0===n||n.removeAttribute("tabindex"):null===(r=e.current)||void 0===r||r.setAttribute("tabindex",t)}))};(0,e.useImperativeHandle)(n,(function(){return{forceFocusOutOfContainer:function(){var e;null===(e=c.current)||void 0===e||e.forceFocusOutOfContainer()}}})),U_((function(){var e=l.current,t=u.current,n={setTabIndex:d},r=c.current=s.createBean(new kx({comp:n,eTopGuard:e,eBottomGuard:t,eFocusableElement:i,onTabKeyDown:o,focusInnerElement:function(e){return a.focusInnerElement(e)}}));return function(){s.destroyBean(r)}}));var h=function(t){var n="top"===t?Sx.TAB_GUARD_TOP:Sx.TAB_GUARD_BOTTOM;return e.createElement("div",{className:"".concat(Sx.TAB_GUARD," ").concat(n),role:"presentation",ref:"top"===t?l:u})};return e.createElement(e.Fragment,null,h("top"),r,h("bottom"))})),fO=(0,e.memo)(hO),pO=(0,e.memo)((function(t){var n=t.context,r=Y((0,e.useState)(""),2),i=r[0],o=r[1],a=Y((0,e.useState)(""),2),s=a[0],l=a[1],u=Y((0,e.useState)(""),2),c=u[0],d=u[1],h=Y((0,e.useState)(null),2),f=h[0],p=h[1],v=Y((0,e.useState)(null),2),g=v[0],m=v[1],y=Y((0,e.useState)(!1),2),w=y[0],b=y[1],C=Y((0,e.useState)(),2),S=C[0],E=C[1],k=(0,e.useRef)(null),x=(0,e.useRef)(null),T=(0,e.useRef)(),R=(0,e.useRef)(null),A=(0,e.useRef)((function(){})),_=(0,e.useCallback)((function(){}),[]),O=(0,e.useMemo)((function(){return n.isDestroyed()?null:n.getBean("beans")}),[n]);oO(" AG Grid ",x),(0,e.useLayoutEffect)((function(){if(!n.isDestroyed()){var e=k.current=n.createBean(new bR),t=k.current;A.current=t.focusInnerElement.bind(t);var r={destroyGridUi:function(){},setRtlClass:o,addOrRemoveKeyboardFocusClass:function(e){return l(e?Rx.AG_KEYBOARD_FOCUS:"")},forceFocusOutOfContainer:function(){var e;null===(e=T.current)||void 0===e||e.forceFocusOutOfContainer()},updateLayoutClasses:d,getFocusableContainers:function(){var e,t,n=[],r=null===(e=x.current)||void 0===e?void 0:e.querySelector(".ag-root"),i=null===(t=x.current)||void 0===t?void 0:t.querySelector(".ag-side-bar:not(.ag-hidden)");return r&&n.push(r),i&&n.push(i),n},setCursor:p,setUserSelect:m};return t.setComp(r,x.current,x.current),b(!0),function(){n.destroyBean(e),k.current=null}}}),[n]),(0,e.useEffect)((function(){if(S&&O&&k.current){var e=k.current,t=[],r=O.agStackComponentsRegistry,i=r.getComponentClass("AG-GRID-HEADER-DROP-ZONES"),o=r.getComponentClass("AG-SIDE-BAR"),a=r.getComponentClass("AG-STATUS-BAR"),s=r.getComponentClass("AG-WATERMARK"),l=r.getComponentClass("AG-PAGINATION"),u=[],c=x.current,d=R.current;if(e.showDropZones()&&i){var h=n.createBean(new i),f=h.getGui();c.insertAdjacentElement("afterbegin",f),u.push(f),t.push(h)}if(e.showSideBar()&&o){var p=n.createBean(new o),v=p.getGui(),g=d.querySelector(".ag-tab-guard-bottom");g&&(g.insertAdjacentElement("beforebegin",v),u.push(v)),t.push(p)}if(e.showStatusBar()&&a){var m=n.createBean(new a),y=m.getGui();c.insertAdjacentElement("beforeend",y),u.push(y),t.push(m)}if(l){var w=n.createBean(new l),b=w.getGui();c.insertAdjacentElement("beforeend",b),u.push(b),t.push(w)}if(e.showWatermark()&&s){var C=n.createBean(new s),E=C.getGui();c.insertAdjacentElement("beforeend",E),u.push(E),t.push(C)}return function(){n.destroyBeans(t),u.forEach((function(e){e.parentElement&&e.parentElement.removeChild(e)}))}}}),[S]);var D=(0,e.useMemo)((function(){return K_("ag-root-wrapper",i,s,c)}),[i,s,c]),N=(0,e.useMemo)((function(){return K_("ag-root-wrapper-body","ag-focus-managed",c)}),[c]),P=(0,e.useMemo)((function(){return{userSelect:null!=g?g:"",WebkitUserSelect:null!=g?g:"",cursor:null!=f?f:""}}),[g,f]),F=R.current,I=(0,e.useCallback)((function(e){T.current=e,E(null!==e)}),[]);return e.createElement("div",{ref:x,className:D,style:P,role:"presentation"},e.createElement("div",{className:N,ref:R,role:"presentation"},w&&F&&O&&e.createElement(V_.Provider,{value:O},e.createElement(fO,{ref:I,eFocusableElement:F,onTabKeyDown:_,gridCtrl:k.current},e.createElement(dO,null)))))}));var vO=function(t){var n,r,i=(0,e.useRef)(null),o=(0,e.useRef)(null),a=(0,e.useRef)(null),s=(0,e.useRef)([]),l=(0,e.useRef)([]),u=(0,e.useRef)(t),c=(0,e.useRef)(!1),d=Y((0,e.useState)(void 0),2),h=d[0],f=d[1],p=(0,e.useCallback)((function(e){e.rowDataChangeDetectionStrategy&&Vb.doOnce((function(){return console.warn("AG Grid: Since v29 rowDataChangeDetectionStrategy has been deprecated. Row data property changes will be compared by reference via triple equals ===. See https://ag-grid.com/react-data-grid/react-hooks/")}),"rowDataChangeDetectionStrategy_Deprecation")}),[]),v=Y((0,e.useState)(0),2)[1];(0,e.useLayoutEffect)((function(){var e=t.modules||[];a.current||(a.current=new j_((function(){return v((function(e){return e+1}))}),t.componentWrappingElement,t.maxComponentCreationTimeMs),s.current.push((function(){var e;null===(e=a.current)||void 0===e||e.destroy(),a.current=null})));var n={providedBeanInstances:{frameworkComponentWrapper:new gO(a.current)},modules:e,frameworkOverrides:new yO(!0)};i.current=t.gridOptions||{},i.current=dy.copyAttributesToGridOptions(i.current,t),p(t);return(new KA).create(o.current,i.current,(function(e){f(e),s.current.push((function(){e.destroy()})),e.getBean(yA.NAME).whenReady((function(){if(!e.isDestroyed()&&i.current){var n=i.current.api;n&&(t.setGridApi&&t.setGridApi(n,i.current.columnApi),s.current.push((function(){n.destroy()})))}}))}),(function(e){e.getBean(yA.NAME).whenReady((function(){l.current.forEach((function(e){return e()})),l.current.length=0,c.current=!0}))}),n),function(){s.current.forEach((function(e){return e()})),s.current.length=0}}),[]);var g=(0,e.useMemo)((function(){return Object.assign({height:"100%"},t.containerStyle||{})}),[t.containerStyle]),m=(0,e.useCallback)((function(e){c.current?e():l.current.push(e)}),[]);return(0,e.useEffect)((function(){var e={};!function(e,t,n){var r=!!t.debug;Object.keys(t).forEach((function(i){dy.ALL_PROPERTIES_SET.has(i)&&e[i]!==t[i]&&(r&&console.log(" agGridReact: [".concat(i,"] property changed")),n[i]={previousValue:e[i],currentValue:t[i]})})),dy.EVENT_CALLBACKS.forEach((function(i){e[i]!==t[i]&&(r&&console.log("agGridReact: [".concat(i,"] event callback changed")),n[i]={previousValue:e[i],currentValue:t[i]})}))}(u.current,t,e),u.current=t,m((function(){var t;(null===(t=i.current)||void 0===t?void 0:t.api)&&dy.processOnChange(e,i.current.api)}))}),[t]),e.createElement("div",{style:g,className:t.className,ref:o},h&&!h.isDestroyed()?e.createElement(pO,{context:h}):null,null!==(r=null===(n=a.current)||void 0===n?void 0:n.getPortals())&&void 0!==r?r:null)},gO=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).parent=e,r}return A(n,[{key:"createWrapper",value:function(e,t){return new G_(e,this.parent,t)}}]),n}(qA);var mO=(0,e.forwardRef)((function(t,n){var r=(0,e.useContext)(V_),i=r.ctrlsFactory,o=r.context,a=r.gridOptionsService,s=r.resizeObserverService,l=r.clientSideRowModel,u=r.serverSideRowModel,c=Y((0,e.useState)(new q_),2),d=c[0],h=c[1],f=Y((0,e.useState)(new q_),2),p=f[0],v=f[1],g=Y((0,e.useState)(),2),m=g[0],y=g[1],w=Y((0,e.useState)(),2),b=w[0],C=w[1],S=(0,e.useRef)(),E=(0,e.useRef)(null),k=(0,e.useMemo)((function(){return Qg.__getGridRegisteredModules(t.api.getGridId())}),[t]),x=(0,e.useMemo)((function(){return d.toString()+" ag-details-row"}),[d]),T=(0,e.useMemo)((function(){return p.toString()+" ag-details-grid"}),[p]);n&&(0,e.useImperativeHandle)(n,(function(){return{refresh:function(){var e,t;return null!==(t=null===(e=S.current)||void 0===e?void 0:e.refresh())&&void 0!==t&&t}}})),U_((function(){t.template&&"string"===typeof t.template&&console.warn("AG Grid: detailCellRendererParams.template is not supported by React - this only works with frameworks that work against String templates. To change the template, please provide your own React Detail Cell Renderer.")})),U_((function(){var e={addOrRemoveCssClass:function(e,t){return h((function(n){return n.setClass(e,t)}))},addOrRemoveDetailGridCssClass:function(e,t){return v((function(n){return n.setClass(e,t)}))},setDetailGrid:function(e){return y(e)},setRowData:function(e){return C(e)},getGui:function(){return E.current}},n=i.getInstance("detailCellRenderer");if(n){var r;if(o.createBean(n),n.init(e,t),S.current=n,a.is("detailRowAutoHeight")){var c=function(){if(null!=E.current){var e=E.current.clientHeight;if(null!=e&&e>0){setTimeout((function(){t.node.setRowHeight(e),l?l.onRowHeightChanged():u&&u.onRowHeightChanged()}),0)}}};r=s.observeResize(E.current,c),c()}return function(){o.destroyBean(n),r&&r()}}}));var R=(0,e.useCallback)((function(e,t){var n;null===(n=S.current)||void 0===n||n.registerDetailWithMaster(e,t)}),[]);return e.createElement("div",{className:x,ref:E},m&&e.createElement(vO,Object.assign({className:T},m,{modules:k,rowData:b,setGridApi:R})))})),yO=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this)).frameworkComponents={agGroupCellRenderer:J_,agGroupRowRenderer:J_,agDetailCellRenderer:mO},r.reactUi=e,r.renderingEngine=e?"react":"vanilla",r}return A(n,[{key:"frameworkComponent",value:function(e){if(this.reactUi)return this.frameworkComponents[e]}},{key:"isFrameworkComponent",value:function(e){if(!e)return!1;var t=e.prototype;return!(t&&"getGui"in t)}}]),n}(tR),wO=function(t){O(r,t);var n=F(r);function r(e){var t;return T(this,r),(t=n.call(this,e)).props=e,t.api=null,t.destroyed=!1,t.SYNCHRONOUS_CHANGE_PROPERTIES=["context"],t.portalManager=new B_(P(t),e.componentWrappingElement,e.maxComponentCreationTimeMs),t}return A(r,[{key:"render",value:function(){var t=this;return e.createElement("div",{style:this.createStyleForDiv(),className:this.props.className,ref:function(e){t.eGridDiv=e}},this.portalManager.getPortals())}},{key:"createStyleForDiv",value:function(){return Object.assign({height:"100%"},this.props.containerStyle||{})}},{key:"componentDidMount",value:function(){var e=this.props.modules||[],t={providedBeanInstances:{agGridReact:this,frameworkComponentWrapper:new SO(this,this.portalManager)},modules:e,frameworkOverrides:new yO(!1)},n=this.props.gridOptions||{};this.gridOptions=dy.copyAttributesToGridOptions(n,this.props),this.checkForDeprecations(this.props),new zA(this.eGridDiv,this.gridOptions,t),this.api=this.gridOptions.api,this.columnApi=this.gridOptions.columnApi,this.props.setGridApi(this.api,this.columnApi)}},{key:"checkForDeprecations",value:function(e){e.rowDataChangeDetectionStrategy&&Vb.doOnce((function(){return console.warn("AG Grid: Since v29 rowDataChangeDetectionStrategy has been deprecated. Row data property changes will be compared by reference via triple equals ===. See https://ag-grid.com/react-data-grid/react-hooks/")}),"rowDataChangeDetectionStrategy_Deprecation")}},{key:"shouldComponentUpdate",value:function(e){return this.processPropsChanges(this.props,e),!1}},{key:"componentDidUpdate",value:function(e){this.processPropsChanges(e,this.props)}},{key:"processPropsChanges",value:function(e,t){var n={};this.extractGridPropertyChanges(e,t,n),this.processSynchronousChanges(n),this.processAsynchronousChanges(n)}},{key:"extractGridPropertyChanges",value:function(e,t,n){var r=!!t.debug;Object.keys(t).forEach((function(i){dy.ALL_PROPERTIES_SET.has(i)&&e[i]!==t[i]&&(r&&console.log("agGridReact: [".concat(i,"] property changed")),n[i]={previousValue:e[i],currentValue:t[i]})})),dy.EVENT_CALLBACKS.forEach((function(i){e[i]!==t[i]&&(r&&console.log("agGridReact: [".concat(i,"] event callback changed")),n[i]={previousValue:e[i],currentValue:t[i]})}))}},{key:"componentWillUnmount",value:function(){this.api&&(this.api.destroy(),this.api=null),this.destroyed=!0,this.portalManager.destroy()}},{key:"isDisableStaticMarkup",value:function(){return!0===this.props.disableStaticMarkup}},{key:"isLegacyComponentRendering",value:function(){return!0===this.props.legacyComponentRendering}},{key:"processSynchronousChanges",value:function(e){var t=Object.assign({},e);if(Object.keys(t).length>0){var n={};this.SYNCHRONOUS_CHANGE_PROPERTIES.forEach((function(e){t[e]&&(n[e]=t[e],delete t[e])})),Object.keys(n).length>0&&this.api&&dy.processOnChange(n,this.api)}return t}},{key:"processAsynchronousChanges",value:function(e){var t=this;Object.keys(e).length>0&&window.setTimeout((function(){t.api&&dy.processOnChange(e,t.api)}))}}]),r}(e.Component);function bO(e,t){e.forEach((function(e){wO[e]=t}))}wO.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3,wO.defaultProps={legacyComponentRendering:!1,disableStaticMarkup:!1,maxComponentCreationTimeMs:wO.MAX_COMPONENT_CREATION_TIME_IN_MS},wO.propTypes={gridOptions:Q.object},bO(dy.EVENT_CALLBACKS,Q.func),bO(dy.BOOLEAN_PROPERTIES,Q.bool),bO(dy.STRING_PROPERTIES,Q.string),bO(dy.OBJECT_PROPERTIES,Q.object),bO(dy.ARRAY_PROPERTIES,Q.array),bO(dy.NUMBER_PROPERTIES,Q.number),bO(dy.FUNCTION_PROPERTIES,Q.func);var CO,SO=function(e){O(n,e);var t=F(n);function n(e,r){var i;return T(this,n),(i=t.call(this)).agGridReact=e,i.portalManager=r,i}return A(n,[{key:"createWrapper",value:function(e,t){return this.agGridReact.isLegacyComponentRendering()?new M_(e,this.agGridReact,this.portalManager,t):new G_(e,this.portalManager,t)}}]),n}(qA),EO=function(t){O(r,t);var n=F(r);function r(){var e;return T(this,r),(e=n.apply(this,arguments)).setGridApi=function(t,n){e.api=t,e.columnApi=n},e}return A(r,[{key:"render",value:function(){return this.props.suppressReactUi?e.createElement(wO,Object.assign({},this.props,{setGridApi:this.setGridApi})):e.createElement(vO,Object.assign({},this.props,{setGridApi:this.setGridApi}))}}]),r}(e.Component);!function(e){e.IdentityCheck="IdentityCheck",e.DeepValueCheck="DeepValueCheck",e.NoCheck="NoCheck"}(CO||(CO={}));var kO=function(){var e=y().numQsorts,t=Xv(),n=t.gridColDefs,i=t.gridRowData,o=t.showCorrelationMatrix,a=29*e;a>700&&(a=700);var s=185+75*e;return s>1200&&(s=1400),s>window.innerWidth-100&&(s=window.innerWidth-100),s+="px",o?(0,r.jsx)("div",{className:"",children:(0,r.jsx)("div",{style:{width:s,height:a},className:"ag-theme-fresh mb-8 mt-4 w-full h-[".concat(a,"px]"),children:(0,r.jsx)(EO,{columnDefs:n,gridOptions:{suppressRowHoverHighlight:!1,columnHoverHighlight:!0},rowData:i,animateRows:!0,enableSorting:!0})})}):null},xO=function(){return Xv().showSection2?(0,r.jsxs)("div",{className:"flex flex-col items-center bg-blue-100 rounded-md p-6",children:[(0,r.jsx)(ug,{}),(0,r.jsx)("div",{className:"flex flex-col w-full items-center bg-gray-300 h-auto pt-4 rounded-md",children:(0,r.jsx)("div",{children:(0,r.jsx)(kO,{})})})]}):null},TO=function(){return(0,r.jsx)("div",{id:"s3HelpButtonDiv",className:"my-7",children:(0,r.jsx)("a",{href:"https://github.com/shawnbanasick/ken-q-analysis/wiki/3.-FACTOR-EXTRACTION",target:"_blank",rel:"noopener noreferrer",style:{targetNew:"tab"},children:(0,r.jsx)(V,{buttonId:"Section3HelpButton",buttonText:"Help - Section 3",buttonColor:"bg-gray-100"})})})},RO=function(){return(0,r.jsx)("div",{id:"section3Header",className:"m-8 w-10/12",children:(0,r.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,r.jsx)("div",{className:"flex flex-row",children:(0,r.jsx)("p",{className:"text-6xl my-4",children:"3. Factor Extraction"})}),(0,r.jsx)(TO,{})]})})};var AO=function(e){var t,n=Math.pow(2,-52),r=1e-64/n,i=0,o=0,a=0,s=0,l=0,u=e.map((function(e){return e.slice(0)})),c=u.length,d=u[0].length,h=[];h.length=d,h.fill(0);var f=h.slice(),p=function(e){for(var t=[],n=0;n<e;n+=1){var r=[];r.length=e,r.fill(0),t.push(r)}return t}(d);function v(e,t){return(e=Math.abs(e))>(t=Math.abs(t))?e*Math.sqrt(1+t*t/e/e):0===t?e:t*Math.sqrt(1+e*e/t/t)}var g=0,m=0,y=0,w=0,b=0,C=0,S=0;for(o=0;o<d;o+=1){for(h[o]=m,S=0,l=o+1,a=o;a<c;a+=1)S+=u[a][o]*u[a][o];if(S<=r)m=0;else for(g=u[o][o],m=Math.sqrt(S),g>=0&&(m=-m),y=g*m-S,u[o][o]=g-m,a=l;a<d;a+=1){for(S=0,s=o;s<c;s+=1)S+=u[s][o]*u[s][a];for(g=S/y,s=o;s<c;s+=1)u[s][a]+=g*u[s][o]}for(f[o]=m,S=0,a=l;a<d;a+=1)S+=u[o][a]*u[o][a];if(S<=r)m=0;else{for(g=u[o][o+1],m=Math.sqrt(S),g>=0&&(m=-m),y=g*m-S,u[o][o+1]=g-m,a=l;a<d;a+=1)h[a]=u[o][a]/y;for(a=l;a<c;a+=1){for(S=0,s=l;s<d;s+=1)S+=u[a][s]*u[o][s];for(s=l;s<d;s+=1)u[a][s]+=S*h[s]}}(b=Math.abs(f[o])+Math.abs(h[o]))>w&&(w=b)}for(o=d-1;-1!==o;o+=-1){if(0!==m){for(y=m*u[o][o+1],a=l;a<d;a+=1)p[a][o]=u[o][a]/y;for(a=l;a<d;a+=1){for(S=0,s=l;s<d;s+=1)S+=u[o][s]*p[s][a];for(s=l;s<d;s+=1)p[s][a]+=S*p[s][o]}}for(a=l;a<d;a+=1)p[o][a]=0,p[a][o]=0;p[o][o]=1,m=h[o],l=o}for(o=d-1;-1!==o;o+=-1){for(l=o+1,m=f[o],a=l;a<d;a+=1)u[o][a]=0;if(0!==m){for(y=u[o][o]*m,a=l;a<d;a+=1){for(S=0,s=l;s<c;s+=1)S+=u[s][o]*u[s][a];for(g=S/y,s=o;s<c;s+=1)u[s][a]+=g*u[s][o]}for(a=o;a<c;a+=1)u[a][o]/=m}else for(a=o;a<c;a+=1)u[a][o]=0;u[o][o]+=1}for(n*=w,s=d-1;-1!==s;s+=-1)for(var E=0;E<50;E+=1){var k=!1;for(l=s;-1!==l;l+=-1){if(Math.abs(h[l])<=n){k=!0;break}if(Math.abs(f[l-1])<=n)break}if(!k){i=0,S=1;var x=l-1;for(o=l;o<s+1&&(g=S*h[o],h[o]*=i,!(Math.abs(g)<=n));o+=1)for(y=v(g,m=f[o]),f[o]=y,i=m/y,S=-g/y,a=0;a<c;a+=1)b=u[a][x],C=u[a][o],u[a][x]=b*i+C*S,u[a][o]=-b*S+C*i}if(C=f[s],l===s){if(C<0)for(f[s]=-C,a=0;a<d;a+=1)p[a][s]=-p[a][s];break}for(console.assert(E<49,"Error: no convergence."),w=f[l],m=v(g=(((b=f[s-1])-C)*(b+C)+((m=h[s-1])-(y=h[s]))*(m+y))/(2*y*b),1),g=g<0?((w-C)*(w+C)+y*(b/(g-m)-y))/w:((w-C)*(w+C)+y*(b/(g+m)-y))/w,i=1,S=1,o=l+1;o<s+1;o+=1){for(m=h[o],b=f[o],y=S*m,m*=i,C=v(g,y),h[o-1]=C,g=w*(i=g/C)+m*(S=y/C),m=-w*S+m*i,y=b*S,b*=i,a=0;a<d;a+=1)w=p[a][o-1],C=p[a][o],p[a][o-1]=w*i+C*S,p[a][o]=-w*S+C*i;for(C=v(g,y),f[o-1]=C,g=(i=g/C)*m+(S=y/C)*b,w=-S*m+i*b,a=0;a<c;a+=1)b=u[a][o-1],C=u[a][o],u[a][o-1]=b*i+C*S,u[a][o]=-b*S+C*i}h[l]=0,h[s]=g,f[s]=w}for(var T=0,R=f.length;T<R;T+=1)f[T]<n&&(f[T]=0);for(o=0;o<d;o+=1)for(a=o-1;a>=0;a-=1)if(f[a]<f[o]){i=f[a],f[a]=f[o],f[o]=i;for(var A=0,_=u.length;A<_;A+=1)t=u[A][o],u[A][o]=u[A][a],u[A][a]=t;for(var O=0,D=p.length;O<D;O+=1)t=p[O][o],p[O][o]=p[O][a],p[O][a]=t;o=a}return{U:u,S:f,V:p}},_O=function(e){return e.sort((function(e,t){return t-e})),e},OO=function(e,t,n,r){for(var i,o,a,s=[],l=[],u=0;u<e;u+=1)l.push([]);for(var c=0,d=t;c<d;c+=1){i=Math.sqrt(n[c]),o=0;for(var h=0,f=r.length;h<f;h+=1)a=Zv(r[h][c]*i,8),l[h][c]=a,o+=Zv(a*Math.abs(a),8);s.push(Zv(o,8))}return[l,s]},DO=function(){var e=[8,y.getState().respondentNames.length,y.getState().numStatements];return Math.min.apply(Math,e)},NO=function(e,t,n,r){for(var i=vt()(t),o=Xv.getState().firstColMaxWidth,a=[{headerName:r.nmTrans,field:"resNum",pinned:!0,editable:!1,sortable:!0,width:80,sort:"asc",cellStyle:{textAlign:"center"}},{headerName:r.participantTrans,field:"respondent",pinned:!0,editable:!1,sortable:!0,width:o,cellStyle:{textAlign:"center"}}],s=[r.nmTrans,r.participantTrans],l=0;l<e;l+=1){var u=l+1;s.push("".concat(r.factorTrans," ").concat(u)),a.push({headerName:"".concat(r.factorTrans," ").concat(u),field:"factor".concat(u),pinned:!1,sortable:!0,editable:!1,width:90,cellStyle:{textAlign:"center"}})}for(var c=[],d=[],h=0;h<i[0].length;h+=1){var f=[],p=h+1,v={},g=void 0,m=void 0;v.resNum=p,v.respondent=n[h],f.push(p,n[h]);for(var y=0;y<i.length;y+=1)m=y+1,g=Zv(i[y][h],4),v["factor".concat(m)]=g,f.push(g);c.push(v),d.push(f)}return d.unshift(s),{gridColDefsFactorTable:a,gridRowDataFactorTable:c,unrotatedFactorArray:d}},PO=function(e,t){for(var n,r=100/t,i=[],o=[],a=0,s=0,l=e.length;s<l;s+=1)e[s]=Zv(e[s],8),n=Zv(e[s]*r,0),i.push(n),a+=n,o.push(a);return[i,o]},FO=function(e,t){for(var n=0,r=e[0].length;n<r;n+=1)if(t[n]<0)for(var i=0;i<e.length;i+=1)e[i][n]=-e[i][n];return e},IO=function(e,t,n){for(var r=[{headerName:"",field:"EigenList",pinned:!0,sortable:!0,editable:!1,width:260,cellStyle:{textAlign:"center"}}],i=0;i<e;i+=1){var o=i+1;r.push({headerName:"".concat(n.factorTrans2," ").concat(o),field:"factor".concat(o),pinned:!1,sortable:!0,editable:!1,width:90,cellStyle:{textAlign:"center"}})}t[0].unshift(n.eigenValuesTrans),t[1].unshift(n.explainedVarianceTrans),t[2].unshift(n.cumuExplainedVarianceTrans);for(var a=[],s=0;s<t.length;s+=1){var l={};l.EigenList=t[s][0];for(var u=1;u<t[0].length;u+=1)l["factor".concat(u)]=0===s?Zv(t[s][u],4):t[s][u];a.push(l)}return{gridColDefsFacTableEigen:r,gridRowDataFacTableEigen:a}},LO=g()((function(e){return{numFactorsKeptForRot:0,setNumFactorsKeptForRot:function(t){return e((function(e){return d(d({},e),{},{numFactorsKeptForRot:t})}))},isLoadingsFactorsKept:!1,setIsLoadingsFactorsKept:function(t){return e((function(e){return d(d({},e),{},{isLoadingsFactorsKept:t})}))},isFacSelectDisabled:!1,setIsFacSelectDisabled:function(t){return e((function(e){return d(d({},e),{},{isFacSelectDisabled:t})}))},shouldDisplayFacKept:!1,setShouldDisplayFacKept:function(t){return e((function(e){return d(d({},e),{},{shouldDisplayFacKept:t})}))},shouldShowJudgeRotDiv:!1,setShouldShowJudgeRotDiv:function(t){return e((function(e){return d(d({},e),{},{shouldShowJudgeRotDiv:t})}))},judgeButtonActive:!1,setJudgeButtonActive:function(t){return e((function(e){return d(d({},e),{},{judgeButtonActive:t})}))},showScatterPlotTableDiv:!1,setShowScatterPlotTableDiv:function(t){return e((function(e){return d(d({},e),{},{showScatterPlotTableDiv:t})}))},abFactors:[],setAbFactors:function(t){return e((function(e){return d(d({},e),{},{abFactors:t})}))},userSelectedRotFactors:[],setUserSelectedRotFactors:function(t){return e((function(e){return d(d({},e),{},{userSelectedRotFactors:t})}))},varimaxButtonDisabled:!1,setVarimaxButtonDisabled:function(t){return e((function(e){return d(d({},e),{},{varimaxButtonDisabled:t})}))},varimaxButtonText:"Varimax Rotation",setVarimaxButtonText:function(t){return e((function(e){return d(d({},e),{},{varimaxButtonText:t})}))},varimaxButtonActive:!1,setVarimaxButtonActive:function(t){return e((function(e){return d(d({},e),{},{varimaxButtonActive:t})}))},rotationDegrees:0,setRotationDegrees:function(t){return e((function(e){return d(d({},e),{},{rotationDegrees:t})}))},isCalculatingVarimax:!1,setIsCalculatingVarimax:function(t){return e((function(e){return d(d({},e),{},{isCalculatingVarimax:t})}))},d3RotChartData:[],setD3RotChartData:function(t){return e((function(e){return d(d({},e),{},{d3RotChartData:t})}))},tempRotFacStateArray:[],setTempRotFacStateArray:function(t){return e((function(e){return d(d({},e),{},{tempRotFacStateArray:t})}))},highlightDegreeButton1:!1,setHighlightDegreeButton1:function(t){return e((function(e){return d(d({},e),{},{highlightDegreeButton1:t})}))},highlightDegreeButton2:!1,setHighlightDegreeButton2:function(t){return e((function(e){return d(d({},e),{},{highlightDegreeButton2:t})}))},highlightDegreeButton3:!1,setHighlightDegreeButton3:function(t){return e((function(e){return d(d({},e),{},{highlightDegreeButton3:t})}))},highlightDegreeButton4:!1,setHighlightDegreeButton4:function(t){return e((function(e){return d(d({},e),{},{highlightDegreeButton4:t})}))},highlightDegreeButton5:!1,setHighlightDegreeButton5:function(t){return e((function(e){return d(d({},e),{},{highlightDegreeButton5:t})}))},rotateByDegrees:0,setRotateByDegrees:function(t){return e((function(e){return d(d({},e),{},{rotateByDegrees:t})}))},participantDataObject:{respondent:"doNotDisplay"},setParticipantDataObject:function(t){return e((function(e){return d(d({},e),{},{participantDataObject:t})}))},calculateRotationsArray:[],setCalculateRotationsArray:function(t){return e((function(e){return d(d({},e),{},{calculateRotationsArray:t})}))},rotColDefsFactorTable:[],setRotColDefsFactorTable:function(t){return e((function(e){return d(d({},e),{},{rotColDefsFactorTable:t})}))},rotRowDataFactorTable:[],setRotRowDataFactorTable:function(t){return e((function(e){return d(d({},e),{},{rotRowDataFactorTable:t})}))},showRotFactorSelectWarning:!1,setShowRotFactorSelectWarning:function(t){return e((function(e){return d(d({},e),{},{showRotFactorSelectWarning:t})}))},shouldDisplayDegreeButtonButtons:!1,setShouldDisplayDegreeButtonButtons:function(t){return e((function(e){return d(d({},e),{},{shouldDisplayDegreeButtonButtons:t})}))},highlightDegreeInputButton:!1,setHighlightDegreeInputButton:function(t){return e((function(e){return d(d({},e),{},{highlightDegreeInputButton:t})}))},rotationDegreeInput:0,setRotationDegreeInput:function(t){return e((function(e){return d(d({},e),{},{rotationDegreeInput:t})}))},notifyForSavedRotations:!1,setNotifyForSavedRotations:function(t){return e((function(e){return d(d({},e),{},{notifyForSavedRotations:t})}))},shouldDisplayRotFactorButtons:!1,setShouldDisplayRotFactorButtons:function(t){return e((function(e){return d(d({},e),{},{shouldDisplayRotFactorButtons:t})}))},shouldClearRotButHigh:!1,setShouldClearRotButHigh:function(t){return e((function(e){return d(d({},e),{},{shouldClearRotButHigh:t})}))}}})),MO=LO,GO=function(e){var t,n,r,i,o,a,s,l=vt()(e),u=[],c=[];function d(e){return e*e}for(l.forEach((function(e){t=e.map(d),n=t.reduce((function(e,t){return e+t})),r=Zv(n,5),u.push(r),i=[];for(var o=0,s=t.length;o<s;o++)a=Zv(t[o],5),i.push(a);c.push(i)})),MO.setState({fSigCriterion:c,rowH2:u}),s=l.length,o=0;o<s;o++)l[o].push(u[o]);return l},BO=g()((function(e){return{factorMatrix:[],setFactorMatrix:function(t){return e((function(e){return d(d({},e),{},{factorMatrix:t})}))},eigenvalues:[],setEigenvalues:function(t){return e((function(e){return d(d({},e),{},{eigenvalues:t})}))},unrotatedFactorMatrix:[],setUnrotatedFactorMatrix:function(t){return e((function(e){return d(d({},e),{},{unrotatedFactorMatrix:t})}))},eigensPercentExpVar:[],setEigensPercentExpVar:function(t){return e((function(e){return d(d({},e),{},{eigensPercentExpVar:t})}))},cumulEigenPerVar:[],setCumulEigenPerVar:function(t){return e((function(e){return d(d({},e),{},{cumulEigenPerVar:t})}))},screePlotData:[],setScreePlotData:function(t){return e((function(e){return d(d({},e),{},{screePlotData:t})}))},isCentroidLoading:!1,setIsCentroidLoading:function(t){return e((function(e){return d(d({},e),{},{isCentroidLoading:t})}))},activeCentroidFactorsButton:!1,setActiveCentroidFactorsButton:function(t){return e((function(e){return d(d({},e),{},{activeCentroidFactorsButton:t})}))},numCentroidFactors:0,setNumCentroidFactors:function(t){return e((function(e){return d(d({},e),{},{numCentroidFactors:t})}))},gridColDefsFacTableEigen:[],setGridColDefsFacTableEigen:function(t){return e((function(e){return d(d({},e),{},{gridColDefsFacTableEigen:t})}))},gridRowDataFacTableEigen:[],setGridRowDataFacTableEigen:function(t){return e((function(e){return d(d({},e),{},{gridRowDataFacTableEigen:t})}))},calculateCommunalityArray:[],setCalculateCommunalityArray:function(t){return e((function(e){return d(d({},e),{},{calculateCommunalityArray:t})}))},rowH2:[],setRowH2:function(t){return e((function(e){return d(d({},e),{},{rowH2:t})}))},gridColDefsFactorTable:[],setGridColDefsFactorTable:function(t){return e((function(e){return d(d({},e),{},{gridColDefsFactorTable:t})}))},gridRowDataFactorTable:[],setGridRowDataFactorTable:function(t){return e((function(e){return d(d({},e),{},{gridRowDataFactorTable:t})}))},unrotatedFactorMatrixOutput:[],setUnrotatedFactorMatrixOutput:function(t){return e((function(e){return d(d({},e),{},{unrotatedFactorMatrixOutput:t})}))},explainedVariance:[],setExplainedVariance:function(t){return e((function(e){return d(d({},e),{},{explainedVariance:t})}))},showUnrotatedFactorTable:!1,setShowUnrotatedFactorTable:function(t){return e((function(e){return d(d({},e),{},{showUnrotatedFactorTable:t})}))},showEigenvaluesTable:!1,setShowEigenvaluesTable:function(t){return e((function(e){return d(d({},e),{},{showEigenvaluesTable:t})}))},showScreePlot:!1,setShowScreePlot:function(t){return e((function(e){return d(d({},e),{},{showScreePlot:t})}))},disabledPcaButton:!1,setDisabledPcaButton:function(t){return e((function(e){return d(d({},e),{},{disabledPcaButton:t})}))},disabledCentroidButton:!1,setDisabledCentroidButton:function(t){return e((function(e){return d(d({},e),{},{disabledCentroidButton:t})}))},showKeepFacForRotButton:!1,setShowKeepFacForRotButton:function(t){return e((function(e){return d(d({},e),{},{showKeepFacForRotButton:t})}))},activePcaButton:!1,setActivePcaButton:function(t){return e((function(e){return d(d({},e),{},{activePcaButton:t})}))},calculatingPca:!1,setCalculatingPca:function(t){return e((function(e){return d(d({},e),{},{calculatingPca:t})}))},pcaButtonText:"Extract Principal Components",setPcaButtonText:function(t){return e((function(e){return d(d({},e),{},{pcaButtonText:t})}))},numberofPrincipalComps:8,setNumberofPrincipalComps:function(t){return e((function(e){return d(d({},e),{},{numberofPrincipalComps:t})}))},numFacsExtracted:0,setNumFacsExtracted:function(t){return e((function(e){return d(d({},e),{},{numFacsExtracted:t})}))},centroidButtonText:"Calculate Centroid Factors",setCentroidButtonText:function(t){return e((function(e){return d(d({},e),{},{centroidButtonText:t})}))},showSections45:!1,setShowSections45:function(t){return e((function(e){return d(d({},e),{},{showSections45:t})}))}}})),jO=BO,HO=function(){var e=y.getState().projectHistoryArray,t=y.getState().numQsorts,n=y.getState().respondentNames,r=Xv.getState().correlation5Calcs,i=r.length,o=i,a=DO(),s=AO(r),l=s.S,u=s.U,c=_O(l),d=PO(c,i),h=d[0],f=d[1],p=OO(o,a,c,u),v=p[0],g=p[1];v=FO(v,g),GO(wt(v));var m=ip(v),w=8;t<w&&(w=t),c.length=w,h.length=w,f.length=w;var b=vt()(f);b.unshift("Cumulative Explained Variance");var C=vt()(h);C.unshift("percent explained variance");var S=vt()(c),E=[];S.forEach((function(e,t){var n=[];n.push(t+1,S[t]),E.push(n)}),undefined);e.push("Extracted 8 Principal Components"),jO.setState({factorMatrix:m,unrotatedFactorMatrix:m,eigenvalues:c,screePlotData:E,eigensPercentExpVar:C,cumulEigenPerVar:b,numFacsExtracted:8,numCentroidFactors:8}),y.setState({projectHistoryArray:e});var k=[c,h,f],x=NO(a,m,n,{participantTrans:"Participant",factorTrans:"Factor",nmTrans:"Nm"});jO.setState({gridColDefsFactorTable:x.gridColDefsFactorTable,gridRowDataFactorTable:x.gridRowDataFactorTable,unrotatedFactorMatrixOutput:x.unrotatedFactorArray});var T=IO(a,k,{eigenValuesTrans:"Eigenvalues",explainedVarianceTrans:"Explained Variance",cumuExplainedVarianceTrans:"Cumulative Explained Variance",factorTrans2:"Factor"});jO.setState({gridColDefsFacTableEigen:T.gridColDefsFacTableEigen,gridRowDataFacTableEigen:T.gridRowDataFacTableEigen,showUnrotatedFactorTable:!0,showEigenvaluesTable:!0,showScreePlot:!0,pcaButtonText:"Principal Components",calculatingPca:!1})},VO=function(){var e=jO(),t=e.activePcaButton,n=e.disabledPcaButton,i=e.pcaButtonText,o=e.setCalculatingPca,a=e.setActivePcaButton,s=e.setDisabledPcaButton,l=e.setDisabledCentroidButton,u=e.setShowKeepFacForRotButton,c=e.setShowSections45,d=Xv().correlation5Calcs,h=y(),f=h.projectHistoryArray,p=h.respondentNames,v=h.numStatements,g="bg-gray-100";!0===t&&(g="bg-green-300");return(0,r.jsx)("div",{className:"ml-24",children:(0,r.jsx)(C,{handleClick:function(){!0!==n&&(HO(f,d,p,v),o(!0),a(!0),u(!0),s(!0),l(!0),c(!0))},buttonText:i,buttonColor:g,otherFormatting:"w-[280px]"})})},WO=n(5080),zO=n.n(WO),UO=function(e){var t=zO()(e,(function(e,t){return Zv(e+t,8)}));return t},KO=function(e){var t=e.map((function(e){return Zv(e*e,8)}));return t},qO=function(e,t){var n=[],r=[];return e.forEach((function(i,o){var a=e[o],s=KO(a),l=Zv(UO(s),4);r.push(l);var u=Zv(l/t*100,0);n.push(u)}),undefined),[r,n]},XO=function(e,t,n){var r=e.slice(),i=t.slice();return n.forEach((function(e){for(var t=0;t<r.length;t+=1)r[t][e]=-r[t][e];for(var n=0;n<r[e].length;n+=1)r[e][n]=-r[e][n];i[e]=-i[e]}),undefined),[r,i]},YO=n(2034),QO=n.n(YO),ZO=n(9627),JO=n.n(ZO),$O=function(e,t){for(var n,r,i,o,a,s=[],l=0,u=t.length;l<u;l+=1)s.push(Zv(t[l]+.5,8));n=zO()(s,(function(e,t){return e+t})),r=Zv(Math.sqrt(n),8),i=QO()(s,(function(e){return Zv(e/r,8)})),a=[];for(var c=0,d=(o=QO()(i,(function(e){return Zv(e*e,8)}))).length;c<d;c+=1)a.push(Math.abs(Zv(o[c]-.5,8)));var h=JO()(a);function f(e){return n=zO()(e,(function(e,t){return Zv(e+t,8)})),n}function p(e){return i=QO()(e,(function(e){return Zv(e/r,8)}))}if(h>.001){do{for(var v=o,g=[],m=0,y=t.length;m<y;m+=1)g.push(Zv(t[m]+v[m],8));n=f(g),r=Zv(Math.sqrt(n),8),i=p(g),o=o=QO()(i,(function(e){return Zv(e*e,8)})),a=[];for(var w=0,b=v.length;w<b;w+=1)a.push(Math.abs(Zv(v[w]-o[w],8)));h=JO()(a)}while(h>.001);return i}return i},eD=function(e,t){var n,r=[];function i(e,t){return e.forEach((function(r){var i=r*e[t];n.push(Zv(i,8))}),this),n}for(var o=0,a=t.length;o<a;o+=1)n=[],n=i(t,o),r.push(n);for(var s=[],l=0,u=t.length;l<u;l+=1){for(var c=[],d=0,h=t.length;d<h;d+=1){var f=e[l][d]-r[l][d];c.push(Zv(f,8))}s.push(c)}for(var p=0,v=t.length;p<v;p+=1){var g=p;s[p][g]=1}return s},tD=function(e){for(var t=[],n=0,r=e.length;n<r;n+=1){for(var i=0,o=0,a=e.length;o<a;o+=1)i+=e[o][n];var s=Zv(i-=1,8);t.push(s)}return t},nD=function(e){var t=0,n=e[0];return e.forEach((function(r,i){e[i]<n&&(t=i,n=e[i])}),undefined),[n,t]},rD=function(e,t){for(var n,r,i,o=t,a=e.slice(),s=[],l=a.length;o<0;)if(n=tD(a),o=(r=nD(n))[0],i=r[1],o<0){for(var u=0;u<l;u+=1)a[u][i]=-a[u][i];for(var c=0,d=a[i].length;c<d;c+=1)a[i][c]=-a[i][c];s.push(i)}return[a,n,s]},iD=function(e){var t=tD(e),n=nD(t)[0];return n<0?rD(e,n):[e,t,[]]},oD=function(e){var t=iD(e),n=t[0],r=t[1],i=t[2],o=$O(n,r),a=eD(n,o),s=XO(a,o,i),l=s[0];return[s[1],l]},aD=function(e){e.shift();var t=[];return e.forEach((function(n,r){var i=[];i.push(r+1,e[r]),t.push(i)}),undefined),t},sD=function(e,t){var n=[],r=[],i=[],o=[],a=e.map((function(e,a){var s,l={},u=e.pop();if(u>1){var c,d=t[a];d=d.replace(/ /g,""),r.push(t[a]),l.participantName=d,l.communality=u,i.push(l),c="(".concat(d,": ").concat(u,")"),o.push(c);var h=Zv(1/Math.sqrt(u),7);return s=e.map((function(e){return Zv(e*h,7)})),n.push(a),s}return e}));return{adjustedParticipantsIndex:n,communalityArray:a,heywoodParticipantsArray:r,heywoodParticipantsCommunalityArray:i,heywoodParticipantsTextArray:o}},lD=function(e,t,n){var r=sD(e,t);jO.setState({heywoodAdjustedMatrix:r.communalityArray});var i=r.heywoodParticipantsTextArray;jO.setState({heywoodParticipantsTextJoin:i.join(", ")}),(r.heywoodParticipantsArray||[]).length>0?(jO.setState({showHeywoodCaseNotifications:!0,heywoodParticipantsArray:r.heywoodParticipantsArray,heywoodParticipantsCommunalityArray:r.heywoodParticipantsCommunalityArray,showUnrotatedFactorTable:!1,showEigenvaluesTable:!1,showScreePlot:!1,showKeepFacForRotButton:!1}),MO.setState({showKeepFacForRotButton:!1})):(jO.setState({showUnrotatedFactorTable:!0,showEigenvaluesTable:!0,showScreePlot:!0,showKeepFacForRotButton:!0}),MO.setState({showKeepFacForRotButton:!0}))},uD=function(e){for(var t=y.getState().projectHistoryArray,n=jO.getState().numCentroidFactors,r=y.getState().numQsorts,i=y.getState().respondentNames,o=Xv.getState().correlation5Calcs,a=[],s=0;s<e;s++){var l=oD(o);a.push(l[0]),o=l[1]}var u=vt()(a),c=vt()(a),d=ip(c),h=GO(d);lD(h,i,!1);var f=qO(u,r),p=NO(e,u,i,{participantTrans:"Participant",factorTrans:"Factor",nmTrans:"Nm"});jO.setState({gridColDefsFactorTable:p.gridColDefsFactorTable,gridRowDataFactorTable:p.gridRowDataFactorTable,unrotatedFactorMatrixOutput:p.unrotatedFactorArray});var v=PO(f[0],r),g={eigenValuesTrans:"Eigenvalues",explainedVarianceTrans:"Explained Variance",cumuExplainedVarianceTrans:"Cumulative Explained Variance",factorTrans2:"Factor"},m=IO(e,[f[0]].concat(wt(v)),g);jO.setState({gridColDefsFacTableEigen:m.gridColDefsFacTableEigen,gridRowDataFacTableEigen:m.gridRowDataFacTableEigen});var w=aD(f[0]),b={logMessage:"Brown Centroid Factors Extracted: ".concat(n),logType:"centroid"};t.push(b.logMessage);var C=f[0];C.unshift("Eigenvalues"),jO.setState({factorMatrix:c,eigenvalues:C,explainedVariance:f[1],unrotatedFactorMatrix:a,eigensPercentExpVar:v[0],cumulEigenPerVar:v[1],screePlotData:w,isCentroidLoading:!1}),y.setState({projectHistoryArray:t}),sessionStorage.setItem("facMatrixArc0",JSON.stringify(c))},cD=function(){var e=jO(),t=e.numCentroidFactors,n=e.activeCentroidFactorsButton,i=e.disabledCentroidButton,o=e.setActiveCentroidFactorsButton,a=e.setIsCentroidLoading,s=e.setShowUnrotatedFactorTable,l=e.setDisabledCentroidButton,u=e.setDisabledPcaButton,c=e.setShowKeepFacForRotButton,d=e.setShowEigenvaluesTable,h=e.setShowSections45,f=Xv().correlation5Calcs,p=y(),v=p.projectHistoryArray,g=p.numQsorts,m=p.respondentNames,w="bg-gray-100";!0===n&&(w="bg-green-300");return(0,r.jsxs)("div",{children:[(0,r.jsx)("dialog",{id:"centroidFactorSelectError",className:"modal",children:(0,r.jsxs)("form",{method:"dialog",className:"modal-box  border-2 border-gray-600",children:[(0,r.jsx)("p",{className:"font-bold text-2xl",children:"Input Error"}),(0,r.jsx)("p",{className:"p-4 pb-0",children:"Select the number of"}),(0,r.jsx)("p",{className:"py-0",children:"centroid factors to extract."}),(0,r.jsx)("div",{className:"modal-action",children:(0,r.jsx)(rg,{buttonText:"Close"})})]})}),(0,r.jsx)(C,{handleClick:function(){!0!==i&&(0===t?window.centroidFactorSelectError.showModal():(o(!0),uD(t,f,v,g,m),a(!1),s(!0),c(!0),d(!0),l(!0),u(!0),h(!0)))},buttonText:"Centroid Factors",buttonColor:w})]})},dD=function(){var e=jO(),t=e.setNumCentroidFactors,n=e.setNumFacsExtracted;return(0,r.jsxs)("div",{className:"flex flex-row items-center text-2xl",children:[(0,r.jsx)("p",{children:"Extract"}),(0,r.jsxs)("select",{className:"select select-bordered rounded-md max-w-xs ml-2 mr-2 hover:bg-gray-400 h-[30px] border border-gray-400",onChange:function(e,r){t(+e.target.value),n(+e.target.value)},children:[(0,r.jsx)("option",{value:0,children:"0"}),(0,r.jsx)("option",{value:1,children:"1"}),(0,r.jsx)("option",{value:2,children:"2"}),(0,r.jsx)("option",{value:3,children:"3"}),(0,r.jsx)("option",{value:4,children:"4"}),(0,r.jsx)("option",{value:5,children:"5"}),(0,r.jsx)("option",{value:6,children:"6"}),(0,r.jsx)("option",{value:7,children:"7"}),(0,r.jsx)("option",{value:8,children:"8"})]}),(0,r.jsx)(cD,{})]})},hD=function(){return(0,r.jsxs)("div",{className:"flex justify-center  w-full",children:[(0,r.jsx)(dD,{}),(0,r.jsx)(VO,{})]})},fD=function(){var e=jO(),t=e.gridColDefsFacTableEigen,n=e.gridRowDataFacTableEigen,i=267+90*e.numFacsExtracted;i>window.innerWidth-100&&(i=window.innerWidth-100),i+="px";return(0,r.jsx)("div",{className:" mb-16 mt-12 ",children:(0,r.jsx)("div",{style:{width:i},className:"ag-theme-fresh border border-gray-400",children:(0,r.jsx)(EO,{columnDefs:t,rowData:n,domLayout:"autoHeight",enableSorting:!0,gridOptions:{suppressRowHoverHighlight:!1,columnHoverHighlight:!0}})})})},pD=function(){var e=y().numQsorts,t=jO(),n=t.gridColDefsFactorTable,i=t.gridRowDataFactorTable,o=t.numFacsExtracted,a=Xv().firstColMaxWidth,s=o;function l(e){var t=40+25*e,n=window.innerHeight-270;return t<n?t+="px":n+="px"}function u(e){var t=80+a+90*e+20,n=window.innerWidth-140;return n<t?n+="px":t+="px"}window.addEventListener("resize",(function(){!function(){var t=document.querySelector("#loadingsTableContainer");null!==t&&(t.style.width=u(s),t.style.height=l(e))}()}));var c={marginTop:30,height:l(e),width:u(s),marginBottom:15};return(0,r.jsx)("div",{children:(0,r.jsx)("div",{style:d({},c),className:"ag-theme-fresh w-full border border-gray-400",children:(0,r.jsx)(EO,{columnDefs:n,rowData:i,gridOptions:{suppressRowHoverHighlight:!1,columnHoverHighlight:!0},animateRows:!0,enableSorting:!0})})})};function vD(e){return e}var gD=1,mD=2,yD=3,wD=4,bD=1e-6;function CD(e){return"translate("+e+",0)"}function SD(e){return"translate(0,"+e+")"}function ED(e){return function(t){return+e(t)}}function kD(e,t){return t=Math.max(0,e.bandwidth()-2*t)/2,e.round()&&(t=Math.round(t)),function(n){return+e(n)+t}}function xD(){return!this.__axis}function TD(e,t){var n=[],r=null,i=null,o=6,a=6,s=3,l="undefined"!==typeof window&&window.devicePixelRatio>1?0:.5,u=e===gD||e===wD?-1:1,c=e===wD||e===mD?"x":"y",d=e===gD||e===yD?CD:SD;function h(h){var f=null==r?t.ticks?t.ticks.apply(t,n):t.domain():r,p=null==i?t.tickFormat?t.tickFormat.apply(t,n):vD:i,v=Math.max(o,0)+s,g=t.range(),m=+g[0]+l,y=+g[g.length-1]+l,w=(t.bandwidth?kD:ED)(t.copy(),l),b=h.selection?h.selection():h,C=b.selectAll(".domain").data([null]),S=b.selectAll(".tick").data(f,t).order(),E=S.exit(),k=S.enter().append("g").attr("class","tick"),x=S.select("line"),T=S.select("text");C=C.merge(C.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),S=S.merge(k),x=x.merge(k.append("line").attr("stroke","currentColor").attr(c+"2",u*o)),T=T.merge(k.append("text").attr("fill","currentColor").attr(c,u*v).attr("dy",e===gD?"0em":e===yD?"0.71em":"0.32em")),h!==b&&(C=C.transition(h),S=S.transition(h),x=x.transition(h),T=T.transition(h),E=E.transition(h).attr("opacity",bD).attr("transform",(function(e){return isFinite(e=w(e))?d(e+l):this.getAttribute("transform")})),k.attr("opacity",bD).attr("transform",(function(e){var t=this.parentNode.__axis;return d((t&&isFinite(t=t(e))?t:w(e))+l)}))),E.remove(),C.attr("d",e===wD||e===mD?a?"M"+u*a+","+m+"H"+l+"V"+y+"H"+u*a:"M"+l+","+m+"V"+y:a?"M"+m+","+u*a+"V"+l+"H"+y+"V"+u*a:"M"+m+","+l+"H"+y),S.attr("opacity",1).attr("transform",(function(e){return d(w(e)+l)})),x.attr(c+"2",u*o),T.attr(c,u*v).text(p),b.filter(xD).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===mD?"start":e===wD?"end":"middle"),b.each((function(){this.__axis=w}))}return h.scale=function(e){return arguments.length?(t=e,h):t},h.ticks=function(){return n=Array.from(arguments),h},h.tickArguments=function(e){return arguments.length?(n=null==e?[]:Array.from(e),h):n.slice()},h.tickValues=function(e){return arguments.length?(r=null==e?null:Array.from(e),h):r&&r.slice()},h.tickFormat=function(e){return arguments.length?(i=e,h):i},h.tickSize=function(e){return arguments.length?(o=a=+e,h):o},h.tickSizeInner=function(e){return arguments.length?(o=+e,h):o},h.tickSizeOuter=function(e){return arguments.length?(a=+e,h):a},h.tickPadding=function(e){return arguments.length?(s=+e,h):s},h.offset=function(e){return arguments.length?(l=+e,h):l},h}function RD(e){return TD(yD,e)}function AD(e){return TD(wD,e)}function _D(){}function OD(e){return null==e?_D:function(){return this.querySelector(e)}}function DD(){return[]}function ND(e){return null==e?DD:function(){return this.querySelectorAll(e)}}function PD(e){return function(){return function(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}(e.apply(this,arguments))}}function FD(e){return function(){return this.matches(e)}}function ID(e){return function(t){return t.matches(e)}}var LD=Array.prototype.find;function MD(){return this.firstElementChild}var GD=Array.prototype.filter;function BD(){return Array.from(this.children)}function jD(e){return new Array(e.length)}function HD(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function VD(e,t,n,r,i,o){for(var a,s=0,l=t.length,u=o.length;s<u;++s)(a=t[s])?(a.__data__=o[s],r[s]=a):n[s]=new HD(e,o[s]);for(;s<l;++s)(a=t[s])&&(i[s]=a)}function WD(e,t,n,r,i,o,a){var s,l,u,c=new Map,d=t.length,h=o.length,f=new Array(d);for(s=0;s<d;++s)(l=t[s])&&(f[s]=u=a.call(l,l.__data__,s,t)+"",c.has(u)?i[s]=l:c.set(u,l));for(s=0;s<h;++s)u=a.call(e,o[s],s,o)+"",(l=c.get(u))?(r[s]=l,l.__data__=o[s],c.delete(u)):n[s]=new HD(e,o[s]);for(s=0;s<d;++s)(l=t[s])&&c.get(f[s])===l&&(i[s]=l)}function zD(e){return e.__data__}function UD(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function KD(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}HD.prototype={constructor:HD,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var qD="http://www.w3.org/1999/xhtml",XD={svg:"http://www.w3.org/2000/svg",xhtml:qD,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function YD(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),XD.hasOwnProperty(t)?{space:XD[t],local:e}:e}function QD(e){return function(){this.removeAttribute(e)}}function ZD(e){return function(){this.removeAttributeNS(e.space,e.local)}}function JD(e,t){return function(){this.setAttribute(e,t)}}function $D(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function eN(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function tN(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function nN(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function rN(e){return function(){this.style.removeProperty(e)}}function iN(e,t,n){return function(){this.style.setProperty(e,t,n)}}function oN(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function aN(e,t){return e.style.getPropertyValue(t)||nN(e).getComputedStyle(e,null).getPropertyValue(t)}function sN(e){return function(){delete this[e]}}function lN(e,t){return function(){this[e]=t}}function uN(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function cN(e){return e.trim().split(/^|\s+/)}function dN(e){return e.classList||new hN(e)}function hN(e){this._node=e,this._names=cN(e.getAttribute("class")||"")}function fN(e,t){for(var n=dN(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function pN(e,t){for(var n=dN(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function vN(e){return function(){fN(this,e)}}function gN(e){return function(){pN(this,e)}}function mN(e,t){return function(){(t.apply(this,arguments)?fN:pN)(this,e)}}function yN(){this.textContent=""}function wN(e){return function(){this.textContent=e}}function bN(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function CN(){this.innerHTML=""}function SN(e){return function(){this.innerHTML=e}}function EN(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function kN(){this.nextSibling&&this.parentNode.appendChild(this)}function xN(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function TN(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===qD&&t.documentElement.namespaceURI===qD?t.createElement(e):t.createElementNS(n,e)}}function RN(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function AN(e){var t=YD(e);return(t.local?RN:TN)(t)}function _N(){return null}function ON(){var e=this.parentNode;e&&e.removeChild(this)}function DN(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function NN(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function PN(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function FN(e,t,n){return function(){var r,i=this.__on,o=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=t);this.addEventListener(e.type,o,n),r={type:e.type,name:e.name,value:t,listener:o,options:n},i?i.push(r):this.__on=[r]}}function IN(e,t,n){var r=nN(e),i=r.CustomEvent;"function"===typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function LN(e,t){return function(){return IN(this,e,t)}}function MN(e,t){return function(){return IN(this,e,t.apply(this,arguments))}}hN.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var GN=Tt().mark(BN);function BN(){var e,t,n,r,i,o,a;return Tt().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e=this._groups,t=0,n=e.length;case 1:if(!(t<n)){s.next=13;break}r=e[t],i=0,o=r.length;case 3:if(!(i<o)){s.next=10;break}if(!(a=r[i])){s.next=7;break}return s.next=7,a;case 7:++i,s.next=3;break;case 10:++t,s.next=1;break;case 13:case"end":return s.stop()}}),GN,this)}var jN=[null];function HN(e,t){this._groups=e,this._parents=t}function VN(){return new HN([[document.documentElement]],jN)}HN.prototype=VN.prototype=u({constructor:HN,select:function(e){"function"!==typeof e&&(e=OD(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=t[i],l=s.length,u=r[i]=new Array(l),c=0;c<l;++c)(o=s[c])&&(a=e.call(o,o.__data__,c,s))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new HN(r,this._parents)},selectAll:function(e){e="function"===typeof e?PD(e):ND(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a,s=t[o],l=s.length,u=0;u<l;++u)(a=s[u])&&(r.push(e.call(a,a.__data__,u,s)),i.push(a));return new HN(r,i)},selectChild:function(e){return this.select(null==e?MD:function(e){return function(){return LD.call(this.children,e)}}("function"===typeof e?e:ID(e)))},selectChildren:function(e){return this.selectAll(null==e?BD:function(e){return function(){return GD.call(this.children,e)}}("function"===typeof e?e:ID(e)))},filter:function(e){"function"!==typeof e&&(e=FD(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a=t[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&l.push(o);return new HN(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,zD);var n=t?WD:VD,r=this._parents,i=this._groups;"function"!==typeof e&&(e=function(e){return function(){return e}}(e));for(var o=i.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],d=i[u],h=d.length,f=UD(e.call(c,c&&c.__data__,u,r)),p=f.length,v=s[u]=new Array(p),g=a[u]=new Array(p);n(c,d,v,g,l[u]=new Array(h),f,t);for(var m,y,w=0,b=0;w<p;++w)if(m=v[w]){for(w>=b&&(b=w+1);!(y=g[b])&&++b<p;);m._next=y||null}}return(a=new HN(a,r))._enter=s,a._exit=l,a},enter:function(){return new HN(this._enter||this._groups.map(jD),this._parents)},exit:function(){return new HN(this._exit||this._groups.map(jD),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,o=this.exit();return"function"===typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),l=0;l<a;++l)for(var u,c=n[l],d=r[l],h=c.length,f=s[l]=new Array(h),p=0;p<h;++p)(u=c[p]||d[p])&&(f[p]=u);for(;l<i;++l)s[l]=n[l];return new HN(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=KD);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,u=i[o]=new Array(l),c=0;c<l;++c)(a=s[c])&&(u[c]=a);u.sort(t)}return new HN(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var e,t=0,n=dg(this);try{for(n.s();!(e=n.n()).done;){e.value;++t}}catch(r){n.e(r)}finally{n.f()}return t},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],a=0,s=o.length;a<s;++a)(i=o[a])&&e.call(i,i.__data__,a,o);return this},attr:function(e,t){var n=YD(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?ZD:QD:"function"===typeof t?n.local?tN:eN:n.local?$D:JD)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?rN:"function"===typeof t?oN:iN)(e,t,null==n?"":n)):aN(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?sN:"function"===typeof t?uN:lN)(e,t)):this.node()[e]},classed:function(e,t){var n=cN(e+"");if(arguments.length<2){for(var r=dN(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof t?mN:t?vN:gN)(n,t))},text:function(e){return arguments.length?this.each(null==e?yN:("function"===typeof e?bN:wN)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?CN:("function"===typeof e?EN:SN)(e)):this.node().innerHTML},raise:function(){return this.each(kN)},lower:function(){return this.each(xN)},append:function(e){var t="function"===typeof e?e:AN(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"===typeof e?e:AN(e),r=null==t?_N:"function"===typeof t?t:OD(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(ON)},clone:function(e){return this.select(e?NN:DN)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=function(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}(e+""),a=o.length;if(!(arguments.length<2)){for(s=t?FN:PN,r=0;r<a;++r)this.each(s(o[r],t,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"===typeof t?MN:LN)(e,t))}},Symbol.iterator,BN);var WN=VN,zN={value:function(){}};function UN(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new KN(r)}function KN(e){this._=e}function qN(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function XN(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=zN,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}KN.prototype=UN.prototype={constructor:KN,on:function(e,t){var n,r,i=this._,o=(r=i,(e+"").trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}))),a=-1,s=o.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++a<s;)if(n=(e=o[a]).type)i[n]=XN(i[n],e.name,t);else if(null==t)for(n in i)i[n]=XN(i[n],e.name,null);return this}for(;++a<s;)if((n=(e=o[a]).type)&&(n=qN(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new KN(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};var YN,QN,ZN=UN,JN=0,$N=0,eP=0,tP=1e3,nP=0,rP=0,iP=0,oP="object"===typeof performance&&performance.now?performance:Date,aP="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function sP(){return rP||(aP(lP),rP=oP.now()+iP)}function lP(){rP=0}function uP(){this._call=this._time=this._next=null}function cP(e,t,n){var r=new uP;return r.restart(e,t,n),r}function dP(){rP=(nP=oP.now())+iP,JN=$N=0;try{!function(){sP(),++JN;for(var e,t=YN;t;)(e=rP-t._time)>=0&&t._call.call(void 0,e),t=t._next;--JN}()}finally{JN=0,function(){var e,t,n=YN,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:YN=t);QN=e,fP(r)}(),rP=0}}function hP(){var e=oP.now(),t=e-nP;t>tP&&(iP-=t,nP=e)}function fP(e){JN||($N&&($N=clearTimeout($N)),e-rP>24?(e<1/0&&($N=setTimeout(dP,e-oP.now()-iP)),eP&&(eP=clearInterval(eP))):(eP||(nP=oP.now(),eP=setInterval(hP,tP)),JN=1,aP(dP)))}function pP(e,t,n){var r=new uP;return t=null==t?0:+t,r.restart((function(n){r.stop(),e(n+t)}),t,n),r}uP.prototype=cP.prototype={constructor:uP,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?sP():+n)+(null==t?0:+t),this._next||QN===this||(QN?QN._next=this:YN=this,QN=this),this._call=e,this._time=n,fP()},stop:function(){this._call&&(this._call=null,this._time=1/0,fP())}};var vP=ZN("start","end","cancel","interrupt"),gP=[],mP=0,yP=1,wP=2,bP=3,CP=4,SP=5,EP=6;function kP(e,t,n,r,i,o){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function o(e){n.state=yP,n.timer.restart(a,n.delay,n.time),n.delay<=e&&a(e-n.delay)}function a(o){var u,c,d,h;if(n.state!==yP)return l();for(u in i)if((h=i[u]).name===n.name){if(h.state===bP)return pP(a);h.state===CP?(h.state=EP,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete i[u]):+u<t&&(h.state=EP,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete i[u])}if(pP((function(){n.state===bP&&(n.state=CP,n.timer.restart(s,n.delay,n.time),s(o))})),n.state=wP,n.on.call("start",e,e.__data__,n.index,n.group),n.state===wP){for(n.state=bP,r=new Array(d=n.tween.length),u=0,c=-1;u<d;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(r[++c]=h);r.length=c+1}}function s(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=SP,1),o=-1,a=r.length;++o<a;)r[o].call(e,i);n.state===SP&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var r in n.state=EP,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=cP(o,0,n.time)}(e,n,{name:t,index:r,group:i,on:vP,tween:gP,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:mP})}function xP(e,t){var n=RP(e,t);if(n.state>mP)throw new Error("too late; already scheduled");return n}function TP(e,t){var n=RP(e,t);if(n.state>bP)throw new Error("too late; already running");return n}function RP(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function AP(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var _P,OP=180/Math.PI,DP={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function NP(e,t,n,r,i,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*OP,skewX:Math.atan(l)*OP,scaleX:a,scaleY:s}}function PP(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],l=[];return o=e(o),a=e(a),function(e,r,i,o,a,s){if(e!==i||r!==o){var l=a.push("translate(",null,t,null,n);s.push({i:l-4,x:AP(e,i)},{i:l-2,x:AP(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:AP(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,a.rotate,s,l),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:AP(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,a.skewX,s,l),function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:AP(e,n)},{i:s-2,x:AP(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(e){for(var t,n=-1,r=l.length;++n<r;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var FP=PP((function(e){var t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?DP:NP(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),IP=PP((function(e){return null==e?DP:(_P||(_P=document.createElementNS("http://www.w3.org/2000/svg","g")),_P.setAttribute("transform",e),(e=_P.transform.baseVal.consolidate())?NP((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):DP)}),", ",")",")");function LP(e,t){var n,r;return function(){var i=TP(this,e),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===t){(r=r.slice()).splice(a,1);break}i.tween=r}}function MP(e,t,n){var r,i;if("function"!==typeof n)throw new Error;return function(){var o=TP(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===t){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function GP(e,t,n){var r=e._id;return e.each((function(){var e=TP(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return RP(e,r).value[t]}}function BP(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function jP(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function HP(){}var VP=.7,WP=1/VP,zP="\\s*([+-]?\\d+)\\s*",UP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",KP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qP=/^#([0-9a-f]{3,8})$/,XP=new RegExp("^rgb\\(".concat(zP,",").concat(zP,",").concat(zP,"\\)$")),YP=new RegExp("^rgb\\(".concat(KP,",").concat(KP,",").concat(KP,"\\)$")),QP=new RegExp("^rgba\\(".concat(zP,",").concat(zP,",").concat(zP,",").concat(UP,"\\)$")),ZP=new RegExp("^rgba\\(".concat(KP,",").concat(KP,",").concat(KP,",").concat(UP,"\\)$")),JP=new RegExp("^hsl\\(".concat(UP,",").concat(KP,",").concat(KP,"\\)$")),$P=new RegExp("^hsla\\(".concat(UP,",").concat(KP,",").concat(KP,",").concat(UP,"\\)$")),eF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tF(){return this.rgb().formatHex()}function nF(){return this.rgb().formatRgb()}function rF(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=qP.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?iF(t):3===n?new sF(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?oF(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?oF(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=XP.exec(e))?new sF(t[1],t[2],t[3],1):(t=YP.exec(e))?new sF(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=QP.exec(e))?oF(t[1],t[2],t[3],t[4]):(t=ZP.exec(e))?oF(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=JP.exec(e))?fF(t[1],t[2]/100,t[3]/100,1):(t=$P.exec(e))?fF(t[1],t[2]/100,t[3]/100,t[4]):eF.hasOwnProperty(e)?iF(eF[e]):"transparent"===e?new sF(NaN,NaN,NaN,0):null}function iF(e){return new sF(e>>16&255,e>>8&255,255&e,1)}function oF(e,t,n,r){return r<=0&&(e=t=n=NaN),new sF(e,t,n,r)}function aF(e,t,n,r){return 1===arguments.length?((i=e)instanceof HP||(i=rF(i)),i?new sF((i=i.rgb()).r,i.g,i.b,i.opacity):new sF):new sF(e,t,n,null==r?1:r);var i}function sF(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function lF(){return"#".concat(hF(this.r)).concat(hF(this.g)).concat(hF(this.b))}function uF(){var e=cF(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(dF(this.r),", ").concat(dF(this.g),", ").concat(dF(this.b)).concat(1===e?")":", ".concat(e,")"))}function cF(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function dF(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hF(e){return((e=dF(e))<16?"0":"")+e.toString(16)}function fF(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new vF(e,t,n,r)}function pF(e){if(e instanceof vF)return new vF(e.h,e.s,e.l,e.opacity);if(e instanceof HP||(e=rF(e)),!e)return new vF;if(e instanceof vF)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new vF(a,s,l,e.opacity)}function vF(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function gF(e){return(e=(e||0)%360)<0?e+360:e}function mF(e){return Math.max(0,Math.min(1,e||0))}function yF(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function wF(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}BP(HP,rF,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:tF,formatHex:tF,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return pF(this).formatHsl()},formatRgb:nF,toString:nF}),BP(sF,aF,jP(HP,{brighter:function(e){return e=null==e?WP:Math.pow(WP,e),new sF(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?VP:Math.pow(VP,e),new sF(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new sF(dF(this.r),dF(this.g),dF(this.b),cF(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:lF,formatHex:lF,formatHex8:function(){return"#".concat(hF(this.r)).concat(hF(this.g)).concat(hF(this.b)).concat(hF(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:uF,toString:uF})),BP(vF,(function(e,t,n,r){return 1===arguments.length?pF(e):new vF(e,t,n,null==r?1:r)}),jP(HP,{brighter:function(e){return e=null==e?WP:Math.pow(WP,e),new vF(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?VP:Math.pow(VP,e),new vF(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new sF(yF(e>=240?e-240:e+120,i,r),yF(e,i,r),yF(e<120?e+240:e-120,i,r),this.opacity)},clamp:function(){return new vF(gF(this.h),mF(this.s),mF(this.l),cF(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=cF(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(gF(this.h),", ").concat(100*mF(this.s),"%, ").concat(100*mF(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));var bF=function(e){return function(){return e}};function CF(e,t){return function(n){return e+n*t}}function SF(e){return 1===(e=+e)?EF:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):bF(isNaN(t)?n:t)}}function EF(e,t){var n=t-e;return n?CF(e,n):bF(isNaN(e)?t:e)}var kF=function e(t){var n=SF(t);function r(e,t){var r=n((e=aF(e)).r,(t=aF(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=EF(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function xF(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=aF(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}xF((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return wF((n-r/t)*t,a,i,o,s)}})),xF((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return wF((n-r/t)*t,i,o,a,s)}}));var TF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,RF=new RegExp(TF.source,"g");function AF(e,t){var n,r,i,o=TF.lastIndex=RF.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(n=TF.exec(e))&&(r=RF.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:AP(n,r)})),o=RF.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function _F(e,t){var n;return("number"===typeof t?AP:t instanceof rF?kF:(n=rF(t))?(t=n,kF):AF)(e,t)}function OF(e){return function(){this.removeAttribute(e)}}function DF(e){return function(){this.removeAttributeNS(e.space,e.local)}}function NF(e,t,n){var r,i,o=n+"";return function(){var a=this.getAttribute(e);return a===o?null:a===r?i:i=t(r=a,n)}}function PF(e,t,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===o?null:a===r?i:i=t(r=a,n)}}function FF(e,t,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(e))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=t(r=a,l));this.removeAttribute(e)}}function IF(e,t,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=t(r=a,l));this.removeAttributeNS(e.space,e.local)}}function LF(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,i)),n}return i._value=t,i}function MF(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,i)),n}return i._value=t,i}function GF(e,t){return function(){xP(this,e).delay=+t.apply(this,arguments)}}function BF(e,t){return t=+t,function(){xP(this,e).delay=t}}function jF(e,t){return function(){TP(this,e).duration=+t.apply(this,arguments)}}function HF(e,t){return t=+t,function(){TP(this,e).duration=t}}var VF=WN.prototype.constructor;function WF(e){return function(){this.style.removeProperty(e)}}var zF=0;function UF(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function KF(){return++zF}var qF=WN.prototype;UF.prototype=function(e){return WN().transition(e)}.prototype=u({constructor:UF,select:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=OD(e));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,l,u=r[a],c=u.length,d=o[a]=new Array(c),h=0;h<c;++h)(s=u[h])&&(l=e.call(s,s.__data__,h,u))&&("__data__"in s&&(l.__data__=s.__data__),d[h]=l,kP(d[h],t,n,h,d,RP(s,n)));return new UF(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=ND(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l,u=r[s],c=u.length,d=0;d<c;++d)if(l=u[d]){for(var h,f=e.call(l,l.__data__,d,u),p=RP(l,n),v=0,g=f.length;v<g;++v)(h=f[v])&&kP(h,t,n,v,f,p);o.push(f),a.push(l)}return new UF(o,a,t,n)},selectChild:qF.selectChild,selectChildren:qF.selectChildren,filter:function(e){"function"!==typeof e&&(e=FD(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a=t[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&l.push(o);return new UF(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,u=t[s],c=n[s],d=u.length,h=a[s]=new Array(d),f=0;f<d;++f)(l=u[f]||c[f])&&(h[f]=l);for(;s<r;++s)a[s]=t[s];return new UF(a,this._parents,this._name,this._id)},selection:function(){return new VF(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=KF(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)if(a=s[u]){var c=RP(a,t);kP(a,e,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new UF(r,this._parents,e,n)},call:qF.call,nodes:qF.nodes,node:qF.node,size:qF.size,empty:qF.empty,each:qF.each,on:function(e,t){var n=this._id;return arguments.length<2?RP(this.node(),n).on.on(e):this.each(function(e,t,n){var r,i,o=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?xP:TP;return function(){var a=o(this,e),s=a.on;s!==r&&(i=(r=s).copy()).on(t,n),a.on=i}}(n,e,t))},attr:function(e,t){var n=YD(e),r="transform"===n?IP:_F;return this.attrTween(e,"function"===typeof t?(n.local?IF:FF)(n,r,GP(this,"attr."+e,t)):null==t?(n.local?DF:OF)(n):(n.local?PF:NF)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;var r=YD(e);return this.tween(n,(r.local?LF:MF)(r,t))},style:function(e,t,n){var r="transform"===(e+="")?FP:_F;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var o=aN(this,e),a=(this.style.removeProperty(e),aN(this,e));return o===a?null:o===n&&a===r?i:i=t(n=o,r=a)}}(e,r)).on("end.style."+e,WF(e)):"function"===typeof t?this.styleTween(e,function(e,t,n){var r,i,o;return function(){var a=aN(this,e),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=aN(this,e)),a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s))}}(e,r,GP(this,"style."+e,t))).each(function(e,t){var n,r,i,o,a="style."+t,s="end."+a;return function(){var l=TP(this,e),u=l.on,c=null==l.value[a]?o||(o=WF(t)):void 0;u===n&&i===c||(r=(n=u).copy()).on(s,i=c),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,o=n+"";return function(){var a=aN(this,e);return a===o?null:a===r?i:i=t(r=a,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!==typeof t)throw new Error;return this.tween(r,function(e,t,n){var r,i;function o(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&function(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}(e,o,n)),r}return o._value=t,o}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(GP(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!==typeof e)throw new Error;return this.tween(t,function(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&function(e){return function(t){this.textContent=e.call(this,t)}}(r)),t}return r._value=e,r}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=RP(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===e)return r.value;return null}return this.each((null==t?LP:MP)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?GF:BF)(t,e)):RP(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?jF:HF)(t,e)):RP(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!==typeof t)throw new Error;return function(){TP(this,e).ease=t}}(t,e)):RP(this.node(),t).ease},easeVarying:function(e){if("function"!==typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!==typeof n)throw new Error;TP(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0===--i&&o()}};n.each((function(){var n=TP(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),n.on=t})),0===i&&o()}))}},Symbol.iterator,qF[Symbol.iterator]);var XF={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function YF(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}WN.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var n,r,i,o=e.__transition,a=!0;if(o){for(i in t=null==t?null:t+"",o)(n=o[i]).name===t?(r=n.state>wP&&n.state<SP,n.state=EP,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete e.__transition}}(this,e)}))},WN.prototype.transition=function(e){var t,n;e instanceof UF?(t=e._id,e=e._name):(t=KF(),(n=XF).time=sP(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)(a=s[u])&&kP(a,e,t,u,s,n||YF(a,t));return new UF(r,this._parents,e,t)};Math.abs,Math.max,Math.min;function QF(e){return[+e[0],+e[1]]}function ZF(e){return[QF(e[0]),QF(e[1])]}["w","e"].map(JF),["n","s"].map(JF),["n","w","e","s","nw","ne","sw","se"].map(JF);function JF(e){return{type:e}}var $F=Math.sqrt(50),eI=Math.sqrt(10),tI=Math.sqrt(2);function nI(e,t,n){var r,i,o,a=(t-e)/Math.max(0,n),s=Math.floor(Math.log10(a)),l=a/Math.pow(10,s),u=l>=$F?10:l>=eI?5:l>=tI?2:1;return s<0?(o=Math.pow(10,-s)/u,(r=Math.round(e*o))/o<e&&++r,(i=Math.round(t*o))/o>t&&--i,o=-o):(o=Math.pow(10,s)*u,(r=Math.round(e/o))*o<e&&++r,(i=Math.round(t/o))*o>t&&--i),i<r&&.5<=n&&n<2?nI(e,t,2*n):[r,i,o]}function rI(e,t,n){return nI(e=+e,t=+t,n=+n)[2]}function iI(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function oI(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function aI(e){var t,n,r;function i(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<o){if(0!==t(r,r))return o;do{var a=i+o>>>1;n(e[a],r)<0?i=a+1:o=a}while(i<o)}return i}return 2!==e.length?(t=iI,n=function(t,n){return iI(e(t),n)},r=function(t,n){return e(t)-n}):(t=e===iI||e===oI?e:sI,n=e,r=e),{left:i,center:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=i(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o},right:function(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<o){if(0!==t(r,r))return o;do{var a=i+o>>>1;n(e[a],r)<=0?i=a+1:o=a}while(i<o)}return i}}}function sI(){return 0}var lI=aI(iI),uI=lI.right,cI=(lI.left,aI((function(e){return null===e?NaN:+e})).center,uI);function dI(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=vI(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}function hI(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function fI(e,t){var n,r={},i={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=vI(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}function pI(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function vI(e,t){var n,r=typeof t;return null==t||"boolean"===r?bF(t):("number"===r?AP:"string"===r?(n=rF(t))?(t=n,kF):AF:t instanceof rF?kF:t instanceof Date?hI:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?pI:Array.isArray(t)?dI:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?fI:AP)(e,t)}function gI(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function mI(e){return+e}var yI=[0,1];function wI(e){return e}function bI(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function CI(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=bI(i,r),o=n(a,o)):(r=bI(r,i),o=n(o,a)),function(e){return o(r(e))}}function SI(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=bI(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=cI(e,t,1,r)-1;return o[n](i[n](t))}}function EI(){var e,t,n,r,i,o,a=yI,s=yI,l=vI,u=wI;function c(){var e=Math.min(a.length,s.length);return u!==wI&&(u=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(a[0],a[e-1])),r=e>2?SI:CI,i=o=null,d}function d(t){return null==t||isNaN(t=+t)?n:(i||(i=r(a.map(e),s,l)))(e(u(t)))}return d.invert=function(n){return u(t((o||(o=r(s,a.map(e),AP)))(n)))},d.domain=function(e){return arguments.length?(a=Array.from(e,mI),c()):a.slice()},d.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},d.rangeRound=function(e){return s=Array.from(e),l=gI,c()},d.clamp=function(e){return arguments.length?(u=!!e||wI,c()):u!==wI},d.interpolate=function(e){return arguments.length?(l=e,c()):l},d.unknown=function(e){return arguments.length?(n=e,d):n},function(n,r){return e=n,t=r,c()}}function kI(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}var xI,TI=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function RI(e){if(!(t=TI.exec(e)))throw new Error("invalid format: "+e);var t;return new AI({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function AI(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function _I(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function OI(e){return(e=_I(Math.abs(e)))?e[1]:NaN}function DI(e,t){var n=_I(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}RI.prototype=AI.prototype,AI.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var NI={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return DI(100*e,t)},r:DI,s:function(e,t){var n=_I(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(xI=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+_I(e,Math.max(0,t+o-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function PI(e){return e}var FI,II,LI,MI=Array.prototype.map,GI=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function BI(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?PI:(t=MI.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(e.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?PI:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(MI.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",u=void 0===e.minus?"\u2212":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function d(e){var t=(e=RI(e)).fill,n=e.align,d=e.sign,h=e.symbol,f=e.zero,p=e.width,v=e.comma,g=e.precision,m=e.trim,y=e.type;"n"===y?(v=!0,y="g"):NI[y]||(void 0===g&&(g=12),m=!0,y="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var w="$"===h?i:"#"===h&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",b="$"===h?o:/[%p]/.test(y)?l:"",C=NI[y],S=/[defgprs%]/.test(y);function E(e){var i,o,l,h=w,E=b;if("c"===y)E=C(e)+E,e="";else{var k=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:C(Math.abs(e),g),m&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),k&&0===+e&&"+"!==d&&(k=!1),h=(k?"("===d?d:u:"-"===d||"("===d?"":d)+h,E=("s"===y?GI[8+xI/3]:"")+E+(k&&"("===d?")":""),S)for(i=-1,o=e.length;++i<o;)if(48>(l=e.charCodeAt(i))||l>57){E=(46===l?a+e.slice(i+1):e.slice(i))+E,e=e.slice(0,i);break}}v&&!f&&(e=r(e,1/0));var x=h.length+e.length+E.length,T=x<p?new Array(p-x+1).join(t):"";switch(v&&f&&(e=r(T+e,T.length?p-E.length:1/0),T=""),n){case"<":e=h+e+E+T;break;case"=":e=h+T+e+E;break;case"^":e=T.slice(0,x=T.length>>1)+h+e+E+T.slice(x);break;default:e=T+h+e+E}return s(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),E.toString=function(){return e+""},E}return{format:d,formatPrefix:function(e,t){var n=d(((e=RI(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(OI(t)/3))),i=Math.pow(10,-r),o=GI[8+r/3];return function(e){return n(i*e)+o}}}}function jI(e,t,n,r){var i,o=function(e,t,n){n=+n;var r=(t=+t)<(e=+e),i=r?rI(t,e,n):rI(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}(e,t,n);switch((r=RI(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(OI(t)/3)))-OI(Math.abs(e)))}(o,a))||(r.precision=i),LI(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,OI(t)-OI(e))+1}(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-OI(Math.abs(e)))}(o))||(r.precision=i-2*("%"===r.type))}return II(r)}function HI(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];var r=t<e,i=Y(r?nI(t,e,n):nI(e,t,n),3),o=i[0],a=i[1],s=i[2];if(!(a>=o))return[];var l=a-o+1,u=new Array(l);if(r)if(s<0)for(var c=0;c<l;++c)u[c]=(a-c)/-s;else for(var d=0;d<l;++d)u[d]=(a-d)*s;else if(s<0)for(var h=0;h<l;++h)u[h]=(o+h)/-s;else for(var f=0;f<l;++f)u[f]=(o+f)*s;return u}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return jI(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),a=0,s=o.length-1,l=o[a],u=o[s],c=10;for(u<l&&(i=l,l=u,u=i,i=a,a=s,s=i);c-- >0;){if((i=rI(l,u,n))===r)return o[a]=l,o[s]=u,t(o);if(i>0)l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i}r=i}return e},e}function VI(){var e=EI()(wI,wI);return e.copy=function(){return t=e,VI().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown());var t},kI.apply(e,arguments),HI(e)}function WI(e){return"string"===typeof e?new HN([[document.querySelector(e)]],[document.documentElement]):new HN([[e]],jN)}FI=BI({thousands:",",grouping:[3],currency:["$",""]}),II=FI.format,LI=FI.formatPrefix;var zI,UI,KI,qI,XI,YI,QI,ZI,JI,$I,eL,tL,nL,rL;Array.prototype.slice;function iL(e){return function(){return e}}function oL(e){this._context=e}function aL(e){return new oL(e)}function sL(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}oL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var lL=Math.PI,uL=2*lL,cL=1e-6,dL=uL-cL;function hL(e){this._+=e[0];for(var t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}var fL=function(){function e(t){T(this,e),this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?hL:function(e){var t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return hL;var n=Math.pow(10,t);return function(e){this._+=e[0];for(var t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(t)}return A(e,[{key:"moveTo",value:function(e,t){this._append(zI||(zI=sL(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(UI||(UI=sL(["Z"]))))}},{key:"lineTo",value:function(e,t){this._append(KI||(KI=sL(["L",",",""])),this._x1=+e,this._y1=+t)}},{key:"quadraticCurveTo",value:function(e,t,n,r){this._append(qI||(qI=sL(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}},{key:"bezierCurveTo",value:function(e,t,n,r,i,o){this._append(XI||(XI=sL(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+i,this._y1=+o)}},{key:"arcTo",value:function(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error("negative radius: ".concat(i));var o=this._x1,a=this._y1,s=n-e,l=r-t,u=o-e,c=a-t,d=u*u+c*c;if(null===this._x1)this._append(YI||(YI=sL(["M",",",""])),this._x1=e,this._y1=t);else if(d>cL)if(Math.abs(c*s-l*u)>cL&&i){var h=n-o,f=r-a,p=s*s+l*l,v=h*h+f*f,g=Math.sqrt(p),m=Math.sqrt(d),y=i*Math.tan((lL-Math.acos((p+d-v)/(2*g*m)))/2),w=y/m,b=y/g;Math.abs(w-1)>cL&&this._append(ZI||(ZI=sL(["L",",",""])),e+w*u,t+w*c),this._append(JI||(JI=sL(["A",",",",0,0,",",",",",""])),i,i,+(c*h>u*f),this._x1=e+b*s,this._y1=t+b*l)}else this._append(QI||(QI=sL(["L",",",""])),this._x1=e,this._y1=t);else;}},{key:"arc",value:function(e,t,n,r,i,o){if(e=+e,t=+t,o=!!o,(n=+n)<0)throw new Error("negative radius: ".concat(n));var a=n*Math.cos(r),s=n*Math.sin(r),l=e+a,u=t+s,c=1^o,d=o?r-i:i-r;null===this._x1?this._append($I||($I=sL(["M",",",""])),l,u):(Math.abs(this._x1-l)>cL||Math.abs(this._y1-u)>cL)&&this._append(eL||(eL=sL(["L",",",""])),l,u),n&&(d<0&&(d=d%uL+uL),d>dL?this._append(tL||(tL=sL(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,c,e-a,t-s,n,n,c,this._x1=l,this._y1=u):d>cL&&this._append(nL||(nL=sL(["A",",",",0,",",",",",",",""])),n,n,+(d>=lL),c,this._x1=e+n*Math.cos(i),this._y1=t+n*Math.sin(i)))}},{key:"rect",value:function(e,t,n,r){this._append(rL||(rL=sL(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}},{key:"toString",value:function(){return this._}}]),e}();function pL(e){return e[0]}function vL(e){return e[1]}function gL(e,t){var n=iL(!0),r=null,i=aL,o=null,a=function(e){var t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{var r=Math.floor(n);if(!(r>=0))throw new RangeError("invalid digits: ".concat(n));t=r}return e},function(){return new fL(t)}}(s);function s(s){var l,u,c,d=(s=function(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}(s)).length,h=!1;for(null==r&&(o=i(c=a())),l=0;l<=d;++l)!(l<d&&n(u=s[l],l,s))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+e(u,l,s),+t(u,l,s));if(c)return o=null,c+""||null}return e="function"===typeof e?e:void 0===e?pL:iL(e),t="function"===typeof t?t:void 0===t?vL:iL(t),s.x=function(t){return arguments.length?(e="function"===typeof t?t:iL(+t),s):e},s.y=function(e){return arguments.length?(t="function"===typeof e?e:iL(+e),s):t},s.defined=function(e){return arguments.length?(n="function"===typeof e?e:iL(!!e),s):n},s.curve=function(e){return arguments.length?(i=e,null!=r&&(o=i(r)),s):i},s.context=function(e){return arguments.length?(null==e?r=o=null:o=i(r=e),s):r},s}function mL(e,t,n){this.k=e,this.x=t,this.y=n}fL.prototype,mL.prototype={constructor:mL,scale:function(e){return 1===e?this:new mL(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new mL(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new mL(1,0,0);mL.prototype;var yL=function(e){var t=e.data,n=e.xScale,i=e.yScale,o=gL().x((function(e){return n(e[0])})).y((function(e){return i(e[1])}));return(0,r.jsx)("path",{d:o(t),stroke:"black",fill:"none"})},wL=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"componentDidMount",value:function(){this.renderAxis()}},{key:"componentDidUpdate",value:function(){this.renderAxis()}},{key:"renderAxis",value:function(){var e=this.axis,t=AD().ticks(5).scale(this.props.scale);WI(e).call(t)}},{key:"render",value:function(){var e=this;return(0,r.jsx)("g",{className:"axis",ref:function(t){e.axis=t},transform:this.props.translate})}}]),n}(e.Component),bL=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"componentDidMount",value:function(){var e=Number(jO.getState().numCentroidFactors)+1;e>8&&(e=8),this.renderAxis(e)}},{key:"componentDidUpdate",value:function(){var e=Number(jO.getState().numCentroidFactors)+1;e>8&&(e=8),this.renderAxis(e)}},{key:"renderAxis",value:function(e){var t=this.axis,n=RD().ticks(e).scale(this.props.scale);WI(t).call(n)}},{key:"render",value:function(){var e=this;return(0,r.jsx)("g",{className:"axis",ref:function(t){e.axis=t},transform:this.props.translate})}}]),n}(e.Component),CL=function(e){var t={translate:"translate(0, ".concat(e.height-e.padding,")"),scale:e.xScale,orient:"bottom"},n={translate:"translate(".concat(e.padding,", 0)"),scale:e.yScale,orient:"left"};return(0,r.jsxs)("g",{className:"xy-axis",children:[(0,r.jsx)(bL,d({},t)),(0,r.jsx)(wL,d({},n))]})},SL={fill:"white",stroke:"black",strokeWidth:1.5},EL=function(e){return function(t,n){var i={cx:e.xScale(t[0]),cy:e.yScale(t[1]),r:3.5,key:n};return(0,r.jsx)("circle",d(d({},SL),i))}},kL=function(e){return(0,r.jsx)("g",{children:e.data.map(EL(e))})},xL=function(){return(0,r.jsxs)("g",{children:[(0,r.jsx)("text",{id:"yAxisTitle",fontFamily:"arial",x:-210,y:-7,transform:"rotate(270 90,50)",children:"Eigenvalues"}),(0,r.jsx)("text",{id:"xAxisTitle",fontFamily:"arial",x:300,y:590,children:"Factor Number"})]})},TL={container:{textAlign:"center",width:"80%",height:"82%",display:"flex",alignItems:"left"},svg:{position:"relative"},XYAxis:{marginBottom:40}},RL=function(e){var t=e.numFacs;return t<3?t=3:t>8&&(t=8),t},AL=function(e){var t=function(e,t){var n;if(void 0===t){var r,i=dg(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;null!=o&&(n<o||void 0===n&&o>=o)&&(n=o)}}catch(c){i.e(c)}finally{i.f()}}else{var a,s=-1,l=dg(e);try{for(l.s();!(a=l.n()).done;){var u=a.value;null!=(u=t(u,++s,e))&&(n<u||void 0===n&&u>=u)&&(n=u)}}catch(c){l.e(c)}finally{l.f()}}return n}(e,(function(e){return e[1]}));return t<10&&t>5?t=10:t<5&&(t=5),t},_L=function(e){return VI().domain([0,RL(e)]).range([e.padding,e.width-2*e.padding])},OL=function(e){return VI().domain([0,AL(e.data)]).range([e.height-e.padding,e.padding])},DL=function(e){var t={xScale:_L(e),yScale:OL(e)};return(0,r.jsx)("div",{style:TL.container,children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",id:"screePlot",style:TL.svg,width:e.width+20,height:e.height,children:[(0,r.jsx)(CL,d(d(d({},e),t),TL.XYAxis)),(0,r.jsx)(xL,{}),(0,r.jsx)(yL,d(d({},e),t)),(0,r.jsx)(kL,d(d({},e),t))]})})},NL=function(){var e=new Date,t=e.getDate();t<10&&(t="0"+t);var n=e.getMonth()+1;return n<10&&(n="0"+n),e.getFullYear()+"-"+n+"-"+t},PL=function(){var e=new Date,t=e.getMinutes();t<10&&(t="0"+t);var n=e.getHours();return n<10&&(n="0"+n),String(n)+"-"+String(t)};var FL=function(){try{var e=y.getState().projectName,t=NL(),n=PL(),r="".concat(t,"_").concat(n),i="".concat(e,"-scree_plot_").concat(r);!function(e,t){e.setAttribute("xmlns","http://www.w3.org/2000/svg");var n=e.outerHTML,r=new Blob(['<?xml version="1.0" standalone="no"?>\r\n',n],{type:"image/svg+xml;charset=utf-8"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o)}(document.querySelector("#screePlot"),i)}catch(o){console.log("File Save Error",o.message)}},IL=n(207),LL=function(){var e=y.getState().projectName,t=NL(),n=PL(),r="".concat(t,"_").concat(n),i="".concat(e,"-scree_plot_").concat(r);(0,IL.saveSvgAsPng)(document.getElementById("screePlot"),i,{encoderOptions:1})},ML=function(){return(0,r.jsxs)("div",{className:"flex flex-row space-x-4 mt-8 mr-8 ml-8",children:[(0,r.jsx)(Mv,{handleClick:FL,buttonText:"Download SVG"}),(0,r.jsx)(Mv,{handleClick:LL,buttonText:"Download PNG"})]})},GL={width:800,height:600,padding:80},BL=function(e){var t=jO(),n=t.screePlotData,i=t.numCentroidFactors,o=y().numQsorts,a=parseInt(i,10);o<a&&(a=o),n.length=a;var s=Number(i)+1;return(0,r.jsxs)("div",{className:"border-2 border-gray-400 bg-white p-4 rounded",children:[(0,r.jsx)("h1",{children:"Scree Plot"}),(0,r.jsx)(DL,d(d(d({data:n},e),GL),{},{numFacs:s})),(0,r.jsx)("div",{className:"controls",children:(0,r.jsx)(ML,{})})]})},jL=function(){return jO().showUnrotatedFactorTable?(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)(pD,{}),(0,r.jsx)(fD,{}),(0,r.jsx)(BL,{})]}):null},HL=function(){return Xv().showSection2?(0,r.jsxs)("div",{className:"flex flex-col items-center bg-blue-100 rounded-md p-6",children:[(0,r.jsx)(RO,{}),(0,r.jsxs)("div",{className:"w-full bg-gray-300 p-8 rounded-md",children:[(0,r.jsx)(hD,{}),(0,r.jsx)(jL,{})]})]}):null},VL=function(){return(0,r.jsx)("div",{className:"my-7",children:(0,r.jsx)("a",{href:"https://github.com/shawnbanasick/ken-q-analysis/wiki/4.-FACTOR-ROTATION",target:"_blank",rel:"noopener noreferrer",style:{targetNew:"tab"},children:(0,r.jsx)(V,{buttonColor:"bg-gray-100",buttonText:"Help - Section 4"})})})},WL=function(){return(0,r.jsx)("div",{className:"m-8 w-10/12",children:(0,r.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,r.jsx)("div",{className:"flex flex-row",children:(0,r.jsx)("p",{className:"text-6xl my-4",children:"4. Factor Rotation"})}),(0,r.jsx)(VL,{})]})})},zL=g()((function(e){return{showLoadingsTable:!1,setShowLoadingsTable:function(t){return e((function(e){return d(d({},e),{},{showLoadingsTable:t})}))},bipolarDisabled:!1,setBipolarDisabled:function(t){return e((function(e){return d(d({},e),{},{bipolarDisabled:t})}))},bipolarSplitCount:0,setBipolarSplitCount:function(t){return e((function(e){return d(d({},e),{},{bipolarSplitCount:t})}))},showAutoFlags:!1,setShowAutoFlags:function(t){return e((function(e){return d(d({},e),{},{showAutoFlags:t})}))},highlighting:"grays",setHighlighting:function(t){return e((function(e){return d(d({},e),{},{highlighting:t})}))},fSigCriterion:[],setFSigCriterion:function(t){return e((function(e){return d(d({},e),{},{fSigCriterion:t})}))},requireMajorityCommonVariance:!0,setRequireMajorityCommonVariance:function(t){return e((function(e){return d(d({},e),{},{requireMajorityCommonVariance:t})}))},fSigCriterionResults:[],setFSigCriterionResults:function(t){return e((function(e){return d(d({},e),{},{fSigCriterionResults:t})}))},gridColDefsLoadingsTable:[],setGridColDefsLoadingsTable:function(t){return e((function(e){return d(d({},e),{},{gridColDefsLoadingsTable:t})}))},gridRowDataLoadingsTable:[],setGridRowDataLoadingsTable:function(t){return e((function(e){return d(d({},e),{},{gridRowDataLoadingsTable:t})}))},isLoadingAutoflag:!1,setIsLoadingAutoflag:function(t){return e((function(e){return d(d({},e),{},{isLoadingAutoflag:t})}))},isLoadingGrayHighlighting:!1,setIsLoadingGrayHighlighting:function(t){return e((function(e){return d(d({},e),{},{isLoadingGrayHighlighting:t})}))},isLoadingColorsHighlighting:!1,setIsLoadingColorsHighlighting:function(t){return e((function(e){return d(d({},e),{},{isLoadingColorsHighlighting:t})}))},isLoadingNoHighlighting:!1,setIsLoadingNoHighlighting:function(t){return e((function(e){return d(d({},e),{},{isLoadingNoHighlighting:t})}))},currentLoadingsTable:[],setCurrentLoadingsTable:function(t){return e((function(e){return d(d({},e),{},{currentLoadingsTable:t})}))},showSplitFactorModal:!1,setShowSplitFactorModal:function(t){return e((function(e){return d(d({},e),{},{showSplitFactorModal:t})}))},userSelectedSigLevel:1.96,setUserSelectedSigLevel:function(t){return e((function(e){return d(d({},e),{},{userSelectedSigLevel:t})}))},autoflagHistory:[],setAutoflagHistory:function(t){return e((function(e){return d(d({},e),{},{autoflagHistory:t})}))},showNoLoadingsFlaggedWarningModal:!1,setShowNoLoadingsFlaggedWarningModal:function(t){return e((function(e){return d(d({},e),{},{showNoLoadingsFlaggedWarningModal:t})}))},rowH2:[],setRowH2:function(t){return e((function(e){return d(d({},e),{},{rowH2:t})}))},autoflagButtonColor:"#d6dbe0",setAutoflagButtonColor:function(t){return e((function(e){return d(d({},e),{},{autoflagButtonColor:t})}))},numFacsForTableWidth:0,setNumFacsForTableWidth:function(t){return e((function(e){return d(d({},e),{},{numFacsForTableWidth:t})}))},sendDataToOutputButtonColor:"bg-gray-100",setSendDataToOutputButtonColor:function(t){return e((function(e){return d(d({},e),{},{sendDataToOutputButtonColor:t})}))},temp_gridRowDataLoadingsTable:[],setTemp_gridRowDataLoadingsTable:function(t){return e((function(e){return d(d({},e),{},{temp_gridRowDataLoadingsTable:t})}))},showInvertFactorModal:!1,setShowInvertFactorModal:function(t){return e((function(e){return d(d({},e),{},{showInvertFactorModal:t})}))},isLoadingsTableLoading:!1,setIsLoadingsTableLoading:function(t){return e((function(e){return d(d({},e),{},{isLoadingsTableLoading:t})}))},isLoadingsTableInitialRender:!0,setIsLoadingsTableInitialRender:function(t){return e((function(e){return d(d({},e),{},{isLoadingsTableInitialRender:t})}))},temp_gridColDefsLoadingsTable:[],setTemp_gridColDefsLoadingsTable:function(t){return e((function(e){return d(d({},e),{},{temp_gridColDefsLoadingsTable:t})}))},rowClassRulesLoadingsTable:{},setRowClassRulesLoadingsTable:function(t){return e((function(e){return d(d({},e),{},{rowClassRulesLoadingsTable:t})}))},factorToSplit:0,setFactorToSplit:function(t){return e((function(e){return d(d({},e),{},{factorToSplit:t})}))},bipolarIndexArray:[],setBipolarIndexArray:function(t){return e((function(e){return d(d({},e),{},{bipolarIndexArray:t})}))},showSection6:!1,setShowSection6:function(t){return e((function(e){return d(d({},e),{},{showSection6:t})}))}}})),UL=zL,KL=g()((function(e){return{showOutputFactorSelection:!1,setShowOutputFactorSelection:function(t){return e((function(e){return d(d({},e),{},{showOutputFactorSelection:t})}))},shouldDisplayFactorVizOptions:!1,setShouldDisplayFactorVizOptions:function(t){return e((function(e){return d(d({},e),{},{shouldDisplayFactorVizOptions:t})}))},showFactorCorrelationsTable:!1,setShowFactorCorrelationsTable:function(t){return e((function(e){return d(d({},e),{},{showFactorCorrelationsTable:t})}))},showStandardErrorsDifferences:!1,setShowStandardErrorsDifferences:function(t){return e((function(e){return d(d({},e),{},{showStandardErrorsDifferences:t})}))},showFactorCharacteristicsTable:!1,setShowFactorCharacteristicsTable:function(t){return e((function(e){return d(d({},e),{},{showFactorCharacteristicsTable:t})}))},showDownloadOutputButtons:!1,setShowDownloadOutputButtons:function(t){return e((function(e){return d(d({},e),{},{showDownloadOutputButtons:t})}))},displayFactorVisualizations:!1,setDisplayFactorVisualizations:function(t){return e((function(e){return d(d({},e),{},{displayFactorVisualizations:t})}))},userSelectedFactors:[],setUserSelectedFactors:function(t){return e((function(e){return d(d({},e),{},{userSelectedFactors:t})}))},isActiveNewDownloadButton:!1,setIsActiveNewDownloadButton:function(t){return e((function(e){return d(d({},e),{},{isActiveNewDownloadButton:t})}))},isActiveExcelDownloadButton:!1,setIsActiveExcelDownloadButton:function(t){return e((function(e){return d(d({},e),{},{isActiveExcelDownloadButton:t})}))},isActiveCsvDownloadButton:!1,setIsActiveCsvDownloadButton:function(t){return e((function(e){return d(d({},e),{},{isActiveCsvDownloadButton:t})}))},outputButtonsArray:[],setOutputButtonsArray:function(t){return e((function(e){return d(d({},e),{},{outputButtonsArray:t})}))},shouldIncludeTimestamp:!1,setShouldIncludeTimestamp:function(t){return e((function(e){return d(d({},e),{},{shouldIncludeTimestamp:t})}))},sheetNamesXlsx:[],setSheetNamesXlsx:function(t){return e((function(e){return d(d({},e),{},{sheetNamesXlsx:t})}))},outputData:[],setOutputData:function(t){return e((function(e){return d(d({},e),{},{outputData:t})}))},colSizes:[],setColSizes:function(t){return e((function(e){return d(d({},e),{},{colSizes:t})}))},sigFactorNumbersArray:[],setSigFactorNumbersArray:function(t){return e((function(e){return d(d({},e),{},{sigFactorNumbersArray:t})}))},sortWeights:[],setSortWeights:function(t){return e((function(e){return d(d({},e),{},{sortWeights:t})}))},sigSortsArray:[],setSigSortsArray:function(t){return e((function(e){return d(d({},e),{},{sigSortsArray:t})}))},masterDistingStatementNumbersArray01:[],setMasterDistingStatementNumbersArray01:function(t){return e((function(e){return d(d({},e),{},{masterDistingStatementNumbersArray01:t})}))},masterDistingStatementNumbersArray05:[],setMasterDistingStatementNumbersArray05:function(t){return e((function(e){return d(d({},e),{},{masterDistingStatementNumbersArray05:t})}))},consensus05Statements:[],setConsensus05Statements:function(t){return e((function(e){return d(d({},e),{},{consensus05Statements:t})}))},consensus01Statements:[],setConsensus01Statements:function(t){return e((function(e){return d(d({},e),{},{consensus01Statements:t})}))},analysisOutput:[],setAnalysisOutput:function(t){return e((function(e){return d(d({},e),{},{analysisOutput:t})}))},maxStatementLength:0,setMaxStatementLength:function(t){return e((function(e){return d(d({},e),{},{maxStatementLength:t})}))},standardErrorDiffSheetArray:[],setStandardErrorDiffSheetArray:function(t){return e((function(e){return d(d({},e),{},{standardErrorDiffSheetArray:t})}))},posShiftSortArray:[],setPosShiftSortArray:function(t){return e((function(e){return d(d({},e),{},{posShiftSortArray:t})}))},sortsAsNumbers:[],setSortsAsNumbers:function(t){return e((function(e){return d(d({},e),{},{sortsAsNumbers:t})}))},freeDistributionArray:[],setFreeDistributionArray:function(t){return e((function(e){return d(d({},e),{},{freeDistributionArray:t})}))},sortsFlaggedOnTwoFactors:[],setSortsFlaggedOnTwoFactors:function(t){return e((function(e){return d(d({},e),{},{sortsFlaggedOnTwoFactors:t})}))},showMultipleFactorsFlaggedWarningModal:!1,setShowMultipleFactorsFlaggedWarningModal:function(t){return e((function(e){return d(d({},e),{},{showMultipleFactorsFlaggedWarningModal:t})}))},correlationTableArrayHolder:[],setCorrelationTableArrayHolder:function(t){return e((function(e){return d(d({},e),{},{correlationTableArrayHolder:t})}))},factorCorrelationsTableData:[],setFactorCorrelationsTableData:function(t){return e((function(e){return d(d({},e),{},{factorCorrelationsTableData:t})}))},synFactorArray1Holder:[],setSynFactorArray1Holder:function(t){return e((function(e){return d(d({},e),{},{synFactorArray1Holder:t})}))},statementRankingArray:[],setStatementRankingArray:function(t){return e((function(e){return d(d({},e),{},{statementRankingArray:t})}))},compositeFactorMasterArray:[],setCompositeFactorMasterArray:function(t){return e((function(e){return d(d({},e),{},{compositeFactorMasterArray:t})}))},factorCharacteristicsArray:[],setFactorCharacteristicsArray:function(t){return e((function(e){return d(d({},e),{},{factorCharacteristicsArray:t})}))},formattedConsensusStatements:[],setFormattedConsensusStatements:function(t){return e((function(e){return d(d({},e),{},{formattedConsensusStatements:t})}))},distStatementDataVizArray:[],setDistStatementDataVizArray:function(t){return e((function(e){return d(d({},e),{},{distStatementDataVizArray:t})}))},outputForDataViz:[],setOutputForDataViz:function(t){return e((function(e){return d(d({},e),{},{outputForDataViz:t})}))},sheetNamesHolder1:[],setSheetNamesHolder1:function(t){return e((function(e){return d(d({},e),{},{sheetNamesHolder1:t})}))},sheetNamesHolder2:[],setSheetNamesHolder2:function(t){return e((function(e){return d(d({},e),{},{sheetNamesHolder2:t})}))},sheetNamesHolder3:[],setSheetNamesHolder3:function(t){return e((function(e){return d(d({},e),{},{sheetNamesHolder3:t})}))},factorWeightFactorArrayHolder:[],setFactorWeightFactorArrayHolder:function(t){return e((function(e){return d(d({},e),{},{factorWeightFactorArrayHolder:t})}))},miniCorrelationArrayHolder:[],setMiniCorrelationArrayHolder:function(t){return e((function(e){return d(d({},e),{},{miniCorrelationArrayHolder:t})}))},output:[],setOutput:function(t){return e((function(e){return d(d({},e),{},{output:t})}))},customFileNameLocation:"",setCustomFileNameLocation:function(t){return e((function(e){return d(d({},e),{},{customFileNameLocation:t})}))},consensusIndicator:"",setConsensusIndicator:function(t){return e((function(e){return d(d({},e),{},{consensusIndicator:t})}))},maxColumnHeight:0,setMaxColumnHeight:function(t){return e((function(e){return d(d({},e),{},{maxColumnHeight:t})}))},positionData:{},setPositionData:function(t){return e((function(e){return d(d({},e),{},{positionData:t})}))},willAddCustomNames:!1,setWillAddCustomNames:function(t){return e((function(e){return d(d({},e),{},{willAddCustomNames:t})}))},willAdjustCardFontSize:!1,setWillAdjustCardFontSize:function(t){return e((function(e){return d(d({},e),{},{willAdjustCardFontSize:t})}))},willAdjustCardHeight:!1,setWillAdjustCardHeight:function(t){return e((function(e){return d(d({},e),{},{willAdjustCardHeight:t})}))},willAdjustCardHeightBy:0,setWillAdjustCardHeightBy:function(t){return e((function(e){return d(d({},e),{},{willAdjustCardHeightBy:t})}))},willAdjustCardWidth:!1,setWillAdjustCardWidth:function(t){return e((function(e){return d(d({},e),{},{willAdjustCardWidth:t})}))},willAdjustCardWidthBy:0,setWillAdjustCardWidthBy:function(t){return e((function(e){return d(d({},e),{},{willAdjustCardWidthBy:t})}))},willAdjustDistIndicatorSize:!1,setWillAdjustDistIndicatorSize:function(t){return e((function(e){return d(d({},e),{},{willAdjustDistIndicatorSize:t})}))},willAdjustDistIndicatorSizeBy:0,setWillAdjustDistIndicatorSizeBy:function(t){return e((function(e){return d(d({},e),{},{willAdjustDistIndicatorSizeBy:t})}))},willAdjustStatementWidth:!1,setWillAdjustStatementWidth:function(t){return e((function(e){return d(d({},e),{},{willAdjustStatementWidth:t})}))},willAdjustStatementWidthBy:0,setWillAdjustStatementWidthBy:function(t){return e((function(e){return d(d({},e),{},{willAdjustStatementWidthBy:t})}))},willAdjustCardFontSizeBy:0,setWillAdjustCardFontSizeBy:function(t){return e((function(e){return d(d({},e),{},{willAdjustCardFontSizeBy:t})}))},willAdjustFontSize:!1,setWillAdjustFontSize:function(t){return e((function(e){return d(d({},e),{},{willAdjustFontSize:t})}))},willAdjustLineSpacing:!1,setWillAdjustLineSpacing:function(t){return e((function(e){return d(d({},e),{},{willAdjustLineSpacing:t})}))},willAdjustLineSpacingBy:0,setWillAdjustLineSpacingBy:function(t){return e((function(e){return d(d({},e),{},{willAdjustLineSpacingBy:t})}))},willAdjustWidthAsian:!1,setWillAdjustWidthAsian:function(t){return e((function(e){return d(d({},e),{},{willAdjustWidthAsian:t})}))},willAdjustWidthAsianBy:0,setWillAdjustWidthAsianBy:function(t){return e((function(e){return d(d({},e),{},{willAdjustWidthAsianBy:t})}))},willDisplayConsensusStates:!1,setWillDisplayConsensusStates:function(t){return e((function(e){return d(d({},e),{},{willDisplayConsensusStates:t})}))},willDisplayDistingCompareSymbols:!1,setWillDisplayDistingCompareSymbols:function(t){return e((function(e){return d(d({},e),{},{willDisplayDistingCompareSymbols:t})}))},willDisplayOnlyStateNums:!1,setWillDisplayOnlyStateNums:function(t){return e((function(e){return d(d({},e),{},{willDisplayOnlyStateNums:t})}))},willIncludeLegend:!1,setWillIncludeLegend:function(t){return e((function(e){return d(d({},e),{},{willIncludeLegend:t})}))},willIndicateDistinguishing:!1,setWillIndicateDistinguishing:function(t){return e((function(e){return d(d({},e),{},{willIndicateDistinguishing:t})}))},willPrependStateNums:!1,setWillPrependStateNums:function(t){return e((function(e){return d(d({},e),{},{willPrependStateNums:t})}))},willTrimStatements:!1,setWillTrimStatements:function(t){return e((function(e){return d(d({},e),{},{willTrimStatements:t})}))},willTrimStatementsBy:0,setWillTrimStatementsBy:function(t){return e((function(e){return d(d({},e),{},{willTrimStatementsBy:t})}))},willUseDistingUnicode:!1,setWillUseDistingUnicode:function(t){return e((function(e){return d(d({},e),{},{willUseDistingUnicode:t})}))},customFactorNames:[],setCustomFactorNames:function(t){return e((function(e){return d(d({},e),{},{customFactorNames:t})}))},titleHeight:50,setTitleHeight:function(t){return e((function(e){return d(d({},e),{},{titleHeight:t})}))},willAddCustomNameToDownload:!1,setWillAddCustomNameToDownload:function(t){return e((function(e){return d(d({},e),{},{willAddCustomNameToDownload:t})}))},customDownloadFileNames:[],setCustomDownloadFileNames:function(t){return e((function(e){return d(d({},e),{},{customDownloadFileNames:t})}))},highlightFactor1:!1,setHighlightFactor1:function(t){return e((function(e){return d(d({},e),{},{highlightFactor1:t})}))},highlightFactor2:!1,setHighlightFactor2:function(t){return e((function(e){return d(d({},e),{},{highlightFactor2:t})}))},highlightFactor3:!1,setHighlightFactor3:function(t){return e((function(e){return d(d({},e),{},{highlightFactor3:t})}))},highlightFactor4:!1,setHighlightFactor4:function(t){return e((function(e){return d(d({},e),{},{highlightFactor4:t})}))},highlightFactor5:!1,setHighlightFactor5:function(t){return e((function(e){return d(d({},e),{},{highlightFactor5:t})}))},highlightFactor6:!1,setHighlightFactor6:function(t){return e((function(e){return d(d({},e),{},{highlightFactor6:t})}))},highlightFactor7:!1,setHighlightFactor7:function(t){return e((function(e){return d(d({},e),{},{highlightFactor7:t})}))},highlightFactor8:!1,setHighlightFactor8:function(t){return e((function(e){return d(d({},e),{},{highlightFactor8:t})}))},selectAllClicked:!1,setSelectAllClicked:function(t){return e((function(e){return d(d({},e),{},{selectAllClicked:t})}))},outputFactorSelectButtonsDisabled:!1,setOutputFactorSelectButtonsDisabled:function(t){return e((function(e){return d(d({},e),{},{outputFactorSelectButtonsDisabled:t})}))},isDownloadTypeSelected:!1,setIsDownloadTypeSelected:function(t){return e((function(e){return d(d({},e),{},{isDownloadTypeSelected:t})}))},factorVizOptions:{willAddCustomNames:!1,willAddCustomNameToDownload:!1,willAdjustCardFontSize:!1,willAdjustCardFontSizeBy:13,willAdjustCardHeight:!1,willAdjustCardHeightBy:110,willAdjustCardWidth:!1,willAdjustCardWidthBy:110,willAdjustDistIndicatorSize:!1,willAdjustDistIndicatorSizeBy:12,willAdjustIndicatorSize:!1,willAdjustIndicatorSizeBy:12,willAdjustFontSize:!1,willAdjustFontSizeBy:14,willAdjustLineSpacing:!1,willAdjustLineSpacingBy:1.4,willAdjustStatementWidth:!1,willAdjustStatementWidthBy:15,willAdjustWidthAsian:!1,willAdjustWidthAsianBy:12,willAdjustTopMargin:!1,willAdjustTopMarginBy:5,willDisplayConsensusStates:!1,willDisplayDistingCompareSymbols:!0,willDisplayOnlyStateNums:!1,willIncludeLegend:!0,willIndicateDistinguishing:!0,willPrependStateNums:!1,willTrimStatement:!0,willTrimStatementBy:5,willUseDistingUnicode:!0,showDistinguishingAs:"symbol",consensusIndicator:"#d9effe",distinguishingIndicator05:"#d1d5db",distinguishingIndicator01:"#9ca3af",customFactorNames:[],customFileNameLocation:"append"},setFactorVizOptions:function(t){return e((function(e){return d(d({},e),{},{factorVizOptions:t})}))},showNoLoadingsFlaggedModal:!1,setShowNoLoadingsFlaggedModal:function(t){return e((function(e){return d(d({},e),{},{showNoLoadingsFlaggedModal:t})}))},factorsWithoutLoading:[],setFactorsWithoutLoading:function(t){return e((function(e){return d(d({},e),{},{factorsWithoutLoading:t})}))},matchCount:0,setMatchCount:function(t){return e((function(e){return d(d({},e),{},{matchCount:t})}))},distStateUpperValueText:"P < 0.01",setDistStateUpperValueText:function(t){return e((function(e){return d(d({},e),{},{distStateUpperValueText:t})}))},distStateLowerValueText:"P < 0.05",setDistStateLowerValueText:function(t){return e((function(e){return d(d({},e),{},{distStateLowerValueText:t})}))},factorVizOptionsHolder:{},setFactorVizOptionsHolder:function(t){return e((function(e){return d(d({},e),{},{factorVizOptionsHolder:t})}))},updateFactorVisualizationsButtonColor:"",setUpdateFactorVisualizationsButtonColor:function(t){return e((function(e){return d(d({},e),{},{updateFactorVisualizationsButtonColor:t})}))},showDistinguishingAs:"symbol",setShowDistinguishingAs:function(t){return e((function(e){return d(d({},e),{},{showDistinguishingAs:t})}))},outputForDataViz2:[],setOutputForDataViz2:function(t){return e((function(e){return d(d({},e),{},{outputForDataViz2:t})}))},userSelectedDistStateSigLevel1:2.575,setUserSelectedDistStateSigLevel1:function(t){return e((function(e){return d(d({},e),{},{userSelectedDistStateSigLevel1:t})}))},userSelectedDistStateSigLevel2:1.96,setUserSelectedDistStateSigLevel2:function(t){return e((function(e){return d(d({},e),{},{userSelectedDistStateSigLevel2:t})}))},shouldDisplayFactorViz:!1,setShouldDisplayFactorViz:function(t){return e((function(e){return d(d({},e),{},{shouldDisplayFactorViz:t})}))}}})),qL=KL,XL=function(){var t=jO(),n=t.activeCentroidFactorsButton,i=t.numCentroidFactors,o=t.numberofPrincipalComps,a=MO(),s=a.setShouldDisplayFacKept,l=a.setNumFactorsKeptForRot,u=a.setShouldShowJudgeRotDiv,c=a.setJudgeButtonActive,d=a.setShowScatterPlotTableDiv,h=a.setAbFactors,f=a.setUserSelectedRotFactors,p=a.setVarimaxButtonDisabled,v=a.setVarimaxButtonText,g=a.setVarimaxButtonActive,m=UL(),y=m.setShowLoadingsTable,w=m.setBipolarDisabled,b=m.setBipolarSplitCount,C=qL(),S=C.setShowOutputFactorSelection,E=C.setShouldDisplayFactorVizOptions,k=C.setShowFactorCorrelationsTable,x=C.setShowStandardErrorsDifferences,T=C.setShowFactorCharacteristicsTable,R=C.setShowDownloadOutputButtons,A=C.setDisplayFactorVisualizations,_=C.setUserSelectedFactors,O=Y((0,e.useState)([]),2),D=O[0],N=O[1];return(0,e.useEffect)((function(){var e=[1,2,3,4,5,6,7,8];e.length=n?+i:+o;var t=e.map((function(e){return(0,r.jsx)("option",{value:e,children:e},e.toString())}));t.unshift((0,r.jsx)("option",{className:"text-right",value:"default",children:"?"},0)),N(t)}),[n,i,o]),(0,r.jsxs)("div",{className:"flex flex-row items-center",children:[(0,r.jsx)("span",{className:"text-2xl",children:"How many factors to keep for rotation?"}),(0,r.jsx)("select",{className:"select select-bordered rounded-md max-w-xs ml-2 mr-2 text-xl hover:bg-gray-400 h-[30px] border border-gray-400",onChange:function(e){var t=e.target.value;l(+t),s(!1),y(!1),S(!1),E(!1),k(!1),x(!1),T(!1),R(!1),A(!1),_([]),w(!1),b(0),u(!1),c(!1),d(!1),h([]),f([]),p(!1),v("Varimax Rotation"),g(!1)},children:D})]})},YL=function(){var e=MO(),t=e.numFactorsKeptForRot;return e.shouldDisplayFacKept?(0,r.jsxs)("p",{className:"mt-8 text-2xl mb-8",children:[t," factors kept for rotation."]}):null};function QL(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function ZL(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=ZL(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}var JL=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=ZL(e))&&(r&&(r+=" "),r+=t);return r},$L=["theme","type"],eM=["delay","staleId"],tM=function(e){return"number"==typeof e&&!isNaN(e)},nM=function(e){return"string"==typeof e},rM=function(e){return"function"==typeof e},iM=function(e){return nM(e)||rM(e)?e:null},oM=function(t){return(0,e.isValidElement)(t)||nM(t)||rM(t)||tM(t)};function aM(t){var n=t.enter,r=t.exit,i=t.appendPosition,o=void 0!==i&&i,a=t.collapse,s=void 0===a||a,l=t.collapseDuration,u=void 0===l?300:l;return function(t){var i=t.children,a=t.position,l=t.preventExitTransition,c=t.done,d=t.nodeRef,h=t.isIn,f=o?"".concat(n,"--").concat(a):n,p=o?"".concat(r,"--").concat(a):r,v=(0,e.useRef)(0);return(0,e.useLayoutEffect)((function(){var e,t=d.current,n=f.split(" "),r=function e(r){var i;r.target===d.current&&(t.dispatchEvent(new Event("d")),t.removeEventListener("animationend",e),t.removeEventListener("animationcancel",e),0===v.current&&"animationcancel"!==r.type&&(i=t.classList).remove.apply(i,wt(n)))};(e=t.classList).add.apply(e,wt(n)),t.addEventListener("animationend",r),t.addEventListener("animationcancel",r)}),[]),(0,e.useEffect)((function(){var e=d.current,t=function t(){e.removeEventListener("animationend",t),s?function(e,t,n){void 0===n&&(n=300);var r=e.scrollHeight,i=e.style;requestAnimationFrame((function(){i.minHeight="initial",i.height=r+"px",i.transition="all ".concat(n,"ms"),requestAnimationFrame((function(){i.height="0",i.padding="0",i.margin="0",setTimeout(t,n)}))}))}(e,c,u):c()};h||(l?t():(v.current=1,e.className+=" ".concat(p),e.addEventListener("animationend",t)))}),[h]),e.createElement(e.Fragment,null,i)}}function sM(e,t){return null!=e?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:t}:{}}var lM={list:new Map,emitQueue:new Map,on:function(e,t){return this.list.has(e)||this.list.set(e,[]),this.list.get(e).push(t),this},off:function(e,t){if(t){var n=this.list.get(e).filter((function(e){return e!==t}));return this.list.set(e,n),this}return this.list.delete(e),this},cancelEmit:function(e){var t=this.emitQueue.get(e);return t&&(t.forEach(clearTimeout),this.emitQueue.delete(e)),this},emit:function(e){var t=arguments,n=this;this.list.has(e)&&this.list.get(e).forEach((function(r){var i=setTimeout((function(){r.apply(void 0,wt([].slice.call(t,1)))}),0);n.emitQueue.has(e)||n.emitQueue.set(e,[]),n.emitQueue.get(e).push(i)}))}},uM=function(t){var n=t.theme,r=t.type,i=QL(t,$L);return e.createElement("svg",d({viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===n?"currentColor":"var(--toastify-icon-color-".concat(r,")")},i))},cM={info:function(t){return e.createElement(uM,d({},t),e.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(t){return e.createElement(uM,d({},t),e.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(t){return e.createElement(uM,d({},t),e.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(t){return e.createElement(uM,d({},t),e.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return e.createElement("div",{className:"Toastify__spinner"})}};function dM(t){var n=(0,e.useReducer)((function(e){return e+1}),0),r=Y(n,2)[1],i=Y((0,e.useState)([]),2),o=i[0],a=i[1],s=(0,e.useRef)(null),l=(0,e.useRef)(new Map).current,u=function(e){return-1!==o.indexOf(e)},c=(0,e.useRef)({toastKey:1,displayedToast:0,count:0,queue:[],props:t,containerId:null,isToastActive:u,getToast:function(e){return l.get(e)}}).current;function h(e){var t=e.containerId;!c.props.limit||t&&c.containerId!==t||(c.count-=c.queue.length,c.queue=[])}function f(e){a((function(t){return null==e?[]:t.filter((function(t){return t!==e}))}))}function p(){var e=c.queue.shift();g(e.toastContent,e.toastProps,e.staleId)}function v(t,n){var i=n.delay,o=n.staleId,a=QL(n,eM);if(oM(t)&&!function(e){return!s.current||c.props.enableMultiContainer&&e.containerId!==c.props.containerId||l.has(e.toastId)&&null==e.updateId}(a)){var u=a.toastId,h=a.updateId,v=a.data,m=c.props,y=function(){return f(u)},w=null==h;w&&c.count++;var b,C,S=d(d(d({},m),{},{style:m.toastStyle,key:c.toastKey++},Object.fromEntries(Object.entries(a).filter((function(e){var t=Y(e,2);t[0];return null!=t[1]})))),{},{toastId:u,updateId:h,data:v,closeToast:y,isIn:!1,className:iM(a.className||m.toastClassName),bodyClassName:iM(a.bodyClassName||m.bodyClassName),progressClassName:iM(a.progressClassName||m.progressClassName),autoClose:!a.isLoading&&(b=a.autoClose,C=m.autoClose,!1===b||tM(b)&&b>0?b:C),deleteToast:function(){var e=sM(l.get(u),"removed");l.delete(u),lM.emit(4,e);var t=c.queue.length;if(c.count=null==u?c.count-c.displayedToast:c.count-1,c.count<0&&(c.count=0),t>0){var n=null==u?c.props.limit:1;if(1===t||1===n)c.displayedToast++,p();else{var i=n>t?t:n;c.displayedToast=i;for(var o=0;o<i;o++)p()}}else r()}});S.iconOut=function(t){var n=t.theme,r=t.type,i=t.isLoading,o=t.icon,a=null,s={theme:n,type:r};return!1===o||(rM(o)?a=o(s):(0,e.isValidElement)(o)?a=(0,e.cloneElement)(o,s):nM(o)||tM(o)?a=o:i?a=cM.spinner():function(e){return e in cM}(r)&&(a=cM[r](s))),a}(S),rM(a.onOpen)&&(S.onOpen=a.onOpen),rM(a.onClose)&&(S.onClose=a.onClose),S.closeButton=m.closeButton,!1===a.closeButton||oM(a.closeButton)?S.closeButton=a.closeButton:!0===a.closeButton&&(S.closeButton=!oM(m.closeButton)||m.closeButton);var E=t;(0,e.isValidElement)(t)&&!nM(t.type)?E=(0,e.cloneElement)(t,{closeToast:y,toastProps:S,data:v}):rM(t)&&(E=t({closeToast:y,toastProps:S,data:v})),m.limit&&m.limit>0&&c.count>m.limit&&w?c.queue.push({toastContent:E,toastProps:S,staleId:o}):tM(i)?setTimeout((function(){g(E,S,o)}),i):g(E,S,o)}}function g(e,t,n){var r=t.toastId;n&&l.delete(n);var i={content:e,props:t};l.set(r,i),a((function(e){return[].concat(wt(e),[r]).filter((function(e){return e!==n}))})),lM.emit(4,sM(i,null==i.props.updateId?"added":"updated"))}return(0,e.useEffect)((function(){return c.containerId=t.containerId,lM.cancelEmit(3).on(0,v).on(1,(function(e){return s.current&&f(e)})).on(5,h).emit(2,c),function(){l.clear(),lM.emit(3,c)}}),[]),(0,e.useEffect)((function(){c.props=t,c.isToastActive=u,c.displayedToast=o.length})),{getToastToRender:function(e){var n=new Map,r=Array.from(l.values());return t.newestOnTop&&r.reverse(),r.forEach((function(e){var t=e.props.position;n.has(t)||n.set(t,[]),n.get(t).push(e)})),Array.from(n,(function(t){return e(t[0],t[1])}))},containerRef:s,isToastActive:u}}function hM(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientX:e.clientX}function fM(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientY:e.clientY}function pM(t){var n=Y((0,e.useState)(!1),2),r=n[0],i=n[1],o=Y((0,e.useState)(!1),2),a=o[0],s=o[1],l=(0,e.useRef)(null),u=(0,e.useRef)({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,c=(0,e.useRef)(t),d=t.autoClose,h=t.pauseOnHover,f=t.closeToast,p=t.onClick,v=t.closeOnClick;function g(e){if(t.draggable){"touchstart"===e.nativeEvent.type&&e.nativeEvent.preventDefault(),u.didMove=!1,document.addEventListener("mousemove",b),document.addEventListener("mouseup",C),document.addEventListener("touchmove",b),document.addEventListener("touchend",C);var n=l.current;u.canCloseOnClick=!0,u.canDrag=!0,u.boundingRect=n.getBoundingClientRect(),n.style.transition="",u.x=hM(e.nativeEvent),u.y=fM(e.nativeEvent),"x"===t.draggableDirection?(u.start=u.x,u.removalDistance=n.offsetWidth*(t.draggablePercent/100)):(u.start=u.y,u.removalDistance=n.offsetHeight*(80===t.draggablePercent?1.5*t.draggablePercent:t.draggablePercent/100))}}function m(e){if(u.boundingRect){var n=u.boundingRect,r=n.top,i=n.bottom,o=n.left,a=n.right;"touchend"!==e.nativeEvent.type&&t.pauseOnHover&&u.x>=o&&u.x<=a&&u.y>=r&&u.y<=i?w():y()}}function y(){i(!0)}function w(){i(!1)}function b(e){var n=l.current;u.canDrag&&n&&(u.didMove=!0,r&&w(),u.x=hM(e),u.y=fM(e),u.delta="x"===t.draggableDirection?u.x-u.start:u.y-u.start,u.start!==u.x&&(u.canCloseOnClick=!1),n.style.transform="translate".concat(t.draggableDirection,"(").concat(u.delta,"px)"),n.style.opacity=""+(1-Math.abs(u.delta/u.removalDistance)))}function C(){document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",C),document.removeEventListener("touchmove",b),document.removeEventListener("touchend",C);var e=l.current;if(u.canDrag&&u.didMove&&e){if(u.canDrag=!1,Math.abs(u.delta)>u.removalDistance)return s(!0),void t.closeToast();e.style.transition="transform 0.2s, opacity 0.2s",e.style.transform="translate".concat(t.draggableDirection,"(0)"),e.style.opacity="1"}}(0,e.useEffect)((function(){c.current=t})),(0,e.useEffect)((function(){return l.current&&l.current.addEventListener("d",y,{once:!0}),rM(t.onOpen)&&t.onOpen((0,e.isValidElement)(t.children)&&t.children.props),function(){var t=c.current;rM(t.onClose)&&t.onClose((0,e.isValidElement)(t.children)&&t.children.props)}}),[]),(0,e.useEffect)((function(){return t.pauseOnFocusLoss&&(document.hasFocus()||w(),window.addEventListener("focus",y),window.addEventListener("blur",w)),function(){t.pauseOnFocusLoss&&(window.removeEventListener("focus",y),window.removeEventListener("blur",w))}}),[t.pauseOnFocusLoss]);var S={onMouseDown:g,onTouchStart:g,onMouseUp:m,onTouchEnd:m};return d&&h&&(S.onMouseEnter=w,S.onMouseLeave=y),v&&(S.onClick=function(e){p&&p(e),u.canCloseOnClick&&f()}),{playToast:y,pauseToast:w,isRunning:r,preventExitTransition:a,toastRef:l,eventHandlers:S}}function vM(t){var n=t.closeToast,r=t.theme,i=t.ariaLabel,o=void 0===i?"close":i;return e.createElement("button",{className:"Toastify__close-button Toastify__close-button--".concat(r),type:"button",onClick:function(e){e.stopPropagation(),n(e)},"aria-label":o},e.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},e.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function gM(t){var n=t.delay,r=t.isRunning,i=t.closeToast,o=t.type,a=void 0===o?"default":o,s=t.hide,l=t.className,c=t.style,h=t.controlledProgress,f=t.progress,p=t.rtl,v=t.isIn,g=t.theme,m=s||h&&0===f,y=d(d({},c),{},{animationDuration:"".concat(n,"ms"),animationPlayState:r?"running":"paused",opacity:m?0:1});h&&(y.transform="scaleX(".concat(f,")"));var w=JL("Toastify__progress-bar",h?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated","Toastify__progress-bar-theme--".concat(g),"Toastify__progress-bar--".concat(a),{"Toastify__progress-bar--rtl":p}),b=rM(l)?l({rtl:p,type:a,defaultClassName:w}):JL(w,l);return e.createElement("div",u({role:"progressbar","aria-hidden":m?"true":"false","aria-label":"notification timer",className:b,style:y},h&&f>=1?"onTransitionEnd":"onAnimationEnd",h&&f<1?null:function(){v&&i()}))}var mM=function(t){var n=pM(t),r=n.isRunning,i=n.preventExitTransition,o=n.toastRef,a=n.eventHandlers,s=t.closeButton,l=t.children,u=t.autoClose,c=t.onClick,h=t.type,f=t.hideProgressBar,p=t.closeToast,v=t.transition,g=t.position,m=t.className,y=t.style,w=t.bodyClassName,b=t.bodyStyle,C=t.progressClassName,S=t.progressStyle,E=t.updateId,k=t.role,x=t.progress,T=t.rtl,R=t.toastId,A=t.deleteToast,_=t.isIn,O=t.isLoading,D=t.iconOut,N=t.closeOnClick,P=t.theme,F=JL("Toastify__toast","Toastify__toast-theme--".concat(P),"Toastify__toast--".concat(h),{"Toastify__toast--rtl":T},{"Toastify__toast--close-on-click":N}),I=rM(m)?m({rtl:T,position:g,type:h,defaultClassName:F}):JL(F,m),L=!!x||!u,M={closeToast:p,type:h,theme:P},G=null;return!1===s||(G=rM(s)?s(M):(0,e.isValidElement)(s)?(0,e.cloneElement)(s,M):vM(M)),e.createElement(v,{isIn:_,done:A,position:g,preventExitTransition:i,nodeRef:o},e.createElement("div",d(d({id:R,onClick:c,className:I},a),{},{style:y,ref:o}),e.createElement("div",d(d({},_&&{role:k}),{},{className:rM(w)?w({type:h}):JL("Toastify__toast-body",w),style:b}),null!=D&&e.createElement("div",{className:JL("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!O})},D),e.createElement("div",null,l)),G,e.createElement(gM,d(d({},E&&!L?{key:"pb-".concat(E)}:{}),{},{rtl:T,theme:P,delay:u,isRunning:r,isIn:_,closeToast:p,hide:f,type:h,style:S,className:C,controlledProgress:L,progress:x||0}))))},yM=function(e,t){return void 0===t&&(t=!1),{enter:"Toastify--animate Toastify__".concat(e,"-enter"),exit:"Toastify--animate Toastify__".concat(e,"-exit"),appendPosition:t}},wM=aM(yM("bounce",!0)),bM=(aM(yM("slide",!0)),aM(yM("zoom"))),CM=(aM(yM("flip")),(0,e.forwardRef)((function(t,n){var r=dM(t),i=r.getToastToRender,o=r.containerRef,a=r.isToastActive,s=t.className,l=t.style,u=t.rtl,c=t.containerId;function h(e){var t=JL("Toastify__toast-container","Toastify__toast-container--".concat(e),{"Toastify__toast-container--rtl":u});return rM(s)?s({position:e,rtl:u,defaultClassName:t}):JL(t,iM(s))}return(0,e.useEffect)((function(){n&&(n.current=o.current)}),[]),e.createElement("div",{ref:o,className:"Toastify",id:c},i((function(t,n){var r=n.length?d({},l):d(d({},l),{},{pointerEvents:"none"});return e.createElement("div",{className:h(t),style:r,key:"container-".concat(t)},n.map((function(t,r){var i=t.content,o=t.props;return e.createElement(mM,d(d({},o),{},{isIn:a(o.toastId),style:d(d({},o.style),{},{"--nth":r+1,"--len":n.length}),key:"toast-".concat(o.key)}),i)})))})))})));CM.displayName="ToastContainer",CM.defaultProps={position:"top-right",transition:wM,autoClose:5e3,closeButton:vM,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};var SM,EM=new Map,kM=[],xM=1;function TM(){return""+xM++}function RM(e){return e&&(nM(e.toastId)||tM(e.toastId))?e.toastId:TM()}function AM(e,t){return EM.size>0?lM.emit(0,e,t):kM.push({content:e,options:t}),t.toastId}function _M(e,t){return d(d({},t),{},{type:t&&t.type||e,toastId:RM(t)})}function OM(e){return function(t,n){return AM(t,_M(e,n))}}function DM(e,t){return AM(e,_M("default",t))}DM.loading=function(e,t){return AM(e,_M("default",d({isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1},t)))},DM.promise=function(e,t,n){var r,i=t.pending,o=t.error,a=t.success;i&&(r=nM(i)?DM.loading(i,n):DM.loading(i.render,d(d({},n),i)));var s={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=function(e,t,i){if(null!=t){var o=d(d(d({type:e},s),n),{},{data:i}),a=nM(t)?{render:t}:t;return r?DM.update(r,d(d({},o),a)):DM(a.render,d(d({},o),a)),i}DM.dismiss(r)},u=rM(e)?e():e;return u.then((function(e){return l("success",a,e)})).catch((function(e){return l("error",o,e)})),u},DM.success=OM("success"),DM.info=OM("info"),DM.error=OM("error"),DM.warning=OM("warning"),DM.warn=DM.warning,DM.dark=function(e,t){return AM(e,_M("default",d({theme:"dark"},t)))},DM.dismiss=function(e){EM.size>0?lM.emit(1,e):kM=kM.filter((function(t){return null!=e&&t.options.toastId!==e}))},DM.clearWaitingQueue=function(e){return void 0===e&&(e={}),lM.emit(5,e)},DM.isActive=function(e){var t=!1;return EM.forEach((function(n){n.isToastActive&&n.isToastActive(e)&&(t=!0)})),t},DM.update=function(e,t){void 0===t&&(t={}),setTimeout((function(){var n=function(e,t){var n=t.containerId,r=EM.get(n||SM);return r&&r.getToast(e)}(e,t);if(n){var r=n.props,i=n.content,o=d(d(d({delay:100},r),t),{},{toastId:t.toastId||e,updateId:TM()});o.toastId!==e&&(o.staleId=e);var a=o.render||i;delete o.render,AM(a,o)}}),0)},DM.done=function(e){DM.update(e,{progress:1})},DM.onChange=function(e){return lM.on(4,e),function(){lM.off(4,e)}},DM.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},DM.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},lM.on(2,(function(e){SM=e.containerId||e,EM.set(SM,e),kM.forEach((function(e){lM.emit(0,e.content,e.options)})),kM=[]})).on(3,(function(e){EM.delete(e.containerId||e),0===EM.size&&lM.off(0).off(1).off(5)}));var NM=function(){var e=vt()(MO.getState().d3RotChartData);MO.setState({newRotationVectors:e})},PM=function(e){for(var t,n,r,i=vt()(MO.getState().abFactors),o=Math.min.apply(Math,wt(i)),a=Math.max.apply(Math,wt(i)),s=vt()(y.getState().respondentNames),l=vt()(MO.getState().fSigCriterionResults),u=vt()(e),c=[],d=u.length,h=0;h<d;h+=1)t=u[h],n=l[h],r={num:h+1,respondent:s[h],factor1:t[o-1],factor1Sig:n[o-1],factor2:t[a-1],factor2Sig:n[a-1]},c.push(r);var f=[],p="Factor ".concat(o),v="Factor ".concat(a);return f.push("",p,v),[].unshift(f),c},FM=function(e,t){for(var n=vt()(MO.getState().abFactors),r=Math.min.apply(Math,wt(n)),i=Math.max.apply(Math,wt(n)),o="Fac. ".concat(r),a="Fac. ".concat(i),s="Chg. ".concat(r),l="Chg. ".concat(i),u=[{headerName:"N.",field:"resNum",pinned:!0,editable:!1,sortable:!0,width:50,cellStyle:{textAlign:"center"}},{headerName:"Part.",field:"respondent",pinned:!0,editable:!1,sortable:!0,width:Xv.getState().firstColMaxWidth,cellStyle:{textAlign:"center"}},{headerName:o,field:"factor1",pinned:!1,sortable:!0,editable:!1,width:85,cellStyle:function(e){return e.node.data.factor1Sig?{textAlign:"center",background:"#b4dffe"}:{textAlign:"center"}}},{headerName:s,field:"change1",pinned:!1,sortable:!0,editable:!1,width:80,cellStyle:{textAlign:"center"}},{headerName:a,field:"factor2",pinned:!1,sortable:!0,editable:!1,width:85,cellStyle:function(e){return e.node.data.factor2Sig?{textAlign:"center",background:"#ffe4b2"}:{textAlign:"center"}}},{headerName:l,field:"change2",pinned:!1,sortable:!0,editable:!1,width:80,cellStyle:{textAlign:"center"}},{headerName:"factor1Sig",field:"factor1Sig",pinned:!1,sortable:!0,editable:!1,hide:!0,width:0},{headerName:"factor2Sig",field:"change2",pinned:!1,sortable:!0,editable:!1,hide:!0,width:0}],c=[],d=0;d<e.length;d+=1){var h={},f=t[d][r-1],p=t[d][i-1],v=e[d].factor1,g=e[d].factor2,m=e[d].factor1Sig,y=e[d].factor2Sig,w=Zv(v-f,4),b=Zv(g-p,4);h.resNum=e[d].num,h.respondent=e[d].respondent,h.factor1=Zv(v,4),h.change1=w,h.factor1Sig=m,h.factor2=Zv(g,4),h.change2=b,h.factor2Sig=y,c.push(h)}MO.setState({rotColDefsFactorTable:u,rotRowDataFactorTable:c})},IM=n(4617),LM=n.n(IM),MM=function(e){var t=UL.getState().userSelectedSigLevel;return Zv(t*(1/Math.sqrt(e)),5)},GM=function(e,t,n,r){var i=UL.getState().requireMajorityCommonVariance;if("flag"===e){if(isNaN(t))return n>r;var o=Zv(t*t,5);return i?n>r&&n>o:n>o}return!1},BM=function(e){var t,n,r,i,o,a,s,l,u=vt()(MO.getState().fSigCriterion),c=y.getState().numStatements,d=MM(c),h=u.length,f=u[0].length,p=[];for(o=0;o<h;o++){for(t=u[o],s=[],a=0;a<f;a++){i=vt()(t),f>1?(n=LM()(i,a),r=i.reduce((function(e,t){return e+t})),l=Zv(r,5)):(n=i,l=0);var v=GM(e,d,n[0],l);s.push(v)}p.push(s)}return MO.setState({fSigCriterionResults:p}),p},jM=function(){var e=vt()(MO.getState().tempRotFacStateArray),t=GO(e);BM("flag");var n=PM(t);MO.setState({d3RotChartData:n}),NM()},HM=function(t){var n=MO(),i=n.abFactors,o=n.userSelectedRotFactors,a=Y((0,e.useState)({factor0:"bg-gray-100",factor1:"bg-gray-100",factor2:"bg-gray-100",factor3:"bg-gray-100",factor4:"bg-gray-100",factor5:"bg-gray-100",factor6:"bg-gray-100",factor7:"bg-gray-100",factor8:"bg-gray-100"}),2),s=a[0],l=a[1],u={factor0:"bg-gray-100",factor1:"bg-gray-100",factor2:"bg-gray-100",factor3:"bg-gray-100",factor4:"bg-gray-100",factor5:"bg-gray-100",factor6:"bg-gray-100",factor7:"bg-gray-100",factor8:"bg-gray-100"},c=MO(),d=c.shouldDisplayRotFactorButtons,h=c.numFactorsKeptForRot,f=c.showRotFactorSelectWarning,p=c.shouldClearRotButHigh,v=c.setShowRotFactorSelectWarning,g=c.setShowScatterPlotTableDiv,m=c.setRotationDegrees,y=c.setAbFactors,w=c.setUserSelectedRotFactors,b=c.setD3RotChartData,S=c.setTempRotFacStateArray,E=c.setShouldClearRotButHigh,k=jO().factorMatrix,x=function(){l(u),m(0),w([]),y([]),g(!1),E(!1)};(0,e.useEffect)((function(){p&&x()}),[p]);for(var T=function(e){var n=e.target.id;if(n=n.split(" ").join(""),o=vt()(o),i=vt()(i),o.length<2&&!yp()(o,n)){o.push(n),s[n]="bg-green-300",l(s);var r=n.substr(n.length-1);i.push(parseInt(r,10)),i.sort((function(e,t){return e-t})),w(o),y(i)}if(2===o.length){var a=vt()(k),u=ip(a),c=GO(u);BM("flag");var d=PM(c);b(d),S(u),FM(d,t.baselineData),NM(),jM()}},R=h,A=[],_=0;_<8;_++)_<R?A.push(!0):A.push(!1);var O=A[0],D=A[1],N=A[2],P=A[3],F=A[4],I=A[5],L=A[6],M=A[7];return d?(0,r.jsxs)("div",{className:"flex align-center",children:[O&&(0,r.jsx)(C,{otherFormatting:"m-1",buttonId:"factor 1",handleClick:T,buttonText:"1",buttonColor:s.factor1}),D&&(0,r.jsx)(C,{buttonId:"factor 2",otherFormatting:"m-1",handleClick:T,buttonText:"2",buttonColor:s.factor2}),N&&(0,r.jsx)(C,{buttonId:"factor 3",otherFormatting:"m-1",handleClick:T,buttonText:"3",buttonColor:s.factor3}),P&&(0,r.jsx)(C,{buttonId:"factor 4",otherFormatting:"m-1",handleClick:T,buttonText:"4",buttonColor:s.factor4}),F&&(0,r.jsx)(C,{buttonId:"factor 5",otherFormatting:"m-1",handleClick:T,buttonText:"5",buttonColor:s.factor5}),I&&(0,r.jsx)(C,{buttonId:"factor 6",otherFormatting:"m-1",handleClick:T,buttonText:"6",buttonColor:s.factor6}),L&&(0,r.jsx)(C,{buttonId:"factor 7",otherFormatting:"m-1",handleClick:T,buttonText:"7",buttonColor:s.factor7}),M&&(0,r.jsx)(C,{buttonId:"factor 8",otherFormatting:"m-1",handleClick:T,buttonText:"8",buttonColor:s.factor8}),(0,r.jsx)(C,{otherFormatting:"m-1",buttonColor:"bg-gray-100",buttonText:"Clear",handleClick:x}),(0,r.jsx)(C,{otherFormatting:"m-1",buttonColor:"bg-gray-100",buttonText:"Display",handleClick:function(){(o=vt()(o)).length<2?v(!0):(v(!1),g(!0))}}),f&&(0,r.jsx)("div",{className:"btn rounded-md mt-[5px] bg-red-400 w-[200px]",children:(0,r.jsx)("button",{className:"text-xl text-center text-white w-[150px] h-[35px] ",children:"Select 2 factors"})})]}):null},VM=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"componentDidMount",value:function(){this.renderAxis()}},{key:"componentDidUpdate",value:function(){this.renderAxis()}},{key:"renderAxis",value:function(){var e=-(this.props.width-2*this.props.padding),t=this.axis,n=AD().ticks(2).tickSize(e).scale(this.props.scale);WI(t).call(n).style("font-size","15px")}},{key:"render",value:function(){var e=this;return(0,r.jsx)("g",{className:"axis",ref:function(t){e.axis=t},transform:this.props.translate})}}]),n}(e.Component),WM=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"componentDidMount",value:function(){this.renderAxis()}},{key:"componentDidUpdate",value:function(){this.renderAxis()}},{key:"renderAxis",value:function(){var e=-(this.props.height-2*this.props.padding),t=this.axis,n=RD().ticks(2).tickSize(e).scale(this.props.scale);WI(t).call(n).style("font-size","15px")}},{key:"render",value:function(){var e=this;return(0,r.jsx)("g",{className:"axis",ref:function(t){e.axis=t},transform:this.props.translate})}}]),n}(e.Component),zM=function(e){var t={translate:"translate(0, ".concat(e.height-e.padding,")"),scale:e.xScale,orient:"bottom",height:e.height,width:e.width,padding:e.padding},n={translate:"translate(".concat(e.padding,", 0)"),scale:e.yScale,orient:"left",height:e.height,width:e.width,padding:e.padding};return(0,r.jsxs)("g",{className:"xy-axis",children:[(0,r.jsx)(WM,d({},t)),(0,r.jsx)(VM,d({},n))]})},UM={stroke:"black",strokeWidth:.5,fontSize:10,cursor:"default"},KM=function(e){return function(t,n){var i={x:e.xScale(e.data[n].factor2),y:e.yScale(e.data[n].factor1-.01),key:e.data[n].num,text:e.data[n].num,textAnchor:"middle"};return(0,r.jsxs)("text",d(d(d({onMouseOver:function(){return t=e.data[n],void MO.setState({participantDataObject:t});var t},onMouseOut:function(){MO.setState({participantDataObject:{respondent:"doNotDisplay"}})}},UM),i),{},{children:[" ",i.text]}))}},qM=function(e){return(0,r.jsx)("g",{children:e.data.map(KM(e))})},XM={stroke:"black",strokeWidth:.5},YM=function(e){return!0===e.factor1Sig?"#b4dffe":!0===e.factor2Sig?"#ffe4b2":"#d3d3d3"},QM=function(e){return function(t,n){var i={cx:e.xScale(e.data[n].factor2),cy:e.yScale(e.data[n].factor1),r:9,key:e.data[n].num,fill:YM(e.data[n]),text:e.data[n].num};return(0,r.jsx)("circle",d(d({onMouseOver:function(){return t=e.data[n],void MO.setState({participantDataObject:t});var t},onMouseOut:function(){MO.setState({participantDataObject:{respondent:"doNotDisplay"}})}},XM),i))}},ZM=function(e){return(0,r.jsx)("g",{children:e.data.map(QM(e))})},JM={yAxis:{position:"absolute",color:"red",backgroundColor:"red"},xAxis:{position:"absolute",color:"black"}},$M=function(e){O(n,e);var t=F(n);function n(){return T(this,n),t.apply(this,arguments)}return A(n,[{key:"render",value:function(){var e=this.props.width-this.props.padding,t=vt()(MO.getState().abFactors),n="Factor ".concat(t[0]),i="Factor ".concat(t[1]);return(0,r.jsxs)("g",{children:[(0,r.jsx)("text",{x:-(this.props.height-this.props.padding)/2-45,y:this.props.padding-18,transform:"rotate(-90)",children:n}),(0,r.jsx)("text",{x:e/2-10,y:e+45,style:JM.xAxis,children:i})]})}}]),n}(e.Component),eG=$M,tG={container:{textAlign:"center",width:"auto",height:"auto",paddingLeft:5},svg:{position:"relative"},XYAxis:{marginBottom:20}},nG=function(e){return VI().domain([-1,1]).range([e.padding,e.width-e.padding])},rG=function(e){return VI().domain([-1,1]).range([e.height-e.padding,e.padding])},iG=function(e){var t={xScale:nG(e),yScale:rG(e)};return(0,r.jsx)("div",{style:tG.container,children:(0,r.jsxs)("svg",{id:"screePlot",style:tG.svg,width:e.width-5,height:e.height+20,children:[(0,r.jsx)(zM,d(d(d({},e),t),tG.XYAxis)),(0,r.jsx)(eG,d({},e)),(0,r.jsxs)("g",{children:[(0,r.jsx)(ZM,d(d({},e),t)),(0,r.jsx)(qM,d(d({},e),t))]})]})})},oG=function(){var e,t,n,i=MO().participantDataObject;return e=i.respondent,t=i.factor1,n=i.factor2,"doNotDisplay"===i.respondent?(0,r.jsx)("div",{className:"flex flex-row bg-gray-300",children:"Hover over circle to view participant data"}):(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"flex flex-row bg-gray-300",children:[(0,r.jsx)("div",{className:"mr-2",children:e}),(0,r.jsxs)("div",{className:"mr-2",children:[t,","]}),(0,r.jsx)("div",{children:n})]})})},aG=function(e){return Math.cos(e*(Math.PI/180))},sG=function(e){return Math.sin(e*(Math.PI/180))},lG=function(e,t){var n,r,i,o=ip(e),a=sG(t),s=aG(t),l=MO.getState(),u=l.rotationDegrees;(0,l.setRotationDegrees)(u+=t);for(var c,d,h,f,p=o[0].length,v=[],g=0;g<p;g+=1)c=o[1][g]*a,d=o[0][g]*s,n=Zv(c+d,5),h=o[0][g]*a,f=o[1][g]*s,r=Zv(-(h-f),5),(i=[])[0]=n,i[1]=r,v.push(i);return v},uG=function(e,t){var n,r,i=ip(e),o=sG(t),a=aG(t),s=MO.getState().rotationDegrees;s-=t,MO.setState({rotationDegrees:s});for(var l,u,c,d,h=i[0].length,f=[],p=0;p<h;p+=1){l=i[1][p]*o,u=i[0][p]*a,n=Zv(-(l-u),5),c=i[0][p]*o,d=i[1][p]*a,r=Zv(c+d,5);var v=[];v[0]=n,v[1]=r,f.push(v)}return f},cG=function(e,t,n){var r=MO.getState(),i=r.abFactors,o=r.tempRotFacStateArray,a=r.setD3RotChartData,s=r.setCalculateRotationsArray,l=r.setTempRotFacStateArray;i=vt()(i);for(var u=Math.min.apply(Math,wt(i))-1,c=Math.max.apply(Math,wt(i))-1,d=vt()(o),h=[],f=0;f<d.length;f+=1){var p=d[f][u],v=d[f][c];h.push([p,v])}var g,m=h.length;"clockwise"===e&&(g=lG(h,t)),"counterClockwise"===e&&(g=uG(h,t));for(var y=0;y<m;y+=1)d[y][u]=g[y][0],d[y][c]=g[y][1];var w=GO(d);BM("flag");var b=PM(w);a(b),FM(b,vt()(n)),s(g),l(d),NM()},dG=function(e){var t=MO().rotateByDegrees,n=function(n){var r=n.target.id;n.stopPropagation(),cG(r,t,e.baselineData)};return(0,r.jsxs)("div",{className:"flex flex-row",children:[(0,r.jsx)(C,{otherFormatting:"text-4xl ml-4 mt-1 mr-4 pt-1",buttonText:"\u21bb",buttonColor:"bg-gray-100",handleClick:n,buttonId:"clockwise"}),(0,r.jsx)(C,{otherFormatting:"text-4xl mt-1 mr-4 pt-1",buttonText:"\u21ba",buttonColor:"bg-gray-100",handleClick:n,buttonId:"counterClockwise"})]})},hG=function(e){var t=Xv().colMaxWidth,n=e.rowData,i=e.colDefs,o=e.maxHeight,a=28*n.length+13;a>o&&(a=o);var s={marginTop:10,height:a,width:+t+405};return(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{style:{marginTop:15,fontWeight:300,fontSize:14},children:"Highlighting levels are set by the flagging options in Section 5"}),(0,r.jsx)("div",{style:s,className:"ag-theme-fresh border border-gray-400",children:(0,r.jsx)(EO,{columnDefs:i,rowData:n,gridOptions:{suppressRowHoverHighlight:!1,columnHoverHighlight:!0},animateRows:!0})})]})},fG=function(e){var t="border-gray-400";return e.highlight&&(t="border-green-300"),(0,r.jsx)("input",{type:"text",id:"degreeInput",name:e.name,className:"text-base font-bold w-16 h-12 text-center border-8 ml-2 ".concat(t," rounded-md hover:border-gray-500 focus:outline-none"),onChange:function(t){e.onChangeCallback(t)},value:e.value,onClick:function(t){e.handleDegreeClick(t)}})},pG=function(){var t=MO(),n=t.shouldShowJudgeRotDiv,i=t.highlightDegreeInputButton,o=t.highlightDegreeButton1,a=t.highlightDegreeButton3,s=t.highlightDegreeButton4,l=t.highlightDegreeButton5,u=t.setRotateByDegrees,c=t.rotationDegreeInput,d=t.setHighlightDegreeButton1,h=t.setHighlightDegreeButton2,f=t.setHighlightDegreeButton3,p=t.setHighlightDegreeButton4,v=t.setHighlightDegreeButton5,g=t.setHighlightDegreeInputButton,m=t.setRotationDegreeInput,y=n,w=Y((0,e.useState)(!1),2),b=w[0],S=w[1],E=Y((0,e.useState)(0),2),k=E[0],x=E[1],T=function(e){var t=e.target.id;S(!1),d(!1),h(!1),f(!1),p(!1),v(!1),g(!1),"Button1Degree"===t&&(g(!1),d(!0),u(1)),"Button5Degrees"===t&&(g(!1),f(!0),u(5)),"Button10Degrees"===t&&(g(!1),p(!0),u(10)),"Button90Degrees"===t&&(g(!1),v(!0),u(90))},R=o?"bg-green-300":"bg-gray-100",A=a?"bg-green-300":"bg-gray-100",_=s?"bg-green-300":"bg-gray-100",O=l?"bg-green-300":"bg-gray-100",D=i?"bg-green-300":"bg-gray-100";return y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"m-1",children:(0,r.jsx)(C,{buttonText:"".concat(1,"\xb0"),buttonId:"Button1Degree",buttonColor:R,handleClick:T})}),(0,r.jsx)("div",{className:"m-1",children:(0,r.jsx)(C,{buttonText:"".concat(5,"\xb0"),buttonId:"Button5Degrees",buttonColor:A,handleClick:T})}),(0,r.jsx)("div",{className:"m-1",children:(0,r.jsx)(C,{buttonText:"".concat(10,"\xb0"),buttonId:"Button10Degrees",buttonColor:_,handleClick:T})}),(0,r.jsx)("div",{className:"m-1",children:(0,r.jsx)(C,{buttonText:"".concat(90,"\xb0"),buttonId:"Button90Degrees",buttonColor:O,handleClick:T})}),(0,r.jsx)(fG,{name:"rotationDegrees",value:c,className:"btn ".concat(D," hover:bg-gray-400"),onChangeCallback:function(e){var t=e.target.value;isNaN(t)||(m(+t),x(+t),g(!0),d(!1),h(!1),f(!1),p(!1),v(!1),u(+t))},highlight:b,handleDegreeClick:function(e){m(k),u(k),S(!0),d(!1),h(!1),f(!1),p(!1),v(!1)}})]}):null},vG=function(e){O(n,e);var t=F(n);function n(e){var r;return T(this,n),(r=t.call(this,e)).state={value:e.value},r.handleCheckboxChange=r.handleCheckboxChange.bind(P(r)),r}return A(n,[{key:"handleCheckboxChange",value:function(e){this.props.data[this.props.colDef.field]=!this.props.data[this.props.colDef.field],this.setState({value:this.props.data[this.props.colDef.field]})}},{key:"render",value:function(){return(0,r.jsx)("input",{type:"checkbox",checked:this.state.value,onChange:this.handleCheckboxChange,className:"w-[15px] h-[15px]]"})}}]),n}(e.Component),gG=vG,mG=function(e,t){var n=+e.slice(1,2),r=+t.slice(1,2),i=+e.slice(3),o=+t.slice(3),a=n-r;return 0!==a?a:i-o},yG=n(9761),wG=n.n(yG),bG=function(e,t){var n,r=[],i=[],o=MO.getState().numFactorsKeptForRot;e.length=o;for(var a=ip(e),s=0,l=a.length;s<l;s+=1){n={};var u=a[s];n.maxValue=Math.max.apply(Math,wt(u)),n.minValue=Math.min.apply(Math,wt(u)),n.sortNum=s+1,n.compareValue=Zv(Math.abs(n.maxValue)-Math.abs(n.minValue),8),n.compareValue>=0?(n.indexValue=wG()(a[s],n.maxValue),n.subSortValue=n.maxValue):(n.indexValue=wG()(a[s],n.minValue),n.subSortValue=Math.abs(n.minValue)),n.sort=a[s],r.push(n)}var c,d,h,f=vt()(r);f.sort((function(e,t){return e.indexValue-t.indexValue||t.subSortValue-e.subSortValue}));for(var p=0,v=0,g=f.length;v<g;v+=1)d=f[v].indexValue,0===v||d===f[v-1].indexValue?p+=1:p=1,h="F".concat(d+1).concat(t),c="F".concat(d+1,"-").concat(p),i.push([f[v].sortNum,c,v+1,h]);return i.sort((function(e,t){return e[0]-t[0]})),i},CG=function(e){for(var t=vt()(jO.getState().factorMatrix),n=vt()(y.getState().respondentNames),r=UL.getState().fSigCriterionResults,i=UL.getState().highlighting,o=bG(wt(t),i),a=[],s=[{headerName:"Number",field:"resNum",pinned:!0,editable:!1,sortable:!0,width:70,cellStyle:{textAlign:"center"}},{headerName:"Participant",field:"respondent",width:170,pinned:!0,sortable:!0,editable:!1,cellStyle:{textAlign:"center"}},{headerName:"FG",field:"factorGroup",pinned:!0,width:70,editable:!1,sortable:!0,comparator:mG,cellStyle:{textAlign:"center"}},{headerName:"highlighting",field:"highlighting",pinned:!1,editable:!1,cellStyle:{textAlign:"center"},hide:!0},{headerName:"defaultSort",field:"defaultSort",pinned:!1,editable:!1,cellStyle:{textAlign:"center"},hide:!0}],l=0;l<e;l+=1){var u=l+1;s.push({headerName:"".concat("Factor"," ").concat(u),field:"factor".concat(u),pinned:!1,width:90,editable:!1,sortable:!0,cellStyle:{textAlign:"right"}},{headerName:"F".concat(u),field:"check".concat(u),pinned:!1,editable:!1,sortable:!0,width:40,cellRenderer:gG,cellStyle:{textAlign:"left"}})}for(var c=[],d=0;d<n.length;d+=1){var h=d+1,f={},p=[];f.resNum=h,f.respondent=n[d],f.factorGroup=o[d][1],f.highlightingClass=o[d][3],f.defaultSort=o[d][2];for(var v=0;v<t.length;v+=1){var g=v+1,m=Zv(t[v][d],4);f["factor".concat(g)]=m,p.push(m),r.length>0?f["check".concat(g)]=r[d][v]:f["check".concat(g)]=!1}a.push(p),c.push(f)}c.sort((function(e,t){return e.defaultSort-t.defaultSort})),UL.setState({gridColDefsLoadingsTable:s,gridRowDataLoadingsTable:c,isLoadingFactorsKept:!1,isLoadingAutoflag:!1,isLoadingsTableInitialRender:!0})},SG=function(){var e,t=y(),n=t.projectHistoryArray,i=t.setProjectHistoryArray,o=jO().setFactorMatrix,a=MO(),s=a.tempRotFacStateArray,l=a.abFactors,u=UL().bipolarDisabled,c=MO(),d=c.rotationDegrees,h=c.numFactorsKeptForRot,f=c.setRotationDegrees,p=c.setShowScatterPlotTableDiv,v=c.setUserSelectedRotFactors,g=c.setAbFactors,m=c.setNotifyForSavedRotations,w=c.setShouldClearRotButHigh,b=qL(),S=b.setShowOutputFactorSelection,E=b.setShouldDisplayFactorVizOptions,k=b.setShowFactorCorrelationsTable,x=b.setShowStandardErrorsDifferences,T=b.setShowFactorCharacteristicsTable,R=b.setShowDownloadOutputButtons,A=b.setDisplayFactorVisualizations,_=b.setUserSelectedFactors,O=u;return e=0!==d?"bg-orange-300":"bg-gray-100",(0,r.jsx)(C,{buttonId:"saveRotationButton",otherFormatting:"m-1",handleClick:function(e){f(0),p(!1),s=vt()(s);var t=(l=vt()(l))[0],r=l[1],a=ip(s);o(a);var u=h;BM("noFlag"),CG(u);var c=vt()(n),y="Factor ".concat(t," and Factor ").concat(r," rotation ").concat(d," degrees");c.push(y),i(c),v([]),g([]),p(!1),m(!0),S(!1),E(!1),k(!1),x(!1),T(!1),R(!1),A(!1),_([]),w(!0)},disabled:O,buttonColor:e,buttonText:"Save Rotation"})},EG=function(t){var n=MO(),i=n.showScatterPlotTableDiv,o=n.rotColDefsFactorTable,a=n.rotRowDataFactorTable,s=n.rotationDegrees,l=n.newRotationVectors,u="".concat(s,"\xb0"),c=(0,e.useMemo)((function(){return vt()(l)}),[l]),h=(0,e.useMemo)((function(){return vt()(o)}),[o]),f=(0,e.useMemo)((function(){return vt()(a)}),[a]);function p(){var e=window.innerWidth-533,t=window.innerHeight-275;return e>t?t:(e>1100&&(e=1100),e)}var v=Y((0,e.useState)(p()),2),g=v[0],m=v[1],y=Y((0,e.useState)(p()),2),w=y[0],b=y[1];(0,e.useEffect)((function(){var e=function(){var e=p();m(e),b(e)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]);var C=p(),S=window.innerHeight-300;return i?(0,r.jsxs)("div",{className:"flex flex-col  items-center",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center mb-6 mt-6 ",children:[(0,r.jsx)("p",{className:"text-2xl mr-2",children:"Rotate axes"}),(0,r.jsx)(pG,{}),(0,r.jsx)(dG,{baselineData:t.baselineData}),(0,r.jsxs)("div",{className:"w-[150px]",children:[" ",(0,r.jsx)("p",{className:"text-5xl ml-4",children:u})]}),(0,r.jsx)(SG,{})]}),(0,r.jsxs)("div",{id:"scatterPlotDiv",className:"grid grid-cols-2 place-items-center",children:[(0,r.jsxs)("div",{style:{width:C},children:[(0,r.jsx)(oG,{}),(0,r.jsx)(iG,d(d({data:c,width:g,height:w},t),{padding:30,marginBottom:10}))]}),(0,r.jsx)("div",{id:"rotFactorsTableDiv",children:(0,r.jsx)(hG,{colDefs:h,maxHeight:S,rowData:f})})]})]}):null},kG=function(){var t=jO().factorMatrix,n=MO(),i=n.notifyForSavedRotations,o=n.setNotifyForSavedRotations,a=vt()(t),s=ip(a);return(0,e.useEffect)((function(){i&&(DM.success("Rotation Data Saved to Loadings Table",{autoClose:5e3}),o(!1))}),[i,o]),(0,r.jsxs)("div",{id:"outmostDiv",className:"flex flex-col items-center",children:[(0,r.jsxs)("div",{className:"flex flex-row mt-4 mb-4 items-center",id:"selectButton",children:[(0,r.jsx)("p",{className:"text-2xl mr-2",children:"Select Factors:"}),(0,r.jsx)(HM,{baselineData:s}),(0,r.jsx)(CM,{transition:bM})]}),(0,r.jsx)(EG,{baselineData:s})]})},xG=function(){var t=MO().shouldShowJudgeRotDiv;return(0,r.jsx)(e.Fragment,{children:t?(0,r.jsx)(kG,{}):null})},TG=function(){var t=y(),n=t.projectHistoryArray,i=t.setProjectHistoryArray,o=jO(),a=o.showKeepFacForRotButton,s=o.factorMatrix,l=MO(),u=l.numFactorsKeptForRot,c=l.setIsLoadingsFactorsKept,d=l.setIsFacSelectDisabled,h=l.setShouldDisplayFacKept,f=UL().setShowLoadingsTable,p=Y((0,e.useState)(!1),2),v=p[0],g=p[1];return a?(0,r.jsxs)(e.Fragment,{children:[(0,r.jsx)(C,{buttonText:"Submit",disabled:v,handleClick:function(){if(0!==+u){var e="Number of factors selected for rotation: ".concat(u),t=vt()(n);t.push(e),i(t),c(!0),setTimeout((function(){var e=vt()(s),t=ip(e);GO(t),BM("flag"),CG(u)}),10),d(!0),h(!0),f(!0),g(!0)}else window.facKeptSubmitModal.showModal()}}),(0,r.jsx)("dialog",{id:"facKeptSubmitModal",className:"modal",children:(0,r.jsxs)("form",{method:"dialog",className:"modal-box border-2 border-gray-500",children:[(0,r.jsx)("p",{className:"font-bold text-2xl",children:"Input Error"}),(0,r.jsx)("span",{className:"text-lg mt-4",children:"Please select the number of factors to keep for rotation"}),(0,r.jsx)("div",{className:"modal-action",children:(0,r.jsx)(rg,{buttonText:"Close"})})]})})]}):null},RG=function(){var e=MO(),t=e.shouldShowJudgeRotDiv,n=e.shouldDisplayFacKept,i=e.setShouldShowJudgeRotDiv,o=e.setJudgeButtonActive,a=e.setShouldDisplayRotFactorButtons,s=UL().bipolarDisabled;if(n)return(0,r.jsx)("div",{className:"ml-8",children:(0,r.jsx)(C,{buttonText:"Judgmental Rotation",buttonColor:"bg-gray-100",handleClick:function(e){!0===!t?(i(!0),o(!0),a(!0)):(i(!1),o(!1))},disabled:s})})},AG=function(e){for(var t,n,r=[],i=e.length,o=0,a=e[0].length;o<a;o++){t=0,0;for(var s=0;s<i;s++)t+=Zv(e[s][o]*e[s][o],8);n=Zv(t,8),r.push(n)}return r},_G=function(e,t){var n,r,i,o,a,s,l,u,c,d,h=!1;if(e<t){if((n=Zv(Math.abs(e)/Math.abs(t),5))<.00116)return t>=0?[r,i,h=!0]:[r=.7071066,i=.7071066,h];o=Zv(1/Zv(Math.sqrt(1+n*n),8),8),a=Zv(n*o,8)}else if(e===t){if(e+t<.00116)return[r,i,h=!0];o=.7071066,a=.7071066}else(s=Zv(Math.abs(e/t),5))<.00116?(o=0,a=1):(a=Zv(1/Zv(Math.sqrt(1+s*s),8),8),o=Zv(s*a,8));return l=Zv(Math.sqrt((1+o)/2),8),u=Zv(a/(2*l),8),c=Zv(Math.sqrt((1+l)/2),8),d=Zv(u/(2*c),8),t<=0?(i=Zv(.7071066*c+.7071066*d,8),r=Zv(Math.abs(.7071066*c-.7071066*d),8)):(i=c,r=d),e<=0&&(r=-r),[r,i,h]},OG=function(e,t,n){if(e[2])return[t,n];var r,i,o,a=[],s=[],l=t.length,u=e[0],c=e[1];for(r=0;r<l;r++)i=Zv(t[r]*c+n[r]*u,8),a.push(i),o=Zv(-t[r]*u+n[r]*c,8),s.push(o);return[a,s]},DG=function(e,t){for(var n,r,i,o,a,s,l,u,c,d=[],h=[],f=[],p=[],v=e.length,g=0,m=v;g<m;g++)a=(e[g]+t[g])*(e[g]-t[g]),d.push(a),l=(s=e[g]*t[g])+s,h.push(l),u=(a+l)*(a-l),f.push(u),c=2*a*l,p.push(c);i=Zv(UO(f),17),o=Zv(UO(p),17),n=Zv(UO(d),17),r=Zv(UO(h),17);var y=Zv(o-Zv(2*n*Zv(r/v,17),17),17),w=Zv(i-Zv((n*n-r*r)/v,8),8),b=_G(y,w);return OG(b,e,t)},NG=function(e){var t,n,r,i=e.length;for(n=0;n<i;n++)for(r=n+1;r<i;r++)t=DG(e[n],e[r]),e[n]=t[0],e[r]=t[1];return e},PG=function(e,t){var n,r,i,o,a,s,l,u=[],c=e.length;for(n=0;n<c;n++){for(a=[],o=(i=e[n]).length,l=0,r=0;r<o;r++)0,s=Zv(i[r],5)*Zv(Math.sqrt(t[r]),5),a.push(Zv(s,5)),l+=s*Math.abs(s);if(l<0){var d,h=a.length;for(d=0;d<h;d++)a[d]=-a[d]}u.push(a)}return ip(u)},FG=function(e,t){var n,r,i,o,a,s,l,u,c,d,h,f,p=0,v=e[0].length,g=v*v;do{n&&(e=u),s=[];var m=void 0,y=void 0,w=void 0,b=void 0,C=e.length;for(r=p,w=0;w<C;w+=1){0,0;var S=(m=e[w]).length;for(o=[],a=[],b=0;b<S;b+=1){y=Zv(m[b]*m[b],8),o.push(Zv(y,8));var E=Zv(y*y,8);a.push(Zv(E,8))}c=Zv(UO(o),8),d=Zv(UO(a),8),h=Zv(v*d,8),f=Zv(c*c,8),p=Zv((h-f)/g,8),s.push(p)}p=Zv(UO(s),8),n?n+=1:(n=1,i=0,r=0),Math.abs(p-r)<1e-8?i+=1:i=0,u=NG(e),l=!1,i>3&&(l=!0),n>=225&&(l=!0)}while(!1===l);return PG(e,t)},IG=function(e,t){var n,r,i,o,a,s,l,u=[],c=t.length;for(s=0;s<c;s++){for(n=t[s],r=[],i=t[s].length,l=0;l<i;l++)o=0!==(a=Zv(Math.sqrt(e[l]),8))?Zv(n[l]/a,8):0,r.push(o);u.push(r)}return u},LG=function(e,t,n,r,i,o){var a=e.map((function(e,a){var s=[],l=[];return e.map((function(e,r){return e>1?(n=!0,s.push(.99999),l.push(Zv(e-1,5)),o.push(t[r])):(s.push(e),l.push(e)),null})),r.push(s),i.push(l),e}));return{needsVarimaxHeywoodAdjustment:n,adjValArray:r,adjValPqmArray:i,originalMatrix:a,over1ParticipantsArray:o}},MG=function(){var e=vt()(MO.getState().adjValPqmArray),t=vt()(MO.getState().tempVarHeyProjectHistoryArray),n="".concat("Varimax Applied"," - ").concat("factor loading greater than 1 adjusted to PQMethod value");t.push(n);var r=vt()(MO.getState().tempVarHeyNewRotatedResults),i=vt()(MO.getState().tempVarHeyNumFactors);jO.setState({factorMatrix:e}),y.setState({projectHistoryArray:t}),MO.setState({isCalculatingVarimax:!1,varimaxButtonDisabled:!0,varimaxButtonText:"Varimax Applied"}),qL.setState({showOutputFactorSelection:!1,shouldDisplayFactorVizOptions:!1,userSelectedFactors:[],showFactorCorrelationsTable:!1,showStandardErrorsDifferences:!1,showFactorCharacteristicsTable:!1,showDownloadOutputButtons:!1,displayFactorVisualizations:!1}),UL.setState({sendDataToOutputButtonColor:"#d6dbe0"}),GO(r),BM("noFlag"),CG(i)},GG=function(){var e=vt()(jO.getState().factorMatrix),t=MO.getState().numFactorsKeptForRot;e.length=t;var n=vt()(y.getState().projectHistoryArray),r=AG(e),i=IG(r,e),o=FG(i,r),a=MO.getState().numFactorsKeptForRot,s=ip(o),l=vt()(s),u=vt()(o),c=vt()(y.getState().respondentNames),d=[],h=LG(l,c,!1,[],[],d);if(MO.setState({adjValArray:h.adjValArray,adjValPqmArray:h.adjValPqmArray}),h.needsVarimaxHeywoodAdjustment){var f=d.join(", ");MO.setState({varimaxHeywoodWarningParticipants:f,showVarimaxHeywoodWarning:!1,tempVarHeyTransposedRotatedResults2:l,tempVarHeyProjectHistoryArray:n,tempVarHeyNewRotatedResults:u,tempVarHeyNumFactors:a}),MG()}else n.push("Varimax rotation applied"),jO.setState({factorMatrix:l}),y.setState({projectHistoryArray:n}),MO.setState({isCalculatingVarimax:!1,varimaxButtonDisabled:!0,varimaxButtonText:"Varimax Applied"}),qL.setState({showOutputFactorSelection:!1,shouldDisplayFactorVizOptions:!1,userSelectedFactors:[],showFactorCorrelationsTable:!1,showStandardErrorsDifferences:!1,showFactorCharacteristicsTable:!1,showDownloadOutputButtons:!1,displayFactorVisualizations:!1}),UL.setState({sendDataToOutputButtonColor:"bg-gray-100"}),GO(u),BM("noFlag"),CG(a)},BG=function(){var e=MO(),t=e.setUserSelectedRotFactors,n=e.setAbFactors,i=e.setRotationDegrees,o=e.setShowScatterPlotTableDiv,a=e.setIsCalculatingVarimax,s=e.setVarimaxButtonActive,l=e.shouldDisplayFacKept,u=e.varimaxButtonActive,c=e.varimaxButtonText,d=UL().bipolarDisabled,h=u?"bg-green-300":"bg-gray-100";if(l)return(0,r.jsx)("div",{children:(0,r.jsx)(C,{buttonText:c,handleClick:function(e){!0!==u&&!0!==d&&(i(0),t([]),n([]),o(!1),a(!0),s(!0),GG())},buttonColor:h,disabled:d,otherFormatting:"w-[200px]"})})},jG=function(){var e=vt()(MO.getState().tempVarHeyTransposedRotatedResults2),t=vt()(y.getState().tempVarHeyProjectHistoryArray),n=vt()(MO.getState().tempVarHeyNewRotatedResults),r=vt()(MO.getState().tempVarHeyNumFactors);t.push("Varimax rotation applied"),jO.setState({factorMatrix:e}),y.setState({projectHistoryArray:t}),MO.setState({isCalculatingVarimax:!1,varimaxButtonDisabled:!0,varimaxButtonText:"Varimax Applied"}),UL.setState({sendDataToOutputButtonColor:"#d6dbe0"}),qL.setState({showOutputFactorSelection:!1,shouldDisplayFactorVizOptions:!1,userSelectedFactors:[],showFactorCorrelationsTable:!1,showStandardErrorsDifferences:!1,showFactorCharacteristicsTable:!1,showDownloadOutputButtons:!1,displayFactorVisualizations:!1}),UL.setState({sendDataToOutputButtonColor:"#d6dbe0"}),GO(n),BM("noFlag"),CG(r)},HG=function(){var e=vt()(MO.getState().adjValArray),t=vt()(MO.getState().tempVarHeyProjectHistoryArray),n=vt()(ip(e)),r=vt()(MO.getState().tempVarHeyNumFactors),i="".concat("Varimax Applied"," - ").concat("factor loading greater than 1 adjusted to 099");t.push(i),y.setState({projectHistoryArray:t}),jO.setState({factorMatrix:e,isCalculatingVarimax:!1,varimaxButtonDisabled:!0,varimaxButtonText:"Varimax Applied"}),qL.setState({showOutputFactorSelection:!1,shouldDisplayFactorVizOptions:!1,userSelectedFactors:[],showFactorCorrelationsTable:!1,showStandardErrorsDifferences:!1,showFactorCharacteristicsTable:!1,showDownloadOutputButtons:!1,displayFactorVisualizations:!1}),UL.setState({sendDataToOutputButtonColor:"#d6dbe0"}),GO(n),BM("noFlag"),CG(r)},VG=function(){var t=MO(),n=t.varimaxHeywoodWarningParticipants,i=t.showVarimaxHeywoodWarning,o=t.setVariAdjustButtonActive,a=t.setVariContinueButtonActive,s=t.setVariContinueButtonDisabled,l=t.setVariAdjustButtonDisabled,u=t.setVariPqmAdjustButtonActive,c=t.setVariPqmAdjustButtonDisabled;return i?(0,r.jsxs)(e.Fragment,{children:[(0,r.jsx)("p",{children:"".concat("A 'Heywood case' occurs when a participant in the project has a communality estimate greater than 1",". ").concat("This can happen when too many or too few factors have been extracted",". ").concat("You can continue the analysis with the current factors (including Heywood case), re-select the number of factors, or proportionally adjust the factor loadings for the Heywood case participants so that their communality estimates will equal 1",".")}),(0,r.jsx)("h4",{children:"Factor loading > 1: ".concat(n)}),(0,r.jsxs)("div",{children:[(0,r.jsx)("button",{id:"VariContinueButton",onClick:function(e){jG(),a(!0),s(!0),o(!1),l(!0),u(!1),c(!0)},children:"Continue Analysis"}),(0,r.jsx)("button",{id:"VariAdjustButton",onClick:function(e){HG(),a(!1),s(!0),o(!0),l(!0),u(!1),c(!0)},children:"Adjust Value to 0.99"}),(0,r.jsx)("button",{id:"VariPqmAdjustButton",onClick:function(e){MG(),a(!1),s(!0),o(!1),l(!0),u(!0),c(!0)},children:"Adjust to PQMethod-style Value"})]})]}):null},WG=function(){return jO().showSections45?(0,r.jsxs)("div",{className:"flex flex-col items-center bg-blue-100 rounded-md p-6",children:[(0,r.jsx)(WL,{}),(0,r.jsx)("div",{className:"w-full bg-gray-300 p-8 rounded-md",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex flex-row justify-center ",children:[(0,r.jsx)(XL,{}),(0,r.jsx)(TG,{})]}),(0,r.jsx)("div",{className:"flex flex-row justify-center ",children:(0,r.jsx)(YL,{})}),(0,r.jsxs)("div",{className:"flex flex-row justify-center mt-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(BG,{}),(0,r.jsx)(VG,{})]}),(0,r.jsx)(RG,{})]}),(0,r.jsx)("div",{className:"flex flex-col mt-8",children:(0,r.jsx)(xG,{})})]})})]}):null},zG=function(){return(0,r.jsx)("div",{className:"my-7",children:(0,r.jsx)("a",{href:"https://github.com/shawnbanasick/ken-q-analysis/wiki/5.-FACTOR-LOADINGS",target:"_blank",rel:"noopener noreferrer",style:{targetNew:"tab"},children:(0,r.jsx)(V,{buttonColor:"bg-gray-100",buttonText:"Help - Section 5"})})})},UG=function(){return(0,r.jsx)("div",{className:"m-8 w-10/12",children:(0,r.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,r.jsx)("div",{className:"flex flex-row",children:(0,r.jsx)("p",{className:"text-6xl my-4",children:"5. Factor Loadings Table"})}),(0,r.jsx)(zG,{})]})})},KG=function(e){var t=UL(),n=t.setUserSelectedSigLevel,i=t.bipolarDisabled,o=t.setAutoflagButtonColor;return(0,r.jsxs)("select",{className:"select select-bordered rounded-md w-[125px] font-bold border border-gray-400",onChange:function(t){n(t.target.value),o("bg-orange-300"),e.clearAllCheckboxes()},disabled:i,defaultValue:"1.96",children:[(0,r.jsx)("option",{value:3.291,children:"P < 0.001"},"99.9"),(0,r.jsx)("option",{value:2.807,children:"P < 0.0005"},"99.5"),(0,r.jsx)("option",{value:2.575,children:"P < 0.01"},"99"),(0,r.jsx)("option",{value:1.96,children:"P < 0.05"},"95"),(0,r.jsx)("option",{value:1.645,children:"P < 0.1"},"90"),(0,r.jsx)("option",{value:1.44,children:"P < 0.15"},"85"),(0,r.jsx)("option",{value:1.28,children:"P < 0.2"},"80"),(0,r.jsx)("option",{value:"majority",children:"Maj. Com. Var."},"Com")]})},qG=function(e){var t=e.target.value;UL.setState({factorToInvert:t})},XG=function(){var e=[1,2,3,4,5,6,7,8];e.length=+MO.getState().numFactorsKeptForRot;for(var t=[],n=0;n<e.length;n++){var i=(0,r.jsx)("option",{children:e[n]},"".concat(e[n]));t.push(i)}return t.unshift((0,r.jsx)("option",{className:"text-right",value:"default",children:"?"},0)),(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("span",{className:"text-3xl mb-4",children:"Select the Factor to Invert"}),(0,r.jsx)("select",{className:"select select-bordered rounded-md w-[73px] font-bold",placeholder:"?",onChange:qG,children:t.map((function(e){return e}))})]})},YG=function(e){var t=UL().bipolarDisabled;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("dialog",{id:"invertFactorModal",className:"modal",children:(0,r.jsxs)("form",{method:"dialog",className:"modal-box border-2 border-gray-600",children:[(0,r.jsx)(XG,{}),(0,r.jsx)("div",{className:"",children:(0,r.jsxs)("div",{className:"flex flex-row w-[450px] place-content-around mt-8",children:[(0,r.jsx)(rg,{id:"invertFactorCancelButton",buttonColor:"bg-gray-300",otherFormatting:"modal-action",buttonText:"Cancel"}),(0,r.jsx)(rg,{id:"invertFactorSubmitButton",buttonColor:"bg-green-300",otherFormatting:"modal-action",buttonText:"Submit",handleClick:e.handleClick})]})})]})}),(0,r.jsx)(C,{id:"invertFactorsButton",handleClick:function(){window.invertFactorModal.showModal()},buttonColor:"bg-gray-100",otherFormatting:"m-1 ml-4 mr-8",disabled:t,buttonText:"Invert Factor"})]})},QG=function(){var e=UL().setFactorToSplit,t=MO().numFactorsKeptForRot,n=[1,2,3,4,5,6,7,8];n.length=+t;var i=n.map((function(e){return(0,r.jsx)("option",{className:"bg-red-200",value:e,children:e},e.toString())}));return i.unshift((0,r.jsx)("option",{className:"text-right",value:"default",children:"?"},0)),(0,r.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,r.jsx)("span",{className:"text-3xl mb-4",children:"Select the Factor to Split"}),(0,r.jsx)("select",{className:"select select-bordered indent-2 rounded-md w-[73px] font-bold",onChange:function(t){e(t.target.value)},children:i})]})},ZG=function(e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("dialog",{id:"splitBipolarFactorModal",className:"modal",children:(0,r.jsxs)("form",{method:"dialog",className:"modal-box border-2 border-gray-600",children:[(0,r.jsx)(QG,{}),(0,r.jsxs)("div",{className:"flex flex-row w-[450px] place-content-around mt-8",children:[(0,r.jsx)(rg,{id:"invertFactorCancelButton",buttonColor:"bg-gray-300",otherFormatting:"modal-action",buttonText:"Cancel"}),(0,r.jsx)(rg,{id:"invertFactorSubmitButton",buttonColor:"bg-green-300",otherFormatting:"modal-action",buttonText:"Submit",handleClick:e.handleClick})]})]})}),(0,r.jsx)(C,{id:"splitFactorsButton",buttonColor:"bg-gray-100",handleClick:function(){window.splitBipolarFactorModal.showModal()},otherFormatting:"m-1 ml-4 mr-8",buttonText:"Split Bipolar Factor"})]})},JG=function(e){var t=UL(),n=t.requireMajorityCommonVariance,i=t.bipolarDisabled,o=t.setRequireMajorityCommonVariance,a=n;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("label",{className:"mr-2",children:"Require Majority of Common Variance"}),(0,r.jsx)("input",{id:"majComVar",type:"checkbox",checked:a,disabled:i,onChange:function(){o(n=!n),e.clearAllCheckboxes()}})]})},$G=function(e){for(var t=qL.getState().outputButtonsArray,n=0;n<t.length;n+=1)qL.setState(u({},"highlightfactor".concat(t[n]),!1));qL.setState({userSelectedFactors:[],showOutputFactorSelection:!0,showStandardErrorsDifferences:!1,showFactorCharacteristicsTable:!1,showDownloadOutputButtons:!1,showFactorCorrelationsTable:!1,displayFactorVisualizations:!1,shouldDisplayFactorVizOptions:!1,outputFactorSelectButtonsDisabled:!1,showTableDataNotSentWarning:!1,outputForDataViz2:[]}),UL.setState({currentLoadingsTable:e,notifyDataSentToOutputSuccess:!0,sendDataToOutputButtonColor:getComputedStyle(document.documentElement).getPropertyValue("--main-theme-color"),gridRowDataLoadingsTable:e})},eB=function(){var e=UL.getState().factorToSplit,t=UL.getState().currentLoadingsTable,n=UL.getState().gridColDefsLoadingsTable;if("default"!==e){var r=UL.getState().bipolarSplitCount,i=y.getState().projectHistoryArray,o=UL.getState().bipolarIndexArray;r+=1,UL.setState({bipolarSplitCount:r});var a="factor".concat(e),s="check".concat(e);o.push(e);for(var l="".concat(a,"a"),u="".concat(a,"b"),c="".concat(s,"a"),d="".concat(s,"b"),h=[],f=0,p=n.length;f<p;f+=1)h.push(n[f].field);var v=h.indexOf(a),g=v+1,m=vt()(n[v]),w=vt()(n[v]),b=vt()(n[g]),C=vt()(n[g]);n.splice(v,2),m.headerName="Factor ".concat(e,"a"),b.headerName="F".concat(e,"a"),w.headerName="Factor ".concat(e,"b"),C.headerName="F".concat(e,"b"),m.field=l,b.field=c,w.field=u,C.field=d,n.splice(v,0,m,b,w,C);for(var S=0,E=t.length;S<E;S+=1){var k=t[S][a],x=t[S][s];t[S][l]=k,t[S][u]=-k,k<0&&!0===x?(t[S][c]=!1,t[S][d]=!0):(t[S][c]=x,t[S][d]=!1),delete t[S][a],delete t[S][s]}var T="Bipolar Factor ".concat(e," was split into Factor ").concat(e,"a and Factor ").concat(e,"b");i.push(T),y.setState({projectHistoryArray:i}),UL.setState({gridColDefsLoadingsTable:n,gridRowDataLoadingsTable:t,factorToSplit:"default",bipolarDisabled:!0,bipolarIndexArray:o,sendDataToOutputButtonColor:"bg-orange-300"}),qL.setState({showOutputFactorSelection:!1,userSelectedFactors:[],shouldDisplayFactorVizOptions:!1,showFactorCorrelationsTable:!1,showStandardErrorsDifferences:!1,showFactorCharacteristicsTable:!1,showDownloadOutputButtons:!1,displayFactorVisualizations:!1})}return[n,t]},tB=function(){var e=UL.getState().factorToInvert,t=UL.getState().currentLoadingsTable,n=y.getState().projectHistoryArray,r=jO.getState().factorMatrix;if(void 0!==e){for(var i="factor".concat(e),o=0;o<t.length;o+=1)t[o][i]=-t[o][i];for(var a=r[e-1],s=0;s<a.length;s+=1)a[s]=-a[s];var l="Factor ".concat(e," was inverted");n.push(l),y.setState({projectHistoryArray:n}),jO.setState({factorMatrix:r}),UL.setState({sendDataToOutputButtonColor:"bg-orange-300",gridRowDataLoadingsTable:t}),qL.setState({showOutputFactorSelection:!1,userSelectedFactors:[],shouldDisplayFactorVizOptions:!1,showFactorCorrelationsTable:!1,showStandardErrorsDifferences:!1,showFactorCharacteristicsTable:!1,showDownloadOutputButtons:!1,displayFactorVisualizations:!1})}return e},nB=function(e){var t=vt()(jO.getState().factorMatrix),n=ip(t);GO(n);var r=BM("flag");return e.forEach((function(e){var t=e.resNum;r[t-1].forEach((function(t,n){e["check".concat(n+1)]=t}))})),e},rB=function(){var e={3.891:"P < 0.0001",3.481:"P < 0.0005",3.291:"P < 0.001",2.807:"P < 0.005",2.575:"P < 0.01",1.96:"P < 0.05",1.645:"P < 0.1",1.44:"P < 0.15",1.28:"P < 0.2",majority:"Majority of Common Variance"}[UL.getState().userSelectedSigLevel],t=" and a majority of common variance was not required";!0===UL.getState().requireMajorityCommonVariance&&(t=" and a majority of common variance was required");var n=["Auto-Flag ","".concat(e).concat(t)];UL.setState({autoFlagHistory:n,sendDataToOutputButtonColor:"bg-orange-300"})},iB=function(){var t=y().numQsorts,n=UL(),i=n.sendDataToOutputButtonColor,o=n.bipolarDisabled,a=n.gridColDefsLoadingsTable,s=n.gridRowDataLoadingsTable,l=n.bipolarSplitCount,u=n.setTemp_gridRowDataLoadingsTable,c=n.setGridColDefsLoadingsTable,d=n.setSendDataToOutputButtonColor,h=n.setCurrentLoadingsTable,f=n.setShowInvertFactorModal,p=n.setHighlighting,v=n.setShowSection6,g=qL(),m=g.setShowOutputFactorSelection,w=g.setShowFactorCorrelationsTable,b=g.setShowStandardErrorsDifferences,S=g.setShowFactorCharacteristicsTable,E=g.setShowDownloadOutputButtons,k=g.setShouldDisplayFactorVizOptions,x=g.setDisplayFactorVisualizations,T=g.setOutputButtonsArray,R=MO().numFactorsKeptForRot,A=(0,e.useRef)(),_=R,O=l,D=o,N=R,P=(0,e.useRef)(),F=function(e){var t=e;return"factor"===(t=t.substring(0,6))?e:null};function I(e){var t=325+128*e+12,n=window.innerWidth-140;return n<t?n+="px":t+="px"}function L(e){var t=40+25*e+20,n=window.innerHeight-230;return t<n?t+="px":n+="px"}window.addEventListener("resize",(function(){!function(){var e=document.querySelector("#loadingsTableContainer");null!==e&&(e.style.width=I(N),e.style.height=L(t))}()})),(0,e.useEffect)((function(){var e=function(){var e=document.querySelector("#loadingsTableContainer");null!==e&&(e.style.width=I(N),e.style.height=L(t))};return window.addEventListener("resize",(function(){e()})),function(){window.removeEventListener("resize",(function(){e()}))}}),[N,t]),N=Number(_),(l=Number(O))>0&&(N+=l);var M={marginTop:2,height:L(t),width:I(N),marginBottom:15,padding:0};var G=function(){var e=[];return P.current.forEachNode((function(t){e.push(t.data)})),e},B=function(){for(var e=G(),t=0;t<e.length;t+=1)for(var n=0;n<N;n+=1){var r="check".concat(n+1);e[t][r]=!1}P.current.setRowData(e),d("bg-gray-100")},j=function(e){var t=[];P.current.forEachNode((function(n){var r=n.data.highlightingClass.slice(0,2),i="".concat(r).concat(e);n.data.highlightingClass=i,t.push(n.data)})),P.current.setRowData(t),p(e)};return(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"flex flex-col items-center outline-blue-300 max-w-[1350px]",children:[(0,r.jsx)(CM,{transition:bM}),(0,r.jsxs)("div",{className:"grid grid-cols-2 w-[1100px]",children:[(0,r.jsx)("p",{className:"text-xl",children:"Row Highlighting"}),(0,r.jsx)("p",{className:"text-xl",children:"Flagging"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 w-[1100px]outline-red-400",children:[(0,r.jsxs)("div",{className:"flex flex-row",children:[(0,r.jsx)(C,{handleClick:function(){return j("none")},buttonText:"None",buttonColor:"bg-gray-100",otherFormatting:"m-1 ml-4 mr-2",disabled:D}),(0,r.jsx)(C,{handleClick:function(){return j("colors")},buttonText:"Color",buttonColor:"bg-gray-100",otherFormatting:"m-1 ml-4 mr-2",disabled:D}),(0,r.jsx)(C,{handleClick:function(){return j("grays")},buttonText:"Gray",buttonColor:"bg-gray-100",otherFormatting:"m-1 ml-4 mr-8",disabled:D})]}),(0,r.jsxs)("div",{className:"flex flex-row items-center",children:[(0,r.jsx)(C,{buttonId:"autoflagButton",buttonText:"Auto-flag",buttonColor:"bg-gray-100",disabled:D,handleClick:function(){var e=G(),t=nB(e);P.current.setRowData(t),d("bg-orange-300"),rB()},otherFormatting:"m-1 ml-4 mr-4"}),(0,r.jsx)("span",{className:"mr-4",children:"at"}),(0,r.jsx)(KG,{clearAllCheckboxes:B,data:"allData"}),(0,r.jsx)(C,{handleClick:function(){for(var e=G(),t=["F1","F2","F3","F4","F5","F6","F7","F8"],n=0;n<e.length;n+=1)for(var r=e[n].factorGroup.slice(0,2),i=t.indexOf(r),o=0;o<N;o+=1){var a="check".concat(o+1);e[n][a]=i===o}P.current.setRowData(e),d("bg-orange-300")},buttonText:"All",buttonColor:"bg-gray-100",otherFormatting:"m-1 ml-8 mr-4",disabled:D}),(0,r.jsx)(C,{handleClick:B,buttonText:"None",buttonColor:"bg-gray-100",otherFormatting:"m-1 ml-4 mr-8",disabled:D})]})]}),(0,r.jsx)("div",{className:"flex flex-row w-[900px]outline-purple-300 justify-center ",children:(0,r.jsx)("div",{className:"ml-[330px]",children:(0,r.jsx)(JG,{clearAllCheckboxes:B})})}),(0,r.jsxs)("div",{className:"flex flex-col items-centeroutline-green-400",children:[(0,r.jsxs)("div",{className:"flex flex-row w-[900px",children:[(0,r.jsx)("p",{className:"mt-4 text-left",children:"Default sort is by factor group FG highest loading factor"}),(0,r.jsx)("p",{className:"mt-4 text-left ml-24",children:"Click the column headers to resort"})]}),(0,r.jsx)("div",{id:"loadingsTableContainer",style:M,className:"ag-theme-fresh border border-gray-400",children:(0,r.jsx)(EO,{id:"loadingsTable",columnDefs:a,animateRows:!0,rowData:s,getRowClass:function(e){return e.data.highlightingClass},onGridReady:function(e){P.current=e.api},onCellClicked:function(){var e=G();u(e),m(!1),w(!1),b(!1),S(!1),E(!1),k(!1),x(!1)},onCellFocused:function(){d("bg-orange-300")},gridOptions:{suppressRowHoverHighlight:!1,columnHoverHighlight:!0},ref:A,scrollbarWidth:"10"})})]}),(0,r.jsxs)("div",{className:"flex flex-row justify-centeroutline-blue-300 space-x-4 w-[910px]",children:[(0,r.jsx)(C,{buttonId:"generateOutputButton",handleClick:function(){var e=G(),t=a.map((function(e){return e.field})).filter(F);t.shift();var n=t.map((function(e){return e.slice(6)}));m(!0),$G(e),DM.success("Data sent to Output",{position:DM.POSITION.TOP_RIGHT,autoClose:5e3}),UL.setState({notifyDataSentToOutputSuccess:!1}),setTimeout((function(){T(n)}),100),d("bg-green-300"),v(!0)},buttonText:"Send Table Data to Output",buttonColor:i,otherFormatting:"m-1 ml-4 mr-[300px]"}),(0,r.jsx)(YG,{handleClick:function(){var e=G();f(!0),h(e);var t,n=tB();void 0!==n&&(t=n,DM.success("Factor ".concat(t," Inverted"),{position:DM.POSITION.TOP_RIGHT,autoClose:5e3}),UL.setState({notifyDataSentToOutputSuccess:!1}))}}),(0,r.jsx)(ZG,{handleClick:function(){var e=G();h(e);var t=eB();c(t[0]),A.current.api.setColumnDefs(t[0]),P.current.setRowData(t[1])}})]})]})})},oB=function(){return UL().showLoadingsTable?(0,r.jsx)("div",{className:"flex flex-row justify-center",children:(0,r.jsx)(iB,{})}):null},aB=function(){return jO().showSections45?(0,r.jsxs)("div",{className:"flex flex-col items-center bg-blue-100 rounded-md p-6",children:[(0,r.jsx)(UG,{}),(0,r.jsx)("div",{className:"w-full justify-center bg-gray-300 p-8 rounded-md",children:(0,r.jsx)(oB,{})})]}):null},sB=function(){return(0,r.jsx)("div",{className:"my-7",children:(0,r.jsx)("a",{href:"https://github.com/shawnbanasick/ken-q-analysis/wiki/6.-OUTPUT",target:"_blank",rel:"noopener noreferrer",style:{targetNew:"tab"},children:(0,r.jsx)(V,{buttonId:"section6HelpButton",buttonText:"Help - Section 6"})})})},lB=function(){return(0,r.jsx)("div",{className:"m-8 w-10/12",children:(0,r.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,r.jsx)("div",{className:"flex flex-row",children:(0,r.jsx)("p",{className:"text-6xl my-4",children:"6. Analysis Output"})}),(0,r.jsx)(sB,{})]})})},uB=function(t){var n=Y((0,e.useState)(t.value),2),i=n[0],o=n[1],a=Y((0,e.useState)(!1),2),s=a[0],l=a[1],u=qL(),c=u.factorVizOptionsHolder,d=u.setFactorVizOptionsHolder,h=u.setUpdateFactorVisualizationsButtonColor,f="Lower Limit".concat(": ",t.lowerLimit,", ","Upper Limit",": ").concat(t.upperLimit);return(0,r.jsxs)("div",{className:"flex flex-row w-[400px]",children:[(0,r.jsx)("input",{type:"number",placeholder:t.placeholder,name:t.name,step:t.step,value:i,onChange:function(e){var n=e.target.value;if(isNaN(n))return null;var r=t.name;l(!1);var i=t.upperLimit;n<t.lowerLimit||n>i?(o(n),l(!0)):(o(n),c[r]=n,d(c),h("bg-orange-300 hover:bg-orange-400"))},className:"color-black cursor-pointer mb-0 w-[60px] rounded-md box-border h-[25px] border-[1px] border-gray-500 box-shadow-none outline-none transition-0.15s text-align-center hover:outline-none hover:bg-none hover:box-shadow-none pl-2"}),s?(0,r.jsx)("div",{className:"ml-1 pt-[4px] pl-1 pr-1 bg-red-100 h-[25px] w-auto text-black-900 ",children:f}):null]})},cB=function(){return(0,r.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:(0,r.jsx)("path",{d:"M9.9 2.12L7.78 0 4.95 2.828 2.12 0 0 2.12l2.83 2.83L0 7.776 2.123 9.9 4.95 7.07 7.78 9.9 9.9 7.776 7.072 4.95 9.9 2.12",fill:"#000",fillRule:"evenodd"})})},dB=function(){return(0,r.jsx)("svg",{width:"14",height:"11",viewBox:"0 0 14 11",children:(0,r.jsx)("path",{d:"M11.264 0L5.26 6.004 2.103 2.847 0 4.95l5.26 5.26 8.108-8.107L11.264 0",fill:"#000",fillRule:"evenodd"})})},hB=n(729),fB=function(t){var n=Y((0,e.useState)(t.toggle),2),i=n[0],o=n[1],a=qL(),s=a.factorVizOptionsHolder,l=a.setFactorVizOptionsHolder,u=a.setUpdateFactorVisualizationsButtonColor;return(0,r.jsx)("div",{className:"flex flex-row justify-center mr-2",children:(0,r.jsx)(hB.Z,{id:t.name,name:t.name,defaultChecked:t.toggle,onChange:function(e){return function(e){e.stopPropagation();var n=!i,r=t.value;s[r]=n,o(n),l(s),u("bg-orange-300")}(e)},icons:{checked:(0,r.jsx)(dB,{}),unchecked:(0,r.jsx)(cB,{})}})})},pB={width:150},vB=function(){return(0,r.jsxs)("div",{style:{marginTop:30},children:[(0,r.jsx)("span",{style:{fontSize:22,userSelect:"none"},children:"Cards"}),(0,r.jsx)("hr",{className:"w-full mb-6 border border-gray-700"}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"4. ".concat("Adjust card height","?")}),(0,r.jsx)(fB,{name:"willAdjustCardHeight",value:"willAdjustCardHeight",toggle:!1}),(0,r.jsx)("div",{style:pB,children:(0,r.jsx)(uB,{name:"willAdjustCardHeightBy",lowerLimit:15,upperLimit:500,value:110})})]}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"5. ".concat("Adjust card width","?")}),(0,r.jsx)(fB,{name:"willAdjustCardWidth",value:"willAdjustCardWidth",toggle:!1}),(0,r.jsx)("div",{style:pB,children:(0,r.jsx)(uB,{name:"willAdjustCardWidthBy",lowerLimit:15,upperLimit:500,value:110})})]}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"6. ".concat("Adjust font size","?")}),(0,r.jsx)(fB,{name:"willAdjustCardFontSize",value:"willAdjustCardFontSize",toggle:!1}),(0,r.jsx)("div",{style:pB,children:(0,r.jsx)(uB,{name:"willAdjustCardFontSizeBy",lowerLimit:5,upperLimit:80,value:13})})]})]})},gB=function(t){var n=qL(),i=n.factorVizOptionsHolder,o=n.setFactorVizOptionsHolder,a=n.setUpdateFactorVisualizationsButtonColor,s=Y((0,e.useState)("#d9effe"),2),l=s[0],u=s[1];return console.log("color: ",l),(0,r.jsx)("input",{id:t.id,type:"color",defaultValue:t.defaultColor,onChange:function(e){u(e.target.value);var t=e.target.id;i[t]=e.target.value,o(i),a("bg-orange-300")}})},mB=function(){var e=qL(),t=e.showDistinguishingAs,n=e.factorVizOptionsHolder,i=e.setShowDistinguishingAs,o=e.setFactorVizOptionsHolder,a=e.setUpdateFactorVisualizationsButtonColor;function s(e){var t=e.target.value;i(t),n.showDistinguishingAs=t,o(n),a("bg-orange-300")}return(0,r.jsxs)("div",{style:{marginTop:30},children:[(0,r.jsx)("span",{style:{fontSize:22,userSelect:"none"},children:"Distinguishing and Consensus Statements"}),(0,r.jsx)("hr",{className:"w-full mb-6 border border-gray-700"}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"12. ".concat("Indicate distinguishing","?")}),(0,r.jsx)(fB,{name:"willIndicateDistinguishing",value:"willIndicateDistinguishing",toggle:!0}),(0,r.jsx)("div",{children:(0,r.jsxs)("form",{className:"flex flex-row justify-center",children:[(0,r.jsx)("p",{className:"ml-2 mr-3",children:"with"}),(0,r.jsxs)("label",{className:"mr-4",children:[(0,r.jsx)("input",{type:"radio",name:"radioGroup1",value:"symbol",checked:"symbol"===t,onChange:s})," ","Symbol"]}),(0,r.jsxs)("label",{className:"mr-2",children:[(0,r.jsx)("input",{type:"radio",name:"radioGroup1",value:"distinguishingColor",checked:"distinguishingColor"===t,onChange:s})," ","Color - 05:"]})]})}),(0,r.jsx)(gB,{id:"distinguishingIndicator05",style:{marginLeft:5},defaultColor:"#ededed"}),(0,r.jsx)("div",{className:"text-base select-none ml-[5px] mr-[5px]",children:"01:"}),(0,r.jsx)(gB,{id:"distinguishingIndicator01",style:{marginLeft:5},defaultColor:"#bdbdbd"})]}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none pl-[10px]",children:"-- ".concat("Adjust distinguishing statement indicator size","?")}),(0,r.jsx)(fB,{name:"willAdjustDistIndicatorSize",value:"willAdjustDistIndicatorSize",toggle:!1}),(0,r.jsx)("div",{children:(0,r.jsx)(uB,{name:"willAdjustDistIndicatorSizeBy",lowerLimit:1,upperLimit:200,value:12,step:.5})})]}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none pl-[10px]",children:"-- ".concat("Display distinguishing statement comparison triangles","?")}),(0,r.jsx)(fB,{name:"willDisplayDistingCompareSymbols",value:"willDisplayDistingCompareSymbols",toggle:!0})]}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"13. ".concat("Display consensus statement indicator color","?")}),(0,r.jsx)(fB,{name:"willDisplayConsensusStates",value:"willDisplayConsensusStates",toggle:!1}),(0,r.jsx)("div",{className:"text-base select-none pl-[10px] mr-[10px]",children:"Color".concat(": ")}),(0,r.jsx)(gB,{id:"consensusIndicator",defaultColor:"#d9effe"})]})]})},yB=function(){return(0,r.jsxs)(e.Fragment,{children:[(0,r.jsx)("span",{className:"text-xl select-none",children:"General"}),(0,r.jsx)("hr",{className:"w-full mb-6 border border-gray-700"}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"1. ".concat("Include legend with visualization","?")}),(0,r.jsx)(fB,{name:"willIncludeLegend",value:"willIncludeLegend",toggle:!0})]}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"2. ".concat("Prepend statement numbers","?")}),(0,r.jsx)(fB,{name:"willPrependStateNums",value:"willPrependStateNums",toggle:!1})]}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"3. ".concat("Display only statement numbers","?")}),(0,r.jsx)(fB,{name:"willDisplayOnlyStateNums",value:"willDisplayOnlyStateNums",toggle:!1})]})]})},wB=function(){return(0,r.jsxs)("div",{className:"mt-[30px]",children:[(0,r.jsx)("p",{className:"text-xl select-none",children:"Statements"}),(0,r.jsx)("hr",{className:"w-full mb-6 border border-gray-700"}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"7. ".concat("Adjust line spacing","?")}),(0,r.jsx)(fB,{name:"willAdjustLineSpacing",value:"willAdjustLineSpacing",toggle:!1}),(0,r.jsx)("div",{className:"w-[150px]",children:(0,r.jsx)(uB,{name:"willAdjustLineSpacingBy",step:"0.1",lowerLimit:.1,upperLimit:10,value:1.4})})]}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"8. ".concat("Adjust top margin","?")}),(0,r.jsx)(fB,{name:"willAdjustTopMargin",value:"willAdjustTopMargin",toggle:!1}),(0,r.jsx)("div",{className:"w-[150px]",children:(0,r.jsx)(uB,{name:"willAdjustTopMarginBy",lowerLimit:5,upperLimit:80,value:15})})]}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"9. ".concat("Limit number of lines to prevent overflow","?")}),(0,r.jsx)(fB,{name:"willTrimStatement",value:"willTrimStatement",toggle:!0}),(0,r.jsx)("div",{className:"text-base select-none",children:"max num lines".concat(" =  ")}),(0,r.jsx)("div",{className:"w-[150px]",children:(0,r.jsx)(uB,{name:"willTrimStatementBy",lowerLimit:1,upperLimit:20,value:5})})]}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"10. ".concat("Adjust statement width","?")}),(0,r.jsx)(fB,{name:"willAdjustStatementWidth",value:"willAdjustStatementWidth",toggle:!1}),(0,r.jsx)("div",{className:"w-[150px]",children:(0,r.jsx)(uB,{name:"willAdjustStatementWidthBy",lowerLimit:5,upperLimit:200,value:15})})]}),(0,r.jsxs)("div",{className:"flex items-center mb-[12px] pl-[10px]",children:[(0,r.jsx)("div",{className:"text-base select-none",children:"11. (".concat("Asian languages only",") ","Adjust width of statement rows","?")}),(0,r.jsx)(fB,{name:"willAdjustWidthAsian",value:"willAdjustWidthAsian",toggle:!1}),(0,r.jsx)("div",{className:"w-[150px]",children:(0,r.jsx)(uB,{name:"willAdjustWidthAsianBy",lowerLimit:1,upperLimit:200,value:12})})]})]})},bB=function(){return qL().shouldDisplayFactorVizOptions?(0,r.jsxs)("div",{style:{width:"90%",maxWidth:920,height:970,border:"2px solid #666",padding:20,marginLeft:20,marginBottom:50},className:"FactorVizDiv",children:[(0,r.jsx)(yB,{}),(0,r.jsx)(vB,{}),(0,r.jsx)(wB,{}),(0,r.jsx)(mB,{})]}):null};var CB=function(e){return(0,r.jsx)("g",{children:function(e){var t=e.factorVizOptions.consensusIndicator,n=e.factorVizOptions.distinguishingIndicator05,i=e.factorVizOptions.distinguishingIndicator01,o=function(e){var t=110*e.positionData.instances.length;return!0===e.factorVizOptions.willAdjustCardWidth&&(t=e.positionData.instances.length*e.factorVizOptions.willAdjustCardWidthBy),t/2}(e),a=function(e){var t=qL.getState().maxColumnHeight,n=110*t+100;return!0===e.factorVizOptions.willAdjustCardHeight?t*e.factorVizOptions.willAdjustCardHeightBy+100:n}(e)+5,s=e.factorVizOptions.showDistinguishingAs,l=e.factorVizOptions.willDisplayConsensusStates,u=e.factorVizOptions.willIndicateDistinguishing,c=e.factorVizOptions.willDisplayDistingCompareSymbols;!1===u&&(c=!1);var h=170;!1===u&&(h-=55),!1===c&&(h-=60);var f=260,p={x:o,y:a+30,fontSize:26,fontWeight:"normal",textAnchor:"middle",fontFamily:"Arial, sans-serif"},v={x:o-f+12,y:a+65,fontSize:16,fontFamily:"Arial, sans-serif"},g={x:o-f+12,y:a+95,fontSize:16,fontFamily:"Arial, sans-serif"},m={x:o-f+30,y:a+65,fontSize:16,fontFamily:"Arial, sans-serif"},y={x:o-f+30,y:a+95,fontSize:16,fontFamily:"Arial, sans-serif"},w={x:o-f+30,y:a+125,fontSize:16,fontFamily:"Arial, sans-serif"},b={x:o-f+9,y:a+155,fontSize:16,fontFamily:"Arial, sans-serif"},C={x:o-f+30,y:a+155,fontSize:16,fontFamily:"Arial, sans-serif"},S={x:o-f+9,y:a+125,fontSize:16,fontFamily:"Arial, sans-serif"},E={x:o-f+9,y:a+h,width:15,height:15,fill:t,stroke:"black",strokeWidth:1},k={x:o-f+9,y:a+81,width:15,height:15,fill:i,stroke:"black",strokeWidth:1},x={x:o-f+9,y:a+51,width:15,height:15,fill:n,stroke:"black",strokeWidth:1},T={x:o-f+30,y:a+14+h,fontSize:16,fontFamily:"Arial, sans-serif"};return"symbol"===s?(0,r.jsxs)("g",{children:[(0,r.jsx)("text",d(d({},p),{},{children:"Legend"})),u&&(0,r.jsxs)("g",{children:[(0,r.jsx)("text",d(d({},v),{},{children:"*"})),(0,r.jsxs)("text",d(d({},m),{},{children:["Distinguishing statement at"," P","<"," 0.05"]})),(0,r.jsx)("text",d(d({},g),{},{children:"**"})),(0,r.jsxs)("text",d(d({},y),{},{children:["Distinguishing statement at"," P","<"," 0.01"]}))]}),c&&(0,r.jsxs)("g",{children:[(0,r.jsx)("text",d(d({},S),{},{children:"\u25ba "})),(0,r.jsx)("text",d(d({},w),{},{children:"Z-score for the statement is higher than in all other factors"})),(0,r.jsx)("text",d(d({},b),{},{children:"\u25c4 "})),(0,r.jsx)("text",d(d({},C),{},{children:"Z-score for the statement is lower than in all other factors"}))]}),l&&(0,r.jsx)("rect",d({},E)),l&&(0,r.jsx)("text",d(d({},T),{},{children:"Consensus Statements"}))]}):(0,r.jsxs)("g",{children:[(0,r.jsx)("text",d(d({},p),{},{children:"Legend "})),u&&(0,r.jsxs)("g",{children:[(0,r.jsx)("rect",d({},x)),(0,r.jsxs)("text",d(d({},m),{},{children:["Distinguishing statement at"," P","<"," 0.05"]})),(0,r.jsx)("rect",d({},k)),(0,r.jsxs)("text",d(d({},y),{},{children:["Distinguishing statement at"," P","<"," 0.01"]}))]}),c&&(0,r.jsxs)("g",{children:[(0,r.jsx)("text",d(d({},S),{},{children:"\u25ba "})),(0,r.jsx)("text",d(d({},w),{},{children:"zScore for the statement is higher than in all other factors"})),(0,r.jsx)("text",d(d({},b),{},{children:"\u25c4 "})),(0,r.jsx)("text",d(d({},C),{},{children:"zScore for the statement is lower than in all other factors"}))]}),l&&(0,r.jsx)("rect",d({},E)),l&&(0,r.jsx)("text",d(d({},T),{},{children:"Consensus Statements"}))]})}(e)})},SB={fontSize:12,stroke:"none",zindex:9999,fill:"black"},EB=function(e){var t=e.factorVizOptions.willDisplayDistingCompareSymbols,n=e.factorVizOptions.willAdjustDistIndicatorSizeBy,i=function(e){return!0===e.factorVizOptions.willAdjustCardWidth?e.factorVizOptions.willAdjustCardWidthBy:110}(e),o=function(e){if(!0===e.factorVizOptions.willAdjustCardHeight){var t=e.factorVizOptions.willAdjustCardHeightBy;return t<60&&(t=60),t}return 110}(e);return function(a,s){var l;l=t?e.data[s].sigVisualizationUni+e.data[s].directionSymbolUni:e.data[s].sigVisualizationUni;var u={x:e.positionData.xPosLoop[s]*i+10,y:e.positionData.yPosLoop[s]*o+26+42+1.7*n,key:e.positionData.numRectsArray[s],text:l,textAnchor:"left",fontSize:n};return(0,r.jsx)("text",d(d(d({},SB),u),{},{children:u.text}))}},kB=function(e){return(0,r.jsx)("g",{children:e.data.map(EB(e))})},xB={stroke:"none",zindex:99,fontFamily:"Arial, sans-serif",fill:"black"},TB=function(e){return!0===e.factorVizOptions.willAdjustCardWidth?e.factorVizOptions.willAdjustCardWidthBy:110},RB=function(e){if(!0===e.factorVizOptions.willAdjustCardHeight){var t=e.factorVizOptions.willAdjustCardHeightBy;return isNaN(t||t<60)&&(t=60),t}return 110},AB=function(e){return!0===e.factorVizOptions.willAdjustTopMargin?+e.factorVizOptions.willAdjustTopMarginBy:15},_B=qL.getState().titleHeight,OB=function(e,t,n){var r,i=[],o=0;if(!0===n.willAdjustWidthAsian){var a=n.willAdjustWidthAsianBy;i=e.match(new RegExp(".{1,".concat(a,"}"),"g"))}else{var s=new RegExp(".{0,".concat(t,"}(?:\\s|$)"),"g");do{var l;r=s.exec(e),(l=i).push.apply(l,wt(r)),o+=1}while(0!==r[0].length&&15!==o)}var u=i.filter(String);if(!0===n.willTrimStatement){var c=n.willTrimStatementBy||5;u.length=c}return u};function DB(e,t,n){var i="1.4em";if(!0===n.willAdjustLineSpacing){var o=n.willAdjustLineSpacingBy;i="".concat(o,"em")}var a=1;return e.map((function(e){return(0,r.jsx)("tspan",{dy:i,x:t,textAnchor:"middle",children:e},a++)}))}var NB=function(e){var t=13;return!0===e.factorVizOptions.willAdjustCardFontSize&&(t=e.factorVizOptions.willAdjustCardFontSizeBy),function(n,i){var o,a=15;!0===e.factorVizOptions.willAdjustStatementWidth&&(a=e.factorVizOptions.willAdjustStatementWidthBy);var s=e.factorVizOptions.willDisplayOnlyStateNums,l=e.factorVizOptions.willPrependStateNums;o=OB(!0===s?e.data[i].statement:!0===l?e.data[i].sortStatementAndNums:e.data[i].sortStatement,a,e.factorVizOptions);var u=e.positionData.xPosLoop[i]*TB(e)+TB(e)/2,c={x:e.positionData.xPosLoop[i]*TB(e)+TB(e)/2,y:e.positionData.yPosLoop[i]*RB(e)+20+AB(e)+_B,key:e.positionData.numRectsArray[i],text:DB(o,u,e.factorVizOptions),textAnchor:"left",fontSize:t};return(0,r.jsx)("text",d(d(d({},xB),c),{},{children:c.text}))}},PB=function(e){return(0,r.jsx)("g",{children:e.data.map(NB(e))})},FB={stroke:"black",strokeWidth:.5,zindex:99},IB=function(e){return!0===e.factorVizOptions.willAdjustCardWidth?e.factorVizOptions.willAdjustCardWidthBy:110},LB=function(e){if(!0===e.factorVizOptions.willAdjustCardHeight){var t=e.factorVizOptions.willAdjustCardHeightBy;return isNaN(t||t<60)&&(t=60),t}return 110},MB=qL.getState().titleHeight,GB=function(e){return function(t,n){var i=qL.getState().factorVizOptions,o=i.willDisplayConsensusStates,a=i.willIndicateDistinguishing,s=i.showDistinguishingAs,l=i.consensusIndicator,u=i.distinguishingIndicator01,c=i.distinguishingIndicator05,h="white";!0===a&&"distinguishingColor"===s&&(!0===e.data[n].isDistinguishing01&&(h=u),!0===e.data[n].isDistinguishing05&&(h=c)),!0===o&&(e.data[n].isConsensus01State&&(h=l),e.data[n].isConsensus05State&&(h=l));var f={x:e.positionData.xPosLoop[n]*IB(e),y:e.positionData.yPosLoop[n]*LB(e)+26+MB,width:IB(e),height:LB(e),key:e.positionData.numRectsArray[n],fill:h};return(0,r.jsx)("rect",d(d({},FB),f))}},BB=function(e){return(0,r.jsx)("g",{children:e.positionData.numRectsArray.map(GB(e))})},jB={fill:"white",stroke:"black",strokeWidth:.5,zindex:99},HB=function(e){var t=50,n=e.factorVizOptions.willDisplayConsensusStates,r=e.factorVizOptions.willIndicateDistinguishing;return!0===r&&(t+=100),!0===e.factorVizOptions.willDisplayDistingCompareSymbols&&(t+=50),!0===n&&(t+=10),!1===r&&!0===n&&(t+=40),t},VB=function(e){var t=110*e.positionData.instances.length;return!0===e.factorVizOptions.willAdjustCardWidth&&(t=e.positionData.instances.length*e.factorVizOptions.willAdjustCardWidthBy),t/2-300},WB=function(e){var t=qL.getState().maxColumnHeight,n=110*t+100;return!0===e.factorVizOptions.willAdjustCardHeight?t*+e.factorVizOptions.willAdjustCardHeightBy+100:n},zB=function(e){O(n,e);var t=F(n);function n(){var e;return T(this,n),(e=t.call(this)).renderLegendRectangle=e.renderLegendRectangle.bind(P(e)),e}return A(n,[{key:"renderLegendRectangle",value:function(e){var t={x:VB(e),y:WB(e),width:600,height:HB(e)};return(0,r.jsx)("rect",d(d({},jB),t))}},{key:"render",value:function(){return(0,r.jsx)("g",{children:this.renderLegendRectangle(this.props)})}}]),n}(e.Component),UB=zB,KB={fontSize:28,fill:"black",stroke:"none",zindex:99,fontFamily:"Verdana, sans-serif"},qB={x:0,y:20,textAnchor:"left"},XB=function(e){return(0,r.jsx)("g",{children:(0,r.jsx)("text",d(d(d({},KB),qB),{},{children:e.name}))})},YB={fill:"white",stroke:"black",strokeWidth:1,zindex:99},QB=qL.getState().titleHeight,ZB=function(e){return!0===e.factorVizOptions.willAdjustCardWidth?e.factorVizOptions.willAdjustCardWidthBy:110},JB=function(e){return function(t,n){var i={x:n*ZB(e),y:0+QB,width:ZB(e),height:26,key:e.positionData.numRectsArray[n]};return(0,r.jsx)("rect",d(d({},YB),i))}},$B=function(e){return(0,r.jsx)("g",{children:e.positionData.uniques.map(JB(e))})},ej={fill:"black",stroke:"none",fontWeight:"bold",zindex:99},tj=function(e){return!0===e.factorVizOptions.willAdjustCardWidth?e.factorVizOptions.willAdjustCardWidthBy:110},nj=qL.getState().titleHeight,rj=function(e){return function(t,n){var i={x:n*tj(e)+tj(e)/2,y:20+nj,key:e.positionData.uniques[n],text:e.positionData.uniques[n],textAnchor:"middle"};return(0,r.jsx)("text",d(d(d({fontFamily:"arial"},ej),i),{},{children:i.text}))}},ij=function(e){return(0,r.jsx)("g",{children:e.positionData.uniques.map(rj(e))})},oj=function(t){var n=Y((0,e.useState)("bg-gray-100 hover:bg-gray-400"),2),i=n[0],o=n[1],a=Y((0,e.useState)("bg-gray-100 hover:bg-gray-400"),2),s=a[0],l=a[1];return(0,r.jsxs)("div",{style:{display:"flex"},children:[(0,r.jsx)(Mv,{buttonId:"downloadSvgButtonFacViz".concat(t.id),handleClick:function(){return function(e){var t,n=qL.getState().factorVizOptions,r=n.willAddCustomNameToDownload,i="#image".concat(e),a=y.getState().projectName,s=NL(),l=PL(),u="".concat(s,"_").concat(l),c="".concat(e),d=n.customDownloadFileNames,h=n.customFileNameLocation;t=!0===r?"prepend"===h?{filename:"".concat(d,"_").concat(a,"_").concat(c,"_").concat(u)}:"append"===h?{filename:"".concat(a,"_").concat(c,"_").concat(u,"_").concat(d)}:"replace"===h?{filename:d}:{filename:"".concat(a,"_").concat(c,"_").concat(u)}:{filename:"".concat(a,"_").concat(c,"_").concat(u)},function(e,t){e.setAttribute("xmlns","http://www.w3.org/2000/svg");var n=e.outerHTML,r=new Blob(['<?xml version="1.0" standalone="no"?>\r\n',n],{type:"image/svg+xml;charset=utf-8"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o)}(document.querySelector(i),t.filename),o("bg-green-300 hover:bg-green-400")}(t.id)},buttonText:"Download SVG",otherFormatting:"mr-2 ml-6",buttonColor:i}),(0,r.jsx)(Mv,{buttonId:"downloadPngButtonFacViz".concat(t.id),handleClick:function(){return function(e){var t,n=qL.getState().factorVizOptions,r=n.willAddCustomNameToDownload,i="image".concat(e),o=y.getState().projectName,a=NL(),s=PL(),u="".concat(a,"__").concat(s),c=n.customDownloadFileNames,d=n.customFileNameLocation,h="".concat(e,"__");t=!0===r?"prepend"===d?"".concat(c,"_").concat(o,"_").concat(h).concat(u):"append"===d?"".concat(o,"__").concat(h).concat(u,"_").concat(c):"replace"===d?c:"".concat(o,"__").concat(h).concat(u):"".concat(o,"__").concat(h).concat(u),(0,IL.saveSvgAsPng)(document.getElementById(i),t,{encoderOptions:1}),l("bg-green-300 hover:bg-green-400")}(t.id)},buttonText:"Download PNG",otherFormatting:"mr-2",buttonColor:s})]})},aj=function(e){var t,n,r=e.positionData,i=e.factorVizOptions.willAdjustCardWidth,o=e.factorVizOptions.willAdjustCardHeight,a=Math.max.apply(Math,wt(r.instances));!0===o?t=385+e.factorVizOptions.willAdjustCardHeightBy*a:t=145*a+250;!0===i?n=40+e.factorVizOptions.willAdjustCardWidthBy*r.uniques.length:n=125*r.uniques.length;return!1===e.factorVizOptions.willIncludeLegend&&(t-=250),{margin:"0 auto",textAlign:"center",width:n,height:t,marginBottom:250}},sj=function(e){var t=e.factorVizOptions.willIndicateDistinguishing,n=e.factorVizOptions.showDistinguishingAs,i=!1;t&&"symbol"===n&&(i=!0);var o=e.factorVizOptions.willIncludeLegend,a=10,s=50,l=10,u=10;return(0,r.jsxs)("div",{className:"flex flex-col items-center",style:aj(e),children:[(0,r.jsx)("svg",{className:"vizImage",id:"image".concat(e.id),width:aj(e).width-s-u,height:aj(e).height-a-l,children:(0,r.jsxs)("g",{transform:"translate(".concat(s,",").concat(a,")"),children:[(0,r.jsx)(XB,d({},e)),(0,r.jsx)($B,d({},e)),(0,r.jsx)(ij,d({},e)),(0,r.jsx)(BB,d({},e)),(0,r.jsx)(PB,d({},e)),i&&(0,r.jsx)(kB,d({},e)),o&&(0,r.jsx)(UB,d({},e)),o&&(0,r.jsx)(CB,d({},e))]})}),(0,r.jsx)(oj,d({},e))]})},lj=function(e,t){var n,r,i=0;for(n=0,r=e.length;n<r;n++)e[n]===t&&i++;return i},uj=function(){for(var e=y.getState().qSortPattern,t=[],n=0;n<e.length;n++)t.push(n+1);for(var r=mt()(e),i=[],o=0;o<r.length;o++){var a=lj(e,r[o]);i.push(a)}var s=Math.max.apply(Math,i);qL.setState({maxColumnHeight:s});for(var l=[],u=0,c=0;c<i.length;c++){for(var d=0;d<i[c];d++)l.push(u);u+=1}for(var h,f=[],p=0;p<i.length;p++){h=0;for(var v=0;v<i[p];v++)f.push(h),h+=1}var g={instances:i,xPosLoop:l,yPosLoop:f,numRectsArray:t,uniques:r};return qL.setState({positionData:g}),g},cj=function(){var e=qL.getState().outputForDataViz;e.length;for(var t=0;t<e.length;t+=1)for(var n=0;n<e[t].length;n+=1){var r=e[t][n].statement,i=e[t][n].sortStatement;e[t][n].sortStatementAndNums="".concat(r,". ").concat(i)}for(var o=0;o<e.length;o+=1)e[o].sort((function(e,t){return e.sortValue>t.sortValue?1:e.sortValue<t.sortValue?-1:e.zScore<t.zScore?1:e.zScore>t.zScore?-1:0}));return e},dj=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},hj=function(e){var t,n=qL.getState().userSelectedFactors,r=uj(),i=n.length,o=cj(),a=[],s=e.willAddCustomNames;if(s){var l=e.customFactorNames;t=0!==l.length?l.split(","):[]}for(var u=0;u<i;u+=1){var c=void 0,d=dj(n[u]),h=d.slice(-2).trim(),f=d.replace(/\s+/g,"");s&&void 0!==(c=t[u])&&""!==c||(c="Composite Q Sort for Factor".concat(" ",h));var p={};p.name=c,p.id=f,p.data=o[u],p.positionData=r,p.factorVizOptions=e,p.shouldUseUnicode=e.shouldUseUnicode,p.willDisplayDistingCompareSymbols=e.willDisplayDistingCompareSymbols,p.willAdjustIndicatorSizeBy=e.willAdjustIndicatorSizeBy,a.push(p)}return a},fj={width:"100%",height:1200,padding:30,margin:10},pj=function(){var t=qL(),n=t.factorVizOptions,i=t.displayFactorVisualizations,o=Y((0,e.useState)([]),2),a=o[0],s=o[1],l=(0,e.useCallback)(At(Tt().mark((function e(){var t;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=hj(n),s(t);case 2:case"end":return e.stop()}}),e)}))),[n]);return(0,e.useEffect)((function(){l()}),[l]),i?(0,r.jsx)("div",{children:a.map((function(e,t){return(0,r.jsx)("div",{children:(0,r.jsx)(sj,d(d({},a[t]),fj),"viz".concat(t))},"fact".concat(t.toString()))}))}):null},vj=function(){var e=At(Tt().mark((function e(t,n,r){var i,o,a,s,l,u,c,d,h,f,p,v,g,m,w;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(p=function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r+=1)n[r]=255&e.charCodeAt(r);return t},u=function(){if(!(this instanceof u))return new u;this.SheetNames=[],this.Sheets={}},l=function(e){for(var t={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!==e.length;++r)for(var i=0;i!==e[r].length;++i){n.s.r>r&&(n.s.r=r),n.s.c>i&&(n.s.c=i),n.e.r<r&&(n.e.r=r),n.e.c<i&&(n.e.c=i);var o={v:e[r][i]};if(null!==o.v){var a=ep.encode_cell({c:i,r:r});"number"===typeof o.v?o.t="n":"boolean"===typeof o.v?o.t="b":o.v instanceof Date?(o.t="n",o.z=Qn._table[14],o.v=ep.datenum(o.v)):o.t="s",t[a]=o}}return n.s.c<1e7&&(t["!ref"]=ep.encode_range(n)),t},i=y.getState().projectName,qL.getState().shouldIncludeTimestamp,o=t,a=n,s=r,c=new u,d=0;d<a.length;d+=1)(h=l(o[d]))["!cols"]=s[d],c.SheetNames.push(a[d]),c.Sheets[a[d]]=h;f=Vf(c,{bookType:"xlsx",bookSST:!0,type:"binary"}),v="".concat(NL(),"_").concat(PL()),!0,g="KenQ_results_".concat(i,"_").concat(v,".xlsx"),m=new Blob([p(f)],{type:"application/octet-stream"}),(w=document.createElement("a")).href=URL.createObjectURL(m),w.download=g,document.body.appendChild(w),w.click(),document.body.removeChild(w);case 21:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),gj=vj,mj=function(){var e=qL.getState().outputData,t=qL.getState().colSizes,n=qL.getState().sheetNamesXlsx;gj(e,n,t)},yj=function(){var t=qL().userSelectedFactors,n=Y((0,e.useState)("bg-gray-100 hover:bg-gray-400"),2),i=n[0],o=n[1];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Mv,{buttonText:"Excel File",buttonId:"downloadResultsAsExcelButton",buttonColor:i,handleClick:function(){0===t.length?window.DownloadResultsAsExcelModal.showModal():(mj(),o("bg-green-300 hover:bg-green-400"))},otherFormatting:"min-w-[100px] mr-[20px]"}),(0,r.jsx)("dialog",{id:"downloadResultsAsExcelModal",className:"modal",children:(0,r.jsxs)("form",{method:"dialog",className:"modal-box border-2 border-gray-600",children:[(0,r.jsx)("p",{className:"text-2xl text-bold",children:"Analysis Output Error"}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-2xl",children:"Select the factors to output first"})}),(0,r.jsx)("button",{className:"btn min-w-[100px] mr-[20px] modal-action bg-gray-200 hover:bg-gray-400 rounded-md",id:"downloadResultsAsExcelModalGotItButton",children:"Got it"})]})})]})},wj=function(){var e=At(Tt().mark((function e(t,n,r){var i,o,a,s,l,u;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=function(e){for(var t="",n=0,r=e.length;n<r;n+=1){var i=e[n];null!==i&&void 0!==i||(i="");var o=i.toString().replace(/"/g,'""');o.search(/("|,|\n)/g)>=0&&(o='"'.concat(o,'"')),n>0&&(t+=","),t+=o}return"".concat(t,"\n")},o="",a=0,s=n.length;a<s;a+=1)o+=i(n[a]);l=new Blob([o],{type:"text/".concat(r,";charset=utf-8;")}),(u=document.createElement("a")).href=URL.createObjectURL(l),u.download=t,document.body.appendChild(u),u.click(),document.body.removeChild(u);case 10:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),bj=wj,Cj=function(e){for(var t=y.getState().projectName,n=qL.getState().outputData,r=(qL.getState().shouldIncludeTimestamp,["","",""]),i=[],o=0,a=n.length;o<a;o++){for(var s=0,l=n[o].length;s<l;s++)i.push(n[o][s]);i.push(r,r,r,r,r,r)}i.shift();var u,c="".concat(NL(),"_").concat(PL());u="KADE_results_".concat(t,"_").concat(c,".").concat(e),bj(u,i,e)},Sj=function(){var t=qL().userSelectedFactors,n=Y((0,e.useState)("bg-gray-100 hover:bg-gray-400"),2),i=n[0],o=n[1];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Mv,{buttonText:"CSV File",buttonId:"downloadResultsAsCsvButton",buttonColor:i,handleClick:function(){0===t.length?window.DownloadResultsAsCsvModal.showModal():(Cj("csv"),o("bg-green-300 hover:bg-green-400"))},otherFormatting:"min-w-[100px] mr-[20px]"}),(0,r.jsx)("dialog",{id:"downloadResultsAsExcelModal",className:"modal",children:(0,r.jsxs)("form",{method:"dialog",className:"modal-box border-2 border-gray-600",children:[(0,r.jsx)("p",{className:"text-2xl",children:"Analysis Output"}),(0,r.jsx)("p",{style:{fontSize:30},children:"Select the factors to output first"}),(0,r.jsx)("button",{className:"btn min-w-[100px] mr-[20px] modal-action bg-gray-200 hover:bg-gray-400 rounded-md",id:"downloadResultsAsCsvModalGotItButton",children:"Got it"})]})})]})},Ej=function(){var t=qL().userSelectedFactors,n=Y((0,e.useState)("bg-gray-100 hover:bg-gray-400"),2),i=n[0],o=n[1];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Mv,{buttonText:"Text File",buttonId:"downloadResultsAsTxtButton",buttonColor:i,handleClick:function(){0===t.length?window.DownloadResultsAsCsvModal.showModal():(Cj("txt"),o("bg-green-300 hover:bg-green-400"))},otherFormatting:"min-w-[100px] mr-[20px]"}),(0,r.jsx)("dialog",{id:"downloadResultsAsExcelModal",className:"modal",children:(0,r.jsxs)("form",{method:"dialog",className:"modal-box border-2 border-gray-600",children:[(0,r.jsx)("p",{className:"text-2xl",children:"Analysis Output"}),(0,r.jsx)("p",{style:{fontSize:30},children:"Select the factors to output first"}),(0,r.jsx)("button",{className:"btn min-w-[100px] mr-[20px] modal-action bg-gray-200 hover:bg-gray-400 rounded-md",id:"downloadResultsAsCsvModalGotItButton",children:"Got it"})]})})]})},kj=function(){return qL().showDownloadOutputButtons?(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"flex flex-row items-center pl-9 pt-[20px] pb-[20px] w-[750px] h-[100px]",children:[(0,r.jsx)("div",{className:"text-2xl mr-[10px]",children:"Download output as"}),(0,r.jsx)(yj,{}),(0,r.jsx)(Sj,{}),(0,r.jsx)(Ej,{})]})}):null},xj=function(){var e=UL(),t=e.showNoLoadingsFlaggedWarningModal,n=e.setSendDataToOutputButtonColor,i=qL(),o=i.factorsWithoutLoading,a=i.setShowOutputFactorSelection,s=i.setShowFactorCorrelationsTable,l=i.setShowStandardErrorsDifferences,u=i.setShowFactorCharacteristicsTable,c=i.setShowDownloadOutputButtons,d=i.setShouldDisplayFactorVizOptions,h=i.setDisplayFactorVisualizations;return t&&window.noLoadingsFlaggedModal.showModal(),(0,r.jsxs)("dialog",{id:"noLoadingsFlaggedModal",className:"modal",children:[(0,r.jsx)("p",{className:"text-2xl",children:"Error Checking"}),(0,r.jsx)("form",{method:"dialog",className:"modal-box border-2 border-gray-600",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,r.jsx)("p",{className:"text-2xl font-bold mb-2",children:"Output Error"}),(0,r.jsx)("p",{className:"mb-4",children:"A factor without a flagged loading was selected."}),(0,r.jsxs)("span",{children:["Problem factors: ",o]}),(0,r.jsx)(rg,{buttonId:"noLoadingsFlaggedModalGotItButton",otherFormatting:"modal-action mt-6",handleClick:function(){a(!1),s(!1),l(!1),u(!1),c(!1),d(!1),h(!1),n("bg-gray-100")},buttonText:"Close"})]})})]})},Tj=function(){var e=qL(),t=e.userSelectedFactors,n=e.displayFactorVisualizations,i=e.showDownloadOutputButtons,o=e.setDisplayFactorVisualizations,a=!0;t.length<2&&(a=!1);return i&&a?(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)(C,{buttonId:"displayVisualizationsButton",handleClick:function(){o(!n)},buttonText:"Display Composite Factors",otherFormatting:"mr-2",buttonColor:"bg-gray-100 hover:bg-gray-400"})}):null},Rj=function(e,t,n,r,i,o,a,s,l,u){var c=u.sheetidTrans,d=u.projectNameTrans,h=u.numStatementsTrans,f=u.qSortDesignTrans,p=u.totalNumSortsTrans,v=u.distThreshold1Trans,g=u.distThreshold2Trans,m=u.analysisCompleteTrans,y=u.kadeVersionTrans,w=[c],b=[],C=["",""],S=[d,r];b.push(["overview",""],C,S,C);var E=[h,i];b.push(E,C);var k=[f,e.join()];b.push(k,C);var x=[p,o];b.push(x,C),b.push(C,[v,s]),b.push(C,[g,l]);var T="".concat(NL()," at ").concat(PL());b.push(C,[m,T]),b.push(C,t),b.push(C,[y,n],C),console.log("list",a[0]);for(var R=0;R<a.length;R++)b.push(["","".concat(R+1,". ").concat(a[R])]);var A=[];return A.push(b),console.log("dispatch - 1 - pushProjectOverview complete"),[A,w,[[{wch:40},{wch:70}]]]},Aj=function(){var e=y.getState().qSortPattern,t=UL.getState().autoFlagHistory,n=y.getState().version,r=y.getState().projectName,i=y.getState().numStatements.toString(),o=y.getState().numQsorts.toString(),a=y.getState().projectHistoryArray;console.log("list",a);var s=qL.getState().distStateUpperValueText,l=qL.getState().distStateLowerValueText,u="Project Name".concat(":  "),c="Total Number of Statements".concat(":  "),d="Q sort Design".concat(":  "),h="Total Number of Q sorts".concat(":  "),f="Project Log".concat(":  "),p="Distinguishing statements threshold 1".concat(":  "),v="Distinguishing statements threshold 2".concat(":  "),g="Analysis completed on".concat(":  "),m="KenQ Version Number".concat(":  ");return Rj(e,t,n,r,i,o,a,s,l,{sheetidTrans:"Project Overview",projectNameTrans:u,numStatementsTrans:c,qSortDesignTrans:d,totalNumSortsTrans:h,analsysProcessTrans:f,distThreshold1Trans:p,distThreshold2Trans:v,analysisCompleteTrans:g,kadeVersionTrans:m})},_j=function(e,t,n,r,i){var o=i.statementsTrans,a=i.statementNumTrans;t.push("statements");var s=[];s.push(["statements",""],["",""],[a,o]);for(var l=0,u=0,c=r.length;u<c;u++){var d=[];d.push(u+1,r[u]),s.push(d);var h=r[u].length;h>l&&(l=h)}e.push(s);var f=[{wch:10},{wch:l}];return n.push(f),[[e,t,n],l]},Oj=function(e,t,n){var r={statementsTrans:"Statements",statementNumTrans:"Statement Number"},i=y.getState().statements,o=_j(e,t,n,i,r);return qL.setState({maxStatementLength:o[1]}),console.log("dispatch - 2 - pushStatements complete"),o[0]},Dj=function(e){var t=e.reduce((function(e,t){return e+t}),0);return Zv(t/e.length,8)},Nj=function(e){var t=Dj(e),n=e.map((function(e){var n=e-t;return n*n})),r=n.reduce((function(e,t){return e+t}),0),i=Zv(r/(n.length-1),8);return Zv(Math.sqrt(i),8)},Pj=function(e,t,n){var r="Mean";t.push("Q sorts");for(var i=vt()(y.getState().mainDataObject),o=vt()(y.getState().respondentNames),a=[],s=[],l=[],u=0,c=i.length;u<c;u++){var d=i[u].rawSort,h=i[u].posShiftSort;s.push(d),l.push(h)}var f=vt()(s);qL.setState({posShiftSortArray:l}),qL.setState({sortsAsNumbers:f});for(var p,v,g=[{wch:15}],m=0,w=s[0].length+2;m<w;m++)g.push({wch:5});n.push(g);for(var b=["Participant"],C=0,S=s[0].length;C<S;C++)v="S".concat(C+1),b.push(v);b.push(r,"Standard Deviation"),a.push(["sorts",""],["",""],["Q sorts",""],["",""],b);for(var E=[["","Q sorts",r,"St Dev"]],k=0,x=s.length;k<x;k++){var T=[],R=k+1,A=Zv(Dj(s[k]),3);p=Zv(Nj(s[k]),3),s[k].unshift(o[k]),s[k].push(A,p),T.push(R,o[k],A,p),a.push(s[k]),E.push(T)}return e.push(a),qL.setState({freeDistributionArray:E}),console.log("dispatch - 3 - pushSorts complete"),[e,t,n]},Fj=function(e,t,n){t.push("Correlation Matrix");for(var r=vt()(Xv.getState().correlationTableArray),i=vt()(y.getState().respondentNames),o=0,a=r.length;o<a;o++)r[o].unshift(i[o]);for(var s=0,l=0,u=i.length;l<u;l++){var c=i[l].length;c>s&&(s=c)}s<5&&(s=5);for(var d=[],h=0,f=r[0].length+1;h<f;h++)d.push({wch:s});return n.push(d),i.unshift("Participant"),r.unshift(["correlations",""],["",""],["Correlations between Q sorts"],["",""],i),e.push(r),console.log("dispatch - 4 - pushCorrelations complete"),[e,t,n]},Ij=function(e,t,n){var r=vt()(jO.getState().unrotatedFactorMatrixOutput),i=vt()(jO.getState().eigenvalues),o=vt()(jO.getState().eigensPercentExpVar);t.push("Unrotated Factor Matrix");for(var a=[{wch:8},{wch:20}],s=r[0].length-2,l=0;l<s;l++)a.push({wch:8});n.push(a);var u=i.map((function(e,t){return!1===isNaN(e)?Zv(e,4):e}));return u.unshift(""),o.unshift(""),r.push(["",""],u,o),r.unshift(["unrotated",""],["",""],["Unrotated Factor Matrix"],["",""]),e.push(r),console.log("dispatch - 5 - pushUnrotatedFactorsTable complete"),[e,t,n]},Lj=function(e,t,n){t.push("Cumul Comm Matrix");for(var r=vt()(jO.getState().unrotatedFactorMatrixOutput),i=[{wch:12}],o=0,a=r[0].length;o<a;o++)i.push({wch:8});n.push(i);for(var s=r.shift(),l=0;l<r.length;l++)for(var u=2;u<r[l].length;u++)if(2===u){var c=r[l][u];r[l][u]=Zv(c*c,4)}else{var d=r[l][u];r[l][u]=Zv(d*d+r[l][u-1],4)}r.unshift(s);var h=jO.getState().cumulEigenPerVar;return h.splice(1,0,""),r.push(["",""],h),r.unshift(["cumulative",""],["",""],["Cumulative Communalities Matrix"],["",""]),e.push(r),console.log("dispatch - 6 - pushCumComMatrix complete"),[e,t,n]},Mj=function(e,t,n){var r=UL.getState().currentLoadingsTable;t.push("Factor Loadings"),r.sort((function(e,t){return e.resNum-t.resNum}));for(var i=[],o=qL.getState().userSelectedFactors,a=o.length,s=r.length,l=["Nm","Q sort"],u=wt(o),c=[],d=[],h=0;h<u.length;h++){var f=u[h].split(" "),p="check".concat(f[1]),v="factor".concat(f[1]),g="Factor".concat(" ",f[1]);l.push(g,""),d.push(p),c.push(v)}o=[].concat(c);for(var m=[],w=0;w<s;w++){var b=[],C=[];b.push(r[w].resNum,r[w].respondent);for(var S=0;S<a;S++){var E=c[S],k=d[S];b.push(r[w][E]),C.push(r[w][E]),!0===r[w][k]?b.push("Flagged"):b.push("")}i.push(b),m.push(C)}for(var x=jO.getState().factorMatrix,T=y.getState().numQsorts,R=qO(x,T),A=["percent explained variance",""],_=wt(o).map((function(e){var t=e.length;return e.substring(6,t)})),O={},D=0;D<R[1].length;D++){O[(D+1).toString()]=R[1][D]}for(var N=0;N<_.length;N++){var P=_[N].charAt(0);A.push(O[P],"")}i.push(A);for(var F=[{wch:20}],I=0,L=i[0].length;I<L;I++)F.push({wch:8});return n.push(F),i.unshift(["matrix"],["",""],["Factor Matrix with Defining Sorts Flagged"],["",""],l),e.push(i),console.log("dispatch - 7 - pushRotatedFactorsArray complete"),[e,t,n]},Gj=function(e,t,n){t.push("Free Dist");n.push([{wch:10},{wch:20},{wch:10},{wch:10}]);var r=qL.getState().freeDistributionArray;return r.unshift(["free",""],["",""],["Free Distribution Data Results"],["",""]),e.push(r),console.log("dispatch - 8 - pushFreeDistributionData complete"),[e,t,n]};var Bj=function(e){for(var t=vt()(y.getState().respondentNames),n=vt()(y.getState().mainDataObject),r=[],i=0,o=n.length;i<o;i+=1)r.push(n[i].posShiftSort);for(var a=[],s=[],l=0,u=r.length;l<u;l+=1){for(var c=[],d=Dj(r[l]),h=Nj(r[l]),f=0,p=r[l].length;f<p;f+=1){var v=Zv((r[l][f]-d)/h,3);c.push(v)}s.push(c)}var g,m=rp()(t,s);function w(e){return Zv(e*g,5)}for(var b=0,C=e.length;b<C;b+=1)for(var S=0,E=m.length;S<E;S+=1){var k=e[b][1],x=m[S][0],T=m[S][1];g=e[b][3];var R=[];if(k===x){var A=QO()(T,w);R.push(e[b][0]),R.push(k),R.push(A),a.push(R)}}return a},jj=function(e){var t=y.getState().statements,n=qL.getState().sigFactorNumbersArray;n.sort();for(var r=e.length,i=[],o=0;o<r;o++){var a={};a.factor=n[o];for(var s=[],l=[],u=0;u<e[0][2].length;u++){var c={},d=Zv(e[o][2][u],3);c.factor=n[o],c.statement=u+1,c.sortStatement=t[u],c.zScore=d,l.push(d),s.push(c)}i.push(s),a["FactorZscores".concat(n[o])]=l}return i},Hj=function(e,t,n){for(var r=[],i=0,o=t.length;i<o;i+=1)for(var a=0;a<e.length;a+=1){if(e[a][0]===t[i]){var s=n[i];e[a][3]=Zv(e[a][3]*s*10,5),r.push(e[a])}}return r};var Vj=function(e){for(var t=y.getState().qSortPattern,n=[],r=0;r<e.length;r++){var i=e[r],o=vt()(i);o.sort((function(e,t){return e.zScore===t.zScore?t.statement-e.statement:e.zScore-t.zScore}));for(var a=0;a<t.length;a++)o[a].sortValue=t[a],o[a].sigVisualization="",o[a].sigVisualizationUni="",o[a].directionSymbol="",o[a].directionSymbolUni="";o.sort((function(e,t){return e.statement-t.statement})),n.push(o)}return qL.setState({analysisOutput:n}),n},Wj=function(e){var t,n,r=qL.getState().sigFactorNumbersArray.sort();n=[];for(var i=[],o=0,a=r.length;o<a;o++){var s=[],l=[],u=r[o];t=[];for(var c={},d=0,h=e.length;d<h;d++){e[d][0]===u&&(l.push(e[d][2]),t.push(e[d][1]))}s.push(u),s.push(t),c["Factor Number"]=u,c.SigSorts=t,i.push(c);for(var f=[],p=0,v=l[0].length;p<v;p++){for(var g=0,m=0,y=l.length;m<y;m++)g=Zv(g+l[m][p],3);f.push(g)}for(var w=[],b=Dj(f),C=Nj(f),S=0,E=f.length;S<E;S++){var k=Zv((f[S]-b)/C,3);w.push(k)}s.push(w),n.push(s)}return qL.setState({sigSortsArray:i}),n},zj=function(e){for(var t=0;t<e.length;t+=1){var n=e[t][2],r=Zv(n*n,5),i=void 0,o=void 0;1===r?o=Zv(n/(i=r),5):r>1?(i=Zv(1-r,5),o=Zv(n/-i,5)):(i=Zv(1-r,5),o=Zv(n/i,5)),e[t].push(o)}return qL.setState({sortWeights:e}),e},Uj=function(e){var t=e.filter((function(e){return 99!==e[0]})),n=[],r=[];t.forEach((function(e){var t=e[0];n.push(t);var i=[t,e[3]];r.push(i)}));var i=vt()(n),o=mt()(i),a=[],s=0;return o.forEach((function(){var e=r.filter((function(e){return e[0]===i[s]})),t=[];e.forEach((function(e){var n=Zv(Math.abs(1/e[1]),8);t.push(n)}));var n=Math.min.apply(Math,t);a.push(n),s+=1})),qL.setState({sigFactorNumbersArray:o}),[e,o,a]},Kj=function(e,t,n){var r=qL.getState().userSelectedFactors,i=r.length,o=vt()(UL.getState().currentLoadingsTable);o.sort((function(e,t){return e.defaultSort-t.defaultSort}));for(var a=[],s=[],l=0;l<r.length;l+=1){var u=r[l].split(" "),c="check".concat(u[1]),d="factor".concat(u[1]);s.push(c),a.push(d)}(r=[].concat(a)).sort((function(e,t){return e-t}));for(var h=[],f=[],p=[],v=0,g=o.length;v<g;v+=1){for(var m=void 0,w=o[v],b=[],C=0,S=i;C<S;C+=1){var E=r[C],k=s[C],x=w[E],T=w[k];m=w.respondent,!0===T&&r.indexOf(E)>-1&&(0!==b.length?((b=[]).push(E,m,x),f.push(E),h.push(b),p.push(m)):(b.push(E,m,x),f.push(E),h.push(b)))}0===b.length&&(b.push(99,m,"Unique Sort"),h.push(b))}if(p.length>0){window.multipleFactorsFlaggedWarningModal.showModal(),console.log("multiple factors flagged for: ",p);var R=p.join(", ");qL.setState({sortsFlaggedOnTwoFactors:R,showMultipleFactorsFlaggedWarningModal:!0})}for(var A=[],_=0;_<r.length;_+=1){yp()(f,r[_])||A.push(r[_])}if(A.length>0)return A=A.join(", "),qL.setState({factorsWithoutLoading:A,showNoLoadingsFlaggedWarningModal:!0}),console.log("process halted - factors without flag selected"),"haltOutputProcessing";var O=zj(h),D=Uj(O),N=Hj.apply(void 0,wt(D)),P=Bj(N),F=Wj(P),I=jj(F);Vj(I);var L=vt()(qL.getState().analysisOutput),M=vt()(L),G=vt()(qL.getState().sigSortsArray),B=vt()(qL.getState().sortsAsNumbers),j=vt()(y.getState().respondentNames),H=vt()(Xv.getState().correlationTableArray),V=vt()(j);V.unshift(""),H.unshift(V);for(var W=1;W<H.length;W+=1)H[W].unshift(V[W]);for(var z=H,U=vt()(qL.getState().sortWeights),K=[],q=[],X=[],Y=[],Q=[],Z=[],J=[],$=0;$<M.length;$+=1){var ee={},te={},ne={},re=G[$]["Factor Number"],ie=re.charAt(0).toUpperCase()+re.slice(1),oe=ie.substring(ie.length-1);isNaN(+oe)&&(oe="".concat(ie.substring(ie.length-2)));var ae="Fac".concat(" ",oe),se="Sorts Weight";se.length>23&&(se="Sorts Weight short"),te.sheetid="".concat(ae," ").concat(se),te.header=!0,Q.push(te);var le="Sorts Corr";le.length>23&&(le="Sorts Corr short"),ne.sheetid="".concat(ae," ").concat(le),ne.header=!0,Z.push(ne),ee.sheetid=ae,ee.header=!0,J.push(ee)}qL.setState({sheetNamesHolder1:Q,sheetNamesHolder2:Z,sheetNamesHolder3:J});for(var ue=[],ce=0;ce<G.length;ce+=1){for(var de=[],he=0;he<G[ce].SigSorts.length;he+=1){var fe=G[ce].SigSorts[he],pe=B[j.indexOf(fe)];de.push(pe)}ue.push(de)}for(var ve=[],ge=[],me=0;me<M.length;me+=1){for(var ye=[["Nm","Q Sort","Weight"]],we=r[me],be=0;be<U.length;be+=1){var Ce=[];if(U[be][0]===we){var Se=j.indexOf(U[be][1])+1;Ce.push(Se,U[be][1],U[be][3]),ye.push(Ce)}}K.push(ye);for(var Ee=r[me],ke=[],xe=0;xe<G.length;xe+=1)G[xe]["Factor Number"]===Ee&&ke.push(G[xe].SigSorts);for(var Te=[],Re=["Q-Sort"],Ae=z[0],_e=0;_e<ke[0].length;_e+=1){Re.push(ke[0][_e]);for(var Oe=0;Oe<z.length;Oe+=1){var De=[];if(z[Oe][0]===ke[0][_e]){De.push(ke[0][_e]);for(var Ne=0;Ne<ke[0].length;Ne+=1){var Pe=Ae.indexOf(ke[0][Ne]);De.push(z[Oe][Pe])}Te.push(De)}}}Te.unshift(Re),q.push(Te);for(var Fe=[],Ie=[],Le=[],Me=0,Ge=M[0].length;Me<Ge;Me+=1){var Be={},je={},He=0,Ve=[];je.indexer=M[me][Me].statement,je.matchSortValue=M[me][Me].sortValue,je.zScore=M[me][Me].zScore;var We=M[me][Me].sortValue;Be["Statement Number"]=M[me][Me].statement,Be.Statement=M[me][Me].sortStatement,Be["Z-score"]=M[me][Me].zScore,Be["Sort Values"]=M[me][Me].sortValue,Ve.push(M[me][Me].statement,M[me][Me].sortStatement,M[me][Me].zScore,M[me][Me].sortValue);for(var ze=ue[me].length,Ue=0;Ue<ze;Ue+=1)Be["Raw Sort".concat(" ",G[me].SigSorts[Ue])]=ue[me][Ue][Me],Ve.push(ue[me][Ue][Me]),We===ue[me][Ue][Me]&&(He+=1);je.matchingCounts=He,je.matchingCountsPercent=parseInt(He/ze*100,10),Ie.push(je),Fe.push(Be),Le.push(Ve)}ve.push(Le),ge.push(Ie),(Y=vt()(Fe)).sort((function(e,t){return t["Z-score"]===e["Z-score"]?t["Statement Number"]-e["Statement Number"]:t["Z-score"]-e["Z-score"]})),X.push(Y)}return qL.setState({factorWeightFactorArrayHolder:K,miniCorrelationArrayHolder:q,synFactorArray1Holder:X,matchCount:ge,compositeFactorMasterArray:ve}),console.log("dispatch - 9 - pushFreeDistributionData complete"),[e,t,n]};function qj(e,t){e.sort((function(e,n){return e[t]===n[t]?0:n[t]<e[t]?-1:1}))}var Xj=function(e,t,n){var r,i,o,a=qL.getState().synFactorArray1Holder,s=qL.getState().userSelectedFactors,l=[],u="Factor Score Ranks";u.length>30&&(u="Factor Score Ranks short"),t.push(u);for(var c=[{wch:8},{wch:qL.getState().maxStatementLength},{wch:8}],d=0,h=2*s.length;d<h;d++)c.push({wch:7});n.push(c);for(var f=0,p=a.length;f<p;f++){for(var v=0,g=a[f].length;v<g;v++)a[f][v]["Z-score"]=Zv(a[f][v]["Z-score"],2);a[f].sort((function(e,t){return t["Z-score"]===e["Z-score"]?e["Statement Number"]-t["Statement Number"]:t["Z-score"]-e["Z-score"]}));for(var m=0,y=a[f].length;m<y;m++)i=m+1,a[f][m].Rank=i;a[f].sort((function(e,t){return e["Statement Number"]-t["Statement Number"]}))}var w=vt()(qL.getState().compositeFactorMasterArray),b=[];w[0].sort((function(e,t){return e[0]===t[0]?0:e[0]<t[0]?-1:1}));for(var C=0,S=w[0].length;C<S;C++){var E=[];E.push(w[0][C][0]),E.push(w[0][C][1]),E.push(w[0][C][0]),b.push(E)}for(var k=0,x=w.length;k<x;k++){w[k].sort((function(e,t){return e[0]===t[0]?0:e[0]<t[0]?-1:1}));for(var T=0,R=w[k].length;T<R;T++){var A=Zv(w[k][T][2],2);b[T].push(A)}qj(w[k],2);for(var _=0,O=w[k].length;_<O;_++){var D=_+1;w[k][_].push(D)}w[k].sort((function(e,t){return e[0]===t[0]?0:e[0]<t[0]?-1:1}));for(var N=0,P=w[k].length;N<P;N++){var F=w[k][N].pop();b[N].push(F)}}for(var I=["",""],L=["Statement Number","Statement","Statement Number"],M=["","",""],G=0,B=s.length;G<B;G++){var j=s[G].slice(7),H="Factor".concat(" ",j);L.push(H,H),M.push("Z-score","Rank")}b.unshift(["ranks",""],I,["","Factor Scores with Corresponding Ranks"],I,L,M),e.push(b),qL.setState({factorScoreRanksArray:b});for(var V=[],W=0,z=a[0].length;W<z;W++){o=[],(r={}).Num1=a[0][W]["Statement Number"],r.Statement=a[0][W].Statement,r.Num2=a[0][W]["Statement Number"],r.Zscore1=a[0][W]["Z-score"];var U=a[0][W].Rank;r.Rank1=U;var K=a[0][W]["Sort Values"];o.push(K);for(var q=1,X=a.length;q<X;q++){var Y=q+1;r["Zscore".concat(Y)]=a[q][W]["Z score"],r["Rank".concat(Y)]=a[q][W].Rank;var Q=a[q][W]["Sort Values"];o.push(Q)}V.push(r),l.push(o)}return qL.setState({statementRankingArray:l}),console.log("dispatch - 10 - pushFactorScoreComparisonRanksTable complete"),[e,t,n]},Yj=function(e,t,n){var r="Factor score correlations";r.length>30&&(r="Factor score correlations short"),t.push(r);for(var i,o,a=qL.getState().analysisOutput,s=qL.getState().userSelectedFactors,l=vt()(a),u=[],c=[{wch:7}],d=0,h=s.length;d<h;d++)c.push({wch:7});n.push(c);for(var f=0;f<s.length;f++){o=[];for(var p=0;p<l[f].length;p++)i=l[f][p].zScore,o.push(i);u.push(o)}function v(e){return Zv(e,5)}for(var g=[],m=0;m<u.length;m++){var y=QO()(u[m],v);g.push(y)}function w(e,t){var n,r,i=[];return e.forEach((function(e){r=Jv(t,e),n=Zv(r[0],4),i.push(n)})),i}for(var b=[],C=[],S=0;S<g.length;S++)b=w(g,g[S]),C.push(b),b=[];for(var E=0;E<C.length;E++){var k=s[E],x="Factor".concat(" ",k.slice(7));C[E].unshift(x)}var T=[];T.push("");for(var R=0;R<s.length;R++){var A=s[R],_="Factor".concat(" ",A.slice(7));T.push(_)}return C.unshift(T),qL.setState({correlationTableArrayHolder:C}),C.unshift(["scoreCorr",""],["",""],[r],["",""]),e.push(C),qL.setState({factorCorrelationsTableData:C}),console.log("dispatch - 11 - pushFactorScoreCorrelations complete"),[a,e,t,n]},Qj=function(e,t,n,r){for(var i=qL.getState().sheetNamesHolder1,o=qL.getState().sheetNamesHolder2,a=qL.getState().sheetNamesHolder3,s=qL.getState().factorWeightFactorArrayHolder,l=qL.getState().miniCorrelationArrayHolder,u=qL.getState().compositeFactorMasterArray,c=qL.getState().userSelectedFactors,d=qL.getState().sigSortsArray,h=qL.getState().maxStatementLength,f=["",""],p=0,v=c.length;p<v;p++){var g=["Statement Number","Statement","Z score","Q Sort Value"];n.push(i[p].sheetid);var m="Factor".concat(" ",c[p].slice(7));r.push([{wch:8},{wch:8}]),s[p].unshift(["weights",""],f,[m,"Sorts Weight"],f),t.push(s[p]),n.push(o[p].sheetid);for(var y=[{wch:8}],w=0,b=c.length;w<b;w++)y.push({wch:8});r.push(y),l[p].unshift(["conCorr",""],f,[m,"Sorts Correlations"],f),t.push(l[p]),n.push(a[p].sheetid);for(var C=[{wch:8},{wch:h},{wch:9},{wch:12}],S=0,E=d[p].SigSorts.length;S<E;S++)C.push({wch:12});r.push(C),u[p].sort((function(e,t){return e[2]===t[2]?e[0]<t[0]?-1:1:t[2]<e[2]?-1:1}));for(var k=0,x=d[p].SigSorts.length;k<x;k++)g.push("".concat("Raw Sort"," ").concat(d[p].SigSorts[k]));u[p].unshift(["facScore",""],f,["","".concat("Factor Scores for","  ").concat(m)],f,g),t.push(u[p])}return console.log("dispatch - 12 - insertFactors complete"),[e,t,n,r]},Zj=function(e,t,n,r){for(var i,o,a="Diff",s=qL.getState().maxStatementLength,l=["",""],u=[],c=0;c<e.length-1;c++)for(var d=c;d<e.length-1;d++)u.push([e[c],e[d+1]]);for(var h,f,p=[],v=[],g=0;g<u.length;g++){var m=[],y=["Statement Number","Statement"],w=(i=u[g][0][0].factor).charAt(0).toUpperCase()+i.slice(1);h=w.substring(w.length-1),isNaN(+h)&&(h="".concat(w.substring(w.length-2))),i="Fac".concat(" ",h);var b=(o=u[g][1][0].factor).charAt(0).toUpperCase()+o.slice(1);f=b.substring(b.length-1),isNaN(+f)&&(f="".concat(b.substring(b.length-2))),o="Fac".concat(" ",f),m.push(i,o);var C={};C.sheetid="".concat(a+i," ").concat(o),C.header=!0,p.push(m),n.push("".concat(a," ").concat(i,"  ").concat(o)),y.push(i,o,"Difference"),v.push(y);var S=[{wch:8},{wch:s},{wch:8},{wch:8},{wch:10}];r.push(S)}for(var E=0;E<u.length;E++){for(var k=[],x=0;x<u[E][0].length;x++){var T=[],R=u[E][0][x].statement,A=u[E][0][x].sortStatement,_=u[E][0][x].zScore,O=u[E][1][x].zScore,D=Zv(u[E][0][x].zScore-u[E][1][x].zScore,3);T.push(R,A,_,O,D),k.push(T)}k.sort((function(e,t){return e[4]===t[4]?0:t[4]<e[4]?-1:1})),k.unshift(["descend","".concat(p[E][0]," / ").concat(p[E][1])],l,["".concat("Descending Array of Differences Between"," ").concat(p[E][0]," ").concat("and"," ").concat(p[E][1])],l,v[E]),t.push(k)}return console.log("dispatch - 13 - pushFactorPowerSetDiffs complete"),[e,t,n,r]},Jj=function(e){for(var t=0,n=0,r=0;r<e.length;r++)if(""===e[r]);else{if(isNaN(e[r]))return 0;t+=1,n+=parseFloat(e[r])}var i=0;if(t>1){for(var o=n/t,a=0;a<e.length;a++)""===e[a]||(i+=(e[a]-o)*(e[a]-o));return Zv(i/t,6)}return 0},$j=function(e,t,n,r){var i=qL.getState().sigFactorNumbersArray,o=qL.getState().userSelectedFactors,a=qL.getState().maxStatementLength,s=["",""],l=[];o.forEach((function(e){var t=e.slice(7);l.push("Factor".concat(" ",t))})),i.sort();var u=["Nm","Statement"].concat(l);u.push("Ranking value"),n.push("Consensus-Disagreement");for(var c=[{wch:8},{wch:a}],d=0,h=o.length;d<h;d++)c.push({wch:8});c.push({wch:15}),r.push(c);for(var f=[],p=0;p<e[0].length;p++){var v=[];v.push(e[0][p].statement,e[0][p].sortStatement);for(var g=[],m=0;m<e.length;m++)v.push(e[m][p].sortValue),g.push(e[m][p].zScore);var y=Zv(Jj(g),3);v.push(y),f.push(v)}var w=o.length+2;return f.sort((function(e,t){return e[w]===t[w]?0:e[w]<t[w]?-1:1})),f.unshift(["con-dis",""],s,["Factor Qsort Values for Statements sorted by Consensus vs Disagreement"],s,u),t.push(f),console.log("dispatch - 14 - pushConsensusStatements complete"),[e,i,t,n,r]},eH=function(e,t,n,r,i){var o="Factor Characteristics";o.length>30&&(o="Factor Characteristics short");var a=qL.getState().userSelectedFactors,s=qL.getState().sigSortsArray,l=["",""];r.push(o);for(var u=[{wch:20}],c=0,d=a.length;c<d;c++)u.push({wch:8});i.push(u);var h=[];a.forEach((function(e){var t=e.slice(7);h.push("Factor".concat(" ",t))}));var f=[],p=[""].concat(h);f.push(p);for(var v=["No of Defining Variables"],g=0;g<s.length;g++)v.push(s[g].SigSorts.length);f.push(v);for(var m=["Avg Rel Coef"],y=0;y<s.length;y++)m.push(.8);f.push(m);for(var w,b,C=["Composite Reliability"],S=[],E=0;E<s.length;E++)w=s[E].SigSorts.length,b=Zv(.8*w/(1+.8*(w-1)),3),S.push(b),C.push(b);f.push(C);for(var k=["S E of Factor Zscores"],x=[],T=0;T<s.length;T++){var R=Zv(Math.sqrt(Math.abs(1-S[T])),3);x.push(R),k.push(R)}return f.push(k),f.unshift(["facChar",""],l,[o],l),n.push(f),qL.setState({factorCharacteristicsArray:f}),console.log("dispatch - 15 - pushFactorCharacteristics complete"),[x,e,t,n,r,i]},tH=function(e,t,n,r,i,o){var a="Standard Errors for Diffs";a.length>30&&(a="Standard Errors for Diffs short");var s=qL.getState().sigSortsArray,l=qL.getState().userSelectedFactors,u=["",""];i.push(a);for(var c=[{wch:8}],d=0,h=l.length;d<h;d++)c.push({wch:8});o.push(c);var f=[],p=[];l.forEach((function(e){var t=e.slice(7);p.push("Factor".concat(" ",t))}));var v=[""].concat(p);f.push(v);for(var g,m,y,w=[],b=[],C=0;C<s.length;C++){var S=[],E=s[C]["Factor Number"].slice(6);S.push("Factor".concat(" ",E));for(var k=0;k<s.length;k++){var x=[],T=[];x.push("Factor".concat(" ",s[C]["Factor Number"])),T.push(s[C]["Factor Number"]),x.push("Factor".concat(" ",s[k]["Factor Number"])),T.push(s[k]["Factor Number"]),g=e[C],m=e[k],y=Zv(Math.sqrt(g*g+m*m),3),x.push(y),T.push(y),S.push(y),w.push(x),b.push(T)}f.push(S)}return f.unshift(["stndErr",""],u,["Standard Errors for Differences in Factor Z scores"],u),r.push(f),qL.setState({standardErrorDiffSheetArray:f}),console.log("dispatch - 16 - pushStandardErrorsDifferences complete"),[s,t,w,b,n,r,i,o]},nH=n(981),rH=n.n(nH),iH=n(5506),oH=n.n(iH),aH=n(1180),sH=n.n(aH),lH=n(7753),uH=n.n(lH);var cH=function(e){for(var t=[],n=0;n<e.length;n+=1){var r=n+1,i=uH()(e[n],e[r]);t.push(i)}return t.length>1&&t.pop(),t},dH=function e(t,n,r,i,o){var a="Distinguishing Statements for",s=qL.getState().distStateUpperValueText,l=qL.getState().distStateLowerValueText,u="(".concat(l," : ","Asterisk Indicates Significance at"," ").concat(s),c="Both the Factor Q Sort Value and the Z Score Z SCR are Shown",d="Significance",h="Statement",f="Nm",p="Z score",v=i.length,g=n.length,m=t.length,y=[],w=[],b=["",""],C=[],S=r.charAt(0).toUpperCase()+r.slice(1),E=S.substring(S.length-1),k=S.slice(0,-1),x=[a+(r="".concat(k," ").concat(E))];C.push(["distinguishing",""],b,x),C.push(b,[u]),C.push(b,[c],b,b);for(var T=[f,h,f],R=[" "," "," "],A={"No.":" ","Statement ":" ","Num ":" "},_=0;_<v;_+=1)A["Q-SV-".concat(o[_])]=" ",A["Z-SCR-".concat(o[_])]=" ",A["SIG".concat(o[_])]=" ";var O={"No.":"distinguishing"};y.push(O),y.push(A);var D={};D["No."]=a+r,y.push(D),y.push(A);var N={};N["No."]=u,y.push(N),y.push(A);var P={};P["No."]=c,y.push(P),y.push(A),y.push(A);var F,I,L,M,G={};G["No."]=f,G["Statement "]=h,G["Num "]=f;for(var B=0;B<v;B+=1){G["Q-SV-".concat(o[B])]="".concat(o[B]," Q-SV"),G["Z-SCR-".concat(o[B])]="".concat(o[B]," ").concat(p),G["SIG".concat(o[B])]=d;var j=o[B].slice(6);R.push("Factor".concat(" ",j),"Factor".concat(" ",j),"Factor".concat(" ",j)),T.push("Q-SV","".concat(p),d)}y.push(G),C.push(R,T);for(var H=[],V=0;V<g;V+=1){var W=[];F={},L=n[V],F["No."]=L,W.push(L),F["Statement "]=i[0][L-1].sortStatement,W.push(i[0][L-1].sortStatement,L),F["Num "]=L;for(var z=0;z<v;z+=1)F["Q-SV-".concat(o[z])]=i[z][L-1].sortValue,F["Z-SCR-".concat(o[z])]=i[z][L-1].zScore,F["SIG".concat(o[z])]="",W.push(i[z][L-1].sortValue,i[z][L-1].zScore,"");w.push(F),H.push(W)}for(var U=0;U<m;U+=1){var K=[];I={},M=t[U],I["No."]=M,I["Statement "]=i[0][M-1].sortStatement,I["Num "]=M,K.push(M,i[0][M-1].sortStatement,M);for(var q=0;q<v;q+=1)I["Q-SV-".concat(o[q])]=i[q][M-1].sortValue,I["Z-SCR-".concat(o[q])]=i[q][M-1].zScore,K.push(i[q][M-1].sortValue,i[q][M-1].zScore),q===e.calledTimes?(I["SIG".concat(o[q])]="*",K.push("*")):(I["SIG".concat(o[q])]="",K.push(""));w.push(I),H.push(K)}for(var X=o[e.calledTimes],Y="Z-SCR-".concat(X),Q=w.sort((function(e,t){return t[Y]-e[Y]})),Z=0;Z<Q.length;Z+=1)y.push(Q[Z]);var J=[4,7,10,13,16,19,22,25][e.calledTimes];H.sort((function(e,t){return e[J]===t[J]?0:t[J]<e[J]?-1:1}));var $=C.concat(H);return e.calledTimes+=1,[y,$]},hH=function(e,t,n,r){for(var i=qL.getState().distStateUpperValueText,o=qL.getState().distStateLowerValueText,a="Consensus Statements",s="Those That Do Not Distinguish Between ANY Pair of Factors",l="All Listed Statements are Non-Significant at".concat(" ",i,"and Those Flagged with an are also Non Significant at"," ").concat(o,")"),u="Significance",c="Statement",d="Nm",h="Z score",f=["",""],p=n.length,v=e.length,g=t.length,m=[],y=[],w=[],b=[],C={"No.":" ","SIG ":" ","Statement ":" ","Num ":" "},S=0;S<p;S+=1)C["Q-SV-".concat(r[S])]=" ",C["Z-SCR-".concat(r[S])]=" ",C["SIG".concat(r[S])]=" ";w.push(["consensus",""],f,["".concat(a),""],["".concat(s)],f,[l],f,f);var E=[];m.push(C);var k={};k["No."]="".concat(a," -- ").concat(s),m.push(k),m.push(C);var x={};x["No."]=l,m.push(x),m.push(C),m.push(C);var T={};T["No."]=d,T["SIG "]=u,T["Statement "]=c,T["Num "]=d,E.push(d,u,c,d);for(var R,A,_,O,D=[" "," "," "," "],N=0;N<p;N+=1){T["Q-SV-".concat(r[N])]="".concat(r[N]," Q-SV"),T["Z-SCR-".concat(r[N])]="".concat(r[N]," ").concat(h);var P=r[N].slice(6);E.push("Q-SV","".concat(h)),D.push("Factor".concat(" ",P),"Factor".concat(" ",P))}m.push(T),w.push(D,E);for(var F=0;F<v;F+=1){R={};var I=[];_=e[F],R["No."]=_,R["SIG "]="*",R["Statement "]=n[0][_-1].sortStatement,R["Num "]=_,I.push(_,"*",n[0][_-1].sortStatement,_);for(var L=0;L<p;L+=1)R["Q-SV-".concat(r[L])]=n[L][_-1].sortValue,R["Z-SCR-".concat(r[L])]=n[L][_-1].zScore,I.push(n[L][_-1].sortValue,n[L][_-1].zScore);y.push(R),b.push(I)}for(var M=0;M<g;M+=1){var G=[];A={},O=t[M],A["No."]=O,A["SIG "]="",A["Statement "]=n[0][O-1].sortStatement,A["Num "]=O,G.push(O,"",n[0][O-1].sortStatement,O);for(var B=0;B<p;B+=1)A["Q-SV-".concat(r[B])]=n[B][O-1].sortValue,A["Z-SCR-".concat(r[B])]=n[B][O-1].zScore,G.push(n[B][O-1].sortValue,n[B][O-1].zScore);y.push(A),b.push(G)}var j=y.sort((function(e,t){return e["No."]-t["No."]}));b.sort((function(e,t){return e[0]===t[0]?0:e[0]<t[0]?-1:1}));for(var H=w.concat(b),V=0;V<j.length;V+=1)m.push(j[V]);return[m,H]},fH=n(4475),pH=n.n(fH);var vH=function(e,t){for(var n=qL.getState().consensus01Statements,r=qL.getState().consensus05Statements,i=qL.getState().userSelectedFactors,o=[],a=vt()(e),s=0;s<i.length;s+=1){var l=i[s].replace(/\s/g,"");o.push(l)}for(var u=0;u<a.length;u+=1){for(var c=0,d=a[u].length;c<d;c+=1){var h=+a[u][c].statement,f=n.includes(h),p=r.includes(h);a[u][c].isConsensus01State=!!f,a[u][c].isConsensus05State=!!p}for(var v=0,g=t[u].length;v<g;v+=1){var m=t[u][v]["No."],y=void 0,w=void 0,b=parseInt(m,10);if(!isNaN(b)){for(var C="Z-SCR-".concat(o[u]),S=t[u][v][C],E=[],k=0;k<o.length;k+=1){var x="Z-SCR-".concat(o[k]),T=t[u][v][x];E.push(T)}for(var R=pH()(E,S),A=[],_=[],O=0;O<R.length;O+=1)S-R[O]>0?_.push("1"):A.push("1");var D=void 0,N=void 0;R.length===_.length&&o.length>1?(D=">>",N="\u25ba"):R.length===A.length?(D="<<",N="\u25c4"):(D="",N="");var P="SIG".concat(o[u]),F=t[u][v][P],I=m-1,L=!1,M=!1;"*"===F?(y="** ",w="** ",L=!0):""===F&&(y="* ",w="* ",M=!0),a[u][I].sigVisualization=y,a[u][I].sigVisualizationUni=w,a[u][I].directionSymbol=D,a[u][I].directionSymbolUni=N,a[u][I].isDistinguishing01=L,a[u][I].isDistinguishing05=M}}}return a},gH=function(e,t,n,r,i,o,a,s){var l,u,c,d,h=qL.getState().maxStatementLength,f=qL.getState().userSelectedFactors,p=qL.getState().userSelectedDistStateSigLevel1,v=qL.getState().userSelectedDistStateSigLevel2;dH.calledTimes=0;for(var g=0;g<e.length;g++){var m=e[g]["Factor Number"],y=m.charAt(0).toUpperCase()+m.slice(1),w=y.substring(y.length-1);isNaN(+w)&&(w="".concat(y.substring(y.length-2))),m="Fac".concat(" ",w),a.push("".concat("Dist State"," ").concat(m));for(var b=[{wch:8},{wch:h},{wch:8}],C=0,S=f.length;C<S;C++)b.push({wch:8},{wch:8},{wch:8});s.push(b)}var E,k,x,T,R,A,_,O,D,N=[],P=[],F=[],I=[],L=[],M=[];for(u=0;u<e.length;u++){var G=[],B=[],j=[],H=[],V=[];for(c=0;c<t[0].length;c++){var W,z=!1,U=[],K=!1,q=[],X={};for(E=[],k=[],x=[],T=[],R=[],A=[],_=[],O=[],D=[],d=0;d<e.length;d++)if(t[u][c].factor===t[d][c].factor);else{l=null;for(var Y=0;Y<r.length;Y++){var Q=r[Y][0],Z=r[Y][1],J=i[u],$=i[d];Q===J&&Z===$&&(l=r[Y][2])}X.factor=t[u][c].factor,X.factorNum=u+1,X.sortValue=t[u][c].sortValue,X.zScore=t[u][c].zScore,X.statement=t[u][c].statement,X.sortStatement=t[u][c].sortStatement;var ee=Math.abs(t[u][c].zScore-t[d][c].zScore);ee>=3.891*l&&E.push(!0),ee>=3.481*l&&k.push(!0),ee>=3.291*l&&x.push(!0),ee>=2.807*l&&T.push(!0),ee>=2.575*l&&R.push(!0),ee>=1.96*l&&A.push(!0),ee>=1.645*l&&_.push(!0),ee>=1.44*l&&O.push(!0),ee>=1.28*l&&D.push(!0),Math.abs(t[u][c].zScore-t[d][c].zScore)>=l*v&&(t[u][c].zScore=Zv(t[u][c].zScore,2),z=!0,U.push(z)),Math.abs(t[u][c].zScore-t[d][c].zScore)>=l*p&&(t[u][c].zScore=Zv(t[u][c].zScore,2),K=!0,q.push(K))}switch(!0){case E.length===i.length-1:X.sigLevelText="P < 0.0001",X.sigLevelRank=8,V.push(X);break;case k.length===i.length-1:X.sigLevelText="P < 0.0005",X.sigLevelRank=7,V.push(X);break;case x.length===i.length-1:X.sigLevelText="P < 0.001",X.sigLevelRank=6,V.push(X);break;case T.length===i.length-1:X.sigLevelText="P < 0.005",X.sigLevelRank=5,V.push(X);break;case R.length===i.length-1:X.sigLevelText="P < 0.01",X.sigLevelRank=4,V.push(X);break;case A.length===i.length-1:X.sigLevelText="P < 0.05",X.sigLevelRank=3,V.push(X);break;case _.length===i.length-1:X.sigLevelText="P < 0.1",X.sigLevelRank=2,V.push(X);break;case O.length===i.length-1:X.sigLevelText="P < 0.15",X.sigLevelRank=1,V.push(X);break;case D.length===i.length-1:X.sigLevelText="P < 0.2",X.sigLevelRank=0,V.push(X)}W=c+1,U.length===i.length-1&&G.push(W),q.length===i.length-1&&B.push(W),0===U.length&&j.push(W),0===q.length&&H.push(W)}var te={factor:"Factor".concat(" ",u+1),distStates:V};M.push(te);var ne=mt()(G,!0),re=mt()(B,!0),ie=sH()(ne,re);I.push(ie),L.push(re),N.push(j),P.push(H);var oe=i[u],ae=dH(re,ie,oe,t,i);F.push(ae[0]),o.push(ae[1])}qL.setState({masterDistingStatementNumbersArray01:L,masterDistingStatementNumbersArray05:I});do{N=cH(N)}while(N.length>1);do{P=cH(P)}while(P.length>1);var se=oH()(N),le=oH()(P),ue=rH()(se,le);qL.setState({consensus05Statements:se,consensus01Statements:ue}),a.push("Consensus Statements");for(var ce=[{wch:12},{wch:12},{wch:h},{wch:12}],de=0,he=f.length;de<he;de++)ce.push({wch:12},{wch:15},{wch:15});s.push(ce);var fe=hH(se,ue,t,i);qL.setState({formattedConsensusStatements:fe[0]});var pe=vt()(t);o.push(fe[1]);var ve=vH(pe,F,fe[0]);return qL.setState({distStatementDataVizArray:F,distStateListData:M,outputForDataViz:ve}),console.log("dispatch - 17 - pushDistinguishingStatements complete"),[o,a,s]},mH=n(763),yH=function(e,t){var n=qL.getState().masterDistingStatementNumbersArray01,r=qL.getState().masterDistingStatementNumbersArray05,i=qL.getState().consensus05Statements,o=qL.getState().consensus01Statements;return yp()(r[t],e)?"  D":yp()(o,e)?"  C":yp()(n[t],e)?"  D*":yp()(i,e)?"  C*":""},wH=function(e,t,n,r,i,o){for(var a,s=[],l=0;l<t;l++){var u=n.shift(),c=u[r],d=u[i],h=yH(c,e),f=u[o],p=vt()(u.rankArray);p.splice(e,1),a=[c,d,f,h].concat(p),s.push(a)}return s},bH=function(e,t,n,r,i,o){for(var a=[],s=[],l=0;l<t;l++){var u=n.pop(),c=u[r],d=u[i],h=yH(c,e),f=u[o],p=vt()(u.rankArray);p.splice(e,1),a=[c,d,f,h].concat(p),s.unshift(a)}return s},CH=function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;a++){var l=t[a][n];if(l>-1)if(l===Math.max.apply(Math,wt(t[a].rankArray))){var u=vt()(t[a].rankArray);u.splice(e,1);var c=t[a][i],d=yH(c,e),h=[c,t[a][r],l,d].concat(u);o.push(h)}}return o},SH=function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;a++){var l=t[a][n];if(l<1)if(l===Math.min.apply(Math,wt(t[a].rankArray))){var u=vt()(t[a].rankArray);u.splice(e,1);var c=t[a][i],d=yH(c,e),h=[c,t[a][r],l,d].concat(u);o.push(h)}}return o},EH=function(e,t,n){for(var r="Statement Number",i="Z-score",o="Statement",a="Sort Values",s="Con/Dist",l="Statements",u="Num.",c="Negative Statements Ranked Lower in ",d=" Array than in Other Factor Arrays",h="Lowest Ranked Statements",f=qL.getState().statementRankingArray,p=qL.getState().userSelectedFactors,v=qL.getState().synFactorArray1Holder,g=y.getState().qSortPattern,m=[],w=+Math.max.apply(Math,wt(g)),b=+Math.min.apply(Math,wt(g)),C=(0,mH.countBy)(g,mH.identity),S=C[w],E=C[b],k=function(){var g=p[x].slice(7);t.push("Fac".concat(" ",g," - ").concat("Rel Ranks"));n.push([{wch:8},{wch:80},{wch:8},{wch:12}]),m=[[],[],[],[]];var y=v[x].map((function(e,t){return e.highLowZorder=t+1,e}));y.sort((function(e,t){return e[r]-t[r]}));for(var w=0,b=y.length;w<b;w++)y[w].rankArray=f[w];y.sort((function(e,t){return t.highLowZorder===e.highLowZorder?e[r]-t[r]:t[i]-e[i]}));var C=wH(x,E,y,r,o,a);m[0]=wt(C);var k=bH(x,S,y,r,o,a);m[3]=wt(k);var T=CH(x,y,a,o,r);m[1]=wt(T);var R=SH(x,y,a,o,r);m[2]=wt(R);var A=["",""],_="Factor".concat(" ",p[x].slice(7)),O=vt()(p);O.splice(x,1);var D=[];O.forEach((function(e){var t=e.slice(7);D.push("Factor".concat(" ",t))}));var N=["","Positive Statements Ranked Higher in "+_+" Array than in Other Factor Arrays"],P=["","Relative Ranking of Statements in "+_],F=[u,l,_,s].concat(D);m[0].unshift(["Relative Ranks",""],A,P,A,["","Highest Ranked Statements"],F),m[1].unshift(A,N,F);var I={stateNum:""};I.statement=c+_+d,I.sortValue="",m[2].unshift(A,["",c+_+d,""],F);var L={stateNum:""};L.statement=h,L.sortValue="",m[3].unshift(A,["",h,""],F),e.push((0,mH.flatten)(m))},x=0,T=p.length;x<T;x++)k();return console.log("dispatch - 18 - pushCribSheets complete"),[e,t,n]},kH=function(e,t,n){var r=UL.getState().gridColDefsLoadingsTable;t.push("Factor Loadings Table");for(var i=UL.getState().currentLoadingsTable.slice().sort((function(e,t){return e.defaultSort-t.defaultSort})),o=[],a=["Nm","Q sort","Factor Group"],s=[],l=[],u=5;u<r.length;u+=1)a.push(r[u].headerName),u%2===0?l.push(r[u].field):s.push(r[u].field);for(var c=i.length,d=0;d<c;d++){var h=[];h.push(i[d].resNum,i[d].respondent,i[d].factorGroup);for(var f=0;f<l.length;f++){var p=s[f],v=l[f];h.push(i[d][p]),!0===i[d][v]?h.push("Flagged"):h.push("")}o.push(h)}for(var g=[{wch:8}],m=0,y=o[0].length;m<y;m++)g.push({wch:8});return n.push(g),o.unshift(["loadingsTable",""],["",""],["Loadings Table with Defining Sorts Flagged"],["",""],a),e.push(o),console.log("dispatch - 7b - pushLoadingsTable complete"),[e,t,n]},xH=function(){var e=qL.getState().userSelectedFactors,t=Aj(),n=Oj.apply(void 0,wt(t)),r=Pj.apply(void 0,wt(n)),i=Fj.apply(void 0,wt(r)),o=Ij.apply(void 0,wt(i)),a=Lj.apply(void 0,wt(o)),s=Mj.apply(void 0,wt(a)),l=kH.apply(void 0,wt(s)),u=Gj.apply(void 0,wt(l)),c=Kj.apply(void 0,wt(u));if("haltOutputProcessing"===c)return console.log("dispatch - processing stopped due to factors without flag selected"),"error";var d=Xj.apply(void 0,wt(c)),h=Yj.apply(void 0,wt(d)),f=Qj.apply(void 0,wt(h));if(e.length>1){var p=Zj.apply(void 0,wt(f)),v=$j.apply(void 0,wt(p)),g=eH.apply(void 0,wt(v)),m=tH.apply(void 0,wt(g)),y=gH.apply(void 0,wt(m)),w=EH.apply(void 0,wt(y));qL.setState({outputData:w[0],sheetNamesXlsx:w[1],colSizes:w[2],showFactorCorrelationsTable:!0,showFactorCharacteristicsTable:!0,showStandardErrorsDifferences:!0}),console.log("dispatch - normal output cascade 1-18 complete")}else qL.setState({outputData:f[1],sheetNamesXlsx:f[2],colSizes:f[3]}),console.log("no user selected factors")},TH=function(){var t=qL(),n=t.outputButtonsArray,i=t.showOutputFactorSelection,o=t.outputFactorSelectButtonsDisabled,a=t.userSelectedFactors,s=t.userSelectedDistStateSigLevel1,l=t.userSelectedDistStateSigLevel2,u=n,c=o,d=s,h=l,f=Y((0,e.useState)({factor0:"bg-gray-100",factor1:"bg-gray-100",factor2:"bg-gray-100",factor3:"bg-gray-100",factor4:"bg-gray-100",factor5:"bg-gray-100",factor6:"bg-gray-100",factor7:"bg-gray-100",factor8:"bg-gray-100"}),2),p=f[0],v=f[1],g=function(){v({factor0:"bg-gray-100",factor1:"bg-gray-100",factor2:"bg-gray-100",factor3:"bg-gray-100",factor4:"bg-gray-100",factor5:"bg-gray-100",factor6:"bg-gray-100",factor7:"bg-gray-100",factor8:"bg-gray-100"}),qL.setState({userSelectedFactors:[],showFactorCorrelationsTable:!1,showFactorCharacteristicsTable:!1,showStandardErrorsDifferences:!1,showDownloadOutputButtons:!1,displayFactorVisualizations:!1,shouldDisplayFactorVizOptions:!1,outputFactorSelectButtonsDisabled:!1,outputForDataViz2:[]})};(0,e.useEffect)((function(){i&&g()}),[i]);var m=function(e){var t=e.target.id;if(!yp()(a,t)){a.push(t),a.sort();var n=t.split(" ").join("");p[n]="bg-green-300",v(p),qL.setState({userSelectedFactors:a,showDownloadOutputButtons:!1,showFactorCorrelationsTable:!1,showFactorCharacteristicsTable:!1,showStandardErrorsDifferences:!1,displayFactorVisualizations:!1,shouldDisplayFactorVizOptions:!1})}};return i?(0,r.jsxs)("div",{className:"flex flex-row items-center h-[50px] w-[850px] align-baseline",children:[(0,r.jsx)("p",{className:"text-2xl mr-2",children:"Select Factors:"}),u.map((function(e){return(0,r.jsx)(C,{buttonId:"factor ".concat(e),handleClick:m,buttonText:e,buttonColor:p["factor".concat(e)],otherFormatting:"mr-2 w-[50px]"},"f".concat(e))})),(0,r.jsx)(C,{buttonId:"selectAllFacs",handleClick:function(){a=[];for(var e=0;e<u.length;e+=1){var t="factor ".concat(u[e]);a.push(t)}v({factor0:"bg-green-300",factor1:"bg-green-300",factor2:"bg-green-300",factor3:"bg-green-300",factor4:"bg-green-300",factor5:"bg-green-300",factor6:"bg-green-300",factor7:"bg-green-300",factor8:"bg-green-300"}),qL.setState({userSelectedFactors:a,showDownloadOutputButtons:!1,showFactorCorrelationsTable:!1,showFactorCharacteristicsTable:!1,showStandardErrorsDifferences:!1,displayFactorVisualizations:!1,shouldDisplayFactorVizOptions:!1})},buttonText:"All",disabled:c,otherFormatting:"mr-2 w-[75px]",buttonColor:"bg-gray-100"}),(0,r.jsx)(C,{buttonId:"clearAllFacs",handleClick:g,buttonText:"Clear",buttonColor:"bg-gray-100",otherFormatting:"mr-2 w-[75px]"}),(0,r.jsx)(C,{buttonId:"startOutput",handleClick:function(){d<=h?qL.setState({notifyOutputDistStateError:!0}):0!==a.length&&("error"===xH()?window.noLoadingsFlaggedModal.showModal():qL.setState({showDownloadOutputButtons:!0,outputFactorSelectButtonsDisabled:!0}))},buttonText:"Submit",disabled:c,buttonColor:"bg-gray-100",otherFormatting:"w-[75px]"})]}):null},RH=function(){var e=qL().sortsFlaggedOnTwoFactors;return(0,r.jsx)("dialog",{id:"multipleFactorsFlaggedWarningModal",className:"modal",children:(0,r.jsxs)("form",{method:"dialog",className:"modal-box",children:[(0,r.jsx)("p",{className:"text-2xl mb-4 font-bold",children:"Output Selection Warning"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xl",children:"There are Q sorts flagged on more than one factor"}),(0,r.jsxs)("p",{className:"text-xl mt-8",children:["Participant sorts: ",e]})]}),(0,r.jsx)(rg,{buttonId:"multipleFactorsFlaggedWarningModalGotItButton",otherFormatting:"modal-action mt-6",buttonText:"Close"})]})})},AH=function(e){var t=qL(),n=t.factorVizOptions,i=t.factorVizOptionsHolder,o=t.shouldDisplayFactorVizOptions,a=t.updateFactorVisualizationsButtonColor,s=t.setFactorVizOptions,l=t.setFactorVizOptionsHolder,u=t.setUpdateFactorVisualizationsButtonColor;return o?(0,r.jsx)("div",{className:"mt-[10px] bg-[".concat(a,"] mb-[10px]"),children:(0,r.jsx)(C,{buttonId:"refreshFactorVizButton",handleClick:function(){for(var e=Object.keys(i),t=0;t<e.length;t+=1)n[e[t]]=i[e[t]];s(n),l({}),u("#83cafe")},buttonColor:a,buttonText:"Update Factor Visualizations",otherFormatting:"mr-2"})}):null},_H=function(){var e=!0;qL.getState().userSelectedFactors.length<2&&(e=!1);if(qL.getState().showDownloadOutputButtons&&e)return(0,r.jsx)("div",{style:{display:"flex"},children:(0,r.jsx)(C,{buttonId:"displayVisualizationsButton",handleClick:function(){var e=!qL.getState().shouldDisplayFactorVizOptions;qL.setState({shouldDisplayFactorVizOptions:e})},buttonText:"View Display Options",otherFormatting:"mr-2",buttonColor:"bg-gray-100 hover:bg-gray-400"})})},OH=function(){var e=qL(),t=e.displayFactorVisualizations,n=e.showStandardErrorsDifferences;return UL().showSection6?(0,r.jsxs)("div",{className:"flex flex-col items-center bg-blue-100 rounded-md p-6",children:[(0,r.jsx)(lB,{}),(0,r.jsxs)("div",{className:"w-full bg-gray-300 p-8 rounded-md",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)(TH,{}),(0,r.jsx)(kj,{}),(0,r.jsx)(xj,{}),(0,r.jsx)(RH,{})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[n&&(0,r.jsx)("p",{className:"text-3xl mt-12 mb-8",children:"Factor Visualizations"}),(0,r.jsxs)("div",{className:"flex flex-row mb-4",children:[(0,r.jsx)(Tj,{}),(0,r.jsx)(_H,{})]}),(0,r.jsx)(AH,{}),(0,r.jsx)(bB,{}),t&&(0,r.jsx)(pj,{})]})]})]}):null},DH=function(e){O(n,e);var t=F(n);function n(){var e;T(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={error:null,hasError:!1,showError:!1},e}return A(n,[{key:"componentDidCatch",value:function(e){this.setState({hasError:!0,error:e.message,errorMessage:e.stack})}},{key:"render",value:function(){var e=this;return this.state.hasError?(0,r.jsxs)("div",{className:"m-[50px]",children:[(0,r.jsx)("h1",{children:"There was an unexpected error"}),(0,r.jsx)("p",{className:"text-2xl m-8",children:"At the top of the page, click the reload button to restart the application"}),!this.state.showError&&(0,r.jsx)("button",{onClick:function(){return e.setState({showError:!0})},children:"Show error \u2192"}),this.state.showError&&(0,r.jsx)("pre",{children:(0,r.jsx)("code",{children:this.state.error})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),this.state.showError&&(0,r.jsx)("pre",{children:(0,r.jsx)("code",{children:this.state.errorMessage})})]}):this.props.children}}]),n}(e.Component),NH=DH;var PH=function(){return(0,r.jsx)(NH,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-6 p-4 bg-neutral-100",children:[(0,r.jsx)(H,{}),(0,r.jsx)(ag,{}),(0,r.jsx)(xO,{}),(0,r.jsx)(HL,{}),(0,r.jsx)(WG,{}),(0,r.jsx)(aB,{}),(0,r.jsx)(OH,{})]})})},FH=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),r(e),i(e),o(e),a(e)}))};t.createRoot(document.getElementById("root")).render((0,r.jsx)(e.StrictMode,{children:(0,r.jsx)(PH,{})})),FH()}()}();
//# sourceMappingURL=main.5764d880.js.map